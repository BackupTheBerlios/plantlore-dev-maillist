<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r263 - trunk/src/net/sf/plantlore/client
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-May/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r263%20-%20trunk/src/net/sf/plantlore/client&In-Reply-To=%3C200605122230.k4CMUxU3005509%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000310.html">
   <LINK REL="Next"  HREF="000312.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r263 - trunk/src/net/sf/plantlore/client</H1>
    <B>fraktalek at berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r263%20-%20trunk/src/net/sf/plantlore/client&In-Reply-To=%3C200605122230.k4CMUxU3005509%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r263 - trunk/src/net/sf/plantlore/client">fraktalek at berlios.de
       </A><BR>
    <I>Sat May 13 00:30:59 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000310.html">[Plantlore-dev] Re: Re:
</A></li>
        <LI>Next message: <A HREF="000312.html">[Plantlore-dev] r264 - trunk/src/net/sf/plantlore/server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#311">[ date ]</a>
              <a href="thread.html#311">[ thread ]</a>
              <a href="subject.html#311">[ subject ]</a>
              <a href="author.html#311">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: fraktalek
Date: 2006-05-13 00:30:55 +0200 (Sat, 13 May 2006)
New Revision: 263

Added:
   trunk/src/net/sf/plantlore/client/Column.java
   trunk/src/net/sf/plantlore/client/SettingsView.form
Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/OverviewTableModel.java
   trunk/src/net/sf/plantlore/client/Search.java
   trunk/src/net/sf/plantlore/client/SearchCtrl.java
   trunk/src/net/sf/plantlore/client/SearchView.java
   trunk/src/net/sf/plantlore/client/Settings.java
   trunk/src/net/sf/plantlore/client/SettingsCtrl.java
   trunk/src/net/sf/plantlore/client/SettingsView.java
Log:
Setting dialog now made in Matisse. Improved Search and bound it to Overview. Also prepared for overview displayed column choice. Although use of Projections in SelectQueries made the Overview many times faster unofrunately the projections still don't seem to work correctly - the order of columns in returned rows is jumbled.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -244,6 +244,8 @@
         prefs.putInt(&quot;recordsPerPage&quot;, recordsPerPage);
     }
     
+    public void setResultId(int resultId) {
+        tableModel.setResultId(resultId);
+    }
     
-    
 }

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -191,7 +191,7 @@
             //If the dialog is already constructed then use it. Otherwise construct it first.
             //if (settingsModel == null) {
                 settingsModel = new Settings();
-                settingsView = new SettingsView(settingsModel, view.getSBM());
+                settingsView = new SettingsView(view,true,settingsModel);
                 settingsCtrl = new SettingsCtrl(settingsModel, settingsView);
                 settingsView.setVisible(true);
             /*} else {
@@ -410,15 +410,28 @@
         public void actionPerformed(ActionEvent actionEvent) {
             if (searchModel == null) {
                 searchModel = new Search(model.getDatabase());
+                searchModel.setColumns(model.getTableModel().getColumns().clone());
                 searchView = new SearchView(view, true, searchModel);
                 searchView.setTitle(&quot;Search&quot;);
                 searchCtrl = new SearchCtrl(searchModel, searchView);
+                searchModel.addObserver(new SearchBridge());
             }
+            searchModel.clear();
             searchView.clearComponentData();
             searchView.setVisible(true);
         }
     }
     
+    class SearchBridge implements Observer {
+        public void update(Observable o, Object arg) {
+            if (arg != null &amp;&amp; arg instanceof Integer) {
+                logger.debug(&quot;Fetching new result id from Search model. Storing it to AppCore model.&quot;);
+                model.setResultId(searchModel.getNewResultId());
+            }
+        }
+        
+    }
+    
     class PreviousPageAction extends AbstractAction {
         public PreviousPageAction() {
             putValue(NAME, L10n.getString(&quot;prevButton&quot;));
@@ -611,5 +624,4 @@
     	}
     }
     
-    
 }

Added: trunk/src/net/sf/plantlore/client/Column.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Column.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/Column.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -0,0 +1,267 @@
+/*
+ * Column.java
+ *
+ * Created on 12. kv&#283;ten 2006, 13:41
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.client;
+
+import java.util.Date;
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ *
+ * @author fraktalek
+ */
+public class Column {
+    public Type type;
+    public int preferredSize;
+    public String l10nKey;
+    public Class columnClass;
+    
+    public enum Type {SELECTION,
+    NUMBER,
+    PLANT_TAXON,
+    AUTHOR,
+    HABITAT_NEAREST_VILLAGE_NAME,
+    HABITAT_DESCRIPTION,
+    OCCURRENCE_YEARCOLLECTED,
+    TERRITORY_NAME,
+    PHYTOCHORION_NAME,
+    PHYTOCHORION_CODE,
+    HABITAT_COUNTRY,
+    HABITAT_QUADRANT,
+    OCCURRENCE_NOTE,
+    HABITAT_NOTE,
+    HABITAT_ALTITUDE,
+    HABITAT_LONGITUDE,
+    HABITAT_LATITUDE,
+    OCCURRENCE_DATASOURCE,
+    PUBLICATION_COLLECTIONNAME,
+    OCCURRENCE_HERBARIUM,
+    METADATA_DATASETTITLE,
+    OCCURRENCE_MONTHCOLLECTED,
+    OCCURRENCE_DAYCOLLECTED,
+    OCCURRENCE_TIMECOLLECTED,
+    OCCURRENCE_ID}
+    
+    /** Creates a new instance of Column */
+    public Column(Type type) {
+        this.type = type;
+        switch (type) {
+            case AUTHOR:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColAuthor&quot;;
+                columnClass = String.class;
+                break;
+            case HABITAT_ALTITUDE:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColAltitude&quot;;
+                columnClass = Double.class;
+                break;
+            case HABITAT_COUNTRY:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColCountry&quot;;
+                columnClass = String.class;
+                break;
+            case HABITAT_DESCRIPTION:
+                preferredSize = 150;
+                l10nKey = &quot;overviewColPlace&quot;;
+                columnClass = String.class;
+                break;
+            case HABITAT_LATITUDE:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColLatitude&quot;;
+                columnClass = Double.class;
+                break;
+            case HABITAT_LONGITUDE:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColLongitude&quot;;
+                columnClass = Double.class;
+                break;
+            case HABITAT_NEAREST_VILLAGE_NAME:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColVillage&quot;;
+                columnClass = String.class;
+                break;
+            case HABITAT_NOTE:
+                preferredSize = 150;
+                l10nKey = &quot;overviewColLocNote&quot;;
+                columnClass = String.class;
+                break;
+            case HABITAT_QUADRANT:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColQuadrant&quot;;
+                columnClass = String.class;
+                break;
+            case METADATA_DATASETTITLE:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColMetadata&quot;;
+                columnClass = String.class;
+                break;
+            case NUMBER:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColNumber&quot;;
+                columnClass = Integer.class;
+                break;
+            case OCCURRENCE_DATASOURCE:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColSource&quot;;
+                columnClass = String.class;
+                break;
+            case OCCURRENCE_DAYCOLLECTED:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColDay&quot;;
+                columnClass = Integer.class;
+                break;
+            case OCCURRENCE_HERBARIUM:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColHerbarium&quot;;
+                columnClass = String.class;
+                break;
+            case OCCURRENCE_ID:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColOccurrenceId&quot;;
+                columnClass = Integer.class;
+                break;
+            case OCCURRENCE_MONTHCOLLECTED:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColMonth&quot;;
+                columnClass = Integer.class;
+                break;
+            case OCCURRENCE_NOTE:
+                preferredSize = 150;
+                l10nKey = &quot;overviewColOccNote&quot;;
+                columnClass = String.class;
+                break;
+            case OCCURRENCE_TIMECOLLECTED:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColTime&quot;;
+                columnClass = Date.class;
+                break;
+            case OCCURRENCE_YEARCOLLECTED:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColYear&quot;;
+                columnClass = Integer.class;
+                break;
+            case PHYTOCHORION_CODE:
+                preferredSize = 50;
+                l10nKey = &quot;overviewColPhytCode&quot;;
+                columnClass = String.class;
+                break;
+            case PHYTOCHORION_NAME:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColPhyt&quot;;
+                columnClass = String.class;
+                break;
+            case PLANT_TAXON:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColName&quot;;
+                columnClass = String.class;
+                break;
+            case PUBLICATION_COLLECTIONNAME:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColPublication&quot;;
+                columnClass = String.class;
+                break;
+            case SELECTION:
+                preferredSize = 30;
+                l10nKey = &quot;overviewColSelection&quot;;
+                columnClass = Boolean.class;
+                break;
+            case TERRITORY_NAME:
+                preferredSize = 100;
+                l10nKey = &quot;overviewColTerritory&quot;;
+                columnClass = String.class;
+                break;
+            default:
+                preferredSize = 100;
+                l10nKey = &quot;overviewCol&quot;;
+                columnClass = String.class;
+        }
+        
+    }
+    
+    public Class getColumnClass() {
+        return columnClass;
+    }
+    
+    public int getPreferredSize() {
+        return preferredSize;
+    }
+    
+    public void setPreferredSize(int size) {
+        preferredSize = size;
+    }
+    
+    public Type getType() {
+        return type;
+    }
+    
+    public void setType(Type type) {
+        this.type = type;
+    }
+    
+    public String getL10nName() {
+        return L10n.getString(l10nKey);
+    }
+}
+
+/*
+                    switch (columns[j].type) {
+                        case AUTHOR:
+                            break;
+                        case HABITAT_ALTITUDE:
+                            break;
+                        case HABITAT_COUNTRY:
+                            break;
+                        case HABITAT_DESCRIPTION:
+                            break;
+                        case HABITAT_LATITUDE:
+                            break;
+                        case HABITAT_LONGITUDE:
+                            break;
+                        case HABITAT_NEAREST_VILLAGE_NAME:
+                            break;
+                        case HABITAT_NOTE:
+                            break;
+                        case HABITAT_QUADRANT:
+                            break;
+                        case METADATA_DATASETTITLE:
+                            break;
+                        case NUMBER:
+                            break;
+                        case OCCURRENCE_DATASOURCE:
+                            break;
+                        case OCCURRENCE_DAYCOLLECTED:
+                            break;
+                        case OCCURRENCE_HERBARIUM:
+                            break;
+                        case OCCURRENCE_ID:
+                            break;
+                        case OCCURRENCE_MONTHCOLLECTED:
+                            break;
+                        case OCCURRENCE_NOTE:
+                            break;
+                        case OCCURRENCE_TIMECOLLECTED:
+                            break;
+                        case OCCURRENCE_YEARCOLLECTED:
+                            break;
+                        case PHYTOCHORION_CODE:
+                            break;
+                        case PHYTOCHORION_NAME:
+                            break;
+                        case PLANT_TAXON:
+                            break;
+                        case PUBLICATION_COLLECTIONNAME:
+                            break;
+                        case SELECTION:
+                            break;
+                        case TERRITORY_NAME:
+                            break;
+                        default:                        
+                    }//switch
+*/
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/client/OverviewTableModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/OverviewTableModel.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/OverviewTableModel.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -16,8 +16,12 @@
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
+import net.sf.plantlore.common.record.Habitat;
 import net.sf.plantlore.common.record.Occurrence;
+import net.sf.plantlore.common.record.Phytochorion;
 import net.sf.plantlore.common.record.Plant;
+import net.sf.plantlore.common.record.Territory;
+import net.sf.plantlore.common.record.Village;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 import net.sf.plantlore.common.exception.DBLayerException;
@@ -35,12 +39,13 @@
     private String[] columnNames;
     private int[] columnSizes;
     
-    private int resultid = 0;
+    private int resultId = 0;
     private int resultsCount = 0;
     private int pageSize = 30;
     private int currentPage = 1;
     private ArrayList&lt;Record999&gt; recordsArray = new ArrayList&lt;Record999&gt;();
     private HashMap&lt;Integer, Record999&gt; resultsMap = new HashMap&lt;Integer, Record999&gt;();
+    private Column[] columns;
     
     class Record999 {
         public Record999(int id, boolean selected, int number) {
@@ -82,20 +87,52 @@
         this.pageSize = pageSize;
         resultsCount = 0;
         this.db = db;
-        SelectQuery sq = db.createQuery(Occurrence.class);
+/*        SelectQuery sq = db.createQuery(Occurrence.class);
         sq.addOrder(PlantloreConstants.DIRECT_ASC, Occurrence.YEARCOLLECTED); //setridit podle roku
-        sq.addRestriction(PlantloreConstants.RESTR_NE, Occurrence.DELETED, null, 1, null);
+        sq.addRestriction(PlantloreConstants.RESTR_NE, Occurrence.DELETED, null, 1, null);*/
+        SelectQuery sq = db.createQuery(AuthorOccurrence.class);
+        sq.createAlias(AuthorOccurrence.AUTHOR,&quot;author&quot;);
+        sq.createAlias(AuthorOccurrence.OCCURRENCE,&quot;occ&quot;);
+        sq.createAlias(&quot;occ.&quot;+Occurrence.HABITAT,&quot;habitat&quot;);
+        sq.createAlias(&quot;occ.&quot;+Occurrence.PLANT,&quot;plant&quot;);
+        sq.createAlias(&quot;occ.&quot;+Occurrence.PUBLICATION,&quot;publication&quot;);
+        sq.createAlias(&quot;occ.&quot;+Occurrence.METADATA,&quot;metadata&quot;);
+        sq.createAlias(&quot;habitat.&quot;+Habitat.PHYTOCHORION,&quot;phyt&quot;);
+        sq.createAlias(&quot;habitat.&quot;+Habitat.NEARESTVILLAGE,&quot;vill&quot;);
+        sq.createAlias(&quot;habitat.&quot;+Habitat.TERRITORY,&quot;territory&quot;);
+        sq.addOrder(PlantloreConstants.DIRECT_ASC, &quot;occ.&quot;+Occurrence.YEARCOLLECTED); //setridit podle roku
+        sq.addRestriction(PlantloreConstants.RESTR_NE, &quot;occ.&quot;+Occurrence.DELETED, null, 1, null);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;plant.&quot;+Plant.TAXON);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;author.&quot;+Author.WHOLENAME);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;vill.&quot;+Village.NAME);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.YEARCOLLECTED);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;phyt.&quot;+Phytochorion.NAME);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.DESCRIPTION);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;territory.&quot;+Territory.NAME);
+        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.ID);
+        
         //FIXME:
         try {
-            setResultid(db.executeQuery(sq));
+            setResultId(db.executeQuery(sq));
         } catch (DBLayerException ex) {
             ex.printStackTrace();
         }
-        loadData();
+        loadData2();
     }
     
     private void init() {
-        columnNames = new String[COLUMN_COUNT];
+        columns = new Column[10];
+        columns[0] = new Column(Column.Type.SELECTION);
+        columns[1] = new Column(Column.Type.NUMBER);
+        columns[2] = new Column(Column.Type.PLANT_TAXON);        
+        columns[3] = new Column(Column.Type.AUTHOR);
+        columns[4] = new Column(Column.Type.HABITAT_NEAREST_VILLAGE_NAME);
+        columns[5] = new Column(Column.Type.OCCURRENCE_YEARCOLLECTED);
+        columns[6] = new Column(Column.Type.PHYTOCHORION_NAME);
+        columns[7] = new Column(Column.Type.HABITAT_DESCRIPTION);
+        columns[8] = new Column(Column.Type.TERRITORY_NAME);
+        columns[9] = new Column(Column.Type.OCCURRENCE_ID);
+/*        columnNames = new String[COLUMN_COUNT];
         columnSizes = new int[COLUMN_COUNT];
         columnNames[0] = L10n.getString(&quot;overviewColX&quot;);
         columnSizes[0] = 30;
@@ -144,7 +181,7 @@
         columnNames[22] = L10n.getString(&quot;overviewColDay&quot;);
         columnSizes[22] = 50;
         columnNames[23] = L10n.getString(&quot;overviewColTime&quot;);
-        columnSizes[23] = 100;
+        columnSizes[23] = 100; */
     }
     
     private Pair&lt;String,Integer&gt;[] getAuthorsOf(Occurrence o) {
@@ -172,6 +209,52 @@
         return authorResults;
     }
     
+    private void loadData2() throws DBLayerException, RemoteException 
+    {
+        resultsCount = db.getNumRows(getResultId());
+        System.out.println(&quot;resultsCount=&quot;+resultsCount);
+        Object[] records;
+        Object[] projArray;
+        Object[] row;
+        if (resultsCount &gt; 0) {
+            logger.debug(&quot;resultsCount = &quot;+resultsCount);
+            to = Math.min(resultsCount-1, from + pageSize - 1);
+            logger.debug(&quot;to = &quot;+to+&quot; from=&quot;+from+&quot; currentPage=&quot;+currentPage);
+            data = new Object[to - from + 1][];
+            logger.debug(&quot;data.length = &quot;+data.length);
+            records = db.more(getResultId(), from, to);
+            logger.debug(&quot;records.length = &quot; + records.length);
+
+            for (int i = 0; i &lt; data.length ; i++) {
+                projArray = (Object[]) records[i];
+                Record999 r = new Record999(from + i + 1, false, from + i + 1);//we want to show the user numbers starting from 1 therefor the +1
+                if (from + i + 1 &gt; recordsArray.size()) //most probably much faster than to ask recordsArray.contains(r)
+                    recordsArray.add(r);
+                else 
+                    r = recordsArray.get(from+i);
+
+                row = new Object[columns.length + 1]; //we'll store the record id in the last column
+                int proj = 0;
+                for (int j = 0; j &lt; columns.length; j++) {
+                    if (columns[j].type.equals(Column.Type.SELECTION)) {
+                        row[j] = r.selected;
+                    System.out.println(&quot;row[&quot;+j+&quot;]=&quot;+r.selected);
+                    } else 
+                    if (columns[j].type.equals((Column.Type.NUMBER))) {
+                        row[j] = r.number;
+                    System.out.println(&quot;row[&quot;+j+&quot;]=&quot;+r.number);
+                    } else {
+                        row[j] = projArray[proj];
+                    System.out.println(&quot;row[&quot;+j+&quot;]=&quot;+projArray[proj]);
+                        proj++;
+                    }
+                }// for j
+                data[i] = row;
+            }//for i
+        }//if resultsCount&gt;0
+        
+    }
+    
     /**
      * Expects from, pageSize, currentPage and resultid variables to be set appropriately.
      */
@@ -182,7 +265,7 @@
         Occurrence result;
         Plant plant;
         Object[] resultObj, records;
-        resultsCount = db.getNumRows(getResultid());
+        resultsCount = db.getNumRows(getResultId());
         System.out.println(&quot;resultsCount=&quot;+resultsCount);
         if (resultsCount &gt; 0) {
             logger.debug(&quot;resultsCount = &quot;+resultsCount);
@@ -190,7 +273,7 @@
             logger.debug(&quot;to = &quot;+to+&quot; from=&quot;+from+&quot; currentPage=&quot;+currentPage);
             data = new Object[to - from + 1][];
             logger.debug(&quot;data.length = &quot;+data.length);
-            records = db.more(getResultid(), from, to);
+            records = db.more(getResultId(), from, to);
             logger.debug(&quot;records.length = &quot; + records.length);
 
             for (int i = 0; i &lt; data.length ; i++) {
@@ -242,7 +325,7 @@
         Object[] resultObj, records;
         //FIXME:
         try {
-            records = db.more(getResultid(), from, from + row);
+            records = db.more(getResultId(), from, from + row);
             result = (AuthorOccurrence)((Object[])records[0])[0];
         } catch (RemoteException ex) {
             ex.printStackTrace();
@@ -265,7 +348,8 @@
     }
     
     public int getColumnCount() {
-        return columnNames.length;
+        return columns.length;
+        //return columnNames.length;
     }
     
     public Object getValueAt(int i, int i0) {
@@ -273,6 +357,10 @@
     }
     
     public Class getColumnClass(int c) {
+        return columns[c].getColumnClass();
+    }
+/*    
+    public Class getColumnClass(int c) {
         switch (c) {
             case 0:return Boolean.class;
             case 1:return Integer.class;
@@ -304,9 +392,10 @@
         }
         //return getValueAt(0,c).getClass();
     }
-    
+*/    
     public String getColumnName(int c){
-        return columnNames[c];
+//        return columnNames[c];
+        return columns[c].getL10nName();
     }
     
     /* nepouziva se
@@ -329,7 +418,8 @@
     }
     
     public int getColumnSize(int col) {
-        return columnSizes[col];
+        //return columnSizes[col];
+        return columns[col].getPreferredSize();
     }
     
     public boolean isSimple() {
@@ -375,7 +465,7 @@
         currentPage = from / pageSize + 1;
         //FIXME: 
         try {
-            loadData();
+            loadData2();
         } catch (RemoteException ex) {
             ex.printStackTrace();
         } catch (DBLayerException ex) {
@@ -400,7 +490,7 @@
         {
             currentPage++;  
             from = from + pageSize;
-            loadData(); //load data with new parameter currentPage
+            loadData2(); //load data with new parameter currentPage
             fireTableDataChanged(); //let the table compoment know it should redraw itself
             logger.debug(&quot;currentPage = &quot;+ currentPage);
             return true;
@@ -415,7 +505,7 @@
         {
             currentPage--;
             from = from - pageSize;
-            loadData(); //load data with new parameter currentPage
+            loadData2(); //load data with new parameter currentPage
             fireTableDataChanged(); //let the table compoment know it should redraw itself
             logger.debug(&quot;currentPage = &quot;+ currentPage);
             return true;
@@ -424,14 +514,23 @@
         }
     }
     
-    public int getResultid() {
-        System.out.println(&quot;returning resultid &quot;+resultid);
-        return resultid;
+    public int getResultId() {
+        System.out.println(&quot;returning resultid &quot;+resultId);
+        return resultId;
     }
 
-    public void setResultid(int resultid) {
-        System.out.println(&quot;setting resultid to &quot;+resultid);
-        this.resultid = resultid;
+    public void setResultId(int resultId) {
+        logger.debug(&quot;Setting resultid to &quot;+resultId);
+        this.resultId = resultId;
+        from = 0;
+        //FIXME
+        try {
+            loadData2();
+        } catch (DBLayerException ex) {
+            ex.printStackTrace();
+        } catch (RemoteException ex) {
+            ex.printStackTrace();
+        }
     }
 
     public int getResultsCount() {
@@ -446,4 +545,12 @@
     {
         return ((Number)Math.ceil(resultsCount / (pageSize*1.0))).intValue();
     }
+
+    public Column[] getColumns() {
+        return columns;
+    }
+
+    public void setColumns(Column[] columns) {
+        this.columns = columns;
+    }
 }

Modified: trunk/src/net/sf/plantlore/client/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Search.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/Search.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -14,6 +14,8 @@
 import java.util.Calendar;
 import java.util.Date;
 import java.util.Observable;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DBLayerUtils;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.exception.DBLayerException;
@@ -42,9 +44,6 @@
     private Logger logger;
     private DBLayer database;      
     
-    private int coordinateSystem;
-    private Occurrence o; //original occurrence
-    
     //list of authors user selects
     private ArrayList&lt;Pair&lt;Pair&lt;String,Integer&gt;,String&gt;&gt; authorList;
     private ArrayList&lt;String&gt; resultRevision;
@@ -72,13 +71,8 @@
     private Pair&lt;String,Integer&gt; project = new Pair&lt;String,Integer&gt;(&quot;&quot;,-1);
     private Integer month;
     private Date fromDate, toDate;
+        
     
-    private boolean yearChanged = false;
-    private boolean dayChanged = false;
-    private boolean monthChanged = false;
-    private boolean timeChanged = false;
-    
-    
     private Pair&lt;String, Integer&gt;[] plants = null;
     private Pair&lt;String, Integer&gt;[] authors = null;
     private String[] authorRoles = null;
@@ -97,6 +91,8 @@
     private int timeChoice = INTERVAL;
     private Boolean editMode = false;
     
+    private Column[] columns;
+    private int newResultId = -1;
     
     /** Creates a new instance of AddEdit */
     public Search(DBLayer database) {
@@ -149,12 +145,6 @@
         return year;
     }
 
-    public void setYear(Integer year) {
-        this.year = year;
-        if (!year.equals(1))
-            yearChanged = true;
-        logger.debug(&quot;Year set to &quot;+ year);
-    }
 
     public String getHabitatNote() {
         return habitatNote;
@@ -314,8 +304,6 @@
 
     public void setMonth(Integer month) {
         this.month = month;
-        if (!month.equals(1))
-            monthChanged = true;
         logger.debug(&quot;Month set to &quot;+month);
     }
 
@@ -709,9 +697,6 @@
         this.project = project;
     }
 
-    public int getCoordinateSystem() {
-        return coordinateSystem;
-    }
 
     public void setTimeChoice(int choice) {
         this.timeChoice = choice;
@@ -788,14 +773,12 @@
         if (isNotEmpty(village))
             allNull = false;
         
-        for (int i = 0; i &lt; taxonList.size(); i++) {
-            if (isNotEmpty(taxonList.get(i)))
-                allNull = false;
-        }
-            
-        if (isNotEmpty(taxonOriginal))
-            allNull = false;
-    
+        if (taxonList != null)
+            for (int i = 0; i &lt; taxonList.size(); i++) {
+                if (isNotEmpty(taxonList.get(i)))
+                    allNull = false;
+            }
+                
         if (isNotEmpty(localityDescription))
             allNull = false;
         
@@ -803,6 +786,9 @@
         if (isNotEmpty(habitatNote))
             allNull = false;
         
+        if (isNotEmpty(occurrenceNote))
+            allNull = false;
+        
         if (isNotEmpty(territoryName))
             allNull = false;
         
@@ -873,6 +859,7 @@
     }
     
     public SelectQuery constructQuery() {
+        DBLayerUtils dlu = new DBLayerUtils(database);
         SelectQuery sq = null;
             //FIXME:
             try {
@@ -888,14 +875,216 @@
                 sq.createAlias(&quot;habitat.&quot;+Habitat.TERRITORY,&quot;territory&quot;);
                 sq.addOrder(PlantloreConstants.DIRECT_ASC, &quot;occ.&quot;+Occurrence.YEARCOLLECTED); //setridit podle roku
                 sq.addRestriction(PlantloreConstants.RESTR_NE, &quot;occ.&quot;+Occurrence.DELETED, null, 1, null);
+                
+                for (int i=0; i &lt; columns.length; i++) {
+                    switch (columns[i].type) {
+                        case AUTHOR:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;author.&quot;+Author.WHOLENAME);
+                            break;
+                        case HABITAT_ALTITUDE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.ALTITUDE);
+                            break;
+                        case HABITAT_COUNTRY:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.COUNTRY);
+                            break;
+                        case HABITAT_DESCRIPTION:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.DESCRIPTION);                    
+                            break;
+                        case HABITAT_LATITUDE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.LATITUDE);
+                            break;
+                        case HABITAT_LONGITUDE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.LONGITUDE);
+                            break;
+                        case HABITAT_NEAREST_VILLAGE_NAME:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;vill.&quot;+Village.NAME);
+                            break;
+                        case HABITAT_NOTE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.NOTE);
+                            break;
+                        case HABITAT_QUADRANT:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;habitat.&quot;+Habitat.QUADRANT);
+                            break;
+                        case METADATA_DATASETTITLE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;metadata.&quot;+Metadata.DATASETTITLE);
+                            break;
+                        case NUMBER:
+                            break;
+                        case OCCURRENCE_DATASOURCE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.DATASOURCE);
+                            break;
+                        case OCCURRENCE_DAYCOLLECTED:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.DAYCOLLECTED);
+                            break;
+                        case OCCURRENCE_HERBARIUM:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.HERBARIUM);
+                            break;
+                        case OCCURRENCE_ID:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.ID);                            
+                            break;
+                        case OCCURRENCE_MONTHCOLLECTED:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.MONTHCOLLECTED);
+                            break;
+                        case OCCURRENCE_NOTE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.NOTE);
+                            break;
+                        case OCCURRENCE_TIMECOLLECTED:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.TIMECOLLECTED);
+                            break;
+                        case OCCURRENCE_YEARCOLLECTED:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;occ.&quot;+Occurrence.YEARCOLLECTED);
+                            break;
+                        case PHYTOCHORION_CODE:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;phyt.&quot;+Phytochorion.CODE);                    
+                            break;
+                        case PHYTOCHORION_NAME:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;phyt.&quot;+Phytochorion.NAME);                    
+                            break;
+                        case PLANT_TAXON:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;plant.&quot;+Plant.TAXON);
+                            break;
+                        case PUBLICATION_COLLECTIONNAME:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;publication.&quot;+Publication.REFERENCECITATION);
+                            break;
+                        case SELECTION:
+                            break;
+                        case TERRITORY_NAME:
+                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,&quot;territory.&quot;+Territory.NAME);
+                            break;
+                        default:                                                
+                    }
+                }
+                
+                if (isNotEmpty(village)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.NEARESTVILLAGE,null,dlu.getObjectFor(village.getSecond(),Village.class),null);
+                }
+                
+                int notEmpty = 0;
+                for (int i = 0; i &lt; authorList.size(); i++) {
+                    Pair&lt;Pair&lt;String,Integer&gt;,String&gt; authorPair = authorList.get(i);
+                    if (isNotEmpty(authorPair.getFirst()))
+                        notEmpty++;
+                    if (isNotEmpty(authorPair.getSecond()))
+                        notEmpty++;
+                }
+                
+                if (notEmpty &gt; 0) {
+                    Object[] args = new Object[notEmpty*4];
+                    int conditionNumber = 0;
+                    for (int i = 0; i &lt; authorList.size(); i++) {
+                        Pair&lt;Pair&lt;String,Integer&gt;,String&gt; authorPair = authorList.get(i);
+                        if (isNotEmpty(authorPair.getFirst())) {
+                            args[4*conditionNumber] = PlantloreConstants.RESTR_EQ;
+                            args[4*conditionNumber+1] = AuthorOccurrence.AUTHOR;
+                            args[4*conditionNumber+2] = null;
+                            args[4*conditionNumber+3] = dlu.getObjectFor(lookupPlant(authorPair.getSecond()),Author.class);
+                            conditionNumber++;
+                        }
+                        if (isNotEmpty(authorPair.getSecond())) {
+                            args[4*conditionNumber] = PlantloreConstants.RESTR_LIKE;
+                            args[4*conditionNumber+1] = AuthorOccurrence.ROLE;
+                            args[4*conditionNumber+2] = null;
+                            args[4*conditionNumber+3] = authorPair.getSecond();
+                            conditionNumber++;
+                        }
+                    }
+                    sq.addOrRestriction(args);
+                }
+
+                notEmpty = 0;
+                if (taxonList != null)
+                    for (int i = 0; i &lt; taxonList.size(); i++) {
+                        if (isNotEmpty(taxonList.get(i)))
+                            notEmpty++;
+                    }
+                
+                if (notEmpty &gt; 0) {
+                    Object[] args = new Object[notEmpty*4];
+                    for (int i = 0; i &lt; taxonList.size(); i++) {
+                        String taxon = taxonList.get(i);
+                        if (isNotEmpty(taxon)) {
+                            args[4*i] = PlantloreConstants.RESTR_EQ;
+                            args[4*i+1] = &quot;occ.&quot;+Occurrence.PLANT;
+                            args[4*i+2] = null;
+                            args[4*i+3] = dlu.getObjectFor(lookupPlant(taxon),Plant.class);
+                        }
+                    }
+                    sq.addOrRestriction(args);
+                }
+                if (isNotEmpty(localityDescription)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_LIKE,&quot;habitat.&quot;+Habitat.DESCRIPTION,null,&quot;%&quot;+localityDescription+&quot;%&quot;,null);
+                }
+                
+                if (isNotEmpty(occurrenceNote)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_LIKE,&quot;occ.&quot;+Occurrence.NOTE,null,&quot;%&quot;+occurrenceNote+&quot;%&quot;,null);
+                }
+                
+                if (isNotEmpty(habitatNote)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_LIKE,&quot;habitat.&quot;+Habitat.NOTE,null,&quot;%&quot;+habitatNote+&quot;%&quot;,null);
+                }
+                
+                if (isNotEmpty(territoryName)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.TERRITORY,null,dlu.getObjectFor(territoryName.getSecond(),Territory.class),null);
+                }
+                
+                if (isNotEmpty(phytName)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.PHYTOCHORION,null,dlu.getObjectFor(phytName.getSecond(),Phytochorion.class),null);
+                }
+                
+                if (isNotEmpty(phytCountry)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.COUNTRY,null,phytCountry,null);
+                }
+                
+                if (isNotEmpty(quadrant)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.QUADRANT,null,quadrant,null);
+                }
+                
+                if (isNotEmpty(altitude)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.ALTITUDE,null,altitude,null);
+                }
+                
+                if (isNotEmpty(longitude)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.LONGITUDE,null,longitude,null);
+                }
+
+                if (isNotEmpty(latitude)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;habitat.&quot;+Habitat.LATITUDE,null,latitude,null);
+                }
+
+                if (isNotEmpty(source)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;occ.&quot;+Occurrence.DATASOURCE,null,source,null);
+                }
+                
+                if (isNotEmpty(publication)) {
+                    //FIXME: mozna pridat addOrRestriction na vsechny relevantni sloupky Publication
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;occ.&quot;+Occurrence.PUBLICATION,null,dlu.getObjectFor(publication.getSecond(),Publication.class),null);
+                }
+                
+                if (isNotEmpty(herbarium)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;occ.&quot;+Occurrence.HERBARIUM,null,herbarium,null);
+                }
+                
+                if (isNotEmpty(project)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;occ.&quot;+Occurrence.METADATA,null,dlu.getObjectFor(project.getSecond(),Metadata.class),null);
+                }
+                
                 if (timeChoice == INTERVAL &amp;&amp; isNotEmpty(fromDate)) {
                     ArrayList a = new ArrayList();
                     a.add(fromDate);
                     a.add(toDate);
                     sq.addRestriction(PlantloreConstants.RESTR_BETWEEN,&quot;occ.&quot;+Occurrence.ISODATETIMEBEGIN,null,null,a);
                 }
+                
+                if (timeChoice == MONTH &amp;&amp; isNotEmpty(month)) {
+                    sq.addRestriction(PlantloreConstants.RESTR_EQ,&quot;occ.&quot;+Occurrence.MONTHCOLLECTED,null,month,null);
+                }
+                
                 int resultId = database.executeQuery(sq);
-                System.out.println(&quot;Number of results: &quot;+database.getNumRows(resultId));
+                this.newResultId = resultId;
+                logger.debug(&quot;Created new query. Number of results: &quot;+database.getNumRows(resultId));
+                //let the SearchBridge in AppCoreCtrl know that new result is there
+                setChanged(); 
+                notifyObservers(resultId);
             } catch (RemoteException ex) {                
                 ex.printStackTrace();
             } catch (DBLayerException ex) {
@@ -904,6 +1093,32 @@
         return sq;
     }
     
+    public void clear() {
+        clearAuthors();
+    
+        village = null;
+        taxonList = null;
+        localityDescription = null;
+        year = null;
+        habitatNote = null;
+        occurrenceNote = null;
+        territoryName = null;
+        phytName = null;
+        phytCode = null;
+        phytCountry = null;
+        quadrant = null;
+        altitude = null;
+        longitude = null;
+        latitude = null;
+        source = null;
+        publication = null;
+        herbarium = null;
+        project = null;
+        month  = null;
+        fromDate = null;
+        toDate = null;
+    }
+    
     public void clearAuthors() {
         authorList = new ArrayList&lt;Pair&lt;Pair&lt;String,Integer&gt;,String&gt;&gt;();
         resultRevision = new ArrayList&lt;String&gt;();        
@@ -969,6 +1184,15 @@
             logger.debug(&quot;Taxon list contains plant #&quot;+taxonList.get(i)+&quot;#&quot;);
         }
     }
+
+    public int getNewResultId() {
+        return newResultId;
+    }
+
+    public void setColumns(Column[] columns) {
+        logger.debug(&quot;Setting columns.&quot;);
+        this.columns = columns;
+    }
 }
 
 

Modified: trunk/src/net/sf/plantlore/client/SearchCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/SearchCtrl.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/SearchCtrl.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -270,12 +270,6 @@
         }
     }//MonthListener
     
-    class YearListener implements ChangeListener {
-        public void stateChanged(ChangeEvent e) {
-            JSpinner s = (JSpinner) e.getSource();
-            model.setYear((Integer)s.getValue());
-        }
-    }//YearListener
     
     class AltitudeListener implements PropertyChangeListener {
         public void propertyChange(PropertyChangeEvent evt) {

Modified: trunk/src/net/sf/plantlore/client/SearchView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/SearchView.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/SearchView.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -758,24 +758,26 @@
     }
 
     public void update(Observable o, Object arg) {
-        String s = ((Pair&lt;String,Integer&gt;)arg).getFirst();
-        int i = ((Pair&lt;String,Integer&gt;)arg).getSecond(); 
-        if (s.equals(&quot;updateCode&quot;))
-            phytCodeCombo.setSelectedItem(model.getPhytCode());
-        if (s.equals(&quot;updateName&quot;))
-            phytNameCombo.setSelectedItem(model.getPhytName());
-        if (s.equals(&quot;addAuthorRow&quot;)) {
-            tableModel.addRow();
-            /*
-            DefaultCellEditor dce = (DefaultCellEditor) authorTable.getCellEditor(0,0);
-            Object o = dce.getCellEditorValue();
-             */            
-        }             
-        if (s.equals(&quot;removeAuthorRow&quot;)) {
-            tableModel.removeRow(i);
-            //unfortunately have to set up the editors and renderers again because of the
-            //fireTableStructureChanged() in the tableModel.removeRow() ... :-/
-            //initAuthorTable();            
+        if (arg != null &amp;&amp; arg instanceof Pair) {
+            String s = ((Pair&lt;String,Integer&gt;)arg).getFirst();
+            int i = ((Pair&lt;String,Integer&gt;)arg).getSecond(); 
+            if (s.equals(&quot;updateCode&quot;))
+                phytCodeCombo.setSelectedItem(model.getPhytCode());
+            if (s.equals(&quot;updateName&quot;))
+                phytNameCombo.setSelectedItem(model.getPhytName());
+            if (s.equals(&quot;addAuthorRow&quot;)) {
+                tableModel.addRow();
+                /*
+                DefaultCellEditor dce = (DefaultCellEditor) authorTable.getCellEditor(0,0);
+                Object o = dce.getCellEditorValue();
+                 */            
+            }             
+            if (s.equals(&quot;removeAuthorRow&quot;)) {
+                tableModel.removeRow(i);
+                //unfortunately have to set up the editors and renderers again because of the
+                //fireTableStructureChanged() in the tableModel.removeRow() ... :-/
+                //initAuthorTable();            
+            }
         }
     }
         

Modified: trunk/src/net/sf/plantlore/client/Settings.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Settings.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/Settings.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -61,6 +61,7 @@
      */
     public void setLanguage(String language) {
         this.language = language;
+        logger.debug(&quot;Language set to &quot;+language);
     }
 
     /** Stores all settings using the Preferences class.

Modified: trunk/src/net/sf/plantlore/client/SettingsCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/SettingsCtrl.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/SettingsCtrl.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -16,6 +16,7 @@
 import java.util.Observable;
 import javax.swing.JRadioButton;
 import javax.swing.JToggleButton;
+import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
 
 /** Controller for the Settings MVC
@@ -34,10 +35,12 @@
         logger = Logger.getLogger(this.getClass().getPackage().getName());        
         this.model = model;
         this.view = view;
-        view.addListener(new SettingsListener());
-        view.addIconListener(new IconListener());
-        view.addLanguagesListener(new LanguagesListener());
-        view.addButtonsListener(new ButtonsListener());
+        view.okButton.addActionListener(new ButtonListener());
+        view.cancelButton.addActionListener(new ButtonListener());
+        view.helpButton.addActionListener(new ButtonListener());
+        view.englishRadioButton.addActionListener(new LanguagesListener());
+        view.czechRadioButton.addActionListener(new LanguagesListener());
+        view.defaultRadioButton.addActionListener(new LanguagesListener());
     }
     
     /** Handles clicks on languages radio buttons.
@@ -45,23 +48,16 @@
      * Stores the currently selected language into Settings model.
      * Reacts only to itemEvents with SECELTED state change set.
      */
-    class LanguagesListener implements ItemListener {
-        public void itemStateChanged(ItemEvent itemEvent)
-        {
-            //we're ineterested only in what button was selected
-            if (itemEvent.getStateChange() == itemEvent.DESELECTED)
-                return;
-            
-            if (itemEvent.getStateChange() == itemEvent.SELECTED) {
-                String s;
-                JRadioButton b;
-                b = (JRadioButton) itemEvent.getItem();
-                s = b.getActionCommand();
-                model.setLanguage(s);
-                return;
+    class LanguagesListener implements ActionListener {
+        public void actionPerformed(ActionEvent e) {
+            String cmd = e.getActionCommand();
+            if (cmd.equals(&quot;ENGLISH&quot;)) {
+                model.setLanguage(L10n.ENGLISH);
             }
-            
-            logger.error(&quot;ItemEvent in LanguagesListener was neither of: SELECTED, DESELECTED.&quot;);
+            if (cmd.equals(&quot;CZECH&quot;)) 
+                model.setLanguage(L10n.CZECH);
+            if (cmd.equals(&quot;DEFAULT&quot;))
+                model.setLanguage(L10n.DEFAULT_LANGUAGE);
         }
     }
     
@@ -71,7 +67,7 @@
      * On Cancel just hides the view.
      * On Help should call help.
      */
-    class ButtonsListener implements ActionListener {
+    class ButtonListener implements ActionListener {
         public void actionPerformed(ActionEvent actionEvent)
         {
             String s = actionEvent.getActionCommand();
@@ -86,49 +82,5 @@
         }
     }
     
-    /** JToggleButtons listener.
-     *
-     * Changes the view's mainPane.
-     */
-    class IconListener implements ActionListener {
-        public void actionPerformed(ActionEvent actionEvent)
-        {
-            view.setMainPane((JToggleButton)actionEvent.getSource());
-        } 
-    }
     
-    /** Settings dialog listener.
-     * Only logs window activation and deactivation now.
-     */
-    class SettingsListener implements WindowListener {
-        public void windowOpened(WindowEvent windowEvent)
-        {
-        }
-
-        public void windowClosing(WindowEvent windowEvent)
-        {
-        }
-
-        public void windowClosed(WindowEvent windowEvent)
-        {
-        }
-
-        public void windowIconified(WindowEvent windowEvent)
-        {
-        }
-
-        public void windowDeiconified(WindowEvent windowEvent)
-        {
-        }
-
-        public void windowActivated(WindowEvent windowEvent)
-        {
-            logger.info(&quot;Settings activated&quot;);
-        }
-
-        public void windowDeactivated(WindowEvent windowEvent)
-        {
-            logger.info(&quot;Settings deactivated&quot;);
-        }        
-    }
 }

Added: trunk/src/net/sf/plantlore/client/SettingsView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/SettingsView.form	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/SettingsView.form	2006-05-12 22:30:55 UTC (rev 263)
@@ -0,0 +1,364 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.3&quot; type=&quot;org.netbeans.modules.form.forminfo.JDialogFormInfo&quot;&gt;
+  &lt;NonVisualComponents&gt;
+    &lt;Component class=&quot;javax.swing.ButtonGroup&quot; name=&quot;languagesButtonGroup&quot;&gt;
+    &lt;/Component&gt;
+  &lt;/NonVisualComponents&gt;
+  &lt;SyntheticProperties&gt;
+    &lt;SyntheticProperty name=&quot;formSizePolicy&quot; type=&quot;int&quot; value=&quot;1&quot;/&gt;
+  &lt;/SyntheticProperties&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;helpButton&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace pref=&quot;334&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;cancelButton&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;okButton&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+          &lt;Component id=&quot;jTabbedPane1&quot; alignment=&quot;0&quot; pref=&quot;589&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;Component id=&quot;jTabbedPane1&quot; pref=&quot;314&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;okButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;cancelButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Container class=&quot;javax.swing.JTabbedPane&quot; name=&quot;jTabbedPane1&quot;&gt;
+
+      &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout&quot;/&gt;
+      &lt;SubComponents&gt;
+        &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel1&quot;&gt;
+          &lt;Constraints&gt;
+            &lt;Constraint layoutClass=&quot;org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout&quot; value=&quot;org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription&quot;&gt;
+              &lt;JTabbedPaneConstraints tabName=&quot;tab1&quot;&gt;
+                &lt;Property name=&quot;tabTitle&quot; type=&quot;java.lang.String&quot; value=&quot;tab1&quot;/&gt;
+              &lt;/JTabbedPaneConstraints&gt;
+            &lt;/Constraint&gt;
+          &lt;/Constraints&gt;
+
+          &lt;Layout&gt;
+            &lt;DimensionLayout dim=&quot;0&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel2&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+            &lt;/DimensionLayout&gt;
+            &lt;DimensionLayout dim=&quot;1&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;141&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+            &lt;/DimensionLayout&gt;
+          &lt;/Layout&gt;
+          &lt;SubComponents&gt;
+            &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel2&quot;&gt;
+              &lt;Properties&gt;
+                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.TitledBorderInfo&quot;&gt;
+                    &lt;TitledBorder title=&quot;Language&quot;/&gt;
+                  &lt;/Border&gt;
+                &lt;/Property&gt;
+              &lt;/Properties&gt;
+
+              &lt;Layout&gt;
+                &lt;DimensionLayout dim=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;englishRadioButton&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;czechRadioButton&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;defaultRadioButton&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;/Group&gt;
+                          &lt;EmptySpace pref=&quot;475&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;/Group&gt;
+                  &lt;/Group&gt;
+                &lt;/DimensionLayout&gt;
+                &lt;DimensionLayout dim=&quot;1&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;englishRadioButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;czechRadioButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;defaultRadioButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace pref=&quot;43&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;/Group&gt;
+                  &lt;/Group&gt;
+                &lt;/DimensionLayout&gt;
+              &lt;/Layout&gt;
+              &lt;SubComponents&gt;
+                &lt;Component class=&quot;javax.swing.JRadioButton&quot; name=&quot;englishRadioButton&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;buttonGroup&quot; type=&quot;javax.swing.ButtonGroup&quot; editor=&quot;org.netbeans.modules.form.RADComponent$ButtonGroupPropertyEditor&quot;&gt;
+                      &lt;ComponentRef name=&quot;languagesButtonGroup&quot;/&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;English&quot;/&gt;
+                    &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                      &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
+                        &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
+                      &lt;/Border&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
+                      &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
+                    &lt;/Property&gt;
+                  &lt;/Properties&gt;
+                  &lt;AuxValues&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;englishRadioButton.setActionCommand(&quot;ENGLISH&quot;);&quot;/&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+                  &lt;/AuxValues&gt;
+                &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JRadioButton&quot; name=&quot;czechRadioButton&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;buttonGroup&quot; type=&quot;javax.swing.ButtonGroup&quot; editor=&quot;org.netbeans.modules.form.RADComponent$ButtonGroupPropertyEditor&quot;&gt;
+                      &lt;ComponentRef name=&quot;languagesButtonGroup&quot;/&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Czech&quot;/&gt;
+                    &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                      &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
+                        &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
+                      &lt;/Border&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
+                      &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
+                    &lt;/Property&gt;
+                  &lt;/Properties&gt;
+                  &lt;AuxValues&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;czechRadioButton.setActionCommand(&quot;CZECH&quot;);&quot;/&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+                  &lt;/AuxValues&gt;
+                &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JRadioButton&quot; name=&quot;defaultRadioButton&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;buttonGroup&quot; type=&quot;javax.swing.ButtonGroup&quot; editor=&quot;org.netbeans.modules.form.RADComponent$ButtonGroupPropertyEditor&quot;&gt;
+                      &lt;ComponentRef name=&quot;languagesButtonGroup&quot;/&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Default&quot;/&gt;
+                    &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                      &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.EmptyBorderInfo&quot;&gt;
+                        &lt;EmptyBorder bottom=&quot;0&quot; left=&quot;0&quot; right=&quot;0&quot; top=&quot;0&quot;/&gt;
+                      &lt;/Border&gt;
+                    &lt;/Property&gt;
+                    &lt;Property name=&quot;margin&quot; type=&quot;java.awt.Insets&quot; editor=&quot;org.netbeans.beaninfo.editors.InsetsEditor&quot;&gt;
+                      &lt;Insets value=&quot;[0, 0, 0, 0]&quot;/&gt;
+                    &lt;/Property&gt;
+                  &lt;/Properties&gt;
+                  &lt;AuxValues&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;defaultRadioButton.setActionCommand(&quot;DEFAULT&quot;);&quot;/&gt;
+                    &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+                  &lt;/AuxValues&gt;
+                &lt;/Component&gt;
+              &lt;/SubComponents&gt;
+            &lt;/Container&gt;
+          &lt;/SubComponents&gt;
+        &lt;/Container&gt;
+        &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel3&quot;&gt;
+          &lt;Constraints&gt;
+            &lt;Constraint layoutClass=&quot;org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout&quot; value=&quot;org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription&quot;&gt;
+              &lt;JTabbedPaneConstraints tabName=&quot;tab2&quot;&gt;
+                &lt;Property name=&quot;tabTitle&quot; type=&quot;java.lang.String&quot; value=&quot;tab2&quot;/&gt;
+              &lt;/JTabbedPaneConstraints&gt;
+            &lt;/Constraint&gt;
+          &lt;/Constraints&gt;
+
+          &lt;Layout&gt;
+            &lt;DimensionLayout dim=&quot;0&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel4&quot; pref=&quot;560&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+            &lt;/DimensionLayout&gt;
+            &lt;DimensionLayout dim=&quot;1&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel4&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+            &lt;/DimensionLayout&gt;
+          &lt;/Layout&gt;
+          &lt;SubComponents&gt;
+            &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel4&quot;&gt;
+              &lt;Properties&gt;
+                &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+                  &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.TitledBorderInfo&quot;&gt;
+                    &lt;TitledBorder title=&quot;Displayed columns&quot;/&gt;
+                  &lt;/Border&gt;
+                &lt;/Property&gt;
+              &lt;/Properties&gt;
+
+              &lt;Layout&gt;
+                &lt;DimensionLayout dim=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;102&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;availableLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jScrollPane1&quot; linkSize=&quot;5&quot; min=&quot;-2&quot; pref=&quot;156&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;/Group&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;45&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;removeButton&quot; linkSize=&quot;2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;addButton&quot; linkSize=&quot;2&quot; min=&quot;-2&quot; pref=&quot;80&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;/Group&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;53&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;selectedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;jScrollPane2&quot; linkSize=&quot;5&quot; min=&quot;-2&quot; pref=&quot;136&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;/Group&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;65&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;/Group&gt;
+                  &lt;/Group&gt;
+                &lt;/DimensionLayout&gt;
+                &lt;DimensionLayout dim=&quot;1&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                                  &lt;Component id=&quot;addButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;removeButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;/Group&gt;
+                              &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                                  &lt;Component id=&quot;availableLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;jScrollPane1&quot; min=&quot;-2&quot; pref=&quot;194&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;/Group&gt;
+                              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                                  &lt;Component id=&quot;selectedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;194&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;/Group&gt;
+                          &lt;/Group&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;/Group&gt;
+                  &lt;/Group&gt;
+                &lt;/DimensionLayout&gt;
+              &lt;/Layout&gt;
+              &lt;SubComponents&gt;
+                &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane1&quot;&gt;
+                  &lt;AuxValues&gt;
+                    &lt;AuxValue name=&quot;autoScrollPane&quot; type=&quot;java.lang.Boolean&quot; value=&quot;true&quot;/&gt;
+                  &lt;/AuxValues&gt;
+
+                  &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
+                  &lt;SubComponents&gt;
+                    &lt;Component class=&quot;javax.swing.JList&quot; name=&quot;availableList&quot;&gt;
+                      &lt;Properties&gt;
+                        &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ListModel&quot; editor=&quot;org.netbeans.modules.form.editors2.ListModelEditor&quot;&gt;
+                          &lt;StringArray count=&quot;0&quot;/&gt;
+                        &lt;/Property&gt;
+                      &lt;/Properties&gt;
+                      &lt;AuxValues&gt;
+                        &lt;AuxValue name=&quot;JavaCodeGenerator_CreateCodeCustom&quot; type=&quot;java.lang.String&quot; value=&quot;new JList(new DefaultListModel());&quot;/&gt;
+                        &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;DefaultListModel lm = (DefaultListModel)availableList.getModel();&amp;#xa;Column.Type[] types = Column.Type.values();&amp;#xa;for (int i=0; i &lt; types.length; i++)&amp;#xa;    lm.addElement(types[i]);&quot;/&gt;
+                      &lt;/AuxValues&gt;
+                    &lt;/Component&gt;
+                  &lt;/SubComponents&gt;
+                &lt;/Container&gt;
+                &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane2&quot;&gt;
+                  &lt;AuxValues&gt;
+                    &lt;AuxValue name=&quot;autoScrollPane&quot; type=&quot;java.lang.Boolean&quot; value=&quot;true&quot;/&gt;
+                  &lt;/AuxValues&gt;
+
+                  &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
+                  &lt;SubComponents&gt;
+                    &lt;Component class=&quot;javax.swing.JList&quot; name=&quot;selectedList&quot;&gt;
+                      &lt;Properties&gt;
+                        &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ListModel&quot; editor=&quot;org.netbeans.modules.form.editors2.ListModelEditor&quot;&gt;
+                          &lt;StringArray count=&quot;0&quot;/&gt;
+                        &lt;/Property&gt;
+                      &lt;/Properties&gt;
+                    &lt;/Component&gt;
+                  &lt;/SubComponents&gt;
+                &lt;/Container&gt;
+                &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;availableLabel&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Available:&quot;/&gt;
+                  &lt;/Properties&gt;
+                &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;selectedLabel&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Displayed:&quot;/&gt;
+                  &lt;/Properties&gt;
+                &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;addButton&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Add&quot;/&gt;
+                  &lt;/Properties&gt;
+                &lt;/Component&gt;
+                &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;removeButton&quot;&gt;
+                  &lt;Properties&gt;
+                    &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Remove&quot;/&gt;
+                  &lt;/Properties&gt;
+                &lt;/Component&gt;
+              &lt;/SubComponents&gt;
+            &lt;/Container&gt;
+          &lt;/SubComponents&gt;
+        &lt;/Container&gt;
+      &lt;/SubComponents&gt;
+    &lt;/Container&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;cancelButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Cancel&quot;/&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;cancelButton.setActionCommand(&quot;CANCEL&quot;);&quot;/&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Ok&quot;/&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;okButton.setActionCommand(&quot;OK&quot;);&quot;/&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Help&quot;/&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;helpButton.setActionCommand(&quot;HELP&quot;);&quot;/&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Modified: trunk/src/net/sf/plantlore/client/SettingsView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/SettingsView.java	2006-05-12 09:52:01 UTC (rev 262)
+++ trunk/src/net/sf/plantlore/client/SettingsView.java	2006-05-12 22:30:55 UTC (rev 263)
@@ -1,334 +1,269 @@
 /*
- * SettingsView.java
+ * SearchView2.java
  *
- * Created on 17. leden 2006, 17:27
- *
+ * Created on 12. kv&#283;ten 2006, 16:50
  */
 
 package net.sf.plantlore.client;
 
-import java.awt.BorderLayout;
-import java.awt.Color;
-import java.awt.FlowLayout;
-import java.awt.GridBagConstraints;
-import java.awt.GridBagLayout;
-import java.awt.event.ActionListener;
-import java.awt.event.ItemListener;
-import java.awt.event.WindowListener;
-import java.util.Enumeration;
-import java.util.HashMap;
-import java.util.Observable;
-import java.util.Observer;
-import javax.swing.AbstractButton;
-import javax.swing.BorderFactory;
-import javax.swing.ButtonGroup;
-import javax.swing.ImageIcon;
-import javax.swing.JButton;
-import javax.swing.JDialog;
-import javax.swing.JLabel;
-import javax.swing.JPanel;
-import javax.swing.JRadioButton;
-import javax.swing.JToggleButton;
-import javax.swing.SpringLayout;
-import javax.swing.SwingConstants;
-import net.sf.plantlore.common.ComponentAdjust;
-import net.sf.plantlore.common.SpringUtilities;
-import net.sf.plantlore.common.StatusBarManager;
-import net.sf.plantlore.l10n.L10n;
+import javax.swing.DefaultListModel;
+import javax.swing.JList;
 
-/** View for the Settings MVC
+/**
  *
- * @author Jakub
+ * @author  fraktalek
  */
-public class SettingsView extends JDialog implements Observer 
-{
-    private Settings model;
-    /** The panel containing toggle buttons on the left side of this dialog. */
-    private JPanel iconsPane;
-    /** This panel contains the switchable right side of the dialog. */
-    private JPanel mainPane;
+public class SettingsView extends javax.swing.JDialog {
+    Settings model;
     
-    private JPanel buttonsPane;
     
-    /** Language settings. */
-    private JPanel languagesPane;
-    /** Other settings. */
-    private JPanel otherPane;
-
-    /** Toggle button for language settings. */
-    private JToggleButton language;
-    /** Toggle button for other settings */
-    private JToggleButton other;
-    
-    /** This maps the buttons to their corresponding right side panels. */
-    private HashMap&lt;JToggleButton, JPanel&gt; panels;
-
-    private JButton okButton;
-    private JButton cancelButton;
-    private JButton helpButton;
-    
-    private ButtonGroup langGroup;
-    
-    private StatusBarManager sbm;
-    
-    /** Creates a new instance of SettingsView */
-    public SettingsView(Settings model, StatusBarManager sbm)
-    {
+    /** Creates new form SearchView2 */
+    public SettingsView(java.awt.Frame parent, boolean modal, Settings model) {
+        super(parent, modal);
         this.model = model;
-        this.sbm = sbm;
-        init();
+        initComponents();
     }
-
-    /** The top initializing method.
-     *
-     * Essentially constructs the whole dialog layout.
-     *
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
      */
-    private void init()
-    {
-        initDialog();
-        panels = new HashMap&lt;JToggleButton, JPanel&gt;();
-        panels.put(language, languagesPane);
-        panels.put(other, otherPane);
-    }
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot; Generated Code &quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+        languagesButtonGroup = new javax.swing.ButtonGroup();
+        jTabbedPane1 = new javax.swing.JTabbedPane();
+        jPanel1 = new javax.swing.JPanel();
+        jPanel2 = new javax.swing.JPanel();
+        englishRadioButton = new javax.swing.JRadioButton();
+        czechRadioButton = new javax.swing.JRadioButton();
+        defaultRadioButton = new javax.swing.JRadioButton();
+        jPanel3 = new javax.swing.JPanel();
+        jPanel4 = new javax.swing.JPanel();
+        jScrollPane1 = new javax.swing.JScrollPane();
+        availableList = new JList(new DefaultListModel());
+        jScrollPane2 = new javax.swing.JScrollPane();
+        selectedList = new javax.swing.JList();
+        availableLabel = new javax.swing.JLabel();
+        selectedLabel = new javax.swing.JLabel();
+        addButton = new javax.swing.JButton();
+        removeButton = new javax.swing.JButton();
+        cancelButton = new javax.swing.JButton();
+        okButton = new javax.swing.JButton();
+        helpButton = new javax.swing.JButton();
 
-    /** Constructs the top dialog layout.
-     *
-     */
-    private void initDialog() 
-    {
-        setTitle(L10n.getString(&quot;Settings&quot;));
-        setSize(500,300);
-        setVisible(false);
-        
-        initIconsPane();
-        initButtonsPane();
-        initLanguagesPane();
-        initOtherPane();
+        jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(&quot;Language&quot;));
+        languagesButtonGroup.add(englishRadioButton);
+        englishRadioButton.setText(&quot;English&quot;);
+        englishRadioButton.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
+        englishRadioButton.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        englishRadioButton.setActionCommand(&quot;ENGLISH&quot;);
 
-        mainPane = new JPanel();
-        mainPane.add(languagesPane);
-        
-        setLayout(new GridBagLayout());
-        GridBagConstraints gbc = new GridBagConstraints();
-        gbc.gridx = 0;
-        gbc.gridy = 0;
-        gbc.anchor = GridBagConstraints.NORTHWEST;
-        gbc.fill = GridBagConstraints.VERTICAL;
-        gbc.weightx = 0;
-        gbc.weighty = 1;
-        add(iconsPane,gbc);
-        gbc.gridx = 1;
-        gbc.weighty = 1;
-        gbc.weightx = 1;
-        gbc.fill = GridBagConstraints.BOTH;
-        add(mainPane, gbc);
-        gbc.gridy = 1;
-        gbc.gridwidth = 2;
-        gbc.weighty = 0;
-        gbc.anchor = GridBagConstraints.SOUTHEAST;
-        add(buttonsPane, gbc);
-    }
+        languagesButtonGroup.add(czechRadioButton);
+        czechRadioButton.setText(&quot;Czech&quot;);
+        czechRadioButton.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
+        czechRadioButton.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        czechRadioButton.setActionCommand(&quot;CZECH&quot;);
 
-    public void update(Observable observable, Object object)
-    {
-    }
-    
-    /** Adds a listener to the whole window events.
-     *
-     */
-    public void addListener(WindowListener wl) 
-    {
-        addWindowListener(wl);
-    }
+        languagesButtonGroup.add(defaultRadioButton);
+        defaultRadioButton.setText(&quot;Default&quot;);
+        defaultRadioButton.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
+        defaultRadioButton.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        defaultRadioButton.setActionCommand(&quot;DEFAULT&quot;);
 
-    /** Sets the al listener to all toggle buttons on the left side.
-     *
-     */
-    public void addIconListener(ActionListener al)
-    {
-        language.addActionListener(al);
-        other.addActionListener(al);
-    }
-    
-    /** Sets a listener to all language radio buttons in langGroup.
-     *
-     */
-    public void addLanguagesListener(ItemListener il) 
-    {
-        Enumeration&lt;AbstractButton&gt; e = langGroup.getElements();
-        AbstractButton ab;
-        while (e.hasMoreElements()) {
-            ab = e.nextElement();
-            ab.addItemListener(il);
-        }
-    }
-    
-    /** Sets a listener to okButton, cancelButton and helpButton.
-     *
-     */
-    public void addButtonsListener(ActionListener al) {
-        okButton.addActionListener(al);
-        cancelButton.addActionListener(al);
-        helpButton.addActionListener(al);
-    }
-    
-    /** Switches the right side of the dialog.
-     * First removes all compoments from mainPane which should contain only one
-     * JPanel. Then adds a new JPanel to the mainPane by translating the JToggleButton
-     * received into a JPanel using panels HashMap.
-     * Finally it validates the whole dialog so that it repaints itself according
-     * to the new layout.
-     */
-    public void setMainPane(JToggleButton button) 
-    {
-        JPanel panel = (JPanel)panels.get(button);
-        mainPane.removeAll();
-        mainPane.add(panel);
-        
-        /* uuuuuuuuuuuuuuuuuaaaaaaaaaahhhhhhhhhhh!!!!!!!!!! :-(((
-         *this whole invalidate, setSize(0,0) is needed only when mainPane
-         *is being added into BorderLayout.CENTER or is added to GridBagLayout with
-         *GridBagConstraint.widthx set to 1 !!! why? whyyyyyy?!! what have I done to whom??!!
-         */
-        panel.invalidate();
-        mainPane.setSize(0,0);
-        mainPane.invalidate();
-        
-        validate();
-    }
-    
-    /** Constructs the left icons/JToggleButtons pane.
-     * Uses Sun's example code for SpringLayout to make the panel look nice - to
-     * make all the buttons the same size and distrubuted regurarly on the pane.
-     */
-    private void initIconsPane()
-    {
-        language = new JToggleButton();
-        other = new JToggleButton();
-        ButtonGroup group = new ButtonGroup();
-        SpringLayout sl = new SpringLayout();
-        
-        iconsPane = new JPanel();
-        iconsPane.setBackground(new Color(255,255,255));
-        iconsPane.setBorder(BorderFactory.createMatteBorder(1, 1, 1, 1, new Color(153, 153, 255)));
-        iconsPane.setLayout(sl);
+        org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
+        jPanel2.setLayout(jPanel2Layout);
+        jPanel2Layout.setHorizontalGroup(
+            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel2Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(englishRadioButton)
+                    .add(czechRadioButton)
+                    .add(defaultRadioButton))
+                .addContainerGap(475, Short.MAX_VALUE))
+        );
+        jPanel2Layout.setVerticalGroup(
+            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel2Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(englishRadioButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(czechRadioButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(defaultRadioButton)
+                .addContainerGap(43, Short.MAX_VALUE))
+        );
 
-        language.setText(L10n.getString(&quot;Languages&quot;));
-        language.setIcon(new ImageIcon(getClass().getResource(&quot;/net/sf/plantlore/client/resources/babelfish32.gif&quot;)));
-        language.setHorizontalTextPosition(SwingConstants.CENTER);
-        language.setVerticalTextPosition(SwingConstants.BOTTOM);
-        language.setSelected(true);
+        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
+        jPanel1.setLayout(jPanel1Layout);
+        jPanel1Layout.setHorizontalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addContainerGap())
+        );
+        jPanel1Layout.setVerticalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap(141, Short.MAX_VALUE))
+        );
+        jTabbedPane1.addTab(&quot;tab1&quot;, jPanel1);
 
-        other.setText(L10n.getString(&quot;Other&quot;));
-        other.setIcon(new ImageIcon(getClass().getResource(&quot;/net/sf/plantlore/client/resources/mysterio.gif&quot;)));
-        other.setHorizontalTextPosition(SwingConstants.CENTER);
-        other.setVerticalTextPosition(SwingConstants.BOTTOM);
-        
-        iconsPane.add(language);
-        iconsPane.add(other);
-        group.add(language);
-        group.add(other);
-        
-        sbm.add(language, L10n.getString(&quot;statusLangSettings&quot;));
-        sbm.add(other, L10n.getString(&quot;statusOtherSettings&quot;));
-        
-        SpringUtilities.makeGrid(iconsPane, 2, 1, 2, 2, 2, 2); 
-    }//initIconsPane();
+        jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(&quot;Displayed columns&quot;));
+        DefaultListModel lm = (DefaultListModel)availableList.getModel();
+        Column.Type[] types = Column.Type.values();
+        for (int i=0; i &lt; types.length; i++)
+        lm.addElement(types[i]);
+        jScrollPane1.setViewportView(availableList);
 
-    /** Constructs the Languages pane.
-     *
-     */
-    private void initLanguagesPane()
-    {
-        JPanel radioPane = new JPanel();
-        
-        langGroup = new ButtonGroup();
-        JRadioButton defaultLang = new JRadioButton(L10n.getString(&quot;defaultLang&quot;));
-        JRadioButton czech = new JRadioButton(L10n.getString(&quot;Czech&quot;));
-        JRadioButton english = new JRadioButton(L10n.getString(&quot;English&quot;));
+        jScrollPane2.setViewportView(selectedList);
 
-        // We'll set action commands so that we can use only one item listener
-        defaultLang.setActionCommand(L10n.DEFAULT_LANGUAGE);
-        czech.setActionCommand(L10n.CZECH);
-        english.setActionCommand(L10n.ENGLISH);
-        
-        
-        switch (model.getLanguage()) {
-            case Settings.DEFAULT_LANGUAGE:
-                defaultLang.setSelected(true);
-                break;
-            case Settings.CZECH:
-                czech.setSelected(true);
-                break;
-            case Settings.ENGLISH:
-                english.setSelected(true);
-                break;
-        }
-        
-        GridBagConstraints gbc = new GridBagConstraints();
-        radioPane.setLayout(new GridBagLayout());
-        gbc.gridx = 0;
-        gbc.gridy = 0;
-        gbc.anchor = GridBagConstraints.WEST;
-        radioPane.add(defaultLang, gbc);
-        gbc.gridy = 1;
-        radioPane.add(czech, gbc);
-        gbc.gridy = 2;
-        radioPane.add(english, gbc);
-        
-        langGroup.add(defaultLang);
-        langGroup.add(czech);
-        langGroup.add(english);
-        
-        
-        languagesPane = new JPanel(new BorderLayout());
-        JLabel label = new JLabel(L10n.getString(&quot;Languages&quot;));
-        languagesPane.add(label, BorderLayout.NORTH);
-        languagesPane.add(radioPane, BorderLayout.WEST);
-         
-    }//initLanguagesPane()
+        availableLabel.setText(&quot;Available:&quot;);
 
-    /** Constructs the Other pane.
-     *
-     */
-    private void initOtherPane()
-    {
-        otherPane = new JPanel();
-        otherPane.setLayout(new FlowLayout());
-        otherPane.add(new JLabel(&quot;Other&quot;));
-    }//initOtherPane()
+        selectedLabel.setText(&quot;Displayed:&quot;);
 
-    /** Constructs the buttons pane.
-     *
-     */
-    private void initButtonsPane()
-    {
-        ComponentAdjust ca = new ComponentAdjust();
-        
-        okButton = new JButton(L10n.getString(&quot;Ok&quot;));
-        cancelButton = new JButton(L10n.getString(&quot;Cancel&quot;));
-        helpButton = new JButton(L10n.getString(&quot;Help&quot;));
-        okButton.setActionCommand(&quot;OK&quot;);
+        addButton.setText(&quot;Add&quot;);
+
+        removeButton.setText(&quot;Remove&quot;);
+
+        org.jdesktop.layout.GroupLayout jPanel4Layout = new org.jdesktop.layout.GroupLayout(jPanel4);
+        jPanel4.setLayout(jPanel4Layout);
+        jPanel4Layout.setHorizontalGroup(
+            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel4Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(availableLabel)
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 156, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .add(45, 45, 45)
+                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(removeButton)
+                    .add(addButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .add(53, 53, 53)
+                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(selectedLabel)
+                    .add(jScrollPane2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 136, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .add(65, 65, 65))
+        );
+
+        jPanel4Layout.linkSize(new java.awt.Component[] {addButton, removeButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
+        jPanel4Layout.linkSize(new java.awt.Component[] {jScrollPane1, jScrollPane2}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
+        jPanel4Layout.setVerticalGroup(
+            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel4Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(jPanel4Layout.createSequentialGroup()
+                        .add(addButton)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(removeButton))
+                    .add(jPanel4Layout.createSequentialGroup()
+                        .add(availableLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 194, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel4Layout.createSequentialGroup()
+                        .add(selectedLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 194, Short.MAX_VALUE)))
+                .addContainerGap())
+        );
+
+        org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
+        jPanel3.setLayout(jPanel3Layout);
+        jPanel3Layout.setHorizontalGroup(
+            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel3Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 560, Short.MAX_VALUE)
+                .addContainerGap())
+        );
+        jPanel3Layout.setVerticalGroup(
+            jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel3Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addContainerGap())
+        );
+        jTabbedPane1.addTab(&quot;tab2&quot;, jPanel3);
+
+        cancelButton.setText(&quot;Cancel&quot;);
         cancelButton.setActionCommand(&quot;CANCEL&quot;);
+
+        okButton.setText(&quot;Ok&quot;);
+        okButton.setActionCommand(&quot;OK&quot;);
+
+        helpButton.setText(&quot;Help&quot;);
         helpButton.setActionCommand(&quot;HELP&quot;);
-        
-        ca.add(okButton);
-        ca.add(cancelButton);
-        ca.add(helpButton);
-        ca.setMaxWidth();
-        
-        buttonsPane = new JPanel();
-        buttonsPane.setLayout(new FlowLayout());
-        buttonsPane.add(okButton);
-        buttonsPane.add(cancelButton);
-        buttonsPane.add(helpButton);
-        
-        sbm.add(okButton, L10n.getString(&quot;statusOkButton&quot;));
-        sbm.add(cancelButton, L10n.getString(&quot;statusCancelButton&quot;));
-        sbm.add(helpButton, L10n.getString(&quot;statusHelpButton&quot;));
-    }
-    
-}// class SettingsView
 
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                .addContainerGap()
+                .add(helpButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 334, Short.MAX_VALUE)
+                .add(cancelButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(okButton)
+                .addContainerGap())
+            .add(jTabbedPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 589, Short.MAX_VALUE)
+        );
 
+        layout.linkSize(new java.awt.Component[] {cancelButton, helpButton, okButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                .add(jTabbedPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 314, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(helpButton)
+                    .add(okButton)
+                    .add(cancelButton))
+                .addContainerGap())
+        );
+        pack();
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+    
+    /**
+     * @param args the command line arguments
+     */
+    public static void main(String args[]) {
+        java.awt.EventQueue.invokeLater(new Runnable() {
+            public void run() {
+                new SettingsView(new javax.swing.JFrame(), true, new Settings()).setVisible(true);
+            }
+        });
+    }
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JButton addButton;
+    private javax.swing.JLabel availableLabel;
+    private javax.swing.JList availableList;
+    protected javax.swing.JButton cancelButton;
+    protected javax.swing.JRadioButton czechRadioButton;
+    protected javax.swing.JRadioButton defaultRadioButton;
+    protected javax.swing.JRadioButton englishRadioButton;
+    protected javax.swing.JButton helpButton;
+    private javax.swing.JPanel jPanel1;
+    private javax.swing.JPanel jPanel2;
+    private javax.swing.JPanel jPanel3;
+    private javax.swing.JPanel jPanel4;
+    private javax.swing.JScrollPane jScrollPane1;
+    private javax.swing.JScrollPane jScrollPane2;
+    private javax.swing.JTabbedPane jTabbedPane1;
+    private javax.swing.ButtonGroup languagesButtonGroup;
+    protected javax.swing.JButton okButton;
+    private javax.swing.JButton removeButton;
+    private javax.swing.JLabel selectedLabel;
+    private javax.swing.JList selectedList;
+    // End of variables declaration//GEN-END:variables
+    
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000310.html">[Plantlore-dev] Re: Re:
</A></li>
	<LI>Next message: <A HREF="000312.html">[Plantlore-dev] r264 - trunk/src/net/sf/plantlore/server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#311">[ date ]</a>
              <a href="thread.html#311">[ thread ]</a>
              <a href="subject.html#311">[ subject ]</a>
              <a href="author.html#311">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
