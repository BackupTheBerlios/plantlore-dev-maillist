<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] chyby
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-December/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20chyby&In-Reply-To=%3C457D0CC9.6030005%40nature.cz%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001320.html">
   <LINK REL="Next"  HREF="001322.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] chyby</H1>
    <B>Vladim&#237;r Hans</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20chyby&In-Reply-To=%3C457D0CC9.6030005%40nature.cz%3E"
       TITLE="[Plantlore-dev] chyby">vladimir_hans at nature.cz
       </A><BR>
    <I>Mon Dec 11 08:46:17 CET 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="001320.html">[Plantlore-dev] Hans
</A></li>
        <LI>Next message: <A HREF="001322.html">[Plantlore-dev] chyby
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1321">[ date ]</a>
              <a href="thread.html#1321">[ thread ]</a>
              <a href="subject.html#1321">[ subject ]</a>
              <a href="author.html#1321">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Ahoj.
pos&#237;l&#225;m dal&#353;&#237; chybky.

Obecn&#283; &#8211; chyby p&#345;i zapisov&#225;n&#237; nov&#253;ch n&#225;lez&#367; do db, kdy doch&#225;zelo k
blokac&#237;m z&#225;pisu, p&#345;i editaci st&#225;vaj&#237;c&#237;ch (zejm&#233;na zm&#283;na druhu) plantlore
na&#353;el n&#283;kolik vyhovuj&#237;c&#237;ch z&#225;znam&#367; a nev&#283;d&#283;l jak&#253; m&#225; aktualizovat.

Instal&#225;tor se odkazuje na soubor postgresql-8.1-inst.msi, kter&#253;
neexistuje. M&#237;sto n&#283;j je postgresql-inst.msi. Proto se nem&#367;&#382;e
nainstalovat postgresql. Na WinXP to ti&#353;e sel&#382;e, Win2k hl&#225;s&#237; chybn&#233;
parametry msiexec. I s verz&#237; windows installer 3.x.

Jestli&#382;e spust&#237;m server bez gui, tak se k n&#283;mu nep&#345;ipoj&#237;m jin&#253;m
plantlore-serverem z jin&#233; ma&#353;iny

Neda&#345;&#237; se mi spustit plantlore-server p&#345;i startu linuchu bez konzole z
rc.local p&#345;&#237;kazem java -Djava.rmi.server.hostname=10.1.69.1 -jar
/usr/local/Plantlore/plantlore-server.jar port 2332 nogui. Viz solubor
out.log

Jestli&#382;e tento p&#345;&#237;kaz spust&#237;m z konzole, tak se na plantlore server
p&#345;ihl&#225;s&#237;m a m&#367;&#382;u pracovat s db



P&#345;evod sou&#345;adnic:

P&#345;i p&#345;evodu z WGS84 do S42 je rozd&#237;l nadmo&#345;sk&#253;ch v&#253;&#353;ek 44 m (p&#367;vodn&#283; 512
m, po p&#345;epo&#269;&#237;t&#225;n&#237; 468 m).

Plantlore umo&#382;n&#237; ulo&#382;it i sou&#345;adnice v jtsk. D&#225;t tam kontrolu na hodnoty
(-90 - +90 na d&#233;lku a &#353;&#237;&#345;ku 0 - 360).

Ovl&#225;d&#225;n&#237; p&#345;evodu sou&#345;adnic je nepraktick&#233;. M&#225;m-li n&#283;kolik sou&#345;adnic
nap&#345;. v JTSK, tak jednu p&#345;evedu do WGS, ale pak mus&#237;m prov&#233;st nadbyte&#269;n&#253;
p&#345;evod do WGS a pak zase m&#367;&#382;u pokra&#269;ovat p&#345;i p&#345;evodu z JTSK do WGS. A
takhle dokola

A jestli&#382;e je nastaven aktu&#225;l. sou&#345;ad. syst. WGS a p&#345;ev&#233;st do WGS, tak
nejsem schopen p&#345;ev&#233;st sou&#345;adnice z jtsk. Mus&#237;m nejd&#345;&#237;v zadat wgs
sou&#345;adnice, p&#345;ev&#233;st do sjtsk a pak zadat sjtsk. Asi nejpohodln&#283;j&#353;&#237; by
bylo, kdyby u sou&#345;adnic byl v&#253;b&#283;rov&#253; prvek, kde by se ur&#269;il vstupn&#237;
sou&#345;adnicov&#253; syst&#233;m. A po p&#345;i z&#225;pisu dat do db by se to p&#345;epo&#269;&#237;talo na
WGS. Standardn&#283; by bylo WGS.

Jestli&#382;e p&#345;ev&#225;d&#237;m do JTSK, tak &#353;&#237;&#345;ka je kladn&#225; a d&#233;lka z&#225;porn&#225;. M&#283;lo by
to b&#253;t oboj&#237; z&#225;porn&#233;. Do I. kvadrantu to d&#225;vaj&#237; akor&#225;t l&#237;n&#237; geodeti :-)



Datab&#225;ze aaa (viz aaa.backup), zkou&#353;eno jak lok&#225;ln&#283; (Fedora 6), tk i
s&#237;&#357;ov&#283; (server na Fedo&#345;e, klient WinXP)

M&#225;m-li spu&#353;t&#283;n&#253; plantlore server bez gui (ale i s gui) a na klientovi
chci editovat existuj&#237;c&#237; z&#225;znam (zm&#283;na taxonu), tak chybov&#225; hl&#225;&#353;ka
&#8222;Nelze prov&#233;st danou operaci&#8220;. Stejn&#283; se to projevuje lok&#225;ln&#283;. Na
konzoli klienta:

net.sf.plantlore.common.exception.DBLayerException: Nelze prov&#223;st danou
operaci.



at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateD

BLayer.java:443)

at net.sf.plantlore.server.HibernateDBLayer.executeInsertInTransaction(H

ibernateDBLayer.java:973)

at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.

java:39)

at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces

sorImpl.java:25)

at java.lang.reflect.Method.invoke(Method.java:585)

at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:294)

at sun.rmi.transport.Transport$1.run(Transport.java:153)

at java.security.AccessController.doPrivileged(Native Method)

at sun.rmi.transport.Transport.serviceCall(Transport.java:149)

at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:4

66)

at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport

.java:707)

at java.lang.Thread.run(Thread.java:595)

at sun.rmi.transport.StreamRemoteCall.exceptionReceivedFromServer(Unknow

n Source)

at sun.rmi.transport.StreamRemoteCall.executeCall(Unknown Source)

at sun.rmi.server.UnicastRef.invoke(Unknown Source)

at net.sf.plantlore.server.HibernateDBLayer_Stub.executeInsertInTransact

ion(Unknown Source)

at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)

at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)

at java.lang.reflect.Method.invoke(Unknown Source)

at spin.Invocation.evaluate(Invocation.java:175)

at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)

at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)

at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.jav

a:102)

at $Proxy2.executeInsertInTransaction(Unknown Source)

at net.sf.plantlore.client.login.Login$DBLayerProxy.executeInsertInTrans

action(Login.java:600)

at net.sf.plantlore.client.overview.AddEdit$1.task(AddEdit.java:1122)

at net.sf.plantlore.common.Task$1.construct(Task.java:200)

at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)

at java.lang.Thread.run(Unknown Source)

Caused by: org.hibernate.PropertyValueException: not-null property
references a

null or transient value: net.sf.plantlore.common.record.Occurrence.unitIdDb

at org.hibernate.engine.Nullability.checkNullability(Nullability.java:72

)

at org.hibernate.event.def.AbstractSaveEventListener.performSaveOrReplic

ate(AbstractSaveEventListener.java:265)

at org.hibernate.event.def.AbstractSaveEventListener.performSave(Abstrac

tSaveEventListener.java:167)

at org.hibernate.event.def.AbstractSaveEventListener.saveWithGeneratedId

(AbstractSaveEventListener.java:114)

at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.saveWithGene

ratedOrRequestedId(DefaultSaveOrUpdateEventListener.java:186)

at org.hibernate.event.def.DefaultSaveEventListener.saveWithGeneratedOrR

equestedId(DefaultSaveEventListener.java:33)

at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.entityIsTran

sient(DefaultSaveOrUpdateEventListener.java:175)

at org.hibernate.event.def.DefaultSaveEventListener.performSaveOrUpdate(

DefaultSaveEventListener.java:27)

at org.hibernate.event.def.DefaultSaveOrUpdateEventListener.onSaveOrUpda

te(DefaultSaveOrUpdateEventListener.java:70)

at org.hibernate.impl.SessionImpl.fireSave(SessionImpl.java:530)

at org.hibernate.impl.SessionImpl.save(SessionImpl.java:518)

at org.hibernate.impl.SessionImpl.save(SessionImpl.java:514)

at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateD

BLayer.java:396)

at net.sf.plantlore.server.HibernateDBLayer.executeInsertInTransaction(H

ibernateDBLayer.java:973)

at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)

at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.

java:39)

at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAcces

sorImpl.java:25)

at java.lang.reflect.Method.invoke(Method.java:585)

at sun.rmi.server.UnicastServerRef.dispatch(UnicastServerRef.java:294)

at sun.rmi.transport.Transport$1.run(Transport.java:153)

at java.security.AccessController.doPrivileged(Native Method)

at sun.rmi.transport.Transport.serviceCall(Transport.java:149)

at sun.rmi.transport.tcp.TCPTransport.handleMessages(TCPTransport.java:4

66)

at sun.rmi.transport.tcp.TCPTransport$ConnectionHandler.run(TCPTransport

.java:707)

at java.lang.Thread.run(Thread.java:595)

A server na konzoli:

23:04:18,898 FATAL RMI TCP Connection(84)-10.1.69.3 server:430 - Saving
record into the database failed. Details: not-null property references a
null or transient value: net.sf.plantlore.common.record.Occurrence.unitIdDb


Chci-li p&#345;idat n&#225;lez, tak ta sam&#225; chyba (v t&#233; sam&#233; konfiguraci jako v&#253;&#353;e).



P&#345;id&#225;m-li publikaci nebo projekt a d&#225;m obnovit, tak v overview mi zmiz&#237;
v&#353;echny n&#225;lezy.

Datab&#225;ze bbb:

nejde upravit n&#225;lez Orchis coryophora, hl&#225;s&#237; to, &#382;e existuje n&#283;kolik
stejn&#253;ch z&#225;znam&#367; (a nen&#237; to jen u t&#233;to db, ale &#269;asto p&#345;i oprav&#225;ch:

09:46:38,125 WARN AWT-EventQueue-0 common:427 - There are 2 completely
identica

l records in the Habitat table: Habitat.quadrant = null;
Habitat.description = B

orsk&#345; rybn&#221;k; Habitat.country = &#9562;R; Habitat.altitude = null;
Habitat.latitude =

null; Habitat.longitude = null; Habitat.note = null; Habitat.deleted =
0; Territ

ory.name = Bohemia meridionalis; Phytochorion.code = 37n;
Phytochorion.name = Ka

plick&#218; meziho&#176;&#221;; NearestVillage.name = K&#176;em&#215;e;

09:46:38,140 ERROR AWT-EventQueue-0 overview:779 - Database problem:
net.sf.plan

tlore.common.exception.DBLayerException: V datab&#223;zi se nach&#223;z&#221; n&#253;kolik
identick&#345;

ch z&#223;znam&#168;.

Nen&#221; jasn&#218;, kter&#345; z&#223;znam m&#223; b&#345;t zpracov&#223;n.

net.sf.plantlore.common.exception.DBLayerException: V datab&#223;zi se
nach&#223;z&#221; n&#253;koli

k identick&#345;ch z&#223;znam&#168;.

Nen&#221; jasn&#218;, kter&#345; z&#223;znam m&#223; b&#345;t zpracov&#223;n.

at net.sf.plantlore.common.DBLayerUtils.findMatchInDB(DBLayerUtils.java:

428)

at net.sf.plantlore.client.overview.AddEdit.checkData(AddEdit.java:1444)



at net.sf.plantlore.client.overview.AddEditCtrl$OkButtonAction.actionPer

formed(AddEditCtrl.java:690)

at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)

at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)

at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)

at javax.swing.DefaultButtonModel.setPressed(Unknown Source)

at javax.swing.plaf.basic.BasicButtonListener.mouseReleased(Unknown Sour

ce)

at java.awt.Component.processMouseEvent(Unknown Source)

at javax.swing.JComponent.processMouseEvent(Unknown Source)

at java.awt.Component.processEvent(Unknown Source)

at java.awt.Container.processEvent(Unknown Source)

at java.awt.Component.dispatchEventImpl(Unknown Source)

at java.awt.Container.dispatchEventImpl(Unknown Source)

at java.awt.Component.dispatchEvent(Unknown Source)

at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)

at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)

at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)

at java.awt.Container.dispatchEventImpl(Unknown Source)

at java.awt.Window.dispatchEventImpl(Unknown Source)

at java.awt.Component.dispatchEvent(Unknown Source)

at java.awt.EventQueue.dispatchEvent(Unknown Source)

at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)



at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)

at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)

at java.awt.Dialog$1.run(Unknown Source)

at java.awt.Dialog$2.run(Unknown Source)

at java.security.AccessController.doPrivileged(Native Method)

at java.awt.Dialog.show(Unknown Source)

at java.awt.Component.show(Unknown Source)

at java.awt.Component.setVisible(Unknown Source)

at net.sf.plantlore.client.AppCoreCtrl$EditAction$2$1.run(AppCoreCtrl.ja

va:793)

at java.awt.event.InvocationEvent.dispatch(Unknown Source)

at java.awt.EventQueue.dispatchEvent(Unknown Source)

at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)



at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)

at java.awt.EventDispatchThread.pumpEvents(Unknown Source)

at java.awt.EventDispatchThread.pumpEvents(Unknown Source)

at java.awt.EventDispatchThread.run(Unknown Source)

09:46:41,468 INFO AWT-EventQueue-0 overview:799 - AddEdit dialog cancelled



Datab&#225;ze provoz:

Vytvo&#345;ena pod Fedorou (Postgre 8.1), p&#345;ihl&#225;sil jsem se na n&#237; z Fedory
p&#345;es s&#237;&#357;ov&#233; rozhran&#237; na plantlore server (taky b&#283;&#382;el pod Fedorou) a z
Woken (taky na tent&#253;&#382; plantlore server). Pod Fidorkou jsem tam vytvo&#345;il
dva z&#225;znamy a kdy&#382; jsem cht&#283;l ulo&#382;it z&#225;znam z woken tak operaci nelze
prov&#233;st: v&#253;pis podobn&#253; jako v&#253;&#353;e.



Vyskytl se DEADLOCK, kdy&#382; jsem cht&#283;l mazat z&#225;znamy. Bohu&#382;el se mi to u&#382;
podruh&#233; nepoda&#345;ilo vyvolat.



Chybn&#253; import &#8211; vyexportil jsem data ve form&#225;tu plantlore native a p&#345;i
importu mi to nenaimportilo 5 z&#225;znam&#367; z 9. Vzhledem k tomu, &#382;e nem&#225;m log
soubor, tak ani nev&#237;m pro&#269;. Zkuste se pod&#237;vat na soubor export.xml. A
d&#283;l&#225; to je&#353;t&#283; hor&#353;&#237; v&#283;ci :-(. Naimport&#237;m data do jin&#233; db, uprav&#237;m je a
kdy&#382; je import&#237;m zp&#225;tky, tak se mi to n&#283;co naimport&#237; jako nov&#233;.
Zpozoroval jsem to u t&#283;ch n&#225;lez&#367;, kde jsem opravil druh.


Vl&#225;&#271;a
-------------- next part --------------
A non-text attachment was scrubbed...
Name: test.zip
Type: application/x-zip-compressed
Size: 815981 bytes
Desc: not available
URL: &lt;<A HREF="https://lists.berlios.de/pipermail/plantlore-dev/attachments/20061211/71e540a4/attachment.bin">https://lists.berlios.de/pipermail/plantlore-dev/attachments/20061211/71e540a4/attachment.bin</A>&gt;
</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001320.html">[Plantlore-dev] Hans
</A></li>
	<LI>Next message: <A HREF="001322.html">[Plantlore-dev] chyby
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1321">[ date ]</a>
              <a href="thread.html#1321">[ thread ]</a>
              <a href="subject.html#1321">[ subject ]</a>
              <a href="author.html#1321">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
