From fraktalek at mail.berlios.de  Fri Sep  1 12:18:46 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 12:18:46 +0200
Subject: [Plantlore-dev] r609 - trunk/src/net/sf/plantlore/client
Message-ID: <200609011018.k81AIkgF030921@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 12:18:45 +0200 (Fri, 01 Sep 2006)
New Revision: 609

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
Log:
Fixes so that a try to display a detail after the server kicked the client off doesn't make the client crash.


Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-08-31 21:40:24 UTC (rev 608)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-01 10:18:45 UTC (rev 609)
@@ -288,9 +288,10 @@
     }
     
     public void selectAndShow(int resultNumber) throws DBLayerException, RemoteException {
-        System.out.println("selectAndShow resultNumber = "+resultNumber);
+        logger.debug("selectAndShow resultNumber = "+resultNumber);
         if (resultNumber < 0 || resultNumber > getResultsCount()) {
-            throw new IllegalArgumentException("Result number "+resultNumber+" doesn't exist.");
+            logger.error("Row #"+resultNumber+" doesn't exist. Have we been disconnected?");
+            return;
         }
         if (resultNumber >= getRecordsPerPage()*getCurrentPage()) { //resultNumber is greater than the last resultNumber on current page
             nextPage();
@@ -325,8 +326,10 @@
     }
     
     public Integer getOccurrence(int i) throws DBLayerException, RemoteException {
-        if (i < 0 || i > getResultsCount())
-            throw new IllegalArgumentException(""+i);
+        if (i < 0 || i > getResultsCount()) {
+            logger.error("Occurrence #"+i+" doesn't exist. Have we been disconnected?");                    
+            return null;
+        }
         
         return tableSorter.getOccurrence(i);
     }

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-08-31 21:40:24 UTC (rev 608)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 10:18:45 UTC (rev 609)
@@ -1425,11 +1425,17 @@
 			if (e.getClickCount() >= 2)
 				try {
 					int resultNumber = model.getSelectedResultNumber();
+                                        if (resultNumber > model.getResultsCount()) {
+                                            logger.equals("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
+                                            JOptionPane.showMessageDialog(view,"The connection has been probably lost.");
+                                            return;
+                                        }
+                                        
 					if (resultNumber != model.getResultsCount())
 						model.selectAndShow(resultNumber);
 					detailModel.load(model.getSelectedResultNumber());
 					detailView.setVisible(true);
-				} catch (RemoteException ex) {
+				} catch (RemoteException ex) {//FIXME
 					JOptionPane.showMessageDialog(view, "RemoteException: "
 							+ ex);
 					ex.printStackTrace();



From fraktalek at mail.berlios.de  Fri Sep  1 12:21:19 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 12:21:19 +0200
Subject: [Plantlore-dev] r610 - trunk/src/net/sf/plantlore/client
Message-ID: <200609011021.k81ALJDO031171@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 12:21:19 +0200 (Fri, 01 Sep 2006)
New Revision: 610

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
Log:
Corretion of a typo...


Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 10:18:45 UTC (rev 609)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 10:21:19 UTC (rev 610)
@@ -1426,7 +1426,7 @@
 				try {
 					int resultNumber = model.getSelectedResultNumber();
                                         if (resultNumber > model.getResultsCount()) {
-                                            logger.equals("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
+                                            logger.error("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
                                             JOptionPane.showMessageDialog(view,"The connection has been probably lost.");
                                             return;
                                         }



From fraktalek at mail.berlios.de  Fri Sep  1 12:28:35 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 12:28:35 +0200
Subject: [Plantlore-dev] r611 - trunk/src/net/sf/plantlore/client
Message-ID: <200609011028.k81ASZ6H031704@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 12:28:35 +0200 (Fri, 01 Sep 2006)
New Revision: 611

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
Log:
One more fix of the detail - on Enter key.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 10:21:19 UTC (rev 610)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 10:28:35 UTC (rev 611)
@@ -1467,6 +1467,12 @@
 			if (e.getKeyText(e.getKeyChar()).equals("Enter")) {
 				try {
 					int resultNumber = model.getSelectedResultNumber();
+                                        if (resultNumber > model.getResultsCount()) {
+                                            logger.error("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
+                                            JOptionPane.showMessageDialog(view,"The connection has been probably lost.");
+                                            return;
+                                        }
+                                        
 					if (resultNumber != model.getResultsCount())
 						model.selectAndShow(resultNumber - 1);// After Enter
 					// the



From fraktalek at mail.berlios.de  Fri Sep  1 12:33:52 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 12:33:52 +0200
Subject: [Plantlore-dev] r612 - trunk/lib
Message-ID: <200609011033.k81AXqoQ000328@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 12:33:49 +0200 (Fri, 01 Sep 2006)
New Revision: 612

Added:
   trunk/lib/commons-beanutils.jar
   trunk/lib/commons-collections-3.1.jar
   trunk/lib/commons-digester-1.7.jar
   trunk/lib/commons-logging-api.jar
   trunk/lib/itext-1.4.jar
   trunk/lib/jasperreports-1.2.1.jar
Removed:
   trunk/lib/commons-collections-2.1.1.jar
   trunk/lib/jasper/
Log:
Moved jars from lib/jasper to lib.

You'll have to change your IDE's settings.



Copied: trunk/lib/commons-beanutils.jar (from rev 608, trunk/lib/jasper/commons-beanutils.jar)

Deleted: trunk/lib/commons-collections-2.1.1.jar
===================================================================
(Binary files differ)

Copied: trunk/lib/commons-collections-3.1.jar (from rev 608, trunk/lib/jasper/commons-collections-3.1.jar)

Copied: trunk/lib/commons-digester-1.7.jar (from rev 608, trunk/lib/jasper/commons-digester-1.7.jar)

Copied: trunk/lib/commons-logging-api.jar (from rev 608, trunk/lib/jasper/commons-logging-api.jar)

Copied: trunk/lib/itext-1.4.jar (from rev 608, trunk/lib/jasper/itext-1.4.jar)

Copied: trunk/lib/jasperreports-1.2.1.jar (from rev 608, trunk/lib/jasper/jasperreports-1.2.1.jar)



From krater at mail.berlios.de  Fri Sep  1 15:00:39 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Fri, 1 Sep 2006 15:00:39 +0200
Subject: [Plantlore-dev] r613 - trunk/lib
Message-ID: <200609011300.k81D0dOT014417@sheep.berlios.de>

Author: krater
Date: 2006-09-01 15:00:13 +0200 (Fri, 01 Sep 2006)
New Revision: 613

Added:
   trunk/lib/spin.jar
Modified:
   trunk/lib/README.txt
Log:
A special library that supports a creation of non-freezing Swing GUI.

Modified: trunk/lib/README.txt
===================================================================
--- trunk/lib/README.txt	2006-09-01 10:33:49 UTC (rev 612)
+++ trunk/lib/README.txt	2006-09-01 13:00:13 UTC (rev 613)
@@ -4,5 +4,5 @@
 looks-2.0.2.jar		JGoodies look & feel
 dom4j-1.6.jar		Dom4j library for work with XML
 swing-layout-1.0.jar	Library used by dialogs created in Netbeans Matisse editor
+spin.jar		A special library that supports a creation of a non-freezing Swing GUI. See http://spin.sourceforge.net/ for more details.
 
-

Added: trunk/lib/spin.jar
===================================================================
(Binary files differ)


Property changes on: trunk/lib/spin.jar
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Fri Sep  1 15:09:40 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Fri, 1 Sep 2006 15:09:40 +0200
Subject: [Plantlore-dev] r614 - in trunk/src/net/sf/plantlore:
	client/checklist client/createdb client/export
	client/export/builders client/export/component client/login
	common common/debug common/record
Message-ID: <200609011309.k81D9eBx017347@sheep.berlios.de>

Author: krater
Date: 2006-09-01 15:09:26 +0200 (Fri, 01 Sep 2006)
New Revision: 614

Added:
   trunk/src/net/sf/plantlore/client/export/component/ProjectionSelectionModel.java
Removed:
   trunk/src/net/sf/plantlore/client/export/DefaultDirector.java
   trunk/src/net/sf/plantlore/client/export/component/TemplateSelectionModel.java
Modified:
   trunk/src/net/sf/plantlore/client/checklist/Checklist.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/client/export/AbstractBuilder.java
   trunk/src/net/sf/plantlore/client/export/Builder.java
   trunk/src/net/sf/plantlore/client/export/ExportMng2.java
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
   trunk/src/net/sf/plantlore/client/export/ExportTask2.java
   trunk/src/net/sf/plantlore/client/export/Projection.java
   trunk/src/net/sf/plantlore/client/export/builders/CSVBuilder.java
   trunk/src/net/sf/plantlore/client/export/builders/TrainingBuilder.java
   trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java
   trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java
   trunk/src/net/sf/plantlore/client/export/component/FileFormat.java
   trunk/src/net/sf/plantlore/client/export/component/UserTreeNode.java
   trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
   trunk/src/net/sf/plantlore/client/login/AuthView.java
   trunk/src/net/sf/plantlore/client/login/DBInfo.java
   trunk/src/net/sf/plantlore/client/login/ItemCtrl2.java
   trunk/src/net/sf/plantlore/client/login/ItemView2.java
   trunk/src/net/sf/plantlore/client/login/Login.java
   trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
   trunk/src/net/sf/plantlore/client/login/LoginView.java
   trunk/src/net/sf/plantlore/common/Assistant.java
   trunk/src/net/sf/plantlore/common/AutoComboBox.java
   trunk/src/net/sf/plantlore/common/AutoComboBoxNG3.java
   trunk/src/net/sf/plantlore/common/AutoTextArea.java
   trunk/src/net/sf/plantlore/common/ComponentAdjust.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
   trunk/src/net/sf/plantlore/common/DefaultCancelAction.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java
   trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java
   trunk/src/net/sf/plantlore/common/GlobalExceptionHandler.java
   trunk/src/net/sf/plantlore/common/ProgressBarEx.java
   trunk/src/net/sf/plantlore/common/ProgressDialog.java
   trunk/src/net/sf/plantlore/common/Selection.java
   trunk/src/net/sf/plantlore/common/SpringUtilities.java
   trunk/src/net/sf/plantlore/common/StandardAction.java
   trunk/src/net/sf/plantlore/common/TabTransfersFocus.java
   trunk/src/net/sf/plantlore/common/UniqueIDGenerator.java
   trunk/src/net/sf/plantlore/common/debug/MemoryMonitor.java
   trunk/src/net/sf/plantlore/common/record/Deletable.java
   trunk/src/net/sf/plantlore/common/record/Record.java
Log:
Javadoc added to several sources.

A problem with GUI freeze in Windows XP fixed (every time the RMI threw the ConnectionException, the GUI froze; but it happened only with the ConnectionException - maybe it has something to do with networking in the OS because there was no trace of this problem in Linux).

Modified: trunk/src/net/sf/plantlore/client/checklist/Checklist.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/Checklist.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/checklist/Checklist.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -24,6 +24,7 @@
 
 /**
  * The Checklist ("?krt?k" in Czech). 
+ * 
  * The Checklist displays plants and allows the User to select some of them
  * easily. The User can use either a mouse or a keyboard to (de)select records.
  * The Checklist supports searching (immediately as User types).

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -143,7 +143,7 @@
 	}
 	
 	/**
-	 * Restore the checklist to its original state (right after creation).
+	 * Restore the checklist to its original state (right after the creation).
 	 */
 	class Restore extends AbstractAction {
 		public Restore() {

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -9,7 +9,7 @@
 
 /**
  * The dialog displaying the checklist and several buttons 
- * the allow the checklist to be saved or loaded. 
+ * that allow the checklist to be saved, or loaded, or restored. 
  *
  * @author  Erik Kratochv?l
  */

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -12,9 +12,28 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
+ * CreateDB is a CreationTask factory. 
+ * Its sole purpose is to gather information required for the
+ * creation of that task and create a new record in the list
+ * of databases the User accessed (see Login).
+ * <br/>
+ * The CreationTask is a long running operation that 
+ * <ol>
+ * <li>
+ * Connects to the database engine and creates a new database.
+ * The creation of the database includes the creation of all tables,
+ * the default administrator (if it is not already created) and filling those
+ * tables with values that are necessary for proper work with Plantlore. 
+ * </li>
+ * <li>
+ * Optionally fills all (so called) immutable tables with records 
+ * that apply to the Czech Republic. 
+ * Those are tables are: villages, plants, territories, and phytochoria.
+ * </li>
+ * </ol>
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 29.8.2006
+ * @since 2006-08-29
  *
  */
 public class CreateDB extends Observable {
@@ -25,41 +44,70 @@
 	private DBInfo info;
 	private boolean leaveEmpty = false;
 		
-	
+	/**
+	 * Create a new CreateDB.
+	 * 
+	 * @param config	The configuration that manages the list of databases the User accessed.
+	 */
 	public CreateDB(MainConfig config) {
 		this.config = config;
 	}
 	
-	
+	/**
+	 * Set information about the datbase that shall come to existence.
+	 *  
+	 * @param alias	The name that will be presented to the User.
+	 * @param engine	The type of the database (the database engine).
+	 * @param port	The port where the database engine listens.
+	 * @param identifier	The name of the database that will be created.
+	 * @param leaveEmpty		True if the immutable tables shall remain empty. 
+	 */
 	public void setDBInfo(String alias, String engine, int port, String identifier, boolean leaveEmpty) {
 		info = new DBInfo(alias, null, 0, engine, port, identifier, "", new String[Login.MAX_NAMES]);
 		this.leaveEmpty = leaveEmpty; 
 	}
 	
+	/**
+	 * Add the database info to the list of databases permanently.
+	 * 
+	 * @param info	The info to be added.
+	 */
 	protected void addDBInfoPermanently(DBInfo info) {
 		ArrayList<DBInfo> dbinfos = config.getDBinfos();
 		dbinfos.add( info );
 		config.setDBInfos( dbinfos, info );
 		try {
 			config.save();
-		} catch(java.io.IOException e) { /* Oh my.. */ }
+		} catch(java.io.IOException e) { /* Never mind. */ }
 		
 		setChanged();
 		notifyObservers( info );
 	}
 	
-	
+	/**
+	 * Create a new Creation Task that is capable of creating the new database.
+	 *  
+	 * @param username	The name of the account that allows us to connect to the database
+	 * engine and perform all actions necessary (create DB, create roles and users, ...) - and Administrator
+	 * typically.
+	 * @param password	The password protecting that account.
+	 * 
+	 * @return	The Creation task.
+	 */
 	public synchronized Task createCreationTask(String username, String password) {
+		// Set the first user name to the Administrator of the database.
+		info.getUsers()[0] = username;
 		return new CreationTask(info, username, password, leaveEmpty);
 	}
 	
 	
 	
 	/**
-	 * Creation of the database.
+	 * The Creation of the database.
 	 * 
-	 * @author Erik Kratochv?l (discontinuum at gmail.com)
-	 * @since 29.8.2006
+	 * @author Erik Kratochv?l (The skeleton of the task.)
+	 * @author Tom?? Kova??k (at least I hope so)
+	 * @since 2006-08-29
 	 *
 	 */
 	private class CreationTask extends Task {
@@ -68,6 +116,14 @@
 		private transient String name, password;
 		private boolean leaveEmpty;
 		
+		/**
+		 * Create a new Creation Task.
+		 * 
+		 * @param dbinfo	The holder object containing information about the new database.
+		 * @param name		The account name that shall be used to connect to the database.
+		 * @param password	The password protecting that account.
+		 * @param leaveEmpty		Leave the immutable tables empty (do not fill them).
+		 */
 		public CreationTask(DBInfo dbinfo, String name, String password, boolean leaveEmpty) {
 			this.dbinfo = dbinfo;
 			this.name = name;

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -6,7 +6,13 @@
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
 
-
+/**
+ * The mapping of the button in the view to actions.
+ * The User can click to start the Creation of the database using the previously 
+ * supplied data.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class CreateDBAuthCtrl {
 	
 	private CreateDBAuthView view;
@@ -23,6 +29,8 @@
 				Task creation = model.createCreationTask(user, new String(view.password.getPassword()));
 				new DefaultProgressBar(creation, view, true);
 				creation.start();
+				
+				view.password.setText("");
 			}
 		});
 	}

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,9 +1,3 @@
-/*
- * CreateDBAuthView.java
- *
- * Created on 31. srpen 2006, 9:03
- */
-
 package net.sf.plantlore.client.createdb;
 
 import java.awt.Dialog;
@@ -14,12 +8,14 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
- *
- * @author  yaa
+ * The view allows the User to specify the Authentication information
+ * - the User name (or the Account name) and the Password of that account.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
  */
 public class CreateDBAuthView extends javax.swing.JDialog implements Observer {
     
-    /** Creates new form CreateDBAuthView */
+    
     public CreateDBAuthView(Dialog parent, CreateDB model) {
     	super(parent, true);
     	
@@ -103,10 +99,8 @@
     public void update(Observable source, final Object parameter) {
 		java.awt.EventQueue.invokeLater(new Runnable() {
     		public void run() {
-    			if(parameter instanceof DBInfo) {
+    			if(parameter instanceof DBInfo)
     				setVisible(false);
-    				password.setText("");
-    			}
     		}
 		});
 	}

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -8,7 +8,14 @@
 import net.sf.plantlore.l10n.L10n;
 
 
-
+/**
+ * The mapping of the button in the view to action
+ * that opens the second part of the dialog - the Authentication.
+ * 
+ * Also the field validity check is performed.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class CreateDBCtrl {
 	
 	private CreateDBView view;

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,9 +1,3 @@
-/*
- * CreateDBView.java
- *
- * Created on 29. srpen 2006, 15:21
- */
-
 package net.sf.plantlore.client.createdb;
 
 import java.awt.Frame;
@@ -14,13 +8,15 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
+ * The view presents the User with several fields
+ * so that the User can supply information about the database
+ * that shall be created.
  *
- * @author  yaa
+ * @author  Erik Kratochv?l
  */
 public class CreateDBView extends javax.swing.JDialog implements Observer {
 	
 	    
-    /** Creates new form CreateDBView */
     public CreateDBView(Frame parent, CreateDB model) {
     	super(parent, true);
     	
@@ -182,6 +178,9 @@
     // End of variables declaration//GEN-END:variables
     
     
+    /**
+     * Hide the dialog if the DBInfo has been added successfully.
+     */
 	public void update(Observable source, final Object parameter) {
 		java.awt.EventQueue.invokeLater(new Runnable() {
     		public void run() {

Modified: trunk/src/net/sf/plantlore/client/export/AbstractBuilder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/AbstractBuilder.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/AbstractBuilder.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -7,7 +7,7 @@
 
 /**
  * A default implementation of the Builder interface.
- * It is strongly recommended to subclass the AbstractBuilder
+ * If it seems convenient you may subclass the AbstractBuilder
  * and implement the <code>output()</code> method
  * instead of implementing the whole Builder interface
  * yourself.
@@ -27,28 +27,28 @@
 	
 	
 	/**
-	 * Create a new DefaultBuilder.
+	 * Create a new Abstract Builder.
 	 * 
-	 * @param template The template describing which columns are selected.
+	 * @param projections The template describing which columns are selected.
 	 */
-	public AbstractBuilder(Projection template) {
-		setTemplate(template);
+	public AbstractBuilder(Projection projections) {
+		setProjections(projections);
 	}
 	
 	/**
 	 * Set another template.
 	 * The builder stores a clone of the template.
 	 *  
-	 * @param template The new template. <b>Mustn't be <i>null</i></b>.
+	 * @param projections The new template. <b>Mustn't be <i>null</i></b>.
 	 */
-	public void setTemplate(Projection template) {
-		this.template = (template == null) ? null : template.clone();
+	public void setProjections(Projection projections) {
+		this.template = (projections == null) ? null : projections.clone();
 	}
 	
 	/**
 	 * @return A clone of the template this Builder currently uses.
 	 */
-	public Projection getTemplate() {
+	public Projection getProjections() {
 		return (template == null) ? null : template.clone();
 	}
 	

Modified: trunk/src/net/sf/plantlore/client/export/Builder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/Builder.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/Builder.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -6,7 +6,7 @@
 
 /**
  * Interface for building the output. 
- * The builder is responsible for "building" the output when given 
+ * The builder is responsible for "building" the output when it is given 
  * a record. The Director calls only these few methods - everything
  * else is "particular-implementation specific".
  * 

Deleted: trunk/src/net/sf/plantlore/client/export/DefaultDirector.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/DefaultDirector.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/DefaultDirector.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,328 +0,0 @@
-package net.sf.plantlore.client.export;
-
-import java.io.IOException;
-import java.rmi.RemoteException;
-import java.util.List;
-import java.util.Observable;
-
-import net.sf.plantlore.common.Pair;
-import net.sf.plantlore.common.PlantloreConstants;
-import net.sf.plantlore.common.Selection;
-import net.sf.plantlore.common.exception.ExportException;
-import net.sf.plantlore.common.record.*;
-import net.sf.plantlore.l10n.L10n;
-import net.sf.plantlore.middleware.DBLayer;
-import net.sf.plantlore.middleware.SelectQuery;
-import net.sf.plantlore.common.exception.DBLayerException;
-
-import org.apache.log4j.Logger;
-
-/**
- * The Director class (for export).
- * Purpose: The Director continualy fetches results of the resultset
- * identified by the <code>result</code>.
- * The selected results (records containted in the <code>selection</code>)
- * are passed to the <code>builder</code> - the builder is responsible for
- * creating a corresponing output.
- * <br/>
- * The Director is supposed to run in a separate thread which is why
- * all exceptions are handled in the <code>run()</code> method
- * in a following manner:
- * <pre>
- * catch(AnException e) { setChanged(); notifyObservers( e ); }
- * </pre>
- *  
- * <br/>
- * The DefaultDirector can run in two "modes" - either using projections
- * or regular records. 
- * If projections are used, the records are reconstructed so that the
- * same Builders can be used in both cases. 
- *
- * 
- * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 2006-04-21
- * @version 2.0
- *
- * @see net.sf.plantlore.client.common.Selection
- * @see net.sf.plantlore.client.export.Builder
- * @see net.sf.plantlore.middleware.DBLayer
- */
- at Deprecated
-public class DefaultDirector extends Observable implements Runnable {
-	
-	private Logger logger = Logger.getLogger(getClass().getPackage().getName());
-	
-	private Builder build;
-	private Selection selection;
-	private DBLayer database;
-	private int result;
-	private int totalNumberOfRecords = Integer.MAX_VALUE;
-	
-	private boolean ignoreDead = true;
-	
-	private boolean aborted = false;
-	private boolean useProjections = false;
-	
-	private List<Pair<Class, String>> description;
-	
-	private int count = 0;
-	
-	//private Class rootTable;
-
-
-	/**
-	 * Create a new export Director. The Director iterates over the results 
-	 * of the <code>query</code> (<code>database.executeQuery(query)</code>)
-	 * and selected records (i.e. records in the <code>selection</code>)
-	 * passes to the <code>builder</code>.
-	 * 
-	 * @param builder	The particular builder used to construct the final output.
-	 * @param result	The result describing the resultset that will be iterated over.
-	 * @param database	The database layer that will quench the Director's thirst for more results.
-	 * @param selection	The set of selected records.
-	 */
-	public DefaultDirector(Builder builder, int result, DBLayer database, Selection selection) 
-	throws ExportException {
-		setBuilder(builder); 
-		setResult(result); 
-		setDatabase(database); 
-		setSelection(selection); 
-	}
-	
-	/**
-	 * Create a new export Director. The Director iterates over the results 
-	 * of the <code>query</code> (<code>database.executeQuery(query)</code>)
-	 * and selected records (i.e. records in the <code>selection</code>)
-	 * passes to the <code>builder</code>.
-	 * 
-	 * @param builder	The particular builder used to construct the final output.
-	 * @param result	The result describing the resultset that will be iterated over.
-	 * @param database	The database layer that will quench the Director's thirst for more results.
-	 * @param selection	The set of selected records.
-	 * @param useProjections	Use projections instead of standard records.
-	 * @param description	The list of [Table, Column] - values of these columns will be returned 
-	 * by the database layer if projections are used
-	 */
-	public DefaultDirector(Builder builder, int result, DBLayer database, Selection selection, 
-			boolean useProjections, List<Pair<Class, String>> description, Class rootTable) 
-	throws ExportException {
-		this(builder, result, database, selection);
-		this.useProjections = useProjections;
-		this.description = description;
-		//this.rootTable = rootTable;
-		if(rootTable != null) try { 
-			torso = (Record)rootTable.newInstance();
-			torso.createTorso();
-		} catch (Exception e) {
-			// What shall we do? The torso is not complete!
-		}
-	}
-	
-	
-	/**
-	 * Set a new Builder
-	 * @param builder	The builder to be used.
-	 * @throws ExportException	If the builder is not valid.
-	 */
-	protected void setBuilder(Builder builder) 
-	throws ExportException {
-		if(builder == null) {
-			logger.warn("The builder is null!");
-			throw new ExportException(L10n.getString("Error.InvalidBuilder"));
-		}
-		build = builder;
-	}
-
-	/**
-	 * Set a new resultset identificator.
-	 * 
-	 * @param result	The identifier of the resultset.
-	 * @throws ExportException	If the identifier is not valid.
-	 */
-	protected void setResult(int result) 
-	throws ExportException {
-		if(result < 0) {
-			logger.warn("The result set is probably not valid!");
-			throw new ExportException(L10n.getString("Error.InvalidResultset"));
-		}
-		this.result =  result;
-	}
-	
-	/**
-	 * Set a new database layer.
-	 * @param db	The database layer to be set.
-	 * @throws ExportException	If the database layer is not valid.
-	 */
-	protected void setDatabase(DBLayer db) 
-	throws ExportException {
-		if(db == null) {
-			logger.error("The database layer is null!");
-			throw new ExportException(L10n.getString("Error.InvalidDBLayer"));
-		}
-		this.database = db;
-	}
-	
-	/**
-	 * Set a new selection.	
-	 * @param selection	The selection to be cloned.
-	 * @throws ExportException	If the selection is not valid.
-	 */
-	protected void setSelection(Selection selection) 
-	throws ExportException {
-		if(selection == null || selection.isEmpty()) {
-			logger.warn("The selection is null or empty!");
-			throw new ExportException(L10n.getString("Error.InvalidSelection"));
-		}
-		this.selection = selection.clone();
-	}
-	
-	/**
-	 * Set whether records marked as dead should be omited. Default is true.
-	 * 
-	 * @param ignore	True if dead records should be omited.
-	 */
-	public void ignoreDead(boolean ignore) {
-		this.ignoreDead = ignore;
-	}
-	
-	
-	public void setExpectedNumberOfRecords(int total) {
-		this.totalNumberOfRecords = total;
-	}
-	
-	/** 
-	 * How many records have been exported.
-	 * 
-	 * @return The exact number of exported records.
-	 */
-	public int exportedRecords() { 
-		return count;
-	}
-	
-		
-	/**
-	 * Find all AuthorOccurrences associated with the <code>Occurrence</code>
-	 * and send them to the Builder, too.
-	 * 
-	 * @param occurrence	The currently processed occurrence data.
-	 */
-	private void loadAssociatedAuthors(Occurrence occurrence) 
-	throws RemoteException, IOException, DBLayerException {
-		
-		logger.debug("Processing the associated information about Authors.");
-		
-		SelectQuery query = database.createQuery(AuthorOccurrence.class);
-		query.createAlias(AuthorOccurrence.OCCURRENCE, "OCC");
-
-		// AuthorOccurrence.OCCURRENCE = Occurrence.ID  &&  Occurrence.ID = occ.getId()
-		query.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, AuthorOccurrence.OCCURRENCE, "OCC."+Occurrence.ID, null, null);
-		query.addRestriction(PlantloreConstants.RESTR_EQ, "OCC."+Occurrence.ID, null, occurrence.getId(), null);
-		int resultId = database.executeQuery( query );
-		
-		// Take all results and spit'em out.
-		int rows = database.getNumRows( resultId );
-		for(int i = 0; i < rows; i++) {
-			logger.debug("Fetching associated data (Author, AuthorOccurrence).");
-			
-			Object[] pulp = database.more( resultId, i, i );
-			AuthorOccurrence ao = (AuthorOccurrence) ((Object[])pulp[0])[0];
-			ao.setOccurrence( null ); // cut off the way back to the occurrence
-			if(ao.isDead() && ignoreDead) continue;
-			
-			logger.debug("New author-occurence record: " + ao);
-			
-			build.part( ao );
-		}
-		database.closeQuery( query );
-		
-		logger.debug("Author-occurence processed.");
-	}
-	
-	
-	/** 
-	 * Execute the exporting procedure -
-	 * fetch all results from the resultset and those that are selected
-	 * send to the builder to process them.
-	 */
-	public void run() {
-		try {
-			logger.info("Export begins...");
-			build.header();
-			
-			// Iterate over the result of the query.
-			int rows = database.getNumRows( result );
-			count = 0;
-			for(int i = 0; i < rows && !aborted && count < totalNumberOfRecords; i++) {
-				
-				logger.debug("Fetching a new record from the database.");
-				
-				Record record;
-				if(useProjections) 
-					record = reconstruct( (Object[])database.more( result, i, i )[0] );
-				else
-					record = (Record)((Object[])database.more( result, i, i )[0])[0];
-				
-				
-				logger.debug("New record No. "+i+" fetched: "+record);
-				if( !selection.contains( record ) || (ignoreDead && record.isDead()) ) 
-					continue; // Is the record selected?
-				
-				logger.debug("The record is in the selection. It will be exported.");
-			
-				count++;
-				build.startRecord();
-				
-				// Build this part of the record.
-				build.part( record );
-				
-				/* -----------------------------------------------------------
-				 * Deal with the one-to-many relationship
-				 * of Occurence -> AuthorOccurence ~ Author
-				 * ----------------------------------------------------------- */
-				if( record instanceof Occurrence ) 
-					loadAssociatedAuthors( (Occurrence)record );
-				
-				build.finishRecord();
-				
-				setChanged(); notifyObservers( count );
-			}
-
-			build.footer();
-			logger.info("Export completed. " + count + " records sent to output. ");
-		}
-		catch(Exception e) {
-			logger.error("Export ended prematurely. Only "+count+" records exported.");
-			logger.error("The problem: "+e);
-			e.printStackTrace();
-			setChanged(); notifyObservers( e ); 
-		}
-		if(aborted) logger.info("Export aborted. " + count + " records sent to output.");
-	}
-	
-	/**
-	 * Abort the export immediately.
-	 */
-	public void abort() {
-		aborted = true;
-	}
-	
-	/**
-	 * The base of the record to be reconstructed.
-	 */
-	private Record torso;
-	
-	/**
-	 * Reconstruct the record from the given values. 
-	 * 
-	 * @param values	Values of columns (in the same order as in the Description).
-	 * @return	The reconstructed record.
-	 */
-	private Record reconstruct(Object[] values) {
-		for(int i = 0; i < description.size(); i++ ) {
-			Pair<Class, String> d = description.get(i);
-			torso.setValue(d.getFirst(), d.getSecond(), values[i]);
-		}
-		return torso;
-	}
-
-}

Modified: trunk/src/net/sf/plantlore/client/export/ExportMng2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -5,7 +5,6 @@
 import java.io.IOException;
 import java.io.OutputStreamWriter;
 import java.io.Writer;
-import java.rmi.RemoteException;
 
 import net.sf.plantlore.client.export.builders.*;
 import net.sf.plantlore.client.export.component.FileFormat;
@@ -20,41 +19,22 @@
 import org.apache.log4j.Logger;
 
 /**
- * The Export Manager. This class controls the whole process of export -
- * starting with creation of all necessary participants
- * and ending with the final cleanup. 
- * <br/>
- * There are several entities involved in the export:
- * <ul>
- * <li><b>DBLayer</b> the database layer that will carry out the requests.
- * 					Mustn't be null!</li>
- * <li><b>Director</b> iterates over the <i>result set</i> 
- * 					and <i>selected records</i> passes to the <i>builder</i>,</li>
- * <li><b>Builder</b> writes the records to the <i>output</i>.</li>
- * <li><b>Selection</b> stores the list of all selected records 
- * 					(<i>restriction</i> in the database terminology).</li>
- * <li><b>SelectQuery</b> identifies the result set as well (in fact the resultId is derived from it).</li>
- * <li><b>Projection</b> stores the list of all selected columns that should be 
- * 					exported (<i>projection</i> in the database terminology).</li>
- * <li><b>File</b> stores the name of file as the user has suggested it.</li>
- * <li><b>XFilter</b> suggests the final name of the <i>file</i>
- * 					and is used to determine which <i>builder</i> will be used
- * 					to produce the output.</li>
- * </ul>
  * 
+ * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-29 
  * @version 2.0
- * @see net.sf.plantlore.client.export.Builder
  */
 public class ExportMng2 {
 	
-	
+	/**
+	 * The encoding that should be used for all files.
+	 */
 	public static final String ENCODING = "UTF-8";
 	
 	
 	/**
-	 * List of all filters the Export Manager is capable to handle.
+	 * List of all file formats the Export Manager is capable to handle.
 	 */
 	protected FileFormat[] filters = new FileFormat[] {
 			new FileFormat(L10n.getString("Format.PlantloreNative"), false, false, ".xml", ".pln"),
@@ -168,11 +148,6 @@
 	 * Set a new DBLayer.
 	 */
 	synchronized public void setDBLayer(DBLayer dblayer) {
-		if(query != null) try {
-			db.closeQuery(query);
-		} catch(Exception e) {
-			// Never mind.
-		}
 		db = dblayer;
 	}
 	
@@ -198,35 +173,18 @@
 			this.selection = selection.clone();
 	}
 	
-	/**
-	 * Set the active filter. The type of the filter will be used 
-	 * to determine the appropriate extension of the file
-	 * and to create a correct Builder (for the format this
-	 * filter represents). 
-	 */
 	synchronized public void setActiveFileFilter(FileFormat filter) {
 		this.filter = filter; 
 	}
 	
-	/**
-	 * Set the selected file. Into this file the builder will 
-	 * spit its output. 
-	 */
 	synchronized public void setSelectedFile(String filename) { 
 		this.filename = filename; 
 	}
 	
-	
-	/**
-	 * Set a particular select query. The manager will execute this select query
-	 * and update the <code>resultId</code> if Projections are not used.
-	 * On the other hand, if Projections are used, it is the <code>setTemplate()</code>
-	 * that executes the query after it adds desired projections.
-	 */
 	synchronized public void setSelectQuery(SelectQuery query) { 
 		// Close the previous query!
 		if(this.query != null) try {
-			db.closeQuery(this.query);  // This must go here because of the RMI!
+			db.closeQuery(this.query);
 		} catch (Exception e) {
 			// Never mind.
 		}
@@ -236,13 +194,7 @@
 	
 	
 	
-	
-	/**
-	 * Start the export procedure. The export will run in its own thread.
-	 * 
-	 * @throws ExportException	If information provided is not complete.
-	 * @throws IOException	If anything with the file goes wrong (insufficient disk space, insufficient permissions).
-	 */
+
 	synchronized public ExportTask2 createExportTask() 
 	throws ExportException, IOException, DBLayerException {
 		// Check if all necessary components are valid.
@@ -302,7 +254,6 @@
 		}
 
 		
-		// Start a new task.
 		ExportTask2 t = new ExportTask2(db, query, writer, builder, selection);
 		t.ignoreDead( filter.ignoreDead() );
 		
@@ -321,7 +272,7 @@
 	
 		
 	/**
-	 * @return The list of filters describing formats this Export Manager can handle.
+	 * @return The list of file formats this Export Manager can handle.
 	 */
 	public FileFormat[] getFileFormats() {
 		return filters.clone();

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -59,7 +59,7 @@
 			putValue(NAME, L10n.getString("Export.Title"));
 		}
 		public void actionPerformed(ActionEvent arg0) {
-			Projection t = viewB.tsm.getTemplate();
+			Projection t = viewB.tsm.getProjections();
 			viewB.setVisible(false);
 			model.setTemplate( t ); // Set the new template.
 			viewB.tsm.clearSelection();

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -8,7 +8,7 @@
 
 import java.awt.Frame;
 
-import net.sf.plantlore.client.export.component.TemplateSelectionModel;
+import net.sf.plantlore.client.export.component.ProjectionSelectionModel;
 import net.sf.plantlore.client.export.component.ExtendedTree;
 import net.sf.plantlore.l10n.L10n;
 
@@ -18,13 +18,13 @@
  */
 public class ExportMngViewB extends javax.swing.JDialog {
 	
-	protected TemplateSelectionModel tsm;
+	protected ProjectionSelectionModel tsm;
     
     /** Creates new form ExportMngView */
     public ExportMngViewB(Frame parent) {
     	super(parent, true);
     	
-    	tsm = new TemplateSelectionModel( new Projection() );
+    	tsm = new ProjectionSelectionModel( new Projection() );
     	
         initComponents();
         getRootPane().setDefaultButton(next);

Modified: trunk/src/net/sf/plantlore/client/export/ExportTask2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -187,7 +187,7 @@
 			ao.setOccurrence( null ); // cut off the way back to the occurrence
 			if(ao.isDead() && ignoreDead) continue;
 			
-			logger.debug("New author-occurence record: " + ao);
+			logger.debug("New author-occurence record: " + ao.toFullString());
 			
 			build.part( ao );
 		}
@@ -199,7 +199,18 @@
 	
 	
 	/**
-	 * Reconstruct the record from the given values. 
+	 * Reconstruct the record from the given values, if projections were used.
+	 * <br/>
+	 * An example: Let us suppose that we created projection for 
+	 * <code>Occurrence.ID</code> and <code>Plant.TAXON<code> and
+	 * <code>NearestVillage.NAME</code>. Database layer returns
+	 * [3292, "Rubus sp.", "?esk? Bud?jovice"]. The `description` is the key to
+	 * those values, as it says:
+	 * <code>Occurrence.ID = 3292</code>,
+	 * <code>Plant.TAXON = Rubus sp.</code> and
+	 * <code>NearestVillage = ?esk? Bud?jovice</code>.
+	 * <br/>
+	 * Without the description we would not know what value belongs to which column.
 	 * 
 	 * @param values	Values of columns (in the same order as in the Description).
 	 * @return	The reconstructed record.

Modified: trunk/src/net/sf/plantlore/client/export/Projection.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/Projection.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/Projection.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -12,96 +12,130 @@
 
 
 /**
- * The template holds information about the selected columns and tables.
- * This information may used by builders and access rights managers
- * to decide, whether or not the currently
- * considered column should be exported / is accessible.
+ * The Projection class holds information about the selected columns and tables.
+ * This information may used by builders  to decide, whether or not 
+ * the currently considered column should be exported.
  * <br/>
- * Note: The template doesn't know anything about the structure
+ * Note: The Projection doesn't know anything about the structure
  * (mapping) of the database.  
  * <br/>
- * A little dictionary:
  * <ul>
  * <li><i>foreign key</i> a column of a table that refers to another table,</li>
  * <li><i>property</i> a column of a table that contains a (possibly null) value,
  * but doesn't refer to another table</li>
  * <li><i>nn</i> a property that cannot be null (defined in the db model)</li>
  * </ul>
+ * <br/>
+ * The list of projections can be applied to a query in order to set its projections.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-22
- * @version 1.1
+ * @version 1.3
  */
 public class Projection {
 	
 	/** The list of all pairs Table.Column that are set. */
 	private Collection<String> columns = new HashSet<String>(100);
 	
-	
 
-	
-	/** Create a new template. */
+	/** 
+	 * Create a new Projection. 
+	 * No columns are selected. 
+	 */
 	public Projection() {/* Nothing to be done. Just to have a default constructor. */}
 	
-	/** A copy constructor. */
-	public Projection(Projection template) {
-		columns = new HashSet<String>( template.columns );
+	/**
+	 * Create a new Projection. Use the same values as the supplied <code>projection</code>.
+	 * 
+	 * @param projection	The Projection that should be copied.
+	 */
+	public Projection(Projection projection) {
+		columns = new HashSet<String>( projection.columns );
 	}
 	
-	
+	/**
+	 * @return A shallow copy of this Projection.
+	 */
 	@Override
 	public Projection clone() {
 		return new Projection(this);
 	}
 	
-	
-	/** Select the <code>table.column</code>. */
+	/** 
+	 * Add the <code>table.column</code> to the list of projections.
+	 * 
+	 * @param table		The class representing the table.
+	 * @param column	The name of the column.
+	 * @return	Itself.
+	 */
 	public Projection set(Class table, String column) { 
-		System.out.println("+ "+table.getSimpleName()+"."+column);
 		columns.add(table.getSimpleName()+ (column == null ? "" : "."+column));
 		return this;
 	}
 	
-	/** Unselect the <code>table.column</code>. */
+	/**
+	 * Remove the <code>table.column</code> from the list of projections.
+	 * 
+	 * @param table		The class representing the table.
+	 * @param column	The name of the column.
+	 * @return Itself.
+	 */ 
 	public Projection unset(Class table, String column) { 
-		System.out.println("- "+table.getSimpleName()+"."+column);
 		columns.remove(table.getSimpleName()+ (column == null ? "" : "."+column));
 		return this;
 	}
 	
-	/** @return true if the <code>table.column</code> is set.*/
+	/** 
+	 * 
+	 * @param table	The class representing the table.
+	 * @param column	The name of the column.
+	 * @return True if the <code>table.column</code> is part of the list of projections.
+	 */
 	public boolean isSet(Class table, String column) {
 		return columns.contains(table.getSimpleName()+ (column == null ? "" : "."+column));
 	}
 	
-	/** Unselect all columns of all tables. */
+	/** 
+	 * Deselect all columns of all tables - deselect everything.
+	 * 
+	 *  @return Itself.
+	 */
 	public Projection unsetEverything() { 
 		columns.clear();
 		return this;
 	}
 	
-	/** Select all columns (properties) of all tables. */
+	/** 
+	 * Select all columns (properties) of all tables.
+	 * 
+	 *  @return Itself.
+	 */
 	public Projection setEverything() {
 		for(Class table : Record.BASIC_TABLES)
 			setAllProperties(table);
 		return this;
 	}
 	
-	/** Select all not null columns (properties). */
-	public void setEverythingNN() {
-		// Implementation missing!
-	}
-	
-	/** Select all properties of this <code>table</code>. */
+	/** 
+	 * Select all properties of the <code>table</code>.
+	 * 
+	 * @param table	The table whose properties shall be set.
+	 * @return Itself.
+	 */
 	public Projection setAllProperties(Class table) {
 		try {
 			for( String column : ((Record)table.newInstance()).getProperties() )
 				set(table, column);
-		} catch(Exception e) {/* Not good :/. */}
+		} catch(Exception e) {/* This should not happen. */}
 		return this;
 	}
 	
-	/** Select all not-null properties of the specified <code>table</code>. */
+	/**
+	 * Select all not-null properties of the specified <code>table</code>. 
+	 * 
+	 * @param table	The table whose properties shall be set.
+	 * @return Itself.
+	 */
 	public Projection setAllNN(Class table) {
 		try {
 			Record record = ((Record)table.newInstance());
@@ -109,12 +143,12 @@
 			nnProperties.removeAll(record.getForeignKeys());
 			for( String column :  nnProperties )
 				set(table, column);
-		} catch(Exception e) {/* Not good. */}
+		} catch(Exception e) {/* This should not happen. */}
 		return this;
 	}
 	
 	/**
-	 * @return true if nothing is selected.
+	 * @return True if nothing is selected.
 	 */
 	public boolean isEmpty() {
 		return columns.isEmpty();
@@ -122,10 +156,10 @@
 	
 		
 	/**
-	 * Match this template against another one.
+	 * Match this list of projections against another one.
 	 * 
-	 * @param t	The template against which the matching will be done.
-	 * @return	True if this template is a superset of the other template.
+	 * @param t	The list against which the matching will take place.
+	 * @return	True if this list of projections is a superset of the other.
 	 */ 
 	public boolean match(Projection t) { 
 		return columns.containsAll(t.columns); 
@@ -134,6 +168,19 @@
 	
 	private List<Pair<Class, String>> plan;
 	
+	/**
+	 * Description of the columns. If projections are used 
+	 * then Hibernate will return a list of values. 
+	 * So as to be able to distinguish what value belongs
+	 * to which column, we need the list of <code>table.column</code>.
+	 * The description of the columns together with the list of values
+	 * can be used to restore the original record.
+	 * 
+	 * @return	The list of <code>table.column</code> that identifies the name
+	 * of the table and column where a value might belong. 
+	 * 
+	 *  @see net.sf.plantlore.client.export.ExportTask2#reconstruct(Object[])
+	 */
 	public List<Pair<Class, String>> getDescription() {
 		return plan;
 	}
@@ -144,6 +191,8 @@
 	 * @param q	The query to be modified.
 	 * @param tables	The important tables. The first table is considered the root table.
 	 * @return The column description.
+	 * 
+	 * @see net.sf.plantlore.client.export.ExportTask2#reconstruct(Object[])
 	 */
 	public List<Pair<Class, String>> addProjections(SelectQuery q, Class...tables) {
 		plan = new ArrayList<Pair<Class,String>>(20);

Modified: trunk/src/net/sf/plantlore/client/export/builders/CSVBuilder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/builders/CSVBuilder.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/builders/CSVBuilder.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -13,7 +13,16 @@
 /**
  * CSV Builder.
  * 
- * The first line is the list of names of exported columns.
+ * The builder produces a comma separated values file format.
+ * The first line is the list of names of exported columns;
+ * the rest of the file contains values of those columns.
+ * <br/>
+ * A sample output:
+ * <br/>
+ * <pre>
+ * Author.WholeName, Author.Email, Plant.Taxon, Plant.CzechName 
+ * Erik Kratochv?l, discontinuum at gmail.com, Gagea pratensis (Pers.) Dumort., ostru?in?k m?kk?
+ * <pre>
  *  
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-23
@@ -44,10 +53,7 @@
 	
 	/**
 	 * Create a new CSV Builder. 
-	 * The output is written in the format of comma separated values:<br/>
-	 * <pre>
-	 * Erik Kratochv?l, discontinuum at gmail.com, Gagea pratensis (Pers.) Dumort., ostru?in?k m?kk?
-	 * <pre>
+
 	 * 
 	 * @param output	The writer where the output will be sent.
 	 * @param tmp	The template that describes the selected columns and tables.

Modified: trunk/src/net/sf/plantlore/client/export/builders/TrainingBuilder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/builders/TrainingBuilder.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/builders/TrainingBuilder.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -10,7 +10,8 @@
  * Convenient if you wish to see the results immediately
  * on the default output.
  * <br/>
- * The output has the following form:<br/>
+ * A sample output:
+ * <br/>
  * <pre>
  * &lt;157&gt;
  *   Author.WholeName = Erik Kratochv?l
@@ -27,27 +28,47 @@
 	
 	private int i = 0;
 	
-	public TrainingBuilder(Projection template) {
-		super(template);
+	/**
+	 * Create a new Training Builder. 
+	 * 
+	 * @param projections	The list of columns that shall be sent to the output.
+	 */
+	public TrainingBuilder(Projection projections) {
+		super(projections);
 	}
  
+	/**
+	 * Create a header of the output.
+	 */
 	public void header() throws IOException {
 		System.out.println("Training Builder engaged.");		
 	}
   
+	/**
+	 * Create a footer of the output.
+	 */
 	public void footer() throws IOException {
 		System.out.println("Training Builder disengaged.");
 	}
  
+	/**
+	 * Start processing another record.
+	 */
 	public void startRecord() throws IOException {
 		System.out.println(" <" + i + ">");
 	}
 
+	/**
+	 * Finish processing of the record.
+	 */
 	public void finishRecord() throws IOException {
 		System.out.println(" </" + i + ">");
 		i++;
 	}
 	
+	/**
+	 * Send a part of the record to the output.
+	 */
 	protected void output(Class table, String column, Object value) throws IOException {
 		System.out.println("   " + table.getSimpleName() + "." + column + " = " + value);
 	}

Modified: trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -13,20 +13,30 @@
 import net.sf.plantlore.common.record.*;
 
 /**
- * An improved version of the previous XMLBuilder. 
- * This XMLBuilder is capable of creating files of virtually any size.
- * The builder uses the Dom4j to create just one Occurrence element
- * at a time; that element is written down when another Occurrence
- * record arrives to be processed. 
+ * This XMLBuilder creates a XML tree from the supplied records.
+ * The builder uses the Dom4j to create just one element at a time; 
+ * that element is written down when another record arrives to be processed. 
  * <br/>
  * This way, the creation of an element is handled by the Dom4j 
  * (all those necessary conversions 
  * of <code>&gt;</code> to <code>&amp;gt;</code> etc.)
+ * but it does not share the Dom4j's greatest weakness: its hunger for memory,
+ * because the whole document is not kept in memory.
  * <br/>
+ * A sample output:
+ * <br/>
+ * <pre>
+ *   &lt;plant&gt;
+ *      &lt;taxon&gt;Gagea pratensis (Pers.) Dumort.&lt;/taxon&gt;
+ *      &lt;czechname&gt;ostru?in?k m?kk?&lt;/czechname&gt;
+ *   &lt;/plant&gt; 
+ * </pre>
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-07-21
- *
+ * @version 2.0
+ * 
+ * @see net.sf.plantlore.client.export.Builder
  */
 public class XMLBuilder2 implements Builder {
 	

Modified: trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -15,37 +15,38 @@
 
 /**
  * The extension of a JTree that allows the User to see the database model
- * in a compact form. The tree expects the database hierarchy when it's created.
+ * in a compact form. The tree expects a database hierarchy - that hierarchy will
+ * be traversed to build the tree.
+ * <br/>
  * Two default hierarchies are already present - the <code>DefaultHierarchy</code>
  * which is loaded when no other hierarchy is specified and displays the database
- * model in the hierarchy, 
+ * model in the natural hierarchy (i.e. following the database model), 
  * and the <code>SimpleHierarchy</code> which is a simplified version with
  * all tables as sub-root nodes.
  * Both hierarchies are hard-wired and must be updated if the database
  * model changes!
  * <br/>
- * The selected nodes are visualized to the User in another colour.
+ * The selected (marked) nodes are visualized to the User in another colour.
  * Collapsing a node <b>will cause</b> deselection of all of its selected
  * sub-nodes. This is a feature that will prevent the User from selecting
  * a group of columns and forgeting about them. 
  * <br/>
- * The XTree uses instances of XNode class - that is, the label of the
- * node is derived from the XNode.toString(). Should you have a desire
- * to implement the L10N, modify that method appropriatelly.
+ * The ExtendedTree uses instances of UserTreeNode class - that is, the label of the
+ * node is derived from the UserTreeNode.toString(). 
  * <br/>
- * The XTree cannot produce a Projection - in order to create and update 
+ * The ExtendedTree cannot produce a list of projections - in order to create and update 
  * the Projection "automatically" create your own TreeSelectionModel
  * that is capable of such an action. 
  * <pre>
- * XTree tree = new XTree( );
+ * ExtendedTree tree = new ExtendedTree( );
  * tree.setSelectionModel( new YSelectionModel() );
  * </pre>
  * where
  * <pre>
- * class TemplateSelectionModel extends DefaultTreeSelectionModel {
- * 		private Projection template;
+ * class ProjectionSelectionModel extends DefaultTreeSelectionModel {
+ * 		private Projection projection;
  * 
- *		// Use this to achieve compatibility with the default XTree selection model.
+ *		// Use this to achieve compatibility with the default ExtendedTree selection model.
  *		@Override 
  *		public void setSelectionPath(TreePath path) {
  *			if( isPathSelected(path) )
@@ -56,10 +57,10 @@
  *		@Override 
  *		public void removeSelectionPaths(TreePath[] paths) {
  *			for(TreePath path : paths) {
- *				XNode x  = (XNode) 
+ *				UserTreeNode x  = (UserTreeNode) 
  *					((DefaultMutableTreeNode)path.getLastPathComponent())
  *					.getUserObject();
- *				template.unset(x.table, x.column);    // update the Projection 
+ *				projection.unset(x.table, x.column);    // update the list of projections 
  *			} 
  *			super.removeSelectionPaths( paths ); 
  *		}
@@ -74,7 +75,7 @@
  * @since 2006-04-29
  * @version 1.0
  * @see net.sf.plantlore.client.export.Projection
- * @see net.sf.plantlore.client.export.ExportMng.XSelectionModel
+ * @see net.sf.plantlore.client.export.ExportMng.ProjectionSelectionModel
  */
 public class ExtendedTree extends javax.swing.JTree {
 	
@@ -284,7 +285,7 @@
 	};
 	
 	/**
-	 * Create a new XTree with the Default Hierarchy Model.
+	 * Create a new ExtendedTree with the Default Hierarchy Model.
 	 */
 	public ExtendedTree( ) {
 		this( DefaultHierarchy );
@@ -292,7 +293,8 @@
 	
 		
 	/**
-	 * Create a new XTree with a specified Hierarchy Model.
+	 * Create a new ExtendedTree using the specified Hierarchy Model.
+	 * 
 	 * @param hierarchy The hierarchy to be processed.
 	 */
 	public ExtendedTree( Object[] hierarchy ) {
@@ -371,7 +373,7 @@
 	
 	
 	/**
-	 * SPecialized Cell Renderer that shows no icons and
+	 * Specialized Cell Renderer that shows no icons and
 	 * displayes mandatory columns with a different coulour.
 	 * 
 	 * @author Erik Kratochv?l (discontinuum at gmail.com)

Modified: trunk/src/net/sf/plantlore/client/export/component/FileFormat.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/FileFormat.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/component/FileFormat.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -7,8 +7,12 @@
 
 /**
  * An implementation of a FileFilter.
- * The XFilter stores a list of extensions
- * that are related to a particular format.
+ * The FileFormat stores a list of extensions that are related to a particular format and
+ * some switches that further describe the format - such as whether the format accepts
+ * records that were marked as deleted (ignoreDead) or whether the whole record is to
+ * be exported or the User can pick only some columns (columnSelection).
+ * 
+ * 
  * <br/>
  * For example: 
  * <code>Comma Separated Values (*.txt, *.csv)</code>
@@ -26,22 +30,24 @@
 	private boolean ignoreDead = true;
 	
 	/**
-	 * Create a new XFilter.
+	 * Create a new FileFormat.
 	 * 
-	 * @param description The description of the filter.
+	 * @param description The description of the filter - some textual string that may be presented to the User.
 	 * @param extensions	The list of extensions that are related to this filter.
 	 */
 	public FileFormat(String description, String... extensions) {
 		this.description = description;
-		this.extensions = new ArrayList<String>( extensions.length );
-		for(String ext : extensions) this.extensions.add(ext);
+		this.extensions = new ArrayList<String>(extensions.length);
+		for (String ext : extensions)
+			this.extensions.add(ext);
 	}
 	
 	/**
-	 * Create a new XFilter.
+	 * Create a new FileFormat.
 	 * 
-	 * @param description	The description of the filter.
-	 * @param columnSelectionEnabled	The format allows further modifications.
+	 * @param description	The description of the filter - some textual string that may be presented to the User.
+	 * @param columnSelectionEnabled	The user can select which columns will be exported.
+	 * @param ignoreDead		The format should contain only those records that were not marked as deleted.
 	 * @param extensions	The list of extensions that are related to this filter.
 	 */
 	public FileFormat(String description, boolean columnSelectionEnabled, boolean ignoreDead, String... extensions) {
@@ -58,7 +64,7 @@
 	}
 	
 	/**
-	 *	@return True if dead records should be omited.
+	 *	@return True if dead records should be omitted.
 	 */
 	public boolean ignoreDead() {
 		return ignoreDead;

Added: trunk/src/net/sf/plantlore/client/export/component/ProjectionSelectionModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/ProjectionSelectionModel.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/component/ProjectionSelectionModel.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -0,0 +1,91 @@
+package net.sf.plantlore.client.export.component;
+
+import javax.swing.tree.DefaultMutableTreeNode;
+import javax.swing.tree.DefaultTreeSelectionModel;
+import javax.swing.tree.TreePath;
+
+import net.sf.plantlore.client.export.Projection;
+
+/**
+ * A TreeSelectionModel modified to update a list of projections. 
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-04-29
+ * @see net.sf.plantlore.client.export.component.ExtendedTree
+ * @see net.sf.plantlore.client.export.component.UserTreeNode
+ */
+public class ProjectionSelectionModel extends DefaultTreeSelectionModel {
+	
+	private Projection projections;
+	
+	
+	/**
+	 * Create a new ProjectionSelectionModel and use the supplied projections
+	 * to store the selected columns.
+	 * 
+	 * @param projections
+	 */
+	public ProjectionSelectionModel(Projection projections) {
+		this.projections = projections;
+	}
+	
+	/**
+	 * Setting a selection path
+	 * adds the selection path if it is not selected
+	 * or removes it if it is selected.
+	 */
+	@Override 
+	public void setSelectionPath(TreePath path) {
+		if( isPathSelected(path) )
+			removeSelectionPath(path);
+		else
+			addSelectionPath(path);
+	}
+	
+	/**
+	 * Update the list of projections appropriately.
+	 */
+	@Override 
+	public void removeSelectionPaths(TreePath[] paths) {
+		for(TreePath path : paths) {
+			if(path == null) continue;
+			Object node = path.getLastPathComponent();
+			if(node instanceof DefaultMutableTreeNode) {
+				UserTreeNode x  = (UserTreeNode) ((DefaultMutableTreeNode)node).getUserObject();
+				projections.unset(x.table, x.column);  
+			}
+		}
+		super.removeSelectionPaths( paths );
+	}
+	
+	/**
+	 * Update the list of projections appropriately.
+	 */
+	@Override 
+	public void addSelectionPaths(TreePath[] paths) {
+		for(TreePath path : paths) {
+			Object node = path.getLastPathComponent();
+			if(node instanceof DefaultMutableTreeNode) {
+				UserTreeNode x  = (UserTreeNode) ((DefaultMutableTreeNode)node).getUserObject();
+				// Select table.column records (not the table only). 
+				if(x.column != null) projections.set(x.table, x.column);
+			}
+		}
+		super.addSelectionPaths( paths );
+	}
+	
+	@Override
+	public void clearSelection() {
+		super.clearSelection();
+		projections.unsetEverything();
+	}
+			
+	/**
+	 * 
+	 * @return The list of projections (the list of selected columns).
+	 */
+	public Projection getProjections() {
+		return projections;
+	}
+	
+}

Deleted: trunk/src/net/sf/plantlore/client/export/component/TemplateSelectionModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/TemplateSelectionModel.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/component/TemplateSelectionModel.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,86 +0,0 @@
-package net.sf.plantlore.client.export.component;
-
-import javax.swing.tree.DefaultMutableTreeNode;
-import javax.swing.tree.DefaultTreeSelectionModel;
-import javax.swing.tree.TreePath;
-
-import net.sf.plantlore.client.export.Projection;
-
-/**
- * A TreeSelectionModel modified to update a Projection. 
- * 
- * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 29.4.2006
- * @see net.sf.plantlore.client.export.component.ExtendedTree
- * @see net.sf.plantlore.client.export.component.UserTreeNode
- */
-public class TemplateSelectionModel extends DefaultTreeSelectionModel {
-	
-	private Projection template;
-	
-	
-	
-	public TemplateSelectionModel(Projection template) {
-		this.template = template;
-	}
-	
-	/**
-	 * Setting a selection path
-	 * adds the selection path if it is not selected
-	 * or removes it if it is selected.
-	 */
-	@Override 
-	public void setSelectionPath(TreePath path) {
-		if( isPathSelected(path) )
-			removeSelectionPath(path);
-		else
-			addSelectionPath(path);
-	}
-	
-	/**
-	 * Update the Projection appropriately.
-	 */
-	@Override 
-	public void removeSelectionPaths(TreePath[] paths) {
-		for(TreePath path : paths) {
-			if(path == null) continue;
-			Object node = path.getLastPathComponent();
-			if(node instanceof DefaultMutableTreeNode) {
-				UserTreeNode x  = (UserTreeNode) ((DefaultMutableTreeNode)node).getUserObject();
-				template.unset(x.table, x.column);  
-			}
-		}
-		super.removeSelectionPaths( paths );
-	}
-	
-	/**
-	 * Update the Projection appropriately.
-	 */
-	@Override 
-	public void addSelectionPaths(TreePath[] paths) {
-		for(TreePath path : paths) {
-			Object node = path.getLastPathComponent();
-			if(node instanceof DefaultMutableTreeNode) {
-				UserTreeNode x  = (UserTreeNode) ((DefaultMutableTreeNode)node).getUserObject();
-				// Select table.column records (not the table only). 
-				if(x.column != null) template.set(x.table, x.column);
-			}
-		}
-		super.addSelectionPaths( paths );
-	}
-	
-	@Override
-	public void clearSelection() {
-		super.clearSelection();
-		template.unsetEverything();
-	}
-			
-	/**
-	 * 
-	 * @return A copy of the inner template that stores the list of selected columns.
-	 */
-	public Projection getTemplate() {
-		return template;
-	}
-	
-}

Modified: trunk/src/net/sf/plantlore/client/export/component/UserTreeNode.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/UserTreeNode.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/export/component/UserTreeNode.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -3,16 +3,17 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
- * A representation of a node in an XTree.
+ * A representation of a node in an ExtendedTree.
  * Every node corresponds to a <code>column</code> of a <code>table</code>.
- *  
+ * This is meant merely as a holder object - the hierarchy is represented elsewhere
+ * and in a different way.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-29
  * @see net.sf.plantlore.client.export.component.ExtendedTree
  */
 public class UserTreeNode {
-	/** The table whose columns this node represents. */
+	/** The table whose column this node represents. */
 	public Class table;
 	/** The column of the table this node represents. */
 	public String column;
@@ -20,15 +21,17 @@
 	public boolean nn;
 	
 	/**
-	 * Create a new XNode. The node represents 
-	 * a (possibly mandatory) column of a table.
+	 * Create a new UserTreeNode. 
+	 * The node represents one (possibly mandatory) column of a table.
 	 */
 	public UserTreeNode(Class table, String column, boolean notNullProperty) {
-		this.table = table; nn = notNullProperty; this.column = column;
+		this.table = table; 
+		this.nn = notNullProperty; 
+		this.column = column;
 	}
 	
 	/**
-	 * Create a new XNode. The node represents a column of a table.
+	 * Create a new UserTreeNode. The node represents a column of a table.
 	 */
 	public UserTreeNode(Class table, String column) {
 		this(table, column, false);
@@ -36,7 +39,6 @@
 	
 	/**
 	 * Get the name of the column.
-	 * TODO: L10n may be useful here!
 	 */
 	@Override
 	public String toString() {

Modified: trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -3,15 +3,19 @@
 import java.awt.event.ActionEvent;
 
 import javax.swing.AbstractAction;
-import javax.swing.JOptionPane;
 
 import net.sf.plantlore.common.DefaultCancelAction;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBarEx;
 import net.sf.plantlore.common.Task;
-import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
 
-
+/**
+ * The mapping of buttons in the view to actions.
+ * The User can click to start the Connection to the database.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class AuthCtrl {
 	
 	private AuthView view;
@@ -23,7 +27,10 @@
 		view.discard.setAction( new DefaultCancelAction(view) );
 	}
 
-	
+	/**
+	 *	Gather the information from the dialog and 
+	 * execute the connection task.
+	 */
 	class NextAction2 extends AbstractAction {
 		public NextAction2() {
 			putValue(SHORT_DESCRIPTION, L10n.getString("Login.AuthorizeTT"));
@@ -31,29 +38,21 @@
 		}
 		public void actionPerformed(ActionEvent arg0) {
 			String user = ((javax.swing.JTextField)view.user.getEditor().getEditorComponent()).getText();
-
 			Task connect = model.createConnectionTask(user, new String(view.password.getPassword()));
 			
 			// My own ProgressBar - 
-			// it is not clever to offer reconnection after the login failed...
+			// it would not be wise to offer reconnection right after the login failed...
 			new DefaultProgressBarEx(connect, view, true) {
 				@Override
 				public void exceptionHandler(Exception ex) {
 					getTask().stop();
-					
-					String problem = ex.getMessage();
-					//TODO: DEFAULTNI HANDLER!
-					if(ex instanceof DBLayerException && ex.getCause() != null )
-						problem = problem + ( (DBLayerException)ex ).getErrorInfo();
-					
-					JOptionPane.showMessageDialog( 
-							parent, 
-							problem, 
-							L10n.getString("Error.ConnectionFailed"), 
-							JOptionPane.ERROR_MESSAGE );
+					DefaultExceptionHandler.handle(parent, ex, L10n.getString("Login.ConnectionFailed"), true);
 				}
 			};
 			connect.start();
+			
+			// Discard the password!
+			view.password.setText("");
 		}
 	}
 	

Modified: trunk/src/net/sf/plantlore/client/login/AuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,9 +1,3 @@
-/*
- * AuthView.java
- *
- * Created on 9. duben 2006, 18:04
- */
-
 package net.sf.plantlore.client.login;
 
 import java.awt.Cursor;
@@ -16,12 +10,17 @@
 import net.sf.plantlore.middleware.DBLayer;
 
 /**
- *
- * @author  yaa
+ * The view allows the User to specify the Authentication information
+ * - the User name (or the Account name) and the Password of that account.
+ * 
+ * The list of User names is reloaded accoring to the currently selected record
+ * in the LoginView.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
  */
 public class AuthView extends javax.swing.JDialog implements Observer {
 	
-    /** Creates new form AuthView */
+    
     public AuthView(Dialog parent, Login model) {
     	super(parent, true);
     	
@@ -115,6 +114,7 @@
     
     /**
      * Reload the list of usernames according to the currently selected record.
+     * Hide the dialog if it is no longer necessary.
      */
     public void update(Observable source, final Object arg) {
     	java.awt.EventQueue.invokeLater(new Runnable() {
@@ -127,21 +127,9 @@
     				password.setText("");
     				setTitle(L10n.getString("Login.ConnectingTo") + " " + selected.toString());
     			}
-    			// Exception! We must display the exception to the user.
-//    			else if(arg instanceof Exception) {
-//    				next.setEnabled(true);
-//    				setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-//    				JOptionPane.showMessageDialog(
-//    						null, 
-//    						((Exception)arg).getMessage(), 
-//    						L10n.getString("Error.LoginFailed"), 
-//    						JOptionPane.ERROR_MESSAGE);
-//    			}
     			// The database layer has been created, we are no longer neccessary
-    			else if(arg instanceof DBLayer) {
+    			else if(arg instanceof DBLayer) 
     				setVisible(false);
-    				password.setText(""); // Erase the password from the field.
-    			}
     		}
     	});
 	}

Modified: trunk/src/net/sf/plantlore/client/login/DBInfo.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/DBInfo.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/DBInfo.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,17 +1,21 @@
 package net.sf.plantlore.client.login;
 
 /**
- * Store information about one DB.
+ * Store information about one database connection.
+ * 
  * <ul>
- * <li><b>alias</b> ~ the name that will be presented to the user (such as <i>"Home Database"</i>)</li>
- * <li><b>host</b> ~ the host name of the server where the database is located</li>
- * <li><b>port</b> ~ the port number where the server listens</li>
- * <li><b>db</b> ~ the database identificator</li>
- * <li><b>user</b> ~ last five user names that have been used for authentication</li>
+ * <li><b>alias</b> The name that will be presented to the User (such as <i>"Home Database"</i>)</li>
+ * <li><b>host</b> The host name or ip address where the Server is located.</li>
+ * <li><b>port</b> The port where the Server listens.</li>
+ * <li><b>databaseType</b> The type of the database engine (postgresql, oraclesql, etc.)</li>
+ * <li><b>databasePort</b> The port where the database engine listens.</li>
+ * <li><b>databaseIdentifier</b> The database identifier (usually a name of the database).</li>
+ * <li><b>databaseParameter</b> Some additional parameter for the JDBC connection string.</li>
+ * <li><b>user</b> The list of last user names that have been used during Authentication.</li>
  * </ul>
  * 
  * @author Erik Kratochv?l
- * @version 1.0 final
+ * @version 4.0
  */
 public class DBInfo {
 	protected String alias;
@@ -24,10 +28,9 @@
 	protected String[] users;
 	
 	/**
-	 * Pick a user. The selected name will be moved to the start of the list.
-	 * The selected user will be at the top of the list next time.
+	 * Move the selected name to the top of the list.
 	 * 
-	 * @param name	The chosen user.
+	 * @param name		The chosen user.
 	 */
 	public void promoteUser(String name) {
 		int id = users.length - 1;
@@ -45,12 +48,26 @@
 		return alias;
 	}
 	
-	
+	/**
+	 * Create a shallow copy of this DBInfo.
+	 */
 	public DBInfo clone() {
 		return new DBInfo(
 				alias, host, port, databaseType, databasePort, databaseIdentifier, databaseParameter, users );
 	}
 
+	/**
+	 * Create a new DBInfo.
+	 * 
+	 * @param alias	The name that will be presented to the User (such as <i>"Home Database"</i>)
+	 * @param host	The host name or ip address where the Server is located.
+	 * @param port	The port where the Server listens.
+	 * @param databaseType	The type of the database engine (postgresql, oraclesql, etc.)
+	 * @param databasePort	The port where the database engine listens.
+	 * @param databaseIdentifier	The database identifier (usually a name of the database).
+	 * @param databaseParameter	Some additional parameter for the JDBC connection string.
+	 * @param users	 The list of last user names that have been used during Authentication.
+	 */
 	public DBInfo(String alias, String host, int port, String databaseType, int databasePort, String databaseIdentifier, String databaseParameter, String[] users) {
 		this.alias = alias;
 		this.host = host;
@@ -62,35 +79,66 @@
 		this.users = users;
 	}
 
-	
+	/**
+	 * 
+	 * @return	The name that will be presented to the User (such as <i>"Home Database"</i>).
+	 */
 	public String getAlias() {
 		return alias;
 	}
 
+	/**
+	 * 
+	 * @return	The database identifier (usually a name of the database).
+	 */
 	public String getDatabaseIdentifier() {
 		return databaseIdentifier;
 	}
 
+	/**
+	 * 
+	 * @return	Some additional parameter for the JDBC connection string.
+	 */
 	public String getDatabaseParameter() {
 		return databaseParameter;
 	}
 
+	/**
+	 * 
+	 * @return	The port where the database engine listens.
+	 */
 	public int getDatabasePort() {
 		return databasePort;
 	}
 
+	/**
+	 * 
+	 * @return	The type of the database engine (postgresql, oraclesql, etc.)
+	 */
 	public String getDatabaseType() {
 		return databaseType;
 	}
 
+	/**
+	 * 
+	 * @return	The host name or ip address where the Server is located.
+	 */
 	public String getHost() {
 		return host;
 	}
 
+	/**
+	 * 
+	 * @return	The port where the Server listens.
+	 */
 	public int getPort() {
 		return port;
 	}
 
+	/**
+	 * 
+	 * @return	The list of last user names that have been used during Authentication.
+	 */
 	public String[] getUsers() {
 		return users;
 	}

Modified: trunk/src/net/sf/plantlore/client/login/ItemCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemCtrl2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/ItemCtrl2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -7,17 +7,36 @@
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.l10n.L10n;
 
+/**
+ * The mapping of buttons in the view to actions.
+ * In the ADD mode a new record is created,
+ * in the EDIT mode the selected record is altered.
+ * 
+ * Also the field validity check is performed.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class ItemCtrl2 {
 	
 	private Login model;
 	private ItemView2 view;
 	
+	/**
+	 * The Controller distinguishes two modes.
+	 * In the ADD mode all fields are blank and the record is created and added to the list.
+	 * In the EDIT mode all fields are pre-filled with values of the selected record
+	 * and then the record is altered. 
+	 */
 	public enum Mode { ADD, EDIT }
 	
 	private Mode mode = Mode.ADD;
 	
 	
-	// Switch between the ADD/EDIT behaviour
+	/**
+	 * Switch between the two modes.
+	 * 
+	 * @param m	The mode that should be used from now on.
+	 */
 	public void setMode(Mode m) {
 		this.mode = m;
 		switch(m) {
@@ -46,7 +65,12 @@
 		}
 	}
 	
-	
+	/**
+	 * Create a new Item Controller. Requires the Model and the View.
+	 * 
+	 * @param login The model.
+	 * @param itemview	The view.
+	 */
 	public ItemCtrl2(Login login, ItemView2 itemview) {
 		this.model = login; this.view = itemview;
 		view.next.setAction(new NextAction());
@@ -58,10 +82,10 @@
 	}
 	
 	
-	
-
-	
-	
+	/**
+	 * Gather the data from the dialog, perform validity checks,
+	 * and add/edit the record. 
+	 */
 	class NextAction extends AbstractAction {
 		
 		public NextAction() {
@@ -94,7 +118,7 @@
     						view, 
     						L10n.getString("Error.MissingSeveralCompulsoryFields"), 
     						L10n.getString("Error.MissingCompulsoryFieldTitle"), 
-    						JOptionPane.ERROR_MESSAGE);
+    						JOptionPane.WARNING_MESSAGE);
 					return;
 				}
 					
@@ -147,7 +171,7 @@
     						view, 
     						L10n.getString("Error.MissingSeveralCompulsoryFields"), 
     						L10n.getString("Error.MissingCompulsoryFieldTitle"), 
-    						JOptionPane.ERROR_MESSAGE);
+    						JOptionPane.WARNING_MESSAGE);
 					return;
 				}
 				

Modified: trunk/src/net/sf/plantlore/client/login/ItemView2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,9 +1,3 @@
-/*
- * ItemView2.java
- *
- * Created on 25. ?ervenec 2006, 16:25
- */
-
 package net.sf.plantlore.client.login;
 
 import java.awt.Dialog;
@@ -13,14 +7,17 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
+ * ItemView displays the dialog where the User can alter values
+ * that are required for connection making. The values are pre-filled
+ * according to the currently selected record.
  *
- * @author  yaa
+ * @author  Erik Kratochv?l
+ * @see Login#getSelected()
  */
 public class ItemView2 extends javax.swing.JDialog implements Observer {
     
 	private Login model;
 	
-    /** Creates new form ItemView2 */
     public ItemView2(Dialog parent, Login model) {
     	super(parent, true);
     	
@@ -234,7 +231,8 @@
     
     
     /**
-     * Fill all fields with information obtained from the currently selected record.
+     * Fill all fields of the dialog
+     * with information obtained from the currently selected record.
      */
     public void update(Observable arg0, Object arg1) {
 		java.awt.EventQueue.invokeLater(new Runnable() {

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -11,6 +11,8 @@
 
 import org.apache.log4j.Logger;
 
+import spin.Spin;
+
 import net.sf.plantlore.common.record.Right;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
@@ -21,15 +23,20 @@
  * Login is responsible for the following tasks:
  * <ul>
  * <li><b>management of the list of databases</b> - 
- * 			adding, editing, removing records from the list, and the persistent storage of that list,</li>
- * <li><b>creating and initializing a new dblayer</b> - only one at a time is active,</li>
- * <li><b>destroying the current dblayer (logout)</b> - so as to make another connection possible</li>
+ * 			adding, editing, removing records from the list, 
+ * 			and the invocation of methods ensuring the persistent storage of that list,</li>
+ * <li><b>creation and initialization of a new dblayer</b> -
+ * 			 only one at a time is active,</li>
+ * <li><b>proper destruction of the current dblayer (logout)</b> - 
+ * 			so as to make another connection possible</li>
+ * <li><b>repeated connection (reconnect)</b> - 
+ * 			to connect to the database again if the previous connection fails</li>
  * </ul>
  * 
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @author Jakub Kotowski
- * @version 1.0
+ * @author Jakub Kotowski (storage and retrieval of the list of databases)
+ * @version 2.0
  */
 public class Login extends Observable {
 	
@@ -65,6 +72,7 @@
 	 * new DBLayers.
 	 *  
 	 * @param factory The factory that will be used to create a new DBLayer. 
+	 * @param mainConfig The configuration tool that is capable of storing the list of databases.
 	 */
 	public Login(DBLayerFactory factory, MainConfig mainConfig) {
 		this.factory = factory;
@@ -75,7 +83,7 @@
 	
 	
 	/**
-	 * Load saved information about the database connections.
+	 * Retrieve saved information about the database connections.
 	 */
 	protected void load() {
 		logger.debug("Loading the stored list of databases.");
@@ -93,7 +101,7 @@
 	}
 	
 	/**
-	 * Save the list of database connections for further usage.
+	 * Store the list of database connections for further usage.
 	 */
 	protected void save() {
 		logger.debug("Saving the list of databases.");
@@ -108,10 +116,10 @@
 	
 
 	/**
-	 * Create a new record, add it to the list of connections and save that information for
-	 * the future use.
+	 * Create a new record, add it to the list of connections, and save that information for
+	 * future use.
 	 * 
-	
+	 * @see DBInfo
 	 */
 	synchronized public void createRecord(
 			String alias, 
@@ -145,12 +153,10 @@
 	}
 	
 	/**
-	 * Update the selected record.
+	 * Update the selected record, and save that information for
+	 * future use.
 	 * 
-	 * @param alias	Alias of the database.
-	 * @param host	Hostname of the computer where the server dwells.
-	 * @param port	Port where the server listens.
-	 * @param db		Identifier of the database to which the User wants to connect.
+	 * @see DBInfo
 	 */
 	synchronized public void updateSelectedRecord(
 			String alias, 
@@ -173,14 +179,14 @@
 		
 		save();
 		logger.debug("The selected record has been updated " + selected);
-		this.setChanged(); this.notifyObservers(UPDATE_LIST);
+		this.setChanged(); 
+		this.notifyObservers(UPDATE_LIST);
 	}
 	
 	/**
-	 * @return the list of all records.
+	 * @return The list of all records the User has created.
 	 */
 	synchronized public DBInfo[] getRecords() {
-		// Seeing is believing: http://java.sun.com/j2se/1.5.0/docs/api/java/util/Collection.html#toArray(T[])
 		return dbinfos.toArray(new DBInfo[0]);
 	}
 	
@@ -190,7 +196,7 @@
 	 * Set the selected record.
 	 * 
 	 * @param index	The index of the selected record. Zero means first. 
-	 * Negative means nothing gets selected (deselect).
+	 * Negative means nothing gets selected (a.k.a. deselect).
 	 */
 	synchronized public void setSelected(int index) {
 		if(index == lastIndex) 
@@ -222,24 +228,24 @@
 	 * update their database layers.
 	 */
 	private void announceConnection() {
-		logger.debug("New database layer created for " + proxyLayer);
+		logger.debug("New database layer created " + proxyLayer);
 		setChanged(); 
 		notifyObservers(proxyLayer);
-		logger.debug("Observers notified.");
+		logger.debug("Observer notification finished.");
 	}
 	
 
 	
 	/**
-	 * Create a task that will try to forge the connection to the selected database. 
-	 * First, a new database layer is created,
-	 * and second, that database layer is initialized.
+	 * Create a task that will build the connection to the selected database. 
 	 * <br/>
-	 * <b>Warning:</b>If there is a previously created DBLayer, 
+	 * <b>Warning:</b>If there is another (previously created) DBLayer, 
 	 * it will be destroyed using the <code>logout()</code> method. 
 	 * 	  
 	 * @param name The account name (used to access the database).  
 	 * @param password The password to the account.
+	 * 
+	 * @see #logout()
 	 */
 	synchronized public Task createConnectionTask(String name, String password) {
 		if(selected == null) {
@@ -259,13 +265,29 @@
 	}
 	
 	
-	
+	/**
+	 * The task that performs the database layer "creation" 
+	 * (using the supplied DatabaseLayerFactory - so in fact it is the Factory that creates
+	 * that DBLayer)
+	 * and it's initialization. Yet it is not the database layer that is returned - 
+	 * it is a special wrapper that performs further access checks and makes the renewal
+	 * of the database layer a little bit easier. 
+	 * 
+	 * @author Erik Kratochv?l (discontinuum at gmail.com)
+	 * @since 2006-08-30
+	 */
 	private class ConnectionTask extends Task {
 		
 		private DBInfo dbinfo;
 		private transient String name, password;
 		
-		
+		/**
+		 * Create a new connection task.
+		 * 
+		 * @param dbinfo	A holder object storing all neccessary information for the connection.
+		 * @param name		The account name (used to access the database).
+		 * @param password	The password to the account.
+		 */
 		public ConnectionTask(DBInfo dbinfo, String name, String password) {
 			this.dbinfo = dbinfo;
 			this.name = name;
@@ -280,7 +302,7 @@
 				if(isCanceled())
 					throw new Exception(L10n.getString("Common.Canceled"));
 				
-				// Create a new database layer.
+				// Create a new database layer ~ ask the DBLayerFactory to create it for us..
 				logger.debug("Asking the DBLayerFactory for a new DBLayer @ " + dbinfo.host + ":" + dbinfo.port);
 				setStatusMessage( L10n.getString("Login.Connecting") );
 				currentDBLayer = factory.create( dbinfo );
@@ -292,13 +314,15 @@
 				
 				// Initialize the database layer.
 				setStatusMessage( L10n.getString("Login.InitializingDBLayer") );
-				logger.debug("Initializing that DBLayer (" + dbinfo.databaseType + ", " + name + ", " + password + "...");
+				logger.debug("Initializing that DBLayer.");
 				
 				User init = currentDBLayer.initialize(dbinfo.getDatabaseIdentifier(), name, password);
 				if(isCanceled())
 					throw new DBLayerException(L10n.getString("Common.Canceled"));
 				plantloreUser = init;
 				accessRights = init.getRight();
+				
+				logger.debug("Initialization successful.");
 			} 
 			catch (Exception e) {
 				logger.error("The initialization of the DBLayer failed! " + e.getMessage());
@@ -308,7 +332,8 @@
 					try {
 						factory.destroy(currentDBLayer);
 					} catch(Exception re) {
-						// Nothing we can do; the server is probably in trouble, or the network connection failed. 
+						// There's nothing we can do; 
+						// the server is probably in trouble, or the network connection failed. 
 					}
 				// Re-throw the exception so that the view is updated as well.
 				throw e;
@@ -322,7 +347,7 @@
 			fireStopped(null);
 			
 			// Everything went fine - 
-			// there is a new DBLayer which is to be announced to the observers of Login.
+			// there is a new DBLayer and the observers of Login must know about it.
 			announceConnection();
 			
 			return null;
@@ -333,8 +358,9 @@
 	
 	
 	/**
-	 * Disconnect from the current database. 
-	 * The database connection is lost, any operation in progress will cause an exception.
+	 * Disconnect the User from the current database. 
+	 * The database connection will cease to exist - 
+	 * everyone using the database layer will get an exception from now on. 
 	 */
 	public void logout() {
 		if(currentDBLayer != null) 
@@ -347,20 +373,25 @@
 				logger.info("The client disconnected itself from the server. The communication may no longer be possible.");
 			} catch(RemoteException e) {
 				logger.warn("Unable to disconnect from the server. " + e.getMessage());
-				/*setChanged();
-				notifyObservers(e);*/ // Not this time, this is supposed to be silent.
+				// Not this time, this is supposed to be silent.
 			}
 	}
 	
 	
-	
+	/**
+	 * 
+	 * @return The last connection task, ie. the last task that was used to create a connection
+	 * to the database. Restarting that task will lead to the database layer renewal, 
+	 * however, this may lead to problems as old queries and resultset identifiers will
+	 * not be valid with the new database layer!
+	 */
 	synchronized public Task getLastConnectionTask() {
 		return lastConnectionTask;
 	}
 	
 		
 	/**
-	 * @return The last DBLayer that has been created.  
+	 * @return The new DBLayer that has been created.  
 	 */	
 	synchronized public DBLayer getDBLayer() { 
 		return proxyLayer; 
@@ -383,7 +414,20 @@
 	
 	
 	
-	
+	/**
+	 * The DBLayerProxy constitutes a simple wrapper of the received database layer.
+	 * It performs some additional access checks.
+	 * <br/>
+	 * The advantage of the wrapper is that its wrapped database layer can be easily
+	 * switched without clients noting anything. 
+	 * However, in some cases clients using the wrapper must be notified 
+	 * in order to restart their queries and refresh their resultsets.
+	 * 
+	 * @author Erik Kratochv?l (discontinuum at gmail.com)
+	 * @since 2006-08-30
+	 * 
+	 * @see DBLayer
+	 */
 	private class DBLayerProxy implements DBLayer {
 		
 		private DBLayer wrappedDBLayer;
@@ -394,8 +438,11 @@
 		}
 		
 				
-		synchronized public void wrap(DBLayer db) {
-			this.wrappedDBLayer = db;
+		synchronized void wrap(DBLayer db) {
+			if(db == null)
+				this.wrappedDBLayer = db;
+			else
+				this.wrappedDBLayer = (DBLayer) Spin.off( db );
 		}
 
 		synchronized public User initialize(String dbID, String user, String password) throws DBLayerException, RemoteException {
@@ -547,12 +594,12 @@
 		}
 
 		synchronized public int getConnectionCount() throws RemoteException {
-			verifyValidity();
-			return wrappedDBLayer.getConnectionCount();
+			//verifyValidity();
+			return 0; //wrappedDBLayer.getConnectionCount();
 		}
 
 		synchronized public void shutdown() throws RemoteException {
-			throw new Error("YOU SHOULD NEVER CALL DBLayer.shutdown() YOU IDIOT!");
+			throw new Error("It is forbidden to call this method. The proper way to destroy a database layer is the logout() method!");
 		}
 		
 		@Override

Modified: trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -10,7 +10,14 @@
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.l10n.L10n;
 
-
+/**
+ * The mapping of buttons in the view to actions.
+ * The User can move to the Authorization dialog,
+ * or to the Add/Edit Item dialog, or Delete one item 
+ * from the list.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class LoginCtrl {
 	
 	private Login model;
@@ -21,7 +28,12 @@
 	private AuthView authView;
 	
 	
-	
+	/**
+	 * Create a new Login Controller. Requires the Model and the View.
+	 * 
+	 * @param login The model.
+	 * @param loginview	The view.
+	 */
 	public LoginCtrl(Login login, LoginView loginview) {
 		this.view = loginview; this.model = login;
 		
@@ -43,13 +55,21 @@
 		view.choice.setSelectedIndex(0);
 	}
 	
-	
+	/**
+	 * Set either this dialog or the Authorization dialog visible.
+	 * The authorization dialog will be opened instead of this one 
+	 * if the selection is non-empty and the View.Remember checkbox is selected.
+	 *  
+	 * @param visible	True if the View should become visible.
+	 */
 	public void setVisible(boolean visible) {
 		JDialog dialog = view.remember.isSelected() && !view.choice.isSelectionEmpty() ? authView : view;
 		dialog.setVisible(visible);
 	}
 	
-	
+	/**
+	 *	Set the currently selected record in the Model accordingly. 
+	 */
 	class ChoiceChanged implements ListSelectionListener {
 		public void valueChanged(ListSelectionEvent e) {
 			int index = view.choice.getSelectedIndex();
@@ -58,6 +78,9 @@
 		}	
 	}
 	
+	/**
+	 * Open the `Add New Record` dialog. 
+	 */
 	class AddRecordAction extends AbstractAction {
 		public AddRecordAction() {
 			putValue(SHORT_DESCRIPTION, L10n.getString("Login.AddRecordTT"));
@@ -69,6 +92,9 @@
 		}
 	}
 	
+	/**
+	 *	Remove the selected record.
+	 */
 	class  RemoveRecordAction extends AbstractAction {
 		public RemoveRecordAction() {
 			putValue(SHORT_DESCRIPTION, L10n.getString("Login.RemoveRecordTT"));
@@ -79,6 +105,9 @@
 		}
 	}
 	
+	/**
+	 * Open the `Edit the Selected Record` dialog.
+	 */
 	class EditRecordAction extends AbstractAction {
 		public EditRecordAction() {
 			putValue(SHORT_DESCRIPTION, L10n.getString("Login.EditRecordTT"));
@@ -92,6 +121,9 @@
 		}
 	}
 	
+	/**
+	 * Proceed to the Authorization - open the `Authentication` dialog.
+	 */
 	class NextAction extends AbstractAction {
 		public NextAction() {
 			putValue(SHORT_DESCRIPTION, L10n.getString("Login.NextTT"));

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -14,14 +14,19 @@
 import net.sf.plantlore.middleware.DBLayer;
 
 /**
+ * The view presents the User with the list of databases the User created or
+ * accessed. The User should choose one of them and proceed to Authorization
+ * or He can modify (add/edit/delete) the list of databases.
  *
- * @author  yaa
+ * @author  Erik Kratochv?l
+ * 
+ * @see LoginCtrl
  */
 public class LoginView extends javax.swing.JDialog implements Observer {
 	
 	private Login model;
     
-    /** Creates new form LoginView */
+    
     public LoginView(Frame parent, Login model) {
     	super(parent, true);
     	
@@ -112,7 +117,8 @@
  
     
     /**
-     * Update the list of records (in case there were some changes).
+     * Update the list of records (in case there were some changes)
+     * or hide if no longer necessary.
      */
     public void update(final Observable source, final Object parameter) {
     	java.awt.EventQueue.invokeLater(new Runnable() {

Modified: trunk/src/net/sf/plantlore/common/Assistant.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Assistant.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/Assistant.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -25,6 +25,7 @@
  *
  *    
  * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @version 1.0
  */
 public class Assistant extends JScrollPane {
 

Modified: trunk/src/net/sf/plantlore/common/AutoComboBox.java
===================================================================
--- trunk/src/net/sf/plantlore/common/AutoComboBox.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/AutoComboBox.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -25,15 +25,13 @@
  * guide this time.</li>
  * </ul>
  * <br/>
- * Heavily refined from the source code created by Stephane Crasnier. 
- * <br/>
  * The use of the benevolent behaviour is discouraged as it contradicts the sole purpose 
  * of this component. If you want to allow the User 
  * to leave this field blank, use a special
  * record "------" or "not specified" instead.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @version 1.1 jlist doesn't get updated when the user types
+ * @version 1.1
  * @since The beginning of time.
  */
 public class AutoComboBox extends JComboBox {
@@ -45,7 +43,7 @@
 	
 
 	/**
-	 * Create the AutoComboBox with given array of choices.
+	 * Create a new AutoComboBox starting with the given array of choices.
 	 * 
 	 * @param choices	<b>Sorted</b> list of available choices (items).
 	 */
@@ -58,11 +56,18 @@
 		editor.setDocument(a); editor.addKeyListener(a); editor.addFocusListener(a);
 	}
 	
-	
+	/**
+	 * Create an empty AutoComboBox.
+	 */
 	public AutoComboBox() {
 		this(new String[] { null });		
 	} 
 	
+	/**
+	 * An extension of JList.addItem(). This method allows you to add several items at once.
+	 * 
+	 * @param items	The list of items to be inserted (added) into the list.
+	 */
 	public void addItems(Object[] items) {
 		for(Object item : items)
 			if(item != null) 

Modified: trunk/src/net/sf/plantlore/common/AutoComboBoxNG3.java
===================================================================
--- trunk/src/net/sf/plantlore/common/AutoComboBoxNG3.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/AutoComboBoxNG3.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,6 +1,5 @@
 package net.sf.plantlore.common;
 
-import java.awt.Color;
 import java.awt.event.FocusEvent;
 import java.awt.event.FocusListener;
 import java.awt.event.KeyEvent;
@@ -8,12 +7,9 @@
 import java.util.Arrays;
 import java.util.HashSet;
 import java.util.Set;
-import javax.swing.BorderFactory;
 
 import javax.swing.JComboBox;
 import javax.swing.JTextField;
-import javax.swing.border.Border;
-import javax.swing.plaf.basic.BasicComboBoxEditor;
 import javax.swing.plaf.metal.MetalComboBoxEditor;
 import javax.swing.text.AttributeSet;
 import javax.swing.text.BadLocationException;
@@ -89,12 +85,10 @@
 		JTextField e = (JTextField)(editor.getEditorComponent());
 		AutoDocument a = new AutoDocument(); // change the model ~~> AutoDocument 
 		e.setDocument(a); e.addKeyListener(a); e.addFocusListener(a);
-                //setBorder(BorderFactory.createLineBorder(Color.BLUE));
-                //updateUI();
 	}
 	
 	/**
-	 * Create the AutoComboBox with given array of values
+	 * Create a new AutoComboBox filled with given values.
 	 * 
 	 * @param values	<b>Sorted</b> list of available values (items).
 	 * @param strict	True if the AutoComboBox should not accept values (items)
@@ -114,11 +108,20 @@
 			super.setPopupVisible(visibility);
 	}
 	
-	
+	/**
+	 * Create an empty AutoComboBox.
+	 * 
+	 */
 	public AutoComboBoxNG3() {
 		this(new String[] { "" });		
 	} 
 	
+	/**
+	 * Create a new AutoComboBox filled with given values.
+	 * 
+	 * @param strict	True if the AutoComboBox should not accept values (items)
+	 *        that are not in the list of available values.
+	 */
 	public AutoComboBoxNG3(boolean strict) {
 		this(new String[] { "" });
                 this.strict = strict;
@@ -287,10 +290,18 @@
 		public void focusGained(FocusEvent arg0) {}
 	}
     
+	/**
+	 * 
+	 * @return The maximum number of character the user can type in the "benevolent" mode.
+	 */
 	public int getCapacity() {
 		return capacity;
 	}
 
+	/**
+	 * 
+	 * @param capacity	The maximum number of character the user can type in the "benevolent" mode.
+	 */
 	public void setCapacity(int capacity) {
 		this.capacity = capacity;
 	}

Modified: trunk/src/net/sf/plantlore/common/AutoTextArea.java
===================================================================
--- trunk/src/net/sf/plantlore/common/AutoTextArea.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/AutoTextArea.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -11,7 +11,7 @@
 /**
  * AutoTextArea is an extension of the default <code>JTextArea</code>. It operates in two modes:
  * <dl>
- * <dt>FREE_ROAM</dt>
+ * <dt>FREE ROAM</dt>
  * <dd>This mode allows the User to move freely through entries with minor limitations.
  * 	<ul>
  * 		<li><code>Up</code>, <code>Down</code>,<code>Left</code>, 
@@ -334,32 +334,55 @@
 			this.values.add(obj);
 	}
 	
-        public AutoTextArea(Container container) {
-                this(new String[] {""}, container);
-        }
-        
-        public AutoTextArea(JDialog dialog) {
-            this(new String[] {""}, dialog.getLayeredPane());
-        }
-        
-        public AutoTextArea(JFrame frame) {
-            this(new String[] {""}, frame.getLayeredPane());
-        }
-        
-        public void setChoices(Object[] choices) {
-            if (choices == null)
-                choices = new String[] {""};
-            assistant.setChoices(choices);
-            assistant.getList().addMouseListener(this);
-            this.choices = choices;
-            this.values = new HashSet<Object>(choices.length);
-            for(Object obj : choices)
-                    this.values.add(obj);
-            
-            firePropertyChange(ALLOWED_VALUES_CHANGED, null, null);
-        }
-        
 	/**
+	 * Create the AutoTextArea with a Visual Assistant that helps with choosing items from the
+	 * list of available (allowed) strings. The initial list is empty.
+	 * 
+	 * @param container	The container which the AutoTextArea is added to.  
+	 */
+	public AutoTextArea(Container container) {
+		this(new String[] {""}, container);
+	}
+	
+	/**
+	 * Create the AutoTextArea with a Visual Assistant that helps with choosing items from the
+	 * list of available (allowed) strings. The initial list is empty.
+	 * 
+	 * @param dialog	The parent dialog which the AutoTextArea is added to.  
+	 */
+	public AutoTextArea(JDialog dialog) {
+		this(new String[] {""}, dialog.getLayeredPane());
+	}
+	
+	/**
+	 * Create the AutoTextArea with a Visual Assistant that helps with choosing items from the
+	 * list of available (allowed) strings. The initial list is empty.
+	 * 
+	 * @param frame	The parent frame which the AutoTextArea is added to.  
+	 */
+	public AutoTextArea(JFrame frame) {
+		this(new String[] {""}, frame.getLayeredPane());
+	}
+	
+	/**
+	 * Replace the old list of choices with the new one.
+	 * 
+	 * @param choices	The list of new available values that will replace the old one.
+	 */
+	public void setChoices(Object[] choices) {
+		if (choices == null)
+			choices = new String[] {""};
+		assistant.setChoices(choices);
+		assistant.getList().addMouseListener(this);
+		this.choices = choices;
+		this.values = new HashSet<Object>(choices.length);
+		for(Object obj : choices)
+			this.values.add(obj);
+		
+		firePropertyChange(ALLOWED_VALUES_CHANGED, null, null);
+	}
+	
+	/**
 	 * The list of choices, or "allowed values" - for fast searching.
 	 */
 	private HashSet<Object> values;
@@ -428,52 +451,6 @@
 	}
 
 	
-//	public static void main(String[] args) throws InterruptedException {
-//		String lookAndFeel = UIManager.getSystemLookAndFeelClassName();
-//        try { UIManager.setLookAndFeel(lookAndFeel); }
-//        catch (Exception e) { JFrame.setDefaultLookAndFeelDecorated(true); }
-//        
-//        String[]
-//        	ch = {"Anubis", "Apophis", "Ayiana", "Baal", "Baldur", "Camulus", "Cronus", "Daniel Jackson",
-//					"Elizabeth Weir", "Freir", "George Hammond", "Hallowed are the Ori", "Heimdall", "Hermiod",
-//					"Chaya Sar", "Imhotep", "Jack O'Neill", "John Sheppard", "Jonas Quinn", "Khalek", "Klorel",
-//					"Loki", "Martoufe", "Master Bra'tac", "Nerus", "Oma Desala", "Penegal", "Qetesh",
-//					"Ra", "Radek Zelenka", "Replicarter", "Rodney McKay", "Ronon Dex",
-//					"Samantha Carter", "Sokar", "?evron", 
-//					"Teyla Emmagan", "The Eight", "The Fifth", "The First", "The Fourth",
-//					"The Second", "The Seventh", "The Sixth", "The Third", "Thor", "Ty'alc", "Vala Mal Doran", "Yu"};
-//        
-//		JFrame f = new JFrame();
-//		f.setDefaultCloseOperation(JFrame.EXIT_ON_CLOSE);
-//		AutoTextArea a = new AutoTextArea(ch, f); 
-//		a.setPreferredSize(new Dimension(400, 300));
-//		a.setFont(new Font("Verdana", 0, 12));
-//		a.setCapacity(5);
-//		JScrollPane sp = new JScrollPane(a);
-//		sp.setVerticalScrollBarPolicy(JScrollPane.VERTICAL_SCROLLBAR_ALWAYS);
-//		
-//		
-//		JPanel ugly = new JPanel(new BorderLayout());
-//		ugly.add(new JButton("foooooooo"), BorderLayout.WEST);
-//		ugly.add(new JButton("sue"), BorderLayout.NORTH);
-//		ugly.add(/*a*/sp, BorderLayout.CENTER);
-//		
-//				
-//		JButton b = new JButton("Done");
-//		f.getContentPane().add(new JLabel("be ugly and give some space"), BorderLayout.WEST);
-//		f.getContentPane().add(new JLabel("be ugly and give more space"), BorderLayout.NORTH);
-//		f.getContentPane().add(ugly/*a*/, BorderLayout.CENTER);
-//		f.getContentPane().add(b, BorderLayout.SOUTH);
-//		f.pack();
-//		f.setVisible(true);
-//		
-//		Thread.sleep(10000);
-//		a.addLines(new String[]{"Martoufe", "The Fourth",  "Baldur", "Chaya Sar", "Ygzotot"});
-//		
-//	}
-
-
-	
 	/*======================================================================
 	 	Unimplemented & uninteresting methods
 	  ======================================================================*/

Modified: trunk/src/net/sf/plantlore/common/ComponentAdjust.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ComponentAdjust.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/ComponentAdjust.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -15,9 +15,12 @@
 /** The purpose of ComponentAdjust is to ease manual creation of swing dialogs.
  * You can add your components to an instance of this class and then adjust their
  * width by calling setMaxWidth() method.
+ * 
+ * This class is no longer in use by any other class. It shall be removed from the repository.
  *
  * @author Jakub
  */
+ at Deprecated
 public class ComponentAdjust
 {
     ArrayList<JComponent> list;

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -45,12 +45,12 @@
  * Class offering convenience methods for DBLayer.
  * 
  * Every class requiring high-level work with the database 
- * should use these methods so as to unite the behaviour through the application. 
+ * should use these methods so as to unite the behaviour throughout the application. 
  *
  * 
  *
- * @author reimei
- * @author kaimu
+ * @author Jakub Kotowski
+ * @author Erik Kratochv?l
  */
 public class DBLayerUtils {
     private DBLayer db;
@@ -84,13 +84,19 @@
 	}
     
     
-    /** Creates a new instance of TempClass */
+    /**
+     * Create a new Utils using the supplied Database layer.
+     *   
+     * @param db		The database layer that should be used to perform all the operations.
+     */
     public DBLayerUtils(DBLayer db) {
         this(db, null, true);
     }
     
     /**
-     * @param db
+     * Create a new Utils using the supplied Database layer.
+     * 
+     * @param db		The database layer that should be used to perform all the operations.
      * @param isCacheEnabled	Gives you the possibility to switch off the cache 
      * (which is enabled by default), because it is highly likely it will not contain up-to-date data.
      */
@@ -101,7 +107,13 @@
     }
     
     
-    
+    /**
+     * Processing of some records require the User's assistance. It this way
+     * you can set the User's true intention with the problematic record.
+     * 
+     * @param intention	The true intention with the record as the User decided.
+     * @see #expectDecision()
+     */
     public void setIntention(Intention intention) {
     	this.intention = intention;
     	this.notify();
@@ -109,9 +121,14 @@
     
     
     /**
-     * There are some cases in which DBLayer utils needs assistance.
+     * There are some cases in which DBLayer utils needs assistance of the User.
+     * This method gives you the time needed to contact and inform the User
+     * and then pass His decision using the setIntention() method.
+     * <br/>
+     * The execution of the operation that required the assistance 
+     * will be suspended until the setIntention() method is called.
      *
-     * You must call setIntention(Intention.SOMETHING);
+     * @see #setIntention(Intention) 
      */
     private Intention expectDecision() {
     	if(decisionCallback == null)
@@ -163,7 +180,7 @@
         AuthorOccurrence[] authorResults = null;
         SelectQuery sq = db.createQuery(AuthorOccurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,AuthorOccurrence.OCCURRENCE,null,o,null);
-        sq.addRestriction(PlantloreConstants.RESTR_EQ,AuthorOccurrence.DELETED,null,0,null);
+        sq.addRestriction(PlantloreConstants.RESTR_EQ,Deletable.DELETED,null,0,null);
         int resultid = db.executeQuery(sq);
         int resultCount = db.getNumRows(resultid);
         authorResults = new AuthorOccurrence[resultCount];
@@ -187,7 +204,7 @@
     public void deleteHabitat(Habitat h) throws DBLayerException, RemoteException {
         SelectQuery sq = db.createQuery(Occurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.HABITAT,null,h,null);
-        sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.DELETED, null, 0, null);
+        sq.addRestriction(PlantloreConstants.RESTR_EQ,Deletable.DELETED, null, 0, null);
         int resultid = db.executeQuery(sq);
         int resultCount = db.getNumRows(resultid);
         if (resultCount == 0) {
@@ -208,7 +225,7 @@
     public void deleteHabitatInTransaction(Habitat h) throws DBLayerException, RemoteException {
         SelectQuery sq = db.createQuery(Occurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.HABITAT,null,h,null);
-        sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.DELETED, null, 0, null);
+        sq.addRestriction(PlantloreConstants.RESTR_EQ,Deletable.DELETED, null, 0, null);
         int resultid = db.executeQuery(sq);
         int resultCount = db.getNumRows(resultid);
         if (resultCount == 0) {
@@ -234,7 +251,7 @@
     
     
 	/**
-	 * Find out how many records share the supplied <code>record</code>.
+	 * Find out how many records (alive or not) share the supplied <code>record</code>.
 	 *  
 	 * @param record	The record in question.
 	 * @return	The number of records that share the supplied <code>record</code>. 
@@ -248,7 +265,7 @@
 	 * Find out how many records share the supplied <code>record</code>.
 	 * 	 * 
 	 * @param record	The record in question.
-	 * @param aliveOnly	Ommit records marked as deleted.
+	 * @param aliveOnly	True if it should ommit records marked as deleted.
 	 * @return	The number of records that share the supplied <code>record</code>. 
 	 */
 	public int sharedBy(Record record, boolean aliveOnly) 
@@ -383,9 +400,6 @@
 				query.addRestriction(RESTR_EQ, key, null, subrecord, null);
 			}
 			
-			
-			
-			
 			// Is there such record?
 			int results = db.executeQuery( query );
 			int rows = db.getNumRows( results );
@@ -396,7 +410,7 @@
 			
 			record = null;
 			if( rows != 0 ) 
-				record = (Record)((Object[])(db.more(results, 0, 0)[0]))[0]; // Well, THIS is ugly!
+				record = (Record)((Object[])(db.more(results, 0, 0)[0]))[0]; 
 		} finally {
 			db.closeQuery( query );
 		}
@@ -499,7 +513,12 @@
 		
 	}
 	
-	
+	/**
+	 * Insert a record that belongs to an immutable table into the database.
+	 * 
+	 * @param record	The record to be inserted.
+	 * @return	The inserted record.
+	 */
 	public Record insertImmutableRecord(Record record)
 	throws RemoteException, DBLayerException {
 		if( !Record.IMMUTABLE.contains(record) )
@@ -652,7 +671,13 @@
 		return current;
 	}
 	
-	
+	/**
+	 * Replace a record that belongs to an immutable table by another record.
+	 * 
+	 * @param current	The record to be replaced.
+	 * @param replacement	The replacement of the current record.
+	 * @return	The replacement.
+	 */
 	public Record updateImmutableRecord(Record current, Record replacement) 
 	throws RemoteException, DBLayerException {
 		if( !Record.IMMUTABLE.contains(current) ||
@@ -798,7 +823,9 @@
 	/**
 	 * It is impossible to delete a record of the type (I), if there is at least one
 	 * record refering to it (undeleted as well as deleted).
-    */
+	 * 
+	 * @param The record that is to be deleted. 
+	 */
 	public void deleteImmutableRecord(Record record)
 	throws RemoteException, DBLayerException {
 		if( !Record.IMMUTABLE.contains(record) )
@@ -819,7 +846,7 @@
 	 * a simple table will be created from supplied record(s).
 	 * 
 	 * @param records
-	 * @return
+	 * @return A table model containing all records.
 	 */
 	public TableModel createTableFor(Record... records) {
 		return new RecordTable(records);
@@ -896,9 +923,7 @@
 	
 	
 	/**
-	 * NOT TESTED!
-	 * 
-	 * High-level record processor. 
+	 * High-level occurrence data processor. 
 	 * Incorporates all rules that bind the record processing. 
 	 * 
 	 * @param occ	The basic occurrence record.

Modified: trunk/src/net/sf/plantlore/common/DefaultCancelAction.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultCancelAction.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DefaultCancelAction.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -28,32 +28,58 @@
 	protected JFrame frame;
 	
 	
+	/**
+	 * Create a new Cancel action that hides the given frame.
+	 * 
+	 * @param frame	The frame to be hidden.
+	 * @param name		The caption of the button.
+	 * @param tooltip	The tooltip displayed over the button.
+	 */
 	public DefaultCancelAction(JFrame frame, String name, String tooltip) {
 		putValue(SHORT_DESCRIPTION, tooltip);
 		putValue(NAME, name);
 		this.frame = frame;
 	}
 	
+	/**
+	 * Create a new Cancel action that hides the given dialog.
+	 * 
+	 * @param dialog	The dialog to be hidden.
+	 * @param name		The caption of the button.
+	 * @param tooltip	The tooltip displayed over the button.
+	 */
 	public DefaultCancelAction(JDialog dialog, String name, String tooltip) {
 		putValue(SHORT_DESCRIPTION, tooltip);
 		putValue(NAME, name);
 		this.dialog = dialog;
 	}
 	
-	
+	/**
+	 * Create a new Cancel action that hides the given frame.
+	 * The caption of the button is set to a default value.
+	 * 
+	 * @param frame	The frame to be hidden.
+	 */
 	public DefaultCancelAction(JFrame frame) {
 		putValue(NAME, L10n.getString("Common.Cancel"));
 		this.frame = frame;
 	}
 	
-	
+	/**
+	 * Create a new Cancel action that hides the given dialog.
+	 * The caption of the button is set to a default value.
+	 * 
+	 * @param dialog	The dialog to be hidden.
+	 */
 	public DefaultCancelAction(JDialog dialog) {
 		putValue(NAME, L10n.getString("Common.Cancel"));
 		this.dialog = dialog;
 	}
 
 	
-	
+	/**
+	 * Hide the frame (or dialog).
+	 */
 	public void actionPerformed(ActionEvent e) {
 		if(frame != null)
 			frame.setVisible(false);

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,5 +1,6 @@
 package net.sf.plantlore.common;
 
+import java.awt.Component;
 import java.rmi.*;
 import java.rmi.server.ExportException;
 
@@ -11,75 +12,155 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
+ * The Default Exception Handler offers a united exception handling and
+ * error presentation. It can offer reconnect if it is reasonable.
+ * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 28.8.2006
- *
+ * @since 2006-08-28
+ * @version 1.0
  */
 public class DefaultExceptionHandler {
+	
+	private static DefaultExceptionHandler D = new DefaultExceptionHandler();
 
+
 	private DefaultExceptionHandler() {}
-	
-	
+
+
+	/**
+	 * Announce the exception to the User.
+	 * 
+	 * @param parent	The parent window (in order to maintain the proper window hierachy in Swing).
+	 * @param e	The exception to be announced.
+	 */
 	public static void handle(java.awt.Component parent, Exception e) {
-		handle(parent, e, L10n.getString("Error.General"));		
+		handle(parent, e, L10n.getString("Error.General"), false);		
 	}
 	
-	
+	/**
+	 * Announce the exception to the User.
+	 * 
+	 * @param parent	The parent window (in order to maintain the proper window hierachy in Swing).
+	 * @param e	The exception to be announced.
+	 * @param title The title the window should have instead of the default title.
+	 */
 	public static void handle(java.awt.Component parent, Exception e, String title) {
+		handle(parent, e, title, false);
+	}
+		
+	/**
+	 * Announce the exception to the User.
+	 * 
+	 * @param parent	The parent window (in order to maintain the proper window hierachy in Swing).
+	 * @param e	The exception to be announced.
+	 * @param title The title the window should have instead of the default title.
+	 * @param doNotOfferReconnect True if the reconnect procedure should not be offered
+	 * 					even if it might seem reasonable.
+	 */	
+	public static void handle(
+			java.awt.Component parent, 
+			Exception e, 
+			String title, 
+			boolean doNotOfferReconnect) {
+		
+		boolean isReconnectReasonable = false;
+		String problemDescription = e.getMessage();
+		
 		/*
 		 * REMOTE EXCEPTION HANDLER
 		 */
 		if( e instanceof RemoteException ) {
-			String problemDescription = e.getMessage();
-			
+			// The caller does not have permission to perform the action requested by the method call.
 			if( e instanceof AccessException )
 				problemDescription = L10n.getString("Error.Server.AccessDenied");
-			else if( e instanceof ConnectException )
+			
+			// Connection is refused to the remote host for a remote method call.
+			else if( e instanceof ConnectException ) {
 				problemDescription = L10n.getString("Error.Server.ConnectionRefused");
+				isReconnectReasonable = true;
+			}
+			
+			// An IOException occured while making a connection to the remote host for a remote method call.
 			else if( e instanceof ConnectIOException )
 				problemDescription = L10n.getString("Error.Server.ConnectionRefused");
+			
+			// An attempt to export a remote object failed.
 			else if( e instanceof ExportException )
 				problemDescription = L10n.getString("Error.Server.ExportFailed");
+			
+			// Occurs while marshalling the remote call header, arguments or 
+			// return value for a remote method call.
+			// Or if the receiver does not support the protocol version of the sender.
 			else if( e instanceof MarshalException )
 				problemDescription = L10n.getString("Error.Server.MarshallingFailed");
+			
+			// An attempt was made to invoke a method on an object 
+			// that no longer exists in the remote virtual machine.
 			else if( e instanceof NoSuchObjectException )
 				problemDescription = L10n.getString("Error.Server.ObjectDoesNotExistAnymore");
-			else if( e instanceof ServerError )
+			
+			// An Error was thrown while processing the invocation on the server, 
+			// either while unmarshalling the arguments, executing the remote method itself, 
+			// or marshalling the return value.
+			else if( e instanceof ServerError ) {
 				problemDescription = L10n.getString("Error.Server.InTrouble");
-			else if( e instanceof ServerException )
+				isReconnectReasonable = true;
+			}
+			
+			// A RemoteException was thrown while processing the invocation on the server, 
+			// either while unmarshalling the arguments or executing the remote method itself.
+			else if( e instanceof ServerException ) {
 				problemDescription = L10n.getString("Error.Server.InTrouble");
+				isReconnectReasonable = true;
+			}
+			
+			// A valid stub class could not be found for a remote object when it is exported.
 			else if( e instanceof StubNotFoundException )
 				problemDescription = L10n.getString("Error.Server.StubNotFound");
+			
+			// If the client of a remote method call receives, as a result of the call, 
+			// a checked exception that is not among the checked exception types 
+			// declared in the throws clause of the method in the remote interface.
 			else if( e instanceof UnexpectedException )
 				problemDescription = L10n.getString("Error.Server.UnexpectedProblem");
+			
+			// If a java.net.UnknownHostException occurs while creating a connection 
+			// to the remote host for a remote method call.
 			else if( e instanceof UnknownHostException )
 				problemDescription = L10n.getString("Error.Server.UnknownHost");
+			
+			// Could be thrown while unmarshalling the parameters or results of a remote method call.
 			else if( e instanceof UnmarshalException )
 				problemDescription = L10n.getString("Error.Server.UnmarshallingFailed");
 
-			DefaultReconnectDialog.show(parent, problemDescription);
+			
 		}
 		
 		/*
 		 * DBLAYER EXCEPTION HANDLER
 		 */
-		else if( e instanceof DBLayerException && ((DBLayerException)e).isReconnectNecessary() ) {
+		else if( e instanceof DBLayerException ) {
 			DBLayerException d = (DBLayerException)e;
-			String problemDescription = d.getMessage();
 			if(d.getCause() instanceof JDBCException)
-				problemDescription = d.getMessage() + "\n"  + d.getErrorInfo();
-			DefaultReconnectDialog.show(parent, problemDescription);
+				problemDescription = problemDescription + "\n"  + d.getErrorInfo();
+			isReconnectReasonable = d.isReconnectNecessary();
 		}
 		
-		/*
-		 * OTHER EXCEPTIONS HANDLER
-		 */
+		// Announce the error and offer the reconnection.
+		if( isReconnectReasonable && ! doNotOfferReconnect )
+			DefaultReconnectDialog.show(parent, problemDescription);
+		// Just announce the problem.
 		else
 			JOptionPane.showMessageDialog( 
 					parent, 
-					e.getMessage(), 
+					problemDescription, 
 					title, 
 					JOptionPane.ERROR_MESSAGE );
+		
+		System.out.println("~~DefaultExceptionHandler~~");
+		System.out.println(problemDescription);
+		
 	}
 	
+	
 }

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -5,7 +5,7 @@
 
 /**
  * A simple and convenient
- * implementation of the abstract ProgressBar.
+ * implementation of the abstract ProgressBar with the default exception handler.
  * <br/>
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
@@ -14,22 +14,39 @@
  */
 public class DefaultProgressBar extends ProgressBar {
 	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
 	public DefaultProgressBar(Task task, JFrame parent, boolean modal) {
 		super(task, parent, modal);
 	}
 	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
 	public DefaultProgressBar(Task task, JDialog parent, boolean modal) {
 		super(task, parent, modal);
 	}
 	
-	
+	/**
+	 * Stop the task and handle the exception with the DefaultExceptionHandler.
+	 * 
+	 * @see DefaultExceptionHandler
+	 */
 	@Override
 	public void exceptionHandler(Exception ex) {
-		
 		getTask().stop();
-		
 		DefaultExceptionHandler.handle(parent, ex);
-		
 	}
 	
 }

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -5,7 +5,7 @@
 
 /**
  * A simple and convenient
- * implementation of the abstract ProgressBar.
+ * implementation of the abstract ProgressBarEx with the default exception handler.
  * <br/>
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
@@ -14,24 +14,39 @@
  */
 public class DefaultProgressBarEx extends ProgressBarEx {
 	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
 	public DefaultProgressBarEx(Task task, JFrame parent, boolean modal) {
 		super(task, parent, modal);
 	}
 	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
 	public DefaultProgressBarEx(Task task, JDialog parent, boolean modal) {
 		super(task, parent, modal);
 	}
 	
-	
-
-	
+	/**
+	 * Stop the task and handle the exception with the DefaultExceptionHandler.
+	 * 
+	 * @see DefaultExceptionHandler
+	 */
 	@Override
 	public void exceptionHandler(Exception ex) {
-		
 		getTask().stop();
-		
 		DefaultExceptionHandler.handle(parent, ex);
-		
 	}
 	
 }

Modified: trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -5,22 +5,39 @@
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.client.AppCoreCtrl;
 
-
+/**
+ * The dialog that offers the User the possibility to perform automatic reconnection
+ * if the connection with the database is lost.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @version 1.0
+ */
 public class DefaultReconnectDialog {
 	
-	private static String[] options = new String[] { L10n.getString("Overview.MenuFileReconnect"), L10n.getString("Common.Ok") };
+	private static String[] options = new String[] { 
+		L10n.getString("Overview.MenuFileReconnect"), 
+		L10n.getString("Common.Ok") };
+	
 	private static AppCoreCtrl.ReconnectAction defaultReconnectAction;
 
-	
+	/**
+	 * Set the default reconnect action.
+	 * 
+	 * @param reconnect	The action that will be called if the User decides the reconnect is needed. 
+	 */
 	public static void setDefaultReconnectAction(AppCoreCtrl.ReconnectAction reconnect) {
 		defaultReconnectAction = reconnect;
 	}
 	
-	
+	/**
+	 * Display the reconnect dialog. If the reconnection is selected by the User, the supplied
+	 * `reconnect` action will be used instead of the default one.
+	 * 
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param e	The exception that must be announced to the User.
+	 * @param reconnect	The reconnect action that will be used instead of the default one.
+	 */
 	public static void show(Component parent, Exception e, AppCoreCtrl.ReconnectAction reconnect) {
-		
-		//reconnect.setParent(parent);
-		
 		int choice = JOptionPane.showOptionDialog(
 				parent, 
 				e.getMessage(), 
@@ -31,20 +48,31 @@
 				options,
 				options[0]
 		);
-		
 		if(choice == 0) 
 			reconnect.actionPerformed(null);
 	}
 	
-	
+	/**
+	 * Display the reconnect dialog. If the reconnection is selected by the User, the default
+	 * reconnect action will be used.
+	 * 
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param e	The exception that must be announced to the User.
+	 */
 	public static void show(Component parent, Exception e) {
 		show(parent, e.getMessage());
 	}
 	
+	/**
+	 * Display the reconnect dialog. If the reconnection is selected by the User, the default
+	 * reconnect action will be used. Instead of automatic exception handling, this time you
+	 * can specify your own problem description. 
+	 * 
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param problemDescription	The string that will be displayed to the User.
+	 */
 	public static void show(Component parent, String problemDescription) {
-		
 		defaultReconnectAction.setParent(parent);
-		
 		int choice = JOptionPane.showOptionDialog(
 				parent, 
 				problemDescription, 
@@ -55,7 +83,6 @@
 				options,
 				options[0]
 		);
-		
 		if(choice == 0 && defaultReconnectAction != null) 
 			defaultReconnectAction.actionPerformed(null);
 	}

Modified: trunk/src/net/sf/plantlore/common/GlobalExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/GlobalExceptionHandler.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/GlobalExceptionHandler.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -11,22 +11,40 @@
 
 
 /**
+ * In case there are some unchecked exceptions or something goes really really
+ * wrong (and is not covered by other catch blocks) the Global Exception handler
+ * will catch that stranded exception, display a message to the User, and try
+ * to shut down the application in a civilized manner.
+ * <br/>
+ * This is the last resort and the less you see this message the better job we have done.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 24.8.2006
- *
+ * @since 2006-08-24
+ * @version 1.0
  */
 public class GlobalExceptionHandler implements UncaughtExceptionHandler {
 	
+	/**
+	 * Make sure the DefaultException handler is not installed twice.
+	 */
 	private static boolean installed = false;
 	private Logger logger = Logger.getLogger(net.sf.plantlore.client.Plantlore.class.getPackage().getName());
 	
 	private final ActionListener silentFinalAction;
 	
+	/**
+	 * Create a new Global Exception handler.
+	 * 
+	 * @param silentFinalAction The action that will perform silent (i.e. without exceptions) cleanup.
+	 */
 	private GlobalExceptionHandler(ActionListener silentFinalAction) {
 		this.silentFinalAction = silentFinalAction;
 	}
 	
+	/**
+	 * Write a message into the log describing the problem,
+	 * display a message to the User, and call the silentFinalAction().
+	 */
 	public void uncaughtException(Thread t, Throwable e) {
 		logger.fatal(
 				"Thread " + t.getName() + " (" + t.getClass().getName() + ") " +
@@ -34,9 +52,9 @@
 				"The application will be terminated."
 		);
 		
-                //FIXME (maybe)
-                e.printStackTrace();
-                
+		//FIXME (maybe)
+		e.printStackTrace();
+		
 		JOptionPane.showMessageDialog( 
 				null,
 				L10n.getString("Error.UnhandledExceptionalState") +
@@ -49,7 +67,14 @@
 			silentFinalAction.actionPerformed(null);
 	}
 
-	
+	/**
+	 * Install the Global exception handler. Thread safe. At most once semantics.
+	 * 
+	 * @param silentFinalAction	The action that will be called to perform the final cleanup.
+	 * This action should be very sturdy and should throw no exceptions. At the end of the
+	 * action there should be the call <code>System.exit(1);</code> that will terminate
+	 * the application - there is no point in continuing because no error recovery is possible.
+	 */
 	public static synchronized void install(ActionListener silentFinalAction) {
 		if( !installed ) {
 			Thread.setDefaultUncaughtExceptionHandler( new GlobalExceptionHandler(silentFinalAction) );

Modified: trunk/src/net/sf/plantlore/common/ProgressBarEx.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarEx.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/ProgressBarEx.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -15,7 +15,8 @@
 import net.sf.plantlore.l10n.L10n;
 
 
-/** ProgressBar dialog that works as an observer of a given Task.
+/** 
+ * ProgressBar dialog works as an observer of a given Task.
  *
  * The dialog sets itself visible after it receives a STARTING Message, disposes
  * itself after getting a STOPPED Message and in the time between it updates it's
@@ -24,29 +25,43 @@
  * If constructed with an indeterminate Task works in indeterminate mode until it
  * receives a LENGHT_CHANGED message from the Task. Then it switches to determinate mode.
  *
- * Exceptions trhown by the task are processed by the abstract exceptionHandler() method.
+ * Exceptions thrown by the task are processed by the abstract exceptionHandler() method.
+ * 
+ * This extended version introduces the possibility to cancel the performed task.
+ * <b>It is up to the creator of the Task to monitor the Task.isCancelled() and react properly!</b>
  *
  * @author  Erik Kratochv?l
  */
 public abstract class ProgressBarEx extends ProgressBar {
     
-    /** Creates a new progress bar, initially invisible. It becomes visible after it receives
+    /** 
+     * Create a new progress bar, initially invisible. It becomes visible after it receives
      * a STARTING Message from the Task.
      *
-     * @param task the task to be monitored
-     * @param parent the parent frame of this dialog
-     * @modal whether to open in modal mode
-     *
+     * @param task The task to be monitored.
+     * @param parent The parent frame of this dialog.
+     * @modal Whether to open in modal mode.
      */
     public ProgressBarEx(Task task, java.awt.Frame parent, boolean modal) {
         super(task, parent, modal);
         
     }
     
+    /** 
+     * Create a new progress bar, initially invisible. It becomes visible after it receives
+     * a STARTING Message from the Task.
+     *
+     * @param task The task to be monitored.
+     * @param parent The parent dialog of this dialog.
+     * @modal Whether to open in modal mode.
+     */
     public ProgressBarEx(Task task, javax.swing.JDialog parent, boolean modal) {
         super(task, parent, modal);
     }    
  
+    /**
+     * Slightly different initialization - the Cancel button must be provided with an Action!
+     */
     @Override
     protected void initialize() {
     	logger = Logger.getLogger(this.getClass().getPackage().getName());
@@ -134,6 +149,9 @@
     }// </editor-fold>//GEN-END:initComponents
     
 
+    /**
+     * Cancel the current task. 
+     */
     private class CancelTaskAction extends AbstractAction {
     	public CancelTaskAction() {
     		putValue(NAME, L10n.getString("Common.Cancel"));

Modified: trunk/src/net/sf/plantlore/common/ProgressDialog.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressDialog.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/ProgressDialog.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -17,8 +17,11 @@
 
 /**
  *
- * @author Tomas Kovarik
+ * The use of ProgressDialog is not recommended anymore. Use the Task and ProgressBar instead!
+ * It should be removed from repository for good.
+ * 
  */
+ at Deprecated
 public class ProgressDialog {
     
     private JDialog progress;

Modified: trunk/src/net/sf/plantlore/common/Selection.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Selection.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/Selection.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -7,9 +7,12 @@
 
 /**
  * A list of selected records. The selection allows
- * selection of new records, removal of selected records (deselection),
+ * the selection of new records, removal of selected records (deselection),
  * selection of all records, deselection of all records,
  * and inversion of the current selection.
+ * <br/>
+ * The Selection is used to store the list of records the User marked to be exported
+ * or printed.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-23
@@ -46,7 +49,7 @@
 		
 	/**
 	 * Remove a selected record from the selection (deselect).
-	 * @param id Of the record that is deselected.
+	 * @param id Identifier of the record that is deselected.
 	 */
 	public Selection remove(Integer id) {
 		if( !inverted ) selected.remove(id);
@@ -80,13 +83,13 @@
 
 	/**
 	 * @param id	The primary key of the record.
-	 * @return true if a record with this primary key is selected.
+	 * @return True if the record with this primary key is selected.
 	 */
 	public boolean contains(Integer id) { return selected.contains(id) ^ inverted; }
 	
 	/**
 	 * @param r	The record.
-	 * @return true if the record is selected.
+	 * @return True if the record is selected.
 	 */
 	public boolean contains(Record r) { return selected.contains(r.getId()) ^ inverted; }
 	
@@ -99,7 +102,7 @@
 	}
 	
 	/**
-	 * @return true if nothing is selected;
+	 * @return True if nothing is selected;
 	 */
 	public boolean isEmpty() {
 		return selected.isEmpty() ^ inverted;
@@ -109,13 +112,21 @@
 	public Selection clone() {
 		return new Selection( this );
 	}
-        
-        public Collection<Integer> values() {
-            return selected;
-        }
-        
-        public void clear() {
-            selected.clear();
-            inverted = false;
-        }
+	
+	/**
+	 * 
+	 * @return	A collection of identifiers of all selected records.
+	 */
+	public Collection<Integer> values() {
+		return selected;
+	}
+	
+	/**
+	 * An alias for Selection.none().
+	 *
+	 * @see #none()
+	 */
+	public Selection clear() {
+		return none();
+	}
 }

Modified: trunk/src/net/sf/plantlore/common/SpringUtilities.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SpringUtilities.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/SpringUtilities.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -20,6 +20,7 @@
  * These utilities are used by several programs, such as
  * SpringBox and SpringCompactGrid.
  */
+ at Deprecated
 public class SpringUtilities {
     private static final Logger logger = Logger.getLogger(SpringUtilities.class.getPackage().getName());
     

Modified: trunk/src/net/sf/plantlore/common/StandardAction.java
===================================================================
--- trunk/src/net/sf/plantlore/common/StandardAction.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/StandardAction.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -6,8 +6,21 @@
 import net.sf.plantlore.client.resources.Resource;
 import net.sf.plantlore.l10n.L10n;
 
+/**
+ * Standard Action introduces the extended constructor that can
+ * automatically assign a caption, a short description,
+ * and an image to the button. 
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public abstract class StandardAction extends AbstractAction {
 	
+	/**
+	 * Create a new StandardAction.
+	 * 
+	 * @param text The base string that will be used to obtain the caption, the tooltip text
+	 * and an image from the L10N.
+	 */
 	public StandardAction(String text) {
 		putValue(NAME, L10n.getString(text));
 		putValue(SHORT_DESCRIPTION, L10n.getString(text+"TT"));

Modified: trunk/src/net/sf/plantlore/common/TabTransfersFocus.java
===================================================================
--- trunk/src/net/sf/plantlore/common/TabTransfersFocus.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/TabTransfersFocus.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -39,7 +39,7 @@
 	}
 	
 	/**
-	 * Neutralize the behaivour.
+	 * Neutralize the effect this class has on the component.
 	 */
 	public void neutralize() {
 		a.removeKeyListener(this);

Modified: trunk/src/net/sf/plantlore/common/UniqueIDGenerator.java
===================================================================
--- trunk/src/net/sf/plantlore/common/UniqueIDGenerator.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/UniqueIDGenerator.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -5,7 +5,7 @@
 import java.security.SecureRandom;
 
 /**
- * A unique number generator.
+ * A unique identifier generator.
  *
  * Based on http://www.javapractices.com/Topic56.cjp
  * 
@@ -15,7 +15,12 @@
  */
 public class UniqueIDGenerator {
 	
-	
+	/**
+	 * Encode the digest to some human readable format.
+	 * 
+	 * @param input	The digest from SHA1 or MD5
+	 * @return
+	 */
 	static private String encode( byte[] input){
 	    StringBuffer result = new StringBuffer();
 	    char[] digits = { '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', 'a', 'b', 'c', 'd', 'e', 'f' };

Modified: trunk/src/net/sf/plantlore/common/debug/MemoryMonitor.java
===================================================================
--- trunk/src/net/sf/plantlore/common/debug/MemoryMonitor.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/debug/MemoryMonitor.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -1,14 +1,11 @@
-/*
- * MemoryMonitor.java
- *
- * Created on 1. srpen 2006, 11:18
- */
-
 package net.sf.plantlore.common.debug;
 
 /**
+ * A simple memory monitor that displays the memory in use.
+ * It is not intended to be a part of the final release. 
+ * Its use is limited to the debugging purposes.
  *
- * @author  yaa
+ * @author  Erik Kratochv?l
  */
 public class MemoryMonitor extends javax.swing.JFrame {
     

Modified: trunk/src/net/sf/plantlore/common/record/Deletable.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Deletable.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/record/Deletable.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -2,12 +2,34 @@
 
 import java.io.Serializable;
 
+/**
+ * An interface that serves as an annotation that some records 
+ * must be deleted from the database in a different way - 
+ * they should be marked as deleted (instead of just removed from 
+ * the database for good).
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public interface Deletable extends Serializable {
 	
+	/**
+	 * The name of the column. It is the same for all `deletable` records.
+	 */
 	static final String DELETED = "deleted";
 	
+	/**
+	 * 
+	 * @param arg	The "delete level". 
+	 * 0 = alive (not deleted), 
+	 * 1 = deleted (dead), 
+	 * 2 = deleted (because the associated record was deleted)
+	 */
 	void setDeleted(Integer arg);
 	
+	/**
+	 * 
+	 * @return	The "delete level".
+	 */
 	Integer getDeleted();
 
 }

Modified: trunk/src/net/sf/plantlore/common/record/Record.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Record.java	2006-09-01 13:00:13 UTC (rev 613)
+++ trunk/src/net/sf/plantlore/common/record/Record.java	2006-09-01 13:09:26 UTC (rev 614)
@@ -136,11 +136,23 @@
 		return null;
 	}
 	
-	
+	/**
+	 * Return the subrecord of this record of the specified type.
+	 * 
+	 * @param name	The simple name of the class of the subrecord.
+	 * 	@return	The subrecord of the specified type if it exists or null otherwise.
+	 */
 	public Record findSubrecord(String name) {
 		return findSubrecord(this, name);
 	}
 	
+	/**
+	 * Return the subrecord of the base record of the specified type.
+	 * 
+	 * @param base	The base record.
+	 * @param name	The simple name of the class of the subrecord.
+	 * @return	The subrecord of the specified type if it exists or null otherwise.
+	 */
 	public static Record findSubrecord(Record base, String name) {
 		if( base.getClass().getSimpleName().equalsIgnoreCase(name) )
 			return base;
@@ -164,7 +176,7 @@
 	
 	
 	/**
-	 * @return	The record with all subrecords (accessible via foreign keys) created.
+	 * @return	The record with all its subrecords (accessible via foreign keys) properly allocated.
 	 */
 	public Record createTorso() {
 		StringBuilder className;
@@ -182,7 +194,9 @@
 	}
 	
 	/**
-	 * Set a <code>value</code> of the <code>column</code> of the <code>subrecord</code>.
+	 * Set a <code>value</code> of the <code>column</code> 
+	 * of a subrecord from the given <code>table</code>.
+	 * 
 	 * @param table	The type of the subrecord.
 	 * @param column	The name of the column.
 	 * @param value	The value to be set to that column.
@@ -193,7 +207,14 @@
 			subrecord.setValue(column, value);
 	}
 	
-	
+	/**
+	 * Set a <code>value</code> of the <code>column</code> 
+	 * of a subrecord from the given <code>table</code>.
+	 * 
+	 * @param table	The simple name of the table of the subrecord.
+	 * @param column	The name of the column.
+	 * @param value	The value to be set to that column.
+	 */
 	public void setValue(String table, String column, Object value) {
 		Record subrecord = findSubrecord(table);
 		if(subrecord != null) 
@@ -220,7 +241,7 @@
 		try {
 			setValue(column, value);
 		} catch(Exception e) {
-			// Whatever
+			// Consume the exception.
 		}
 	}
 	
@@ -284,7 +305,11 @@
 	 */
 	public List<String> getForeignKeys() { return new ArrayList<String>(0); }
 	
-	
+	/**
+	 * 
+	 * @param key	The name of the foreign key in question.
+	 * @return	True if the key is a name of a column that happens to be a foreign key.
+	 */
 	public boolean isForeignKey(String key) {
 		for(String fk : getForeignKeys())
 			if( key.equalsIgnoreCase(fk) )
@@ -297,7 +322,11 @@
 	 */
 	public List<String> getColumns() { return new ArrayList<String>(0); }
 	
-	
+	/**
+	 * 
+	 * @param property		The name of the property in question.
+	 * @return	True if the property is a name of a column that is not a foreign key.
+	 */
 	public boolean isColumn(String property) {
 		for(String column : getColumns())
 			if( property.equalsIgnoreCase(column) )
@@ -333,7 +362,6 @@
 	public boolean areAllNNSet() {
 		for( String column : getNN() ) { 
 			Object value = getValue(column);
-			//System.out.println(" # "+this.getClass().getSimpleName()+"."+column+" = ["+value+"].");
 			if( value == null ) {
 				System.out.println(getClass().getSimpleName()+"."+column+" = 0");
 				return false;
@@ -419,7 +447,12 @@
 		return null;
 	}
 	
-	
+	/**
+	 * Array to List convertor.
+	 * 
+	 * @param values	A (classical) array o values.
+	 * @return	A List of the same values.
+	 */
 	protected List<String> asList(String...values) {
 		return new ArrayList<String>(Arrays.asList(values));
 	}
@@ -438,14 +471,17 @@
 
 	/**
 	 * Convert the record into a string. 
-	 * The list of values spans across subrecords as well.
-	 * For debug purposes mostly.
 	 */
 	@Override
 	public String toString() {
 		return this.getClass().getSimpleName();
 	}
 	
+	/**
+	 * Convert the record into a long string. 
+	 * The list of values spans across subrecords as well.
+	 * For debug purposes only.
+	 */
 	public String toFullString() {
 		
 		StringBuilder sigma = new StringBuilder();
@@ -457,8 +493,6 @@
 			if(subrecord != null)	sigma.append( subrecord.toString() );
 		}
 		return sigma.toString();
-		
-		//return this.getClass().getSimpleName();
 	}
 	                
 }



From fraktalek at mail.berlios.de  Fri Sep  1 15:10:00 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 15:10:00 +0200
Subject: [Plantlore-dev] r615 - trunk
Message-ID: <200609011310.k81DA0WN017374@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 15:09:44 +0200 (Fri, 01 Sep 2006)
New Revision: 615

Modified:
   trunk/build.xml
Log:
Modified to work with the changes to lib directory.
Added encoding="utf8" to the javac task.



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-01 13:09:26 UTC (rev 614)
+++ trunk/build.xml	2006-09-01 13:09:44 UTC (rev 615)
@@ -16,10 +16,6 @@
 		<fileset dir="${base.dir}/lib">
 			<include name="*.jar" />
 		</fileset>
-		
-		<fileset dir="${base.dir}/lib/jasper">
-			<include name="*.jar" />
-		</fileset>		
 	</path>
         
 	<!-- classpath used for rmic compilation -->
@@ -51,6 +47,7 @@
 		       verbose="${TALK}"
 		       fork="true" 
 		       debug="${DEBUG}"
+                       encoding="utf8"
 		       >
 			<classpath refid="classpath.base"/>
 			<compilerarg line="-Xlint:unchecked -Xlint:deprecation"/>
@@ -134,10 +131,6 @@
                 <copy todir="${dist.dir}">
                     <fileset dir="${base.dir}" includes="lib/*.jar"/>
                 </copy>
-                <copy todir="${dist.dir}">
-                    <fileset dir="${base.dir}" includes="lib/jasper/*.jar"/>
-                    <globmapper from="lib/jasper/*" to="lib/*"/>
-                </copy>
                 <copy file="${base.dir}/resources/java.policy" todir="${dist.dir}"/>    
 	</target>
         



From kovo at mail.berlios.de  Fri Sep  1 15:58:40 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Fri, 1 Sep 2006 15:58:40 +0200
Subject: [Plantlore-dev] r616 - trunk
Message-ID: <200609011358.k81Dweba023483@sheep.berlios.de>

Author: kovo
Date: 2006-09-01 15:58:39 +0200 (Fri, 01 Sep 2006)
New Revision: 616

Modified:
   trunk/build.xml
Log:
Added javadoc target for generating JavaDoc documentation. Results are stored in dist/javadoc folder. Errors and warnings are displayed during the generation so that you can find and fix them.

Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-01 13:09:44 UTC (rev 615)
+++ trunk/build.xml	2006-09-01 13:58:39 UTC (rev 616)
@@ -1,5 +1,5 @@
 <project name="Plantlore" default="all" basedir=".">
-	<target name="all" depends="clean, compile" />
+	<target name="all" depends="clean, javadoc, compile" />
 	
 	<property name="base.dir" location="." />
 	<property name="build.dir" location="${base.dir}/build"/>
@@ -141,6 +141,22 @@
                     basedir="${base.dir}"
             />
         </target>
+        
+        <target name="javadoc" depends="init" description="Compile JavaDoc documentation for the project">
+            <javadoc packagenames="net.sf.plantlore.*"
+                     sourcepath="${base.dir}/src"
+                     destdir="${dist.dir}/javadoc"
+                     private="true"
+                     verbose="true"
+                     encoding="utf8"
+                     author="true"
+                     version="true"
+                     windowtitle="Plantlore API documentation">
+                <doctitle><![CDATA[<h1>Plantlore API</h1>]]></doctitle>
+                <link href="http://plantlore.berlios.de"/>                
+                <bottom><![CDATA[<i>Project homepage: http://plantlore.berlios.de</i>]]></bottom>
+            </javadoc>
+        </target>        
 </project>
 
 



From krater at mail.berlios.de  Fri Sep  1 17:14:25 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Fri, 1 Sep 2006 17:14:25 +0200
Subject: [Plantlore-dev] r617 - trunk/src/net/sf/plantlore/client/login
Message-ID: <200609011514.k81FEPtZ032091@sheep.berlios.de>

Author: krater
Date: 2006-09-01 17:14:25 +0200 (Fri, 01 Sep 2006)
New Revision: 617

Modified:
   trunk/src/net/sf/plantlore/client/login/Login.java
Log:
Repair the crippled getConnectionCount() to make debugging easier.

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-01 13:58:39 UTC (rev 616)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-01 15:14:25 UTC (rev 617)
@@ -595,7 +595,9 @@
 
 		synchronized public int getConnectionCount() throws RemoteException {
 			//verifyValidity();
-			return 0; //wrappedDBLayer.getConnectionCount();
+			if( wrappedDBLayer != null )
+				return wrappedDBLayer.getConnectionCount();
+			return -1;
 		}
 
 		synchronized public void shutdown() throws RemoteException {



From fraktalek at mail.berlios.de  Fri Sep  1 20:45:28 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 1 Sep 2006 20:45:28 +0200
Subject: [Plantlore-dev] r618 - in trunk: . src/net/sf/plantlore/common
Message-ID: <200609011845.k81IjSl8015821@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-01 20:45:22 +0200 (Fri, 01 Sep 2006)
New Revision: 618

Added:
   trunk/src/net/sf/plantlore/common/Utils.java
Modified:
   trunk/
Log:
Methods to determine code base at runtime.




Property changes on: trunk
___________________________________________________________________
Name: svn:ignore
   - svn-commit.tmp~

   + svn-commit.tmp~
build.xml~


Added: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-01 15:14:25 UTC (rev 617)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-01 18:45:22 UTC (rev 618)
@@ -0,0 +1,93 @@
+/*
+ * Utils.java
+ *
+ * Created on 1. z??? 2006, 17:28
+ *
+ */
+
+package net.sf.plantlore.common;
+
+import java.io.UnsupportedEncodingException;
+import java.net.URLDecoder;
+import org.apache.log4j.Logger;
+
+/** A suit of helper methods not fitting anywhere else and of possible use to others.
+ *
+ * @author fraktalek
+ */
+public class Utils {
+    private static String URL_ENCODING="UTF-8";
+    static Logger logger = Logger.getLogger(Utils.class.getPackage().getName());
+    
+    /** Does nothing */
+    public Utils() {
+    }
+    
+    /** Determines whether this class is bundled in and run from a jar file.
+     *
+     * @return true if run from jar file, false otherwise
+     */
+    public static boolean isRunningFromJar() {
+        java.net.URL url = Utils.class.getResource("Utils.class");
+        return url.getProtocol().equals("jar");
+    }
+    
+    /** Determines the name of the jar in which this class is bundled.
+     *
+     * @return name of the jar file or null if not in jar
+     */
+    public static String getJarName() {
+        java.net.URL url = Utils.class.getResource("Utils.class");
+        if (!url.getProtocol().equals("jar"))
+            return null;
+        
+        String jar = url.getFile();
+        jar = jar.substring(0,jar.indexOf("jar!")+3);
+        jar = jar.substring(jar.lastIndexOf("/")+1);
+        return jar;
+    }
+    
+    /** Returns a code base path as needed by RMI.
+     *
+     * Relies on the fact that this class is bundled in the same jar or directory
+     * structure as the rest of the application (the stubs actually).
+     *
+     * @return path to the code base or null in case of some unexpected problem
+     *
+     */
+    public static String getCodeBasePath() {
+        String dir;
+        
+        //take a class that's in the same place as the rest of the application
+        //and get it's location
+        java.net.URL url = Utils.class.getResource("Utils.class");
+        //now we got something like:
+        //"jar:file:/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
+        
+        try {            
+            dir = URLDecoder.decode(url.getPath(),"UTF-8");
+        } catch (UnsupportedEncodingException ex) {
+            logger.error("Utils.java: the URLDecoder complains about unsupported URL encoding: \""+URL_ENCODING+"\"");
+            return null;
+        }
+
+        //clear off the file name
+        dir = dir.substring(0,dir.lastIndexOf("/"));
+        if (url.getProtocol().equals("jar")) {
+            //remove path to the package and the trailing "!/"
+            dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
+            dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+        } else {
+            //remove the path to the package and a trailing slash        
+            dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/")));            
+        }
+        
+        return dir;
+    }
+    
+    
+    public static void main(String[] args) {
+        System.out.println("code base = "+getCodeBasePath());
+    }
+}
+



From krater at mail.berlios.de  Fri Sep  1 23:11:42 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Fri, 1 Sep 2006 23:11:42 +0200
Subject: [Plantlore-dev] r619 - in trunk/src/net/sf/plantlore: client/export
	client/export/builders client/export/component common common/record
Message-ID: <200609012111.k81LBgu6030406@sheep.berlios.de>

Author: krater
Date: 2006-09-01 23:11:41 +0200 (Fri, 01 Sep 2006)
New Revision: 619

Modified:
   trunk/src/net/sf/plantlore/client/export/ExportMng2.java
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
   trunk/src/net/sf/plantlore/client/export/ExportTask2.java
   trunk/src/net/sf/plantlore/client/export/Projection.java
   trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java
   trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/record/Record.java
Log:
DefaultExceptionHandler returned to its initial state.

Projections applies the list of selected columns to a query (addProjections()) a little bit more carefully. In order to process the record properly - namely to recognize, whether the record is marked for export or not - the Record.ID (= "id") must be add to the list of projections and *processed*, too.
The problem was that ID was not included in the list of properties of the record (as it is in fact an internal number of the database that hosts the record), therefore the ID was neither projected nor reconstructed which is why the record got always rejected. The Occurrence.ID is also required so as to be able to find all author-occurrences referring to that occurrence.

Export: Some final tuning of the *code*. Export will use projections for every format that allows the User to specify which columns should be exported, and it will use the record fetching (Hibernate is an object wrapper of a database - it return fully reconstructed records) otherwise. It may speed up a little bit the Export procedure (it is in fact the Import that has much greater need for speed up than Export).

Modified: trunk/src/net/sf/plantlore/client/export/ExportMng2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -19,8 +19,21 @@
 import org.apache.log4j.Logger;
 
 /**
+ * ExportManager serves as a Export Task factory. The Export Manager gathers all information
+ * needed for the creation of a new Export Task.
+ * <br/>
+ * In order to create a new Export task these information must be supplied:
+ * <ul>   
+ * <li>dblayer	The database layer mediating the access to the database.</li>
+ * <li>query	The query defining the result set which is to be iterated over.</li>
+ * <li>selection	The list of selected records. Null means all records from the query should be exported.</li>
+ * <li>projections	The list of selected columns. Null means all columns are selected.</li>
+ * <li>format	The format which will be used to determine the appropriate builder of the output.</li>
+ * <li>file	The name of the file where the output will be written.</li>
+ * <li>useProjections		Should projections be used (projections may reduce the amount of time required by export).</li>
+ * <li>rootTable	The root table (only if projections are used).</li>
+ * </ul>
  * 
- * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-29 
  * @version 2.0
@@ -48,9 +61,9 @@
 	
 	private Logger logger = Logger.getLogger(this.getClass().getPackage().getName());
 	private DBLayer db ;
-	private Projection template;
+	private Projection projections;
 	private Selection selection;
-	private FileFormat filter;
+	private FileFormat format;
 	private String filename;
 	private SelectQuery query = null;
 	private boolean useProjections = false;
@@ -62,11 +75,11 @@
 	 * 
 	 * @param dblayer The database layer mediating the access to the database.
 	 * @param query	The query defining the result set which is to be iterated over.
-	 * @param selection	The list of selected records. 
-	 * @param template	The list of selected columns. <b>Null means everything is selected.</b>
+	 * @param selection	The list of selected records. Null means all records from the query should be exported.
+	 * @param projection	The list of selected columns. Null means all columns are selected.
 	 */
-	public ExportMng2(DBLayer dblayer, SelectQuery query, Selection selection, Projection template) {
-		this(dblayer, query, selection, template, null, null, false, null);
+	public ExportMng2(DBLayer dblayer, SelectQuery query, Selection selection, Projection projection) {
+		this(dblayer, query, selection, projection, null, null, false, null);
 	}
 
 	
@@ -99,9 +112,9 @@
 	 * 
 	 * @param dblayer	The database layer mediating the access to the database. Shouldn't be empty.
 	 * @param query	The query defining the result set which is to be iterated over. Shouldn't be empty.
-	 * @param selection	The list of selected records. Shouldn't be empty.
-	 * @param template	The list of selected columns. <b>Null means everything is selected.</b>
-	 * @param filter	The filter which will be used to determine the appropriate builder of the output.
+	 * @param selection	The list of selected records. Null means all records from the query should be exported.
+	 * @param projections	The list of selected columns. Null means all columns are selected.
+	 * @param format	The format which will be used to determine the appropriate builder of the output.
 	 * @param file	The name of the file where the output will be written.
 	 * @param useProjections	Should projections be used.
 	 * @param rootTable	The root table (only if projections are used).
@@ -121,14 +134,15 @@
 		setDBLayer(dblayer);
 		setSelectQuery(query);
 		setSelection(selection);
-		setTemplate(template);
+		setProjections(template);
 		setSelectedFile(filename);
-		setActiveFileFilter(filter);
+		setFileFormat(filter);
 	}
 	
 	
 	/**
 	 * @param useProjections	True if the Export manager shall use projections instead of regular records.
+	 * Projections may save some time if the number of exported columns is small.
 	 */
 	synchronized public void useProjections(boolean useProjections) {
 		this.useProjections = useProjections;
@@ -146,25 +160,30 @@
 	
 	/**
 	 * Set a new DBLayer.
+	 * 
+	 * @param dblayer The database layer mediating the access to the database. Shouldn't be empty.
 	 */
 	synchronized public void setDBLayer(DBLayer dblayer) {
 		db = dblayer;
 	}
 	
 	/**
-	 * Store a copy of the <code>template</code>. 
-	 * Null means all columns are selected.
+	 * Store a copy of the list of <code>projections</code>. 
+	 * 
+	 * @param projections The list of columns the User wants to export. 
+	 * Null means that all columns should be sellected.
 	 */
-	synchronized public void setTemplate(Projection template) {
-		if(template == null)
-			this.template = null;
+	synchronized public void setProjections(Projection projections) {
+		if(projections == null)
+			this.projections = null;
 		else 
-			this.template = template.clone();
+			this.projections = projections.clone();
 	}
 	
 	/**
-	 * Store a copy of the <code>selection</code>.
-	 * Null means all rows are selected.
+	 * Store a copy of the list of selected rows (records).
+	 * 
+	 * @param selection	The list of records that should be exported. Null means that all records are selected.
 	 */
 	synchronized public void setSelection(Selection selection) {
 		if(selection == null)
@@ -173,14 +192,32 @@
 			this.selection = selection.clone();
 	}
 	
-	synchronized public void setActiveFileFilter(FileFormat filter) {
-		this.filter = filter; 
+	/**
+	 * Set the file format that should be Used to store the exported records. 
+	 * 
+	 * @param format	The file format that will be used to store the selected records.
+	 */
+	synchronized public void setFileFormat(FileFormat format) {
+		this.format = format; 
 	}
 	
+	/**
+	 * Set the name of the file into which the records will be exported.
+	 * 
+	 * @param filename	The name of the file where the records will be written.
+	 */
 	synchronized public void setSelectedFile(String filename) { 
 		this.filename = filename; 
 	}
 	
+	/**
+	 * Set the query that defines the superset of records from which some
+	 * (those that are marked in the Selection) records will be exported.
+	 * The query must not be executed! The Export Task will execute it itself.
+	 * 
+	 * @param query	The query that defines the superset of records from which some
+	 * will be exported.
+	 */
 	synchronized public void setSelectQuery(SelectQuery query) { 
 		// Close the previous query!
 		if(this.query != null) try {
@@ -191,10 +228,15 @@
 		this.query = query;
 	}
 	
-	
-	
-	
-
+	/**
+	 *	Create a new Export Task. The task is ready to be started.
+	 * <br/>
+	 * All previously supplied information will be reset to default values
+	 * (except the database layer) - in order to create a new Export task,
+	 * all information must be supplied again.
+	 * 
+	 * @return	The new Export Task ready to be started.
+	 */
 	synchronized public ExportTask2 createExportTask() 
 	throws ExportException, IOException, DBLayerException {
 		// Check if all necessary components are valid.
@@ -202,33 +244,35 @@
 			throw new ExportException(L10n.getString("Error.InvalidDBLayer"));
 		if( query == null)
 			throw new ExportException(L10n.getString("Error.InvalidQuery"));
-		if( filter == null ) 
+		if( format == null ) 
 			throw new ExportException(L10n.getString("Error.InvalidFilter"));
 		if( filename == null || filename.length() == 0 ) 
 			throw new ExportException(L10n.getString("Error.MissingFileName"));
 		if( useProjections && rootTable == null)
 			throw new ExportException(L10n.getString("Error.InvalidRootTable"));
-		if(template == null || template.isEmpty())
-			template = new Projection().setEverything();
+		if(projections == null || projections.isEmpty())
+			projections = new Projection().setEverything();
 		if(selection == null || selection.isEmpty())
 			selection = new Selection().all();
 			
+		//useProjections = true;
 		
-		logger.debug("Initializing the export environment.");
+		logger.debug("Creating necessary participants.");
+		projections.set(Occurrence.class, Occurrence.ID);
 		
 		// Prepare the query for projections.
 		if(useProjections) {
 			if( rootTable == AuthorOccurrence.class || rootTable == Author.class )
-				template.addProjections( query, AuthorOccurrence.class, Author.class );
+				projections.addProjections( query, AuthorOccurrence.class, Author.class );
 			else
-				template.addProjections( query, 
+				projections.addProjections( query, 
 					Occurrence.class, Plant.class, Metadata.class, Publication.class, 
 					Habitat.class, Territory.class, NearestVillage.class, Phytochorion.class );
 		}
 		
 		// Create a new file and writer (wrapper).
 		Writer writer = new BufferedWriter(
-					new OutputStreamWriter(new FileOutputStream(filter.suggestName(filename)),
+					new OutputStreamWriter(new FileOutputStream(format.suggestName(filename)),
 					ENCODING));
 		if(writer == null) {
 			logger.fatal("Unable to create a new Writer.");
@@ -239,29 +283,35 @@
 		
 		// Create a new builder according to the selected format. 
 		Builder builder;
-		if(filter.getDescription().equals(L10n.getString("Format.CSV")))
-			builder = new CSVBuilder(writer, template);
-		else if(filter.getDescription().equals(L10n.getString("Format.DC")))                        
+		if(format.getDescription().equals(L10n.getString("Format.CSV")))
+			builder = new CSVBuilder(writer, projections);
+		else if(format.getDescription().equals(L10n.getString("Format.DC")))                        
 			builder = new DarwinCoreBuilder(writer);
-		else if(filter.getDescription().equals(L10n.getString("Format.ABCD"))) 
+		else if(format.getDescription().equals(L10n.getString("Format.ABCD"))) 
 			builder = new ABCDBuilder(writer);
-		else if(filter.getDescription().equals(L10n.getString("Format.XML")))                        
-			builder = new XMLBuilder2(template, writer);                       
-		else if(filter.getDescription().equals(L10n.getString("Format.PlantloreNative")))                        
+		else if(format.getDescription().equals(L10n.getString("Format.XML")))                        
+			builder = new XMLBuilder2(projections, writer);                       
+		else if(format.getDescription().equals(L10n.getString("Format.PlantloreNative")))                        
 			builder = new XMLBuilder2(writer);                       
 		else {
-			builder = new TrainingBuilder(template);
+			builder = new TrainingBuilder(projections);
+			writer.close();
+			(new java.io.File(filename)).delete();
 		}
 
+		// Create the task!
+		ExportTask2 t;
+		if( useProjections )
+			t =new ExportTask2(db, query, writer, builder, selection, projections, rootTable);
+		else
+			t = new ExportTask2(db, query, writer, builder, selection);
+		t.ignoreDead( format.ignoreDead() );
 		
-		ExportTask2 t = new ExportTask2(db, query, writer, builder, selection);
-		t.ignoreDead( filter.ignoreDead() );
-		
 		// Reset variables.
 		query = null;
-		template = null;
+		projections = null;
 		selection = null;
-		filter = null;
+		format = null;
 		filename = null;
 		useProjections = false;
 		rootTable = Occurrence.class;

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -2,28 +2,37 @@
 
 import java.awt.event.ActionEvent;
 
-import javax.swing.AbstractAction;
 import javax.swing.JFileChooser;
+import javax.swing.JFrame;
 import javax.swing.JOptionPane;
 import javax.swing.filechooser.FileFilter;
 
-import net.sf.plantlore.client.AppCoreView;
 import net.sf.plantlore.client.export.component.FileFormat;
 import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
 
+/**
+ * The mapping of the button in the view to action
+ * that opens the second part of the dialog - the Column Selection -
+ * or Creates and starts the Export task.
+ * 
+ * Also the field validity check is performed.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ */
 public class ExportMngCtrl2 {
 	
 	
 	private ExportMng2 model;
-	private AppCoreView parentView;
+	private JFrame parentView;
 	private JFileChooser choice;
 	
 	private ExportMngViewB viewB;
 	
 
 	
-	public ExportMngCtrl2(ExportMng2 model, AppCoreView view) {
+	public ExportMngCtrl2(ExportMng2 model, JFrame view) {
 		this.model = model; 
 		this.parentView = view;
 		
@@ -35,40 +44,57 @@
 			choice.addChoosableFileFilter(filter);
 	}
 	
-	
+	/**
+	 * Let the User choose the name and format of the file and
+	 * then either proceed to the column selection, or create and start the new Export task.
+	 * 
+	 * @param visible	True if the dialog should be opened.
+	 */
 	public void setVisible(boolean visible) {
 		if(visible) {
 			// The dialog must have a parent so that it is displayed correctly after ALT+TAB is pressed.
 			int result = choice.showDialog(parentView, L10n.getString("Export.Title"));
 			if( result == JFileChooser.APPROVE_OPTION ) {
 				model.setSelectedFile( choice.getSelectedFile().getAbsolutePath() );
-				FileFormat filter = (FileFormat) choice.getFileFilter();
-				model.setActiveFileFilter( filter );
+				FileFormat format = (FileFormat) choice.getFileFilter();
+				model.setFileFormat( format );
 				
-				if( filter.isColumnSelectionEnabled() )
+				if( format.isColumnSelectionEnabled() ) {
+					// Reset the the tree to the initial state.
+					((net.sf.plantlore.client.export.component.ExtendedTree)(viewB.tree)).collapseAll();
 					viewB.setVisible(true);
+				}
 				else 
 					performExport();
 			}
 		}
 	}
 	
-	
-	private class NextAction extends AbstractAction {
+	/**
+	 * Proceed to the column selection dialog or createa and start the Export task, 
+	 * if the format doesn't support column selection. 
+	 *
+	 */
+	private class NextAction extends StandardAction {
 		public NextAction() {
-			putValue(NAME, L10n.getString("Export.Title"));
+			super("Export.Title");
 		}
 		public void actionPerformed(ActionEvent arg0) {
+			// Get the list of projections.
 			Projection t = viewB.tsm.getProjections();
 			viewB.setVisible(false);
-			model.setTemplate( t ); // Set the new template.
+			// Supply the list of projections to the ExportManager (Export task factory).
+			model.setProjections( t );
+			model.useProjections(true);
 			viewB.tsm.clearSelection();
 			
 			performExport();
 		}
 	}
 
-	
+	/**
+	 * Create the Export task and start it.
+	 */
 	private void performExport() {
 		try {
 			ExportTask2 export = model.createExportTask();

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -13,8 +13,9 @@
 import net.sf.plantlore.l10n.L10n;
 
 /**
- *
- * @author  yaa
+ * Allows the User to select columns (i.e. properties of the records) that should be exported.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
  */
 public class ExportMngViewB extends javax.swing.JDialog {
 	

Modified: trunk/src/net/sf/plantlore/client/export/ExportTask2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -13,6 +13,7 @@
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.exception.ExportException;
+import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.Occurrence;
 import net.sf.plantlore.common.record.Record;
@@ -20,6 +21,39 @@
 import net.sf.plantlore.middleware.DBLayer;
 import net.sf.plantlore.middleware.SelectQuery;
 
+/**
+ * The Export task serves as a Director for the selected Builder.
+ * It takes the supplied query, executes it, and hands over every
+ * record, that is selected to be exported, to the Builder.
+ * <br/>
+ * The database layer is capable of retrieving whole records (objects)
+ * from the database. 
+ * Sometimes it may cost a lot of time to reconstruct the whole record and if we want
+ * to export just a few columns, we would not use the rest of the record anyway.
+ * This may lead to a great overhead. In order to reduce this overhead, projections can be used.
+ * Projections is a list of columns the User wants to export; the list is typically very small.
+ * The database layer is instructed to return only the values of those columns.
+ * <br/>
+ * Let's see an example:
+ * <br/>
+ * The User exports Occurrences and is interrested in three columns only:
+ * Occurrence.UnitID, Occurrence.Plant.Taxon, Occurrence.Habitat.NearestVillage.Name.
+ * It would not be wise to retrieve the whole record that comprises dozens of columns
+ * some of which may contain a lot of data. We set those three projections and
+ * instruct the Task to use them. The database layer will then return just those three values
+ * for every record, then it will reconstruct the record from those values, 
+ * and finally it will pass it to the Builder. This can speed up the Export enormously, 
+ * especially when a remote connection is used.
+ * <br/>
+ * However, the usual use of Export is to export the whole record, 
+ * therefore it is much more convenient to have the database layer 
+ * reconstructed the object for us. 
+ * 
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-01
+ * @version 2.0
+ */
 public class ExportTask2 extends Task {
 	
 private Logger logger = Logger.getLogger(getClass().getPackage().getName());
@@ -30,13 +64,22 @@
 	private Integer resultId;
 	private boolean ignoreDead = true;
 	private boolean useProjections = false;
+	private Projection projections;
 	private List<Pair<Class, String>> description;
 	private SelectQuery query;
 	private Writer writer;
 	private Record torso;
 	
 	
-	
+	/**
+	 * Create a new Export task. 
+	 * 
+	 * @param dblayer	The database layer that mediates the connection with the database. 
+	 * @param query	The query defining the result set which is to be iterated over.
+	 * @param writer	The writer that will be used for the output.
+	 * @param builder	The builder that will construct the output from records the Director supplies.
+	 * @param selection	The list of selected records - only the selected records will be exported.
+	 */
 	public ExportTask2(
 			DBLayer dblayer, 
 			SelectQuery query, 
@@ -51,20 +94,31 @@
 		this.build = builder;
 	}
 	
-	// Pro pouziti s projekcema
+	/**
+	 * Create a new Export task. This Export task is set to use projections.
+	 * 
+	 * @param dblayer	The database layer that mediates the connection with the database. 
+	 * @param query	The query defining the result set which is to be iterated over.
+	 * @param writer	The writer that will be used for the output.
+	 * @param builder	The builder that will construct the output from records the Director supplies.
+	 * @param selection	The list of selected records - only the selected records will be exported.
+	 * @param projections	The list of columns that should be exported.
+	 * @param rootTable	The root table (only if projections are used).
+	 */
 	public ExportTask2(
 			DBLayer dblayer, 
 			SelectQuery query, 
 			Writer writer, 
 			Builder builder, 
 			Selection selection,
-			List<Pair<Class, String>> description, 
+			Projection projections,
 			Class rootTable) 
 	throws ExportException {
 		
 		this(dblayer, query, writer, builder, selection);
 		this.useProjections = true;
-		this.description = description;
+		this.projections = projections;
+		this.description = projections.getDescription();
 		try { 
 			torso = (Record)rootTable.newInstance();
 			torso.createTorso();
@@ -73,6 +127,14 @@
 		}
 	}
 	
+	/**
+	 * Some records may be marked as deleted (so that Plantlore can revive them
+	 * it the User tells him to). Some formats may wish to skip such records, others
+	 * may make use of them.
+	 * 
+	 * @param ignore	True if the dead records should be skipped.
+	 * @return	The Export task itself.
+	 */
 	public ExportTask2 ignoreDead(boolean ignore) {
 		this.ignoreDead = ignore;
 		return this;
@@ -102,12 +164,12 @@
 				
 				Record record;
 				if(useProjections) 
-					record = reconstruct( (Object[])database.more( resultId, i, i )[0] );
+					record = reconstruct( torso, (Object[])database.more( resultId, i, i )[0], description );
 				else
 					record = (Record)((Object[])database.more( resultId, i, i )[0])[0];
 				
 				
-				logger.debug("New record No. "+i+" fetched: "+record);
+				logger.debug("New record No. "+i+" fetched: "+record.toFullString());
 				if( !selection.contains( record ) || (ignoreDead && record.isDead()) ) 
 					continue; // Is the record selected?
 				
@@ -145,8 +207,9 @@
 		return null;
 	}
 	
-	
-	
+	/**
+	 * Perform the final cleanup - close the file and the query. 
+	 */
 	private void cleanup() {
 		try {
 			writer.close();
@@ -162,36 +225,61 @@
 	 * Find all AuthorOccurrences associated with the <code>Occurrence</code>
 	 * and send them to the Builder, too.
 	 * 
-	 * @param occurrence	The currently processed occurrence data.
+	 * @param occurrence	The currently processed occurrence record.
 	 */
 	private void loadAssociatedAuthors(Occurrence occurrence) 
 	throws RemoteException, IOException, DBLayerException {
 		
 		logger.debug("Processing the associated information about Authors.");
 		
-		SelectQuery query = database.createQuery(AuthorOccurrence.class);
-		query.createAlias(AuthorOccurrence.OCCURRENCE, "OCC");
-
-		// AuthorOccurrence.OCCURRENCE = Occurrence.ID  &&  Occurrence.ID = occ.getId()
-		query.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, AuthorOccurrence.OCCURRENCE, "OCC."+Occurrence.ID, null, null);
-		query.addRestriction(PlantloreConstants.RESTR_EQ, "OCC."+Occurrence.ID, null, occurrence.getId(), null);
-		int resultId = database.executeQuery( query );
-		
-		// Take all results and spit'em out.
-		int rows = database.getNumRows( resultId );
-		for(int i = 0; i < rows; i++) {
-			logger.debug("Fetching associated data (Author, AuthorOccurrence).");
+		SelectQuery query = null;
+		try {
+			query = database.createQuery(AuthorOccurrence.class);
 			
-			Object[] pulp = database.more( resultId, i, i );
-			AuthorOccurrence ao = (AuthorOccurrence) ((Object[])pulp[0])[0];
-			ao.setOccurrence( null ); // cut off the way back to the occurrence
-			if(ao.isDead() && ignoreDead) continue;
+			query.createAlias(AuthorOccurrence.OCCURRENCE, "OCC");
+			/* 6 lines of new code */
+			query.createAlias(AuthorOccurrence.AUTHOR, Record.alias(Author.class));
+			List<Pair<Class, String>> description = null;
+			if( useProjections )
+				description = projections.addProjections(query, AuthorOccurrence.class, Author.class);
 			
-			logger.debug("New author-occurence record: " + ao.toFullString());
+			AuthorOccurrence ao = new AuthorOccurrence();
+			ao.setAuthor(new Author());
 			
-			build.part( ao );
+			// AuthorOccurrence.OCCURRENCE = Occurrence.ID  &&  Occurrence.ID = occ.getId()
+			query.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, AuthorOccurrence.OCCURRENCE, "OCC."+Occurrence.ID, null, null);
+			query.addRestriction(PlantloreConstants.RESTR_EQ, "OCC."+Occurrence.ID, null, occurrence.getId(), null);
+			int resultId = database.executeQuery( query );
+			
+			// Take all results and send them to the Builder as well.
+			int rows = database.getNumRows( resultId );
+			for(int i = 0; i < rows; i++) {
+				logger.debug("Fetching associated data (Author, AuthorOccurrence).");
+				
+				/* 4 lines of new code */
+				if(useProjections) 
+					ao = (AuthorOccurrence) reconstruct( ao, (Object[])database.more( resultId, i, i )[0], description );
+				else
+					ao = (AuthorOccurrence) ((Object[])database.more( resultId, i, i )[0])[0];
+				
+//				Object[] pulp = database.more( resultId, i, i );
+//				AuthorOccurrence ao = (AuthorOccurrence) ((Object[])pulp[0])[0];
+				ao.setOccurrence( null ); // cut off the way back to the occurrence
+				if(ao.isDead() && ignoreDead) continue;
+				
+				logger.debug("New author-occurence record: " + ao.toFullString());
+				
+				build.part( ao );
+			}
 		}
-		database.closeQuery( query );
+		finally {
+			if( query != null) 
+				try {
+					database.closeQuery( query );
+				} catch(Exception e) {
+					// Nothing we can do.
+				}
+		}
 		
 		logger.debug("Author-occurence processed.");
 	}
@@ -205,7 +293,7 @@
 	 * <code>Occurrence.ID</code> and <code>Plant.TAXON<code> and
 	 * <code>NearestVillage.NAME</code>. Database layer returns
 	 * [3292, "Rubus sp.", "?esk? Bud?jovice"]. The `description` is the key to
-	 * those values, as it says:
+	 * identificaton of those values, as it says:
 	 * <code>Occurrence.ID = 3292</code>,
 	 * <code>Plant.TAXON = Rubus sp.</code> and
 	 * <code>NearestVillage = ?esk? Bud?jovice</code>.
@@ -213,9 +301,11 @@
 	 * Without the description we would not know what value belongs to which column.
 	 * 
 	 * @param values	Values of columns (in the same order as in the Description).
+	 * @param torso	The record that should be filled with values.
+	 * @param description The description of columns.
 	 * @return	The reconstructed record.
 	 */
-	private Record reconstruct(Object[] values) {
+	private Record reconstruct(Record torso, Object[] values, List<Pair<Class, String>> description) {
 		for(int i = 0; i < description.size(); i++ ) {
 			Pair<Class, String> d = description.get(i);
 			torso.setValue(d.getFirst(), d.getSecond(), values[i]);

Modified: trunk/src/net/sf/plantlore/client/export/Projection.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/Projection.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/Projection.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -205,7 +205,10 @@
 	private void addProjections(SelectQuery q, Class table, boolean omitAlias) {
 		try {
 			Record r = (Record)table.newInstance();
-			for(String property : r.getProperties())
+			List<String> properties = r.getProperties();
+			properties.add(Occurrence.ID);
+
+			for(String property : properties)
 				if( isSet(table, property) ) {
 					q.addProjection(PROJ_PROPERTY, (omitAlias ? property : Record.alias(table)+"."+property));
 					plan.add(new Pair<Class, String>(table, property));

Modified: trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/builders/XMLBuilder2.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -96,7 +96,7 @@
      */
     public void footer() 
     throws IOException {
-    	outputWriter.write("</occurrences>\n");
+    	outputWriter.write("\n\n</occurrences>\n");
         xmlWriter.close();
     }
     

Modified: trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/client/export/component/ExtendedTree.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -313,7 +313,7 @@
 	
 	
 	/**
-	 * Collapse all nodes.
+	 * Collapse all nodes (i.e. restore the tree to its initial state).
 	 *
 	 */
 	public void collapseAll() {

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -1,6 +1,5 @@
 package net.sf.plantlore.common;
 
-import java.awt.Component;
 import java.rmi.*;
 import java.rmi.server.ExportException;
 
@@ -21,9 +20,6 @@
  */
 public class DefaultExceptionHandler {
 	
-	private static DefaultExceptionHandler D = new DefaultExceptionHandler();
-
-
 	private DefaultExceptionHandler() {}
 
 
@@ -157,9 +153,6 @@
 					title, 
 					JOptionPane.ERROR_MESSAGE );
 		
-		System.out.println("~~DefaultExceptionHandler~~");
-		System.out.println(problemDescription);
-		
 	}
 	
 	

Modified: trunk/src/net/sf/plantlore/common/record/Record.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Record.java	2006-09-01 18:45:22 UTC (rev 618)
+++ trunk/src/net/sf/plantlore/common/record/Record.java	2006-09-01 21:11:41 UTC (rev 619)
@@ -490,7 +490,7 @@
 			append(property).append(" = ").append(this.getValue(property)).append("; ");
 		for(String key : getForeignKeys()) {
 			Record subrecord = (Record)getValue(key); 
-			if(subrecord != null)	sigma.append( subrecord.toString() );
+			if(subrecord != null)	sigma.append( subrecord.toFullString() );
 		}
 		return sigma.toString();
 	}



From fraktalek at gmx.net  Sat Sep  2 00:11:44 2006
From: fraktalek at gmx.net (fraktalek)
Date: Sat, 02 Sep 2006 00:11:44 +0200
Subject: [Plantlore-dev] mensi problem s vytuhavanim
Message-ID: <1157148704.2690.10.camel@kryton>

Spustit plantlore, prihlasit se k databazi.
Kliknout na nejaky nalez, kliknout na Upravit.
Okamzite, jeste nez se staci objevit Edit dialog, kliknout na Historii.
Naskoci progressbar od Historie a Plantlore vytuhne.
Bud rovnou, nebo kdyz se pak zrusi edit dialog a da se historie tak pak
treba.


Nenacitam data v editu v tasku, zitra to predelam.
Mozna by ale stalo za zvazeni, jestli nevypinat akce na dobu, kdy se
startuje nebo uz bezi jina akce. Vetsinou, aspon kdyz uzivatel klika
mysi, se to vyresi modalitou dialogu. Obcas ale jde akce volat
klavesovou zkratkou. V tom pripade by tam treba taky mohl nastat
neocekavany zmatek. Pokud by napr. nekdo dal editovat nalez - mel
zobrazeny edit dialog, ale nejakym zpusobem vyvolal akci delete v
overview (podle me by to jit nemelo, pisu to sem spis na zamyslenou).

Jakub




From fraktalek at mail.berlios.de  Sat Sep  2 00:12:39 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 00:12:39 +0200
Subject: [Plantlore-dev] r620 - in trunk/src/net/sf/plantlore:
	client/overview l10n
Message-ID: <200609012212.k81MCd3Y004577@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 00:12:38 +0200 (Sat, 02 Sep 2006)
New Revision: 620

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
   trunk/src/net/sf/plantlore/l10n/L10n.java
Log:
Wrote some JavaDocs and tuned a few bits of code.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-01 21:11:41 UTC (rev 619)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-01 22:12:38 UTC (rev 620)
@@ -3,8 +3,6 @@
  *
  * Created on 20. duben 2006, 14:26
  *
- * To change this template, choose Tools | Template Manager
- * and open the template in the editor.
  */
 
 package net.sf.plantlore.client.overview;
@@ -43,8 +41,15 @@
 import net.sf.plantlore.common.exception.DBLayerException;
 import org.apache.log4j.Logger;
 
-/**
+/** Model of the AddEdit dialog.
  *
+ * Handles all the inner logic of the two dialogs. Gathers data from user, loads
+ * data from the database for given occurrence id, stores the data into the 
+ * database, creates new occurrences, updates them, deletes them if necessary.
+ *
+ * The {@link storeRecord()} method should use the DBLayerUtils more so that
+ * it would work exactly the same as import does.
+ *
  * @author fraktalek
  */
 public class AddEdit extends Observable {
@@ -219,7 +224,7 @@
         altitude = o.getHabitat().getAltitude();
         longitude = o.getHabitat().getLongitude();
         latitude = o.getHabitat().getLatitude();
-//--
+
         habitatNoteOld = o.getHabitat().getNote();
         territoryNameOld = new Pair(o.getHabitat().getTerritory().getName(),o.getHabitat().getTerritory().getId());
         phytNameOld = new Pair(o.getHabitat().getPhytochorion().getName(), o.getHabitat().getPhytochorion().getId());
@@ -229,7 +234,7 @@
         altitudeOld = o.getHabitat().getAltitude();
         longitudeOld = o.getHabitat().getLongitude();
         latitudeOld = o.getHabitat().getLatitude();
-//--        
+
         source = o.getDataSource();
         if (o.getPublication() != null)
             publication = new Pair(o.getPublication().getReferenceCitation(), o.getPublication().getId());
@@ -283,7 +288,11 @@
     }//setHabitat
 
     /** Convenience method for {@link hasHabitatChanged()}.
+     * @param o1 object to compare
+     * @param o2 object to compare
      *
+     * @return true if o1.equals(o2) or both objects are null
+     * @return false otherwise
      */
     private boolean equal(Object o1, Object o2) {
         if (o1 == null && o2 != null)
@@ -295,6 +304,10 @@
      *
      * We need to keep track of changes to habitat for the case that it is shared by two and more occurrences. 
      * In that case we have to ask user whether he wants to divide this habitat or change it for all occurrences.
+     *
+     * Compares values preserved in *Old habitat variables with the actual habitat variables.
+     *
+     * @return true if all every habitat variable is {@link equal()} to it's counterpart.
      */
     public boolean hasHabitatChanged() {
     return !( 
@@ -312,38 +325,44 @@
             );
     }
     
+    /** Author getter. */
     public Pair<String, Integer> getAuthor(int i) {
         return ((Pair<Pair<String,Integer>,String>)authorList.get(i)).getFirst();
     }
     
+    /** Author role getter. */
     public String getAuthorRole(int i) {
         return ((Pair<Pair<String,Integer>,String>)authorList.get(i)).getSecond();
     }
     
+    /** Determines the number of author that the model holds.
+     * @return the number of authors
+     */
     public int getAuthorCount() {
-        return authorList.size();
+        return authorList == null ? 0 : authorList.size();
     }
     
+    /** Adds an author to the list of authors held by the model.
+     *
+     * @param author the author to be added
+     */
     public void addAuthor(Pair<Pair<String, Integer>,String> author) {
         authorList.add(author);
         logger.debug("Added author "+author.getFirst()+" as "+author.getSecond());
     }
     
-    /*public Pair<Pair<String, Integer>,String> removeAuthor(int i) {
-        Pair<Pair<String, Integer>,String> author = authorList.remove(i);
-        logger.debug("Removed author "+author.getFirst()+" "+author.getSecond());
-        return author;
-    }*/
-
+    /** Village getter. */
     public Pair<String, Integer> getVillage() {
         return village;
     }
 
+    /** Village setter. */
     public void setVillage(Pair<String, Integer> village) {
         this.village = village;
         logger.debug("NearestVillage set to "+village);
     }
 
+    /** Taxon getter. */
     public String getTaxon(int i) {
         if (taxonList == null || taxonList.size() == 0)
             return "";
@@ -351,21 +370,28 @@
         return (String) taxonList.get(i);
     }
 
+    /** Habitat description getter. */
     public String getHabitatDescription() {
         return habitatDescription;
     }
 
+    /** Habitat description setter. */
     public void setHabitatDescription(String habitatDescription) {
         this.habitatDescription = habitatDescription;
         logger.debug("HabitatDescription set to "+habitatDescription);
     }
 
+    /** Year getter. 
+     * In case the year hasn't been set yet or was set to null this method
+     * determines the current year and returns it.
+     */
     public Integer getYear() {
         if (year == null)
             year = Calendar.getInstance().get(Calendar.YEAR);
         return year;
     }
 
+    /** Year setter. */
     public void setYear(Integer year) {
         this.year = year;
         logger.debug("Year set to "+ year);
@@ -373,37 +399,47 @@
         notifyObservers("YEAR_CHANGED");
     }
 
+    /** Habitat note getter. */
     public String getHabitatNote() {
         return habitatNote;
     }
 
+    /** Habitat note setter. */
     public void setHabitatNote(String habitatNote) {
         this.habitatNote = habitatNote;
         logger.debug("HabitatNote set to "+ habitatNote);
     }
 
+    /** Occurrence note getter. */
     public String getOccurrenceNote() {
         return occurrenceNote;
     }
 
+    /** Occurrence note setter. */
     public void setOccurrenceNote(String occurrenceNote) {
         this.occurrenceNote = occurrenceNote;
         logger.debug("OccurrenceNote set to "+occurrenceNote);
     }
 
+    /** Territory name getter. */
     public Pair<String, Integer> getTerritoryName() {
         return territoryName;
     }
 
+    /** Territory name setter. */
     public void setTerritoryName(Pair<String, Integer> territoryName) {
         this.territoryName = territoryName;
         logger.debug("TerritoryName set to "+territoryName);
     }
 
+    /** Phytochorion name getter. */
     public Pair<String, Integer> getPhytName() {
         return phytName;
     }
 
+    /** Phytochorion name setter. 
+     * Also updates the phytochorion code and notifies observers about that change.
+     */
     public void setPhytName(Pair<String, Integer> phytName) {
         if (phytName == null)
             return;
@@ -429,11 +465,15 @@
         setChanged();
         notifyObservers(new Pair<String,Integer>("updateCode",-1));
     }
-
+    
+    /** Phytochorion code getter. */
     public Pair<String, Integer> getPhytCode() {
         return phytCode;
     }
 
+    /** Phytochorion code setter. 
+     * Also updates the phytochorion name and notifies observers about that change.
+     */
     public void setPhytCode(Pair<String, Integer> phytCode) {
         if (phytCode == null)
             return;
@@ -462,10 +502,12 @@
         notifyObservers(new Pair<String,Integer>("updateName",-1));
     }
 
+    /** Phytochorion country getter. */
     public String getPhytCountry() {
         return phytCountry;
     }
 
+    /** Phytochorion country setter. */
     public void setPhytCountry(String phytCountry) {
         if (phytCountry != null && !phytCountry.equals(EMPTY_STRING)) {
             this.phytCountry = phytCountry;
@@ -476,25 +518,31 @@
         }
     }
 
+    /** Quadrant getter. */
     public String getQuadrant() {
         return quadrant;
     }
 
+    /** Quadrant getter. */
     public void setQuadrant(String quadrant) {
         this.quadrant = quadrant;
         logger.debug("Quadrant set to "+ quadrant);
     }
 
+    /** Altitude getter. */
     public Double getAltitude() {
         return altitude;
     }
 
+    /** Altitude setter. */
     public void setAltitude(Double altitude) {
         this.altitude = altitude;
         logger.debug("Altitude set to "+altitude);
         altitudeValid = true;
     }
 
+    /** Sets whether the value returned by {@link getAltitude()} should be considered valid.
+     */
     public void setAltitudeValid(boolean valid) {
         altitudeValid = valid;
         if (valid)
@@ -502,17 +550,21 @@
         else
             logger.debug("Altitude set INVALID");
     }
-    
+
+    /** Longitude getter. */
     public Double getLongitude() {
         return longitude;
     }
 
+    /** Longitude setter. */
     public void setLongitude(Double longitude) {
         this.longitude = longitude;
         logger.debug("Longitude set to "+longitude);
         longitudeValid = true;
     }
 
+    /** Sets whether the value returned by {@link getLongitude()} should be considered valid.
+     */
     public void setLongitudeValid(boolean valid) {
         longitudeValid = valid;
         if (valid)
@@ -521,16 +573,20 @@
             logger.debug("Longitude set INVALID");
     }
     
+    /** Latitude getter. */
     public Double getLatitude() {
         return latitude;
     }
 
+    /** Latitude setter. */
     public void setLatitude(Double latitude) {
         this.latitude = latitude;
         logger.debug("Latitude set to "+latitude);
         latitudeValid = true;
     }
 
+    /** Sets whether the value returned by {@link getLatitude()} should be considered valid.
+     */
     public void setLatitudeValid(boolean valid) {
         latitudeValid = valid;
         if (valid)
@@ -539,10 +595,14 @@
             logger.debug("Latitude set INVALID");
     }
     
+    /** Source getter. */
     public String getSource() {
         return source;
     }
 
+    /** Source setter. 
+     * If the parameter source euqals to {@link EMPTY_STRING} then it sets the source to null.
+     */
     public void setSource(String source) {
         if (source != null && !source.equals(EMPTY_STRING)) {
             this.source = source;
@@ -553,10 +613,14 @@
         }
     }
 
+    /** Publication getter. */
     public Pair<String, Integer> getPublication() {
         return publication;
     }
 
+    /** Publication setter.
+     * If the parameter source euqals to {@link EMPTY_STRING} then it sets the publication to null.
+     */
     public void setPublication(Pair<String, Integer> publication) {
         if (publication != null && !publication.equals(EMPTY_PAIR)) {
             this.publication = publication;
@@ -567,19 +631,25 @@
         }
     }
 
+    /** Herbarium getter. */
     public String getHerbarium() {
         return herbarium;
     }
 
+    /** Herbarium setter. */
     public void setHerbarium(String herbarium) {
         this.herbarium = herbarium;
         logger.debug("Herbarium set to "+herbarium);
     }
 
+    /** Month getter. */
     public Integer getMonth() {
         return month;
     }
 
+    /** Month setter. 
+     * Notifies observers that the day chooser should be updated.
+     */
     public void setMonth(Integer month) {
         this.month = month;
         logger.debug("Month set to "+month);
@@ -587,6 +657,7 @@
         notifyObservers("updateDayChooser");
     }
 
+    /** Day getter. */
     public Integer getDay() {
         return day;
     }
@@ -600,6 +671,9 @@
         setDayValid(true);
     }
     
+    /** Sets whether the value returned by {@link getDay()} method should be considered valid.
+     *
+     */
     public void setDayValid(boolean valid) {
         if (valid)
             logger.debug("Day set VALID.");
@@ -608,6 +682,7 @@
         dayValid = valid;
     }
 
+    /** Time getter. */
     public Date getTime() {
         return time;
     }
@@ -621,6 +696,9 @@
         setTimeValid(true);
     }
     
+    /** Sets whether the value returned by {@link getTime()} method should be considered valid.
+     *
+     */
     public void setTimeValid(boolean valid) {
         if (valid)
             logger.debug("Time set VALID.");
@@ -628,29 +706,38 @@
             logger.debug("Time set INVALID.");                    
         timeValid = valid;
     }
-    
+
+    /** DBLayer getter. */
     public DBLayer getDatabase() {
         return database;
     }
 
+    /** Sets new database layer.
+     * Now it actually only notifies  about a reconnect thanks to the change
+     *that the DBLayer is now only a proxy to the actual DBLayer.
+     */
     public void setDatabase(DBLayer database) {
         this.database = database;
         occurrenceTableModel.setDBLayer(database);
     }
 
+    /** Project getter.     */
     public Pair<String, Integer> getProject() {
         return project;
     }
 
+    /** Project setter. */
     public void setProject(Pair<String, Integer> project) {
         logger.debug("Project set to "+project);
         this.project = project;
     }
 
+    /** Coordinate system getter. */
     public int getCoordinateSystem() {
         return coordinateSystem;
     }
 
+    /** Coordinate system setter. */
     public void setCoordinateSystem(int coordinateSystem) {
         this.coordinateSystem = coordinateSystem;       
         switch (coordinateSystem) {
@@ -686,9 +773,10 @@
     
     /** Pre-processes data gathered from the user.
      *
-     * @paran author one of the authors of this occurrence to be processed
+     * @param author one of the authors of this occurrence to be processed
      * @param newRecord if true then new record is to be created - e.g. we are in Add mode, otherwise the record is updated
      * @param updateAllPlants if true then the shared habitat is updated, if false then a new habitat is created and asociated with our AuthorOccurrence object o. Has only sense if newRecord is true.
+     *
      * @return AuthorOccurrence the object that will be created or updated
      * @return true the object has to be updated
      * @return false the object has to be created
@@ -754,19 +842,14 @@
         occ.setDataSource(source);        
         
         occ.setDeleted(0);
-        
-        //FIXME #### 2BE REMOVED
-        occ.setUnitIdDb("docasna unitIdDb");
-        occ.setUnitValue("docasna unit value");
-        //####        
-        
+                
         return occ;
     }//prepareNewOccurrence
 
-    /** prepares the original occurrence record for the original taxon for update 
-     * modifies the AddEdit's occurrence o. Can insert a new habitat into the database if updateAllPlants is false.
-     * updates the existing habitat if updateAllPlants is true
+    /** Prepares the original occurrence record for the original taxon for update.
+     * Modifies the AddEdit's occurrence o. Can insert a new habitat into the database if updateAllPlants is false.
      *
+     * @param updateAllPlants updates the existing habitat if true, otherwise creates a new habitat.
      */
     private void prepareOccurrenceUpdate(boolean updateAllPlants) throws DBLayerException, RemoteException {
         Habitat h;
@@ -896,7 +979,13 @@
                 
         return occTmp;
     }
-        
+    
+    /** Determines whether the original taxon from the occurrence that the user began to edit
+     * survived the editation - e.g. whether it has or hasn't been removed.
+     *
+     * @return true if the taxon survived
+     * @return false if it was removed by the user
+     */
     private boolean originalTaxonSurvived() {
         for (int t = 0; t < taxonList.size(); t++) {
             if (taxonOriginal.equals(taxonList.get(t))) {
@@ -906,6 +995,13 @@
         return false;
     }
     
+    /** The big method handling the process of saving changes the user made to the occurrence.
+     *
+     * Works in two modes - add and edit mode. Determines the mode according to the inner variable editMode
+     * the value of which is passed to this object during it's construction.
+     *
+     * @param updateAllPlants says whether to create a new habitat if the user made a change to a habitat that is used also by other occurrences.
+     */
     public void storeRecord(boolean updateAllPlants) throws DBLayerException, RemoteException {
         boolean newOccurrenceInserted = false;
         DBLayerUtils dlu = new DBLayerUtils(database);
@@ -948,7 +1044,7 @@
                         originalAuthors.clear();//user
                     }//original taxon didn't survive
                     
-                    /* originalni taxon prezil, ale byl ubran autor
+                    /* original taxon survived but an author was removed
                      *
                      */
                     
@@ -999,7 +1095,7 @@
                      */
                     
                     //K++ A?
-                    //pro kazdou novou kytku vytvorit Occurrence a k nemu pro kazdeho autora vytvorit AuthorOccurrence
+                    //create a new Occurrence for each new flower and also create new AuthorOccurrences
                     for (int j = 0; j < taxonList.size(); j++) {
                         if (taxonOriginal.equals(taxonList.get(j)))
                             continue; //skip the original taxon, it's been already taken care of 
@@ -1032,8 +1128,8 @@
                     
                     
                     //A++ K-orig
-                    //pro puvodni kytku updatnout puvodni occurrence (uz jsme udelali) a author occurrence (neni potreba) 
-                    //a pro nove autory pro ni vytvorit author occurrence
+                    //for the original taxon update the original taxon (that has already been done) and the author occurrence ( not needed)
+                    //and for new authors create a new author occurrence 
                     if (originalTaxonSurvived)
                         for (int k = 0; k < authorList.size(); k++) {
                             Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
@@ -1082,7 +1178,7 @@
                     boolean ok = database.beginTransaction();
                     if (!ok) {
                         logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
-                        throw new DBLayerException("Can't create transaction. Another already running.");
+                        throw new DBLayerException(L10n.getString("Error.TransactionRaceConditions"),DBLayerException.ERROR_TRANSACTION);
                     }
                     
                     logger.info("Creating a shared habitat");
@@ -1122,9 +1218,7 @@
                 }//add mode
         } catch (DBLayerException ex) {
             database.rollbackTransaction();
-            DBLayerException dbex = new DBLayerException("Add/Edit was rolled back. Some database problem occurred during processing: "+ex);
-            dbex.setStackTrace(ex.getStackTrace());
-            throw dbex;
+            throw ex;
         }        
         
         checkAndPropagateChanges();
@@ -1157,7 +1251,7 @@
             i++;
             
         if (i > 0) { //there's been some change we must report
-            System.out.println("REPORTING CHANGE!");
+            logger.debug("REPORTING CHANGE!");
             PlantloreConstants.Table[] changedTables = new PlantloreConstants.Table[i];
             if (isCountryNew) {
                 i--;
@@ -1299,12 +1393,20 @@
         return new Pair<Boolean,String>(true,"");
     }
     
+    /** Loads all occurrences that share the currently edited habitat.
+     *
+     * Loads the occurrences into the habitatSharingOccurrences variable.
+     */
     private void loadHabitatSharingOccurrences() throws DBLayerException, RemoteException {
         Habitat h = o.getHabitat();
         SelectQuery sq = database.createQuery(Occurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.HABITAT,null,h,null);
         int resultid = database.executeQuery(sq);
         int resultCount = database.getNumRows(resultid);
+        if (resultCount <= 0) {
+            logger.error("AddEdit: some problem occurred a habitat seems not to have any occurrence, although it's perhaps being edited..!");
+            return;
+        }
         habitatSharingOccurrences = new Occurrence[resultCount];
 
         Object[] results = database.more(resultid, 0, resultCount-1);
@@ -1318,7 +1420,8 @@
         database.closeQuery(sq);
     }
     
-    /** returns all occurrences sharing the habitat - that means including the current working occurrence
+    /** Returns all occurrences sharing the habitat - that means including the current working occurrence.
+     * Loads the occurences using the {@link loadHabitatSharingOccurrences()} method.
      */
     public  Occurrence[] getHabitatSharingOccurrences() throws DBLayerException, RemoteException {
         //sdili je? mozna s kym
@@ -1370,11 +1473,15 @@
         return authorResults;
     }
     
+    /** Clears the authorList and resultRevision variables. */
     public void clearAuthors() {
         authorList = new ArrayList<Pair<Pair<String,Integer>,String>>();
         resultRevision = new ArrayList<String>();        
     }
     
+    /** Adds a new space for an author. Adds a new Pair into the authorList variable and a null to the resultRevision. 
+     * Notifies observers.
+     */
     public void addAuthorRow() {
         authorList.add(new Pair<Pair<String,Integer>,String>(new Pair<String,Integer>("",0),""));
         resultRevision.add(null);
@@ -1383,7 +1490,14 @@
         notifyObservers(new Pair<String,Integer>("addAuthorRow",-1));
     }
     
+    /** Removes the asked author row.
+     * Does nothing if the index is out of bounds.
+     */
     public void removeAuthorRow(int i) {
+        if (i < 0 || i > authorList.size()) {
+            logger.error("AddEdit.removeAuthorRow(): "+i+" is out of bounds of the authorList array! Doing nothing. ");
+            return;
+        }
         authorList.remove(i);
         resultRevision.remove(i);
         logger.info("AddEdit: Removing author row #"+i);
@@ -1391,6 +1505,9 @@
         notifyObservers(new Pair<String,Integer>("removeAuthorRow",i));        
     }
     
+    /** Auhtor setter.
+     *
+     */
     public void setAuthor(int i, Pair<String,Integer> author) {
         if (i >= authorList.size()) {
             logger.error("AddEdit: trying to add an author to a non-existent row!");
@@ -1400,6 +1517,7 @@
         logger.debug("Author name in row "+i+" set to "+author);
     }
     
+    /** Author role setter. */
     public void setAuthorRole(int i, String role) {
         if (i >= authorList.size()) {
             logger.error("AddEdit: trying to add an author to a non-existent row!");
@@ -1409,6 +1527,7 @@
         logger.debug("Author role in row "+i+" set to "+role);
     }
     
+    /** Author occurrence note setter. */
     public void setResultRevision(int i, String revision) {
         if (revision != null) {
             resultRevision.set(i, revision);
@@ -1416,10 +1535,14 @@
         }
     }
     
+    /** Author occurrence note getter. */
     public String getResultRevision(int i) {
         return resultRevision.get(i);
     }
 
+    /** Taxons setter. Used by the dialog form to offer options to the user. 
+     * Removes duplicates if some contained in the list.
+     */
     public void setTaxons(ArrayList taxonList) {
         //remove duplicities
         for (int i=0 ; i < taxonList.size() ; i++) {
@@ -1434,125 +1557,151 @@
         }
     }
 
+    /** Plants getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getPlants() {
         return plants;
     }
 
+    /** Plants setter. Notifies observers. */
     public void setPlants(Pair<String, Integer>[] plants) {
         logger.debug(""+(plants == null ? 0 : plants.length)+" plants set.");
         this.plants = plants;
         setChanged(); notifyObservers("PLANTS_CHANGED");
     }
 
+    /** Authors getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getAuthors() {
         return authors;
     }
 
+    /** Authors setter. Notifies observers. */
     public void setAuthors(Pair<String, Integer>[] authors) {
         logger.debug(""+(authors==null?0:authors.length)+" authors set.");
         this.authors = authors;
         setChanged(); notifyObservers("AUTHORS_CHANGED");
     }
 
+    /** Author roles getter. Used by the dialog form to offer options to the user. */
     public String[] getAuthorRoles() {
         return authorRoles;
     }
 
+    /** Author roles setter. */
     public void setAuthorRoles(String[] authorRoles) {
         logger.debug(""+(authorRoles==null? 0 : authorRoles.length)+" author roles set.");
         this.authorRoles = authorRoles;
         setChanged(); notifyObservers("AUTHORROLES_CHANGED");
     }
 
+    /** Villages setter. */
     public Pair<String, Integer>[] getVillages() {
         return villages;
     }
 
+    /** Villages getter. Used by the dialog form to offer options to the user. */
     public void setVillages(Pair<String, Integer>[] villages) {
         logger.debug(""+(villages == null? 0: villages.length)+" villages set.");
         this.villages = villages;
         setChanged(); notifyObservers("VILLAGES_CHANGED");
     }
 
+    /** Territories getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getTerritories() {
         return territories;
     }
 
+    /** Territories setter. Used by the dialog form to offer options to the user. */
     public void setTerritories(Pair<String, Integer>[] territories) {
         logger.debug(""+(territories==null ? 0 : territories.length)+" territories set.");
         this.territories = territories;
         setChanged(); notifyObservers("TERRITORIES_CHANGED");
     }
 
+    /** Phytochorion names getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getPhytNames() {
         return phytNames;
     }
 
+    /** Phytochorion names setter. Used by the dialog form to offer options to the user. */
     public void setPhytNames(Pair<String, Integer>[] phytNames) {
         logger.debug(""+(phytNames == null ? 0 : phytNames.length)+" phytochorion names set.");
         this.phytNames = phytNames;
         setChanged(); notifyObservers("PHYTNAMES_CHANGED");
     }
 
+    /** Phytochorion codes getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getPhytCodes() {
         return phytCodes;
     }
 
+    /** Phytochorion codes setter. Used by the dialog form to offer options to the user. */
     public void setPhytCodes(Pair<String, Integer>[] phytCodes) {
         logger.debug(""+(phytCodes == null ? 0 : phytCodes.length)+" phytochorion codes set.");
         this.phytCodes = phytCodes;
         setChanged(); notifyObservers("PHYTCODES_CHANGED");
     }
 
+    /** Countries getter. Used by the dialog form to offer options to the user. */
     public String[] getCountries() {
         return countries;
     }
 
+    /** Countries setter. Used by the dialog form to offer options to the user. */
     public void setCountries(String[] countries) {
         logger.debug(""+(countries == null ? 0 : countries.length)+" countries set.");
         this.countries = countries;
         setChanged(); notifyObservers("COUNTRIES_CHANGED");
     }
 
+    /** Sources getter. Used by the dialog form to offer options to the user. */
     public String[] getSources() {
         return sources;
     }
 
+    /** Sources setter. Used by the dialog form to offer options to the user. */
     public void setSources(String[] sources) {
         logger.debug(""+(sources == null ? 0 : sources.length)+" sources set.");
         this.sources = sources;
         setChanged(); notifyObservers("SOURCES_CHANGED");
     }
 
+    /** Publications getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getPublications() {
         return publications;
     }
 
+    /** Publications setter. Used by the dialog form to offer options to the user. */
     public void setPublications(Pair<String, Integer>[] publications) {
         logger.debug(""+(publications == null ? 0 : publications.length)+" publications set.");
         this.publications = publications;
         setChanged(); notifyObservers("PUBLICATIONS_CHANGED");
     }
 
+    /** Projects getter. Used by the dialog form to offer options to the user. */
     public Pair<String, Integer>[] getProjects() {
         return projects;
     }
 
+    /** Projects setter. Used by the dialog form to offer options to the user. */
     public void setProjects(Pair<String, Integer>[] projects) {
         logger.debug(""+(projects == null ? 0 : projects.length)+" projects set.");
         this.projects = projects;
         setChanged(); notifyObservers("PROJECTS_CHANGED");
     }
 
-    //for add mode
-    //we need to clear, create default values for all values that can be null
-    //the not null values are forced by calling checkData before store()
+    /** Clears all variables storing values of the actual record currently held by the model.
+     * we need to clear, create default values for all values that can be null
+     * the not null values are forced by calling checkData before store()
+     */
     public void clear() {
         logger.debug("Clearing add model");
         clearLocation();
         clearOccurrence();
     }
     
+    /** Clears the variables holding information about the location of the occurrence.
+     * Notifies observers. Sets coordinate system to {@link WGS84}.
+     */
     public void clearLocation() {
         logger.debug("Clearing Location part of add model");
         
@@ -1575,6 +1724,9 @@
         notifyObservers("CLEAR_LOCATION");        
     }
  
+    /** Clears the variables holding information about the occurrence of the occurrence.
+     * Notifies observers. Sets the date to today's date.
+     */
     public void clearOccurrence() {
         logger.debug("Clearing Occurrence part of add model");
         
@@ -1595,10 +1747,7 @@
         notifyObservers("CLEAR_OCCURRENCE");
     }
 
-    public void setPreloadAuthorsEnabled(boolean preloadAuthors) {
-        this.preloadAuthors = preloadAuthors;
-    }
-    
+    /** Returns the model of this dialog's occurrence table model. */
     public OccurrenceTableModel getOccurrenceTableModel() {
         return occurrenceTableModel;
     }

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-01 21:11:41 UTC (rev 619)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
@@ -703,13 +703,6 @@
         }
     }
     
-    class PreloadCheckBox implements ActionListener {
-        public void actionPerformed(ActionEvent e) {
-            JCheckBox cb = (JCheckBox) e.getSource();
-            model.setPreloadAuthorsEnabled(cb.isSelected());
-        }        
-    }
-    
     /**
      *
      */

Modified: trunk/src/net/sf/plantlore/l10n/L10n.java
===================================================================
--- trunk/src/net/sf/plantlore/l10n/L10n.java	2006-09-01 21:11:41 UTC (rev 619)
+++ trunk/src/net/sf/plantlore/l10n/L10n.java	2006-09-01 22:12:38 UTC (rev 620)
@@ -151,10 +151,17 @@
         }
     }
     
+    /** Returns current locale.
+     * @return current locale.
+     */
     public static Locale getCurrentLocale() {
         return (Locale) currentLocale.clone();
     }
     
+    /** Returns string representing current locale.
+     *
+     * @return String denoting the current locale.
+     */
     public static String getLanguageLocale() {
     	return languageLocale;
     }



From fraktalek at gmx.net  Sat Sep  2 00:32:16 2006
From: fraktalek at gmx.net (fraktalek)
Date: Sat, 02 Sep 2006 00:32:16 +0200
Subject: [Plantlore-dev] How-to: Omezeni delky vstupu uzivatele
Message-ID: <1157149937.2690.24.camel@kryton>

V edit fieldech dialgu by bylo vhodne omezovat delku textu, ktery
uzivatel muze zadat, aby to pak nekde dal nehazelo vyjimky, diky
omezenim v databazi.

Hibernate bohuzel neumoznuje zjistit velikost daneho sloupku, takze je
potreba si rucne ty velikosti dopsat do holder objektu.

Ja to zatim udelal tak, ze jsem v danem potomkovi Recordu vytvoril
statickou promennou columnSizes typu Hashtable<String, Integer> a do ni
ulozil dvojice sloupek,velikost sloupku. Tj. pro Habitat to je:

    private static Hashtable<String, Integer> columnSizes;
    static {
        columnSizes = new Hashtable<String,Integer>();
        columnSizes.put(QUADRANT,10);
        columnSizes.put(DESCRIPTION,255);
        columnSizes.put(COUNTRY,30);
        columnSizes.put(ALTITUDE,6);
        columnSizes.put(LATITUDE,8);
        columnSizes.put(LONGITUDE,8);
        columnSizes.put(NOTE,4096);        
    }

Pak uz jen staci dopsat metodu getColumnSize:
    public static int getColumnSize(String columnConst) {
        return columnSizes.get(columnConst);
    }

================
Pouziti filteru
================
Pro korektni omezeni vstupu je potreba u textovych komponent
implementovat DocumentLister. Korektnim zpusobem myslim uplny zpusob,
tj. takovy, ktery omezi velikost zadaneho textu at uz je ten text vlozen
jakkoliv - psanim, vlozenim ze schranky, pretazenim...

My mame filter implementovany jako:
net.sf.plantlore.common.DocumentSizeFilter().

Pouziva se tak, ze se nastavi jako filter dokumentu dane komponenty.
Tzn. vetsinou je potreba z te komponenty vytahnout dokument, pretypovat
ho na PlainDocument, protoze az ten ma metodu setDocumentFilter() a
pomoci ni filter nastavit za pouziti konstant z holder objektu:

 pd = (PlainDocument) quadrantTextField.getDocument();
        pd.setDocumentFilter(new
DocumentSizeFilter(Habitat.getColumnSize(Habitat.QUADRANT)));
        
Je potreba si pri pretypovani dat pozor na to, ze nektere komponenty
mohou obsahovat StyledDocument. To jsou komponenty obsahujici a
zobrazujici rich text - tj. treba renderuji html - tucny text, kurzivu,
ruzne barvy a velikosti pisma, atp. Pokud to ve sve komponente
nevyuzivate, tak vase komponenta bude pravdepodobne obsahovat
PlainDocument.

Vyjimka se tyka AutoComboBoxu, ten umi velikost zadaneho textu omezovat
sam:

((AutoComboBoxNG3)phytCountryCombo).setCapacity(Habitat.getColumnSize(Habitat.COUNTRY));





From fraktalek at gmx.net  Sat Sep  2 00:35:23 2006
From: fraktalek at gmx.net (fraktalek)
Date: Sat, 02 Sep 2006 00:35:23 +0200
Subject: [Plantlore-dev] mensi problem s vytuhavanim
In-Reply-To: <1157148704.2690.10.camel@kryton>
References: <1157148704.2690.10.camel@kryton>
Message-ID: <1157150124.2690.27.camel@kryton>

Psal jsem vytuhava, ale myslel jsem tim, ze progress bar historie si
beha kolem dokola a nic se nedeje. Plantlore se prekresluje spravne.


fraktalek p??e v So 02. 09. 2006 v 00:11 +0200:
> Spustit plantlore, prihlasit se k databazi.
> Kliknout na nejaky nalez, kliknout na Upravit.
> Okamzite, jeste nez se staci objevit Edit dialog, kliknout na Historii.
> Naskoci progressbar od Historie a Plantlore vytuhne.
> Bud rovnou, nebo kdyz se pak zrusi edit dialog a da se historie tak pak
> treba.
> 
> 
> Nenacitam data v editu v tasku, zitra to predelam.
> Mozna by ale stalo za zvazeni, jestli nevypinat akce na dobu, kdy se
> startuje nebo uz bezi jina akce. Vetsinou, aspon kdyz uzivatel klika
> mysi, se to vyresi modalitou dialogu. Obcas ale jde akce volat
> klavesovou zkratkou. V tom pripade by tam treba taky mohl nastat
> neocekavany zmatek. Pokud by napr. nekdo dal editovat nalez - mel
> zobrazeny edit dialog, ale nejakym zpusobem vyvolal akci delete v
> overview (podle me by to jit nemelo, pisu to sem spis na zamyslenou).
> 
> Jakub
> 
> 
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev
> 



From lada at mail.berlios.de  Sat Sep  2 00:44:52 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 00:44:52 +0200
Subject: [Plantlore-dev] r621 - in trunk/src/net/sf/plantlore/client: .
	history metadata user
Message-ID: <200609012244.k81Miq3m010786@sheep.berlios.de>

Author: lada
Date: 2006-09-02 00:44:46 +0200 (Sat, 02 Sep 2006)
New Revision: 621

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.form
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
   trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
Log:
Exception are catch correctly now - use DefaultExceptionHandler.

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -1726,10 +1726,10 @@
 					tableImportModel.setDBLayer( dblayer );
 				logger.debug(" # record history ");
 				if (historyModel != null ) 
-					historyModel.setDBLayer( dblayer );
+					historyModel.restartQuery(History.HISTORY_RECORD);
 				logger.debug(" # complete history ");
 				if (wholeHistoryModel != null ) 
-					wholeHistoryModel.setDBLayer( dblayer );
+					wholeHistoryModel.restartQuery(History.HISTORY_WHOLE);
 				logger.debug(" # user manager ");
 				if (userManagerModel != null )
 					userManagerModel.setDBLayer( dblayer );

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -19,6 +19,7 @@
 import java.util.HashSet;
 import java.util.Hashtable;
 import java.util.Observable;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.record.Author;
@@ -58,8 +59,8 @@
     private SelectQuery query = null;
     /** Exception with details about an error */
     private String error = null;
-    /** Remote exception (network communication failed)*/
-    private RemoteException remoteEx;
+    /** Exception (network communication failed)*/
+    private Exception exception;
     /** True if MyTask finished successful*/
     private boolean  finishedTask = false;
     /** Constant with default number of rows to display */
@@ -129,6 +130,10 @@
     private Hashtable<String, Integer> publicationHash;
     private Hashtable<String, Enum> editTypeHash;
     
+    /** Constants used for identification type of history */
+    public static final int HISTORY_RECORD = 1;
+    public static final int HISTORY_WHOLE = 2;
+    
     /** Constants used for description of errors */
     public static final String ERROR_SEARCH_RECORD = "Error.HistoryRecordSearchFailed";
     public static final String ERROR_SEARCH_DATA = "Error.HistoryDataSearchFailed";
@@ -176,22 +181,22 @@
     public Task initialize(int idObj) {
     	dataId = idObj;
     	final Task task = new Task() {    		    		
-    		public Object task() throws Exception {
-    			
-    			try {
-		           //Save basic data
-		           initOccHistoryData(dataId);
-			       //Searching for information about data editing concerned with specific habitat
-			       searchEditHistory(getData());	       
-			       //Process results of a search "edit" query 
-			       processResult(1,DEFAULT_DISPLAY_ROWS);			       		      
-    			}catch (Exception e) {
-    				logger.error("Initialize of Record History failed. Exception caught in History. Details: "+e.getMessage());
-    				throw e;
-    			}        	
-    			setInfoFinishedTask(true);
-    			return null;
-    		}
+            public Object task() throws Exception {
+
+                    try {
+                          //Save basic data
+                           initOccHistoryData(dataId);
+                           //Searching for information about data editing concerned with specific habitat
+                           searchEditHistory(getData());	       
+                           //Process results of a search "edit" query 
+                           processResult(1,DEFAULT_DISPLAY_ROWS);			       		      
+                    }catch (Exception e) {
+                            logger.error("Initialize of Record History failed. Exception caught in History. Details: "+e.getMessage());
+                            throw e;
+                    }        	
+                    setInfoFinishedTask(true);
+                    return null;
+                    }
 	    };
 	    return task;
     }
@@ -209,8 +214,8 @@
     		       //Process results 
     		       processResult(1, DEFAULT_DISPLAY_ROWS);
     		   } catch (Exception e) {
-    			   logger.error("Initialize of Whole History failed. caught in History. Details: "+e.getMessage());
-   				   throw e;
+    			   logger.error("Initialize of Whole History failed. Exception caught in History. Details: "+e.getMessage());
+                           throw e;
     		   }    
     		   setInfoFinishedTask(true);
     		   return null;
@@ -225,33 +230,26 @@
      *  @throws DBLayerException in case search failed
      *  @throws RemoteException in case network communication failed
      */   
-    public void initOccHistoryData(int idOcc) throws RemoteException, DBLayerException {
+    public void initOccHistoryData(int idOcc) throws Exception {
     	SelectQuery query = null;
         int resultIdRecord = 0;
         Object[] object = null;      
         
         try {    	  
- 		    query = database.createQuery(Occurrence.class);
+ 	    query = database.createQuery(Occurrence.class);
        	    query.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.ID, null, idOcc, null);
        	    query.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.DELETED, null, 0, null);    	                   
             resultIdRecord = database.executeQuery(query);
             object = database.next(resultIdRecord);                    
             database.closeQuery(query);            
-        } catch(RemoteException e) {
-        	    logger.error("Remote exception caught in History. Details: "+e.getMessage());       	            	     
-        	     RemoteException remex = new RemoteException(e.getMessage());
-                 remex.setStackTrace(e.getStackTrace());
-                 throw remex; 		           		           	   
-        } catch(DBLayerException e) {
-     	    logger.error("Search selected occurrence failed. DBLayer exception caught in History. Details: "+e.getMessage());       	                                                                
-             DBLayerException dbex = new DBLayerException(ERROR_SEARCH_RECORD + e.getMessage());
-             dbex.setStackTrace(e.getStackTrace());
-             throw dbex; 		           
-        }                                          
+        } catch(Exception ex) {            
+     	     logger.error("Search selected occurrence failed. Exception caught in History. Details: "+ex.getMessage());       	                                                                             
+             throw ex; 		           
+        }                  
+        
         if (object == null) {
      	   logger.error("tOccurrence doesn't contain required data");  
-     	   DBLayerException dbex = new DBLayerException(ERROR_SEARCH_RECORD + "tOccurrence doesn't contain required data");                      
-     	   throw dbex; 		            
+     	   throw  new DBLayerException(ERROR_SEARCH_RECORD + "tOccurrence doesn't contain required data");                           	   		            
         } else {
      	   
      	   Occurrence occurrence = (Occurrence)object[0];    	   
@@ -259,15 +257,15 @@
      	        	 
      	   //Check rights
      	   if(! hasRights(occurrence.getCreatedWho().getId())) {
-     		   DBLayerException dbex = new DBLayerException("Bezparametricky konstruktor byl smazan!");
+     		   DBLayerException dbex = new DBLayerException("");
      		   dbex.setError(DBLayerException.ERROR_RIGHTS, ERROR_NO_RIGHTS);
         	   throw dbex; 		            
      	   }   
-     	   if (isError()) {
-     		  RemoteException remoteEx = new RemoteException(getRemoteEx().getMessage());
+     	   if (isError()) {    
+          Exception ex = getException(); 		  
      		  setError(null);
-     		  setRemoteEx(null);
-     		  throw remoteEx;
+     		  setException(null);
+     		  throw ex;
      	   }
      	   
  	       //Save basic information about specific occurrence 
@@ -287,7 +285,7 @@
      * @throws DBLayerException in case search failed
      * @throws RemoteException in case network communication failed
      */     
-    public void searchEditHistory(Object data) throws RemoteException, DBLayerException
+    public void searchEditHistory(Object data) throws Exception
     {    
     	//Cleare historyDataList
     	historyDataList.clear(); 
@@ -312,16 +310,9 @@
 	        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.operation", null, HistoryChange.HISTORYCHANGE_EDIT, null);
 	        query.addOrder(PlantloreConstants.DIRECT_DESC, "hc.when");
 	        resultIdEdit = database.executeQuery(query); 
-		} catch (RemoteException e) {
-			logger.error("Remote exception caught in History (searchEditHistory). Details: "+e.getMessage());			
-			RemoteException remex = new RemoteException(e.getMessage());
-            remex.setStackTrace(e.getStackTrace());
-            throw remex; 		
-		} catch (DBLayerException e) {
-			logger.error("DBLayer exception caught in History (searchEditHistory). Details: "+e.getMessage());
-			DBLayerException dbex = new DBLayerException(ERROR_SEARCH_DATA + e.getMessage());
-            dbex.setStackTrace(e.getStackTrace());
-            throw dbex; 	            
+		} catch (Exception ex) {
+		     logger.error("Exception caught in History.searchEditHistory(). Details: "+ex.getMessage());						
+                     throw ex; 	            
 		}                
 		setResultId(resultIdEdit);   		
     }
@@ -333,7 +324,7 @@
      * @throws DBLayerException in case search failed
      *  @throws RemoteException in case network communication failed
      */
-    public void searchWholeHistoryData() throws RemoteException, DBLayerException {
+    public void searchWholeHistoryData() throws Exception {
         
     	// Cleare historyDataList
     	historyDataList.clear();
@@ -351,16 +342,9 @@
 			query.createAlias("historyChange", "hc");			
 			query.addOrder(PlantloreConstants.DIRECT_DESC, "hc.when");
 			resultIdWHistory = database.executeQuery(query);
-		} catch (RemoteException e) {
-			logger.error("Remote exception caught in History (searchWholeHistoryData). Details: "+e.getMessage());
-			RemoteException remex = new RemoteException(e.getMessage());
-            remex.setStackTrace(e.getStackTrace());
-            throw remex; 		
-		} catch (DBLayerException e) {
-			logger.error("DBLayer exception caught in History (searchWholeHistoryData). Details: "+e.getMessage());			
-			DBLayerException dbex = new DBLayerException(ERROR_SEARCH_DATA + e.getMessage());
-            dbex.setStackTrace(e.getStackTrace());
-            throw dbex; 	            
+		} catch (Exception ex) {
+			logger.error("Exception caught in History.searchWholeHistoryData(). Details: "+ex.getMessage());			
+                        throw ex; 	            
 	    }
 		setResultId(resultIdWHistory);                 
     }
@@ -370,7 +354,7 @@
      * @param from number of the first row to show in table. Number of the first row to retraieve is 1.
      * @param count number of rows to retrieve 
      */
-    public void processResult(int from, int count) throws RemoteException, DBLayerException{
+    public void processResult(int from, int count) throws Exception{
         
         if (this.resultId != 0) {
             int currentRow = getResultRows();
@@ -394,21 +378,14 @@
             	Object[] objectHistory;
              	try {
              		objectHistory = database.more(this.resultId, 0, to-1);  
-             	} catch(RemoteException e) {
-             		logger.error("Remote exception caught in History (processResult). Details: "+e.getMessage());
-             		RemoteException remex = new RemoteException(e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		                                                                                 
-                } catch (DBLayerException e) {                  
-                    logger.error("Processing search results failed: " + e.getMessage());                       
-                    DBLayerException dbex = new DBLayerException(ERROR_PROCESS + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 
+             	} catch(Exception ex) {             		            
+                    logger.error("History - Processing search results failed: " + ex.getMessage());                                           
+                    throw ex; 
                 }  
                 if (objectHistory == null) {
                 	logger.error("tHistoryChange doesn`t contain required data");
                 	DBLayerException dbex = new DBLayerException(ERROR_PROCESS + "tHistoryChange doesn`t contain required data");                   
-                    throw dbex; 
+                        throw dbex; 
                 }
                 int countResult = objectHistory.length;  
                 logger.debug("Results retrieved. Count: "+ countResult);                
@@ -762,6 +739,7 @@
                 } catch (ParseException e) {
                         logger.error("Parse time failed. "+ e);
                         setError(ERROR_PARSE_DATE);
+                        setException(e);
                         return;
                 }
                 occ.setTimeCollected(time);
@@ -1404,21 +1382,18 @@
             resultIdObject = database.executeQuery(query);
             object = database.next(resultIdObject);
             database.closeQuery(query);
-        } catch(RemoteException e) {
-        	logger.error("Remote exception caught in History. Details: "+e.getMessage());
-       	    setError(ERROR_REMOTE_EXCEPTION);
-       	    setRemoteEx(e);	    
+        } catch(Exception e) {
+            logger.error("Search selected " + typeObject  +" failed. DBLayer exception caught in History. Details: "+e.getMessage());       	                                                   
+       	    setError(ERROR_SEARCH_OBJECT); 
+       	    setException(e);	    
        	    return null;
-        } catch(DBLayerException e) {
-        	logger.error("Search selected " + typeObject  +" failed. DBLayer exception caught in History. Details: "+e.getMessage());       	                                                   
-            setError(ERROR_SEARCH_OBJECT); 
-            return null;
-        }
-              
+        } 
+        
 	   if (object == null) {
-		   logger.error("t"+typeObject+ " doesn't contain required data");  
-		   setError(ERROR_SEARCH_OBJECT);		   
-		   return null;           
+               logger.error("t"+typeObject+ " doesn't contain required data");  
+               setError(ERROR_SEARCH_OBJECT);		   
+               setException(new DBLayerException(ERROR_SEARCH_OBJECT + " t"+typeObject+ " doesn't contain required data"));
+               return null;           
 	   } 	 
        return object; 	       	          	              	        
     }
@@ -1447,18 +1422,16 @@
             if (to > 0)
                 objects = database.more(resultIdAuthors, 0, to-1);
             database.closeQuery(query);
-        } catch(RemoteException e) {
-        	logger.error("Remote exception caught in History. Details: "+e.getMessage());
-       	    setError(ERROR_REMOTE_EXCEPTION);
-       	    setRemoteEx(e);       	    
-        } catch(DBLayerException e) {
-        	logger.error("Search authors failed. DBLayer exception caught in History. Details: "+e.getMessage());       	                                                   
-            setError(ERROR_SEARCH_AUTHOR);            
-        }     
+        } catch(Exception ex) {
+        	logger.error("Search authors failed. DBLayer exception caught in History. Details: "+ex.getMessage());       	                                                   
+                setError(ERROR_SEARCH_AUTHOR);
+                setException(ex);       	    
+        }  
           
         if (objects == null) {
         	logger.error("tAuthors doesn't contain required data");  
- 		    setError(ERROR_SEARCH_AUTHOR);		    		             
+ 		    setError(ERROR_SEARCH_AUTHOR);
+                    setException(new DBLayerException(ERROR_SEARCH_AUTHOR));
         }
         
        return objects;
@@ -1533,7 +1506,7 @@
 		        } catch (Exception e) {
 		        	logger.error("Process UNDO failed. Exception caught in History. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                    
-                    throw e; 		           		       	    
+                                 throw e; 		           		       	    
 		        } 
 		        database.commitTransaction();	    	
 		    	//Create array of editing object and call notifyObservers
@@ -1584,23 +1557,23 @@
     		historyChange = historyRecord.getHistoryChange(); 
     		
 	    	try {
-				database.executeDeleteHistory(historyRecord);
-				logger.debug("Deleting historyRecord successfully. Number of result: "+i);
-			} catch (Exception e) {								
-				logger.error("Process UNDO failed. Deleting historyRecord failed. Exception caught in History. Details: "+e.getMessage());	        	                
-                throw e; 		           
-			} 						
-			try {
-				int countResult = getRelationshipHistoryChange(historyChange.getId());				
-				if (countResult == 0) {	
-					database.executeDeleteHistory(historyChange);
-					logger.debug("Deleting historyChange successfully.");
-				} else {
-					logger.debug("Exist other record in the table tHistory, whitch has the same value of attribute cChangeId.");
-				}
-			} catch (Exception e) {
-				logger.error("Process UNDO failed. Deleting historyChange failed. Exception caught in History. Details: "+e.getMessage());	        		                
-                throw e; 		           
+                        database.executeDeleteHistory(historyRecord);
+                        logger.debug("Deleting historyRecord successfully. Number of result: "+i);
+                } catch (Exception e) {								
+                        logger.error("Process UNDO failed. Deleting historyRecord failed. Exception caught in History. Details: "+e.getMessage());	        	                
+                        throw e; 		           
+		} 						
+                try {
+                        int countResult = getRelationshipHistoryChange(historyChange.getId());				
+                        if (countResult == 0) {	
+                                database.executeDeleteHistory(historyChange);
+                                logger.debug("Deleting historyChange successfully.");
+                        } else {
+                                logger.debug("Exist other record in the table tHistory, whitch has the same value of attribute cChangeId.");
+                        }
+                } catch (Exception e) {
+                        logger.error("Process UNDO failed. Deleting historyChange failed. Exception caught in History. Details: "+e.getMessage());	        		                
+                        throw e; 		           
 			} 		 
     	}    	
 		//Clear lists 
@@ -1628,10 +1601,10 @@
                 database.closeQuery(query);
         } catch(RemoteException e) {
         	logger.error("Searching historyChange failed.Remote exception caught in History. Details: "+e.getMessage());
-       	    throw e;       	  
+       	        throw e;       	  
         } catch(DBLayerException e) {
         	logger.error("Searching historyChange failed. DBLayer exception caught in History. Details: "+e.getMessage());       	                                                   
-            throw e;       	  
+                throw e;       	  
         }        
        	return countResult;
     }
@@ -1805,7 +1778,7 @@
         } catch (Exception e) {
         	logger.error("Process cleare database failed. Exception caught in History. Details: "+e.getMessage());
         	database.rollbackTransaction();           
-            throw e; 		                  	    
+                throw e; 		                  	    
         }  
     }
     
@@ -1845,8 +1818,7 @@
 		        } catch (Exception e) {
 		        	logger.error("Process cleare database failed. Exception caught in History. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                   
-                    throw e;                     
-		       	    
+                                throw e;                     		       	    
 		        } 
 		        database.commitTransaction();
 		        setInfoFinishedTask(true);
@@ -1883,10 +1855,9 @@
                 // No rights to work with history of the record
                 return false;
             }
-        } catch (RemoteException e) {
-        	logger.error("GetUserRight() failed. Remote exception caught in History. Details: "+e.getMessage());
-        	setError(ERROR_REMOTE_EXCEPTION);
-        	setRemoteEx(e);
+        } catch (Exception e) {
+        	logger.error("GetUserRight() failed. Exception caught in History. Details: "+e.getMessage());        	
+        	setException(e);
         }   
         return false;
     }
@@ -1899,6 +1870,41 @@
         this.setChanged();
         this.notifyObservers( event );
      }
+    
+        
+    /**
+     * Close query.    
+     */    
+    public void closeQuery() {
+    	if(query != null) try {
+		      database.closeQuery(query);
+		      query = null;
+		} catch(Exception e) {
+			// Never mind.
+		}
+    }
+    
+       /**
+	* Restart select query after recconect to database.
+        * @param typeHistory identifier of history type ( 1 == record history, 2 == whole history)
+	*/
+      public void restartQuery(int typeHistory) {
+                query = null;  
+                /*
+                try {
+                    if (typeHistory == History.HISTORY_RECORD) {                        
+                        searchEditHistory(getData());
+                        processResult(1, DEFAULT_DISPLAY_ROWS);
+                    } else if (typeHistory == History.HISTORY_WHOLE) {
+                        searchWholeHistoryData();
+                        processResult(1, DEFAULT_DISPLAY_ROWS);
+                    }
+                 } catch (DBLayerException ex) {
+                        ex.printStackTrace();
+                 } catch (RemoteException ex) {
+                        ex.printStackTrace();
+                 }    */
+	}
             
      //***************************//
     //****Init Hashtable*********//
@@ -1998,31 +2004,14 @@
         editTypeHash.put("Territory", PlantloreConstants.Table.TERRITORY);
         editTypeHash.put("Phytochorion", PlantloreConstants.Table.PHYTOCHORION);        
     }
-       
-    /**
-     * Close query.    
-     */    
-    public void closeQuery() {
-    	if(query != null) try {
-		      database.closeQuery(query);
-		      query = null;
-		} catch(Exception e) {
-			// Never mind.
-		}
-    }
+   
     
     //****************************//
     //****Get and set metods*****//
     //**************************//
+        
     
     /**
-	 * Set a new DBLayer.
-	 */
-	synchronized public void setDBLayer(DBLayer dblayer) {
-		query = null;                
-	}
-    
-    /**
      *  Set an error flag.
      *  @param msg  message explaining the error which occured
      */
@@ -2051,19 +2040,19 @@
     }  
     
     /**
-     *  Set an remote exception (network communication failed)
-     *  @param ex  RemoteException (network communication failed)
+     *  Set an exception 
+     *  @param ex  exception
      */
-    public void setRemoteEx(RemoteException ex) {
-        this.remoteEx = ex;
+    public void setException(Exception ex) {
+        this.exception = ex;
     }
     
     /**
-     *  Get remote exception (network communication failed)
-     *  @return remote exception (network communication failed)
+     *  Get exception
+     *  @return exception 
      */
-    public RemoteException getRemoteEx() {
-        return this.remoteEx;
+    public Exception getException() {
+        return this.exception;
     }  
     
     /** 

Modified: trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -7,6 +7,7 @@
 
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Task;
@@ -62,7 +63,7 @@
      */
     public void reloadData(int fromRow, int countRow) {
     	try {
-    		model.processResult(fromRow, countRow);        
+    	    model.processResult(fromRow, countRow);        
             view.getTable().setModel(new HistoryTableModel(model));             
             int from = model.getCurrentFirstRow();
             int to = from + view.getTable().getRowCount() - 1;
@@ -83,12 +84,12 @@
            } else {
         	   view.previousButton.setEnabled(false);
            }
-    	} catch (RemoteException e) {
-    		DefaultReconnectDialog.show(view, e);
-    	} catch (DBLayerException e) {
-    		view.showErrorMessage(e.getMessage());
-    	}
-    	           
+    	}catch (Exception ex) {
+           logger.error("Reload data failed. Details:" + ex.getMessage());           
+           ex.printStackTrace();
+           DefaultExceptionHandler.handle(view, ex);           
+           return;
+        }     	           
     }
     
    /**
@@ -100,7 +101,9 @@
        {    	  
     	   // Check whether an error flag is set
            if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get previous page of results
@@ -132,7 +135,9 @@
        {
     	   // Check whether an error flag is set 
            if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get next page of result
@@ -164,7 +169,9 @@
        {   
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }    	   
     	   model.setSelectAll(true);    	  	   
@@ -182,7 +189,9 @@
        {   
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
     	   model.setUnselectedAll(true); 
@@ -199,7 +208,9 @@
        {   
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }    	   
     	   // process selected record
@@ -212,33 +223,31 @@
             	   logger.debug("Button OK was press.");
             	   Task task = model.commitUpdate(model.getResultRows(), true);  
             	   
-            	   new DefaultProgressBar(task, view, true) {		   									
-							@Override
-		   					public void afterStopping() {
-								try {
-								   if (! model.isFinishedTask()) return;
-								   model.setInfoFinishedTask(false);	
-			   					   model.searchEditHistory(model.getData());
-			   					   reloadData(1,model.getDisplayRows());			   	            	          
-			   	                   view.setCountResutl(model.getResultRows());
-								} catch (RemoteException e) {
-									DefaultReconnectDialog.show(view, e);
-						    	} catch (DBLayerException e) {
-						    		view.showErrorMessage(e.getMessage());
-						    	}
-		   	               } 		   					
-		   				};		   					                   	                   
-	                    task.start();     	                   
+            	   new DefaultProgressBar(task, view, true) {                       
+                        @Override
+                        public void afterStopping() {
+                                try {
+                                   if (! model.isFinishedTask()) return;
+                                   model.setInfoFinishedTask(false);	
+                                   model.searchEditHistory(model.getData());
+                                   reloadData(1,model.getDisplayRows());			   	            	          
+                                   view.setCountResutl(model.getResultRows());
+                                }catch (Exception ex) {                                   
+                                   ex.printStackTrace();
+                                   DefaultExceptionHandler.handle(view, ex);                                   
+                                   return;
+                                } 
+                        } 		   					
+                  };		   					                   	                   
+	          task.start();     	                   
                } else {            	  
             	   logger.debug("Button Cancle was press."); 
                }  
-           } else {
-        	   if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
-        		   DefaultReconnectDialog.show(view, model.getRemoteEx());
-        	   } else {
-        		   view.showErrorMessage(model.getError());
-        	   }
-        	   model.setError(null);        	           	  
+           } else {                
+        	Exception ex = model.getException();  
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);                                   
+        	model.setError(null);        	           	  
            }
        }
    }
@@ -251,7 +260,9 @@
        public void actionPerformed(ActionEvent actionEvent) {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Save old value 

Modified: trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -123,8 +123,7 @@
             Date when = ((HistoryRecord)editHistoryDataList.get(i)).getHistoryChange().getWhen();
     	    editHistoryData[ii][1] = DateFormat.getDateTimeInstance(DateFormat.MEDIUM, DateFormat.SHORT,L10n.getCurrentLocale()).format(when); 
     	    editHistoryData[ii][2] = ((HistoryRecord)editHistoryDataList.get(i)).getHistoryChange().getWho().getWholeName();    	   
-    	    editHistoryData[ii][3] = item;
-    	    logger.debug("XXXXXXXXXX: "+ item);
+    	    editHistoryData[ii][3] = item;    	    
     	    editHistoryData[ii][4] = ((HistoryRecord)editHistoryDataList.get(i)).getOldValue();
     	    editHistoryData[ii][5] = ((HistoryRecord)editHistoryDataList.get(i)).getNewValue();
     	    ii++;

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -15,6 +15,7 @@
 
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Task;
@@ -87,11 +88,12 @@
            } else {
         	   view.nextButton.setEnabled(false);
            }
-    	} catch (RemoteException e) {
-    		DefaultReconnectDialog.show(view, e);
-    	} catch (DBLayerException e) {
-    		view.showErrorMessage(e.getMessage());
-    	}    	        	         
+    	 } catch (Exception ex) {
+               logger.error("Reload data failed.");               
+               ex.printStackTrace();
+               DefaultExceptionHandler.handle(view, ex);               
+               return;
+        }         	         
     }
     
    /**
@@ -103,7 +105,9 @@
        {    	  
     	   // Check whether an error flag is set
            if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get previous page of results
@@ -135,7 +139,9 @@
        {
     	   // Check whether an error flag is set 
            if (model.isError()) {
-        	   view.showErrorMessage(model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get next page of result
@@ -164,7 +170,9 @@
        public void actionPerformed(ActionEvent actionEvent) {
     	   // Check whether an error flag is set
     	   if (model.isError() && view.tableHistoryList.getRowCount() > 0) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Save old value 
@@ -205,7 +213,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError() && view.tableHistoryList.getRowCount() > 0) {
-        	   view.showErrorMessage(model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableHistoryList.getSelectedRow() < 0) {    
@@ -226,34 +236,32 @@
 	                   Task task = model.commitUpdate(toResult, false);
 	                   
 	                   new DefaultProgressBar(task, view, true) {		   										
-						    @Override
-		   					public void afterStopping() {
-		   						logger.debug("Load Data");	   
-		   						try {
-		   						   if (! model.isFinishedTask()) return;
-		   						   model.setInfoFinishedTask(false);	
-		   						   model.searchWholeHistoryData();
-		   						   reloadData(1,model.getDisplayRows());
-		   						   view.setCountResult(model.getResultRows());
-		   						} catch (RemoteException e) {
-									DefaultReconnectDialog.show(view, e);
-						    	} catch (DBLayerException e) {
-						    		view.showErrorMessage(e.getMessage());
-						    	}
-		   					}
-		   				};		   					                   	                  
+                                @Override
+                                    public void afterStopping() {
+                                        logger.debug("Load Data");	   
+                                        try {
+                                           if (! model.isFinishedTask()) return;
+                                           model.setInfoFinishedTask(false);	
+                                           model.searchWholeHistoryData();
+                                           reloadData(1,model.getDisplayRows());
+                                           view.setCountResult(model.getResultRows());
+                                        } catch (Exception ex) {                                                                   
+                                           ex.printStackTrace();
+                                           DefaultExceptionHandler.handle(view, ex);                                                                   
+                                           return;
+                                        } 
+                                    }
+                            };		   					                   	                  
 	                    task.start();
 	                   
 	               } else {	                       	                     
 	                       logger.debug("Button Cancle was press.");
 	               } 
                 } else {
-                	if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
-             		   DefaultReconnectDialog.show(view, model.getRemoteEx());
-             	   } else {
-             		   view.showErrorMessage(model.getError());
-             	   }
-             	   model.setError(null); 
+                    Exception ex = model.getException();  
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);                                   
+                    model.setError(null);                        
                 }
             }
          }
@@ -268,7 +276,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError() && view.tableHistoryList.getRowCount() > 0) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }        
            if (view.tableHistoryList.getSelectedRow() < 0) {
@@ -283,13 +293,12 @@
                detailsView.setDetailsMessage(detailsMessage);
                detailsView.setVisible(true);               
            } 
-           if (model.getError() != null) {
-	           if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
-	    		   DefaultReconnectDialog.show(view, model.getRemoteEx());
-	    	   } else {
-	    		   view.showErrorMessage(model.getError());
-	    	   }
-	    	   model.setError(null); 
+           if (!model.isError()) {
+	           Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
+        	   model.setError(null); 
+                   model.setException(null);
            }
        }
     }
@@ -303,7 +312,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError() && view.tableHistoryList.getRowCount() > 0) {
-        	   view.showErrorMessage(model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }     
     	   if (view.tableHistoryList.getRowCount() == 0) {
@@ -312,27 +323,26 @@
     	   }
            int okCancle = view.messageUndo("clearHistory");
            if (okCancle == 0){
-                   //Button OK was press
-                   logger.debug("Button OK was press.");  
-                   // delete records whit contition cdelete > 0
-                   Task task = model.clearDatabase();
-                   
-                   new DefaultProgressBar(task, view, true) {
-                	        @Override
-			   				public void afterStopping() {
-		   						//load data
-                	        	try {
-                	        		model.searchWholeHistoryData();
-                	        		reloadData(1,model.getDisplayRows());
-                	        		view.totalResultValueLabel.setText("0");
-                	        	} catch (RemoteException e) {
-									DefaultReconnectDialog.show(view, e);
-						    	} catch (DBLayerException e) {
-						    		view.showErrorMessage(e.getMessage());
-						    	}		   	               
-		   					}
-		   				};		   					                   	                   
-	                    task.start();	                                                         
+           //Button OK was press
+           logger.debug("Button OK was press.");  
+           // delete records whit contition cdelete > 0
+           Task task = model.clearDatabase();
+
+           new DefaultProgressBar(task, view, true) {
+                @Override
+                public void afterStopping() {
+                //load data
+                try {
+                        model.searchWholeHistoryData();
+                        reloadData(1,model.getDisplayRows());
+                        view.totalResultValueLabel.setText("0");
+                        } catch (Exception ex) {                                                                                    
+                            ex.printStackTrace();
+                            DefaultExceptionHandler.handle(view, ex);                                                                                  		   	               
+                        }
+                }
+           };		   					                   	                   
+           task.start();	                                                         
            }
        }
     }

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -16,6 +16,7 @@
 import net.sf.plantlore.client.history.History;
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.record.Metadata;
 import org.apache.log4j.Logger;
@@ -67,15 +68,13 @@
                 if (view.checkNotNull()) {
                         //Check if new name of project (dataSetTitle) already exist
                 	if (!model.uniqueDatasetTitle(view.dataSetTitleText.getText())){       
-                		if (model.isError()) {
-                			if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
-                		 		   DefaultReconnectDialog.show(view, model.getRemoteEx());
-                		 	   } else {
-                		 		   view.showErrorMessage(model.getError());
-                		 	   }
-                			   //TODO nastavit zde null
-                		 	   model.setError(null); 
-                		 	   return;
+                		if (model.isError()) {                			
+                                        Exception ex = model.getException();
+                                        ex.printStackTrace();
+                                        DefaultExceptionHandler.handle(view, ex);
+                                        model.setError(null);
+                                        model.setException(null);                		 	  
+                		 	return;
                 		}
                 		view.showErrorMessage(MetadataManager.ERROR_TITLE, MetadataManager.ERROR_DATASETTITLE);
                 		return;

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -39,8 +39,8 @@
     private SelectQuery query = null;
     /** Exception with details about an error */
     private String error = null;
-    /** Remote exception (network communication failed)*/
-    private RemoteException remoteEx;
+    /** Exception */
+    private Exception exception;
     /** True if MyTask finished successful*/
     private boolean  finishedTask = false;
     /** Constant with default number of rows to display */
@@ -53,6 +53,8 @@
     private String displayRow;           
     /** Result of the search query */
     private int resultId = 0;
+    /** Number of results for the current SelectQuery */
+    private int resultRows = 0;
     /** List of data (results of a search query) displayed in the table */
     private ArrayList<Metadata> metadataList = new ArrayList<Metadata>();         
     /** Message containing information about changes in metadata*/
@@ -133,40 +135,30 @@
        
     	if (createTask) {
 	    	final Task task = new Task() {    		    		
-	    		public Object task() throws DBLayerException, RemoteException {
+	    		public Object task() throws Exception {
 	  		       int resultIdent;
 	    			try {
 	  		    	    resultIdent = search();
 	  		    	    setResultId(resultIdent);
-		    	   }catch (RemoteException e) {	            
-			            logger.error("Searching metada failed. Remote exception caught in Metadata. Details: "+e.getMessage());			        	
-		                RemoteException remex = new RemoteException(ERROR_SEARCH + e.getMessage());
-		                remex.setStackTrace(e.getStackTrace());
-		                throw remex; 		           
-			        } catch (DBLayerException e) {
-			        	logger.error("Searching metada failed. DBLayer exception caught in Metadata. Details: "+e.getMessage());       	                                                   			        
-		                DBLayerException dbex = new DBLayerException(ERROR_SEARCH + e.getMessage());
-		                dbex.setStackTrace(e.getStackTrace());
-		                throw dbex; 		           
-			        }			
-			        setInfoFinishedTask(true);
-                    return null;			        
-				}
+		    	   }catch (Exception e) {	            
+			        logger.error("Searching metada failed. Exception caught in Metadata. Details: "+e.getMessage());			        			               
+		                throw e; 		           
+                            }			
+                            setInfoFinishedTask(true);
+                            return null;			        
+                            }
 		    };
 		    return task;
     	} else {
     		try {
-    			int resultIdent = search();
-    			setResultId(resultIdent);
-			} catch (DBLayerException e) {
-				logger.error("Searching metada failed. Remote exception caught in Metadata. Details: "+e.getMessage());
-				setError(ERROR_SEARCH);				               
-			} catch (RemoteException e) {
-				logger.error("Searching metada failed. DBLayer exception caught in Metadata. Details: "+e.getMessage());				
-				 setError(ERROR_REMOTE_EXCEPTION);	
-				 setRemoteEx(e);
-			}
-			return null;
+                    int resultIdent = search();
+                    setResultId(resultIdent);
+                    } catch (Exception e) {
+                          logger.error("Searching metada failed. Exception caught in Metadata. Details: "+e.getMessage());
+                           setError(ERROR_SEARCH);
+                           setException(e);
+                    }
+                    return null;
     	}
   }
     
@@ -249,10 +241,17 @@
      * @param from number of the first row to show in table. 
      * @param count number of rows to retrieve 
      */
-    public void processResult(int from, int count) throws RemoteException, DBLayerException{
+    public void processResult(int from, int count) throws Exception{
         
     	if (this.resultId != 0) {    		
-            int currentRow = getResultRows();
+             int currentRow = getResultCount();
+            setResultRows(currentRow);
+            if (isError()) {
+                Exception ex = getException();
+                setError(null);
+                setException(null);
+                throw ex;
+            }
             logger.debug("Rows in the result: "+currentRow);
             logger.debug("Max available rows: "+(from+count-1));            
            
@@ -269,20 +268,13 @@
                 Object[] objectMetadata;
              	try {
              		objectMetadata = database.more(this.resultId, 0, to-1);  
-             	} catch(RemoteException e) {
-             		logger.error("Remote exception caught in MetadataManager (processResult). Details: "+e.getMessage());        			
-        			RemoteException remex = new RemoteException(e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		                                    	                                                                                      
-                } catch (DBLayerException e) {                  
-                    logger.error("Processing search results failed: " + e.getMessage());   
-                    DBLayerException dbex = new DBLayerException(ERROR_PROCESS + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 
+             	}  catch (Exception e) {                  
+                    logger.error("Processing search results failed: " + e.getMessage());                       
+                    throw e; 
                 }  
                 if (objectMetadata == null) {
-                	logger.error("tMetadata doesn`t contain required data");
-                	DBLayerException dbex = new DBLayerException(ERROR_PROCESS + "tMetadata doesn`t contain required data");                   
+                    logger.error("tMetadata doesn`t contain required data");
+                    DBLayerException dbex = new DBLayerException(ERROR_PROCESS + "tMetadata doesn`t contain required data");                   
                     throw dbex; 
                 }
                 int countResult = objectMetadata.length;  
@@ -290,7 +282,7 @@
                 this.metadataList = new ArrayList<Metadata>();
                 // Cast the results to the Metadata objects
                 for (int i=0; i<countResult; i++ ) {                    							
-                	Object[] objHis = (Object[])objectMetadata[i];
+                    Object[] objHis = (Object[])objectMetadata[i];
                     this.metadataList.add((Metadata)objHis[0]);
                     logger.debug("Proccess: "+ i + ": " + (Metadata)objHis[0]);
                 }               
@@ -324,15 +316,11 @@
                 return false;
             }
             database.closeQuery(sq);
-        } catch (RemoteException e) {
-            logger.error("Remote exception caught in Metadata. Details: "+e.getMessage());
-            setError(ERROR_REMOTE_EXCEPTION);  
-            setRemoteEx(e);
-            return false;
-        } catch (DBLayerException e) {
+        } catch (Exception e) {
             logger.error("Loading metadata failed. Cannot determine whether metadata can be deleted");
-            setError(ERROR_DELETE);
-            return false;
+            setError(ERROR_DELETE);  
+            setException(e);
+            return false;       
         }        
         return true;
     }
@@ -358,16 +346,12 @@
                 return false;
             }
             database.closeQuery(sq);
-    	} catch (RemoteException e) {
-            logger.error("Remote exception caught in Metadata. Details: "+e.getMessage());
-            setError(ERROR_REMOTE_EXCEPTION);
-            setRemoteEx(e);
-            return false;
-        } catch (DBLayerException e) {
+    	} catch (Exception e) {
             logger.error("Check unique datasetTitle failed. Cannot determine whether some name of project equals new datasetTitle.");
             setError(ERROR_DATASETTITLE);
+            setException(e);
             return false;
-        }        
+        }    
     	return true;
     }
     
@@ -380,21 +364,13 @@
     public Task addMetedataRecord () {
     	    	
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {
+    		public Object task() throws Exception {
     			try {
 		            database.executeInsert(metadataRecord);		            		            
-		        }catch (RemoteException e) {
+		        }catch (Exception e) {
 		        	logger.error("Process add metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();
-                    RemoteException remex = new RemoteException(ERROR_ADD + e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process add metadata failed. DBLayer exception caught in MetadataManager. Details: "+e.getMessage());       	                                                   
-		        	database.rollbackTransaction();
-                    DBLayerException dbex = new DBLayerException(ERROR_ADD + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 		            
+		        	database.rollbackTransaction();                    
+                                throw e; 		            
 		        } 		       
 		        //Tell AppCore observerber
 		        setChanged(); 
@@ -415,22 +391,14 @@
     public Task editMetadataRecord() {       
         
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {
+    		public Object task() throws Exception {
     			try {
 		        	database.executeUpdate(metadataRecord);
 		        	metadataList.set(idRecord, metadataRecord);
-		        }catch (RemoteException e) {
+		        }catch (Exception e) {
 		        	logger.error("Process update metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();
-                    RemoteException remex = new RemoteException(ERROR_EDIT + e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process update metadata failed. DBLayer exception caught in MetadataManager. Details: "+e.getMessage());       	                                                   
-		        	database.rollbackTransaction();
-                    DBLayerException dbex = new DBLayerException(ERROR_EDIT + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 		            
+		        	database.rollbackTransaction();                   
+                                throw e; 		            
 		        } 		        
 		        //Tell AppCore observerber
 		        setChanged(); 
@@ -451,22 +419,13 @@
     public Task deleteMetadataRecord() {
     	
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {
+    		public Object task() throws Exception {
     			try {
 		        	metadataRecord.setDeleted(1);
 		            database.executeUpdate(metadataRecord);		            
-		        }catch (RemoteException e) {
-		        	logger.error("Process delete metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();
-                    RemoteException remex = new RemoteException(ERROR_DELETE + e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process delete metadata failed. DBLayer exception caught in MetadataManager. Details: "+e.getMessage());       	                                                   
-		        	database.rollbackTransaction();
-                    DBLayerException dbex = new DBLayerException(ERROR_DELETE + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 		            
+		        }catch (Exception e) {
+		        	logger.error("Process delete metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());		        	
+                                throw e; 		            
 		        } 			        
 		        //Tell AppCore observerber
 		        setChanged(); 
@@ -530,19 +489,19 @@
     }    
     
     /**
-     *  Set an remote exception (network communication failed)
-     *  @param ex  RemoteException (network communication failed)
+     *  Set an exception 
+     *  @param ex  Exception 
      */
-    public void setRemoteEx(RemoteException ex) {
-        this.remoteEx = ex;
+    public void setException(Exception ex) {
+        this.exception = ex;
     }
     
     /**
-     *  Get remote exception (network communication failed)
-     *  @return remote exception (network communication failed)
+     *  Get exception 
+     *  @return exception 
      */
-    public RemoteException getRemoteEx() {
-        return this.remoteEx;
+    public Exception getException() {
+        return this.exception;
     }  
     
     /** 
@@ -594,17 +553,35 @@
         return this.resultId;
     }
     
+    
+     /**
+     * Get the number of results for the current SelectQuery. 
+     * @return number of results for the current SelectQuery
+     */
+    public int getResultRows() {
+       return this.resultRows;
+    }
+    
     /**
+     * Set the number of results for the current SelectQuery.     
+     */
+    public void setResultRows(int resultCount) {
+        this.resultRows = resultCount;
+    }
+    
+  
+    /**
      * Get the number of results for the current SelectQuery
      * @return number of results for the current SelectQuery
      */
-    public int getResultRows() {
+    public int getResultCount() {
         int resultCount = 0;
         if (resultId != 0) try {
                 resultCount = database.getNumRows(resultId);        	
-        } catch(RemoteException e) {
-        	logger.error("Get number of results failed.Remote exception caught in MetadataManager. Details: "+e.getMessage());  
+        } catch(Exception e) {
+        	logger.error("Get number of results failed. Exception caught in MetadataManager. Details: "+e.getMessage());  
         	setError(ERROR_NUMBER_ROWS);
+                setException(e);
         }
         return resultCount;
     }

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -6,7 +6,7 @@
  * To change this template, choose Tools | Template Manager
  * and open the template in the editor.
  */
-
+    
 package net.sf.plantlore.client.metadata;
 
 import java.awt.event.ActionEvent;
@@ -20,6 +20,7 @@
 import net.sf.plantlore.client.user.AddEditUserView;
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Task;
@@ -102,25 +103,13 @@
            } else {
         	   view.previousButton.setEnabled(false);
            }
-    	} catch (RemoteException e) {
-    		DefaultReconnectDialog.show(view, e);
-    	} catch (DBLayerException e) {
-    		view.showErrorMessage(e.getMessage());
-    	}    	           
-    }
-    
-    /**
-     * Display error message.
-     */
-    public void displayError() {
-    	if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
- 		   DefaultReconnectDialog.show(view, model.getRemoteEx());
- 	   } else {
- 		   view.showErrorMessage(model.getError());
- 	   }
-    	//TODO nastavit ci nenastvit null
- 	   model.setError(null); 
-    }
+    	}catch (Exception ex) {                      
+           ex.printStackTrace();
+           DefaultExceptionHandler.handle(view, ex);         
+           return;
+        } 
+       
+    }       
      
    /**
     *  ActionListener class controlling the <b>PREV</b> button on the form.
@@ -131,7 +120,9 @@
        {
     	   // Check whether an error flag is set
            if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get previous page of results
@@ -164,7 +155,9 @@
        {
     	   //Check whether an error flag is set 
            if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get next page of result
@@ -193,7 +186,9 @@
        public void actionPerformed(ActionEvent actionEvent) {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Save old value 
@@ -233,7 +228,9 @@
        {
     	   //Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            //set information abut selected operation ADD
@@ -252,14 +249,15 @@
            Task task = model.addMetedataRecord();
            
            new DefaultProgressBar(task, view, true) {		   							 
-   			@Override
-   			public void afterStopping() {
-   				   if (! model.isFinishedTask()) return;
-				   model.setInfoFinishedTask(false);
-    			   //load metadata
+                @Override
+                public void afterStopping() {
+                   if (! model.isFinishedTask()) return;
+                   model.setInfoFinishedTask(false);
+                   //load metadata
     	           model.searchMetadata(false);
     	           if (model.isError()) {
-    	        	   displayError();
+    	        	   DefaultExceptionHandler.handle(view, model.getException());
+                           model.setError(null);
     	        	   return;
     	           }    	           
     	           reloadData(1, model.getDisplayRows());    	                   
@@ -277,7 +275,9 @@
        {
     	   //  Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableMetadataList.getSelectedRow() < 0) {
@@ -305,12 +305,12 @@
                
                new DefaultProgressBar(task, view, true) {
             	   @Override
-          			public void afterStopping() {
-            		   if (! model.isFinishedTask()) return;
-					   model.setInfoFinishedTask(false);
-          			   //load metadata          				
-                        if (model.isError()) return;
-                        view.tableMetadataList.setModel(new MetadataManagerTableModel(model));                         
+                public void afterStopping() {
+                     if (! model.isFinishedTask()) return;
+                     model.setInfoFinishedTask(false);
+                   //load metadata          				
+                    if (model.isError()) return;
+                    view.tableMetadataList.setModel(new MetadataManagerTableModel(model));                         
                      } 		   					
           		};          		                 	                   
                 task.start();                                       
@@ -326,7 +326,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	  Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableMetadataList.getSelectedRow() < 0) {    
@@ -360,7 +362,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableMetadataList.getSelectedRow() < 0) {    
@@ -373,7 +377,8 @@
                //Test if record can be deleted               
                if (!model.checkDelete(resultNumber)) {
             	   if (model.isError()) {
-	            	   displayError();
+	            	   DefaultExceptionHandler.handle(view, model.getException());
+                           model.setError(null);
 	            	   return;
             	   }
                    view.showErrorMessage(MetadataManager.ERROR_TITLE, MetadataManager.ERROR_CHECK_DELETE);
@@ -386,14 +391,16 @@
 		               Task task = model.deleteMetadataRecord();
 		               
 		             new DefaultProgressBar(task, view, true) {		   								  		   				
-						@Override						
-                        public void afterStopping() {
-							if (! model.isFinishedTask()) return;
-							model.setInfoFinishedTask(false);
-                           // load metadata
+                                    @Override						
+                                     public void afterStopping() {
+                                        if (! model.isFinishedTask()) return;
+                                        model.setInfoFinishedTask(false);
+                                        // load metadata
 		   	               model.searchMetadata(false);  
 		   	               if (model.isError()) {
-		   	            	   displayError();
+		   	            	   DefaultExceptionHandler.handle(view, model.getException());
+                                            model.setError(null);
+                                            model.setException(null);
 		   	            	   return;
 		   	               }
 		   	               reloadData(1, model.getDisplayRows());		   	              		   	               
@@ -416,7 +423,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            model.setSourceInstitutionId(view.sourceInstitutionIdText.getText());           
@@ -434,16 +443,16 @@
            new DefaultProgressBar(task, view, true) {		   								  			
 			   @Override 
         	   public void afterStopping() {
-				   if (! model.isFinishedTask()) return;
-				   model.setInfoFinishedTask(false);
-					if (model.getDisplayRows() <= 0) {
-		               model.setDisplayRows(MetadataManager.DEFAULT_DISPLAY_ROWS);
-		           }
-		           //No record in result - show message to user
-		           if (model.getResultRows() < 1) {
-		               view.showInfoMessage(MetadataManager.INFORMATION_RESULT_TITLE,MetadataManager.INFORMATION_RESULT);
-		           }
-		           reloadData(1, model.getDisplayRows());		           		           
+                       if (! model.isFinishedTask()) return;
+                       model.setInfoFinishedTask(false);
+                       if (model.getDisplayRows() <= 0) {
+                       model.setDisplayRows(MetadataManager.DEFAULT_DISPLAY_ROWS);
+                       }
+                       //No record in result - show message to user
+                       if (model.getResultRows() < 1) {
+                           view.showInfoMessage(MetadataManager.INFORMATION_RESULT_TITLE,MetadataManager.INFORMATION_RESULT);
+                       }
+                       reloadData(1, model.getDisplayRows());		           		           
                } 		   					
 			};			                  	                   
             task.start();                                                                  

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.form	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.form	2006-09-01 22:44:46 UTC (rev 621)
@@ -225,6 +225,11 @@
           </AuxValues>
         </Component>
         <Component class="javax.swing.JTextField" name="loginText">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="passwordtext"/>
+            </Property>
+          </Properties>
           <Events>
             <EventHandler event="actionPerformed" listener="java.awt.event.ActionListener" parameters="java.awt.event.ActionEvent" handler="loginTextActionPerformed"/>
           </Events>
@@ -233,16 +238,31 @@
           </AuxValues>
         </Component>
         <Component class="javax.swing.JTextField" name="firstNameText">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="surnameText"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
         </Component>
         <Component class="javax.swing.JTextField" name="emailText">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="addressText"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
         </Component>
         <Component class="javax.swing.JTextField" name="addressText">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="noteText"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
@@ -265,6 +285,9 @@
               <Properties>
                 <Property name="columns" type="int" value="20"/>
                 <Property name="rows" type="int" value="5"/>
+                <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+                  <ComponentRef name="administratorCheckBox"/>
+                </Property>
               </Properties>
               <AuxValues>
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -283,6 +306,11 @@
           </AuxValues>
         </Component>
         <Component class="javax.swing.JTextField" name="passwordtext">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="firstNameText"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
@@ -373,6 +401,9 @@
                 <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
                   <Insets value="[0, 0, 0, 0]"/>
                 </Property>
+                <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+                  <ComponentRef name="editAllCheckBox"/>
+                </Property>
               </Properties>
               <AuxValues>
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -391,6 +422,9 @@
                 <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
                   <Insets value="[0, 0, 0, 0]"/>
                 </Property>
+                <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+                  <ComponentRef name="addRightCheckBox"/>
+                </Property>
               </Properties>
               <AuxValues>
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -409,6 +443,9 @@
                 <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
                   <Insets value="[0, 0, 0, 0]"/>
                 </Property>
+                <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+                  <ComponentRef name="editGroupTextArea"/>
+                </Property>
               </Properties>
               <AuxValues>
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -430,6 +467,9 @@
                   <Properties>
                     <Property name="columns" type="int" value="20"/>
                     <Property name="rows" type="int" value="5"/>
+                    <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+                      <ComponentRef name="operationButton"/>
+                    </Property>
                   </Properties>
                   <AuxValues>
                     <AuxValue name="JavaCodeGenerator_CreateCodeCustom" type="java.lang.String" value="new AutoTextArea(choices, this);"/>
@@ -442,6 +482,11 @@
           </SubComponents>
         </Container>
         <Component class="javax.swing.JTextField" name="surnameText">
+          <Properties>
+            <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+              <ComponentRef name="emailText"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
@@ -453,6 +498,9 @@
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
           <Connection code="&quot;&quot;" type="code"/>
         </Property>
+        <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+          <ComponentRef name="closeButton"/>
+        </Property>
       </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -463,6 +511,9 @@
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
           <Connection code="L10n.getString(&quot;UserManager.ButtonClose&quot;)" type="code"/>
         </Property>
+        <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+          <ComponentRef name="helpButton"/>
+        </Property>
       </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -473,6 +524,9 @@
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
           <Connection code="L10n.getString(&quot;UserManager.ButtonHelp&quot;)" type="code"/>
         </Property>
+        <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
+          <ComponentRef name="loginText"/>
+        </Property>
       </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -260,20 +260,30 @@
 
         createWhenuser.setText(L10n.getString("UserManager.CreateWhen")+ ": ");
 
+        loginText.setNextFocusableComponent(passwordtext);
         loginText.addActionListener(new java.awt.event.ActionListener() {
             public void actionPerformed(java.awt.event.ActionEvent evt) {
                 loginTextActionPerformed(evt);
             }
         });
 
+        firstNameText.setNextFocusableComponent(surnameText);
+
+        emailText.setNextFocusableComponent(addressText);
+
+        addressText.setNextFocusableComponent(noteText);
+
         noteLabel.setText(L10n.getString("UserManager.Note")+ ": ");
 
         noteText.setColumns(20);
         noteText.setRows(5);
+        noteText.setNextFocusableComponent(administratorCheckBox);
         jScrollPane1.setViewportView(noteText);
 
         dropWhenLabel.setText(L10n.getString("UserManager.DropWhen")+ ": ");
 
+        passwordtext.setNextFocusableComponent(firstNameText);
+
         passwordLabel.setText(L10n.getString("UserManager.Password")+ ": (*) ");
 
         createWhenValueLabel.setText("");
@@ -284,20 +294,24 @@
         administratorCheckBox.setText(L10n.getString("UserManager.Right.Administrator"));
         administratorCheckBox.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         administratorCheckBox.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        administratorCheckBox.setNextFocusableComponent(editAllCheckBox);
 
         editAllCheckBox.setText(L10n.getString("UserManager.Right.EditAll"));
         editAllCheckBox.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         editAllCheckBox.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        editAllCheckBox.setNextFocusableComponent(addRightCheckBox);
 
         addRightCheckBox.setText(L10n.getString("UserManager.Right.Add"));
         addRightCheckBox.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         addRightCheckBox.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        addRightCheckBox.setNextFocusableComponent(editGroupTextArea);
 
         editGroupLabel.setText(L10n.getString("UserManager.Right.EditGroup"));
         editGroupLabel.setAutoscrolls(true);
 
         editGroupTextArea.setColumns(20);
         editGroupTextArea.setRows(5);
+        editGroupTextArea.setNextFocusableComponent(operationButton);
         jScrollPane3.setViewportView(editGroupTextArea);
 
         org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
@@ -330,6 +344,8 @@
                 .addContainerGap())
         );
 
+        surnameText.setNextFocusableComponent(emailText);
+
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
         jPanel1.setLayout(jPanel1Layout);
         jPanel1Layout.setHorizontalGroup(
@@ -420,10 +436,13 @@
         );
 
         operationButton.setText("");
+        operationButton.setNextFocusableComponent(closeButton);
 
         closeButton.setText(L10n.getString("UserManager.ButtonClose"));
+        closeButton.setNextFocusableComponent(helpButton);
 
         helpButton.setText(L10n.getString("UserManager.ButtonHelp"));
+        helpButton.setNextFocusableComponent(loginText);
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -41,8 +41,8 @@
     private SelectQuery query = null;
     /** Exception with details about an error */
     private String error = null;
-    /** Remote exception (network communication failed)*/
-    private RemoteException remoteEx;
+    /** Exception */
+    private Exception exception;
     /** True if MyTask finished successful*/
     private boolean  finishedTask = false;
     /** Constant with default number of rows to display */
@@ -55,6 +55,8 @@
     private String displayRow;    
     /** Result of the search query */
     private int resultId = 0;
+    /** Number of results for the current SelectQuery */
+    private int resultRows = 0;
     /** List of data (results of a search query) displayed in the table */
     private ArrayList<User> userList = new ArrayList<User>();         
     /** Message containing information about changes in user record*/
@@ -167,24 +169,16 @@
        
     	if (createTask) {
 	    	final Task task = new Task() {    		    		
-	    		public Object task() throws DBLayerException, RemoteException {
+	    		public Object task() throws Exception {
 	  		       int resultIdent;
 	    			try {
 	  		    	    resultIdent = search();
 	  		    	    setResultId(resultIdent);	
 	  		    	    loadLoginUsers();
-		    	   } catch (RemoteException e) {	            
+		    	   } catch (Exception e) {	            
 			            logger.error("Searching user failed. Remote exception caught in User. Details: "+e.getMessage());
-			        	database.rollbackTransaction();
-		                RemoteException remex = new RemoteException(ERROR_SEARCH + e.getMessage());
-		                remex.setStackTrace(e.getStackTrace());
-		                throw remex; 		           
-			        } catch (DBLayerException e) {
-			        	logger.error("Searching user failed. DBLayer exception caught in User. Details: "+e.getMessage());       	                                                   
-			        	database.rollbackTransaction();
-		                DBLayerException dbex = new DBLayerException(ERROR_SEARCH + e.getMessage());
-		                dbex.setStackTrace(e.getStackTrace());
-		                throw dbex; 		           
+			            database.rollbackTransaction();		                
+		                    throw e; 		           
 			        }		
 			        setInfoFinishedTask(true);
                     return null;			        
@@ -193,17 +187,14 @@
 		    return task;
     	} else {
     		try {
-    			int resultIdent = search();
-    			setResultId(resultIdent);
-			} catch (DBLayerException e) {
-				logger.error("Searching user failed. Remote exception caught in User. Details: "+e.getMessage());
-				setError(ERROR_SEARCH);
-			} catch (RemoteException e) {
-				logger.error("Searching user failed. DBLayer exception caught in User. Details: "+e.getMessage());				
-				setError(ERROR_REMOTE_EXCEPTION);	
-				setRemoteEx(e);                
-			}
-			return null;
+                    int resultIdent = search();
+                    setResultId(resultIdent);
+                    } catch (Exception e) {
+                            logger.error("Searching user failed. Exception caught in User. Details: "+e.getMessage());
+                            setError(ERROR_SEARCH);
+                            setException(e);               
+                    }
+                    return null;
     	}
   }
     
@@ -279,10 +270,17 @@
      * @param from number of the first row to show in table. Number of the first row to retraieve is 1.
      * @param count number of rows to retrieve 
      */
-    public void processResult(int from, int count) throws RemoteException, DBLayerException {
+    public void processResult(int from, int count) throws Exception {
         
         if (this.resultId != 0) {
-            int currentRow = getResultRows();
+            int currentRow = getResultCount();
+            setResultRows(currentRow);
+            if (isError()) {
+                Exception ex = getException();
+                setError(null);
+                setException(null);
+                throw ex;
+            }
             logger.debug("Rows in the result: "+currentRow);
             logger.debug("Max available rows: "+(from+count-1));
            
@@ -299,21 +297,13 @@
                 Object[] objectUser;
              	try {
              		objectUser = database.more(this.resultId, 0, to-1);  
-             	} catch(RemoteException e) {
-             		logger.error("Remote exception caught in UserManager (processResult). Details: "+e.getMessage());
-             		RemoteException remex = new RemoteException(e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex;                                                                              
-                } catch (DBLayerException e) {                  
-                    logger.error("Processing search results failed: " + e.getMessage());   
-                    DBLayerException dbex = new DBLayerException(ERROR_PROCESS + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 
+             	} catch(Exception e) {
+             		logger.error("Processing search results failed: " + e.getMessage());                		
+                        throw e; 
                 }  
                 if (objectUser == null) {
                 	logger.error("tUser doesn`t contain required data");
-                	DBLayerException dbex = new DBLayerException(ERROR_PROCESS + "tUser doesn`t contain required data");                   
-                    throw dbex; 
+                	throw new DBLayerException(ERROR_PROCESS + "tUser doesn`t contain required data");                                       
                 }
                 int countResult = objectUser.length;  
                 logger.debug("Results retrieved. Count: "+ countResult);                
@@ -340,7 +330,7 @@
     public Task addUserRecord() {
     	    	
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {
+    		public Object task() throws Exception {
     			
     			boolean ok = false;
     			ok = database.beginTransaction();
@@ -367,18 +357,10 @@
                                 logger.debug(userRecord.getId());
                                 //TODO overit, zda znam cID nebo je zjistit jinak ... pravdepodobne se rovna count+1    	            
                                 users = usersNew;
-                        }catch (RemoteException e) {
-                                logger.error("Process add User failed. Remote exception caught in UserManager. Details: "+e.getMessage());
-                                database.rollbackTransaction();	
-                                RemoteException remex = new RemoteException(ERROR_ADD + e);
-                                remex.setStackTrace(e.getStackTrace());
-                                throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process add User failed. DBLayer exception caught in UserManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();	
-                    DBLayerException dbex = new DBLayerException(ERROR_ADD + e);
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 		            
+                        }catch (Exception e) {
+                                logger.error("Process add User failed. Exception caught in UserManager. Details: "+e.getMessage());
+                                database.rollbackTransaction();	                               
+                                throw e; 		            
 		        } 	
 		        database.commitTransaction();
 		        setInfoFinishedTask(true);
@@ -427,16 +409,8 @@
                                 //logger.debug("Edit user - after update user list");
 		        }catch (RemoteException e) {
 		        	logger.error("Process update User failed. Remote exception caught in UserManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();		        	
-                                RemoteException remex = new RemoteException(ERROR_EDIT + e.getMessage());
-                                remex.setStackTrace(e.getStackTrace());
-                                throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process update User failed. DBLayer exception caught in UserManager. Details: "+e.getMessage());       	                                                   
-		        	database.rollbackTransaction();		        
-                                DBLayerException dbex = new DBLayerException(ERROR_EDIT + e.getMessage());
-                                dbex.setStackTrace(e.getStackTrace());
-                                throw dbex; 		            
+		        	database.rollbackTransaction();		        	                       
+                                throw e; 		            
 		        } 
                         logger.debug("Edit user - before commit transaction");
 		        database.commitTransaction();                                                
@@ -458,7 +432,7 @@
     	//Set actual time into param DROPWHEN - inform about deactive user account     	
         userRecord.setDropWhen(new Date());    	
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {  
+    		public Object task() throws Exception {  
     			
     			boolean ok = false;
     			ok = database.beginTransaction();
@@ -471,18 +445,10 @@
     				database.dropUser(userRecord.getLogin());
     				//Set information abou dropping user into database
     				 database.executeUpdate(userRecord);		            
-		        }catch (RemoteException e) {
+		        }catch (Exception e) {
 		        	logger.error("Process delete User failed. Remote exception caught in UserManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();
-                    RemoteException remex = new RemoteException(ERROR_DELETE + e.getMessage());
-                    remex.setStackTrace(e.getStackTrace());
-                    throw remex; 		           		       	    
-		        } catch (DBLayerException e) {
-		        	logger.error("Process delete User failed. DBLayer exception caught in UserManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();
-                    DBLayerException dbex = new DBLayerException(ERROR_DELETE + e.getMessage());
-                    dbex.setStackTrace(e.getStackTrace());
-                    throw dbex; 		            
+		        	database.rollbackTransaction();                    
+                                throw e; 		            
 		        } 		
 		        database.commitTransaction();
 		        setInfoFinishedTask(true);
@@ -498,7 +464,7 @@
      * @throws DBLayerException in case search failed
      * @throws RemoteException in case network communication failed
      */
-    public Pair<String, Integer>[] loadLoginUsers() throws DBLayerException, RemoteException{
+    public Pair<String, Integer>[] loadLoginUsers() throws Exception{
         if (users == null)
         {  
             SelectQuery sq;
@@ -527,16 +493,9 @@
                     userLogin.add((String)record[2]);
                 }
                 database.closeQuery(sq);
-            }catch (RemoteException e) {	            
-	            logger.error("Searching user and creating Pairs (login, identifier) failed. Remote exception caught in User. Details: "+e.getMessage());	        	
-                RemoteException remex = new RemoteException(ERROR_CREATE_PAIRS + e.getMessage());
-                remex.setStackTrace(e.getStackTrace());
-                throw remex; 		           
-	        } catch (DBLayerException e) {
-	        	logger.error("Searching user and creating Pairs (login, identifier) failed. DBLayer exception caught in User. Details: "+e.getMessage());       	                                                   
-                DBLayerException dbex = new DBLayerException(ERROR_CREATE_PAIRS + e.getMessage());
-                dbex.setStackTrace(e.getStackTrace());
-                throw dbex; 		           
+            }catch (Exception e) {	            
+	            logger.error("Searching user and creating Pairs (login, identifier) failed. Remote exception caught in User. Details: "+e.getMessage());	        	                
+                   throw e; 		           
 	        }					       
             return users;
         } else
@@ -684,20 +643,20 @@
         return this.error;
     }      
     
-    /**
-     *  Set an remote exception (network communication failed)
-     *  @param ex  RemoteException (network communication failed)
+     /**
+     *  Set an exception 
+     *  @param ex  exception
      */
-    public void setRemoteEx(RemoteException ex) {
-        this.remoteEx = ex;
+    public void setException(Exception ex) {
+        this.exception = ex;
     }
     
     /**
-     *  Get remote exception (network communication failed)
-     *  @return remote exception (network communication failed)
+     *  Get exception
+     *  @return exception 
      */
-    public RemoteException getRemoteEx() {
-        return this.remoteEx;
+    public Exception getException() {
+        return this.exception;
     }  
     
     /** 
@@ -749,16 +708,32 @@
     }
     
     /**
-     * Get the number of results for the current SelectQuery
+     * Get the number of results for the current SelectQuery. 
      * @return number of results for the current SelectQuery
      */
     public int getResultRows() {
+       return this.resultRows;
+    }
+    
+    /**
+     * Set the number of results for the current SelectQuery.     
+     */
+    public void setResultRows(int resultCount) {
+        this.resultRows = resultCount;
+    }
+    
+    /**
+     * Get the number of results for the current SelectQuery
+     * @return number of results for the current SelectQuery
+     */
+    public int getResultCount() {
         int resultCount = 0;
         if (resultId != 0) try {
                 resultCount = database.getNumRows(resultId);        	
         } catch(RemoteException e) {
                 logger.error("Get number of results failed.Remote exception caught in UserManager. Details: "+e.getMessage());  
             	setError(ERROR_REMOTE_EXCEPTION);
+                setException(e);
         }
         return resultCount;
     }

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-01 22:12:38 UTC (rev 620)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-01 22:44:46 UTC (rev 621)
@@ -18,6 +18,7 @@
 import net.sf.plantlore.client.metadata.MetadataManager;
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Task;
@@ -103,26 +104,14 @@
            } else {
         	   view.previousButton.setEnabled(false);
            }
-    	} catch (RemoteException e) {
-    		DefaultReconnectDialog.show(view, e);
-    	} catch (DBLayerException e) {
-    		view.showErrorMessage(e.getMessage());
-    	}    	           
+    	} catch (Exception ex) {           
+           ex.printStackTrace();
+           DefaultExceptionHandler.handle(view, ex);           
+           return;
+        } 
+	           
     }
-    
-    /**
-     * Display error message.
-     */
-    public void displayError() {
-    	if (model.getError().equals(History.ERROR_REMOTE_EXCEPTION)) {
- 		   DefaultReconnectDialog.show(view, model.getRemoteEx());
- 	   } else {
- 		   view.showErrorMessage(model.getError());
- 	   }
-    	//TODO nastavit ci nenastvit null
- 	   model.setError(null); 
-    }
-   
+      
    /**
     *  ActionListener class controlling the <b>PREV</b> button on the form.
     *  The button PREV is used for browsing the search results.
@@ -132,7 +121,9 @@
        {
     	   // Check whether an error flag is set
            if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);                   
         	   return;
            }
            // Get previous page of results
@@ -164,7 +155,9 @@
        {
     	   // Check whether an error flag is set 
            if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Get next page of result
@@ -193,7 +186,9 @@
        public void actionPerformed(ActionEvent actionEvent) {
            // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            // Save old value 
@@ -233,7 +228,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            //set information abut selected operation ADD
@@ -259,7 +256,9 @@
     			   //load data
     	           model.searchUser(false);  
     	           if (model.isError()) {
-    	        	   displayError();
+    	        	   DefaultExceptionHandler.handle(view, model.getException());
+                           model.setError(null);
+                           model.setException(null);
     	        	   return;
     	           }    	
     	           reloadData(1, model.getDisplayRows());    	             	           
@@ -277,7 +276,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(UserManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableUserList.getSelectedRow() < 0) {
@@ -331,7 +332,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableUserList.getSelectedRow() < 0) {    
@@ -363,7 +366,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(UserManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
            if (view.tableUserList.getSelectedRow() < 0) {    
@@ -398,7 +403,9 @@
                                        // load User
 		   	               model.searchUser(false); 
 		   	               if (model.isError()) {
-		    	        	   displayError();
+		    	        	   DefaultExceptionHandler.handle(view, model.getException());
+                                           model.setError(null);
+                                           model.setException(null);
 		    	        	   return;
 		    	           }    	
 		   	               reloadData(1, model.getDisplayRows());		   	               		   	              
@@ -420,7 +427,9 @@
        {
     	   // Check whether an error flag is set
     	   if (model.isError()) {
-        	   view.showErrorMessage(MetadataManager.ERROR_TITLE, model.getError());
+        	   Exception ex = model.getException();
+                   ex.printStackTrace();
+                   DefaultExceptionHandler.handle(view, ex);  
         	   return;
            }
     	   model.setWholeName(view.wholeNameSearchText.getText());           



From ladaOb at seznam.cz  Sat Sep  2 00:49:13 2006
From: ladaOb at seznam.cz (=?iso-8859-2?Q?Lada_Oberreiterov=E1?=)
Date: Sat, 2 Sep 2006 00:49:13 +0200
Subject: [Plantlore-dev] Vyjimka
Message-ID: <001f01c6ce18$e09a1890$f12ca20a@Jose>

Ahojte,

posilam jednu z vyjimek,na ktere jsem narazila

1. pouziji edit pro zmenu polozky napr. Herbar
2. otevru historie tohoto nalezu a dam UNDO na polozku Herbar
3. opet zedituji polozku Herbar
4. pokusim se o UNDO na tuto polozku a sleti to z nasledujici vyjimkou

Co se tyka osetreni vyjimek, tak by melo byt v historii, userM a metadataM spravne pomoci DefaultExceptionHandler a kazdy task pouziva defaultProgressBar.


Hibernate: update TOCCURRENCES set CVERSION=?, CUNITIDDB=?, CUNITVALUE=?, CHABITATID=?, CPLANTID=?, CYEARCOLLECTED=?, CMONTHCOLLECTED=?, CDAYCOLLECTED=?, CTIMECOLLECTED=?, CISODATETIMEBEGIN=?, CDATASOURCE=?, CPUBLICATIONSID=?, CHERBARIUM=?, CCREATEWHEN=?, CCREATEWHO=?, CUPDATEWHEN=?, CUPDATEWHO=?, CNOTE=?, CMETADATAID=?, CDELETE=? where CID=? and CVERSION=?
00:31:32,750 ERROR Thread-11 AbstractFlushingEventListener:300 - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
net.sf.plantlore.common.exception.DBLayerException: Error.ConcurrentUpdate
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:343)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at java.lang.Thread.run(Thread.java:595)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
00:31:32,750  WARN Thread-11 server:342 - StaleObjectStateException caught (Concurrent transactions running and trying to commit). Details: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
00:31:32,750 ERROR Thread-11 history:1507 - Process UNDO failed. Exception caught in History. Details: Error.ConcurrentUpdate
00:31:33,109 DEBUG Thread-11 history:177 - Received message: STOPPING
00:31:33,125 DEBUG AWT-EventQueue-0 history:184 - Progress bar visible
        ... 15 more
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060902/bc9c055f/attachment.html>

From ladaOb at seznam.cz  Sat Sep  2 01:47:07 2006
From: ladaOb at seznam.cz (=?iso-8859-2?Q?Lada_Oberreiterov=E1?=)
Date: Sat, 2 Sep 2006 01:47:07 +0200
Subject: [Plantlore-dev] Fw: Vyjimka - o kork dal
Message-ID: <003501c6ce20$f09e2850$f12ca20a@Jose>

Tak jsem se chvili zabivala poslanou vyjimkou a posunula jsem se o neco dal:
- chyba je na me strane, protoze jsem v dlouhe transakci volala executeHistory() misto executeUpdateInTransactionHistory().
- Kovo, potrebovala bych pridat do HibernateDBLayer funkci executeDleleteInTransactionHistory(record), ktera fyzicky smaze zaznam, co dostane a bude volatelna v ramci dlouhe transakce
- po oprave chyby a zokomentovani kodu s volanim deleteHistory jsem dostala nasledujici vyjimku:
- jeste se na to zkusim kouknout, ale  kdyz vas neco napadne, tak pisnete, dik

Hibernate: update TOCCURRENCES set CVERSION=?, CUNITIDDB=?, CUNITVALUE=?, CHABITATID=?, CPLANTID=?, CYEARCOLLECTED=?, CMONTHCOLLECTED=?, CDAYCOLLECTED=?, CTIMECOLLECTED=?, CISODATETIMEBEGIN=?, CDATASOURCE=?, CPUBLICATIONSID=?, CHERBARIUM=?, CCREATEWHEN=?, CCREATEWHO=?, CUPDATEWHEN=?, CUPDATEWHO=?, CNOTE=?, CMETADATAID=?, CDELETE=? where CID=? and CVERSION=?
01:41:37,562 ERROR Thread-12 AbstractFlushingEventListener:300 - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
net.sf.plantlore.common.exception.DBLayerException: Exception.CommitTransaction
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at net.sf.plantlore.server.HibernateDBLayer.commitTransaction(HibernateDBLayer.java:895)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at $Proxy0.commitTransaction(Unknown Source)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.commitTransaction(Login.java:550)
        at net.sf.plantlore.client.history.History$3.task(History.java:1509)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.server.HibernateDBLayer.commitTransaction(HibernateDBLayer.java:884)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at spin.Invocation.evaluate(Invocation.java:175)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at $Proxy0.commitTransaction(Unknown Source)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.commitTransaction(Login.java:550)
        at net.sf.plantlore.client.history.History$3.task(History.java:1509)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
01:41:37,562 FATAL Thread-12 server:894 - Cannot commit database transaction
01:41:37,703 DEBUG Thread-12 history:177 - Received message: STOPPING
01:41:37,718 DEBUG AWT-EventQueue-0 history:184 - Progress bar visible
01:41:37,734 DEBUG Thread-12 history:223 - ProgressBar:Stopping net.sf.plantlore.client.history.History$3 at 12efcfe
01:41:37,734  WARN Thread-12 l10n:99 - The key "Error.General" is not defined in the property file!
~~DefaultExceptionHandler~~
Exception.CommitTransaction

----- Original Message ----- 
From: Lada Oberreiterov? 
To: plantlore-dev at lists.berlios.de 
Sent: Saturday, September 02, 2006 12:49 AM
Subject: Vyjimka


Ahojte,

posilam jednu z vyjimek,na ktere jsem narazila

1. pouziji edit pro zmenu polozky napr. Herbar
2. otevru historie tohoto nalezu a dam UNDO na polozku Herbar
3. opet zedituji polozku Herbar
4. pokusim se o UNDO na tuto polozku a sleti to z nasledujici vyjimkou

Co se tyka osetreni vyjimek, tak by melo byt v historii, userM a metadataM spravne pomoci DefaultExceptionHandler a kazdy task pouziva defaultProgressBar.


Hibernate: update TOCCURRENCES set CVERSION=?, CUNITIDDB=?, CUNITVALUE=?, CHABITATID=?, CPLANTID=?, CYEARCOLLECTED=?, CMONTHCOLLECTED=?, CDAYCOLLECTED=?, CTIMECOLLECTED=?, CISODATETIMEBEGIN=?, CDATASOURCE=?, CPUBLICATIONSID=?, CHERBARIUM=?, CCREATEWHEN=?, CCREATEWHO=?, CUPDATEWHEN=?, CUPDATEWHO=?, CNOTE=?, CMETADATAID=?, CDELETE=? where CID=? and CVERSION=?
00:31:32,750 ERROR Thread-11 AbstractFlushingEventListener:300 - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
net.sf.plantlore.common.exception.DBLayerException: Error.ConcurrentUpdate
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:343)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at java.lang.Thread.run(Thread.java:595)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
00:31:32,750  WARN Thread-11 server:342 - StaleObjectStateException caught (Concurrent transactions running and trying to commit). Details: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
00:31:32,750 ERROR Thread-11 history:1507 - Process UNDO failed. Exception caught in History. Details: Error.ConcurrentUpdate
00:31:33,109 DEBUG Thread-11 history:177 - Received message: STOPPING
00:31:33,125 DEBUG AWT-EventQueue-0 history:184 - Progress bar visible
        ... 15 more
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060902/7f5efd90/attachment.html>

From lada at mail.berlios.de  Sat Sep  2 01:58:36 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 01:58:36 +0200
Subject: [Plantlore-dev] r622 - in trunk/src/net/sf/plantlore/client:
	history user
Message-ID: <200609012358.k81NwaUt032181@sheep.berlios.de>

Author: lada
Date: 2006-09-02 01:58:21 +0200 (Sat, 02 Sep 2006)
New Revision: 622

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
Log:
Use correctly function database.execute... in transaction.

History.java - must call database.executeDeleteInTransactionHistory(). We must write this function.

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-01 22:44:46 UTC (rev 621)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-01 23:58:21 UTC (rev 622)
@@ -1496,10 +1496,8 @@
 			                         key = (Enum)editTypeHash.get(type); 
 			                         if(!editType.contains(key))
 			                             editType.add(key);
-			                }                                  
-			                 // TODO tady to spadne otevru dialog History, zavru, vypnu DB, dialog, zapnu DB, znosu pripojim
-			                 // k databazi, zedituji nalez a na danou polozku zavolam UNDO
-			                database.executeUpdateHistory(editObjectList.get(i));
+			                }                                  			                
+			                database.executeUpdateInTransactionHistory(editObjectList.get(i));
 			    		}
 			    	//Delete selected data from history tables 
 			    	deleteHistory();

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-01 22:44:46 UTC (rev 621)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-01 23:58:21 UTC (rev 622)
@@ -346,7 +346,7 @@
     				//Insert information about user into tRight, tUser
     				int rightId = database.executeInsert(right);
                                 right.setId(rightId);
-                                database.executeInsert(userRecord);		                                
+                                database.executeInsertInTransaction(userRecord);		                                
                                 //Add new name (login) of user to user list    	            
                                 int count = users.length;
                                 Pair<String, Integer>[] usersNew = new Pair[count+1];
@@ -444,7 +444,7 @@
     				//Drop database user
     				database.dropUser(userRecord.getLogin());
     				//Set information abou dropping user into database
-    				 database.executeUpdate(userRecord);		            
+    				 database.executeUpdateInTransaction(userRecord);		            
 		        }catch (Exception e) {
 		        	logger.error("Process delete User failed. Remote exception caught in UserManager. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                    



From lada at mail.berlios.de  Sat Sep  2 02:31:21 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 02:31:21 +0200
Subject: [Plantlore-dev] r623 - in trunk/src/net/sf/plantlore/client:
	history metadata user
Message-ID: <200609020031.k820VL7w009171@sheep.berlios.de>

Author: lada
Date: 2006-09-02 02:31:13 +0200 (Sat, 02 Sep 2006)
New Revision: 623

Modified:
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
   trunk/src/net/sf/plantlore/client/user/UserManagerView.java
Log:
Set location of dialog.

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -31,6 +31,7 @@
     public DetailsHistoryView(javax.swing.JDialog parent, boolean modal) {
         super(parent, modal);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        setLocationRelativeTo(null);
         initComponents(); 
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -40,6 +40,7 @@
         this.model = model;
         // Register observer
         model.addObserver(this);
+        setLocationRelativeTo(null);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents();
         getRootPane().setDefaultButton(closeButton);        

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -38,6 +38,7 @@
         this.model = model;
         // Register observer
         model.addObserver(this);
+        setLocationRelativeTo(null);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
         initComponents();        
         getRootPane().setDefaultButton(closeButton);            

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-02 00:31:13 UTC (rev 623)
@@ -23,7 +23,7 @@
                   <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="helpButton" min="-2" pref="100" max="-2" attributes="0"/>
-                      <EmptySpace pref="331" max="32767" attributes="0"/>
+                      <EmptySpace pref="360" max="32767" attributes="0"/>
                       <Component id="operationButton" min="-2" pref="100" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="closeButton" min="-2" pref="100" max="-2" attributes="0"/>
@@ -109,8 +109,8 @@
                               </Group>
                               <EmptySpace min="-2" pref="21" max="-2" attributes="0"/>
                               <Group type="103" groupAlignment="0" attributes="0">
-                                  <Component id="abbrevText" pref="136" max="32767" attributes="2"/>
-                                  <Component id="sourceInstirutionIdText" alignment="0" pref="136" max="32767" attributes="2"/>
+                                  <Component id="abbrevText" pref="165" max="32767" attributes="2"/>
+                                  <Component id="sourceInstirutionIdText" alignment="0" pref="165" max="32767" attributes="2"/>
                               </Group>
                               <EmptySpace min="-2" pref="335" max="-2" attributes="0"/>
                           </Group>
@@ -172,9 +172,9 @@
                           </Group>
                           <EmptySpace min="-2" pref="23" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="technicalContactAddressText" alignment="0" pref="136" max="32767" attributes="2"/>
-                              <Component id="technicalContactNameText" alignment="0" pref="136" max="32767" attributes="2"/>
-                              <Component id="technicalContactEmailText" alignment="0" pref="136" max="32767" attributes="2"/>
+                              <Component id="technicalContactAddressText" alignment="0" pref="151" max="32767" attributes="2"/>
+                              <Component id="technicalContactNameText" alignment="0" pref="151" max="32767" attributes="2"/>
+                              <Component id="technicalContactEmailText" alignment="0" pref="151" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                       </Group>
@@ -265,9 +265,9 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="contentContactNameText" alignment="0" pref="165" max="32767" attributes="2"/>
-                              <Component id="contentContactEmailText" alignment="0" pref="165" max="32767" attributes="2"/>
-                              <Component id="contectContactAddressText" alignment="0" pref="165" max="32767" attributes="2"/>
+                              <Component id="contentContactNameText" alignment="0" pref="179" max="32767" attributes="2"/>
+                              <Component id="contentContactEmailText" alignment="0" pref="179" max="32767" attributes="2"/>
+                              <Component id="contectContactAddressText" alignment="0" pref="179" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace min="-2" pref="47" max="-2" attributes="0"/>
                       </Group>
@@ -381,7 +381,7 @@
                               <EmptySpace min="-2" pref="12" max="-2" attributes="0"/>
                               <Component id="jPanel6" max="32767" attributes="0"/>
                               <EmptySpace max="-2" attributes="0"/>
-                              <Component id="jPanel7" pref="277" max="32767" attributes="0"/>
+                              <Component id="jPanel7" pref="292" max="32767" attributes="0"/>
                           </Group>
                           <Group type="102" alignment="0" attributes="0">
                               <EmptySpace max="-2" attributes="0"/>
@@ -428,9 +428,9 @@
                           </Group>
                           <EmptySpace min="-2" pref="24" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="sourceIdText" pref="165" max="32767" attributes="2"/>
-                              <Component id="dataSetDetailsText" alignment="0" pref="165" max="32767" attributes="2"/>
-                              <Component id="dataSetTitleText" alignment="0" pref="165" max="32767" attributes="2"/>
+                              <Component id="sourceIdText" pref="179" max="32767" attributes="2"/>
+                              <Component id="dataSetDetailsText" alignment="0" pref="179" max="32767" attributes="2"/>
+                              <Component id="dataSetTitleText" alignment="0" pref="179" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace min="-2" pref="21" max="-2" attributes="0"/>
                       </Group>

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -40,6 +40,7 @@
         super(parent, modal);
         this.model = model;
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        setLocationRelativeTo(null);
         initComponents();        
         //getRootPane().setDefaultButton(closeButton); 
         PlantloreHelp.addKeyHelp(PlantloreHelp.METDATA_ADD, this.getRootPane());

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -39,6 +39,7 @@
         this.model = model;
         model.addObserver(this);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        setLocationRelativeTo(null);
         initComponents();
         //getRootPane().setDefaultButton(closeButton);
         //Init Help

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -42,6 +42,7 @@
         super(parent, modal);
         this.model = model;
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        setLocationRelativeTo(null);
         initComponents(); 
         PlantloreHelp.addKeyHelp(PlantloreHelp.USER_ADD, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.USER_ADD, this.helpButton);        

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-01 23:58:21 UTC (rev 622)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-02 00:31:13 UTC (rev 623)
@@ -34,6 +34,7 @@
         super(parent, modal);
         this.model = model;
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        setLocationRelativeTo(null);
         initComponents();        
         // getRootPane().setDefaultButton(closeButton);
         PlantloreHelp.addKeyHelp(PlantloreHelp.USER_MANAGER, this.getRootPane());



From lada at mail.berlios.de  Sat Sep  2 03:13:32 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 03:13:32 +0200
Subject: [Plantlore-dev] r624 - trunk/src/net/sf/plantlore/client/history
Message-ID: <200609020113.k821DWLm019549@sheep.berlios.de>

Author: lada
Date: 2006-09-02 03:13:16 +0200 (Sat, 02 Sep 2006)
New Revision: 624

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
Log:
History of record - fix bug (email 2.9.):
Call operation UNDO to the same occurrence second time is working now.

Use new function executeDeleteInTransactionHistory()

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-02 00:31:13 UTC (rev 623)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-02 01:13:16 UTC (rev 624)
@@ -416,6 +416,8 @@
         initPublicationHash();
         initAuthorHash();      
         initMetadataHash();
+        //Init editObjecList
+        editObjectList.clear();
         	    	
     	//read record from younger to older until selected row        
     	for( int i=0; i < toResult; i++) {    
@@ -451,7 +453,8 @@
         	
     	//number of result
     	int countResult = getResultRows();    	   
-    	
+    	editObjectList.clear();
+        
     	//take record from younger to older
     	for( int i=0; i < countResult; i++) {
     		if (isError())return;
@@ -1510,6 +1513,7 @@
 		    	//Create array of editing object and call notifyObservers
 		        informMethod(editType);
 		        setInfoFinishedTask(true);
+                        
 		        return null;
     		}
 	    };
@@ -1555,7 +1559,7 @@
     		historyChange = historyRecord.getHistoryChange(); 
     		
 	    	try {
-                        database.executeDeleteHistory(historyRecord);
+                        database.executeDeleteInTransactionHistory(historyRecord);
                         logger.debug("Deleting historyRecord successfully. Number of result: "+i);
                 } catch (Exception e) {								
                         logger.error("Process UNDO failed. Deleting historyRecord failed. Exception caught in History. Details: "+e.getMessage());	        	                
@@ -1564,7 +1568,7 @@
                 try {
                         int countResult = getRelationshipHistoryChange(historyChange.getId());				
                         if (countResult == 0) {	
-                                database.executeDeleteHistory(historyChange);
+                                database.executeDeleteInTransactionHistory(historyChange);
                                 logger.debug("Deleting historyChange successfully.");
                         } else {
                                 logger.debug("Exist other record in the table tHistory, whitch has the same value of attribute cChangeId.");



From kovo at mail.berlios.de  Sat Sep  2 03:15:41 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sat, 2 Sep 2006 03:15:41 +0200
Subject: [Plantlore-dev] r625 - in trunk/src/net/sf/plantlore: middleware
	server
Message-ID: <200609020115.k821Ff9l019725@sheep.berlios.de>

Author: kovo
Date: 2006-09-02 03:15:22 +0200 (Sat, 02 Sep 2006)
New Revision: 625

Modified:
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Add executeDeleteInTransactionHistory() method to DBLayer. This method executes delete in long transaction without modifying history tables.

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-02 01:13:16 UTC (rev 624)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-02 01:15:22 UTC (rev 625)
@@ -292,6 +292,19 @@
     public void executeDeleteInTransaction(Object data) throws DBLayerException, RemoteException;
 
     /**
+     *  Execute DB delete using a long running transaction. For this method to work, it is neccessary
+     *  to begin long running transaction using beginTransaction() method of this class.
+     *
+     *  This method checks whether the user has appropriate priviliges and DOES NOT save history
+     *
+     *  @param data holder object with the record we want to delete
+     *  @throws DBLayerException in case we are not connected to the database or an error occurred
+     *                           while executing the delete
+     *  @throws RemoteException in case network connection failed
+     */    
+    public void executeDeleteInTransactionHistory(Object data) throws DBLayerException, RemoteException;    
+    
+    /**
      *  Method for creating new database user using CREATE USER statement. This method can only be called
      *  as a part of long running transaction (such as executeInsertInTransaction() method).
      *

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-02 01:13:16 UTC (rev 624)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-02 01:15:22 UTC (rev 625)
@@ -1000,6 +1000,21 @@
     public void executeDeleteInTransaction(Object data) throws DBLayerException, RemoteException {
     	lowLevelOperation(DELETE, data, true, false);
     }    
+
+    /**
+     *  Execute DB delete using a long running transaction. For this method to work, it is neccessary
+     *  to begin long running transaction using beginTransaction() method of this class.
+     *
+     *  This method checks whether the user has appropriate priviliges and DOES NOT save history
+     *
+     *  @param data holder object with the record we want to delete
+     *  @throws DBLayerException in case we are not connected to the database or an error occurred
+     *                           while executing the delete
+     *  @throws RemoteException in case network connection failed
+     */    
+    public void executeDeleteInTransactionHistory(Object data) throws DBLayerException, RemoteException {
+        lowLevelOperation(DELETE, data, false, false);
+    }
     
     private void checkRights(Object data, int type) throws DBLayerException {
         DBLayerException ex;



From ladaOb at seznam.cz  Sat Sep  2 03:16:58 2006
From: ladaOb at seznam.cz (=?iso-8859-2?Q?Lada_Oberreiterov=E1?=)
Date: Sat, 2 Sep 2006 03:16:58 +0200
Subject: [Plantlore-dev] Fw:  Fw: Vyjimka - o kork dal - VYRESENO
Message-ID: <006d01c6ce2d$7dfa8ca0$f12ca20a@Jose>

Tak uz je to ok :-)

Bylo to tim, ze jsem pri prvnim UNDO ulozila do  promnne editObjectList ten occurrenc ... pri drujem otevreni jsem ho tam nechala a protoze uz tam existoval, tak se nepridal aktualne nacteny, ale volala jsem pak commite na ten stary.
Takze bylo pridano na spravne misto promazani promenne editObjectList a uz to funguje. 

----- Original Message ----- 
From: Lada Oberreiterov? 
To: plantlore-dev at lists.berlios.de 
Sent: Saturday, September 02, 2006 1:47 AM
Subject: [Plantlore-dev] Fw: Vyjimka - o kork dal


Tak jsem se chvili zabivala poslanou vyjimkou a posunula jsem se o neco dal:
- chyba je na me strane, protoze jsem v dlouhe transakci volala executeHistory() misto executeUpdateInTransactionHistory().
- Kovo, potrebovala bych pridat do HibernateDBLayer funkci executeDleleteInTransactionHistory(record), ktera fyzicky smaze zaznam, co dostane a bude volatelna v ramci dlouhe transakce
- po oprave chyby a zokomentovani kodu s volanim deleteHistory jsem dostala nasledujici vyjimku:
- jeste se na to zkusim kouknout, ale  kdyz vas neco napadne, tak pisnete, dik

Hibernate: update TOCCURRENCES set CVERSION=?, CUNITIDDB=?, CUNITVALUE=?, CHABITATID=?, CPLANTID=?, CYEARCOLLECTED=?, CMONTHCOLLECTED=?, CDAYCOLLECTED=?, CTIMECOLLECTED=?, CISODATETIMEBEGIN=?, CDATASOURCE=?, CPUBLICATIONSID=?, CHERBARIUM=?, CCREATEWHEN=?, CCREATEWHO=?, CUPDATEWHEN=?, CUPDATEWHO=?, CNOTE=?, CMETADATAID=?, CDELETE=? where CID=? and CVERSION=?
01:41:37,562 ERROR Thread-12 AbstractFlushingEventListener:300 - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
net.sf.plantlore.common.exception.DBLayerException: Exception.CommitTransaction
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at net.sf.plantlore.server.HibernateDBLayer.commitTransaction(HibernateDBLayer.java:895)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at $Proxy0.commitTransaction(Unknown Source)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.commitTransaction(Login.java:550)
        at net.sf.plantlore.client.history.History$3.task(History.java:1509)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.server.HibernateDBLayer.commitTransaction(HibernateDBLayer.java:884)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at spin.Invocation.evaluate(Invocation.java:175)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at $Proxy0.commitTransaction(Unknown Source)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.commitTransaction(Login.java:550)
        at net.sf.plantlore.client.history.History$3.task(History.java:1509)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
01:41:37,562 FATAL Thread-12 server:894 - Cannot commit database transaction
01:41:37,703 DEBUG Thread-12 history:177 - Received message: STOPPING
01:41:37,718 DEBUG AWT-EventQueue-0 history:184 - Progress bar visible
01:41:37,734 DEBUG Thread-12 history:223 - ProgressBar:Stopping net.sf.plantlore.client.history.History$3 at 12efcfe
01:41:37,734  WARN Thread-12 l10n:99 - The key "Error.General" is not defined in the property file!
~~DefaultExceptionHandler~~
Exception.CommitTransaction

----- Original Message ----- 
From: Lada Oberreiterov? 
To: plantlore-dev at lists.berlios.de 
Sent: Saturday, September 02, 2006 12:49 AM
Subject: Vyjimka


Ahojte,

posilam jednu z vyjimek,na ktere jsem narazila

1. pouziji edit pro zmenu polozky napr. Herbar
2. otevru historie tohoto nalezu a dam UNDO na polozku Herbar
3. opet zedituji polozku Herbar
4. pokusim se o UNDO na tuto polozku a sleti to z nasledujici vyjimkou

Co se tyka osetreni vyjimek, tak by melo byt v historii, userM a metadataM spravne pomoci DefaultExceptionHandler a kazdy task pouziva defaultProgressBar.


Hibernate: update TOCCURRENCES set CVERSION=?, CUNITIDDB=?, CUNITVALUE=?, CHABITATID=?, CPLANTID=?, CYEARCOLLECTED=?, CMONTHCOLLECTED=?, CDAYCOLLECTED=?, CTIMECOLLECTED=?, CISODATETIMEBEGIN=?, CDATASOURCE=?, CPUBLICATIONSID=?, CHERBARIUM=?, CCREATEWHEN=?, CCREATEWHO=?, CUPDATEWHEN=?, CUPDATEWHO=?, CNOTE=?, CMETADATAID=?, CDELETE=? where CID=? and CVERSION=?
00:31:32,750 ERROR Thread-11 AbstractFlushingEventListener:300 - Could not synchronize database state with session
org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
net.sf.plantlore.common.exception.DBLayerException: Error.ConcurrentUpdate
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:343)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.server.HibernateDBLayer.executeUpdateHistory(HibernateDBLayer.java:440)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
        at java.lang.Thread.run(Thread.java:595)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
Caused by: org.hibernate.StaleObjectStateException: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
        at java.lang.reflect.Method.invoke(Method.java:585)
        at org.hibernate.persister.entity.AbstractEntityPersister.check(AbstractEntityPersister.java:1635)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2208)
        at org.hibernate.persister.entity.AbstractEntityPersister.updateOrInsert(AbstractEntityPersister.java:2118)
        at org.hibernate.persister.entity.AbstractEntityPersister.update(AbstractEntityPersister.java:2374)
        at org.hibernate.action.EntityUpdateAction.execute(EntityUpdateAction.java:91)
        at org.hibernate.engine.ActionQueue.execute(ActionQueue.java:248)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:232)
        at org.hibernate.engine.ActionQueue.executeActions(ActionQueue.java:140)
        at spin.Invocation.evaluate(Invocation.java:175)
        at org.hibernate.event.def.AbstractFlushingEventListener.performExecutions(AbstractFlushingEventListener.java:297)
        at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
        at org.hibernate.event.def.DefaultFlushEventListener.onFlush(DefaultFlushEventListener.java:27)
        at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
        at org.hibernate.impl.SessionImpl.flush(SessionImpl.java:985)
        at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
        at org.hibernate.impl.SessionImpl.managedFlush(SessionImpl.java:333)
        at $Proxy0.executeUpdateHistory(Unknown Source)
        at org.hibernate.transaction.JDBCTransaction.commit(JDBCTransaction.java:106)
        at net.sf.plantlore.client.login.Login$DBLayerProxy.executeUpdateHistory(Login.java:485)
        at net.sf.plantlore.server.HibernateDBLayer.lowLevelOperation(HibernateDBLayer.java:337)
        at net.sf.plantlore.client.history.History$3.task(History.java:1502)
        at net.sf.plantlore.common.Task$1.construct(Task.java:185)
        at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
        at java.lang.Thread.run(Thread.java:595)
00:31:32,750  WARN Thread-11 server:342 - StaleObjectStateException caught (Concurrent transactions running and trying to commit). Details: Row was updated or deleted by another transaction (or unsaved-value mapping was incorrect): [net.sf.plantlore.common.record.Occurrence#587]
00:31:32,750 ERROR Thread-11 history:1507 - Process UNDO failed. Exception caught in History. Details: Error.ConcurrentUpdate
00:31:33,109 DEBUG Thread-11 history:177 - Received message: STOPPING
00:31:33,125 DEBUG AWT-EventQueue-0 history:184 - Progress bar visible
        ... 15 more


__________ NOD32 1.1735 (20060901) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com



--------------------------------------------------------------------------------


_______________________________________________
Plantlore-dev mailing list
Plantlore-dev at lists.berlios.de
https://lists.berlios.de/mailman/listinfo/plantlore-dev


__________ NOD32 1.1735 (20060901) Information __________

This message was checked by NOD32 antivirus system.
http://www.eset.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060902/ea843423/attachment.html>

From lada at mail.berlios.de  Sat Sep  2 03:24:53 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 03:24:53 +0200
Subject: [Plantlore-dev] r626 - trunk/src/net/sf/plantlore/client/login
Message-ID: <200609020124.k821Orom020686@sheep.berlios.de>

Author: lada
Date: 2006-09-02 03:24:47 +0200 (Sat, 02 Sep 2006)
New Revision: 626

Modified:
   trunk/src/net/sf/plantlore/client/login/Login.java
Log:
Add new function executeDeleteInTransactionHistory to DBLayerProxy in Login.

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-02 01:15:22 UTC (rev 625)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-02 01:24:47 UTC (rev 626)
@@ -480,6 +480,11 @@
 			wrappedDBLayer.executeDeleteHistory(data);
 		}
 
+                synchronized public void executeDeleteInTransactionHistory(Object data) throws DBLayerException, RemoteException {
+			verifyValidity();   
+			wrappedDBLayer.executeDeleteInTransactionHistory(data);
+		}
+                
 		synchronized public void executeUpdateHistory(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
 			wrappedDBLayer.executeUpdateHistory(data);



From tkovarik at gmail.com  Sat Sep  2 04:26:28 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Sat, 2 Sep 2006 04:26:28 +0200
Subject: [Plantlore-dev] Maximalizovanie okna s helpom
Message-ID: <ea88f1620609011926p55d409b0u2a1960390f008fd1@mail.gmail.com>

No, tvrdil som sice ze to urcite pojde... ale to som uz tradicne klamal ;)

http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=4462770

Je to trosku stare, ale nenasiel som nic o tom, ze by sa to odvtedy zmenilo.


Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060902/7885f6ab/attachment.html>

From fraktalek at mail.berlios.de  Sat Sep  2 10:21:17 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 10:21:17 +0200
Subject: [Plantlore-dev] r627 - trunk/src/net/sf/plantlore/common
Message-ID: <200609020821.k828LHix031969@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 10:21:17 +0200 (Sat, 02 Sep 2006)
New Revision: 627

Modified:
   trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
Log:
JavaDoc for DocumentSizeFilter...



Modified: trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-02 01:24:47 UTC (rev 626)
+++ trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-02 08:21:17 UTC (rev 627)
@@ -13,9 +13,18 @@
 import javax.swing.text.BadLocationException;
 import javax.swing.text.DocumentFilter;
 
+
+/** Document filter that limits lenght of the text user can type, paste or maybe drag
+ * into TextComponents.
+ *
+ */
 public class DocumentSizeFilter extends DocumentFilter {
     int maxCharacters;
 
+    /** Constructs the DocumentSizeFilter.
+     *
+     * @param maxChars the text size limit to necessitate.
+     */
     public DocumentSizeFilter(int maxChars) {
         maxCharacters = maxChars;
     }



From fraktalek at mail.berlios.de  Sat Sep  2 15:03:26 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 15:03:26 +0200
Subject: [Plantlore-dev] r628 - in trunk/src/net/sf/plantlore/client: .
	overview overview/search
Message-ID: <200609021303.k82D3Qco031195@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 15:03:14 +0200 (Sat, 02 Sep 2006)
New Revision: 628

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
   trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
Log:
dded a few JavaDocs, Edit now starts using Task,
better exception handling on many places. Fix of a problem in search that appeared after the previous changes.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -892,7 +892,7 @@
                         setStatusMessage(L10n.getFormattedString("Delete.Message.ProgressInfo",deleted,toBeDeleted.size()));
                     }
                 } catch (DBLayerException ex) {
-                    database.rollbackTransaction();
+                    database.rollbackTransaction();//FIXME:
                     DBLayerException dbex = new DBLayerException("Delete rolled back. Some database problem occurred: "+ex);
                     dbex.setStackTrace(ex.getStackTrace());
                     throw dbex;
@@ -929,7 +929,7 @@
             int resId = database.executeQuery(sq);
             int resCount = database.getNumRows(resId);
             assert resCount == 1;
-            if (resCount == 0)
+            if (resCount == 0) //FIXME
                 throw new DBLayerException("The record is no longer in the database.");
             Object[] obj = database.more(resId, 0, 0);
             Object[] res = (Object[])obj[0];

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -32,9 +32,7 @@
 import java.util.Observer;
 import java.util.prefs.Preferences;
 import javax.swing.AbstractAction;
-import javax.swing.JDialog;
 import javax.swing.JFormattedTextField;
-import javax.swing.JFrame;
 import javax.swing.JOptionPane;
 import javax.swing.KeyStroke;
 import javax.swing.ListSelectionModel;
@@ -80,11 +78,9 @@
 import net.sf.plantlore.client.user.UserManager;
 import net.sf.plantlore.client.user.UserManagerCtrl;
 import net.sf.plantlore.client.user.UserManagerView;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
-import net.sf.plantlore.common.DefaultProgressBarEx;
 import net.sf.plantlore.common.DefaultReconnectDialog;
-import net.sf.plantlore.common.DefaultReconnectDialog;
-import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.ProgressBar;
@@ -92,10 +88,7 @@
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.StatusBarManager;
 import net.sf.plantlore.common.Task;
-import net.sf.plantlore.common.record.Occurrence;
 import net.sf.plantlore.common.exception.DBLayerException;
-import net.sf.plantlore.common.exception.ExportException;
-import net.sf.plantlore.common.exception.ImportException;
 import net.sf.plantlore.client.authors.AuthorManager;
 import net.sf.plantlore.client.authors.AuthorManagerCtrl;
 import net.sf.plantlore.client.authors.AuthorManagerView;
@@ -687,6 +680,11 @@
 		}
 	}
 
+        /** Action for handling edit commands.
+         *
+         * Determines the selected occurrence in overview and then invokes edit dialog
+         * on that occurrence.
+         */
 	class EditAction extends AbstractAction {
 		public EditAction() {
 			if (showButtonText)
@@ -696,7 +694,6 @@
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.EditTT"));
 			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_E,
 					ActionEvent.CTRL_MASK));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Edit"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {                    
@@ -705,37 +702,45 @@
                         return;
                     }
                         
-			Object[] row = model.getSelectedRow();
+                    final Object[] row = model.getSelectedRow();
 
-			try {
-				if (!model.isEditAllowed(model.getSelectedOccurrence())) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("AddEdit.InsufficientEditRights"), L10n
-							.getString("AddEdit.InsufficientRightsTitle"),
-							JOptionPane.INFORMATION_MESSAGE);
-					return;
-				}
-				editModel.setRecord((Integer) row[row.length - 1]);
-			} catch (DBLayerException ex) {
-				JOptionPane.showMessageDialog(view, L10n
-						.getString("Error.DBLayerException")
-						+ "\n" + ex.getErrorInfo(), L10n
-						.getString("Error.DBLayerExceptionTitle"),
-						JOptionPane.WARNING_MESSAGE);
-				logger.error(ex + ": " + ex.getErrorInfo());
-			} catch (RemoteException ex) {
-				JOptionPane.showMessageDialog(view, L10n
-						.getString("Error.RemoteException")
-						+ "\n" + ex.getMessage(), L10n
-						.getString("Error.RemoteExceptionTitle"),
-						JOptionPane.WARNING_MESSAGE);
-				logger.error(ex);
-			}
-			editView.loadComponentData();
-			editView.setVisible(true);
-		}
-	}
+                    try {
+                        if (!model.isEditAllowed(model.getSelectedOccurrence())) {
+                                JOptionPane.showMessageDialog(view, L10n
+                                                .getString("AddEdit.InsufficientEditRights"), L10n
+                                                .getString("AddEdit.InsufficientRightsTitle"),
+                                                JOptionPane.INFORMATION_MESSAGE);
+                                return;
+                        }
+                    } catch(RemoteException ex) {
+                        DefaultExceptionHandler.handle(view,ex);  
+                        return;
+                    } catch (DBLayerException ex) {
+                        DefaultExceptionHandler.handle(view,ex);                            
+                        return;
+                    }
 
+                    Task t = new Task() {
+                        public Object task() throws DBLayerException, RemoteException {
+                            setStatusMessage(L10n.getString("Overview.LoadingOccurrenceRecord"));
+                            return editModel.loadRecord((Integer) row[row.length - 1]);
+                        }
+                    };
+
+                    new DefaultProgressBar(t, view, true) {
+                        public void afterStopping() {
+                            SwingUtilities.invokeLater(new Runnable() {
+                                public void run() {
+                                    editView.loadComponentData();
+                                    editView.setVisible(true);    
+                                }
+                            });
+                        }
+                    };
+                    t.start();
+		}//actionPerformed()
+	}//EditAction
+
 	class DeleteAction extends AbstractAction {
 		public DeleteAction() {
 			if (showButtonText)
@@ -745,109 +750,71 @@
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.DeleteTT"));
 			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(
 					KeyEvent.VK_DELETE, 0));
-
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Delete"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			Selection selection = model.getTableModel().getSelection();
 			Object[] arg = { selection.values().size() };
 
+                        //Nothing checked in the overview -> tell user to check something first
 			if (arg[0].equals(0)) {
-				JOptionPane.showMessageDialog(view, L10n
-						.getString("Message.CheckAnOccurrence"), L10n
-						.getString("Message.CheckAnOccurrenceTitle"),
-						JOptionPane.INFORMATION_MESSAGE);
-				return;
+                            JOptionPane.showMessageDialog(view, 
+                                    L10n.getString("Message.CheckAnOccurrence"), 
+                                    L10n.getString("Message.CheckAnOccurrenceTitle"),
+                                    JOptionPane.INFORMATION_MESSAGE);
+                            return;
 			}
 
 			try {
-				for (Integer occId : selection.values())
-					if (!model.isEditAllowed(occId)) {
-						JOptionPane.showMessageDialog(view, L10n
-								.getString("Delete.InsufficientRights"), L10n
-								.getString("Delete.InsufficientRightsTitle"),
-								JOptionPane.INFORMATION_MESSAGE);
-						return;
-					}
+                            for (Integer occId : selection.values())
+                                    if (!model.isEditAllowed(occId)) {
+                                            JOptionPane.showMessageDialog(view, 
+                                                    L10n.getString("Delete.InsufficientRights"), 
+                                                    L10n.getString("Delete.InsufficientRightsTitle"),
+                                                    JOptionPane.INFORMATION_MESSAGE);
+                                            return;
+                                    }
 			} catch (RemoteException ex) {
-				logger.error("Remote problem: " + ex);
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "RemoteException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			} catch (DBLayerException ex) {
-				logger.error("Database problem: " + ex);
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "DBLayerException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			}
 
-			int choice = JOptionPane.showConfirmDialog(view, L10n
-					.getFormattedString("Message.DeleteRecords", arg), L10n
-					.getString("Message.DeleteRecordsTitle"),
-					JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE);
+                        int choice = JOptionPane.showConfirmDialog(view, L10n
+                                .getFormattedString("Message.DeleteRecords", arg), L10n
+                                .getString("Message.DeleteRecordsTitle"),
+                                JOptionPane.OK_CANCEL_OPTION, JOptionPane.WARNING_MESSAGE);
+                        
+                        switch (choice) {
+                            case JOptionPane.CANCEL_OPTION:
+                                return;
+                            case JOptionPane.OK_OPTION:
+                                logger.info("Deleting " + arg[0] + " records.");
+                                
+                                Task task = model.deleteSelected();
+                                
+                                ProgressBar progressBar = new DefaultProgressBar(task, view, true) {                                    
+                                    public void afterStopped(Object value) {
+                                        refreshOverview(false); // false -> do not create task,
+                                        // refresh the overview directly
+                                        // in this thread
+                                    }
+                                };                                
+                                task.start();
+                                break;
+                        }// switch
+		}//actionPerformed
+	}//DeleteAction
 
-			switch (choice) {
-			case JOptionPane.CANCEL_OPTION:
-				return;
-			case JOptionPane.OK_OPTION:
-				logger.info("Deleting " + arg[0] + " records.");
-
-				Task task = model.deleteSelected();
-
-				ProgressBar progressBar = new ProgressBar(task, view, true) {
-					public void exceptionHandler(Exception ex) {
-						if (ex instanceof DBLayerException) {
-							DBLayerException e = (DBLayerException) ex;
-							JOptionPane.showMessageDialog(view, L10n
-									.getString("Error.DBLayerException")
-									+ "\n" + e.getErrorInfo(), L10n
-									.getString("Error.DBLayerExceptionTitle"),
-									JOptionPane.WARNING_MESSAGE);
-							logger.error(e + ": " + e.getErrorInfo());
-							getTask().stop();
-							return;
-						}
-						if (ex instanceof RemoteException) {
-							RemoteException e = (RemoteException) ex;
-							JOptionPane.showMessageDialog(view, L10n
-									.getString("Error.RemoteException")
-									+ "\n" + e.getMessage(), L10n
-									.getString("Error.RemoteExceptionTitle"),
-									JOptionPane.WARNING_MESSAGE);
-							logger.error(e);
-							getTask().stop();
-							return;
-						}
-						JOptionPane
-								.showMessageDialog(
-										view,
-										L10n
-												.getString("Delete.Message.UnknownException")
-												+ "\n" + ex.getMessage(),
-										L10n
-												.getString("Delete.Message.UnkownExceptionTitle"),
-										JOptionPane.WARNING_MESSAGE);
-						logger.error(ex);
-					}
-
-					public void afterStopped(Object value) {
-						refreshOverview(false); // false -> do not create task,
-						// refresh the overview directly
-						// in this thread
-					}
-				};
-				progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
-
-				task.start();
-				break;
-			}// switch
-		}
-	}
-
+        /** Overview select all action.
+         * Selects all occurrences on current page.
+         */
 	class SelectAllAction extends AbstractAction {
 		public SelectAllAction() {
 			putValue(NAME, L10n.getString("Overview.SelectAll"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.SelectAllTT"));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.SelectAll"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
@@ -856,11 +823,13 @@
 		}
 	}
 
+        /** Overview select none action.
+         * Unselects all occurrences on current page.
+         */
 	class SelectNoneAction extends AbstractAction {
 		public SelectNoneAction() {
 			putValue(NAME, L10n.getString("Overview.SelectNone"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.SelectNoneTT"));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.SelectNone"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
@@ -869,13 +838,14 @@
 		}
 	}
 
+        /** Overview invert selected action.
+         * Inverts the selection of occurrences on current page.
+         */
 	class InvertSelectedAction extends AbstractAction {
 		public InvertSelectedAction() {
 			putValue(NAME, L10n.getString("Overview.InvertSelected"));
 			putValue(SHORT_DESCRIPTION, L10n
 					.getString("Overview.InvertSelectedTT"));
-			// putValue(MNEMONIC_KEY,
-			// L10n.getMnemonic("Overview.InvertSelected"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
@@ -884,82 +854,81 @@
 		}
 	}
 
+        /** Handles the overview's Search action.
+         */
 	class SearchAction extends AbstractAction {
 		public SearchAction() {
 			if (showButtonText)
 				putValue(NAME, L10n.getString("Overview.Search"));
-			putValue(SMALL_ICON, Resource
-					.createIcon("/toolbarButtonGraphics/general/Search24.gif"));
+			putValue(SMALL_ICON, Resource.createIcon("/toolbarButtonGraphics/general/Search24.gif"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.SearchTT"));
-			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_S,
-					ActionEvent.CTRL_MASK));
-
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Search"));
+			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_S,ActionEvent.CTRL_MASK));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			searchModel.clear();
-			searchView.setVisible(true);
-		}
-	}
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                searchView.setVisible(true);
+                            }
+                        });
+		}//actionPerformed
+	}//SearchAction
 
+        /** Handles the invoking of habitat tree from overview.
+         *
+         */
 	class HabitatTreeAction extends AbstractAction {
 		public HabitatTreeAction() {
 			if (showButtonText)
 				putValue(NAME, L10n.getString("Overview.HabitatTree"));
 			putValue(SMALL_ICON, Resource.createIcon("/toolbarButtonGraphics/development/Application24.gif"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.HabitatTreeTT"));
-			//putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_S,
-			//		ActionEvent.CTRL_MASK));
-
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Search"));
+			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_T,ActionEvent.CTRL_MASK));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
                         habitatTreeModel.setDBLayer(model.getDatabase());
                         try {
                             habitatTreeModel.loadData();
-                            habitatTreeView.setVisible(true);
-                        } catch (Exception ex) {
-                            if (ex instanceof DBLayerException || ex instanceof RemoteException) {
-                                DefaultReconnectDialog.show(view,ex);
-                            } else {
-                                logger.error("Exception: "+ex);
-                                ex.printStackTrace(); //FIXME
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
+                        } catch (DBLayerException ex) {
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
+                        }
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                habitatTreeView.setVisible(true);
                             }
-                        }
-		}
-	}
+                        });
+		}//actionPerformed
+	}// HabitatTreeAction
 
+        /** Bridge that informs overview about a new query.
+         *
+         */
 	class SearchBridge implements Observer {
 		public void update(Observable o, Object arg) {
-			if (arg != null && arg instanceof Integer) {
-				logger.debug("Fetching new result id from Search model. Storing it to AppCore model.");
-				try {
-					model.setResultId(searchModel.getNewResultId(), searchModel
-							.getNewSelectQuery());
-				} catch (RemoteException ex) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("Error.RemoteException")
-							+ "\n" + ex.getMessage(), L10n
-							.getString("Error.RemoteExceptionTitle"),
-							JOptionPane.WARNING_MESSAGE);
-					logger.error(ex);
-				} catch (DBLayerException ex) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("Error.DBLayerException")
-							+ "\n" + ex.getErrorInfo(), L10n
-							.getString("Error.DBLayerExceptionTitle"),
-							JOptionPane.WARNING_MESSAGE);
-					logger.error(ex + ": " + ex.getErrorInfo());
-				}
-				// model.setExportQuery(searchModel.getExportQuery(), false,
-				// Occurrence.class);
-			}
-		}
-
-	}
+                    if (arg != null && arg instanceof Integer) {
+                        logger.debug("Fetching new result id from Search model. Storing it to AppCore model.");
+                        try {
+                            model.setResultId(searchModel.getNewResultId(), searchModel.getNewSelectQuery());
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
+                        } catch (DBLayerException ex) {
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
+                        }
+                    }
+		}//update()
+	}//SearchBridge
         
+        /** Bridge from HabitatTree to overview, search and add.
+         *
+         */
         class HabitatTreeBridge implements Observer {
             public void update(Observable o, Object arg) {
                 if (arg != null && arg instanceof Pair) {                    
@@ -979,60 +948,60 @@
                     if (message.equals("ADD")) {
 			try {
 				if (model.getDatabase().getUserRights().getAdd() != 1) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("AddEdit.InsufficientAddRights"), L10n
-							.getString("AddEdit.InsufficientRightsTitle"),
-							JOptionPane.INFORMATION_MESSAGE);
+					JOptionPane.showMessageDialog(view, 
+                                                L10n.getString("AddEdit.InsufficientAddRights"), 
+                                                L10n.getString("AddEdit.InsufficientRightsTitle"),
+                                                JOptionPane.INFORMATION_MESSAGE);
 					return;
 				}
 			} catch (RemoteException ex) {
-                            DefaultReconnectDialog.show(view,ex);
-                            logger.error(ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			}
 			addModel.clear();
                         try {
                             addModel.setHabitat(nodeInfo.getId());
                         } catch (RemoteException ex) {
-                            DefaultReconnectDialog.show(view,ex);
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
                         } catch (DBLayerException ex) {
-                            DefaultReconnectDialog.show(view,ex);
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
                         }
-                        addView.loadComponentData();
-			addView.setVisible(true);         
-//                        habitatTreeView.setVisible(false);
+                        SwingUtilities.invokeLater( new Runnable() {
+                            public void run() {
+                                addView.loadComponentData();
+                                addView.setVisible(true);   
+                            }
+                        });//invokeLater
                     }//if ADD
                 }//if
             }//update
         }//class HabitatTreeBridge
 
+        /** Handles the overview scheda action.
+         *
+         */
 	class SchedaAction extends AbstractAction {
 		public SchedaAction() {
 			putValue(NAME, L10n.getString("Overview.Scheda"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.SchedaTT"));
-			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_X,
-					ActionEvent.CTRL_MASK));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Scheda"));
-			putValue(
-					SMALL_ICON,
-					Resource
-							.createIcon("/toolbarButtonGraphics/general/ComposeMail24.gif"));
+			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_X,	ActionEvent.CTRL_MASK));
+			putValue(SMALL_ICON,Resource.createIcon("/toolbarButtonGraphics/general/ComposeMail24.gif"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			try {
 				if (model.getTableModel().getSelection().values().size() < 1) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("Message.CheckAnOccurrence"), L10n
-							.getString("Message.CheckAnOccurrenceTitle"),
+					JOptionPane.showMessageDialog(view, 
+                                                L10n.getString("Message.CheckAnOccurrence"), 
+                                                L10n.getString("Message.CheckAnOccurrenceTitle"),
 							JOptionPane.INFORMATION_MESSAGE);
 					return;
 				}
 
 				final JasperReport schedaReport;
-				InputStream schedaIs = this
-						.getClass()
-						.getClassLoader()
-						.getResourceAsStream(
+				InputStream schedaIs = this.getClass().getClassLoader().getResourceAsStream(
 								"net/sf/plantlore/client/resources/SchedaA6.jasper");
 
 				try {
@@ -1092,21 +1061,15 @@
 
 				ProgressBar pb = new ProgressBar(task, view, true) {
 					public void exceptionHandler(final Exception ex) {
-						logger
-								.error("Error while filling jasper report in SchedaAction: "
-										+ ex);
+						logger.error("Error while filling jasper report in SchedaAction: "+ ex);
 						ex.printStackTrace();
 						SwingUtilities.invokeLater(new Runnable() {
 							public void run() {
-								JOptionPane
-										.showMessageDialog(
-												view.getParent(),
-												L10n
-														.getString("Print.Message.BrokenReport")
+								JOptionPane.showMessageDialog(view.getParent(),
+											L10n.getString("Print.Message.BrokenReport")
 														+ "\n"
 														+ ex.getMessage(),
-												L10n
-														.getString("Print.Message.BrokenReport"),
+											L10n.getString("Print.Message.BrokenReport"),
 												JOptionPane.WARNING_MESSAGE);
 							}
 						});
@@ -1122,10 +1085,8 @@
 						});
 					}
 				};
-				pb.setTitle(L10n.getString("Scheda.ProgressTitle"));
-
 				task.start();
-			} catch (Exception ex) { // Unreachable CATCH block
+			} catch (Exception ex) { 
 				logger.error("Broken report: " + ex);
 				JOptionPane.showMessageDialog(view, L10n
 						.getString("Print.Message.BrokenReport")
@@ -1137,46 +1098,49 @@
 		}
 	}
 
+        /** Handles the previous page overview action */
 	class PreviousPageAction extends AbstractAction {
 		public PreviousPageAction() {
 			putValue(NAME, L10n.getString("Overview.PrevPage"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.PrevPageTT"));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.PrevPage"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			try {
 				model.prevPage();
 			} catch (RemoteException ex) {
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "RemoteException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			} catch (DBLayerException ex) {
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "DBLayerException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			}
 		}
 	}
 
+        /** Handles the next page overview action */        
 	class NextPageAction extends AbstractAction {
 		public NextPageAction() {
 			putValue(NAME, L10n.getString("Overview.NextPage"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.NextPageTT"));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.NextPage"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			try {
 				model.nextPage();
 			} catch (RemoteException ex) {
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "RemoteException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			} catch (DBLayerException ex) {
-				ex.printStackTrace();
-				JOptionPane.showMessageDialog(view, "DBLayerException: " + ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			}
 		}
 	}
 
+        /** Window closing listener.
+         * Saves preferences on that event.
+         */
 	class AppWindowListener extends WindowAdapter {
 		public void windowClosing(WindowEvent e) {
 			try {
@@ -1185,40 +1149,42 @@
 				
 				model.savePreferences();
 			} catch (IOException ex) {
-				JOptionPane.showMessageDialog(view,
-						"Problem while saving configuration: "
+				JOptionPane.showMessageDialog(view,L10n.getString("Overview.ProblemSavingPreferences")+": "
 								+ ex.getMessage());
 			}
 		}
 	}
 
+        /** Handles author manager action invoked from overview. */
 	class DataAuthorsAction extends AbstractAction {
 		public DataAuthorsAction() {
 			putValue(NAME, L10n.getString("Overview.MenuDataAuthors"));
-			putValue(SHORT_DESCRIPTION, L10n
-					.getString("Overview.MenuDataAuthorsTT"));
+			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.MenuDataAuthorsTT"));
 			putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.MenuDataAuthors"));
 		}
 
 		public void actionPerformed(ActionEvent e) {
 			AuthorManager authModel = new AuthorManager(model.getDatabase());
-			AuthorManagerView authView = new AuthorManagerView(authModel, view,
+			final AuthorManagerView authView = new AuthorManagerView(authModel, view,
 					true);
 			AuthorManagerCtrl authCtrl = new AuthorManagerCtrl(authModel,
 					authView);
 			authModel.addObserver(managerBridge);
-			authView.setVisible(true);
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                authView.setVisible(true);
+                            }
+                        });
 		}
 
 	}
 
+        /** Handles publication manager action invoked from overview. */
 	class DataPublicationsAction extends AbstractAction {
 		public DataPublicationsAction() {
 			putValue(NAME, L10n.getString("Overview.MenuDataPublications"));
-			putValue(SHORT_DESCRIPTION, L10n
-					.getString("Overview.MenuDataPublicationsTT"));
-			putValue(MNEMONIC_KEY, L10n
-					.getMnemonic("Overview.MenuDataPublications"));
+			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.MenuDataPublicationsTT"));
+			putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.MenuDataPublications"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
@@ -1229,17 +1195,22 @@
 			publicationManagerCtrl = new PublicationManagerCtrl(
 					publicationManagerModel, publicationManagerView);
 			publicationManagerModel.addObserver(managerBridge);
-			publicationManagerView.setVisible(true);
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                publicationManagerView.setVisible(true);
+                            }
+                        });
 		}
 	}
 
+        /** Handles user manager action invoked from overview. */        
 	class DataUserAction extends AbstractAction {
 		public DataUserAction() {
 			putValue(NAME, L10n.getString("userManager"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			System.out.println("UserManager");
+			logger.info("Starting UserManager");
 
 			if (userManagerModel == null) {
 				userManagerModel = new UserManager(model.getDatabase());
@@ -1253,13 +1224,18 @@
 					if (! userManagerModel.isFinishedTask()) return;
 					userManagerModel.setInfoFinishedTask(false);
 					userManagerCtrl.reloadData(1, UserManager.DEFAULT_DISPLAY_ROWS);
-					userManagerView.setVisible(true);						
+                                        SwingUtilities.invokeLater(new Runnable() {
+                                            public void run() {
+                                                userManagerView.setVisible(true);	
+                                            }
+                                        });
 	 	    	}
 			};			
 			task.start();					
 		}
 	}
-
+        
+        /** Handles history action invoked from overview. */
 	class DataHistoryAction extends AbstractAction {
 		public DataHistoryAction() {
 			if (showButtonText)
@@ -1267,9 +1243,6 @@
 			putValue(SMALL_ICON, Resource
 					.createIcon("/toolbarButtonGraphics/general/History24.gif"));
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.HistoryTT"));
-			// putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_S,
-			// ActionEvent.CTRL_MASK));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.History"));
 		}
 
 		public void actionPerformed(ActionEvent e) {
@@ -1292,24 +1265,29 @@
 	 	    	public void afterStopping() {
 					if (! historyModel.isFinishedTask()) return;
 					historyModel.setInfoFinishedTask(false);
-					historyView.setVisible(true);						
+                                        SwingUtilities.invokeLater(new Runnable() {
+                                            public void run() {
+                                                historyView.setVisible(true);		
+                                            }
+                                        });
 	 	    	}				
 			};			
 			task.start();							
 		}
 	}
 
+        /** Handles the whole history action invoked from overview. */
 	class DataWholeHistoryAction extends AbstractAction {
 		public DataWholeHistoryAction() {
 			putValue(NAME, L10n.getString("wholeHistory"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			System.out.println("Whole history");
+			logger.info("Starting Whole history");
 
 			if (wholeHistoryModel == null) {
 				wholeHistoryModel = new History(model.getDatabase());				
-			    wholeHistoryView = new WholeHistoryView(wholeHistoryModel, view,true);
+                                wholeHistoryView = new WholeHistoryView(wholeHistoryModel, view,true);
 				wholeHistoryCtrl = new WholeHistoryCtrl(wholeHistoryModel, wholeHistoryView);
 				wholeHistoryModel.addObserver(managerBridge);
 			}
@@ -1319,13 +1297,18 @@
 	 	    	public void afterStopping() {	
 					if (! wholeHistoryModel.isFinishedTask()) return;
 					wholeHistoryModel.setInfoFinishedTask(false);
-					wholeHistoryView.setVisible(true);
+                                        SwingUtilities.invokeLater( new Runnable() {
+                                            public void run() {
+                                                wholeHistoryView.setVisible(true);
+                                            }
+                                        });
 	 	    	}
 			};			
 			task.start();							
 		}
 	}
 	
+        /** Handles metadata manager action invoked from overview. */
 	class DataMetadataAction extends AbstractAction {
 		public DataMetadataAction() {
 			putValue(NAME, L10n.getString("metadataManager"));
@@ -1349,13 +1332,18 @@
 					if (! metadataManagerModel.isFinishedTask()) return;
 					metadataManagerModel.setInfoFinishedTask(false);
 					metadataManagerCtrl.reloadData(1, MetadataManager.DEFAULT_DISPLAY_ROWS);
-					metadataManagerView.setVisible(true);
+                                        SwingUtilities.invokeLater(new Runnable() {
+                                            public void run() {
+                                                metadataManagerView.setVisible(true);
+                                            }
+                                        });
 	 	    	}
 			};			
 			task.start();						
 		}
 	}
 
+        /** Handles changes of the page size invoked from overview. */
 	class RecordsPerPagePropertyChangeListener implements
 			PropertyChangeListener {
 		public void propertyChange(PropertyChangeEvent e) {
@@ -1366,8 +1354,8 @@
 					JOptionPane.showMessageDialog(view, L10n
 							.getString("Overview.Warning.MaxRecordsPerPage")
 							+ " " + MAX_RECORDS_PER_PAGE);
-					Object obj = e.getOldValue();
-					if (obj != null)
+					Object obj = e.getOldValue();                                        
+					if (obj != null) 
 						tf.setValue(obj);
 					else
 						// either multiple properties changed or there was no
@@ -1390,19 +1378,18 @@
 					try {
 						model.setRecordsPerPage(i);
 					} catch (RemoteException ex) {
-						JOptionPane.showMessageDialog(view, "RemoteException: "
-								+ ex);
-						ex.printStackTrace();
+                                            DefaultExceptionHandler.handle(view, ex);
+                                            return;
 					} catch (DBLayerException ex) {
-						JOptionPane.showMessageDialog(view,
-								"DBLayerException: " + ex);
-						ex.printStackTrace();
+                                            DefaultExceptionHandler.handle(view, ex);
+                                            return;
 					}
 				}
 			}
 		}
 	}
 
+        /** Keeps track of selected row in overview. */
 	class OverviewSelectionListener implements ListSelectionListener {
 		public void valueChanged(ListSelectionEvent e) {
 			// Ignore extra messages.
@@ -1420,6 +1407,7 @@
 		}
 	}
 
+        /** Handles double clicks in overview to invoke the Detail. */
 	class OverviewMouseListener implements MouseListener {
 		public void mouseClicked(MouseEvent e) {
 			if (e.getClickCount() >= 2)
@@ -1427,22 +1415,24 @@
 					int resultNumber = model.getSelectedResultNumber();
                                         if (resultNumber > model.getResultsCount()) {
                                             logger.error("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
-                                            JOptionPane.showMessageDialog(view,"The connection has been probably lost.");
+                                            JOptionPane.showMessageDialog(view,L10n.getString("Error.LostConnection"));
                                             return;
                                         }
                                         
 					if (resultNumber != model.getResultsCount())
 						model.selectAndShow(resultNumber);
 					detailModel.load(model.getSelectedResultNumber());
-					detailView.setVisible(true);
-				} catch (RemoteException ex) {//FIXME
-					JOptionPane.showMessageDialog(view, "RemoteException: "
-							+ ex);
-					ex.printStackTrace();
+                                        SwingUtilities.invokeLater( new Runnable() {
+                                            public void run() {
+                                                detailView.setVisible(true);
+                                            }
+                                        });
+				} catch (RemoteException ex) {
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				} catch (DBLayerException ex) {
-					JOptionPane.showMessageDialog(view, "DBLayerException: "
-							+ ex);
-					ex.printStackTrace();
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				}
 		}
 
@@ -1460,6 +1450,7 @@
 
 	}
 
+        /** Listnes to the enter key pressed in overview and invokes Detail. */
 	class OverviewKeyListener implements KeyListener {
 		public void keyTyped(KeyEvent e) {
 			if (e.getKeyText(e.getKeyChar()).equals("Space"))
@@ -1483,15 +1474,17 @@
 					// we need to
 					// correct that
 					detailModel.load(model.getSelectedResultNumber());
-					detailView.setVisible(true);
+                                        SwingUtilities.invokeLater( new Runnable() {
+                                            public void run() {
+                                                detailView.setVisible(true);
+                                            }
+                                        });
 				} catch (RemoteException ex) {
-					JOptionPane.showMessageDialog(view, "RemoteException: "
-							+ ex);
-					ex.printStackTrace();
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				} catch (DBLayerException ex) {
-					JOptionPane.showMessageDialog(view, "DBLayerException: "
-							+ ex);
-					ex.printStackTrace();
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				}
 			}
 		}
@@ -1505,6 +1498,7 @@
 
 	}
 
+        /** Handles the login action. */
 	class LoginAction extends AbstractAction {
 		public LoginAction() {
 			putValue(NAME, L10n.getString("Overview.MenuFileLogin"));
@@ -1539,7 +1533,7 @@
 				newDBView = new CreateDBView(view, newDBModel);
 				newDBCtrl = new CreateDBCtrl(newDBModel, newDBView);
 			}
-	    	view.setVisible(true);
+                        view.setVisible(true);
 		}
 	}
 
@@ -1568,13 +1562,17 @@
 			 * etc.)
 			 */
 
-			setDatabaseDependentCommandsEnabled(false);
+                        SwingUtilities.invokeLater( new Runnable() {
+                            public void run() {
+                                setDatabaseDependentCommandsEnabled(false);
+                            }
+                        });
 		}
 
 	}
 
 	
-	
+	/** Handles the reconnect action invoked from overview. */
 	public class ReconnectAction extends AbstractAction {
 
 		private Component parent = view;
@@ -1613,8 +1611,10 @@
 	}
 	
 
-	// Update all information about the database layer and inform everyone who
-	// has to be informed
+	/** Bridge from login / reconnect(?) to the rest of the application.
+         * Updates all information about the database layer and informs everyone who
+	 * has to be informed.
+         */
 	class DatabaseChange implements Observer {
 		/**
 		 * Fetches combobox items from AppCore and stores them to dialog models.
@@ -1661,56 +1661,52 @@
 			searchModel.setTerritories(model.getTerritories());
 		}
 
-		public void update(Observable targer, Object parameter) {
-			if (parameter != null && parameter instanceof DBLayer) {
-				loginAction.setEnabled(false);
-				view.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+		public void update(final Observable targer, final Object parameter) {
+                    SwingUtilities.invokeLater( new Runnable() {
+                        public void run() {
+                            if (parameter != null && parameter instanceof DBLayer) {
+                                    loginAction.setEnabled(false);
+                                    view.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
 
-				logger.debug("Database layer retrieval.");
-				DBLayer dblayer = loginModel.getDBLayer();
+                                    logger.debug("Database layer retrieval.");
+                                    DBLayer dblayer = loginModel.getDBLayer();
 
-				// FIXME: neni potreba zresetovat stav treba loginModelu, pokdu
-				// neco takhle selze? pripadne stav jinyho objektu?
-				try {
-					model.setDatabase(dblayer);
-				} catch (RemoteException ex) {
-                                    logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
-                                    ex.printStackTrace();
-                                    DefaultReconnectDialog.show(view,ex);
-                                    return;
-				} catch (DBLayerException ex) {
-                                    logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
-                                    ex.printStackTrace();
-                                    DefaultReconnectDialog.show(view,ex);
-                                    return;
-				}
-				// distribute database to dialogs
-				addModel.setDatabase(dblayer);
-				editModel.setDatabase(dblayer);
-				searchModel.setDatabase(dblayer);
-				detailModel.setDatabase(dblayer);
+                                    // FIXME: neni potreba zresetovat stav treba loginModelu, pokdu
+                                    // neco takhle selze? pripadne stav jinyho objektu?
+                                    try {
+                                            model.setDatabase(dblayer);
+                                    } catch (RemoteException ex) {
+                                        logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
+                                        ex.printStackTrace();
+                                        DefaultReconnectDialog.show(view,ex);
+                                        return;
+                                    } catch (DBLayerException ex) {
+                                        logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
+                                        ex.printStackTrace();
+                                        DefaultReconnectDialog.show(view,ex);
+                                        return;
+                                    }
+                                    // distribute database to dialogs
+                                    addModel.setDatabase(dblayer);
+                                    editModel.setDatabase(dblayer);
+                                    searchModel.setDatabase(dblayer);
+                                    detailModel.setDatabase(dblayer);
 
-				model.setAccessRights(loginModel.getAccessRights());
-				model.login();
+                                    model.setAccessRights(loginModel.getAccessRights());
+                                    model.login();
 
-				view.getSBM().display(L10n.getString("Message.FillingDialogs"));
-				fillDialogModels();
+                                    view.getSBM().display(L10n.getString("Message.FillingDialogs"));
+                                    fillDialogModels();
 
-				view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
-				searchModel.clear();
-				searchModel.constructQuery();
-				view.getSBM().displayDefaultText();
+                                    view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
+                                    searchModel.clear();
+                                    searchModel.constructQuery();
 
-				view.initOverview();
-				view.setCursor(Cursor.getDefaultCursor());
-				setDatabaseDependentCommandsEnabled(true);
-				
-                                
-                                //this can't be done earlier. must be done after the query is created
-                                //otherwise this listener would give the overview table model commands to load data
-                                //for a query that doesn't exist yet
-                                view.overviewScrollPane.addComponentListener(overviewResizeListener);
+                                    view.getSBM().displayDefaultText();
 
+                                    view.initOverview();
+                                    view.setCursor(Cursor.getDefaultCursor());
+                                    setDatabaseDependentCommandsEnabled(true);
 				/*-------------------------------------------------------------------
 				 *  This may no longer be necessary:
 				 *------------------------------------------------------------------*/
@@ -1741,6 +1737,46 @@
 	}
 
 
+                                    //this can't be done earlier. must be done after the query is created
+                                    //otherwise this listener would give the overview table model commands to load data
+                                    //for a query that doesn't exist yet
+                                    view.overviewScrollPane.addComponentListener(overviewResizeListener);
+
+                                    /*-------------------------------------------------------------------
+                                     *  This may no longer be necessary:
+                                     *------------------------------------------------------------------*/
+                    logger.debug("Distributing the new database layer to:");
+                    logger.debug(" # export ");
+                                    if( exportModel != null )
+                                            exportModel.setDBLayer( dblayer );
+                                    logger.debug(" # occurrence data import ");
+                                    if( importModel != null )
+                                            importModel.setDBLayer( dblayer );
+                                    logger.debug(" # table data import ");
+                                    if( tableImportModel != null )
+                                            tableImportModel.setDBLayer( dblayer );
+                                    logger.debug(" # record history ");
+                                    if (historyModel != null ) 
+                                            historyModel.setDBLayer( dblayer );
+                                    logger.debug(" # complete history ");
+                                    if (wholeHistoryModel != null ) 
+                                            wholeHistoryModel.setDBLayer( dblayer );
+                                    logger.debug(" # user manager ");
+                                    if (userManagerModel != null )
+                                            userManagerModel.setDBLayer( dblayer );
+                                    logger.debug(" # metadata manager ");
+                                    if (metadataManagerModel != null )
+                                            metadataManagerModel.setDBLayer( dblayer );							
+                            }//if
+                        }//run()
+                    });//invokeLater
+		}//update()
+	}//DatabaseChange
+
+
+        /** Helper class to refresh overview or to create a task that refreshes overview.
+         *
+         */
 	private Task refreshOverview(boolean createTask) {
 		if (createTask) {
 			Task task = new Task() {
@@ -1760,6 +1796,7 @@
 		}
 	}
 
+        /** Handles the refresh action invoked from overview. */
 	class RefreshAction extends AbstractAction {
 		public RefreshAction() {
 			if (showButtonText)
@@ -1769,21 +1806,19 @@
 			putValue(SHORT_DESCRIPTION, L10n.getString("Overview.RefreshTT"));
 			putValue(ACCELERATOR_KEY, KeyStroke.getKeyStroke(KeyEvent.VK_R,
 					ActionEvent.CTRL_MASK));
-			// putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.Refresh"));
 		}
 
 		public void actionPerformed(ActionEvent e) {
 			// e can be null !!! - we call actionPerformed(null) in DeleteAction
 			Task task = refreshOverview(true);
 			ProgressBar progressBar = new DefaultProgressBar(task, view, true);
-			progressBar.setTitle(L10n.getString("Overview.Refresh.ProgressTitle"));
 
 			task.start();
 		}
 
 	}
 
-	/**
+	/** Bridge between mostly managers and the rest of the application. 
 	 * Propagates changes made in managers to the rest of the application.
 	 * 
 	 */
@@ -1873,24 +1908,20 @@
 						}// switch table
 					}// for
 				} catch (DBLayerException ex) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("Error.DBLayerException")
-							+ "\n" + ex.getErrorInfo(), L10n
-							.getString("Error.DBLayerExceptionTitle"),
-							JOptionPane.WARNING_MESSAGE);
-					logger.error(ex + ": " + ex.getErrorInfo());
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				} catch (RemoteException ex) {
-					JOptionPane.showMessageDialog(view, L10n
-							.getString("Error.RemoteException")
-							+ "\n" + ex.getMessage(), L10n
-							.getString("Error.RemoteExceptionTitle"),
-							JOptionPane.WARNING_MESSAGE);
-					logger.error(ex);
+                                    DefaultExceptionHandler.handle(view,ex);
+                                    return;
 				}
 			}// if arg instanceof Table[]
 		}// update()
 	}// class ManagerBridge
 
+        /** Handles resizing of Plantlore's main window.
+         *
+         * Computes and changes the page size if needed.
+         */
 	class OverviewResizeListener implements ComponentListener {
 		private final static int sub = 20; // height of the header row perhaps
 
@@ -1906,12 +1937,12 @@
 			try {
 				model.setRecordsPerPage(newRecordsCount);
 				view.recordsPerPage.setValue(newRecordsCount);
-			} catch (RemoteException ex) {
-				JOptionPane.showMessageDialog(view, "RemoteException: " + ex);
-				ex.printStackTrace();
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
 			} catch (DBLayerException ex) {
-				JOptionPane.showMessageDialog(view, "DBLayerException: " + ex);
-				ex.printStackTrace();
+                            DefaultExceptionHandler.handle(view,ex);
+                            return;
 			}
 		}
 

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-02 13:03:14 UTC (rev 628)
@@ -512,7 +512,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="1" pref="172" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="1" pref="136" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -15,6 +15,7 @@
 import javax.swing.AbstractAction;
 import javax.swing.Action;
 import javax.swing.ListSelectionModel;
+import javax.swing.SwingUtilities;
 import javax.swing.event.ListSelectionListener;
 import javax.swing.table.TableColumn;
 import net.sf.plantlore.client.overview.*;
@@ -422,42 +423,46 @@
         });
     }
 
-    public void update(Observable observable, Object object) {
-        if (object != null && object instanceof String) {
-            String arg = (String) object;
-            if (arg.equals("PAGE_CHANGED")||arg.equals("RECORDS_PER_PAGE")) {
-                recordsCount.setText(""+model.getResultsCount());
-                pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount());
-                //FIXME: change selection only if really required
-                overview.changeSelection(model.getSelectedRowNumber(),0,false,false);
-                return;
-            }
-            if (arg.equals("NEW_QUERY")) {
-                //setPreferredColumnSizes();
-                overview.setEnabled(true);
-                overview.setVisible(true);
-                recordsCount.setText(""+model.getResultsCount());
-                pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount()); 
-                overview.getSelectionModel().setSelectionInterval(0,0);
-                return;
-            }
-            if (arg.equals("LOADING_NEW_DATA")) {
-                //TableSorter and OverviewTable model threw exceptions while loading data
-                //because they were trying to display data in possibly inconsistent state
-                //I hope that I've fixed it at least in OverviewTableModel where data are now
-                //loaded into a new variable and then put in place of the working data at one point
-                //
-                //However now I noticed a NullPointerException from TableSorter, which is not my work
-                //and I don't want to study it now, so we'll try to ensure that overview doesn't ask
-                //for any data during the loading:
-                overview.setVisible(false);
-                overview.setEnabled(false);
-            }
-            if (arg.equals("SELECTION_CHANGED")) {
-                overview.getSelectionModel().setSelectionInterval(model.getSelectedRowNumber(),model.getSelectedRowNumber());
-            }
-        }        
-    }
+    public void update(final Observable observable, final Object object) {
+        SwingUtilities.invokeLater( new Runnable() {
+            public void run() {
+                if (object != null && object instanceof String) {
+                    String arg = (String) object;
+                    if (arg.equals("PAGE_CHANGED")||arg.equals("RECORDS_PER_PAGE")) {
+                        recordsCount.setText(""+model.getResultsCount());
+                        pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount());
+                        //FIXME: change selection only if really required
+                        overview.changeSelection(model.getSelectedRowNumber(),0,false,false);
+                        return;
+                    }
+                    if (arg.equals("NEW_QUERY")) {
+                        //setPreferredColumnSizes();
+                        overview.setEnabled(true);
+                        overview.setVisible(true);
+                        recordsCount.setText(""+model.getResultsCount());
+                        pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount()); 
+                        overview.getSelectionModel().setSelectionInterval(0,0);
+                        return;
+                    }
+                    if (arg.equals("LOADING_NEW_DATA")) {
+                        //TableSorter and OverviewTable model threw exceptions while loading data
+                        //because they were trying to display data in possibly inconsistent state
+                        //I hope that I've fixed it at least in OverviewTableModel where data are now
+                        //loaded into a new variable and then put in place of the working data at one point
+                        //
+                        //However now I noticed a NullPointerException from TableSorter, which is not my work
+                        //and I don't want to study it now, so we'll try to ensure that overview doesn't ask
+                        //for any data during the loading:
+                        overview.setVisible(false);
+                        overview.setEnabled(false);
+                    }
+                    if (arg.equals("SELECTION_CHANGED")) {
+                        overview.getSelectionModel().setSelectionInterval(model.getSelectedRowNumber(),model.getSelectedRowNumber());
+                    }
+                }//if instanceof String        
+            }//run()
+        });//invokeLater()
+    }//update()
 
     private void setPreferredColumnSizes() {
         OverviewTableModel otm = model.getTableModel();

Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -180,7 +180,7 @@
      * @return >=0 if everything was OK
      * @return -1 if the Occurrence table overflew
      */
-    public int setRecord(Integer occurrenceId) throws DBLayerException, RemoteException {
+    public int loadRecord(Integer occurrenceId) throws DBLayerException, RemoteException {
         logger.debug("Loading AddEdit data for occurrence id "+occurrenceId);
         
         clearOccurrence();

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -15,29 +15,19 @@
 import java.awt.event.ActionListener;
 import java.awt.event.FocusEvent;
 import java.awt.event.FocusListener;
-import java.awt.event.ItemEvent;
-import java.awt.event.ItemListener;
-import java.awt.event.MouseAdapter;
-import java.awt.event.MouseEvent;
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
 import java.text.DateFormat;
-import java.text.MessageFormat;
 import java.text.NumberFormat;
 import java.text.ParseException;
 import java.util.ArrayList;
 import java.util.Calendar;
 import java.util.Date;
-import java.util.Locale;
 
 import javax.swing.AbstractAction;
-import javax.swing.DefaultCellEditor;
-import javax.swing.JButton;
-import javax.swing.JCheckBox;
 import javax.swing.JComboBox;
 import javax.swing.JDialog;
-import javax.swing.JFormattedTextField;
 import javax.swing.JOptionPane;
 import javax.swing.JSpinner;
 import javax.swing.JTextArea;
@@ -46,24 +36,20 @@
 import javax.swing.event.ChangeListener;
 import javax.swing.event.DocumentEvent;
 import javax.swing.event.DocumentListener;
-import javax.swing.table.TableColumn;
 import javax.swing.text.BadLocationException;
 import com.toedter.calendar.JCalendar;
-import net.sf.plantlore.client.*;
+import org.apache.log4j.Logger;
 
 import net.sf.plantlore.client.checklist.ChecklistCtrl;
 import net.sf.plantlore.client.checklist.ChecklistView;
-import net.sf.plantlore.common.AutoComboBox;
 import net.sf.plantlore.common.AutoComboBoxNG3;
 import net.sf.plantlore.common.AutoTextArea;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Pair;
-import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.Occurrence;
 import net.sf.plantlore.l10n.L10n;
-import org.apache.log4j.Logger;
 
 /**
  *

Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -205,11 +205,22 @@
     public void setPhytName(Pair<String, Integer> phytName) {
         if (phytName == null)
             return;
+        
         if (skipUpdate) {
             skipUpdate = false;
             logger.debug("Skipping setPhytName");
             return;
         }
+
+        if (phytName.equals(EMPTY_PAIR)) {
+            this.phytCode = EMPTY_PAIR;
+            this.phytName = EMPTY_PAIR;
+            skipUpdate = true;
+            setChanged();
+            notifyObservers(new Pair<String,Integer>("updateCode",-1));
+            return;
+        }
+            
         this.phytName = phytName;
         if (phytCodes != null)
             for (int i=0; i < phytCodes.length; i++) {
@@ -234,12 +245,22 @@
     public void setPhytCode(Pair<String, Integer> phytCode) {
         if (phytCode == null)
             return;
-        
+            
         if (skipUpdate) {
             skipUpdate = false;
             logger.debug("Skipping setPhytCode");
             return;
         }
+
+        if (phytCode.equals(EMPTY_PAIR)) {
+            this.phytName = EMPTY_PAIR;
+            this.phytCode = EMPTY_PAIR;
+            skipUpdate = true;
+            setChanged();
+            notifyObservers(new Pair<String,Integer>("updateName",-1));
+            return;
+        }
+            
         this.phytCode = phytCode;
         if (phytNames != null)
             for (int i=0; i < phytNames.length; i++) {

Modified: trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-02 08:21:17 UTC (rev 627)
+++ trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-02 13:03:14 UTC (rev 628)
@@ -13,6 +13,7 @@
 import javax.swing.DefaultComboBoxModel;
 import javax.swing.JComboBox;
 import javax.swing.JDialog;
+import javax.swing.SwingUtilities;
 import javax.swing.event.PopupMenuEvent;
 import javax.swing.event.PopupMenuListener;
 import javax.swing.table.TableColumn;
@@ -841,165 +842,176 @@
         });
     }
 
-    public void update(Observable o, Object arg) {
-        if (arg != null && arg instanceof Pair) {
-            String s = ((Pair<String,Integer>)arg).getFirst();
-            int row = ((Pair<String,Integer>)arg).getSecond(); 
-            if (s.equals("updateCode"))
-                phytCodeCombo.setSelectedItem(model.getPhytCode());
-            if (s.equals("updateName"))
-                phytNameCombo.setSelectedItem(model.getPhytName());
-            if (s.equals("addAuthorRow")) {
-                tableModel.addRow();
-                /*
-                DefaultCellEditor dce = (DefaultCellEditor) authorTable.getCellEditor(0,0);
-                Object o = dce.getCellEditorValue();
-                 */            
-            }             
-            if (s.equals("removeAuthorRow")) {
-                tableModel.removeRow(row);
-                //unfortunately have to set up the editors and renderers again because of the
-                //fireTableStructureChanged() in the tableModel.removeRow() ... :-/
-                //initAuthorTable();            
-            }            
-        }//instanceof Pair
+    /** Observer update method.
+     *
+     * Updates the dialog as messages from the observable model come.
+     */
+    public void update(final Observable o, final Object arg) {
+        SwingUtilities.invokeLater(new Runnable() {
+            public void run() {
         
-        if (arg != null && arg instanceof String) {
-            String s = (String) arg;
-            
-            if (s.equals("CLEAR")) {
-                clearComponentData();
-                return;
-            }
-            
-            if (s.equals("PLANTS_CHANGED")) {
-                logger.debug("Updating plant area");
-                if (model.getPlants() == null) {
-                    ((AutoTextArea)taxonTextArea).setChoices(new String[] {""});
-                    return;
-                }
-                Pair<String, Integer>[] plants = model.getPlants();
-                String[] choices = new String[plants.length];
-                for (int i = 0; i < plants.length; i++) 
-                    choices[i] = plants[i].getFirst();
-                
-                ((AutoTextArea)taxonTextArea).setChoices(choices);
-                return;
-            }
-            
-            if (s.equals("AUTHORS_CHANGED")) {
-                logger.debug("Updating authors combo");
-                JComboBox cb;
-                
-                if (model.getAuthors() == null) 
-                    cb = new AutoComboBoxNG3();
-                else
-                    cb = new AutoComboBoxNG3(model.getAuthors());
-                    
-                TableColumn tc1 = authorTable.getColumnModel().getColumn(0);
+                if (arg != null && arg instanceof Pair) {
+                    String s = ((Pair<String,Integer>)arg).getFirst();
+                    int row = ((Pair<String,Integer>)arg).getSecond(); 
+                    if (s.equals("updateCode"))
+                        phytCodeCombo.setSelectedItem(model.getPhytCode());
+                    if (s.equals("updateName"))
+                        phytNameCombo.setSelectedItem(model.getPhytName());
+                    if (s.equals("addAuthorRow")) {
+                        tableModel.addRow();
+                        /*
+                        DefaultCellEditor dce = (DefaultCellEditor) authorTable.getCellEditor(0,0);
+                        Object o = dce.getCellEditorValue();
+                         */            
+                    }             
+                    if (s.equals("removeAuthorRow")) {
+                        tableModel.removeRow(row);
+                        //unfortunately have to set up the editors and renderers again because of the
+                        //fireTableStructureChanged() in the tableModel.removeRow() ... :-/
+                        //initAuthorTable();            
+                    }            
+                }//instanceof Pair
 
-                
-                tc1.setCellEditor(new DefaultCellEditor(cb));  
-                return;
-            }
+                if (arg != null && arg instanceof String) {
+                    String s = (String) arg;
 
-            if (s.equals("AUTHORROLES_CHANGED")) {
-                logger.debug("Updating authorroles combobox");
-                JComboBox cb;
-                
-                if (model.getAuthorRoles() == null)
-                    cb = new AutoComboBoxNG3();
-                else
-                    cb = new AutoComboBoxNG3(model.getAuthorRoles());
+                    if (s.equals("CLEAR")) {
+                        clearComponentData();
+                        return;
+                    }
 
-                TableColumn tc2 = authorTable.getColumnModel().getColumn(1);
-                
-                tc2.setCellEditor(new DefaultCellEditor(cb));                
-                return;
-            }
-            
-            if (s.equals("VILLAGES_CHANGED")) {
-                logger.debug("Updating villages combobox");
-                if (model.getVillages() == null)
-                    townComboBox.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    townComboBox.setModel(new DefaultComboBoxModel(model.getVillages()));
-                townComboBox.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }
-            
-            if (s.equals("TERRITORIES_CHANGED")) {
-                logger.debug("Updating territories combobox");
-                if (model.getTerritories() == null)
-                    territoryNameCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    territoryNameCombo.setModel(new DefaultComboBoxModel(model.getTerritories()));
-                territoryNameCombo.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }
+                    if (s.equals("PLANTS_CHANGED")) {
+                        logger.debug("Updating plant area");
+                        if (model.getPlants() == null) {
+                            ((AutoTextArea)taxonTextArea).setChoices(new String[] {""});
+                            return;
+                        }
+                        Pair<String, Integer>[] plants = model.getPlants();
+                        String[] choices = new String[plants.length];
+                        for (int i = 0; i < plants.length; i++) 
+                            choices[i] = plants[i].getFirst();
 
-            if (s.equals("PHYTNAMES_CHANGED")) {
-                logger.debug("Updating phytnames combobox");
-                if (model.getPhytNames() == null)
-                    phytNameCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    phytNameCombo.setModel(new DefaultComboBoxModel(model.getPhytNames()));
-                phytNameCombo.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }
+                        ((AutoTextArea)taxonTextArea).setChoices(choices);
+                        return;
+                    }
 
-            if (s.equals("PHYTCODES_CHANGED")) {
-                logger.debug("Updating phytcodes combobox");
-                if (model.getPhytCodes() == null)
-                    phytCodeCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    phytCodeCombo.setModel(new DefaultComboBoxModel(model.getPhytCodes()));
-                phytCodeCombo.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }
+                    if (s.equals("AUTHORS_CHANGED")) {
+                        logger.debug("Updating authors combo");
+                        JComboBox cb;
 
-            if (s.equals("COUNTRIES_CHANGED")) {
-                logger.debug("Updating countries combobox");
-                if (model.getCountries() == null)
-                    phytCountryCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    phytCountryCombo.setModel(new DefaultComboBoxModel(model.getCountries()));
-                phytCountryCombo.insertItemAt(model.EMPTY_STRING,0);
-                return;
-            }
-            
-            if (s.equals("SOURCES_CHANGED")) {
-                logger.debug("Updating sources combobox");
-                if (model.getSources() == null)
-                    sourceCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    sourceCombo.setModel(new DefaultComboBoxModel(model.getSources()));
-                sourceCombo.insertItemAt(model.EMPTY_STRING,0);
-                return;
-            }
-            
-            if (s.equals("PUBLICATIONS_CHANGED")) {
-                logger.debug("Updating publications combobox");
-                if (model.getPublications() == null)
-                    publicationCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    publicationCombo.setModel(new DefaultComboBoxModel(model.getPublications()));
-                publicationCombo.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }
+                        if (model.getAuthors() == null) 
+                            cb = new AutoComboBoxNG3();
+                        else
+                            cb = new AutoComboBoxNG3(model.getAuthors());
 
-            if (s.equals("PROJECTS_CHANGED")) {
-                logger.debug("Updating projects combobox");
-                if (model.getProjects() == null)
-                    projectCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
-                else
-                    projectCombo.setModel(new DefaultComboBoxModel(model.getProjects()));
-                projectCombo.insertItemAt(model.EMPTY_PAIR,0);
-                return;
-            }                       
-        }//instanceof String
-    }
+                        TableColumn tc1 = authorTable.getColumnModel().getColumn(0);
+
+
+                        tc1.setCellEditor(new DefaultCellEditor(cb));  
+                        return;
+                    }
+
+                    if (s.equals("AUTHORROLES_CHANGED")) {
+                        logger.debug("Updating authorroles combobox");
+                        JComboBox cb;
+
+                        if (model.getAuthorRoles() == null)
+                            cb = new AutoComboBoxNG3();
+                        else
+                            cb = new AutoComboBoxNG3(model.getAuthorRoles());
+
+                        TableColumn tc2 = authorTable.getColumnModel().getColumn(1);
+
+                        tc2.setCellEditor(new DefaultCellEditor(cb));                
+                        return;
+                    }
+
+                    if (s.equals("VILLAGES_CHANGED")) {
+                        logger.debug("Updating villages combobox");
+                        if (model.getVillages() == null)
+                            townComboBox.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            townComboBox.setModel(new DefaultComboBoxModel(model.getVillages()));
+                        townComboBox.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }
+
+                    if (s.equals("TERRITORIES_CHANGED")) {
+                        logger.debug("Updating territories combobox");
+                        if (model.getTerritories() == null)
+                            territoryNameCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            territoryNameCombo.setModel(new DefaultComboBoxModel(model.getTerritories()));
+                        territoryNameCombo.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }
+
+                    if (s.equals("PHYTNAMES_CHANGED")) {
+                        logger.debug("Updating phytnames combobox");
+                        if (model.getPhytNames() == null)
+                            phytNameCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            phytNameCombo.setModel(new DefaultComboBoxModel(model.getPhytNames()));
+                        phytNameCombo.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }
+
+                    if (s.equals("PHYTCODES_CHANGED")) {
+                        logger.debug("Updating phytcodes combobox");
+                        if (model.getPhytCodes() == null)
+                            phytCodeCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            phytCodeCombo.setModel(new DefaultComboBoxModel(model.getPhytCodes()));
+                        phytCodeCombo.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }
+
+                    if (s.equals("COUNTRIES_CHANGED")) {
+                        logger.debug("Updating countries combobox");
+                        if (model.getCountries() == null)
+                            phytCountryCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            phytCountryCombo.setModel(new DefaultComboBoxModel(model.getCountries()));
+                        phytCountryCombo.insertItemAt(model.EMPTY_STRING,0);
+                        return;
+                    }
+
+                    if (s.equals("SOURCES_CHANGED")) {
+                        logger.debug("Updating sources combobox");
+                        if (model.getSources() == null)
+                            sourceCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            sourceCombo.setModel(new DefaultComboBoxModel(model.getSources()));
+                        sourceCombo.insertItemAt(model.EMPTY_STRING,0);
+                        return;
+                    }
+
+                    if (s.equals("PUBLICATIONS_CHANGED")) {
+                        logger.debug("Updating publications combobox");
+                        if (model.getPublications() == null)
+                            publicationCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            publicationCombo.setModel(new DefaultComboBoxModel(model.getPublications()));
+                        publicationCombo.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }
+
+                    if (s.equals("PROJECTS_CHANGED")) {
+                        logger.debug("Updating projects combobox");
+                        if (model.getProjects() == null)
+                            projectCombo.setModel(new DefaultComboBoxModel(new String[] {""}));
+                        else
+                            projectCombo.setModel(new DefaultComboBoxModel(model.getProjects()));
+                        projectCombo.insertItemAt(model.EMPTY_PAIR,0);
+                        return;
+                    }                       
+                }//instanceof String
+            }//run()
+        }//runnable
+        );//invokeLater
         
+    }//update()
+        
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JRadioButton S42Button;



From fraktalek at mail.berlios.de  Sat Sep  2 15:39:38 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 15:39:38 +0200
Subject: [Plantlore-dev] r629 - trunk/src/net/sf/plantlore/client
Message-ID: <200609021339.k82Ddc4i022476@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 15:39:37 +0200 (Sat, 02 Sep 2006)
New Revision: 629

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
Log:
setVisible(true) is again called normally, not using SwingUtilities.invokeLater() in history and whole history.
It made the whole history not to appear... it's progress bar just hanged on the screen..

Also fixed a wrong merge from last commit...



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 13:03:14 UTC (rev 628)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 13:39:37 UTC (rev 629)
@@ -1265,11 +1265,7 @@
 	 	    	public void afterStopping() {
 					if (! historyModel.isFinishedTask()) return;
 					historyModel.setInfoFinishedTask(false);
-                                        SwingUtilities.invokeLater(new Runnable() {
-                                            public void run() {
-                                                historyView.setVisible(true);		
-                                            }
-                                        });
+                                            historyView.setVisible(true);		
 	 	    	}				
 			};			
 			task.start();							
@@ -1297,11 +1293,7 @@
 	 	    	public void afterStopping() {	
 					if (! wholeHistoryModel.isFinishedTask()) return;
 					wholeHistoryModel.setInfoFinishedTask(false);
-                                        SwingUtilities.invokeLater( new Runnable() {
-                                            public void run() {
-                                                wholeHistoryView.setVisible(true);
-                                            }
-                                        });
+                                        wholeHistoryView.setVisible(true);
 	 	    	}
 			};			
 			task.start();							
@@ -1707,36 +1699,7 @@
                                     view.initOverview();
                                     view.setCursor(Cursor.getDefaultCursor());
                                     setDatabaseDependentCommandsEnabled(true);
-				/*-------------------------------------------------------------------
-				 *  This may no longer be necessary:
-				 *------------------------------------------------------------------*/
-                logger.debug("Distributing the new database layer to:");
-                logger.debug(" # export ");
-				if( exportModel != null )
-					exportModel.setDBLayer( dblayer );
-				logger.debug(" # occurrence data import ");
-				if( importModel != null )
-					importModel.setDBLayer( dblayer );
-				logger.debug(" # table data import ");
-				if( tableImportModel != null )
-					tableImportModel.setDBLayer( dblayer );
-				logger.debug(" # record history ");
-				if (historyModel != null ) 
-					historyModel.restartQuery(History.HISTORY_RECORD);
-				logger.debug(" # complete history ");
-				if (wholeHistoryModel != null ) 
-					wholeHistoryModel.restartQuery(History.HISTORY_WHOLE);
-				logger.debug(" # user manager ");
-				if (userManagerModel != null )
-					userManagerModel.setDBLayer( dblayer );
-				logger.debug(" # metadata manager ");
-				if (metadataManagerModel != null )
-					metadataManagerModel.setDBLayer( dblayer );							
-			}
-		}
-	}
 
-
                                     //this can't be done earlier. must be done after the query is created
                                     //otherwise this listener would give the overview table model commands to load data
                                     //for a query that doesn't exist yet
@@ -1757,10 +1720,10 @@
                                             tableImportModel.setDBLayer( dblayer );
                                     logger.debug(" # record history ");
                                     if (historyModel != null ) 
-                                            historyModel.setDBLayer( dblayer );
+                                        historyModel.restartQuery(History.HISTORY_RECORD);
                                     logger.debug(" # complete history ");
                                     if (wholeHistoryModel != null ) 
-                                            wholeHistoryModel.setDBLayer( dblayer );
+                                         wholeHistoryModel.restartQuery(History.HISTORY_WHOLE);
                                     logger.debug(" # user manager ");
                                     if (userManagerModel != null )
                                             userManagerModel.setDBLayer( dblayer );



From krater at mail.berlios.de  Sat Sep  2 18:27:17 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 2 Sep 2006 18:27:17 +0200
Subject: [Plantlore-dev] r630 - in trunk/src/net/sf/plantlore:
	client/occurrenceimport client/occurrenceimport/parsers
	client/tableimport client/tableimport/parsers common
Message-ID: <200609021627.k82GRHSk014654@sheep.berlios.de>

Author: krater
Date: 2006-09-02 18:27:15 +0200 (Sat, 02 Sep 2006)
New Revision: 630

Modified:
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMng.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceParser.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/RecordProcessor.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/parsers/XMLOccurrenceParser.java
   trunk/src/net/sf/plantlore/client/tableimport/DataHolder.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportMng.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/TableParser.java
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
   trunk/src/net/sf/plantlore/common/ProgressBar.java
Log:
TableImport: Finishing touches to the code + enriched with JavaDoc. Thoroughly tested (all operations behave exactly as described). The question is whether the behaviour is really fine: if the record R is supposed to be replaced by R', but both R and R' are already in the database, then R is deleted. This has its logic, because the following file may exist (schematically):

<add> Z </add> <update> Z -> X </update>

If this file is imported for the first time, only X is in the database. However, if the file is imported again (by accident or so), then both X and Z would be in the database (if we would not have deleted Z), which is wrong because the result should be the same no matter how many times the file is imported. By deleting the original record R we can achieve that.

OccurrenceImport: JavaDoc added, some final tests remain to be performed.

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMng.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMng.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMng.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -20,23 +20,58 @@
 import org.apache.log4j.Logger;
 import org.xml.sax.SAXException;
 
+/**
+ * The Occurrence Import manager serves as an Occurrence Import Task factory. 
+ * The Occurrence Import Manager gathers all information
+ * needed for the creation of a new Occurrence Import Task.
+ * <br/>
+ * In order to create a new Occurrence Import task these information must be supplied:
+ * <ul>   
+ * <li>dblayer	The database layer mediating the access to the database.</li>
+ * <li>filename	The name of the file where the records are stored.</li>
+ * </ul>
+ * <br/>
+ * The Occurrence Import manager requires an Observer as well - 
+ * this Observer is notified if some table was modified during the Import
+ * so that the Application can reload the up-to-date content of
+ * those modified tables.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-06-29 
+ * @version 1.0
+ */
 public class OccurrenceImportMng {
 	
 	private Logger logger = Logger.getLogger(OccurrenceImportMng.class.getPackage().getName());
 	private DBLayer db; 
 	private Observer tableChangeObserver;
 	
+	/**
+	 * Create a new Occurrence Import Manager. 
+	 * 
+	 * @param db		The database layer mediating the access to the database.
+	 * @param tableChangeObserver	The observer that will be notified after the Occurrence Import task
+	 * ends so that the content of the modified tables is reloaded from the database and distributed
+	 * to other parts of the application.
+	 */
 	public OccurrenceImportMng(DBLayer db, Observer tableChangeObserver) {
 		this.db = db;
 		this.tableChangeObserver = tableChangeObserver;
 	}
 	
+	/**
+	 * 
+	 * @param dblayer	Set a new database layer.
+	 */
 	public void setDBLayer(DBLayer dblayer) {
 		this.db = dblayer;
 	}
 	
 	/**
+	 * Construct a new Occurrence Import task.
 	 * 
+	 * @param filename	The name of the file where the Occurrences are stored.
+	 * @return	The task that will perform the import.
 	 */
 	synchronized public Task createOccurrenceImportTask(String filename) 
 	throws ImportException, IOException, RemoteException, SAXException {
@@ -63,6 +98,7 @@
 		}
 		
 		logger.debug("Preparing new OccurrenceImport task.");
+		// Only one kind of parser is available - the XML parser.
 		OccurrenceParser parser = new XMLOccurrenceParser(reader);
 		Task occurrenceImportTask = new OccurrenceImportTask(db, parser);
 		occurrenceImportTask.addObserver( tableChangeObserver );

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -10,6 +10,13 @@
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 
+/**
+ * Allow the User to specify the name of the file where the Occurrence records
+ * are stored. Then create an Occurrence Import task and start it.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+ */
 public class OccurrenceImportMngCtrl {
 	
 	private OccurrenceImportMng model;
@@ -24,6 +31,12 @@
 		choice.addChoosableFileFilter( new FileFormat(L10n.getString("Format.XML"), true, true, ".xml") ); 
 	}
 	
+	/**
+	 * Display the dialog where the User can choose the file name,
+	 * create the Occurrence Import task and start it.
+	 * 
+	 * @param visible	True if the GUI should become visible.
+	 */
 	public void setVisible(boolean visible) {
 		if(visible) {
 			int result = choice.showDialog(view, L10n.getString("Import.Title"));

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -16,6 +16,16 @@
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 
+/**
+ * The Occurrence Import task instructs the Parser to start parsing the file
+ * and every time a record is reconstructed, it is processed here (via a callback).
+ * <br/>
+ * The task can be cancelled.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+ * @version 1.0
+ */
 public class OccurrenceImportTask extends Task implements RecordProcessor {
 	
 	private Logger logger = Logger.getLogger(OccurrenceImportTask.class.getPackage().getName());
@@ -26,6 +36,10 @@
 	
 	private DBLayerException canceledByUser = new DBLayerException(L10n.getString("Import.CanceledByUser"));
 	
+	/**
+	 * The list of tables that can be modified during the import
+	 * (therefore the application must reload the content of those tables). 
+	 */
 	private static Table[] TABLES_TO_UPDATE = new Table[] { 
 		Table.AUTHOR, 
 		Table.AUTHOROCCURRENCE, 
@@ -41,7 +55,12 @@
 			DBLayerException.ERROR_UPDATE,
 			DBLayerException.ERROR_RIGHTS));
 	
-	
+	/**
+	 * Create a new Occurrence Import task. 
+	 * 
+	 * @param db		The database layer mediating the access to the database.
+	 * @param parser	The parser that is capable of reconstructing the records stored in some file.
+	 */
 	public OccurrenceImportTask(DBLayer db, OccurrenceParser parser) {
 		this.parser = parser;
 		parser.setRecordProcessor( this );
@@ -75,7 +94,14 @@
 		// Empty implementation. Just to make sure no one will try to resurrect this operation.
 	}
 
-	
+	/**
+	 * Store the record supplied by the parser into the database. 
+	 * All author-occurrences should share the same occurrence.
+	 * <br/>
+	 * Some erros may be ignored (such as insufficient access rights)
+	 * i.e. the whole import procedure will not fail, just the problematic 
+	 * record will be rejected. 
+	 */
 	public void processRecord(AuthorOccurrence... aos) 
 	throws DBLayerException, RemoteException {
 		if( isCanceled() ) 

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceParser.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceParser.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -1,9 +1,28 @@
 package net.sf.plantlore.client.occurrenceimport;
 
+/**
+ * The Occurrence parser performs the parsing of the input
+ * and every time an Occurrence record is read
+ * (with all its Author-occurrences), it is passed to the Record processor.
+ * <br/> 
+ * The format of the input is implementation specific.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+ *
+ */
 public interface OccurrenceParser {
 	
+	/**
+	 * Set the Record processor. 
+	 * 
+	 * @param processor	The record processor that is used to process the whole Occurrence record.
+	 */
 	void setRecordProcessor(RecordProcessor processor);
 	
+	/**
+	 *	Start parsing the input. 
+	 */
 	void startParsing() throws Exception ;
 
 }

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/RecordProcessor.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/RecordProcessor.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/RecordProcessor.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -2,8 +2,22 @@
 
 import net.sf.plantlore.common.record.*;
 
+/**
+ * The record processor is an interface that allows the Occurrence parser
+ * to pass the reconstructed record for further processing.
+ * It is not the Parser that should decide, what will happen with the record.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+  */
 public interface RecordProcessor {
 	
+	/**
+	 * Process the whole occurrence record.
+	 * 
+	 * @param authorOccurrences	The list of all author-occurrences
+	 * refering to the same occurrence.
+	 */
 	void processRecord(AuthorOccurrence...authorOccurrences) throws Exception;
 
 }

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/parsers/XMLOccurrenceParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/parsers/XMLOccurrenceParser.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/parsers/XMLOccurrenceParser.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -21,7 +21,22 @@
 import net.sf.plantlore.l10n.L10n;
 
 
-
+/**
+ * The XML Occurrence Parser is capable of reading the selected file in the PlantloreNative
+ * file format, that is based on the XML, and reconstructing records stored in that format.
+ * The reconstructed record is handed over to the Record Processor.
+ * <br/>
+ * The XML Occurrence Parser uses SAX to parse the input. It is fast and requires next to
+ * no memory (which is why DOM is not suitable in this case). The Parser can handle
+ * files of virtually any size.
+ * <br/>
+ * The input must be a valid PlantloreNative format - if it is not, the input is considered corrupted
+ * and the parsing is terminated.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+ *	@version 1.0
+ */
 public class XMLOccurrenceParser extends DefaultHandler implements OccurrenceParser {
 	
 	private Logger logger = Logger.getLogger(XMLOccurrenceParser.class.getPackage().getName());
@@ -40,7 +55,12 @@
 	
 	private static AuthorOccurrence[] AUTHOR_OCCURRENCE_ARRAY = new AuthorOccurrence[0];
 	
-	
+	/**
+	 * Create a new XML Occurrence Parser.
+	 * 
+	 * @param reader	The reader that allows us to read the input. 
+	 * It will be closed when the end of the input is reached. 
+	 */
 	public XMLOccurrenceParser(Reader reader) 
 	throws SAXException {
 		xmlReader = XMLReaderFactory.createXMLReader();
@@ -50,11 +70,18 @@
 		this.reader = reader;
 	}
 	
+	/**
+	 * Set another record processor.
+	 * 
+	 * @param processor	The record processor which will be used to process the reconstructed record.
+	 */
 	public void setRecordProcessor(RecordProcessor processor) {
 		this.processor = processor;
 	}
 
-	
+	/**
+	 * Start parsing the input.
+	 */
 	public void startParsing() 
 	throws Exception {
 		try {
@@ -67,7 +94,14 @@
 		}
 	}
 	
-	
+	/**
+	 * If the condition is satisfied
+	 * throw an exception that will signal that the file format is corrupted.
+	 * 
+	 * 
+	 * @param condition	If the condition is false, throw the exception.
+	 * @throws SAXException	The exception signalling a corrupted file format.
+	 */
 	private void signalCorruptedFileIf(boolean condition) throws SAXException {
 		if( condition ) {
 			logger.error("Format of the file is corrupted! Parsing will be terminated.");
@@ -76,7 +110,10 @@
 	}
 	
 	
-
+	/**
+	 * Process the opening tag. Make some format validity checks 
+	 * and throw an exception if the validity constraints are violated.
+	 */
 	@Override
 	public void startElement(String uri, String name, String qname, Attributes attr) 
 	throws SAXException {
@@ -110,10 +147,17 @@
 			else if( current.isColumn(name) ) 
 				textCache.delete(0, textCache.capacity());
 			else
-				signalCorruptedFileIf( true );
+				signalCorruptedFileIf( true ); // an unknown tag
 		}
 	}
 	
+	/**
+	 * Process the closing tag. Make some format validity checks 
+	 * and throw an exception, if the validity constraints are violated.
+	 * <br/>
+	 * When the whole Occurrence record is reconstructed, pass it to the
+	 * Record Processor.
+	 */
 	@Override
 	public void endElement(String uri, String name, String qname) 
 	throws SAXException {
@@ -146,10 +190,17 @@
 			current.setValueSafe(name, textCache.toString());
 	}
 	
+	/**
+	 * Gather the data stored in between the opening and closing tag.
+	 * Limit the maximum length of the text to 4096 characters.
+	 */
 	@Override
 	public void characters(char[] ch, int start, int length) {
-		for(int i = start; i < start + length; i++)
+		for(int i = start; i < start + length; i++) {
+			if( textCache.length() >= textCache.capacity() )
+				break;
 			textCache.append( ch[i] );
+		}
 	}
 	
 

Modified: trunk/src/net/sf/plantlore/client/tableimport/DataHolder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/DataHolder.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/DataHolder.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -2,8 +2,24 @@
 
 import net.sf.plantlore.common.record.Record;
 
+/**
+ * Store the information about the record(s) obtained from the input.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-10
+  */
 public class DataHolder {
+	/**
+	 * The action that should be performed with the record(s).
+	 */
 	public TableParser.Action action;
+	/**
+	 * The record from the file that should be processed.
+	 */
 	public Record record;
+	/**
+	 * Additional record from the file that may be required in order to carry out the 
+	 * intended action (such as update) properly.
+	 */
 	public Record replacement;
 }

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportMng.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportMng.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportMng.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -19,10 +19,22 @@
 import static net.sf.plantlore.client.export.ExportMng2.ENCODING;
 
 /**
- * ImportTask factory.
+ * The Table Import manager serves as a Table Import Task factory. 
+ * The Table Import Manager gathers all information needed for the creation of a new Table Import Task.
+ * <br/>
+ * In order to create a new Table Import task these information must be supplied:
+ * <ul>   
+ * <li>dblayer	The database layer mediating the access to the database.</li>
+ * <li>filename	The name of the file where the records are stored.</li>
+ * </ul>
+ * <br/>
+ * The Table Import manager requires an Observer as well - 
+ * this Observer is notified if the immutable table is modified during the Import
+ * so that the Application can reload the up-to-date content of
+ * that modified table.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 2006-05-08
+ * @since 2006-05-08 
  * @version 1.0
  */
 public class TableImportMng {
@@ -31,17 +43,32 @@
 	private DBLayer db; 
 	private Observer tableChangeObserver;
 	
+	/**
+	 * Create a new Occurrence Import Manager. 
+	 * 
+	 * @param db		The database layer mediating the access to the database.
+	 * @param tableChangeObserver	The observer that will be notified after the Table Import task
+	 * ends so that the content of the modified table is reloaded and redistributed
+	 * to other parts of the application.
+	 */
 	public TableImportMng(DBLayer db, Observer tableChangeObserver) {
 		this.db = db;
 		this.tableChangeObserver = tableChangeObserver;
 	}
 	
+	/**
+	 * 
+	 * @param dblayer	Set a new database layer.
+	 */
 	public void setDBLayer(DBLayer dblayer) {
 		this.db = dblayer;
 	}
 	
 	/**
-	 * Start the import procedure. The import will run in its own thread.
+	 * Construct a new Table Import task.
+	 * 
+	 * @param filename	The name of the file where the records are stored.
+	 * @return	The task that will perform the import.
 	 */
 	synchronized public Task createTableImportTask(String filename) 
 	throws ImportException, IOException, RemoteException {

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -9,7 +9,13 @@
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 
-
+/**
+ * Allow the User to specify the name of the file where the immutable table's records
+ * are stored. Then create an Table Import task and start it.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-14
+ */
 public class TableImportMngCtrl {
 	
 	private TableImportMng model;
@@ -24,6 +30,12 @@
 		choice.addChoosableFileFilter( new FileFormat("Table update files (*.xml)", ".xml") );
 	}
 	
+	/**
+	 * Display the dialog where the User can choose the file name,
+	 * create the Table Import task and start it.
+	 * 
+	 * @param visible	True if the GUI should become visible.
+	 */
 	public void setVisible(boolean visible) {
 		if(visible) {
 			int result = choice.showDialog(view, L10n.getString("Import.Title"));

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -17,7 +17,25 @@
 
 
 /**
- * DefaultDirector
+ * The Table Import task acts as the Director from the Builder design pattern.
+ * It repeatedly asks for records and processes them accordingly.
+ * <br/>
+ * <ul>
+ * <li>Records that are meant to be inserted are inserted only if they are not in the database already.</li>
+ * <li>Records that are meant to be deleted are removed only if there is no other record in the database
+ * that would refer to it, so that the reference integrity is kept.</li>
+ * <li>Records that are meant to be updated may be treated in three different ways:
+ * 		<ol>
+ * 		<li>if the record to be updated is not in the database, then the replacement is inserted;</li>
+ * 		<li>if the record to be updated is in the database but the replacement is not, the record
+ * 		in the database is updated accordingly; </li>
+ * 		<li>if both the record to be updated and the replacement are in the database, 
+ * 		the (original) record is deleted.</li>
+ * 		</ol>
+ * </li>
+ * </ul>
+ * <br/>
+ * The Table Import is potentially a dangerous operation which is why only the Administrator can perform it.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-05-31
@@ -36,13 +54,12 @@
 //			Arrays.asList(Metadata.class, Plant.class, NearestVillage.class, Phytochorion.class, Territory.class));
 	
 	/**
+	 * Create a new Table Import task.
 	 * 
 	 * @param db	The database where the data will be imported.
 	 * @param TableParser	The TableParser that is responsible for parsing the file.
-	 * @throws ImportException	If some parameters are null.
 	 */
-	public TableImportTask(DBLayer db, TableParser parser) 
-	throws ImportException {
+	public TableImportTask(DBLayer db, TableParser parser) {
 		this.db = db;
 		this.parser = parser;
 		
@@ -77,7 +94,7 @@
 			try {
 				count++;
 				setPosition( count );
-				setStatusMessage(count + " " + L10n.getString("Import.RecordsImported"));
+				setStatusMessage(L10n.getFormattedString("Import.RecordsImported", count));
 				data = parser.getNext();
 			} catch( ParserException pe ) {
 				logger.warn("The record is corrupted. " + pe);
@@ -94,9 +111,9 @@
 				setStatusMessage(L10n.getFormattedString("Import.IncompleteRecord", count));					
 			}
 			
-			logger.debug(data.action+" "+data.record + 
+			logger.debug(data.action+" "+data.record.toFullString() + 
 					((data.action == Action.UPDATE) ? 
-							" ==> " + data.replacement :
+							" ==> " + data.replacement.toFullString() :
 					""));
 			
 			
@@ -118,11 +135,14 @@
 					break;
 				case UPDATE:
 					Record replacementInDB = dbutils.findMatchInDB( data.replacement ); 
-					if( replacementInDB == null )
+					if( replacementInDB == null ) {
 						if( !isRecordInDB )
 							insert( data.replacement );
 						else
 							update( recordInDB, data.replacement );
+					} 
+					else if( isRecordInDB )
+						delete( recordInDB );
 					updated ++;
 					break;
 				}
@@ -158,6 +178,7 @@
 	
 	
 	/**
+	 * Insert the record into the database.
 	 */
 	protected void insert(Record record) 
 	throws RemoteException, DBLayerException {
@@ -166,6 +187,7 @@
 	}
 	
 	/**
+	 * Update the record in the database.
 	 */
 	protected void update(Record current, Record replacement) 
 	throws RemoteException, DBLayerException {
@@ -177,6 +199,7 @@
 	}
 		
 	/**
+	 * Remove the record from the database if possible.
 	 */
 	protected void delete(Record record) 
 	throws RemoteException, DBLayerException, ImportException {

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableParser.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableParser.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -2,16 +2,63 @@
 
 import net.sf.plantlore.common.exception.ParserException;
 
+/**
+ * The Table Parser is an interface for a parser capable of reading 
+ * an input containing records from an immutable table. 
+ * Those records can be added, updated, or removed.
+ * <br/>
+ * The use of a parser
+ * <pre>
+ * parser.initialize();
+ * while( parser.hasNext() ) {
+ *   DataHolder h = parser.getNext();
+ *   // Process the data stored in the holder object 
+ * }
+ * </pre>
+ * <br/>
+ * The Parser acts as a Builder in the Builder design pattern.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-10
+ *
+ */
 public interface TableParser {
 	
+	/**
+	 * The operation that can be performed with a record.
+	 * 
+	 * @author Erik Kratochv?l (discontinuum at gmail.com)
+	 * @since 2006-08-10
+	 *
+	 */
 	enum Action { INSERT, UPDATE, DELETE };
 	
+	/**
+	 * Initialize the parser. The parser should be able to recognize
+	 * the immutable table to which the records belong.
+	 * 
+	 * @return	The table into which the processed records belong.
+	 */
 	Class initialize() throws ParserException;
 
+	/**
+	 * 
+	 * @return	True if there are some records left.
+	 */
 	boolean hasNext();
 	
+	/**
+	 * Obtain the next record(s) from the input.
+	 * 
+	 * @return	The holder object storing the record(s) and the action that should be performed with it.
+	 */
 	DataHolder getNext() throws ParserException;
-	
+
+	/**
+	 * Optional.
+	 * 
+	 * @return	The total number of records on the input, or -1 if the number could not be determined. 
+	 */
 	int getNumberOfRecords();
 
 }

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -14,6 +14,54 @@
 import net.sf.plantlore.common.record.*;
 import net.sf.plantlore.l10n.L10n;
 
+/**
+ * The Unified Table Parser is capable of parsing
+ * a file in the XML file format. It can detect the type of records stored in the file
+ * and the operation that should be performed with that record.
+ * <br/> 
+ * Typicall format of the file looks like this:
+ * <br/>
+ * <pre>
+ * &lt;villages&gt;  // The Root element is used to determine the immutable table.
+ *  &lt;add&gt;
+ *   &lt;nearestvillage&gt;
+ *     &lt;name&gt;T?eb??&lt;/name&gt;
+ *   &lt;/nearestvillage&gt;
+ *  &lt;/add&gt;
+ *  
+ *  &lt;delete&gt;
+ *   &lt;nearestvillage&gt;
+ *     &lt;name&gt;?elezn? Brod&lt;/name&gt;
+ *   &lt;/nearestvillage&gt;  
+ *  &lt;delete&gt;
+ *  
+ *  &lt;update&gt; // Records in this branch must go in pairs &lt;original, replacement&gt;
+ *   &lt;nearestvillage&gt;
+ *     &lt;name&gt;K?ice&lt;/name&gt;
+ *   &lt;/nearestvillage&gt;  
+ *   &lt;nearestvillage&gt;
+ *     &lt;name&gt;Ko?ice&lt;/name&gt;
+ *   &lt;/nearestvillage&gt;
+ *  &lt;update&gt;
+ * &lt;/villages&gt;
+ * </pre>
+ * <br/>
+ * The same goes for plants, metadata, phytochoria, and territories - you just have to
+ * change the root element and the content of those three branches.
+ * <br/>
+ * The Unified Table Parser uses DOM to process the input. 
+ * It may require a huge amount of memory, however the purpose of the Table Import
+ * is to allow the User to make some minor changes to the (otherwise) immutable tables.
+ * It is not expected that the number of villages (nearest bigger seats), known plants,
+ * phytochoria, or territories will grow or change extremely fast. 
+ * The Table Import is meant for occasional changes and updates of a few records.
+ *  
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-10
+ * @version 1.0
+ *
+ */
 public class UnifiedTableParser implements TableParser {
 	
 	private Document document;
@@ -27,6 +75,9 @@
 	
 	private static Map<String, Class> tables = new Hashtable<String, Class>(10);
 	
+	/**
+	 * The key to the immutable tables.
+	 */
 	static {
 		tables.put( "plants", Plant.class);
 		tables.put( "metadata", Metadata.class);
@@ -35,12 +86,18 @@
 		tables.put( "territories", Territory.class);
 	}
 	
-	
+	/**
+	 * Create a new Unified Table Parser that will read from the supplied Reader.
+	 * 
+	 * @param reader	The input containing the  records.
+	 */
 	public UnifiedTableParser(Reader reader) {
 		this.reader = reader;
 	}
 	
-	
+	/**
+	 * Initialize the reader and detect the immutable table into which the records in the file belong.
+	 */
 	public Class initialize() throws ParserException {
 		try {
         	SAXReader saxReader = new SAXReader();
@@ -70,13 +127,18 @@
         return rootTable;
 	}
 	
-
+	/**
+	 * @return True if there are more records in the file.
+	 */
 	public boolean hasNext() {
 		if(recIterator == null)
 			return false;
 		return recIterator.hasNext();
 	}
 
+	/**
+	 * @return Another record from the file.
+	 */
 	public DataHolder getNext() 
 	throws ParserException {
 		if(recIterator == null)
@@ -109,12 +171,19 @@
 		return data;
 	}
 
-	
+	/**
+	 * @return The number of records in the file.
+	 */
 	public int getNumberOfRecords() {
 		return numberOfRecords;
 	}
 	
-	
+	/**
+	 * Reconstruct the record from the XML element.
+	 * 
+	 * @param part	The record to be recontructed.
+	 * @param node	The node storing the information about the record.
+	 */
     private void reconstruct(Record part, Node node) {
     	if(part == null || node == null)
     		return;

Modified: trunk/src/net/sf/plantlore/common/ProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-02 13:39:37 UTC (rev 629)
+++ trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-02 16:27:15 UTC (rev 630)
@@ -218,7 +218,7 @@
                         break;
                     case STOPPING:
                         setVisible(false);
-                        dispose();                    
+                        dispose(); // FIXME: Should not this method be invoked from the EDT?                    
                         parent.setCursor(Cursor.getDefaultCursor());
                         logger.debug( "ProgressBar:Stopping " + task );
                         afterStopping();



From tkovarik at gmail.com  Sat Sep  2 18:49:42 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Sat, 2 Sep 2006 18:49:42 +0200
Subject: [Plantlore-dev] Upravy databze - Unikatne identifikatory databaze a
	zaznamu
Message-ID: <ea88f1620609020949n41e34393r1b4c3a176b7efd50@mail.gmail.com>

Caute,

narazil som na dva "problemy" pri pridavani unikatnych identifikatorov
zaznamu a databaze:

1. Unikatny identifikator zaznamu by asi mal byt unikatne cislo (v celej
databazi). Staci teda aby ho tam DBLayer pridavala a inkrementovala. Polozka
cUnitValue v tabulke tOccurrences je ale typu varchar(30). Nemal by to byt
radsej integer? (resp. int4 v postgre, maximalna velkost 2147483647 asi
staci)

2. Hash ktory lezie z UniqueIDGenerator.generate() ma dlzku 40 bytov (napr.:
01e6326ba2b7e87cfc9a495b70b4af485f36a1fa), polozka cunitiddb v tabulkach
tunitiddatabase a toccurrences je typu varchar(30) a trosku to preteka.
Chceme skratit ten hash alebo zvacsit pole v tabulkach? (ja by som zvacsil
pole v tabulkach aby sa zachovala jednoznacnost toho hashu)

Majte sa

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060902/b2872e7c/attachment.html>

From fraktalek at mail.berlios.de  Sat Sep  2 18:53:15 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 18:53:15 +0200
Subject: [Plantlore-dev] r631 - in trunk/src/net/sf/plantlore: client
	client/overview/detail common l10n
Message-ID: <200609021653.k82GrF1i023940@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 18:53:00 +0200 (Sat, 02 Sep 2006)
New Revision: 631

Added:
   trunk/src/net/sf/plantlore/client/AboutView.form
   trunk/src/net/sf/plantlore/client/AboutView.java
Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/Plantlore.java
   trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Added about dialog and bound the help about and help contents menu items.
Removed another invokeLater from AppCoreCtrl...
DefaultExc.Handler now prints stack trace...



Added: trunk/src/net/sf/plantlore/client/AboutView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AboutView.form	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/AboutView.form	2006-09-02 16:53:00 UTC (rev 631)
@@ -0,0 +1,223 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+<Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
+  <Properties>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+      <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.About" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+    </Property>
+    <Property name="resizable" type="boolean" value="false"/>
+  </Properties>
+  <SyntheticProperties>
+    <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
+  </SyntheticProperties>
+  <AuxValues>
+    <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_layoutCodeTarget" type="java.lang.Integer" value="2"/>
+    <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
+    <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
+  </AuxValues>
+
+  <Layout>
+    <DimensionLayout dim="0">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Component id="aboutTabbedPane" alignment="0" pref="382" max="32767" attributes="0"/>
+      </Group>
+    </DimensionLayout>
+    <DimensionLayout dim="1">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Component id="aboutTabbedPane" alignment="0" pref="277" max="32767" attributes="0"/>
+      </Group>
+    </DimensionLayout>
+  </Layout>
+  <SubComponents>
+    <Container class="javax.swing.JTabbedPane" name="aboutTabbedPane">
+
+      <Layout class="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout"/>
+      <SubComponents>
+        <Container class="javax.swing.JPanel" name="aboutTab">
+          <Properties>
+            <Property name="name" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.About" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+            </Property>
+          </Properties>
+          <Constraints>
+            <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
+              <JTabbedPaneConstraints tabName="">
+                <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.About" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </JTabbedPaneConstraints>
+            </Constraint>
+          </Constraints>
+
+          <Layout>
+            <DimensionLayout dim="0">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <EmptySpace min="0" pref="377" max="32767" attributes="0"/>
+              </Group>
+            </DimensionLayout>
+            <DimensionLayout dim="1">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <EmptySpace min="0" pref="250" max="32767" attributes="0"/>
+              </Group>
+            </DimensionLayout>
+          </Layout>
+        </Container>
+        <Container class="javax.swing.JPanel" name="detailTab">
+          <Properties>
+            <Property name="name" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Detail" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+            </Property>
+          </Properties>
+          <Constraints>
+            <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
+              <JTabbedPaneConstraints tabName="Detail: ">
+                <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Detail" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </JTabbedPaneConstraints>
+            </Constraint>
+          </Constraints>
+
+          <Layout>
+            <DimensionLayout dim="0">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Group type="102" attributes="0">
+                      <Group type="103" groupAlignment="0" attributes="0">
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="versionLabel" pref="353" max="32767" attributes="0"/>
+                          </Group>
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="osLabel" min="-2" max="-2" attributes="0"/>
+                          </Group>
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="javaLabel" min="-2" max="-2" attributes="0"/>
+                          </Group>
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="userDirLabel" min="-2" max="-2" attributes="0"/>
+                          </Group>
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="configDirLabel" min="-2" max="-2" attributes="0"/>
+                          </Group>
+                          <Group type="102" alignment="0" attributes="0">
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="authorsLabel" min="-2" max="-2" attributes="0"/>
+                          </Group>
+                      </Group>
+                      <EmptySpace max="-2" attributes="0"/>
+                  </Group>
+                  <Group type="102" alignment="1" attributes="0">
+                      <EmptySpace pref="75" max="32767" attributes="0"/>
+                      <Group type="103" groupAlignment="0" attributes="0">
+                          <Component id="erikLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                          <Component id="ladaLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                          <Component id="kovoLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                          <Component id="jakubLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                      </Group>
+                      <EmptySpace min="-2" pref="29" max="-2" attributes="0"/>
+                  </Group>
+              </Group>
+            </DimensionLayout>
+            <DimensionLayout dim="1">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Group type="102" alignment="0" attributes="0">
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="versionLabel" max="32767" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="osLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="javaLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="userDirLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="configDirLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="authorsLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="ladaLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="erikLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="kovoLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="jakubLabel" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="34" max="32767" attributes="0"/>
+                  </Group>
+              </Group>
+            </DimensionLayout>
+          </Layout>
+          <SubComponents>
+            <Component class="javax.swing.JLabel" name="versionLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Version" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="osLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Os" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="javaLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Java" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="userDirLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.UserDir" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="configDirLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.ConfigDir" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="authorsLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Authors" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="ladaLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="Lada Oberreiterov&#xe1; ( jose at mail.berlios.de )"/>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="erikLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="Erik Kratochv&#xed;l ( krater at mail.berlios.de )"/>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="kovoLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="Tom&#xe1;&#x161; Kova&#x159;&#xed;k ( kovo at mail.berlios.de )"/>
+              </Properties>
+            </Component>
+            <Component class="javax.swing.JLabel" name="jakubLabel">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="Jakub Kotowski ( fraktalek at mail.berlios.de)"/>
+              </Properties>
+            </Component>
+          </SubComponents>
+        </Container>
+      </SubComponents>
+    </Container>
+  </SubComponents>
+</Form>

Added: trunk/src/net/sf/plantlore/client/AboutView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AboutView.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/AboutView.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -0,0 +1,194 @@
+/*
+ * AboutView.java
+ *
+ * Created on 2. z??? 2006, 16:26
+ */
+
+package net.sf.plantlore.client;
+
+import java.io.File;
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ *
+ * @author  fraktalek
+ */
+public class AboutView extends javax.swing.JDialog {
+    
+    /** Creates new form AboutView */
+    public AboutView(java.awt.Frame parent, boolean modal) {
+        super(parent, modal);
+        initComponents();
+        loadData();
+        setLocationRelativeTo(parent);
+    }
+    
+    private void loadData() {
+        String os = System.getProperty("os.name");
+        String plantloreDir = (os.equals("linux") ? "." : "") + Plantlore.PLANTLORE;
+        configDirLabel.setText(configDirLabel.getText()+System.getProperty("user.home")+File.separator+plantloreDir);
+        osLabel.setText(osLabel.getText()+System.getProperty("os.name"));
+        userDirLabel.setText(userDirLabel.getText()+System.getProperty("user.home"));
+        versionLabel.setText(versionLabel.getText()+Plantlore.VERSION);
+        javaLabel.setText(javaLabel.getText()+System.getProperty("java.version")+" ("+System.getProperty("java.vendor")+")");
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
+    private void initComponents() {
+        aboutTabbedPane = new javax.swing.JTabbedPane();
+        aboutTab = new javax.swing.JPanel();
+        detailTab = new javax.swing.JPanel();
+        versionLabel = new javax.swing.JLabel();
+        osLabel = new javax.swing.JLabel();
+        javaLabel = new javax.swing.JLabel();
+        userDirLabel = new javax.swing.JLabel();
+        configDirLabel = new javax.swing.JLabel();
+        authorsLabel = new javax.swing.JLabel();
+        ladaLabel = new javax.swing.JLabel();
+        erikLabel = new javax.swing.JLabel();
+        kovoLabel = new javax.swing.JLabel();
+        jakubLabel = new javax.swing.JLabel();
+
+        setTitle(L10n.getString("Overview.About.About"));
+        setResizable(false);
+        aboutTab.setName(L10n.getString("Overview.About.About"));
+        org.jdesktop.layout.GroupLayout aboutTabLayout = new org.jdesktop.layout.GroupLayout(aboutTab);
+        aboutTab.setLayout(aboutTabLayout);
+        aboutTabLayout.setHorizontalGroup(
+            aboutTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(0, 377, Short.MAX_VALUE)
+        );
+        aboutTabLayout.setVerticalGroup(
+            aboutTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(0, 250, Short.MAX_VALUE)
+        );
+        aboutTabbedPane.addTab(L10n.getString("Overview.About.About"), aboutTab);
+
+        detailTab.setName(L10n.getString("Overview.About.Detail"));
+        versionLabel.setText(L10n.getString("Overview.About.Version"));
+
+        osLabel.setText(L10n.getString("Overview.About.Os"));
+
+        javaLabel.setText(L10n.getString("Overview.About.Java"));
+
+        userDirLabel.setText(L10n.getString("Overview.About.UserDir"));
+
+        configDirLabel.setText(L10n.getString("Overview.About.ConfigDir"));
+
+        authorsLabel.setText(L10n.getString("Overview.About.Authors"));
+
+        ladaLabel.setText("Lada Oberreiterov\u00e1 ( jose at mail.berlios.de )");
+
+        erikLabel.setText("Erik Kratochv\u00edl ( krater at mail.berlios.de )");
+
+        kovoLabel.setText("Tom\u00e1\u0161 Kova\u0159\u00edk ( kovo at mail.berlios.de )");
+
+        jakubLabel.setText("Jakub Kotowski ( fraktalek at mail.berlios.de)");
+
+        org.jdesktop.layout.GroupLayout detailTabLayout = new org.jdesktop.layout.GroupLayout(detailTab);
+        detailTab.setLayout(detailTabLayout);
+        detailTabLayout.setHorizontalGroup(
+            detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(detailTabLayout.createSequentialGroup()
+                .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(versionLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 353, Short.MAX_VALUE))
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(osLabel))
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(javaLabel))
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(userDirLabel))
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(configDirLabel))
+                    .add(detailTabLayout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(authorsLabel)))
+                .addContainerGap())
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, detailTabLayout.createSequentialGroup()
+                .addContainerGap(75, Short.MAX_VALUE)
+                .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(erikLabel)
+                    .add(ladaLabel)
+                    .add(kovoLabel)
+                    .add(jakubLabel))
+                .add(29, 29, 29))
+        );
+        detailTabLayout.setVerticalGroup(
+            detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(detailTabLayout.createSequentialGroup()
+                .addContainerGap()
+                .add(versionLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(osLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(javaLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(userDirLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(configDirLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(authorsLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(ladaLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(erikLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(kovoLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jakubLabel)
+                .addContainerGap(34, Short.MAX_VALUE))
+        );
+        aboutTabbedPane.addTab(L10n.getString("Overview.About.Detail"), detailTab);
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(aboutTabbedPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 382, Short.MAX_VALUE)
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(aboutTabbedPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 277, Short.MAX_VALUE)
+        );
+        pack();
+    }// </editor-fold>//GEN-END:initComponents
+    
+    /**
+     * @param args the command line arguments
+     */
+    public static void main(String args[]) {
+        java.awt.EventQueue.invokeLater(new Runnable() {
+            public void run() {
+                new AboutView(new javax.swing.JFrame(), true).setVisible(true);
+            }
+        });
+    }
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JPanel aboutTab;
+    private javax.swing.JTabbedPane aboutTabbedPane;
+    private javax.swing.JLabel authorsLabel;
+    private javax.swing.JLabel configDirLabel;
+    private javax.swing.JPanel detailTab;
+    private javax.swing.JLabel erikLabel;
+    private javax.swing.JLabel jakubLabel;
+    private javax.swing.JLabel javaLabel;
+    private javax.swing.JLabel kovoLabel;
+    private javax.swing.JLabel ladaLabel;
+    private javax.swing.JLabel osLabel;
+    private javax.swing.JLabel userDirLabel;
+    private javax.swing.JLabel versionLabel;
+    // End of variables declaration//GEN-END:variables
+    
+}

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -83,6 +83,7 @@
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.ProgressBar;
 import net.sf.plantlore.common.Selection;
 import net.sf.plantlore.common.StandardAction;
@@ -325,7 +326,8 @@
 		view.addDataHistoryAction(dataHistoryAction);
 		view.addDataWholeHistoryAction(dataWholeHistoryAction);
 		view.addDataUserAction(dataUserAction);
-
+                view.dataCreateDatabase.setAction(createNewDatabaseAction);
+                        
                 view.habitatTreeButton.setAction(habitatTreeAction);
                 
 		view.setSearchAction(searchAction);
@@ -410,6 +412,7 @@
 		dataHistoryAction.setEnabled(enabled);
 		dataWholeHistoryAction.setEnabled(enabled);
 		dataUserAction.setEnabled(enabled);
+                createNewDatabaseAction.setEnabled(enabled);
 
 		historyAction.setEnabled(enabled);
 		schedaAction.setEnabled(enabled);
@@ -467,7 +470,7 @@
 		}
 	}
 
-	/**
+	/** Bridge from settings to the rest of the application.
 	 * Assumes that user doesn't work with the Search dialog at time of the
 	 * update.
 	 * 
@@ -496,6 +499,9 @@
 		}
 	}
 
+        /** Handles the print action invoked from overview.
+         *
+         */
 	class PrintAction extends AbstractAction {
 		public PrintAction() {
 			putValue(NAME, L10n.getString("Print"));
@@ -511,11 +517,13 @@
 			}
 			Selection sel = model.getTableModel().getSelection();
 			if (sel.values().size() < 1) {
-				JOptionPane.showMessageDialog(view,
-						"Please check at least one record.");
+                            JOptionPane.showMessageDialog(view, 
+                                    L10n.getString("Message.CheckAnOccurrence"), 
+                                    L10n.getString("Message.CheckAnOccurrenceTitle"),
+                                    JOptionPane.INFORMATION_MESSAGE);
 				return;
 			}
-			printModel.setSource(model.getDatabase(), sel);
+			printModel.setSource(model.getDatabase(), sel);                        
 			printView.setVisible(true);
 		}
 	}
@@ -530,9 +538,8 @@
 			try {
 				model.savePreferences();
 			} catch (IOException ex) {
-                            //FIXME - aspon lokalizovat
 				JOptionPane.showMessageDialog(view,
-						"Problem while saving configuration: "
+						L10n.getString("Overview.ProblemSavingPreferences")+":"
 								+ ex.getMessage());
 			}
 
@@ -548,27 +555,36 @@
 		}
 	}
 
+        /** Handles help contents action.
+         *
+         */
 	class HelpContentsAction extends AbstractAction {
 		public HelpContentsAction() {
-			putValue(NAME, L10n.getString("helpContents"));
-			putValue(SHORT_DESCRIPTION, "Help contents");
-			putValue(MNEMONIC_KEY, L10n.getMnemonic("helpContents"));
+			putValue(NAME, L10n.getString("Overview.MenuHelp.Contents"));
+			putValue(SHORT_DESCRIPTION, "Overview.MenuHelp.ContentsTT");
+			putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.MenuHelp.Contents"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			System.out.println("Help contents selected");
+			logger.info("Invoking Help contents.");
 		}
 	}
 
+        /** Handles help about action.
+         *
+         */
 	class HelpAboutAction extends AbstractAction {
+            AboutView aboutView = new AboutView(view,true);
+            
 		public HelpAboutAction() {
-			putValue(NAME, L10n.getString("helpAbout"));
-			putValue(SHORT_DESCRIPTION, "Help about tooltip");
-			putValue(MNEMONIC_KEY, L10n.getMnemonic("helpAbout"));
+			putValue(NAME, L10n.getString("Overview.MenuHelp.About"));
+			putValue(SHORT_DESCRIPTION, "Overview.MenuHelp.AboutTT");
+			putValue(MNEMONIC_KEY, L10n.getMnemonic("Overview.MenuHelp.About"));
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			System.out.println("Help about selected");
+                    logger.info("Displaying help about dialog.");
+                    aboutView.setVisible(true);
 		}
 	}
 
@@ -1654,86 +1670,78 @@
 		}
 
 		public void update(final Observable targer, final Object parameter) {
-                    SwingUtilities.invokeLater( new Runnable() {
-                        public void run() {
-                            if (parameter != null && parameter instanceof DBLayer) {
-                                    loginAction.setEnabled(false);
-                                    view.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+                        if (parameter != null && parameter instanceof DBLayer) {
+                                loginAction.setEnabled(false);
+                                view.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
 
-                                    logger.debug("Database layer retrieval.");
-                                    DBLayer dblayer = loginModel.getDBLayer();
+                                logger.debug("Database layer retrieval.");
+                                DBLayer dblayer = loginModel.getDBLayer();
 
-                                    // FIXME: neni potreba zresetovat stav treba loginModelu, pokdu
-                                    // neco takhle selze? pripadne stav jinyho objektu?
-                                    try {
-                                            model.setDatabase(dblayer);
-                                    } catch (RemoteException ex) {
-                                        logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
-                                        ex.printStackTrace();
-                                        DefaultReconnectDialog.show(view,ex);
-                                        return;
-                                    } catch (DBLayerException ex) {
-                                        logger.error("Caught an error in AppCoreCtrl update(): "+ex.getMessage());
-                                        ex.printStackTrace();
-                                        DefaultReconnectDialog.show(view,ex);
-                                        return;
-                                    }
-                                    // distribute database to dialogs
-                                    addModel.setDatabase(dblayer);
-                                    editModel.setDatabase(dblayer);
-                                    searchModel.setDatabase(dblayer);
-                                    detailModel.setDatabase(dblayer);
+                                // FIXME: neni potreba zresetovat stav treba loginModelu, pokdu
+                                // neco takhle selze? pripadne stav jinyho objektu?
+                                try {
+                                        model.setDatabase(dblayer);
+                                } catch (RemoteException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                } catch (DBLayerException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                }
+                                // distribute database to dialogs
+                                addModel.setDatabase(dblayer);
+                                editModel.setDatabase(dblayer);
+                                searchModel.setDatabase(dblayer);
+                                detailModel.setDatabase(dblayer);
 
-                                    model.setAccessRights(loginModel.getAccessRights());
-                                    model.login();
+                                model.setAccessRights(loginModel.getAccessRights());
+                                model.login();
 
-                                    view.getSBM().display(L10n.getString("Message.FillingDialogs"));
-                                    fillDialogModels();
+                                view.getSBM().display(L10n.getString("Message.FillingDialogs"));
+                                fillDialogModels();
 
-                                    view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
-                                    searchModel.clear();
-                                    searchModel.constructQuery();
+                                view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
+                                searchModel.clear();
+                                searchModel.constructQuery();
 
-                                    view.getSBM().displayDefaultText();
+                                view.getSBM().displayDefaultText();
 
-                                    view.initOverview();
-                                    view.setCursor(Cursor.getDefaultCursor());
-                                    setDatabaseDependentCommandsEnabled(true);
+                                view.initOverview();
+                                view.setCursor(Cursor.getDefaultCursor());
+                                setDatabaseDependentCommandsEnabled(true);
 
-                                    //this can't be done earlier. must be done after the query is created
-                                    //otherwise this listener would give the overview table model commands to load data
-                                    //for a query that doesn't exist yet
-                                    view.overviewScrollPane.addComponentListener(overviewResizeListener);
+                                //this can't be done earlier. must be done after the query is created
+                                //otherwise this listener would give the overview table model commands to load data
+                                //for a query that doesn't exist yet
+                                view.overviewScrollPane.addComponentListener(overviewResizeListener);
 
-                                    /*-------------------------------------------------------------------
-                                     *  This may no longer be necessary:
-                                     *------------------------------------------------------------------*/
-                    logger.debug("Distributing the new database layer to:");
-                    logger.debug(" # export ");
-                                    if( exportModel != null )
-                                            exportModel.setDBLayer( dblayer );
-                                    logger.debug(" # occurrence data import ");
-                                    if( importModel != null )
-                                            importModel.setDBLayer( dblayer );
-                                    logger.debug(" # table data import ");
-                                    if( tableImportModel != null )
-                                            tableImportModel.setDBLayer( dblayer );
-                                    logger.debug(" # record history ");
-                                    if (historyModel != null ) 
-                                        historyModel.restartQuery(History.HISTORY_RECORD);
-                                    logger.debug(" # complete history ");
-                                    if (wholeHistoryModel != null ) 
-                                         wholeHistoryModel.restartQuery(History.HISTORY_WHOLE);
-                                    logger.debug(" # user manager ");
-                                    if (userManagerModel != null )
-                                            userManagerModel.setDBLayer( dblayer );
-                                    logger.debug(" # metadata manager ");
-                                    if (metadataManagerModel != null )
-                                            metadataManagerModel.setDBLayer( dblayer );							
-                            }//if
-                        }//run()
-                    });//invokeLater
-		}//update()
+                                /*-------------------------------------------------------------------
+                                 *  This may no longer be necessary:
+                                 *------------------------------------------------------------------*/
+                logger.debug("Distributing the new database layer to:");
+                logger.debug(" # export ");
+                                if( exportModel != null )
+                                        exportModel.setDBLayer( dblayer );
+                                logger.debug(" # occurrence data import ");
+                                if( importModel != null )
+                                        importModel.setDBLayer( dblayer );
+                                logger.debug(" # table data import ");
+                                if( tableImportModel != null )
+                                        tableImportModel.setDBLayer( dblayer );
+                                logger.debug(" # record history ");
+                                if (historyModel != null ) 
+                                    historyModel.restartQuery(History.HISTORY_RECORD);
+                                logger.debug(" # complete history ");
+                                if (wholeHistoryModel != null ) 
+                                     wholeHistoryModel.restartQuery(History.HISTORY_WHOLE);
+                                logger.debug(" # user manager ");
+                                if (userManagerModel != null )
+                                        userManagerModel.setDBLayer( dblayer );
+                                logger.debug(" # metadata manager ");
+                                if (metadataManagerModel != null )
+                                        metadataManagerModel.setDBLayer( dblayer );							
+                        }//if
+                    }//run()
 	}//DatabaseChange
 
 

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-02 16:53:00 UTC (rev 631)
@@ -132,6 +132,16 @@
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
               </AuxValues>
             </MenuItem>
+            <MenuItem class="javax.swing.JSeparator" name="jSeparator5">
+            </MenuItem>
+            <MenuItem class="javax.swing.JMenuItem" name="dataCreateDatabase">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="Item"/>
+              </Properties>
+              <AuxValues>
+                <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+              </AuxValues>
+            </MenuItem>
           </SubComponents>
         </Menu>
         <Menu class="javax.swing.JMenu" name="occurrencesMenu">
@@ -512,7 +522,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="1" pref="136" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="1" pref="100" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -19,6 +19,7 @@
 import javax.swing.event.ListSelectionListener;
 import javax.swing.table.TableColumn;
 import net.sf.plantlore.client.overview.*;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.StatusBarManager;
 import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
@@ -49,6 +50,8 @@
         fileExit.setToolTipText(L10n.getString("Overview.MenuFileExitTT"));
         fileExit.setMnemonic(L10n.getMnemonic("Overview.MenuFileExit"));
         
+        PlantloreHelp.addButtonHelp(PlantloreHelp.PLANTLORE_OVERVIEW,helpContents);
+
         setLocationRelativeTo(null);
         model.addObserver(this); 
         model.addObserver(sbm);
@@ -108,6 +111,8 @@
         dataMetadata = new javax.swing.JMenuItem();
         dataUser = new javax.swing.JMenuItem();
         dataWholeHistory = new javax.swing.JMenuItem();
+        jSeparator5 = new javax.swing.JSeparator();
+        dataCreateDatabase = new javax.swing.JMenuItem();
         occurrencesMenu = new javax.swing.JMenu();
         occurrencesAdd = new javax.swing.JMenuItem();
         occurrencesEdit = new javax.swing.JMenuItem();
@@ -239,7 +244,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 172, Short.MAX_VALUE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 100, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");
@@ -331,6 +336,11 @@
         dataWholeHistory.setText("Item");
         dataMenu.add(dataWholeHistory);
 
+        dataMenu.add(jSeparator5);
+
+        dataCreateDatabase.setText("Item");
+        dataMenu.add(dataCreateDatabase);
+
         jMenuBar1.add(dataMenu);
 
         occurrencesMenu.setMnemonic(L10n.getMnemonic("Overview.MenuOccurrences"));
@@ -710,6 +720,7 @@
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton addButton;
     protected javax.swing.JMenuItem dataAuthors;
+    protected javax.swing.JMenuItem dataCreateDatabase;
     private javax.swing.JMenuItem dataExport;
     private javax.swing.JMenuItem dataImport;
     protected javax.swing.JMenuItem dataImportTable;
@@ -741,6 +752,7 @@
     private javax.swing.JSeparator jSeparator2;
     private javax.swing.JSeparator jSeparator3;
     protected javax.swing.JSeparator jSeparator4;
+    private javax.swing.JSeparator jSeparator5;
     private javax.swing.JToolBar mainToolBar;
     private javax.swing.JButton nextPage;
     private javax.swing.JMenuItem occurrencesAdd;

Modified: trunk/src/net/sf/plantlore/client/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -46,7 +46,8 @@
     Logger logger;
     private static SplashScreen splashScreen;   
     private static final String LOGGER_PROPS = "net/sf/plantlore/config/log4j.properties";
-    private static final String PLANTLORE="plantlore";
+    public static final String PLANTLORE="plantlore";
+    public static final String VERSION="1.0";
     private static final String MAIN_CONFIG_NAME=PLANTLORE+".xml";
     
     /**

Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -33,6 +33,7 @@
         initComponents();
         
         new DefaultEscapeKeyPressed(this);
+        setLocationRelativeTo(parent);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-02 16:53:00 UTC (rev 631)
@@ -58,7 +58,7 @@
 			Exception e, 
 			String title, 
 			boolean doNotOfferReconnect) {
-		
+		e.printStackTrace();//FIXME - print to log perhaps!
 		boolean isReconnectReasonable = false;
 		String problemDescription = e.getMessage();
 		

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-02 16:53:00 UTC (rev 631)
@@ -1405,3 +1405,21 @@
 CreateDB.LeaveEmptyTT=May be handy for someone who doesn't wish to polute the database \nwith the names of Czech villages, territories, etc.
 
 CreateDB.Title=Create a new database
+Overview.About.About=About
+Overview.About.Detail=Detail
+Overview.About.Version=Version\: 
+Overview.About.Os=Os\: 
+Overview.About.Java=Java\:
+
+Overview.About.UserDir=User dir\: 
+Overview.About.ConfigDir=Config dir\: 
+
+Overview.About.Authors=Authors\: 
+
+Overview.MenuHelp.Contents=Contents
+
+Overview.MenuHelp.ContentsTT=Displays the help to Plantlore.
+
+Overview.MenuHelp.About=About
+
+Overview.MenuHelp.AboutTT=Displays info about Plantlore and this installation.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-02 16:53:00 UTC (rev 631)
@@ -1553,3 +1553,27 @@
 Overview.Transformation.Help=Pomoc
 
 Overview.Transformation.Change=P\u0159eve\u010F
+
+Overview.About.About=O programu
+
+Overview.About.Detail=Podrobnosti
+
+Overview.About.Version=Verze\: 
+
+Overview.About.Os=Os\: 
+
+Overview.About.Java=Java\: 
+
+Overview.About.UserDir=U\u017Eivatel\u016Fv adr.\: 
+
+Overview.About.ConfigDir=Konfig. adres\u00E1\u0159\:
+
+Overview.About.Authors=Auto\u0159i\: 
+
+Overview.MenuHelp.Contents=Obsah
+
+Overview.MenuHelp.ContentsTT=Zobraz\u00ED n\u00E1pov\u011Bdu k Plantlore.
+
+Overview.MenuHelp.About=O programu
+
+Overview.MenuHelp.AboutTT=Zobraz\u00ED informace o Plantlore a t\u00E9to instalaci.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-02 16:27:15 UTC (rev 630)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-02 16:53:00 UTC (rev 631)
@@ -1083,3 +1083,27 @@
 Overview.Transformation.Help=Help
 
 Overview.Transformation.Change=Change
+
+Overview.About.About=About
+
+Overview.About.Detail=Detail
+
+Overview.About.Version=Version\: 
+
+Overview.About.Os=Os\: 
+
+Overview.About.Java=Java\: 
+
+Overview.About.UserDir=User dir\:
+
+Overview.About.ConfigDir=Config dir\:
+
+Overview.About.Authors=Authors\: 
+
+Overview.MenuHelp.Contents=Contents
+
+Overview.MenuHelp.ContentsTT=Displays the help to Plantlore.
+
+Overview.MenuHelp.About=About
+
+Overview.MenuHelp.AboutTT=Displays info about Plantlore and this installation.



From fraktalek at mail.berlios.de  Sat Sep  2 18:57:41 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 18:57:41 +0200
Subject: [Plantlore-dev] r632 - trunk/src/net/sf/plantlore/common
Message-ID: <200609021657.k82GvfId025203@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 18:57:35 +0200 (Sat, 02 Sep 2006)
New Revision: 632

Modified:
   trunk/src/net/sf/plantlore/common/Utils.java
Log:
Codebase gen. should work on windows too now.



Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 16:53:00 UTC (rev 631)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 16:57:35 UTC (rev 632)
@@ -76,7 +76,10 @@
         if (url.getProtocol().equals("jar")) {
             //remove path to the package and the trailing "!/"
             dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
-            dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+            if (System.getProperty("os.name").equals("windows"))//on windows there's one more slash after file:
+                dir = dir.substring(dir.indexOf("file:")+6);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+            else
+                dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
         } else {
             //remove the path to the package and a trailing slash        
             dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/")));            



From kovo at mail.berlios.de  Sat Sep  2 19:12:54 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sat, 2 Sep 2006 19:12:54 +0200
Subject: [Plantlore-dev] r633 - trunk/src/net/sf/plantlore/server
Message-ID: <200609021712.k82HCsQ3028672@sheep.berlios.de>

Author: kovo
Date: 2006-09-02 19:12:53 +0200 (Sat, 02 Sep 2006)
New Revision: 633

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Save unique DB identifier and unique record identifier when adding new occurrence. Fixed bug in saveHistory() causing db connection leak.

IMPORTANT: Database table tunitiddatabase must contain at least one record (currently it is empty). Insert something (doesn't matter what) to this table.

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-02 16:57:35 UTC (rev 632)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-02 17:12:53 UTC (rev 633)
@@ -23,6 +23,7 @@
 import java.util.Set;
 
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.UniqueIDGenerator;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.Habitat;
@@ -37,6 +38,7 @@
 import net.sf.plantlore.common.record.Record;
 import net.sf.plantlore.common.record.Right;
 import net.sf.plantlore.common.record.Territory;
+import net.sf.plantlore.common.record.UnitIdDatabase;
 import net.sf.plantlore.common.record.User;
 import net.sf.plantlore.common.record.NearestVillage;
 import net.sf.plantlore.l10n.L10n;
@@ -94,7 +96,9 @@
     private User plantloreUser;
     /** Rights of the authenticated user */
     private Right rights;    
-
+    /** Unique identifier of the database we are connected to */
+    private String databaseID;
+    
     private Session txSession;
     private Transaction longTx;            
             
@@ -215,6 +219,14 @@
             Object[] userinfo = sr.get();
             plantloreUser = (User)userinfo[0];
             rights = plantloreUser.getRight();
+            // Load unique database identifier
+            sr = sess.createCriteria(UnitIdDatabase.class).scroll();            
+            if( ! sr.next() ) {
+            	logger.debug("DBLayer Initialization - things are not going well. sr.get() returned null!");
+            	throw new DBLayerException(L10n.getString("Error.ConnectionFailed"), DBLayerException.ERROR_CONNECT);
+            }
+            Object[] unitiddatabase = sr.get();
+            this.databaseID = ((UnitIdDatabase)unitiddatabase[0]).getUnitIdDb();
             logger.debug("DBLayer Initialization - finished!");
         } 
         catch (JDBCException e) {
@@ -253,15 +265,15 @@
         }
     }
     
-    protected void completeRecord(Object record) {
+    protected void completeRecord(Object record) throws DBLayerException {
     	java.util.Date now = new Date();
         if(record instanceof Occurrence) {
             Occurrence occ = (Occurrence)record;
             occ.setCreatedWhen(now);
             occ.setCreatedWho(this.plantloreUser);
-            /*
-             * TODO: UNIQUE ID MUST BE SET AS WELL
-             */
+            // Set UniqueID for the record and database
+            occ.setUnitIdDb(this.databaseID);
+            occ.setUnitValue("TODO");
         } else if(record instanceof Habitat) {
             ((Habitat)record).setCreatedWho(this.plantloreUser);
         } else if(record instanceof Publication) {
@@ -306,8 +318,7 @@
         // If we should not use our own transaction, we must use the stored one.
         Session session = useOwnTransaction ? sessionFactory.openSession() : this.txSession;
         int recordId = -1;
-        try {
-            
+        try {            
             // Begin transaction, if it is required. If not, the `tx` stays null.
             if(useOwnTransaction) tx = session.beginTransaction();
             
@@ -360,10 +371,9 @@
             }
             throw new DBLayerException(L10n.getString("Error.DatabaseOperationFailed"), exceptionType, e);
         } finally {
-        	// We must close only our own sessions!
+            // We must close only our own sessions!
             if(useOwnTransaction) session.close();
         }
-        
         return recordId;
     }
     
@@ -1469,6 +1479,7 @@
                 sq.addRestriction(PlantloreConstants.RESTR_IS_NULL, HistoryColumn.COLUMNNAME, null, null, null);
                 result = this.executeQuery(sq);
                 objCol = next(result);                
+                this.closeQuery(sq);
             } catch (RemoteException e) {
                 logger.error("Remote exception caught in DBLayer. This should never happen. Details: "+e.getMessage());
             }



From krater at mail.berlios.de  Sat Sep  2 19:28:42 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 2 Sep 2006 19:28:42 +0200
Subject: [Plantlore-dev] r634 - trunk/src/net/sf/plantlore/common
Message-ID: <200609021728.k82HSfrU002945@sheep.berlios.de>

Author: krater
Date: 2006-09-02 19:28:37 +0200 (Sat, 02 Sep 2006)
New Revision: 634

Modified:
   trunk/src/net/sf/plantlore/common/Utils.java
Log:
Utils updated. Must be tested on linux and from the jar as well.

Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 17:12:53 UTC (rev 633)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 17:28:37 UTC (rev 634)
@@ -65,26 +65,35 @@
         //"jar:file:/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
         
         try {            
-            dir = URLDecoder.decode(url.getPath(),"UTF-8");
+            dir = URLDecoder.decode(url.getPath(),URL_ENCODING);
         } catch (UnsupportedEncodingException ex) {
             logger.error("Utils.java: the URLDecoder complains about unsupported URL encoding: \""+URL_ENCODING+"\"");
             return null;
         }
 
         //clear off the file name
-        dir = dir.substring(0,dir.lastIndexOf("/"));
-        if (url.getProtocol().equals("jar")) {
-            //remove path to the package and the trailing "!/"
-            dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
-            if (System.getProperty("os.name").equals("windows"))//on windows there's one more slash after file:
-                dir = dir.substring(dir.indexOf("file:")+6);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
-            else
-                dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
-        } else {
-            //remove the path to the package and a trailing slash        
-            dir = dir.substring(0,dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/")));            
-        }
         
+        // The following code should not be necessary as the dir = url.getPath(), 
+        // ie. from the "jar:file:/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
+        // just the "/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
+        // will remain.
+        
+//        //dir = dir.substring(0,dir.lastIndexOf("/"));
+//        if (url.getProtocol().equals("jar")) {
+//            //remove path to the package and the trailing "!/"
+//            dir = dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/"))-2);
+//            if (System.getProperty("os.name").toLowerCase().startsWith("win")) //on windows there's one more slash after file:
+//                dir = dir.substring(dir.indexOf("file:")+6);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"
+//            else
+//                dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+//        } else {
+            // Just remove the path to the package
+        	if (System.getProperty("os.name").toLowerCase().startsWith("win"))
+        		dir = dir.substring(1, dir.indexOf(Utils.class.getName().replaceAll("\\.", "/")));
+        	else
+        		dir = dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/")));            
+//        }
+        
         return dir;
     }
     



From fraktalek at gmx.net  Sat Sep  2 22:24:28 2006
From: fraktalek at gmx.net (fraktalek)
Date: Sat, 02 Sep 2006 22:24:28 +0200
Subject: [Plantlore-dev] How to: run (selected) file v Netbeansech i ve
	freeform projektu	(tj. s vlastnim build.xml)
Message-ID: <1157228668.28873.11.camel@kryton>

Po prechodu na freeform projekt v Netbeansech prestane par prikazu
fungovat, jeden z nich je Run -> Run File (Shift-F6).

Tady je navod, jak to zase zprovoznit. Podobne si je mozne upravit i asi
14 dalsich prikazu, vice viz
http://www.netbeans.org/kb/55/freeform-config.html


Do build.xml je potreba pridat cil spoustejici zadanou tridu:
 <target name="run-selected-file" depends="build" description="Run
Single File">
          <fail unless="classname">Must set property 'classname'</fail>
          <java classname="${classname}">
              <classpath>
                  <pathelement
location="${dist.dir}/plantlore-client.jar"/>
              </classpath>
          </java>
       </target>

Tuhle upravu hned commitnu.

Pak je potreba uz jen pridat nasledujici dva kusy kodu na spravne misto
do nbproject/project.xml :
do tagu <ide-actions> pujde:
                <action name="run.single">
                    <target>run-selected-file</target>
                    <context>
                        <property>classname</property>
                        <folder>${src.dir}</folder>
                        <format>java-name</format>
                        <arity>
                            <one-file-only/>
                        </arity>
                    </context>
                </action>       

a nahoru mezi tag <name> a tag <folders> pujde:
            <properties>
              <property name="src.dir">src</property>
            </properties>

A to je vse. Neni ani potreba zavrit a znova otevrit projekt nebo
restartovat IDE. Zacne to fungovat hned jak to nastavite spravne (do te
doby bude ten prikaz v menu sedy a nefunkcni).


POZN.: predpoklada se, ze adresar nbproject je umisten v projektovem
adresari, tj. u Plantlore to je v adresari, kde se nachazi adresare src,
documentation, test, ...




From krater at mail.berlios.de  Sat Sep  2 22:30:55 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 2 Sep 2006 22:30:55 +0200
Subject: [Plantlore-dev] r635 - in trunk/src/net/sf/plantlore: client
	client/occurrenceimport common middleware server
	server/manager server/tools
Message-ID: <200609022030.k82KUtnA004850@sheep.berlios.de>

Author: krater
Date: 2006-09-02 22:30:53 +0200 (Sat, 02 Sep 2006)
New Revision: 635

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
   trunk/src/net/sf/plantlore/common/Utils.java
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/middleware/DBLayerFactory.java
   trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java
   trunk/src/net/sf/plantlore/middleware/RemoteDBLayerFactory.java
   trunk/src/net/sf/plantlore/middleware/SelectQuery.java
   trunk/src/net/sf/plantlore/server/CertificationException.java
   trunk/src/net/sf/plantlore/server/ConnectionInfo.java
   trunk/src/net/sf/plantlore/server/DatabaseSettings.java
   trunk/src/net/sf/plantlore/server/Guard.java
   trunk/src/net/sf/plantlore/server/Plantlore.java
   trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/RMIServerControl.java
   trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
   trunk/src/net/sf/plantlore/server/Server.java
   trunk/src/net/sf/plantlore/server/ServerSettings.java
   trunk/src/net/sf/plantlore/server/Undertaker.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Added more JavaDoc, code verification, some minor changes (RMIDBLayerFactory has been made a singleton).

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -1520,7 +1520,7 @@
 			// needed.
 			if (loginModel == null) {
 				loginModel = new Login(
-						new RMIDBLayerFactory( model.getMainConfig().getCodebase() ), 
+						RMIDBLayerFactory.getDBLayerFactory(), 
 						model.getMainConfig());
 				loginModel.addObserver(new DatabaseChange()); // Callback ~ redistribution of DBLayer.
 				loginView = new LoginView(view, loginModel);

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -19,12 +19,15 @@
 /**
  * The Occurrence Import task instructs the Parser to start parsing the file
  * and every time a record is reconstructed, it is processed here (via a callback).
+ * The record is processed using the <code>DBLayerUtils.processRecord()</code>.
  * <br/>
  * The task can be cancelled.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-08-14
  * @version 1.0
+ * 
+ *  @see net.sf.plantlore.common.DBLayerUtils#processRecord(Occurrence, AuthorOccurrence[])
  */
 public class OccurrenceImportTask extends Task implements RecordProcessor {
 	
@@ -101,6 +104,10 @@
 	 * Some erros may be ignored (such as insufficient access rights)
 	 * i.e. the whole import procedure will not fail, just the problematic 
 	 * record will be rejected. 
+	 * <br/>
+	 * The record is processed using the <code>DBLayerUtils.processRecord()</code>.
+	 * 
+	 * @see net.sf.plantlore.common.DBLayerUtils#processRecord(Occurrence, AuthorOccurrence[])
 	 */
 	public void processRecord(AuthorOccurrence... aos) 
 	throws DBLayerException, RemoteException {

Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -72,27 +72,18 @@
         }
 
         //clear off the file name
-        
-        // The following code should not be necessary as the dir = url.getPath(), 
-        // ie. from the "jar:file:/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
-        // just the "/home/fraktalek/cvs/plantlore/dist/plantlore-client.jar!/net/sf/plantlore/common/Utils.class"
-        // will remain.
-        
-//        //dir = dir.substring(0,dir.lastIndexOf("/"));
-//        if (url.getProtocol().equals("jar")) {
-//            //remove path to the package and the trailing "!/"
-//            dir = dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/"))-2);
-//            if (System.getProperty("os.name").toLowerCase().startsWith("win")) //on windows there's one more slash after file:
-//                dir = dir.substring(dir.indexOf("file:")+6);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"
-//            else
-//                dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
-//        } else {
+        if (url.getProtocol().equals("jar")) {
+        	dir = dir.substring(0, dir.lastIndexOf("/"));
+            //remove path to the package and the trailing "!/"
+            dir = dir.substring(0, dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
+            dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+        } else {
             // Just remove the path to the package
         	if (System.getProperty("os.name").toLowerCase().startsWith("win"))
         		dir = dir.substring(1, dir.indexOf(Utils.class.getName().replaceAll("\\.", "/")));
         	else
         		dir = dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/")));            
-//        }
+        }
         
         return dir;
     }

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -16,11 +16,10 @@
 import net.sf.plantlore.common.exception.DBLayerException;
 
 /**
- * Interface for database access.
+ * The interface for a database layer wrapper.
  * 
- * TODO: Zdokumentovat metody interface!
- *
- * @author Tom?? Kova??k, Erik Kratochv?l
+ * @author Tom?? Kova??k
+ * @author Erik Kratochv?l
  */
 public interface DBLayer extends Remote, Serializable {
 	
@@ -356,11 +355,9 @@
     /**
      * This method is intended for final cleanup. <b>Do not call this method
      * yourself! The proper way for you to get rid of a DBLayer is to call
-     * DBLayer.destroy() method!</b> <br/> Terminate all processes running in
-     * this DBLayer, disconnect from the database and destroy all objects
-     * created by this DBLayer. <br/> <b>After this the DBLayer will not be
-     * capable of carrying out its duties.</b> <br/> This method is supposed to
-     * be used by the DBLayerFactory exclusively.
+     * DBLayerFactory.destroy() method!</b> <br/> Terminates all processes running in
+     * this DBLayer, disconnects from the database and destroys all objects
+     * created by this DBLayer. <br/> 
      */
     public void shutdown() throws RemoteException;
            

Modified: trunk/src/net/sf/plantlore/middleware/DBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayerFactory.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/middleware/DBLayerFactory.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -7,32 +7,35 @@
 import net.sf.plantlore.common.exception.DBLayerException;
 
 /** 
- * Interface for obtaining the (possibly remote) DBLayer object.
+ * The interface for the Database Layer Factory.
+ * The creation of the Database Layer is very complex
+ * and it is not possible to achieve the desired complexity
+ * by a simple <i>new DBLayer</i>.
+ * <br/> 
+ * The Database Layer Factory is capable of both creating a new
+ * database layer and its proper destruction.
  * 
- * @author Erik Kratocvh?l
- * @version 1.0 final
- * @since The beginning of time.
+ * @author Erik Kratochv?l
+ * @version 1.0
+ * @since 2006-03-01
  */
 public interface DBLayerFactory {
 	
 
 	/** 
-	 * Create a new instance of the DBLayer that will manage the connection to the remote database.
+	 * Create a new instance of the Database Layer 
+	 * that will manage the connection to the (possibly remote) database.
+	 *
+	 *  @param settings	The information that are necessary for the Database Layer creation.
 	 *  
-	 * @param host	Hostname of the server.
-	 * @param port	Port where the server is listening.
-	 * @return	Remote reference of the DBLayer.
-	 * @throws RemoteException		If the RMI encounters a problem.
-	 * @throws NotBoundException	If the server is not running on the specified port.
+	 *  @see net.sf.plantlore.client.login.DBInfo
 	 */
 	DBLayer create(DBInfo settings) throws RemoteException, NotBoundException, DBLayerException;
 	
 	/** 
-	 * Destroy the DBLayer. This is a special measure, 
-	 * so that the db connection can be closed and the object disconnected (unexported).
+	 * Destroy the Database Layer properly. After this call the Database Layer should not be used anymore.
 	 * 
 	 * @param db		The DBLayer to be destroyed.
-	 * @throws RemoteException		If the RMI encounters a problem.
 	 */
 	void destroy(DBLayer db) throws RemoteException;
 

Modified: trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -11,6 +11,7 @@
 import net.sf.plantlore.server.ConnectionInfo;
 import net.sf.plantlore.server.DatabaseSettings;
 import net.sf.plantlore.client.login.DBInfo;
+import net.sf.plantlore.common.Utils;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.server.HibernateDBLayer;
 import net.sf.plantlore.server.tools.RMI;
@@ -19,12 +20,11 @@
 
 
 /**
- * The RMIDBLayerFactory can create and destroy DBLayers - either local or remote. 
+ * The RMIDBLayerFactory can create and destroy Database Layers (DBLayers in short) 
+ * - either local or remote. 
  * The client should ask the factory to create the DBLayer and the factory will shield him from
  * all the details how the DBLayer is created or where those objects really live.
  * <br/>
- * RMIDBLayer factory lives in the client's JVM.   
- * <br/>
  * The RMIDBLayerFactory keeps track of all database layers it has created and where they
  * actually live.
  * <table>
@@ -35,50 +35,65 @@
  * <br/>
  * The DBLayer factory is responsible for creating and destroying DBLayers.
  * It has no responsibility for initialization of those DBLayers.
+ * <br/>
+ * The RMIDBLayerFactory is a singleton.
  * 
  *  
  * @author Erik Kratochv?l
  * @since 2006-03-11
- * @version 1.0 final
+ * @version 1.0
   */
 public class RMIDBLayerFactory implements DBLayerFactory {
 	
-	private Logger logger = Logger.getLogger(this.getClass().getPackage().getName()); 
+	private static Logger logger = Logger.getLogger(RMIDBLayerFactory.class.getPackage().getName()); 
 	
+	private static RMIDBLayerFactory databaseLayerFactory;
 	
+	
 	/** Keep information about connections to databases. */
 	private Hashtable<DBLayer, ConnectionInfo> client = new Hashtable<DBLayer, ConnectionInfo>(4);
 	
 	
-	/** Create a new instance of DBLayerFactory. */
-	public RMIDBLayerFactory(String codebase) {
-		if(codebase == null)
-			logger.warn("The codebase may not have been set! This may cause serious problems when trying to connect to a remote database! It is imperative you make sure the codebase is set properly!!");
-		net.sf.plantlore.server.tools.RMI.addToCodebase( codebase );
+	/** 
+	 * Create a new instance of DBLayerFactory.
+	 * The RMIDBLayerFactory is a singleton and can be obtained via getDBLayerFactory() only. 
+	 */
+	private RMIDBLayerFactory() {}
+	
+	/**
+	 * Construct a new Database Layer factory. 
+	 * 
+	 * @return	The new Database Layer factory.
+	 */
+	public static DBLayerFactory getDBLayerFactory() {
+		if(databaseLayerFactory == null) {
+			String codebase = Utils.getCodeBasePath();
+			if(codebase == null)
+				logger.warn("The codebase may not have been set! This may cause serious problems when trying to connect to a remote database! It is imperative you make sure the codebase is set properly!!");
+			else
+				net.sf.plantlore.server.tools.RMI.addToCodebase( codebase );
+			
+			databaseLayerFactory = new RMIDBLayerFactory();
+		}
+		return databaseLayerFactory;
 	}
 	
 	
 	/**
 	 * Create a new DBLayer.
 	 * <br/>
-	 * This method is meant for connections to remote databases. 
-	 * The DBLayerFactory asks the server's RemoteDBLayerFactory to
-	 * create a new DBLayer object there. The RemoteDBLayerFactory
-	 * returns a stub of that object, which is what the caller will obtain.
+	 * The Database Layer may be either local or remote, 
+	 * but the caller should spot no difference. 
 	 * 
-	 * @param host	Hostname of the computer where server runs.
-	 * @param port	Port where the server listens.
-	 * 
-	 * @return A stub of the remote object that lives on the server and mediates the connection
-	 * with the remote database.
+	 * @param settings	The information that are necessary for the Database Layer creation.
+	 * @return The newly constructed Database Layer.
 	 */
 	public synchronized DBLayer create(DBInfo settings) 
 	throws RemoteException, NotBoundException, DBLayerException {
-		// Some exceptional cases are handled specially.
 		String host = settings.getHost();
 		
 		// ~~~ LOCAL CONNECTION ~~~
-		if(host == null || host.equals("") /*|| host.equalsIgnoreCase("localhost")*/) {
+		if( host == null || host.equals("") ) {
 			
 			DatabaseSettings dbSettings = new DatabaseSettings(
 					settings.getDatabaseType(),
@@ -132,7 +147,7 @@
 	}
 
 	/**
-	 * Destroy a DBLayer instance. This is necessary for remote DBLayers, 
+	 * Destroy a Database Layer. This is necessary especially with remote DBLayers, 
 	 * because the server keeps track of all connected clients
 	 * and has a certain limit of how many clients can be connected simultaneously.
 	 * Therefore we should tell the server we want to disconnect from it so as not to

Modified: trunk/src/net/sf/plantlore/middleware/RemoteDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/RemoteDBLayerFactory.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/middleware/RemoteDBLayerFactory.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -9,19 +9,19 @@
  * Interface for obtaining remote references of the DBLayer objects running on some remote server.
  * 
  * @author Erik Kratochv?l
- * @version 1.0 final
+ * @version 1.0
  * @since	2006-03-13	
  */
 public interface RemoteDBLayerFactory extends Remote {
 	
-	/** The name the Remote Factory will be bound to. */
+	/** The name the Remote Factory will use in the RMIRegistry. */
 	static final String ID = "PlantloreRemoteDBLayerFactoryID";
 	
 	/** 
 	 * Create a new DBLayer on the server and return a remote reference of that object. 
 	 * The object is "private" = unique for every client.
 	 * 
-	 * The number of connections from one host is limited as well as the total number of
+	 * The number of connections from one host may be limited as well as the total number of
 	 * all clients connected to the server.
 	 * 
 	 * @see RMIRemoteDBLayerFactory

Modified: trunk/src/net/sf/plantlore/middleware/SelectQuery.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/SelectQuery.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/middleware/SelectQuery.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -15,7 +15,7 @@
  *
  * FIXME Tie metody by asi mali hadzat DBLayerException a prekladat vyhadzovane HibernateExceptions
  *
- * @author Erik Kratochv?l (discontinuum at gmail.com), Tom?? Kova??k (kovo at matfyz.cz)
+ * @author Tom?? Kova??k (kovo at matfyz.cz)
  * @since 2006-03-26
  */
 public interface SelectQuery extends Serializable, Remote {

Modified: trunk/src/net/sf/plantlore/server/CertificationException.java
===================================================================
--- trunk/src/net/sf/plantlore/server/CertificationException.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/CertificationException.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -1,6 +1,13 @@
 package net.sf.plantlore.server;
 
-
+/**
+ * The Certification exception states that the access to the Administration
+ * of the Server was denied, usually due to the incorrect authorization key.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-05-30
+ *
+ */
 public class CertificationException extends Exception {
 	
 	private static final long serialVersionUID = 2006060411064L;

Modified: trunk/src/net/sf/plantlore/server/ConnectionInfo.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -6,17 +6,17 @@
 import net.sf.plantlore.middleware.RemoteDBLayerFactory;
 
 /**
- *  Information the particular connection:
+ *  Information about the connection:
  *  <ul>
- *  <li><code>database</code> = the DBLayer object that mediates the connection to the database</li>
- *   <li><code>stub</code> = the stub of the DBLayer object that mediates the connection to the database</li>
- *  <li><code>remote factory</code> = null if the object is created locally or reference of the factory that created the <code>database</code></li>
- *  <li><code>client host</code> = identification of the computer for which the <code>database</code> was created</li>
+ * <li>remoteFactory	The RemoteDBLayerFactory that created the remote object.</li>
+ * <li>db	 The remote object.</li>
+ * <li>stub The remote reference (stub) of that object.</li>
+ * <li>description		The description of the connection.</li>
  *  </ul>
  * 
  * @author Erik Kratochv?l
  * @since 2006-03-13
- * @version 1.0 final
+ * @version 1.0
  */
 public class ConnectionInfo implements Serializable {
 	
@@ -26,7 +26,7 @@
 	private RemoteDBLayerFactory remoteFactory = null;
 	private DBLayer database = null;
 	private DBLayer stub = null;
-	private String clientHost = null;
+	private String description = null;
 	
 	/**
 	 * Create a new record holding the information about the client's connection.
@@ -34,28 +34,47 @@
 	 * @param remoteFactory	The RemoteDBLayerFactory that created the remote object.
 	 * @param db	 The remote object.
 	 * @param stub The remote reference (stub) of that object.
-	 * @param client		Host name of the computer where client dwells.
+	 * @param description		The description of the connection.
 	 */
-	public ConnectionInfo(RemoteDBLayerFactory remoteFactory, DBLayer db, DBLayer stub, String client) {
-		this.remoteFactory = remoteFactory; this.database = db; this.stub = stub; this.clientHost = client;
+	public ConnectionInfo(RemoteDBLayerFactory remoteFactory, DBLayer db, DBLayer stub, String description) {
+		this.remoteFactory = remoteFactory; this.database = db; this.stub = stub; this.description = description;
 	}
 
-	/** The name of the host where the client is hiding. */
-	public String getClientHost() { return clientHost; }
-	
-	/** The remote object or remote reference (stub) that allows the client to work with the database. */
-	public DBLayer getDatabase() { return database; }
-	
-	/** The remote factory that created the remote object and returned the stub of it. 
-	 * If it is null, the object is local. */
-	public RemoteDBLayerFactory getRemoteFactory() { return remoteFactory; }
-	
-	/** Stub. */
-	public DBLayer getStub() { return stub; }
-	
+	/** 
+	 * 
+	 * @return	The description of the connection.
+	 */
+	public String getDescription() {
+		return description;
+	}
+
+	/**
+	 * 
+	 * @return The remote object or remote reference (stub) that allows the client to
+	 * work with the database.
+	 */
+	public DBLayer getDatabase() {
+		return database;
+	}
+
+	/**
+	 * @return The remote factory that created the remote object, or null, if the object is local.
+	 */
+	public RemoteDBLayerFactory getRemoteFactory() {
+		return remoteFactory;
+	}
+
+	/** 
+	 * 
+	 * @return	The stub.
+	 */
+	public DBLayer getStub() {
+		return stub;
+	}
+
 	@Override
 	public String toString() {
-		return database + " @ " + clientHost;
+		return database + " @ " + description;
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/DatabaseSettings.java
===================================================================
--- trunk/src/net/sf/plantlore/server/DatabaseSettings.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/DatabaseSettings.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -1,5 +1,13 @@
 package net.sf.plantlore.server;
 
+/**
+ * The holder object containing the settings that are needed 
+ * to connect to the database on the server side.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-01
+ * @version 1.0
+ */
 public class DatabaseSettings {
 	
 	private static final long serialVersionUID = 2006081333004L;
@@ -9,7 +17,13 @@
 	private int port;
 	private String database;
 	
-	
+	/**
+	 * Create new Database settings.
+	 * 
+	 * @param database	The database engine.
+	 * @param port	The port where the database listens.
+	 * @param suffix	Additional information that may be required for the connection.
+	 */
 	public DatabaseSettings(String database, int port, String suffix) {
 		this.connectionStringSuffix = suffix;
 		this.database = database;
@@ -19,16 +33,34 @@
 			((port > 0) ? ":"+(Integer.toString(port))+"/" : "/");
 	}
 	
-	
+	/**
+	 * 
+	 * @return The additional information that may be required for the connection
+	 */
 	public String getConnectionStringSuffix() {
 		return connectionStringSuffix;
 	}
+	
+	/**
+	 * 
+	 * @return	The first part of the JDBC connection string created from the supplied data.
+	 */
 	public String getConnectionStringPrefix() {
 		return connectionStringPrefix;
 	}
+	
+	/**
+	 * 
+	 * @return	The database engine.
+	 */
 	public String getDatabase() {
 		return database;
 	}
+	
+	/**
+	 * 
+	 * @return	The port where the database listens.
+	 */
 	public int getPort() {
 		return port;
 	}

Modified: trunk/src/net/sf/plantlore/server/Guard.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Guard.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/Guard.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -3,10 +3,31 @@
 import java.rmi.Remote;
 import java.rmi.RemoteException;
 
+/**
+ * An interface that guards the access to the Server
+ * for administration purposes.
+ * <br/>
+ * In order to manage the Server (terminate the Server, view
+ * the list of connected clients, disconnecting the clients, etc.)
+ * the User must pass the authorization procedure and
+ * supply valid authorization key (password).
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-05-30
+ */
 public interface Guard extends Remote {
 	
 	final static String ID = "PlantloreRMIServerGuard";
 
+	/**
+	 * In order to connect to the server to administrate it,
+	 * you must pass this certification test. If the authorization information
+	 * fits, the Server will be returned.
+	 * 
+	 * @param authorizationInfo	The password protecting the Server.
+	 * @return	The server if the authorization was correct.
+	 * 
+	 */
 	Server certify(String authorizationInfo) throws RemoteException, CertificationException;
 	
 }

Modified: trunk/src/net/sf/plantlore/server/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -17,17 +17,21 @@
 
 
 /**
- * Temporary solution.
+ * The entry point when starting the Server. 
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
- * @since 30.3.2006
- * @version beta not tested
+ * @since 2006-03-30
+ * @version 1.0
  */
 public class Plantlore {
 	
 	private static final String LOGGER_PROPS = "net/sf/plantlore/config/log4j.properties";
 	
-	
+	/**
+	 * Configure the basic components the Server will use, 
+	 * create the GUI and display it.
+	 *
+	 */
 	public void run() {
 		// Load log4j settings
 		try {
@@ -54,11 +58,7 @@
 	}
 	
 
-	/**
-	 * 
-	 * @param args Controlling the server from the command line:
-	 * 		start|stop|who|kick=id [host] [port]
-	 */
+	
 	public static void main(String[] args) {
 		
 		// Set beautiful system look & feel.

Modified: trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -6,32 +6,37 @@
 import java.rmi.server.UnicastRemoteObject;
 import java.util.Collection;
 import java.util.Hashtable;
-import net.sf.plantlore.common.exception.DBLayerException;
 
 import org.apache.log4j.Logger;
 
+import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 import net.sf.plantlore.server.HibernateDBLayer;
 import net.sf.plantlore.middleware.RemoteDBLayerFactory;
 
 /**
- * RMIRemoteDBLayerFactory is responsible for creating and exporting instances of DBLayer.
- * Remote references to these objects are returned to the caller. All methods are synchronized. 
+ * RMIRemoteDBLayerFactory is responsible for management of Database Layers
+ * on the remote machine. It can create and destroy them, it stores the list of
+ * all created Database Layers (i.e. list of connected clients) and can disconnect the
+ * selected client.
  * <br/>
- * The proper way to disconnect all remote clients from the server has these steps:
+ * It is a remote object so clients can connect to this factory and ask it to create 
+ * a Database Layer for them.
+ * <br/>
+ * To stop the RMIRemoteDBLayerFactory properly, one must do the following steps:
  * <ol>
- * <li>removing the RemoteDBLayerFactory from the rmiregistry, so that no more clients can obtain a reference
+ * <li>Remove the RemoteDBLayerFactory from the rmiregistry, so that no more clients can obtain a reference
  * of the factory and ask it for creating a new dblayer</li>
- * <li>unexporting the RemoteDBLayerFactory, so that it cannot accept remote calls, so that all clients that
+ * <li>Unexport the RemoteDBLayerFactory, so that it cannot accept remote calls, so that all clients that
  * have a remote reference of this factory cannot ask it for another dblayer</li>
- * <li>"kicking" all currently connected users by unexporting their dblayer remote objects, which will terminate their
- * connections effectively</li>
+ * <li>"Kick" all currently connected users by unexporting their dblayer remote objects, 
+ * which will terminate their connections for good.</li>
  * </ol>
  * 
  * 
  * @author Erik Kratochv?l
  * @since 2006-03-13
- * @version 1.0  final
+ * @version 1.0
  */
 public class RMIRemoteDBLayerFactory extends UnicastRemoteObject
 	implements RemoteDBLayerFactory {
@@ -50,9 +55,11 @@
 	
 	/** 
 	 * Create a new RMIDBLayerFactory.
-	 * @throws RemoteException If the RMI encounters an error.
+	 * 
+	 * @param settings The settings of the server. 
 	 */
-	public RMIRemoteDBLayerFactory(ServerSettings settings) throws RemoteException {
+	public RMIRemoteDBLayerFactory(ServerSettings settings) 
+	throws RemoteException {
 		this.settings = settings;
 		clients = new Hashtable<DBLayer, ConnectionInfo>( settings.getConnectionsTotal() );
 		undertaker = new RMIUndertaker();
@@ -62,9 +69,10 @@
 	/** 
 	 * Return information about connected clients.
 	 * 
-	 *  @return Collection holding information about currently connected clients.
+	 *  @return The list of currently connected clients.
 	 */
-	protected synchronized ConnectionInfo[] getClients() {
+	protected synchronized ConnectionInfo[] getClients() 
+	throws RemoteException {
 		Collection<ConnectionInfo> currentlyConnectedClients = clients.values();
 		if(currentlyConnectedClients != null) 
 			return currentlyConnectedClients.toArray(new ConnectionInfo[0]);
@@ -84,21 +92,21 @@
 		
 		int c = 0;
 		for(ConnectionInfo info : clients.values())
-			if(info.getClientHost().equalsIgnoreCase(host)) 
+			if(info.getDescription().equalsIgnoreCase(host)) 
 				c++; // HA! C++ in Java! Strange!
 		return (c < settings.getConnectionsPerIP());
 	}
 	
 	/**
 	 * Create a new remote object, export it so that the object can accept remote calls, and return the
-	 * stub of this object. The creation of new connection must adhere to the connection policy.
+	 * stub of this object. The creation of new connection must abide by the connection policy.
 	 * 
 	 * @return Remote reference (stub) of the remote DBLayer object or 
 	 * <b>null</b> if the server doesn't approve of creating the DBLayer
 	 * (too many connections from this IP or too many clients connected). 
-	 * @throws RemoteException If the RMI encounters an error.
 	 */
-	public synchronized DBLayer create() throws RemoteException, DBLayerException {
+	public synchronized DBLayer create()
+	throws RemoteException {
 		// Apply the connection policy ~ see AllowConnection(host)
 		String clientHost = "unknown";
 		try { clientHost = RemoteServer.getClientHost(); } 
@@ -108,22 +116,21 @@
 		// Connection policy
 		if( !allowConnection(clientHost) ) {
 			logger.warn("Too many connections from " + clientHost + " (or the server is full)!");
-			throw new DBLayerException("There are either too many connections or the server is already full!");
+			throw new RemoteException(L10n.getString("Error.TooManyConnections"));
 		}
 		
 		// Create a new DBLayer, export it, and keep the stub. Also set the Undertaker of this object.
 		logger.debug("Creating a new HibernateDBLayer ...");
 		DBLayer database = new HibernateDBLayer( undertaker, settings.getDatabaseSettings() );
-		logger.debug("[Success] DBLayer created.");
 		
 		
 		DBLayer stub = null;
 		try {
 			logger.debug("Exporting the database layer...");
 			stub = (DBLayer) UnicastRemoteObject.exportObject(database);
-			logger.debug("[Success] DBLayer exported.");
+			logger.debug("DBLayer exported.");
 		} catch(RemoteException e) {
-			logger.error("[Failure] Unable to export the DBLayer. Is the `codebase` set properly? Are stubs generated properly? " + e.getMessage());
+			logger.error("Unable to export the DBLayer. Is the `codebase` set properly? Are stubs generated properly? " + e.getMessage());
 			throw e;
 		}
 		
@@ -142,10 +149,11 @@
 	 * Make sure the DBLayer performs some cleanup.  
 	 * 
 	 * @param db	The DBLayer object (not stub!) that should be disconnected.
-	 * @throws RemoteException If the RMI encounters an error.
 	 */	
-	void disconnect(DBLayer db)  throws RemoteException {
-		assert(db != null);
+	void disconnect(DBLayer db)  
+	throws RemoteException {
+		if(db == null)
+			return;
 		
 		// Let the database layer perform some cleanup.
 		db.shutdown();
@@ -161,9 +169,9 @@
 	 * (and remove it from the list of connected clients).
 	 * 
 	 * @param stub The remote reference to the remote object that is to be destroyed.
-	 * @throws RemoteException If the RMI encounters an error.
 	 */	
-	public synchronized void destroy(DBLayer stub) throws RemoteException {
+	public synchronized void destroy(DBLayer stub) 
+	throws RemoteException {
 		if(stub == null) return;
 		ConnectionInfo info = clients.remove(stub);
 		if(info != null) 
@@ -186,7 +194,7 @@
 	
 	/** 
 	 * Take care of DBLayer whose client has "crashed".
-	 * Ensure this database layer is properly disconnected.
+	 * Ensure this database layer is properly destroyed.
 	 * 
 	 * @see destroy 
 	 */

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -15,22 +15,24 @@
 import net.sf.plantlore.server.tools.*;
 
 /**
+ *
+ *  The RMIServer starts and terminates the server, 
+ *  that is: it creates and exports/unexports the RemoteDBLayerFactory.  
  *  
- * <br/>
- *  The server is terminated
- *  <=> 
- *  All remote objects that have been exported are unexported.
- *  
- * @see RemoteDBLayerFactory, RMIDBLayerFactory
  * @author Erik Kratochv?l
  * @since 2006-03-11
  * @version 1.0
+ * 
+ * @see net.sf.plantlore.middleware.RemoteDBLayerFactory
  */
 public class RMIServer extends UnicastRemoteObject implements Server {
 	
 	private static final long serialVersionUID = 2006060433819775L;
 	
-	/** The default port where the rmiregistry listens. To that rmiregistry the RemoteDBLayerFactory will be bound to. */
+	/** 
+	 * The default port where the rmiregistry listens. 
+	 * To that rmiregistry the RemoteDBLayerFactory will be bound. 
+	 */
 	public static final int DEFAULT_PORT = Registry.REGISTRY_PORT;
 	
 	
@@ -43,7 +45,12 @@
 
 
 	
-	/** Create a new instance of RMIServer running on the specified port. */
+	/** 
+	 * Create a new instance of the server based on the supplied settings.
+	 * 
+	 * @param settings		The settings of the server.
+	 * @param password	The password protecting the access to the server.
+	 */
 	public RMIServer(ServerSettings settings, String password) 
 	throws RemoteException, AlreadyBoundException {
 		logger = Logger.getLogger(this.getClass().getPackage().getName());
@@ -54,11 +61,20 @@
 		RMI.bind(settings.getPort(), guard, Guard.ID);
 	}
 	
-	/** Get the information about the connected clients. */
-	public synchronized ConnectionInfo[] getClients() {
+	/** 
+	 * Get the list of currently connected clients. 
+	 */
+	public synchronized ConnectionInfo[] getClients() 
+	throws RemoteException {
 		if(remoteFactory == null) 
 			return null;
-		return remoteFactory.getClients(); 
+		try {
+			return remoteFactory.getClients();
+		}
+		catch(RemoteException e) {
+			logger.error("Unable to obtain the list of connected clients. " + e.getMessage());
+			throw e;
+		}
 	}
 
 	/**
@@ -66,22 +82,24 @@
 	 * 
 	 * @param client The client to be kicked.
 	 */
-	public synchronized void disconnect(ConnectionInfo client) {
+	public synchronized void disconnect(ConnectionInfo client) 
+	throws RemoteException {
 		try { 
-			remoteFactory.destroy(client.getStub()); 
+			remoteFactory.destroy( client.getStub() );  
 		} catch(RemoteException e) { 
 			logger.error("Unable to disconnect the client. " + e.getMessage());
-			e.printStackTrace();
+			throw e;
 		}
 	}
 	
 	/** 
 	 * Bind a new RemoteDBLayerFactory to the rmiregistry on the specified <code>port</code>. 
-	 * If the rmiregistry is not currently running on that port, it will be created. 
+	 * If the rmiregistry is not currently running on that port, it will be started. 
 	 * 
 	 * @throws AlreadyBoundException If another RemoteDBLayerFactory is already bound to the rmiregistry. 
 	 */
-	public synchronized void start() throws AlreadyBoundException {
+	public synchronized void start() 
+	throws AlreadyBoundException, RemoteException {
 		try {
 			
 			int timeout = Math.min(Math.max(1, settings.getTimeout()), 30) * 60000;
@@ -89,32 +107,32 @@
 
 			// Locate (or start) the rmiregistry on the specified port
 			Registry registry;
-			try {	registry = LocateRegistry.createRegistry(settings.getPort()); }
-			catch(Exception e) { registry = LocateRegistry.getRegistry(settings.getPort()); }
+			try {	
+				registry = LocateRegistry.createRegistry(settings.getPort()); 
+			}
+			catch(Exception e) { 
+				registry = LocateRegistry.getRegistry(settings.getPort()); 
+			}
 			// Create a new factory or reuse an existing one.
-			if(remoteFactory == null) remoteFactory = new RMIRemoteDBLayerFactory( settings );
+			if(remoteFactory == null) 
+				remoteFactory = new RMIRemoteDBLayerFactory( settings );
 			// Bind the factory to the rmiregistry. 
 			registry.bind(RemoteDBLayerFactory.ID, remoteFactory);
 
-			
-			// Nemel by server exportnout i sebe??
-
-			
 			logger.info("The RemoteDBLayerFactory has been bound to the rmiregistry.");
 		}
 		catch(RemoteException e) { 
 			logger.error("Unable to start the server. " + e.getMessage());
-			e.printStackTrace();
+			throw e;
 		}
 	}
 	
 	/** 
 	 * Unbind the RemoteDBLayerFactory from the rmiregistry on the specified <code>port</code>. 
-	 * The rmiregistry on the specified port is <b>not</b> stopped, because some other programs may be still
-	 * using it!<br/>
-	 * This will terminate the server completely.
+	 * This will terminate the server completely (all clients will be disconnected immediately).
 	 */
-	public synchronized void stop() {
+	public synchronized void stop() 
+	throws RemoteException {
 		if(remoteFactory == null) return;
 		try {
 			// 1. Unbind the RemoteDBLayerFactory from the rmiregistry 
@@ -143,18 +161,7 @@
 		}
 		catch(Exception e) { 
 			logger.error("Unable to stop the server. " + e.getMessage());
-			e.printStackTrace();
 		}
 	}
 
-	
-	
-	
-	
-	/** Static initialization. */
-	static {
-		//RMI.addToCodebase( System.getProperty("user.dir") + "/" );
-	}
-	
-
 }

Modified: trunk/src/net/sf/plantlore/server/RMIServerControl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -3,6 +3,20 @@
 import java.rmi.RemoteException;
 import java.rmi.server.UnicastRemoteObject;
 
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ * The Server Control guards the access to the Server 
+ * and prevents unauthorized Users from shutting it down.
+ * In order to manage the Server (terminate the Server, view
+ * the list of connected clients, disconnecting the clients)
+ * the User must pass the authorization procedure and
+ * supply valid authorization key (password).
+ * 
+ * @author Erik Kratochv?l
+ * @since 2006-05-30
+ * @version 1.0
+ */
 public class RMIServerControl extends UnicastRemoteObject implements Guard {
 	
 	private static final long serialVersionUID = 2006060433140537L;
@@ -10,15 +24,28 @@
 	private Server server;
 	private String password;
 
+	/**
+	 * Create a new Guard of the Server.
+	 * 
+	 * @param server	The Server that shall be protected.
+	 * @param password	The authorization key protecting the access to the Server.
+	 */
 	public RMIServerControl(Server server, String password) throws RemoteException {
 		this.server = server;
 		this.password = password;
 	}
 	
+	/**
+	 * The certification procedure. If the supplied authorization information
+	 * matches the password protecting the Server, the Server is returned
+	 * (Server is the interface for managing the Plantlore Server).
+	 * 
+	 * @return The Server if the 
+	 */
 	public Server certify(String authorizationInfo) throws RemoteException, CertificationException {
 		if(authorizationInfo.equals(password)) 
 			return server;
-		throw new CertificationException("Wrong password.");
+		throw new CertificationException(L10n.getString("Error.WrongAuthorizationKey"));
 	}
 	
 }

Modified: trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -41,7 +41,7 @@
  *  
  *  TODO: Nezapominat generovat stub! (rmic net.sf.plantlore.server.SelectQueryImplementation)
  *
- * @author Tom?? Kova??k, Erik Kratochv?l
+ * @author Tom?? Kova??k
  */
 public class SelectQueryImplementation implements SelectQuery {
 	

Modified: trunk/src/net/sf/plantlore/server/Server.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Server.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/Server.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -6,19 +6,18 @@
 import java.rmi.RemoteException;
 
 /**
- * Server management.
+ * An interface for the server management.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-03-29
- * @version 1.0 final
+ * @version 1.0
  */
 public interface Server extends Remote, Serializable {
 	
 	/**
-	 * Return a collection of currently connected clients.
+	 * Return a list of currently connected clients.
 	 * 
 	 * @return Currently connected clients.
-	 * @throws RemoteException	if the RMI encounters an error (network/server).
 	 */
 	ConnectionInfo[]	getClients() throws RemoteException;
 	
@@ -26,22 +25,18 @@
 	 * "Kick" the specified client. The client is disconnected immediately.
 	 * 
 	 * @param client The client to be kicked from the server.
-	 * @throws RemoteException if the RMI encounters an error (network/server).
 	 */
 	void disconnect(ConnectionInfo client) throws RemoteException;
 	
 	/**
-	 * Run the server on the specified port.
+	 * Start the server.
 	 * 
-	 * @throws RemoteException if the RMI encounters an error (network/server).
-	 * @throws AlreadyBoundException if another server is already running on the specified port.
 	 */
 	void start() throws RemoteException, AlreadyBoundException;
 	
 	/**
 	 * Terminate the server. 
 	 * 
-	 * @throws RemoteException if the RMI encounters an error (network/server).
 	 */
 	void stop() throws RemoteException;
 	

Modified: trunk/src/net/sf/plantlore/server/ServerSettings.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ServerSettings.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/ServerSettings.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -1,5 +1,13 @@
 package net.sf.plantlore.server;
 
+/**
+ * The holder object containing the settings  
+ * needed to start a new server.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-08-01
+ * @version 1.0
+ */
 public class ServerSettings {
 
 	private int port;
@@ -8,7 +16,17 @@
 	private int connectionsPerIP;
 	private DatabaseSettings databaseSettings;
 	
-	
+	/**
+	 * Create new Server Settings.
+	 * 
+	 * @param port	The port number where the listens.
+	 * @param timeout	The ammount of time after which the crashed client's database layer
+	 * is automatically destroyed. 
+	 * @param connectionsTotal	The maximum number of clients connected to the server simultaneously.
+	 * @param connectionsPerIP	The maximum number of clients connected to the server 
+	 * simultaneously from the same IP address.
+	 * @param databaseSettings		The settings describing the connection to the database.
+	 */
 	public ServerSettings(int port, int timeout, int connectionsTotal, int connectionsPerIP, DatabaseSettings databaseSettings) {
 		this.port = port;
 		this.timeout = timeout;
@@ -17,18 +35,44 @@
 		this.databaseSettings = databaseSettings;
 	}
 
+	/**
+	 * 
+	 * @return	The maximum number of clients connected to the server 
+	 * simultaneously from the same IP address.
+	 */
 	public int getConnectionsPerIP() {
 		return connectionsPerIP;
 	}
+	
+	/**
+	 * 
+	 * @return	The maximum number of clients connected to the server simultaneously.
+	 */
 	public int getConnectionsTotal() {
 		return connectionsTotal;
 	}
+	
+	/**
+	 * 
+	 * @return	The settings describing the connection to the database.
+	 */
 	public DatabaseSettings getDatabaseSettings() {
 		return databaseSettings;
 	}
+	
+	/**
+	 * 
+	 * @return		The port number where the listens.
+	 */
 	public int getPort() {
 		return port;
 	}
+	
+	/**
+	 * 
+	 * @return	The ammount of time after which the crashed client's database layer
+	 * is automatically destroyed. 
+	 */
 	public int getTimeout() {
 		return timeout;
 	}

Modified: trunk/src/net/sf/plantlore/server/Undertaker.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Undertaker.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/Undertaker.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -3,11 +3,13 @@
 import net.sf.plantlore.middleware.DBLayer;
 
 /**
- * The Undertaker can properly bury DBLayers, that were not properly destroyed. 
+ * The Undertaker can destroy stranded DBLayers properly.
+ * A Database Layer is considered stranded if the client, for whom it was created,
+ * crashes or the network connection is lost. 
  *   
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-03-26
- * @version 1.0 final
+ * @version 1.0 
   */
 public interface Undertaker {
 	

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -2,9 +2,11 @@
 
 import java.awt.event.ActionEvent;
 
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
+import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.DatabaseSettings;
 import net.sf.plantlore.server.RMIServer;
 import net.sf.plantlore.server.ServerSettings;
@@ -61,7 +63,13 @@
 					
 					// Create and run a new server.
 					Task createServer = model.createNewServerTask( serverPassword );
-					new DefaultProgressBar(createServer, view, true);
+					new DefaultProgressBar(createServer, view, true) {
+						@Override
+						public void exceptionHandler(Exception ex) {
+							getTask().stop();
+							DefaultExceptionHandler.handle(parent, ex, L10n.getString("Error.CannotStartServer"), true);
+						}
+					};
 					createServer.start();
 					
 					break;
@@ -79,7 +87,13 @@
 					
 					Task connectToServer = model.createConnectToRunningServerTask(
 							view.remoteHost.getText(), port, password );
-					new DefaultProgressBar(connectToServer, view, true);
+					new DefaultProgressBar(connectToServer, view, true) {
+						@Override
+						public void exceptionHandler(Exception ex) {
+							getTask().stop();
+							DefaultExceptionHandler.handle(parent, ex, L10n.getString("Error.CannotConnectToTheServer"), true);
+						}
+					};
 					connectToServer.start();
 					
 					break;

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-02 17:28:37 UTC (rev 634)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-02 20:30:53 UTC (rev 635)
@@ -13,7 +13,7 @@
 	public static final String PROPERTY_CODEBASE = "java.rmi.server.codebase";
 	public static final String PROPERTY_LEASEVALUE = "java.rmi.dgc.leaseValue";
 	
-	
+
 	public static void bind(Remote object, String name) 
 	throws RemoteException, AccessException, AlreadyBoundException {
 		



From fraktalek at mail.berlios.de  Sat Sep  2 22:32:16 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 2 Sep 2006 22:32:16 +0200
Subject: [Plantlore-dev] r636 - trunk
Message-ID: <200609022032.k82KWGZb004927@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-02 22:32:15 +0200 (Sat, 02 Sep 2006)
New Revision: 636

Modified:
   trunk/build.xml
Log:
Allow for Run -> Run File command in Netbeans.
I sent a mail to the conference how to enable it in the IDE.



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-02 20:30:53 UTC (rev 635)
+++ trunk/build.xml	2006-09-02 20:32:15 UTC (rev 636)
@@ -84,6 +84,15 @@
                         <jvmarg value="-Djava.rmi.server.codebase=file://${dist.dir}/"/>
 		</java>
 	</target>
+        
+       <target name="run-selected-file" depends="build" description="Run Single File">
+          <fail unless="classname">Must set property 'classname'</fail>
+          <java classname="${classname}">
+              <classpath>
+                  <pathelement location="${dist.dir}/plantlore-client.jar"/>
+              </classpath>
+          </java>
+       </target>        
 	
 	<!-- makes a new build -->
 	<target name="build" depends="compile" description="Creates a new build. Builds both Plantlore client and server.">



From lada at mail.berlios.de  Sat Sep  2 22:57:20 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 2 Sep 2006 22:57:20 +0200
Subject: [Plantlore-dev] r637 - in trunk/src/net/sf/plantlore:
	client/history client/metadata client/user common/record
Message-ID: <200609022057.k82KvKPm008518@sheep.berlios.de>

Author: lada
Date: 2006-09-02 22:57:18 +0200 (Sat, 02 Sep 2006)
New Revision: 637

Modified:
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
   trunk/src/net/sf/plantlore/client/user/UserManagerView.java
   trunk/src/net/sf/plantlore/common/record/Metadata.java
   trunk/src/net/sf/plantlore/common/record/User.java
Log:
Add size restriction for editable text field.
Fix bug: location relative (Dialog is displayed in the middle of the window. Function setLocationRelativeTo(null) must be called after function initComponent())

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -30,13 +30,13 @@
      */
     public DetailsHistoryView(javax.swing.JDialog parent, boolean modal) {
         super(parent, modal);
-        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        setLocationRelativeTo(null);
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents(); 
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);        
         this.detailsTextArea.setEditable(false);
+        setLocationRelativeTo(null);
     }
         
     public void update(Observable observable, Object object) {

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -39,14 +39,14 @@
         super(parent, modal);
         this.model = model;
         // Register observer
-        model.addObserver(this);
-        setLocationRelativeTo(null);
+        model.addObserver(this);        
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents();
         getRootPane().setDefaultButton(closeButton);        
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.OCCURRENCE_HISTORY, this.getRootPane());
-        PlantloreHelp.addButtonHelp(PlantloreHelp.OCCURRENCE_HISTORY, this.helpButton);                
+        PlantloreHelp.addButtonHelp(PlantloreHelp.OCCURRENCE_HISTORY, this.helpButton);  
+        setLocationRelativeTo(null);
     }
     
     /**

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -37,14 +37,14 @@
         super(parent, modal);
         this.model = model;
         // Register observer
-        model.addObserver(this);
-        setLocationRelativeTo(null);
+        model.addObserver(this);        
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
         initComponents();        
         getRootPane().setDefaultButton(closeButton);            
         // Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());
-        PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);                
+        PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);    
+        setLocationRelativeTo(null);
     }
     
      /**

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataCtrl.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -95,7 +95,7 @@
                     metadata.setDateCreate(view.createDateChooser.getDate());                                        
                     metadata.setDateModified(new Date());                                               
                     metadata.setRecordBasis(view.recordbasisText.getText());
-                    metadata.setBiotopeText(view.noteTextArea.getText());
+                    metadata.setBiotopeText(view.biotopeTextText.getText());
                     metadata.setDeleted(0);                   
                     //Save new Metadata into model
                     model.setNewMetadataRecord(metadata);
@@ -119,7 +119,7 @@
                     model.getMetadataRecord().setSourceId(view.sourceIdText.getText());
                     model.getMetadataRecord().setOwnerOrganizationAbbrev(view.abbrevText.getText());
                     model.getMetadataRecord().setRecordBasis(view.recordbasisText.getText());
-                    model.getMetadataRecord().setBiotopeText(view.noteTextArea.getText());                    
+                    model.getMetadataRecord().setBiotopeText(view.biotopeTextText.getText());                    
                     model.getMetadataRecord().setDateModified(new Date());
                     model.getMetadataRecord().setDeleted(0);                 
                     view.close(); 

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-02 20:57:18 UTC (rev 637)
@@ -17,9 +17,9 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" alignment="1" attributes="0">
-              <EmptySpace min="-2" max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="1" attributes="0">
+          <Group type="102" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="0" attributes="0">
                   <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="helpButton" min="-2" pref="100" max="-2" attributes="0"/>
@@ -29,20 +29,20 @@
                       <Component id="closeButton" min="-2" pref="100" max="-2" attributes="0"/>
                   </Group>
               </Group>
-              <EmptySpace min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
       <Group type="103" groupAlignment="0" attributes="0">
           <Group type="102" alignment="1" attributes="0">
-              <EmptySpace min="-2" max="-2" attributes="1"/>
-              <Component id="jPanel1" pref="515" max="32767" attributes="0"/>
               <EmptySpace min="-2" max="-2" attributes="0"/>
+              <Component id="jPanel1" pref="480" max="32767" attributes="0"/>
+              <EmptySpace min="-2" pref="12" max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
-                  <Component id="helpButton" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="closeButton" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="operationButton" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="helpButton" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>
@@ -66,7 +66,7 @@
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="1" attributes="0">
                   <Group type="103" groupAlignment="1" attributes="0">
-                      <Component id="jPanel5" alignment="0" max="32767" attributes="1"/>
+                      <Component id="jPanel5" alignment="0" max="32767" attributes="2"/>
                       <Component id="jPanel4" alignment="1" max="32767" attributes="2"/>
                   </Group>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -77,9 +77,9 @@
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="0" max="-2" attributes="0">
                   <Component id="jPanel4" max="32767" attributes="0"/>
-                  <EmptySpace max="-2" attributes="0"/>
-                  <Component id="jPanel5" min="-2" max="-2" attributes="0"/>
-                  <EmptySpace min="-2" pref="19" max="-2" attributes="0"/>
+                  <EmptySpace min="-2" max="-2" attributes="0"/>
+                  <Component id="jPanel5" max="32767" attributes="0"/>
+                  <EmptySpace min="-2" pref="52" max="-2" attributes="0"/>
               </Group>
           </Group>
         </DimensionLayout>
@@ -396,12 +396,11 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" attributes="0">
                       <Group type="103" groupAlignment="0" max="-2" attributes="0">
-                          <Component id="jPanel6" max="32767" attributes="3"/>
-                          <Component id="jPanel7" alignment="0" max="32767" attributes="1"/>
+                          <Component id="jPanel7" max="32767" attributes="1"/>
+                          <Component id="jPanel6" alignment="0" max="32767" attributes="3"/>
                       </Group>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jPanel8" max="32767" attributes="0"/>
-                      <EmptySpace min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -454,7 +453,7 @@
                               <Component id="sourceIdLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                               <Component id="sourceIdText" alignment="3" min="-2" max="-2" attributes="0"/>
                           </Group>
-                          <EmptySpace pref="33" max="32767" attributes="0"/>
+                          <EmptySpace pref="16" max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -514,14 +513,14 @@
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Component id="recordbasisLabel" alignment="0" min="-2" max="-2" attributes="0"/>
-                              <Component id="notetextLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                              <Component id="biotopeTextLabel" alignment="0" min="-2" max="-2" attributes="0"/>
                           </Group>
                           <EmptySpace min="-2" pref="14" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" max="-2" attributes="0">
-                              <Component id="recordbasisText" max="32767" attributes="3"/>
-                              <Component id="jScrollPane1" alignment="0" pref="170" max="32767" attributes="1"/>
+                              <Component id="biotopeTextText" max="32767" attributes="1"/>
+                              <Component id="recordbasisText" alignment="0" pref="171" max="32767" attributes="3"/>
                           </Group>
-                          <EmptySpace max="-2" attributes="0"/>
+                          <EmptySpace min="-2" pref="27" max="-2" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -534,11 +533,11 @@
                               <Component id="recordbasisText" alignment="3" min="-2" max="-2" attributes="0"/>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="notetextLabel" min="-2" max="-2" attributes="0"/>
-                              <Component id="jScrollPane1" min="-2" pref="66" max="-2" attributes="0"/>
+                          <Group type="103" groupAlignment="3" attributes="0">
+                              <Component id="biotopeTextLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                              <Component id="biotopeTextText" alignment="3" min="-2" max="-2" attributes="0"/>
                           </Group>
-                          <EmptySpace max="32767" attributes="0"/>
+                          <EmptySpace pref="41" max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -551,10 +550,10 @@
                     </Property>
                   </Properties>
                 </Component>
-                <Component class="javax.swing.JLabel" name="notetextLabel">
+                <Component class="javax.swing.JLabel" name="biotopeTextLabel">
                   <Properties>
                     <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-                      <Connection code="L10n.getString(&quot;MetadataManager.Note&quot;)+ &quot;: &quot;" type="code"/>
+                      <Connection code="L10n.getString(&quot;MetadataManager.biotopeText&quot;)+ &quot;: &quot;" type="code"/>
                     </Property>
                   </Properties>
                 </Component>
@@ -563,21 +562,11 @@
                     <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
                   </AuxValues>
                 </Component>
-                <Container class="javax.swing.JScrollPane" name="jScrollPane1">
-
-                  <Layout class="org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout"/>
-                  <SubComponents>
-                    <Component class="javax.swing.JTextArea" name="noteTextArea">
-                      <Properties>
-                        <Property name="columns" type="int" value="20"/>
-                        <Property name="rows" type="int" value="5"/>
-                      </Properties>
-                      <AuxValues>
-                        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                      </AuxValues>
-                    </Component>
-                  </SubComponents>
-                </Container>
+                <Component class="javax.swing.JTextField" name="biotopeTextText">
+                  <AuxValues>
+                    <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+                  </AuxValues>
+                </Component>
               </SubComponents>
             </Container>
             <Container class="javax.swing.JPanel" name="jPanel8">

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -14,6 +14,8 @@
 import javax.swing.JDialog;
 import javax.swing.JFormattedTextField;
 import javax.swing.JOptionPane;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.TransferFocus;
 import net.sf.plantlore.common.record.Metadata;
@@ -40,14 +42,55 @@
         super(parent, modal);
         this.model = model;
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        setLocationRelativeTo(null);
         initComponents();        
         //getRootPane().setDefaultButton(closeButton); 
         PlantloreHelp.addKeyHelp(PlantloreHelp.METDATA_ADD, this.getRootPane());
-        PlantloreHelp.addButtonHelp(PlantloreHelp.METDATA_ADD, this.helpButton);   
-        TransferFocus.patch(noteTextArea);
+        PlantloreHelp.addButtonHelp(PlantloreHelp.METDATA_ADD, this.helpButton);           
+        setSizeRestrictions();
+        setLocationRelativeTo(null);
     }
     
+    private void setSizeRestrictions() {
+        PlainDocument pd = (PlainDocument) this.sourceInstirutionIdText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.SOURCEINSTITUTIONID)));
+
+        pd = (PlainDocument) this.sourceIdText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.SOURCEID)));
+        
+        pd = (PlainDocument) this.technicalContactNameText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.TECHNICALCONTACTNAME)));
+
+        pd = (PlainDocument) this.technicalContactEmailText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.TECHNICALCONTACTEMAIL)));
+        
+        pd = (PlainDocument) this.technicalContactAddressText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.TECHNICALCONTACTADDRESS)));
+        
+        pd = (PlainDocument) this.contentContactNameText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.CONTENTCONTACTNAME)));
+        
+        pd = (PlainDocument) this.contentContactEmailText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.CONTENTCONTACTEMAIL)));
+        
+        pd = (PlainDocument) this.contectContactAddressText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.CONTENTCONTACTADDRESS)));
+        
+        pd = (PlainDocument) this.dataSetTitleText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.DATASETTITLE)));
+        
+        pd = (PlainDocument) this.dataSetDetailsText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.DATASETDETAILS)));
+        
+        pd = (PlainDocument) this.abbrevText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.OWNERORGANIZATIONABBREV)));
+        
+        pd = (PlainDocument) this.recordbasisText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.RECORDBASIS)));
+        
+        pd = (PlainDocument) this.biotopeTextText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.BIOTOPETEXT)));                
+     }
+    
      public void update(Observable observable, Object object)
     {
     }
@@ -73,7 +116,7 @@
          dateCreateText.setText("");
          dateModifiedText.setText("");
          recordbasisText.setText("");
-         noteTextArea.setText("");  
+         biotopeTextText.setText("");  
          createDateChooser.setDate(new Date());
      }
      
@@ -108,7 +151,7 @@
        dateCreateText.setEditable(false);
        dateModifiedText.setEditable(false);
        recordbasisText.setEditable(false);
-       noteTextArea.setEditable(false);   
+       biotopeTextText.setEditable(false);   
        dateModifiedEmptyLable.setVisible(false);
        createDateChooser.setVisible(false);
      }
@@ -134,7 +177,7 @@
            createDateChooser.setDate(new Date());           
            dateModifiedText.setValue(metadata.getDateModified());
            recordbasisText.setText(metadata.getRecordBasis());
-           noteTextArea.setText(metadata.getBiotopeText());            
+           biotopeTextText.setText(metadata.getBiotopeText());            
         }
      
      /**
@@ -225,10 +268,9 @@
         sourceIdText = new javax.swing.JTextField();
         jPanel7 = new javax.swing.JPanel();
         recordbasisLabel = new javax.swing.JLabel();
-        notetextLabel = new javax.swing.JLabel();
+        biotopeTextLabel = new javax.swing.JLabel();
         recordbasisText = new javax.swing.JTextField();
-        jScrollPane1 = new javax.swing.JScrollPane();
-        noteTextArea = new javax.swing.JTextArea();
+        biotopeTextText = new javax.swing.JTextField();
         jPanel8 = new javax.swing.JPanel();
         dateCreateLabel = new javax.swing.JLabel();
         dateModifiedLabel = new javax.swing.JLabel();
@@ -262,9 +304,9 @@
                     .add(technicalContactNameLabel))
                 .add(23, 23, 23)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(technicalContactAddressText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE)
-                    .add(technicalContactNameText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE)
-                    .add(technicalContactEmailText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE))
+                    .add(technicalContactAddressText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 151, Short.MAX_VALUE)
+                    .add(technicalContactNameText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 151, Short.MAX_VALUE)
+                    .add(technicalContactEmailText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 151, Short.MAX_VALUE))
                 .addContainerGap())
         );
         jPanel2Layout.setVerticalGroup(
@@ -304,9 +346,9 @@
                     .add(contectContactAddressLabel))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(contentContactNameText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
-                    .add(contentContactEmailText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
-                    .add(contectContactAddressText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE))
+                    .add(contentContactNameText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE)
+                    .add(contentContactEmailText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE)
+                    .add(contectContactAddressText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE))
                 .add(47, 47, 47))
         );
         jPanel3Layout.setVerticalGroup(
@@ -344,8 +386,8 @@
                             .add(sourceInstitutionIdLabel))
                         .add(21, 21, 21)
                         .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(abbrevText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE)
-                            .add(sourceInstirutionIdText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE))
+                            .add(abbrevText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
+                            .add(sourceInstirutionIdText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE))
                         .add(335, 335, 335))
                     .add(jPanel4Layout.createSequentialGroup()
                         .addContainerGap()
@@ -392,9 +434,9 @@
                     .add(sourceIdLabel))
                 .add(24, 24, 24)
                 .add(jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(sourceIdText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
-                    .add(dataSetDetailsText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
-                    .add(dataSetTitleText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE))
+                    .add(sourceIdText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE)
+                    .add(dataSetDetailsText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE)
+                    .add(dataSetTitleText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 179, Short.MAX_VALUE))
                 .add(21, 21, 21))
         );
         jPanel6Layout.setVerticalGroup(
@@ -412,18 +454,14 @@
                 .add(jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(sourceIdLabel)
                     .add(sourceIdText, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                .addContainerGap(33, Short.MAX_VALUE))
+                .addContainerGap(16, Short.MAX_VALUE))
         );
 
         jPanel7.setBorder(javax.swing.BorderFactory.createEtchedBorder());
         recordbasisLabel.setText(L10n.getString("MetadataManager.Recordbasis")+ ": ");
 
-        notetextLabel.setText(L10n.getString("MetadataManager.Note")+ ": ");
+        biotopeTextLabel.setText(L10n.getString("MetadataManager.biotopeText")+ ": ");
 
-        noteTextArea.setColumns(20);
-        noteTextArea.setRows(5);
-        jScrollPane1.setViewportView(noteTextArea);
-
         org.jdesktop.layout.GroupLayout jPanel7Layout = new org.jdesktop.layout.GroupLayout(jPanel7);
         jPanel7.setLayout(jPanel7Layout);
         jPanel7Layout.setHorizontalGroup(
@@ -432,12 +470,12 @@
                 .addContainerGap()
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(recordbasisLabel)
-                    .add(notetextLabel))
+                    .add(biotopeTextLabel))
                 .add(14, 14, 14)
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
-                    .add(recordbasisText)
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 170, Short.MAX_VALUE))
-                .addContainerGap())
+                    .add(biotopeTextText)
+                    .add(recordbasisText, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 171, Short.MAX_VALUE))
+                .add(27, 27, 27))
         );
         jPanel7Layout.setVerticalGroup(
             jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -447,10 +485,10 @@
                     .add(recordbasisLabel)
                     .add(recordbasisText, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(notetextLabel)
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 66, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(biotopeTextLabel)
+                    .add(biotopeTextText, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap(41, Short.MAX_VALUE))
         );
 
         jPanel8.setBorder(javax.swing.BorderFactory.createEtchedBorder());
@@ -509,7 +547,7 @@
                         .add(12, 12, 12)
                         .add(jPanel6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 277, Short.MAX_VALUE))
+                        .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 292, Short.MAX_VALUE))
                     .add(jPanel5Layout.createSequentialGroup()
                         .addContainerGap()
                         .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)))
@@ -519,11 +557,10 @@
             jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel5Layout.createSequentialGroup()
                 .add(jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
-                    .add(jPanel6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .add(jPanel6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .addContainerGap())
+                .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
@@ -541,8 +578,8 @@
             .add(jPanel1Layout.createSequentialGroup()
                 .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .add(19, 19, 19))
+                .add(jPanel5, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .add(52, 52, 52))
         );
 
         closeButton.setText(L10n.getString("MetadataManager.ButtonClose"));
@@ -555,13 +592,13 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+            .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(layout.createSequentialGroup()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 331, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 360, Short.MAX_VALUE)
                         .add(operationButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
@@ -571,12 +608,12 @@
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
-                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 515, Short.MAX_VALUE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 480, Short.MAX_VALUE)
+                .add(12, 12, 12)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(helpButton)
                     .add(closeButton)
-                    .add(operationButton))
+                    .add(operationButton)
+                    .add(helpButton))
                 .addContainerGap())
         );
         pack();
@@ -596,6 +633,8 @@
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JLabel abbrevLabel;
     protected javax.swing.JTextField abbrevText;
+    private javax.swing.JLabel biotopeTextLabel;
+    protected javax.swing.JTextField biotopeTextText;
     protected javax.swing.JButton closeButton;
     private javax.swing.JLabel contectContactAddressLabel;
     protected javax.swing.JTextField contectContactAddressText;
@@ -622,9 +661,6 @@
     private javax.swing.JPanel jPanel6;
     private javax.swing.JPanel jPanel7;
     private javax.swing.JPanel jPanel8;
-    private javax.swing.JScrollPane jScrollPane1;
-    protected javax.swing.JTextArea noteTextArea;
-    private javax.swing.JLabel notetextLabel;
     protected javax.swing.JButton operationButton;
     private javax.swing.JLabel recordbasisLabel;
     protected javax.swing.JTextField recordbasisText;

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -12,8 +12,11 @@
 import javax.swing.DefaultListSelectionModel;
 import javax.swing.JDialog;
 import javax.swing.JOptionPane;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.TransferFocus;
+import net.sf.plantlore.common.record.Metadata;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -38,15 +41,27 @@
         super(parent, modal);
         this.model = model;
         model.addObserver(this);
-        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        setLocationRelativeTo(null);
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents();
         //getRootPane().setDefaultButton(closeButton);
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.METDATA_MANAGER, this.getRootPane());
-        PlantloreHelp.addButtonHelp(PlantloreHelp.METDATA_MANAGER, this.helpButton);                  
+        PlantloreHelp.addButtonHelp(PlantloreHelp.METDATA_MANAGER, this.helpButton);    
+        setSizeRestrictions();
+        setLocationRelativeTo(null);
     }
     
+    private void setSizeRestrictions() {
+        PlainDocument pd = (PlainDocument) dataSetTitleText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.DATASETTITLE)));
+
+        pd = (PlainDocument) this.sourceInstitutionIdText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.SOURCEINSTITUTIONID)));
+        
+        pd = (PlainDocument) this.sourceIdText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(Metadata.getColumnSize(Metadata.SOURCEID)));
+    }
+    
     /**
      * Reload the view dialog or display some kind of error.
      */

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -12,7 +12,9 @@
 
 import javax.swing.JDialog;
 import javax.swing.JOptionPane;
+import javax.swing.text.PlainDocument;
 import net.sf.plantlore.common.AutoTextArea;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.TransferFocus;
 import net.sf.plantlore.common.PlantloreHelp;
@@ -41,15 +43,40 @@
     public AddEditUserView(UserManager model, javax.swing.JDialog parent, boolean modal) {
         super(parent, modal);
         this.model = model;
-        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        setLocationRelativeTo(null);
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents(); 
         PlantloreHelp.addKeyHelp(PlantloreHelp.USER_ADD, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.USER_ADD, this.helpButton);        
         TransferFocus.patch(noteText);
-        TransferFocus.patch(editGroupTextArea);                
+        TransferFocus.patch(editGroupTextArea);   
+        setSizeRestrictions();
+        setLocationRelativeTo(null);
     }
     
+    
+     private void setSizeRestrictions() {
+        PlainDocument pd = (PlainDocument) loginText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.LOGIN)));
+
+        pd = (PlainDocument) passwordtext.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.PSWD)));
+        
+        pd = (PlainDocument) firstNameText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.FIRSTNAME)));
+
+        pd = (PlainDocument) surnameText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.SURNAME)));
+        
+        pd = (PlainDocument) emailText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.EMAIL)));
+        
+        pd = (PlainDocument) addressText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.ADDRESS)));
+        
+        pd = (PlainDocument) noteText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.NOTE)));                   
+    }
+     
      public void update(Observable observable, Object object)
     {
     }

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -12,8 +12,11 @@
 import javax.swing.DefaultListSelectionModel;
 import javax.swing.JDialog;
 import javax.swing.JOptionPane;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.TransferFocus;
+import net.sf.plantlore.common.record.User;
 import net.sf.plantlore.l10n.L10n;
 
 /** Creates new form UserManagerView
@@ -33,14 +36,29 @@
     public UserManagerView(UserManager model, java.awt.Frame parent, boolean modal) {
         super(parent, modal);
         this.model = model;
-        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        setLocationRelativeTo(null);
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
         initComponents();        
         // getRootPane().setDefaultButton(closeButton);
         PlantloreHelp.addKeyHelp(PlantloreHelp.USER_MANAGER, this.getRootPane());
-        PlantloreHelp.addButtonHelp(PlantloreHelp.USER_MANAGER, this.helpButton);                
+        PlantloreHelp.addButtonHelp(PlantloreHelp.USER_MANAGER, this.helpButton); 
+        setSizeRestrictions();
+        setLocationRelativeTo(null);
     }
     
+     private void setSizeRestrictions() {
+        PlainDocument pd = (PlainDocument) loginSearchText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.LOGIN)));
+
+        pd = (PlainDocument) wholeNameSearchText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.WHOLENAME)));
+        
+        pd = (PlainDocument) emailSearchText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.EMAIL)));
+
+        pd = (PlainDocument) addressSearchText.getDocument();
+        pd.setDocumentFilter(new DocumentSizeFilter(User.getColumnSize(User.ADDRESS)));
+     }
+    
     /**
      * Reload the view dialog or display some kind of error.
      */

Modified: trunk/src/net/sf/plantlore/common/record/Metadata.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Metadata.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/common/record/Metadata.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -7,6 +7,7 @@
 
 package net.sf.plantlore.common.record;
 
+import java.util.Hashtable;
 import java.util.List;
 
 /**
@@ -118,6 +119,29 @@
 		else if(column.equalsIgnoreCase(DATEMODIFIED)) setDateModified((java.util.Date)value);
     }
     
+    private static Hashtable<String, Integer> columnSizes;
+    static {
+        columnSizes = new Hashtable<String,Integer>();
+        columnSizes.put(TECHNICALCONTACTNAME,50);
+        columnSizes.put(TECHNICALCONTACTEMAIL,100);
+        columnSizes.put(TECHNICALCONTACTADDRESS,255);
+        columnSizes.put(CONTENTCONTACTNAME,50);
+        columnSizes.put(CONTENTCONTACTEMAIL,100);
+        columnSizes.put(CONTENTCONTACTADDRESS,255);
+        columnSizes.put(DATASETTITLE,50);        
+        columnSizes.put(DATASETDETAILS, 255);        
+        columnSizes.put(SOURCEINSTITUTIONID, 50);        
+        columnSizes.put(SOURCEID, 50);        
+        columnSizes.put(OWNERORGANIZATIONABBREV, 50);        
+        columnSizes.put(RECORDBASIS, 15);        
+        columnSizes.put(BIOTOPETEXT, 4095);               
+    }
+    
+    
+     public static int getColumnSize(String columnConst) {
+        return columnSizes.get(columnConst);
+    }
+    
     /**
      *   Get metadata id
      *   @return id of the metadata

Modified: trunk/src/net/sf/plantlore/common/record/User.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/User.java	2006-09-02 20:32:15 UTC (rev 636)
+++ trunk/src/net/sf/plantlore/common/record/User.java	2006-09-02 20:57:18 UTC (rev 637)
@@ -7,6 +7,8 @@
 
 package net.sf.plantlore.common.record;
 
+import java.util.Hashtable;
+
 /**
  *  Data holder object containing information about a user
  *
@@ -33,7 +35,7 @@
 
     /** Constants with column mapping (used for building select queries) */
     public static final String ID = "id";
-    public static final String LOGIN = "login";        
+    public static final String LOGIN = "login";            
     public static final String FIRSTNAME = "firstName";    
     public static final String SURNAME = "surname";    
     public static final String WHOLENAME = "wholeName";    
@@ -42,7 +44,9 @@
     public static final String CREATEWHEN = "createWhen";    
     public static final String DROPWHEN = "dropWhen";    
     public static final String RIGHT = "right";    
-    public static final String NOTE = "note";    
+    public static final String NOTE = "note";   
+    
+    public static final String PSWD = "pswd";      
 
     //public enum Column {ID, LOGIN, FIRSTNAME, SURNAME, WHOLENAME, EMAIL, ADDRESS, CREATEWHEN, DROPWHEN, RIGHT, NOTE};
         
@@ -61,6 +65,24 @@
     		login.equalsIgnoreCase("IDDQD");
     }
     
+     private static Hashtable<String, Integer> columnSizes;
+    static {
+        columnSizes = new Hashtable<String,Integer>();
+        columnSizes.put(LOGIN,20);
+        columnSizes.put(PSWD,30);
+        columnSizes.put(FIRSTNAME,20);
+        columnSizes.put(SURNAME,30);
+        columnSizes.put(WHOLENAME,55);
+        columnSizes.put(EMAIL,50);
+        columnSizes.put(ADDRESS,255);
+        columnSizes.put(NOTE,4096);        
+    }
+    
+    
+     public static int getColumnSize(String columnConst) {
+        return columnSizes.get(columnConst);
+    }
+    
     /**
      *   Get user id
      *   @return id of the user



From kovo at mail.berlios.de  Sat Sep  2 23:32:46 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sat, 2 Sep 2006 23:32:46 +0200
Subject: [Plantlore-dev] r638 - in trunk/src/net/sf/plantlore:
	client/publications common/record l10n
Message-ID: <200609022132.k82LWkkE011038@sheep.berlios.de>

Author: kovo
Date: 2006-09-02 23:32:33 +0200 (Sat, 02 Sep 2006)
New Revision: 638

Modified:
   trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
   trunk/src/net/sf/plantlore/common/record/Publication.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Update of Publication manager. This should be final version ready for testing. List of changes:
* ProgressBars updated
* Checking length of user input
* All strings should now be localized
* JavaDoc updated
* Compiler warnings removed

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -1,9 +1,3 @@
-/*
- * AddPublicationCtrl.java
- *
- * Created on 21. leden 2006, 0:58
- *
- */
 
 package net.sf.plantlore.client.publications;
 
@@ -14,11 +8,8 @@
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
-import javax.swing.JOptionPane;
-import net.sf.plantlore.common.PlantloreHelp;
-import javax.swing.Timer;
-import net.sf.plantlore.common.ProgressBar;
-import net.sf.plantlore.common.ProgressDialog;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
@@ -28,17 +19,13 @@
  * Controller for the Add/Edit publication dialog in the PublicationManager MVC.
  * 
  * @author Tomas Kovarik
- * @version 1.0 BETA, May 1, 2006
+ * @version 1.0
  */
 public class AddPublicationCtrl {
     /** Model of the Publication manager MVC */
     private PublicationManager model;
     /** View for adding publications in PublicationManager */
     private AddPublicationView view;
-    /** Timer used to check for the end of long running tasks */
-    private Timer timer;
-    /** Instance of progress dialog */
-    private ProgressDialog progress;    
     /** Instance of a logger */ 
     private Logger logger;
     
@@ -87,63 +74,52 @@
                 if (model.getEditPublication() == null) {                    
                     // Save new publication
                     Task task = model.savePublication();                
-                    ProgressBar progressBar = new ProgressBar(task, view, true) {
-                        public void exceptionHandler(Exception ex) {
-                            if (ex instanceof DBLayerException) {
-                                DBLayerException e = (DBLayerException)ex;
-                                JOptionPane.showMessageDialog(view,L10n.getString("Error.DBLayerException")+"\n"+e.getErrorInfo(),L10n.getString("Error.DBLayerExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                                logger.error(e+": "+e.getErrorInfo());
-                                getTask().stop();
-                                return;
-                            }
-                            if (ex instanceof RemoteException) {
-                                RemoteException e = (RemoteException)ex;
-                                JOptionPane.showMessageDialog(view,L10n.getString("Error.RemoteException")+"\n"+e.getMessage(),L10n.getString("Error.RemoteExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                                logger.error(e);
-                                getTask().stop();
-                                return;
-                            }
-                            JOptionPane.showMessageDialog(view,L10n.getString("Delete.Message.UnknownException")+"\n"+ex.getMessage(),L10n.getString("Delete.Message.UnkownExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                            logger.error(ex);                            
-                        }              
-                        
+                    DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
+                        @Override
                         public void afterStopped(Object value) {
                             model.searchPublication(false);
-                            model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
                             model.reloadCache();
                         }
                     };
-                    progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
+                    dpb.setTitle(L10n.getString("Publications.ProgressBar.Save"));
                     task.start();
                 } else {                    
                     // Edit existing publication
                     Task task = model.editPublication();
-                    ProgressBar progressBar = new ProgressBar(task, view, true) {
-                        public void exceptionHandler(Exception ex) {
-                            if (ex instanceof DBLayerException) {
-                                DBLayerException e = (DBLayerException)ex;
-                                JOptionPane.showMessageDialog(view,L10n.getString("Error.DBLayerException")+"\n"+e.getErrorInfo(),L10n.getString("Error.DBLayerExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                                logger.error(e+": "+e.getErrorInfo());
-                                getTask().stop();
-                                return;
-                            }
-                            if (ex instanceof RemoteException) {
-                                RemoteException e = (RemoteException)ex;
-                                JOptionPane.showMessageDialog(view,L10n.getString("Error.RemoteException")+"\n"+e.getMessage(),L10n.getString("Error.RemoteExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                                logger.error(e);
-                                getTask().stop();
-                                return;
-                            }
-                            JOptionPane.showMessageDialog(view,L10n.getString("Delete.Message.UnknownException")+"\n"+ex.getMessage(),L10n.getString("Delete.Message.UnkownExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                            logger.error(ex);                            
-                        }                                      
+                    DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
+                        @Override
                         public void afterStopped(Object value) {
                             model.searchPublication(false);
-                            model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
                             model.reloadCache();                            
                         }
                     };
-                    progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
+                    dpb.setTitle(L10n.getString("Publications.ProgressBar.Save"));
                     task.start();                    
                 }
                 // Close the add dialog when save finished

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-02 21:32:33 UTC (rev 638)
@@ -3,7 +3,7 @@
 <Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
   <Properties>
     <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-      <Connection code="L10n.getString(&quot;addPublicationTitle&quot;)" type="code"/>
+      <Connection code="L10n.getString(&quot;Publications.Add.Title&quot;)" type="code"/>
     </Property>
   </Properties>
   <SyntheticProperties>
@@ -125,55 +125,55 @@
     <Component class="javax.swing.JLabel" name="jLabel1">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationCollectionNameLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.CollectionName.Label&quot;)+&quot; *&quot;" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel2">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationCollectionYearPublicationLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.CollectionYearPublication.Label&quot;)+&quot; *&quot;" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel3">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationJournalNameLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.JournalName.Label&quot;)+&quot; *&quot;" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel5">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationJournalAuthorNameLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.JournalAuthorName.Label&quot;)+&quot; *&quot;" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel7">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationReferenceDetailLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.ReferenceDetail.Label&quot;)" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel8">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationNoteLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.Note.Label&quot;)" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JLabel" name="jLabel9">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;requiredFieldLbl&quot;)" type="code"/>
+          <Connection code="&quot;* &quot;+L10n.getString(&quot;Publications.Add.RequiredField.Label&quot;)" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="collectionNameField">
       <AuxValues>
-        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="collectionNameField.setValue(&quot;&quot;);"/>
+        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="collectionNameField.setValue(&quot;&quot;);&#xa;collectionNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.COLLECTIONNAME)));"/>
       </AuxValues>
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="publicationYearField">
@@ -183,12 +183,12 @@
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="journalNameField">
       <AuxValues>
-        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalNameField.setValue(&quot;&quot;);"/>
+        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalNameField.setValue(&quot;&quot;);&#xa;journalNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALNAME)));"/>
       </AuxValues>
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="urlField">
       <AuxValues>
-        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="urlField.setValue(&quot;&quot;);"/>
+        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="urlField.setValue(&quot;&quot;);&#xa;urlField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.URL)));"/>
       </AuxValues>
     </Component>
     <Container class="javax.swing.JScrollPane" name="jScrollPane2">
@@ -205,6 +205,7 @@
           </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_InitCodePost" type="java.lang.String" value="TransferFocus.patch(noteArea);"/>
+            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="noteArea.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.NOTE)));"/>
           </AuxValues>
         </Component>
       </SubComponents>
@@ -232,7 +233,7 @@
     <Component class="javax.swing.JButton" name="saveBtn">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;Publication.Add.SaveButton&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.SaveButton.Label&quot;)" type="code"/>
         </Property>
         <Property name="minimumSize" type="java.awt.Dimension" editor="org.netbeans.beaninfo.editors.DimensionEditor">
           <Dimension value="[150, 23]"/>
@@ -242,18 +243,18 @@
     <Component class="javax.swing.JLabel" name="jLabel10">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;addPublicationUrlLbl&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Publications.Add.Url.Label&quot;)" type="code"/>
         </Property>
       </Properties>
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="referenceDetailField">
       <AuxValues>
-        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceDetailField.setValue(&quot;&quot;);"/>
+        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceDetailField.setValue(&quot;&quot;);&#xa;referenceDetailField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCEDETAIL)));"/>
       </AuxValues>
     </Component>
     <Component class="javax.swing.JFormattedTextField" name="journalAuthorField">
       <AuxValues>
-        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalAuthorField.setValue(&quot;&quot;);"/>
+        <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalAuthorField.setValue(&quot;&quot;);&#xa;journalAuthorField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALAUTHORNAME)));"/>
       </AuxValues>
     </Component>
   </SubComponents>

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -8,20 +8,28 @@
 import java.util.Observer;
 import javax.swing.JDialog;
 import javax.swing.JOptionPane;
+import javax.swing.text.AttributeSet;
+import javax.swing.text.BadLocationException;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.TransferFocus;
+import net.sf.plantlore.common.record.Publication;
 import net.sf.plantlore.l10n.L10n;
 
 /**
- * Dialog used for adding / editing publications.
- *
+ * Dialog for adding / editing publications.
+ * 
  * @author  Tomas Kovarik
- * @version 1.0, June 4, 2006
+ * @version 1.0
  */
 public class AddPublicationView extends javax.swing.JDialog implements Observer {
     /** Model of the Publication manager MVC */
     private PublicationManager model;    
-
+    /** Variable used for setting maximu input size of text fields */
+    private PlainDocument pd;
+    
     /**
      * Creates new form AddPublicationView 
      * 
@@ -70,30 +78,34 @@
         referenceDetailField = new javax.swing.JFormattedTextField();
         journalAuthorField = new javax.swing.JFormattedTextField();
 
-        setTitle(L10n.getString("addPublicationTitle"));
-        jLabel1.setText(L10n.getString("addPublicationCollectionNameLbl"));
+        setTitle(L10n.getString("Publications.Add.Title"));
+        jLabel1.setText(L10n.getString("Publications.Add.CollectionName.Label")+" *");
 
-        jLabel2.setText(L10n.getString("addPublicationCollectionYearPublicationLbl"));
+        jLabel2.setText(L10n.getString("Publications.Add.CollectionYearPublication.Label")+" *");
 
-        jLabel3.setText(L10n.getString("addPublicationJournalNameLbl"));
+        jLabel3.setText(L10n.getString("Publications.Add.JournalName.Label")+" *");
 
-        jLabel5.setText(L10n.getString("addPublicationJournalAuthorNameLbl"));
+        jLabel5.setText(L10n.getString("Publications.Add.JournalAuthorName.Label")+" *");
 
-        jLabel7.setText(L10n.getString("addPublicationReferenceDetailLbl"));
+        jLabel7.setText(L10n.getString("Publications.Add.ReferenceDetail.Label"));
 
-        jLabel8.setText(L10n.getString("addPublicationNoteLbl"));
+        jLabel8.setText(L10n.getString("Publications.Add.Note.Label"));
 
-        jLabel9.setText(L10n.getString("requiredFieldLbl"));
+        jLabel9.setText("* "+L10n.getString("Publications.Add.RequiredField.Label"));
 
         collectionNameField.setValue("");
+        collectionNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.COLLECTIONNAME)));
 
         publicationYearField.setValue(0);
         publicationYearField.setValue(null);
 
         journalNameField.setValue("");
+        journalNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALNAME)));
 
         urlField.setValue("");
+        urlField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.URL)));
 
+        noteArea.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.NOTE)));
         noteArea.setColumns(20);
         noteArea.setRows(5);
         TransferFocus.patch(noteArea);
@@ -105,14 +117,16 @@
         closeBtn.setText(L10n.getString("Common.Close"));
         closeBtn.setMinimumSize(new java.awt.Dimension(150, 23));
 
-        saveBtn.setText(L10n.getString("Publication.Add.SaveButton"));
+        saveBtn.setText(L10n.getString("Publications.Add.SaveButton.Label"));
         saveBtn.setMinimumSize(new java.awt.Dimension(150, 23));
 
-        jLabel10.setText(L10n.getString("addPublicationUrlLbl"));
+        jLabel10.setText(L10n.getString("Publications.Add.Url.Label"));
 
         referenceDetailField.setValue("");
+        referenceDetailField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCEDETAIL)));
 
         journalAuthorField.setValue("");
+        journalAuthorField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALAUTHORNAME)));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
@@ -209,7 +223,7 @@
     public boolean checkCompulsory() {
         if (((Integer)publicationYearField.getValue() == null) && (((String)collectionNameField.getValue()).length() == 0) &&
             (((String)journalNameField.getValue()).length() == 0) && (((String)journalAuthorField.getValue()).length() == 0)) {
-            JOptionPane.showMessageDialog(this, "At least one of the following fields must be filled in: Journal author, Year of publication, Journal name, Collection name", "Missing compulsory field", JOptionPane.ERROR_MESSAGE);
+            JOptionPane.showMessageDialog(this, L10n.getString("Publications.CompulsoryFieldsMessage"), L10n.getString("Publications.CompulsoryFieldsMessage.Title"), JOptionPane.ERROR_MESSAGE);
             collectionNameField.requestFocus();
             return false;
         }
@@ -240,14 +254,19 @@
      *  @param arg  argument sent with notification
      */
     public void update(Observable o, Object arg) {
-        // Load form fields with data from the model
-        this.collectionNameField.setValue(model.getCollectionName());
-        this.publicationYearField.setValue(model.getPublicationYear());
-        this.journalNameField.setValue(model.getJournalName());
-        this.journalAuthorField.setValue(model.getJournalAuthor());
-        this.referenceDetailField.setValue(model.getReferenceDetail());
-        this.urlField.setValue(model.getUrl());
-        this.noteArea.setText(model.getNote());
+        if (arg instanceof Exception) {
+            // Exception occurred during execution
+            DefaultExceptionHandler.handle(this, (Exception)arg);            
+        } else {
+            // Load form fields with data from the model
+            this.collectionNameField.setValue(model.getCollectionName());
+            this.publicationYearField.setValue(model.getPublicationYear());
+            this.journalNameField.setValue(model.getJournalName());
+            this.journalAuthorField.setValue(model.getJournalAuthor());
+            this.referenceDetailField.setValue(model.getReferenceDetail());
+            this.urlField.setValue(model.getUrl());
+            this.noteArea.setText(model.getNote());
+        }
     }
     
     /**
@@ -324,7 +343,7 @@
     
     /**
      *  Add FocusListener for the <b>note</b> field
-     *  @param pcl FocusListener for the <b>note</b> field
+     *  @param fl FocusListener for the <b>note</b> field
      */
     void noteAddFocusListener(FocusListener fl) {
         noteArea.addFocusListener(fl);
@@ -392,6 +411,27 @@
     public String getNote() {
         return noteArea.getText();        
     }        
+
+    class FieldLengthLimit extends PlainDocument {
+        private int limit;
+        // optional uppercase conversion
+        private boolean toUppercase = false;
+        
+        FieldLengthLimit(int limit) {
+            super();
+            this.limit = limit;
+        }
+        
+        @Override
+        public void insertString(int offset, String  str, AttributeSet attr) throws BadLocationException {
+            if (str == null) return;
+            if ((getLength() + str.length()) <= limit) {
+                super.insertString(offset, str, attr);
+            } else {
+                super.insertString(offset, str.substring(0, limit), attr);
+            }
+        }
+    }    
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JButton closeBtn;

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -22,20 +22,14 @@
  * Publication manager model. Contains bussines logic and data fields of the PublicationManager.
  * Implements operations including add publication, edit publication, delete publication, search
  * publications.
- *
+ * 
  * @author Tomas Kovarik
- * @version 1.0, June 4, 2006
- *
- * TODO:    Proper exception handling
- *          Clean API (get rid of unused or unnecessary methods)
- *          Improve thread management
+ * @version 1.0
  */
 public class PublicationManager extends Observable {
     /* VARIOUS VARIABLES */
     /** Instance of a logger */
     private Logger logger;
-    /** Exception with details about an error */
-    private String error = null;
     /** Instance of a database management object */
     private DBLayer database;
     /** Flag telling whether a long running operation has already finished */
@@ -45,7 +39,7 @@
     /** Actual number of rows to display */
     private int displayRows = DEFAULT_DISPLAY_ROWS;
     /** Data (results of a search query) displayed in the table */
-    private ArrayList data;
+    private ArrayList<Publication> data;
     /** Index of the first record shown in the table */
     private int currentFirstRow;
     /** Index of currently selected publication in the table */
@@ -56,8 +50,10 @@
     private int sortDirection = 0;
     /** Publication we want to edit */
     private Publication editPublication;
-    /** Enum used for notifying AppCore to reload cahced publications */
+    /** Enum used for notifying AppCore to reload cached publications */
     private PlantloreConstants.Table[] editTypeArray = new PlantloreConstants.Table[]{PlantloreConstants.Table.PUBLICATION};
+    /** Instance of currently active SelectQuery. We have to keep it so that we can close it when neccessary */
+    private SelectQuery activeSelectQuery = null;
     
     /* PUBLICATION PROPERTIES */
     /** Name of the collection */
@@ -95,13 +91,7 @@
     public static final int SORT_JOURNAL_AUTHOR = 4;
     public static final int SORT_REFERENCE_CITATION = 5;
     public static final int SORT_REFERENCE_DETAIL = 6;
-    /** Constants with error descriptions */
-    public static final String ERROR_SEARCH = L10n.getString("publicationSearchFailed");
-    public static final String ERROR_SAVE = L10n.getString("publicationSaveFailed");
-    public static final String ERROR_UPDATE = L10n.getString("publicationUpdateFailed");
-    public static final String ERROR_DELETE = L10n.getString("publicationDeleteFailed");
-    public static final String ERROR_PROCESS = L10n.getString("publicationProcessResultsFailed");
-
+    /** Constants for operations */
     public static final int ADD = 1;
     public static final int EDIT = 2;
     public static final int DELETE = 3;
@@ -127,6 +117,7 @@
         final Task task = new Task() {
             public Object task() throws Exception {
                 boolean first = true;
+                setStatusMessage(L10n.getString("Publications.ProgressBar.Save"));
                 // Construct Reference citation
                 StringBuffer refCitation = new StringBuffer();
                 if ((journalAuthor != null) && (!journalAuthor.equals(""))) {
@@ -188,6 +179,7 @@
         // Create new Task
         final Task task = new Task() {
             public Object task() throws Exception {
+                setStatusMessage(L10n.getString("Publications.ProgressBar.Delete"));                
                 Publication pub = (Publication)data.get(getPublicationIndex());
                 // Set deleted flag of the publication
                 pub.setDeleted(1);
@@ -214,6 +206,7 @@
         final Task task = new Task() {
             public Object task() throws Exception {
                 boolean first = true;
+                setStatusMessage(L10n.getString("Publications.ProgressBar.Save"));
                 // Construct Refernce citation
                 StringBuffer refCitation = new StringBuffer();
                 if ((journalAuthor != null) && (!journalAuthor.equals(""))) {
@@ -269,12 +262,14 @@
      *
      *  @param createTask tells whether to execute search in a separate thread
      *  @return instance of the Task with the long running operation (searching data)
+     *  @see #search()
      */
     public Task searchPublication(boolean createTask) {
         // Use the Task class to execute the search in a new thread
         if (createTask) {
             final Task task = new Task() {
                 public Object task() throws Exception {
+                    setStatusMessage(L10n.getString("Publications.ProgressBar.Search"));                    
                     // Search the data
                     int resultId = search();
                     setResult(resultId);
@@ -286,14 +281,18 @@
             };
             return task;
         } else {
-            // Do not use Task
+            // Do not use Task. Catch exceptions but do not display error.
             try {
                 int resultId = search();
                 setResult(resultId);
             } catch (DBLayerException ex1) {
-                // ???
+                logger.error("DBLayerException caught while searching the database. Details: "+ex1.getMessage());
+                ex1.printStackTrace();
+                return null;
             } catch (RemoteException ex2) {
-                // ???
+                logger.error("RemoteException caught while searching the database. Details: "+ex2.getMessage());
+                ex2.printStackTrace();
+                return null;
             }
             logger.info("Publications successfuly retrieved from the database");
             return null;
@@ -301,11 +300,12 @@
     }
     
     /**
-     *  Method to construct and execute the search query.
+     *  Method to construct and execute the search query. This method is called from searchPublication method.
      *
      *  @return id identifying the search result
      *  @throws DBLayerException in case search failed
      *  @throws RemoteException in case network communication failed
+     *  @see #searchPublication(boolean)
      */
     private Integer search() throws DBLayerException, RemoteException {
         SelectQuery query;
@@ -347,55 +347,66 @@
         int resultId = 0;
         // Execute query
         resultId = database.executeQuery(query);
+        // If there is a previous active query, close it first
+        if (this.activeSelectQuery != null) {
+            database.closeQuery(this.activeSelectQuery);
+        }
+        // Save the query as the active search query        
+        this.activeSelectQuery = query;
         return resultId;
     }
       
+    /**
+     *  Notify observers  about the change in the list of publications (used to reload cached publications)
+     */
     public void reloadCache() {
         // Notify observers about the change in the list of publications. Used to reload cached publications
         setChanged();
         notifyObservers(editTypeArray);        
     }
     
-    public boolean hasRights(int operation) {
+    /**
+     *  Check whether the user has appropriate rights for the given operation.
+     *
+     *  @param  operation operation that is executed (for operation codes see constants)
+     *  @return true if the user has the right to execute the operation, false otherwise
+     *  @throws RemoteException in case we could not get user's access privileges
+     */
+    public boolean hasRights(int operation) throws RemoteException {
         String[] group;
         SelectQuery sq;
         int result;
         Object[] resData;
         ArrayList groupList;
         User groupUser;
-        try {
-            // Administrator can add, edit and delete any record
-            if (database.getUserRights().getAdministrator() == 1) {
+        // Administrator can add, edit and delete any record
+        if (database.getUserRights().getAdministrator() == 1) {
+            return true;
+        }
+        if (operation == ADD) {
+            if (database.getUserRights().getAdd() == 1) {
                 return true;
+            } else {
+                return false;
             }
-            if (operation == ADD) {
-                if (database.getUserRights().getAdd() == 1) {
+        } else { // EDIT AND DELETE - the same rights apply
+            // Check whether the user can edit all the records
+            if (database.getUserRights().getEditAll() == 1) {
+                return true;
+            }
+            // Check whether the user can edit the record through some other user
+            group = database.getUserRights().getEditGroup().split(",");
+            // We will need Publication that will be edited
+            Publication selectedPubl = (Publication)data.get(this.getPublicationIndex());
+            // Check whether someone in the group is an owner of the publication
+            for (int i=0;i<group.length;i++) {
+                if (selectedPubl.getCreatedWho().getId().toString().equals(group[i])) {
                     return true;
-                } else {
-                    return false;
                 }
-            } else { // EDIT AND DELETE - the same rights apply
-                // Check whether the user can edit all the records
-                if (database.getUserRights().getEditAll() == 1) {
-                    return true;
-                }
-                // Check whether the user can edit the record through some other user
-                group = database.getUserRights().getEditGroup().split(",");
-                // We will need Publication that will be edited
-                Publication selectedPubl = (Publication)data.get(this.getPublicationIndex());
-                // Check whether someone in the group is an owner of the publication
-                for (int i=0;i<group.length;i++) {
-                    if (selectedPubl.getCreatedWho().getId().toString().equals(group[i])) {
-                        return true;
-                    }
-                }
-                // No rights to edit the record
-                return false;
             }
-        } catch (RemoteException e) {
-            logger.error("Remote exception caught");
+            // No rights to edit the record
+            return false;
         }
-        return false;
     }
     
     /**
@@ -417,30 +428,25 @@
      *
      *  @param index index of the selected publication in the list of publications
      *  @return true if publication can be deleted, false otherwise
+     *  @throws RemoteException in case we were not able to get to-be-deleted publication because of network error
+     *  @throws DBLayerException in case we were not able to get to-be-deleted publication because database query failed 
      */
-    public boolean checkDelete(int index) {
+    public boolean checkDelete(int index) throws RemoteException, DBLayerException {
         SelectQuery sq;
         int resId;
         
         // Get the selected publication
         Publication publ = (Publication)data.get(index);
         // Find out whether we can delete this publication
-        try {
-            sq = database.createQuery(Occurrence.class);
-            sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.PUBLICATION, null, publ, null);
-            sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.DELETED, null, 0, null);
-            resId = database.executeQuery(sq);
-            if (database.getNumRows(resId)>0) {
-                database.closeQuery(sq);
-                return false;
-            }
+        sq = database.createQuery(Occurrence.class);
+        sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.PUBLICATION, null, publ, null);
+        sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.DELETED, null, 0, null);
+        resId = database.executeQuery(sq);
+        if (database.getNumRows(resId)>0) {
             database.closeQuery(sq);
-        } catch (RemoteException e1) {
-            System.out.println("Handle the Remote exception");
-        } catch (DBLayerException e2) {
-            logger.error("Loading occurrences failed. Cannot determine whether publication can be deleted");
-            setError(this.ERROR_DELETE);
-        }        
+            return false;
+        }
+        database.closeQuery(sq);
         return true;
     }
     
@@ -452,50 +458,36 @@
      *
      * @param from  index of the first row to retrieve.
      * @param count number of rows to retrieve
+     * @throws RemoteException in case of a network error
+     * @throws DBLayerException in case of a database error 
      */
-    public void processResults(int from, int count) {
+    public void processResults(int from, int count) throws RemoteException, DBLayerException {
         if (this.resultId != 0) {
             // Find out how many rows we can retrieve - it cannot be more than number of rows in the result
             int to = Math.min(getResultRows(), from+count-1);
             if (to == 0) {
-                this.data = new ArrayList();
+                this.data = new ArrayList<Publication>();
             } else {
-                try {
-                    // Retrieve selected row interval
-                    Object[] objArray;
-                    try {
-                        // FIXME: Should change all the usages of processResults to use 0 as the index of the forst row
-                        // from-1 and to-1 just temporary
-                        objArray = database.more(resultId, from-1, to-1);
-                    } catch(RemoteException e) {
-                        System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                        return;
-                    }
-                    logger.debug("Results retrieved. Count: "+objArray.length);
-                    // Create storage for the results
-                    this.data = new ArrayList(objArray.length);
-                    // Cast the results to the AuthorRecord objects
-                    for (int i=0;i<objArray.length;i++) {
-                        Object[] objAuth = (Object[])objArray[i];
-                        this.data.add((Publication)objAuth[0]);
-                    }
-                } catch (DBLayerException e) {
-                    // Log and set error in case of an exception
-                    logger.error("Processing search results failed: "+e.toString());
-                    setError(this.ERROR_PROCESS);
+                // Retrieve selected row interval
+                Object[] objArray;
+                // FIXME: Should change all the usages of processResults to use 0 as the index of the forst row
+                // from-1 and to-1 just temporary
+                objArray = database.more(resultId, from-1, to-1);
+                logger.debug("Results retrieved. Count: "+objArray.length);
+                // Create storage for the results
+                this.data = new ArrayList<Publication>(objArray.length);
+                // Cast the results to the AuthorRecord objects
+                for (int i=0;i<objArray.length;i++) {
+                    Object[] objAuth = (Object[])objArray[i];
+                    this.data.add((Publication)objAuth[0]);
                 }
-                // Update current first displayed row (only if data retrieval was successful).
-                if (!this.isError()) {
-                    logger.info("Results successfuly retrieved");
-                    // Update current first displayed row
-                    setCurrentFirstRow(from);
-                }
+                logger.info("Results successfuly retrieved");
+                // Update current first displayed row
+                setCurrentFirstRow(from);
             }
             // Tell observers to update
             setChanged();
             notifyObservers();
-            // Clean error flag (if it was set)
-            this.error = null;
         }
     }
     
@@ -548,45 +540,33 @@
      *
      *  @return number of results for the current SelectQuery
      */
-    public int getResultRows() {
+    public int getResultRows(){
         int result = 0;
-        if (resultId != 0) try {
-            result = database.getNumRows(resultId);
-        } catch(RemoteException e) {
-            System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
+        if (resultId != 0) {
+            try {
+                result = database.getNumRows(resultId);
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while retrieving number of rows in the result. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return 0;
+            }
         }
         return result;
     }
     
     /**
-     *  Set an error flag.
-     *  @param msg  message explaining the error which occured
+     *  Close active SelectQuery (if there is one)
+     *
+     *  @throws DBLayerException    In case database operation failed
+     *  @throws RemoteException     In case network operation failed
      */
-    public void setError(String msg) {
-        this.error = msg;
-    }
-    
-    /**
-     *  Checks whether an error flag is set.
-     *  return true if an error occured and error message is available, false otherwise
-     */
-    public boolean isError() {
-        if (this.error != null) {
-            return true;
-        } else {
-            return false;
+    public void closeActiveQuery() throws DBLayerException, RemoteException {
+        if (this.activeSelectQuery != null) {
+            database.closeQuery(this.activeSelectQuery);
+            this.activeSelectQuery = null;
         }
     }
-    
     /**
-     *  Get error message for the error that occured
-     *  @return message explaining the error which occured
-     */
-    public String getError() {
-        return this.error;
-    }
-    
-    /**
      *  Get data returned by the last search query. Returns only currently displayed data.
      *  @return data returned by the last search query
      */
@@ -679,7 +659,7 @@
     
     /**
      *  Get publication we are editing in the add/edit publication dialog
-     *  @param editPublication   Publication we are editing
+     *  @return Publication we are editing
      */
     public Publication getEditPublication() {
         return this.editPublication;

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -5,12 +5,12 @@
 import java.awt.event.ActionListener;
 import java.awt.event.FocusEvent;
 import java.awt.event.FocusListener;
+import java.awt.event.WindowAdapter;
+import java.awt.event.WindowEvent;
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
-import javax.swing.JOptionPane;
 import net.sf.plantlore.common.*;
-import javax.swing.Timer;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
@@ -19,7 +19,7 @@
  * Controller for the main PublicationManager dialog (part of the PublicationManager MVC).
  * 
  * @author Tomas Kovarik
- * @version 1.0, June 4, 2006
+ * @version 1.0
  */
 public class PublicationManagerCtrl {
     /** Instance of a logger */
@@ -41,6 +41,7 @@
         this.model = publModel;
         this.view = publView;
         // Add action listeners to buttons
+        view.addPublicationWindowListener(new PublicationWindowListener());        
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.addBtnAddActionListener(new AddPublicationButtonListener());
         view.searchBtnAddActionlistener(new SearchPublicationButtonListener());
@@ -59,36 +60,55 @@
         view.sortDirectionAddFocusListener(new SortDirectionRadioFocusListener());
         // Display all publication when Publication manager is opened using the Task
         Task task = model.searchPublication(true);
-        ProgressBar progressBar = new ProgressBar(task, view, true) {
-            public void exceptionHandler(Exception ex) {
-                if (ex instanceof DBLayerException) {
-                    DBLayerException e = (DBLayerException)ex;
-                    JOptionPane.showMessageDialog(view,L10n.getString("Error.DBLayerException")+"\n"+e.getErrorInfo(),L10n.getString("Error.DBLayerExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                    logger.error(e+": "+e.getErrorInfo());
-                    getTask().stop();
-                    return;
-                }
-                if (ex instanceof RemoteException) {
-                    RemoteException e = (RemoteException)ex;
-                    JOptionPane.showMessageDialog(view,L10n.getString("Error.RemoteException")+"\n"+e.getMessage(),L10n.getString("Error.RemoteExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                    logger.error(e);
-                    getTask().stop();
-                    return;
-                }
-                JOptionPane.showMessageDialog(view,L10n.getString("Delete.Message.UnknownException")+"\n"+ex.getMessage(),L10n.getString("Delete.Message.UnkownExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                logger.error(ex);                            
-            }              
+        DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
             // After Task is finished, display the results
+            @Override
             public void afterStopped(Object value) {
                 model.setCurrentFirstRow(1);
-                model.processResults(1, model.getDisplayRows());
+                try {
+                    model.processResults(1, model.getDisplayRows());
+                } catch (RemoteException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                } catch (DBLayerException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                }
             }
         };
-        progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
+        dpb.setTitle(L10n.getString("Publications.ProgressBar.Search"));
         task.start();
     }
     
+    
     /**
+     *  Window listener for the main Publication manager window. When window is closed, we have to close
+     *  all open database connections
+     */
+    class PublicationWindowListener extends WindowAdapter {
+        public void windowClosed(WindowEvent e) {
+            // Close database connection
+            try {
+                model.closeActiveQuery();
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            }
+        }
+    }
+
+    /**
      * ActionListener class controlling the <b>close</b> button on the form.
      */
     class CloseButtonListener implements ActionListener {
@@ -103,15 +123,22 @@
      */    
     class AddPublicationButtonListener implements ActionListener {
         public void actionPerformed(ActionEvent e) {
-            // Check whether we have rights for this operation
-            if (!model.hasRights(model.ADD)) {
-                view.showErrorMessage("You don't have sufficient rights for this operation");
+            try {
+                // Check whether we have rights for this operation
+                if (!model.hasRights(PublicationManager.ADD)) {
+                    view.showErrorMessage(L10n.getString("Publications.Add.InsufficientRights"));
+                    return;
+                }            
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
                 return;
-            }            
+            }
             // Display dialog for adding / editing publications. This dialog shares model with
             // the rest of the PublicationManager.
             AddPublicationView addPublView = new AddPublicationView(model, view.getFrame(), true);
-            AddPublicationCtrl addPublCtrl = new AddPublicationCtrl(model, addPublView);            
+            new AddPublicationCtrl(model, addPublView);            
             // We are going to add publication, no editing
             model.setEditPublication(null);
             // addPublView.setSize(400,450);        
@@ -131,13 +158,20 @@
                 view.selectRowMsg();
                 return;
             }          
-            // Check whether we have rights for this operation
-            if (!model.hasRights(model.EDIT)) {
-                view.showErrorMessage("You don't have sufficient rights for this operation");
+            try {
+                // Check whether we have rights for this operation
+                if (!model.hasRights(PublicationManager.EDIT)) {
+                    view.showErrorMessage(L10n.getString("Publications.Edit.InsufficientRights"));
+                    return;
+                }                        
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
                 return;
-            }                        
+            }
             AddPublicationView addPublView = new AddPublicationView(model, view.getFrame(), false);
-            AddPublicationCtrl addPublCtrl = new AddPublicationCtrl(model, addPublView);            
+            new AddPublicationCtrl(model, addPublView);            
             // Save publication we are going to edit
             model.setEditPublication(model.getSelectedPublication(index));            
             model.setPublicationIndex(index);
@@ -160,17 +194,35 @@
                 view.selectRowMsg();
                 return;
             }        
-            // Check whether we have rights for this operation
-            if (!model.hasRights(model.DELETE)) {
-                view.showErrorMessage("You don't have sufficient rights for this operation");
+            try {
+                // Check whether we have rights for this operation
+                if (!model.hasRights(PublicationManager.DELETE)) {
+                    view.showErrorMessage(L10n.getString("Publications.Delete.InsufficientRights"));
+                    return;
+                }           
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                
+            }
+            try {
+                // Check whether it is OK to delete the publication (it cannot be used in an occurrence)                
+                if (model.checkDelete(index) == false) {
+                    view.showErrorMessage(L10n.getString("Publications.Delete.UsedInOccurrence"));
+                    return;
+                }
+            } catch (RemoteException e1) {
+                logger.error("RemoteException caught while loading occurrences. Cannot determine whether publication can be deleted. Details: "+e1.getMessage());
+                e1.printStackTrace();
+                DefaultExceptionHandler.handle(view, e1);
                 return;
-            }           
-            // Check whether it is OK to delete the publication (it cannot be used in an occurrence)
-            if (model.checkDelete(index) == false) {
-                view.showErrorMessage("This publication cannot be deleted because it is used in an occurence");
+            } catch (DBLayerException e2) {
+                logger.error("DBLayerException caught while loading occurrences. Cannot determine whether publication can be deleted. Details: "+e2.getMessage());
+                e2.printStackTrace();
+                DefaultExceptionHandler.handle(view, e2);
                 return;
-            }
-            System.out.println("********* CHECK DELETE OK");
+            }        
             // Confirm deletion
             if (!view.confirmDelete()) {
                 return;
@@ -179,33 +231,28 @@
             model.setPublicationIndex(index);
             // Delete is executed in a separate thread using Task
             Task task = model.deletePublication();
-            ProgressBar progressBar = new ProgressBar(task, view, true) {
-                public void exceptionHandler(Exception ex) {
-                    if (ex instanceof DBLayerException) {
-                        DBLayerException e = (DBLayerException)ex;
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.DBLayerException")+"\n"+e.getErrorInfo(),L10n.getString("Error.DBLayerExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                        logger.error(e+": "+e.getErrorInfo());
-                        getTask().stop();
-                        return;
-                    }
-                    if (ex instanceof RemoteException) {
-                        RemoteException e = (RemoteException)ex;
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.RemoteException")+"\n"+e.getMessage(),L10n.getString("Error.RemoteExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                        logger.error(e);
-                        getTask().stop();
-                        return;
-                    }
-                    JOptionPane.showMessageDialog(view,L10n.getString("Delete.Message.UnknownException")+"\n"+ex.getMessage(),L10n.getString("Delete.Message.UnkownExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                    logger.error(ex);                            
-                }              
+            DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                 // Refresh the list of publications after a delete
-                public void afterStopped(Object value) {
+                @Override
+                public void afterStopped(Object value) {                    
                     model.searchPublication(false);
-                    model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }
                     model.reloadCache();
                 }
             };
-            progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
+            dpb.setTitle(L10n.getString("Publications.ProgressBar.Delete"));
             task.start();
         }
     }    
@@ -217,31 +264,27 @@
         public void actionPerformed(ActionEvent e) {
             // Run DB search. The operation is executed in a separate thread
             Task task = model.searchPublication(true);
-            ProgressBar progressBar = new ProgressBar(task, view, true) {
-                public void exceptionHandler(Exception ex) {
-                    if (ex instanceof DBLayerException) {
-                        DBLayerException e = (DBLayerException)ex;
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.DBLayerException")+"\n"+e.getErrorInfo(),L10n.getString("Error.DBLayerExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                        logger.error(e+": "+e.getErrorInfo());
-                        getTask().stop();
-                        return;
-                    }
-                    if (ex instanceof RemoteException) {
-                        RemoteException e = (RemoteException)ex;
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.RemoteException")+"\n"+e.getMessage(),L10n.getString("Error.RemoteExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                        logger.error(e);
-                        getTask().stop();
-                        return;
-                    }
-                    JOptionPane.showMessageDialog(view,L10n.getString("Delete.Message.UnknownException")+"\n"+ex.getMessage(),L10n.getString("Delete.Message.UnkownExceptionTitle"),JOptionPane.WARNING_MESSAGE);
-                    logger.error(ex);                            
-                }              
+
+            DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                 // Display the results of a search
+                @Override
                 public void afterStopped(Object value) {
-                    model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }                        
                 }
             };
-            progressBar.setTitle(L10n.getString("Delete.ProgressTitle"));
+            dpb.setTitle(L10n.getString("Publications.ProgressBar.Search"));
             task.start();
         }
     }        
@@ -254,7 +297,19 @@
             // Call processResults only if we don't see the first page (should not happen, button should be disabled)
             if (model.getCurrentFirstRow() > 1) {
                 int firstRow = Math.max(model.getCurrentFirstRow()-view.getDisplayRows(), 1);
-                model.processResults(firstRow, view.getDisplayRows());                
+                try {
+                    model.processResults(firstRow, view.getDisplayRows());                
+                } catch (RemoteException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                } catch (DBLayerException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                }
             }
         }
     }
@@ -265,8 +320,20 @@
     class NextButtonListener implements ActionListener {    
         public void actionPerformed(ActionEvent e) {
             // Call processResults only if we don't see the last page (should not happen, button should be disabled)
-            if (model.getCurrentFirstRow()+view.getDisplayRows()<=model.getResultRows()) {
-                model.processResults(model.getCurrentFirstRow()+view.getDisplayRows(), view.getDisplayRows());
+            try {            
+                if (model.getCurrentFirstRow()+view.getDisplayRows()<=model.getResultRows()) {
+                    model.processResults(model.getCurrentFirstRow()+view.getDisplayRows(), view.getDisplayRows());
+                }
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
             }
         }
     }    
@@ -355,8 +422,20 @@
             // Set new value in the model
             model.setDisplayRows(view.getDisplayRows());
             // If neccessary reload search results
-            if ((oldValue != view.getDisplayRows()) && (model.getDisplayRows() <= model.getResultRows())) {
-                model.processResults(model.getCurrentFirstRow(), view.getDisplayRows());
+            try {            
+                if ((oldValue != view.getDisplayRows()) && (model.getDisplayRows() <= model.getResultRows())) {
+                    model.processResults(model.getCurrentFirstRow(), view.getDisplayRows());
+                }
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
             }
         }        
     }            

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-02 21:32:33 UTC (rev 638)
@@ -10,7 +10,7 @@
   </NonVisualComponents>
   <Properties>
     <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-      <Connection code="L10n.getString(&quot;publicationManager&quot;)" type="code"/>
+      <Connection code="L10n.getString(&quot;Publications.Title&quot;)" type="code"/>
     </Property>
   </Properties>
   <SyntheticProperties>
@@ -63,7 +63,7 @@
         <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
           <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
             <TitledBorder title="&lt;User Code&gt;">
-              <Connection PropertyName="titleX" code="L10n.getString(&quot;publicationList&quot;)" type="code"/>
+              <Connection PropertyName="titleX" code="L10n.getString(&quot;Publications.List.Label&quot;)" type="code"/>
             </TitledBorder>
           </Border>
         </Property>
@@ -158,7 +158,7 @@
         <Component class="javax.swing.JButton" name="previousBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;prevButton&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Previous.Button&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -168,7 +168,7 @@
         <Component class="javax.swing.JButton" name="nextBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;nextButton&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Next.Button&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -178,7 +178,7 @@
         <Component class="javax.swing.JButton" name="deleteBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;deletePublicationBtn&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Delete.Button&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -188,7 +188,7 @@
         <Component class="javax.swing.JButton" name="editBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;editPublicationBtn&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Edit.Button&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -198,7 +198,7 @@
         <Component class="javax.swing.JButton" name="addBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;addPublicationBtn&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Add.Button&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -208,35 +208,35 @@
         <Component class="javax.swing.JLabel" name="totalResultLabel2">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;totalResult&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.TotalResults.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="totalRowsLabel">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="((Integer)model.getResultRows()).toString()" type="code"/>
+              <Connection code="((Integer)model.getResultRows()).toString()&#xa;" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="toDisplayedLabel2">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;displayRows&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.RowsToDisplay.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="displayedLabel2">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;displayed&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.DisplayedRows.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="displayedLabel">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;displayed&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.DisplayedRows.Label&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -255,7 +255,7 @@
         <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
           <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
             <TitledBorder title="&lt;User Code&gt;">
-              <Connection PropertyName="titleX" code="L10n.getString(&quot;searchPublicationsLbl&quot;)" type="code"/>
+              <Connection PropertyName="titleX" code="L10n.getString(&quot;Publications.Search.Label&quot;)" type="code"/>
             </TitledBorder>
           </Border>
         </Property>
@@ -274,8 +274,8 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="journalNameField" pref="186" max="32767" attributes="2"/>
-                              <Component id="collectionNameField" alignment="0" pref="186" max="32767" attributes="2"/>
+                              <Component id="journalNameField" pref="183" max="32767" attributes="2"/>
+                              <Component id="collectionNameField" alignment="0" pref="183" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
@@ -284,8 +284,8 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="referenceDetailField" pref="186" max="32767" attributes="2"/>
-                              <Component id="referenceCitationField" alignment="0" pref="186" max="32767" attributes="2"/>
+                              <Component id="referenceDetailField" pref="183" max="32767" attributes="2"/>
+                              <Component id="referenceCitationField" alignment="0" pref="183" max="32767" attributes="2"/>
                           </Group>
                       </Group>
                       <Component id="searchBtn" min="-2" pref="149" max="-2" attributes="1"/>
@@ -329,14 +329,14 @@
         <Component class="javax.swing.JLabel" name="jLabel11">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;collectionNameLbl&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Search.CollectionName.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="jLabel12">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;journalNameLbl&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Search.JournalName.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
@@ -345,7 +345,7 @@
             <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
               <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
                 <TitledBorder title="&lt;User Code&gt;">
-                  <Connection PropertyName="titleX" code="L10n.getString(&quot;sortingLbl&quot;)" type="code"/>
+                  <Connection PropertyName="titleX" code="L10n.getString(&quot;Publications.Ordering.Label&quot;)" type="code"/>
                 </TitledBorder>
               </Border>
             </Property>
@@ -355,12 +355,13 @@
             <DimensionLayout dim="0">
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" alignment="0" attributes="0">
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="jLabel13" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
+                      <EmptySpace min="-2" pref="9" max="-2" attributes="0"/>
                       <Group type="103" groupAlignment="0" attributes="0">
                           <Component id="descRadio" alignment="0" min="-2" max="-2" attributes="0"/>
                           <Component id="ascRadio" alignment="0" min="-2" max="-2" attributes="0"/>
-                          <Component id="sortCombo" alignment="1" pref="151" max="32767" attributes="0"/>
+                          <Component id="sortCombo" alignment="0" min="-2" pref="142" max="-2" attributes="0"/>
                       </Group>
                   </Group>
               </Group>
@@ -369,8 +370,8 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" attributes="0">
                       <Group type="103" groupAlignment="3" attributes="0">
+                          <Component id="sortCombo" alignment="3" min="-2" max="-2" attributes="0"/>
                           <Component id="jLabel13" alignment="3" min="-2" max="-2" attributes="0"/>
-                          <Component id="sortCombo" alignment="3" min="-2" max="-2" attributes="0"/>
                       </Group>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="ascRadio" min="-2" max="-2" attributes="0"/>
@@ -385,7 +386,7 @@
             <Component class="javax.swing.JRadioButton" name="descRadio">
               <Properties>
                 <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-                  <Connection code="L10n.getString(&quot;descending&quot;)" type="code"/>
+                  <Connection code="L10n.getString(&quot;Common.Descending&quot;)" type="code"/>
                 </Property>
                 <Property name="actionCommand" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
                   <Connection code="L10n.getString(&quot;descending&quot;)" type="code"/>
@@ -403,7 +404,7 @@
             <Component class="javax.swing.JRadioButton" name="ascRadio">
               <Properties>
                 <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-                  <Connection code="L10n.getString(&quot;ascending&quot;)" type="code"/>
+                  <Connection code="L10n.getString(&quot;Common.Ascending&quot;)" type="code"/>
                 </Property>
                 <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
                   <Border info="org.netbeans.modules.form.compat2.border.EmptyBorderInfo">
@@ -418,7 +419,7 @@
             <Component class="javax.swing.JLabel" name="jLabel13">
               <Properties>
                 <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-                  <Connection code="L10n.getString(&quot;sortByLbl&quot;)" type="code"/>
+                  <Connection code="L10n.getString(&quot;Publications.OrderBy.Label&quot;)" type="code"/>
                 </Property>
               </Properties>
             </Component>
@@ -434,42 +435,42 @@
         <Component class="javax.swing.JLabel" name="jLabel14">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;referenceCitationLbl&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Search.ReferenceCitation.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JLabel" name="jLabel15">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;referenceDetailLbl&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Search.ReferenceDetail.Label&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JButton" name="searchBtn">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;searchPublicationsBtn&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Publications.Search.Button&quot;)" type="code"/>
             </Property>
           </Properties>
         </Component>
         <Component class="javax.swing.JFormattedTextField" name="collectionNameField">
           <AuxValues>
-            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="collectionNameField.setValue(&quot;&quot;);"/>
+            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="collectionNameField.setValue(&quot;&quot;);&#xa;collectionNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.COLLECTIONNAME)));"/>
           </AuxValues>
         </Component>
         <Component class="javax.swing.JFormattedTextField" name="journalNameField">
           <AuxValues>
-            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalNameField.setValue(&quot;&quot;);"/>
+            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="journalNameField.setValue(&quot;&quot;);&#xa;journalNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALNAME)));"/>
           </AuxValues>
         </Component>
         <Component class="javax.swing.JFormattedTextField" name="referenceCitationField">
           <AuxValues>
-            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceCitationField.setValue(&quot;&quot;);"/>
+            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceCitationField.setValue(&quot;&quot;);&#xa;referenceCitationField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCECITATION)));"/>
           </AuxValues>
         </Component>
         <Component class="javax.swing.JFormattedTextField" name="referenceDetailField">
           <AuxValues>
-            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceDetailField.setValue(&quot;&quot;);"/>
+            <AuxValue name="JavaCodeGenerator_InitCodePre" type="java.lang.String" value="referenceDetailField.setValue(&quot;&quot;);&#xa;referenceDetailField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCEDETAIL)));"/>
           </AuxValues>
         </Component>
       </SubComponents>
@@ -487,7 +488,7 @@
     <Component class="javax.swing.JButton" name="helpBtn">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;Help&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -3,6 +3,7 @@
 
 import java.awt.event.ActionListener;
 import java.awt.event.FocusListener;
+import java.awt.event.WindowAdapter;
 import java.beans.PropertyChangeListener;
 import java.util.ArrayList;
 import java.util.Observable;
@@ -12,10 +13,14 @@
 import javax.swing.JFrame;
 import javax.swing.JOptionPane;
 import javax.swing.table.DefaultTableModel;
+import javax.swing.text.AttributeSet;
+import javax.swing.text.BadLocationException;
+import javax.swing.text.PlainDocument;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
-import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.Publication;
 import net.sf.plantlore.l10n.L10n;
+import org.apache.log4j.Logger;
 
 /**
  * Main dialog of the PublicationManager used for searching publications and displaying the 
@@ -28,12 +33,15 @@
     /** Model of the PublicationManager MVC */
     private PublicationManager model;
     /** Names of fields available for sorting the results */
-    private String[] sortFields = {L10n.getString("collectionNameTitle"), L10n.getString("publicationYearTitle"), L10n.getString("journalNameTitle"), L10n.getString("journalAuthorTitle"), L10n.getString("referenceCitationTitle"), L10n.getString("referenceDetailTitle")};        
+    private String[] sortFields = {L10n.getString("Publications.Sortby.CollectionNameTitle"), L10n.getString("Publications.Sortby.PublicationYearTitle"), L10n.getString("Publications.Sortby.JournalNameTitle"), L10n.getString("Publications.Sortby.JournalAuthorTitle"), L10n.getString("Publications.Sortby.ReferenceCitationTitle"), L10n.getString("Publications.Sortby.ReferenceDetailTitle")};        
     /** Names of the columns in the search results */
-    private String[] columnNames = new String [] {L10n.getString("collectionNameTitle"), L10n.getString("publicationYearTitle"), L10n.getString("journalNameTitle"), L10n.getString("journalAuthorTitle"), L10n.getString("referenceCitationTitle"), L10n.getString("referenceDetailTitle"), L10n.getString("publicationUrlTitle")};    
+    private String[] columnNames = new String [] {L10n.getString("Publications.ColumnTitle.CollectionNameTitle"), L10n.getString("Publications.ColumnTitle.PublicationYearTitle"), L10n.getString("Publications.ColumnTitle.JournalNameTitle"), L10n.getString("Publications.ColumnTitle.JournalAuthorTitle"), L10n.getString("Publications.ColumnTitle.ReferenceCitationTitle"), L10n.getString("Publications.ColumnTitle.ReferenceDetailTitle"), L10n.getString("Publications.ColumnTitle.PublicationUrlTitle")};    
     /** Contents of the table with the query result */
     private String[][] tableData;
-    
+    /** Instance of a Logger */
+    private Logger logger;
+    /** Variable used for setting maximu input size of text fields */
+    PlainDocument pd;
     /**
      * Creates new form PublicationManagerView 
      * 
@@ -43,6 +51,7 @@
      */
     public PublicationManagerView(PublicationManager model, JFrame parent, boolean modal) {        
         super(parent, modal);
+        logger = Logger.getLogger(this.getClass().getPackage().getName());                        
         this.model = model;
         this.model.addObserver(this);
         initComponents();
@@ -97,8 +106,8 @@
         sortButtonGroup.add(descRadio);
         sortButtonGroup.setSelected(ascRadio.getModel(), true);
 
-        setTitle(L10n.getString("publicationManager"));
-        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("publicationList")));
+        setTitle(L10n.getString("Publications.Title"));
+        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Publications.List.Label")));
         listTable.setModel(new javax.swing.table.DefaultTableModel(
             new Object [][] {
                 {null, null, null, null},
@@ -112,25 +121,26 @@
         ));
         jScrollPane3.setViewportView(listTable);
 
-        previousBtn.setText(L10n.getString("prevButton"));
+        previousBtn.setText(L10n.getString("Publications.Previous.Button"));
 
-        nextBtn.setText(L10n.getString("nextButton"));
+        nextBtn.setText(L10n.getString("Publications.Next.Button"));
 
-        deleteBtn.setText(L10n.getString("deletePublicationBtn"));
+        deleteBtn.setText(L10n.getString("Publications.Delete.Button"));
 
-        editBtn.setText(L10n.getString("editPublicationBtn"));
+        editBtn.setText(L10n.getString("Publications.Edit.Button"));
 
-        addBtn.setText(L10n.getString("addPublicationBtn"));
+        addBtn.setText(L10n.getString("Publications.Add.Button"));
 
-        totalResultLabel2.setText(L10n.getString("totalResult"));
+        totalResultLabel2.setText(L10n.getString("Publications.TotalResults.Label"));
 
-        totalRowsLabel.setText(((Integer)model.getResultRows()).toString());
+        totalRowsLabel.setText(((Integer)model.getResultRows()).toString()
+        );
 
-        toDisplayedLabel2.setText(L10n.getString("displayRows"));
+        toDisplayedLabel2.setText(L10n.getString("Publications.RowsToDisplay.Label"));
 
-        displayedLabel2.setText(L10n.getString("displayed"));
+        displayedLabel2.setText(L10n.getString("Publications.DisplayedRows.Label"));
 
-        displayedLabel.setText(L10n.getString("displayed"));
+        displayedLabel.setText(L10n.getString("Publications.DisplayedRows.Label"));
 
         rowsField.setValue(model.getDisplayRows());
 
@@ -190,22 +200,22 @@
                 .addContainerGap())
         );
 
-        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("searchPublicationsLbl")));
-        jLabel11.setText(L10n.getString("collectionNameLbl"));
+        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Publications.Search.Label")));
+        jLabel11.setText(L10n.getString("Publications.Search.CollectionName.Label"));
 
-        jLabel12.setText(L10n.getString("journalNameLbl"));
+        jLabel12.setText(L10n.getString("Publications.Search.JournalName.Label"));
 
-        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("sortingLbl")));
-        descRadio.setText(L10n.getString("descending"));
+        jPanel9.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Publications.Ordering.Label")));
+        descRadio.setText(L10n.getString("Common.Descending"));
         descRadio.setActionCommand(L10n.getString("descending"));
         descRadio.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         descRadio.setMargin(new java.awt.Insets(0, 0, 0, 0));
 
-        ascRadio.setText(L10n.getString("ascending"));
+        ascRadio.setText(L10n.getString("Common.Ascending"));
         ascRadio.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
         ascRadio.setMargin(new java.awt.Insets(0, 0, 0, 0));
 
-        jLabel13.setText(L10n.getString("sortByLbl"));
+        jLabel13.setText(L10n.getString("Publications.OrderBy.Label"));
 
         sortCombo.setModel(new DefaultComboBoxModel(sortFields));
 
@@ -214,19 +224,20 @@
         jPanel9Layout.setHorizontalGroup(
             jPanel9Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel9Layout.createSequentialGroup()
+                .addContainerGap()
                 .add(jLabel13)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(9, 9, 9)
                 .add(jPanel9Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(descRadio)
                     .add(ascRadio)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, sortCombo, 0, 151, Short.MAX_VALUE)))
+                    .add(sortCombo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 142, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
         );
         jPanel9Layout.setVerticalGroup(
             jPanel9Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel9Layout.createSequentialGroup()
                 .add(jPanel9Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(jLabel13)
-                    .add(sortCombo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(sortCombo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                    .add(jLabel13))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(ascRadio)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -234,19 +245,23 @@
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
-        jLabel14.setText(L10n.getString("referenceCitationLbl"));
+        jLabel14.setText(L10n.getString("Publications.Search.ReferenceCitation.Label"));
 
-        jLabel15.setText(L10n.getString("referenceDetailLbl"));
+        jLabel15.setText(L10n.getString("Publications.Search.ReferenceDetail.Label"));
 
-        searchBtn.setText(L10n.getString("searchPublicationsBtn"));
+        searchBtn.setText(L10n.getString("Publications.Search.Button"));
 
         collectionNameField.setValue("");
+        collectionNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.COLLECTIONNAME)));
 
         journalNameField.setValue("");
+        journalNameField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.JOURNALNAME)));
 
         referenceCitationField.setValue("");
+        referenceCitationField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCECITATION)));
 
         referenceDetailField.setValue("");
+        referenceDetailField.setDocument(new FieldLengthLimit(Publication.getColumnSize(Publication.REFERENCEDETAIL)));
 
         org.jdesktop.layout.GroupLayout jPanel8Layout = new org.jdesktop.layout.GroupLayout(jPanel8);
         jPanel8.setLayout(jPanel8Layout);
@@ -261,16 +276,16 @@
                             .add(jLabel12))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE)
-                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE))
+                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)
+                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jLabel14)
                             .add(jLabel15))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE)
-                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 186, Short.MAX_VALUE)))
+                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)
+                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)))
                     .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 149, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel9, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
@@ -301,7 +316,7 @@
 
         closeBtn.setText(L10n.getString("Common.Close"));
 
-        helpBtn.setText(L10n.getString("Help"));
+        helpBtn.setText(L10n.getString("Common.Help"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
@@ -332,8 +347,8 @@
         );
         pack();
     }// </editor-fold>//GEN-END:initComponents
-        
-    /**
+      
+/**
      *  Check whether the given field is empty or not. This is used for validating user input when 
      *  searching publications.
      *
@@ -371,33 +386,22 @@
     public JDialog getDialog() {
         return this;
     }
-    
+       
     /**
-     *  Display error message saying that no search field has been filled in.
-     */
-    public void showSearchErrorMessage() {
-        JOptionPane.showMessageDialog(this, "Please fill in at least one search field", "Missing search data", JOptionPane.ERROR_MESSAGE);       
-    }
-    
-    /**
      *  Display generic error message.
      *  @param message Message we want to display
      */
     public void showErrorMessage(String message) {
-        JOptionPane.showMessageDialog(this, message, "Error", JOptionPane.ERROR_MESSAGE);               
+        JOptionPane.showMessageDialog(this, message, L10n.getString("Error.GenericMessageTitle"), JOptionPane.ERROR_MESSAGE);               
     }
-    
+
     /**
      *  Method used for updating the view (called when the model has changed and notifyObservers() was called)
+     *  @param obs Instance of an Observable which changed
+     *  @param obj Object used as a parameter of the update
      */
-    public void update(Observable obs, Object obj) {       
-        // Check whether we have some kind of error to display
-        if (model.isError()) {
-            showErrorMessage(model.getError());            
-            return;
-        } else {
-            displayResults(model.getData());
-        }
+    public void update(Observable obs, Object obj) {
+        displayResults(model.getData());
     }
 
     /**
@@ -407,7 +411,6 @@
      */
     public void displayResults(ArrayList results) {
         this.tableData = new String[results.size()][];
-        System.out.println("Displaying data. Data length: "+this.tableData.length);        
         for (int i=0;i<results.size();i++) {            
             this.tableData[i] = new String[7];
             this.tableData[i][0] = ((Publication)results.get(i)).getCollectionName();
@@ -612,6 +615,14 @@
         }
     }
     
+    /** 
+     *  Add WindowListener to the main window
+     *  @param wa WindowAdapter object acting as window listener
+     */
+    public void addPublicationWindowListener(WindowAdapter wa) {
+        this.addWindowListener(wa);
+    }    
+    
     /**
      *  Add PropertyChangeListener to collection name field.
      *  @param pcl PropertyChangeListener for the collection name field
@@ -654,7 +665,7 @@
 
     /**
      *  Add FocusListener to sort combo.
-     *  @param pcl FocusListener for the sort combo
+     *  @param fl FocusListener for the sort combo
      */    
     void sortAddFocusListener(FocusListener fl) {
         sortCombo.addFocusListener(fl);
@@ -662,7 +673,7 @@
     
     /**
      *  Add FocusListener to ascending and descending radiobuttons.
-     *  @param pcl FocusListener for the ascending and descending radiobuttons
+     *  @param fl FocusListener for the ascending and descending radiobuttons
      */
     void sortDirectionAddFocusListener(FocusListener fl) {
         ascRadio.addFocusListener(fl);
@@ -675,8 +686,8 @@
      */
     public boolean confirmDelete() {
         // JOptionPane results: 0 = Yes, 1 = No
-        int res = JOptionPane.showConfirmDialog(this, "Do you really want to delete selected publication?", 
-                                                "Delete publication", JOptionPane.YES_NO_OPTION);
+        int res = JOptionPane.showConfirmDialog(this, L10n.getString("Publications.ConfirmDelete"), 
+                                                L10n.getString("Publications.ConfirmDelete.Title"), JOptionPane.YES_NO_OPTION);
         if (res == 0) {
             return true;
         }
@@ -695,18 +706,30 @@
      *  Display dialog with the message saying that no row in the table with publications is selected
      */
     public void selectRowMsg() {
-        JOptionPane.showMessageDialog(this, "Please select at least one publication from the list",
-                                      "Select publication", JOptionPane.WARNING_MESSAGE);        
+        JOptionPane.showMessageDialog(this, L10n.getString("Publications.SelectPublication"),
+                                      L10n.getString("Publications.SelectPublication.Title"), JOptionPane.WARNING_MESSAGE);        
     }
-
-    /**
-     *  Display dialoge with message saying that the result of the search is empty
-     */
-    public void showSearchInfoMessage() {
-        JOptionPane.showMessageDialog(this, "No publications with the given attributes were found. Please modify search criteria.",
-                                      "No search results", JOptionPane.INFORMATION_MESSAGE);                
-    }
     
+    class FieldLengthLimit extends PlainDocument {
+        private int limit;
+        // optional uppercase conversion
+        private boolean toUppercase = false;
+        
+        FieldLengthLimit(int limit) {
+            super();
+            this.limit = limit;
+        }
+        
+        @Override
+        public void insertString(int offset, String  str, AttributeSet attr) throws BadLocationException {
+            if (str == null) return;
+            if ((getLength() + str.length()) <= limit) {
+                super.insertString(offset, str, attr);
+            } else {
+                super.insertString(offset, str.substring(0, limit), attr);
+            }
+        }
+    }    
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton addBtn;

Modified: trunk/src/net/sf/plantlore/common/record/Publication.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Publication.java	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/common/record/Publication.java	2006-09-02 21:32:33 UTC (rev 638)
@@ -7,6 +7,7 @@
 
 package net.sf.plantlore.common.record;
 
+import java.util.Hashtable;
 import java.util.List;
 
 /**
@@ -49,6 +50,18 @@
     public static final String CREATEDWHO = "createdWho";    
     public static final String NOTE = "note";
     
+    private static Hashtable<String, Integer> columnSizes;
+    static {
+        columnSizes = new Hashtable<String,Integer>();
+        columnSizes.put(COLLECTIONNAME,255);
+        columnSizes.put(JOURNALNAME,255);
+        columnSizes.put(JOURNALAUTHORNAME,255);
+        columnSizes.put(REFERENCECITATION,4096);
+        columnSizes.put(REFERENCEDETAIL,100);
+        columnSizes.put(URL,100);
+        columnSizes.put(NOTE,4096);
+    }
+    
     //public enum Column {ID, COLLECTIONNAME, COLLECTIONYEARPUBLICATION, JOURNALNAME, JOURNALAUTHORNAME, REFERENCECITATION, REFERENCEDETAIL,
     //URL, DELETED, CREATEDWHO, NOTE};    
     
@@ -107,6 +120,15 @@
     }
     
     /**
+     *  Return size of the column in the database
+     *  @param columnConst constant identifying column
+     *  @return size of the given column
+     */
+    public static int getColumnSize(String columnConst) {
+        return columnSizes.get(columnConst);
+    }
+    
+    /**
      *   Get publication id
      *   @return id of the publication
      *   @see setId

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-02 21:32:33 UTC (rev 638)
@@ -341,7 +341,77 @@
 MetadataManager.SortAscending = Ascending
 MetadataManager.SortDescending = Descending
 
+#=============================================================
+# PUBLICATION MANAGER
+#	net.sf.plantlore.client.publications
+#=============================================================
 
+Publications.ProgressBar.Search = Searching publications, please wait.
+Publications.ProgressBar.Delete = Deleting publication, please wait.
+Publications.Add.InsufficientRights = You don't have sufficient rights to add publications
+Publications.Edit.InsufficientRights = You don't have sufficient rights to edit this publication
+Publications.Delete.InsufficientRights = You don't have sufficient rights to delete this publication
+Publications.Delete.UsedInOccurrence = This publication cannot be deleted because it is used in an occurence. To delete the publication, you have to first remove it from all the occurrences.
+Publications.ProgressBar.Save = Saving publication, please wait
+
+# Strings in the combobox for specifying column used for ordering the results
+Publications.Sortby.CollectionNameTitle=Collection name
+Publications.Sortby.ReferenceDetailTitle=Reference detail
+Publications.Sortby.ReferenceCitationTitle=Reference citation
+Publications.Sortby.JournalAuthorTitle=Journal Author
+Publications.Sortby.JournalNameTitle=Journal name
+Publications.Sortby.PublicationYearTitle=Year of publication
+
+# Column captions in the table with the search results
+Publications.ColumnTitle.CollectionNameTitle=Collection name
+Publications.ColumnTitle.ReferenceDetailTitle=Reference detail
+Publications.ColumnTitle.ReferenceCitationTitle=Reference citation
+Publications.ColumnTitle.JournalAuthorTitle=Journal author
+Publications.ColumnTitle.JournalNameTitle=Journal name
+Publications.ColumnTitle.PublicationYearTitle=Year of publication
+Publications.ColumnTitle.PublicationUrlTitle=URL
+
+Publications.ConfirmDelete = Do you really want to delete selected publication?
+Publications.ConfirmDelete.Title = Delete publication
+Publications.SelectPublication.Title = Please select at least one publication from the list
+Publications.SelectPublication.Title = Select publication
+Publications.CompulsoryFieldsMessage = At least one of the following fields must be filled in: Journal author, Year of publication, Journal name, Collection name
+Publications.CompulsoryFieldsMessage.Title = Missing compulsory field
+
+# Labels in the Add/Edit publication dialog
+Publications.Add.CollectionName.Label = Collection name:
+Publications.Add.CollectionYearPublication.Label = Year of publication:
+Publications.Add.JournalName.Label = Journal name:
+Publications.Add.JournalAuthorName.Label = Journal author:
+Publications.Add.ReferenceDetail.Label = Reference detail:
+Publications.Add.Url.Label = URL:
+Publications.Add.Note.Label = Note:
+Publications.Add.RequiredField.Label = At least one of these fields is required
+Publications.Add.SaveButton.Label = Save publication
+Publications.Add.Title = Add publication
+
+# Labels in the main Publication manager window
+Publications.List.Label = List of publications
+Publications.Search.Label = Search publications
+Publications.Previous.Button = Previous
+Publications.Next.Button = Next
+Publications.TotalResults.Label = Total results:
+Publications.RowsToDisplay.Label = Rows to display:
+Publications.DisplayedRows.Label = Displayed rows:
+Publications.Delete.Button = Delete publication
+Publications.Edit.Button = Edit publication
+Publications.Add.Button = Add publication
+Publications.Title = Publication Manager
+Publications.Search.CollectionName.Label = Collection name:
+Publications.Search.JournalName.Label = Journal name:
+Publications.Search.ReferenceCitation.Label = Reference citation:
+Publications.Search.ReferenceDetail.Label = Reference detail:
+Publications.Search.Button = Search publications
+Publications.Ordering.Label = Ordering results
+Publications.OrderBy.Label = Order by:
+
+Common.Ascending = Ascending
+Common.Descending = Descending
 #=============================================================
 # LOGIN
 #	net.sf.plantlore.client.login
@@ -588,11 +658,11 @@
 
 Publication = Publication
 Publication.collectionName = Collection
-Publication.collectionYearPublication = Year
+Publication.collectionYearPublication = Publication year
 Publication.journalName = Journal
-Publication.journalAuthorName = Author
-Publication.referenceCitation = Reference
-Publication.referenceDetail = Detail
+Publication.journalAuthorName = Journal Author
+Publication.referenceCitation = Reference citation
+Publication.referenceDetail = Reference detail
 Publication.url = URL
 Publication.createdWho = Created by
 Publication.note = Note
@@ -695,9 +765,9 @@
 Error.DeletingSharedRecord = The {0} is shared by {1} other records.\nCannot delete.
 Error.UnableToProcess = The record No. {0} cannot be processed; 
 Error.MissingUpdateRecord = The update is not defined! 
+Error.GenericMessageTitle = Error
 
 
-
 #=============================================================
 # QUESTIONS
 #=============================================================
@@ -795,44 +865,6 @@
 #Label next to the field in the Add author dialog
 Author.Add.Note=Note\:
 
-publicationUrlTitle=URL
-
-referenceDetailTitle=Reference detail
-
-referenceCitationTitle=Reference citation
-
-journalAuthorTitle=Journal Author
-
-journalNameTitle=Journal name
-
-publicationYearTitle=Year of publication
-
-collectionNameTitle=Collection name
-
-addPublicationTitle=Add publication
-
-publicationManager=Publication Manager
-
-referenceCitationLbl=Reference citation\:
-
-journalNameLbl=Journal name
-
-collectionNameLbl=Collection name
-
-referenceDetailLbl=Reference detail
-
-publicationList=List of publications
-
-addPublicationBtn=Add publication
-
-editPublicationBtn=Edit publication
-
-deletePublicationBtn=Delete publication
-
-searchPublicationsLbl=Search publications
-
-searchPublicationsBtn=Search publications
-
 publicationSearchFailed=Searching publications failed
 
 publicationSaveFailed=Saving publication failed
@@ -843,22 +875,6 @@
 
 publicationProcessResultsFailed=Processing search results failed
 
-addPublicationNoteLbl=Note\:
-
-addPublicationUrlLbl=URL\:
-
-addPublicationReferenceDetailLbl=Reference detail\:
-
-addPublicationReferenceCitationLbl=Reference citation\:
-
-addPublicationJournalAuthorNameLbl=Journal author\:
-
-addPublicationJournalNameLbl=Journal name\:
-
-addPublicationCollectionYearPublicationLbl=Year of publication\:
-
-addPublicationCollectionNameLbl=Collection name\:
-
 authorSearchFailed=Searching authors failed
 
 authorSaveFailed=Saving author failed
@@ -1101,8 +1117,6 @@
 
 Overview.MenuDataPublications=&Publication manager
 
-Publication.Add.SaveButton=Save publication
-
 Message.DeleteRecords={0} records will be deleted.
 
 Message.DeleteRecordsTT=Warning
@@ -1423,3 +1437,19 @@
 Overview.MenuHelp.About=About
 
 Overview.MenuHelp.AboutTT=Displays info about Plantlore and this installation.
+
+Publication.Add.SaveButton=Save publication
+
+PUBLICATION.null=Publication
+
+publicationList=List of publications
+
+publicationManager=Publication manager
+
+publicationYearTitle=Year of publication
+
+publicationUrlTitle=URL
+
+collectionNameLbl=Collection name
+
+collectionNameTitle=Collection name

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-02 21:32:33 UTC (rev 638)
@@ -391,23 +391,23 @@
 
 journalNameTitle=Journal name
 
-publicationYearTitle=Year of publication
+publicationYearTitle=Rok publikace
 
-collectionNameTitle=Collection name
+collectionNameTitle=N\u00E1zev kolekce
 
 addPublicationTitle=Add publication
 
-publicationManager=Publication Manager
+publicationManager=Spr\u00E1va publikac\u00ED
 
 referenceCitationLbl=Reference citation\:
 
 journalNameLbl=Journal name
 
-collectionNameLbl=Collection name
+collectionNameLbl=N\u00E1zev kolekce
 
 referenceDetailLbl=Reference detail
 
-publicationList=List of publications
+publicationList=Seznam publikac\u00ED
 
 addPublicationBtn=Add publication
 
@@ -419,15 +419,15 @@
 
 searchPublicationsBtn=Search publications
 
-publicationSearchFailed=Searching publications failed
+publicationSearchFailed=Vyhled\u00E1v\u00E1n\u00ED publikac\u00ED selhalo
 
-publicationSaveFailed=Saving publication failed
+publicationSaveFailed=Uklad\u00E1n\u00ED publikace selhalo
 
-publicationUpdateFailed=Updating publication failed
+publicationUpdateFailed=\u00DAprava publikace selhala
 
-publicationDeleteFailed=Deleting publication failed
+publicationDeleteFailed=Maz\u00E1n\u00ED publikace selhalo
 
-publicationProcessResultsFailed=Processing search results failed
+publicationProcessResultsFailed=Spracov\u00E1n\u00ED v\u00FDsledk\u016F hled\u00E1n\u00ED selhalo
 
 addPublicationNoteLbl=Note\:
 
@@ -1198,17 +1198,17 @@
 
 Publication.collectionName=Kolekce
 
-Publication.collectionYearPublication=Rok
+Publication.collectionYearPublication=Rok publikace
 
 Publication.journalName=\u017Durn\u00E1l
 
-Publication.journalAuthorName=Autor
+Publication.journalAuthorName=Autor \u010Dl\u00E1nku
 
-Publication.referenceCitation=Reference
+Publication.referenceCitation=Reference (citace)
 
-Publication.referenceDetail=Detail
+Publication.referenceDetail=Reference (detail)
 
-Publication.url=Web
+Publication.url=URL
 
 Publication.createdWho=Vytvo\u0159eno (k\u00FDm)
 
@@ -1577,3 +1577,113 @@
 Overview.MenuHelp.About=O programu
 
 Overview.MenuHelp.AboutTT=Zobraz\u00ED informace o Plantlore a t\u00E9to instalaci.
+
+Publications.Add.Button=P\u0159idej publikaci
+
+Publications.Add.CollectionName.Label=N\u00E1zev kolekce\:
+
+Publications.Add.CollectionYearPublication.Label=Rok publikace\:
+
+Publications.Add.InsufficientRights=Nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED pro p\u0159id\u00E1v\u00E1n\u00ED publikac\u00ED
+
+Publications.Add.JournalAuthorName.Label=Autor \u010Dl\u00E1nku\:
+
+Publications.Add.JournalName.Label=N\u00E1zev \u010Dl\u00E1nku\:
+
+Publications.Add.Note.Label=Pozn\u00E1mka\:
+
+Publications.Add.ReferenceDetail.Label=Reference (detail)\:
+
+Publications.Add.RequiredField.Label=Alespo\u0148 jedna z t\u011Bchto polo\u017Eek mus\u00ED b\u00FDt vypl\u0148ena
+
+Publications.Add.SaveButton.Label=Ulo\u017E publikaci
+
+Publications.Add.Title=P\u0159idej publikaci
+
+Publications.Add.Url.Label=URL\:
+
+Publications.ColumnTitle.CollectionNameTitle=N\u00E1zev kolekce
+
+Publications.ColumnTitle.JournalAuthorTitle=Autor \u010Dl\u00E1nku
+
+Publications.ColumnTitle.JournalNameTitle=N\u00E1zev \u010Dl\u00E1nku
+
+Publications.ColumnTitle.PublicationUrlTitle=URL
+
+Publications.ColumnTitle.PublicationYearTitle=Rok publikace
+
+Publications.ColumnTitle.ReferenceCitationTitle=Reference (citace)
+
+Publications.ColumnTitle.ReferenceDetailTitle=Reference (detail)
+
+Publications.CompulsoryFieldsMessage=Alespo\u0148 jedna z n\u00E1sleduj\u00EDc\u00EDch polo\u017Eek mus\u00ED b\u00FDt vypln\u011Bna\: Autor \u010Dl\u00E1nku, Rok publikace, N\u00E1zev \u010Dl\u00E1nku, N\u00E1zev kolekce
+
+Publications.CompulsoryFieldsMessage.Title=Chyb\u011Bj\u00EDc\u00ED povinn\u00E1 polo\u017Eka
+
+Publications.ConfirmDelete=Opravdu chcete smazat vybranou publikaci?
+
+Publications.ConfirmDelete.Title=Sma\u017E publikaci
+
+Publications.Delete.Button=Sma\u017E publikaci
+
+Publications.Delete.InsufficientRights=Nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED pro tuto operaci
+
+Publications.Delete.UsedInOccurrence=Tato publikace nem\u016F\u017Ee b\u00FDt smaz\u00E1na proto\u017Ee se vyskytuje u n\u011Bkter\u00E9ho z n\u00E1lez\u016F. Aby bylo mo\u017En\u00E9 ji smazat, mus\u00EDte ji nejprve odstranit ze v\u0161ech n\u00E1lez\u016F u kter\u00FDch se vyskytuje.
+
+Publications.DisplayedRows.Label=Zobrazen\u00E9 \u0159\u00E1dky\:
+
+Publications.Edit.Button=Uprav publikaci
+
+Publications.Edit.InsufficientRights=Nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED pro tuto operaci
+
+Publications.List.Label=Seznam publikac\u00ED
+
+Publications.Next.Button=N\u00E1sleduj\u00EDc\u00ED
+
+Publications.OrderBy.Label=Uspo\u0159\u00E1dej dle\:
+
+Publications.Ordering.Label=Uspo\u0159\u00E1d\u00E1n\u00ED v\u00FDsledk\u016F
+
+Publications.Previous.Button=P\u0159edchoz\u00ED
+
+Publications.ProgressBar.Delete=Ma\u017Eu publikaci, \u010Dekejte pros\u00EDm.
+
+Publications.ProgressBar.Save=Ukl\u00E1d\u00E1m publikaci, \u010Dekejte pros\u00EDm.
+
+Publications.ProgressBar.Search=Vyhled\u00E1v\u00E1m publikace, \u010Dekejte pros\u00EDm.
+
+Publications.RowsToDisplay.Label=Zobrazit \u0159\u00E1dk\u016F\:
+
+Publications.Search.Button=Vyhledej publiakce
+
+Publications.Search.CollectionName.Label=N\u00E1zev kolekce\:
+
+Publications.Search.JournalName.Label=N\u00E1zev \u0107l\u00E1nku\:
+
+Publications.Search.Label=Vyhled\u00E1v\u00E1n\u00ED publikac\u00ED
+
+Publications.Search.ReferenceCitation.Label=Reference (citace)
+
+Publications.Search.ReferenceDetail.Label=Reference (detail)
+
+Publications.SelectPublication.Title=Vyberte publikaci
+
+Publications.Sortby.CollectionNameTitle=N\u00E1zev kolekce
+
+Publications.Sortby.JournalAuthorTitle=Autor \u010Dl\u00E1nku
+
+Publications.Sortby.JournalNameTitle=N\u00E1zev \u010Dl\u00E1nku
+
+Publications.Sortby.PublicationYearTitle=Rok publikace
+
+Publications.Sortby.ReferenceCitationTitle=Reference (citace)
+
+Publications.Sortby.ReferenceDetailTitle=Reference (detail)
+
+Publications.Title=Spr\u00E1va publikac\u00ED
+
+Publications.TotalResults.Label=V\u00FDsledk\u016F celkem\:
+
+Common.Ascending=Vzestupn\u011B
+
+Common.Descending=Sestupn\u011B

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-02 20:57:18 UTC (rev 637)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-02 21:32:33 UTC (rev 638)
@@ -1107,3 +1107,135 @@
 Overview.MenuHelp.About=About
 
 Overview.MenuHelp.AboutTT=Displays info about Plantlore and this installation.
+
+Publication=Publication
+
+Publication.collectionName=Collection
+
+Publication.collectionYearPublication=Publication year
+
+Publication.createdWho=Created by
+
+Publication.deleted=Deleted
+
+Publication.journalAuthorName=Journal Autor
+
+Publication.journalName=Journal
+
+Publication.note=Note
+
+Publication.referenceCitation=Reference citation
+
+Publication.referenceDetail=Reference detail
+
+Publication.url=URL
+
+Publications.Add.Button=Add publication
+
+Publications.Add.CollectionName.Label=Collection name\:
+
+Publications.Add.CollectionYearPublication.Label=Year of publication\:
+
+Publications.Add.InsufficientRights=You don't have sufficient rights to add publications
+
+Publications.Add.JournalAuthorName.Label=Journal author\:
+
+Publications.Add.JournalName.Label=Journal name\:
+
+Publications.Add.Note.Label=Note\:
+
+Publications.Add.ReferenceDetail.Label=Reference detail\:
+
+Publications.Add.RequiredField.Label=At least one of these fields is required
+
+Publications.Add.SaveButton.Label=Save publication
+
+Publications.Add.Title=Add publication
+
+Publications.Add.Url.Label=URL\:
+
+Publications.ColumnTitle.CollectionNameTitle=Collection name
+
+Publications.ColumnTitle.JournalAuthorTitle=Journal author
+
+Publications.ColumnTitle.JournalNameTitle=Journal name
+
+Publications.ColumnTitle.PublicationUrlTitle=URL
+
+Publications.ColumnTitle.PublicationYearTitle=Year of publication
+
+Publications.ColumnTitle.ReferenceCitationTitle=Reference citation
+
+Publications.ColumnTitle.ReferenceDetailTitle=Reference detail
+
+Publications.CompulsoryFieldsMessage=At least one of the following fields must be filled in\: Journal author, Year of publication, Journal name, Collection name
+
+Publications.CompulsoryFieldsMessage.Title=Missing compulsory field
+
+Publications.ConfirmDelete=Do you really want to delete selected publication?
+
+Publications.ConfirmDelete.Title=Delete publication
+
+Publications.Delete.Button=Delete publication
+
+Publications.Delete.InsufficientRights=You don't have sufficient rights to delete this publication
+
+Publications.Delete.UsedInOccurrence=This publication cannot be deleted because it is used in an occurence. To delete the publication, you have to first remove it from all the occurrences.
+
+Publications.DisplayedRows.Label=Displayed rows\:
+
+Publications.Edit.Button=Edit publication
+
+Publications.Edit.InsufficientRights=You don't have sufficient rights to edit this publication
+
+Publications.List.Label=List of publications
+
+Publications.Next.Button=Next
+
+Publications.OrderBy.Label=Order by\:
+
+Publications.Ordering.Label=Ordering results
+
+Publications.Previous.Button=Previous
+
+Publications.ProgressBar.Delete=Deleting publication, please wait.
+
+Publications.ProgressBar.Save=Saving publication, please wait.
+
+Publications.ProgressBar.Search=Searching publications, please wait.
+
+Publications.RowsToDisplay.Label=Rows to display\:
+
+Publications.TotalResults.Label=Total results\:
+
+Publications.Title=Publication Manager
+
+Publications.Sortby.ReferenceDetailTitle=Reference detail
+
+Publications.Sortby.ReferenceCitationTitle=Reference citation
+
+Publications.Sortby.PublicationYearTitle=Year of publication
+
+Publications.Sortby.JournalNameTitle=Journal name
+
+Publications.Sortby.CollectionNameTitle=Collection name
+
+Publications.Sortby.JournalAuthorTitle=Journal Author
+
+Publications.SelectPublication.Title=Select publication
+
+Publications.Search.ReferenceDetail.Label=Reference detail\:
+
+Publications.Search.ReferenceCitation.Label=Reference citation\:
+
+Publications.Search.Label=Search publications
+
+Publications.Search.JournalName.Label=Journal name\:
+
+Publications.Search.Button=Search publications
+
+Publications.Search.CollectionName.Label=Collection name\:
+
+Common.Ascending=Ascending
+
+Common.Descending=Descending



From fraktalek at mail.berlios.de  Sun Sep  3 00:39:47 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 3 Sep 2006 00:39:47 +0200
Subject: [Plantlore-dev] r639 - in trunk/src/net/sf/plantlore: client common
Message-ID: <200609022239.k82MdlWC018408@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-03 00:39:45 +0200 (Sun, 03 Sep 2006)
New Revision: 639

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/common/ProgressBar.java
Log:
Update method of ProgressBar is now run in EventDispatchThread. This seems to prevent the progress bar freezing. Further testing needed.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 21:32:33 UTC (rev 638)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-02 22:39:45 UTC (rev 639)
@@ -1079,26 +1079,18 @@
 					public void exceptionHandler(final Exception ex) {
 						logger.error("Error while filling jasper report in SchedaAction: "+ ex);
 						ex.printStackTrace();
-						SwingUtilities.invokeLater(new Runnable() {
-							public void run() {
 								JOptionPane.showMessageDialog(view.getParent(),
 											L10n.getString("Print.Message.BrokenReport")
 														+ "\n"
 														+ ex.getMessage(),
 											L10n.getString("Print.Message.BrokenReport"),
 												JOptionPane.WARNING_MESSAGE);
-							}
-						});
 						getTask().stop();
 					}
 
 					public void afterStopped(final Object value) {
-						SwingUtilities.invokeLater(new Runnable() {
-							public void run() {
-								new SchedaView(view, true, (JasperPrint) value)
-										.setVisible(true);
-							}
-						});
+                                                new SchedaView(view, true, (JasperPrint) value)
+                                                                .setVisible(true);
 					}
 				};
 				task.start();

Modified: trunk/src/net/sf/plantlore/common/ProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-02 21:32:33 UTC (rev 638)
+++ trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-02 22:39:45 UTC (rev 639)
@@ -166,70 +166,76 @@
      *
      * Invokes exceptionHanlder on received exceptions.
      */
-    public void update(Observable o, Object arg) {
+    public void update(final Observable o, final Object arg) {
         final ProgressBar pb = this;
-        if (arg instanceof Pair) {
-            Pair p = (Pair)arg;
-            Object first = p.getFirst();
-            if (first instanceof Task.Message) {
-                Task.Message msg = (Task.Message)first;
-                Object value = p.getSecond();
-                logger.debug("Received message: "+msg);
-                switch (msg) {
-                    case STARTING:
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                setLocationRelativeTo(parent);
-                                setVisible(true);
-                                logger.debug("Progress bar visible");
-                            }
-                        });
-                        break;
-                    case POSITION_CHANGED:
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                progressBar.setValue(task.getPosition());
-                            }
-                        });
-                        break;
-                    case MESSAGE_CHANGED:
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                String text = task.getStatusMessage();
-                                statusField.setText(text);
-                                progressBar.setString(text);
-                                int curWidth = statusField.getWidth();
-                                if (text.length() > (curWidth/charSizeApprox)) {
-                                    int newWidth = new Double(text.length()*charSizeApprox).intValue();
-                                    pb.setSize(pb.getWidth()+(newWidth-curWidth),pb.getHeight());
+        SwingUtilities.invokeLater(new Runnable() {
+            public void run() {
+                
+                if (arg instanceof Pair) {
+                    Pair p = (Pair)arg;
+                    Object first = p.getFirst();
+                    if (first instanceof Task.Message) {
+                        Task.Message msg = (Task.Message)first;
+                        Object value = p.getSecond();
+                        logger.debug("Received message: "+msg);
+                        switch (msg) {
+                            case STARTING:
+                                SwingUtilities.invokeLater(new Runnable() {
+                                    public void run() {
+                                        setLocationRelativeTo(parent);
+                                        setVisible(true);
+                                        logger.debug("Progress bar visible");
+                                    }
+                                });
+                                break;
+                            case POSITION_CHANGED:
+                                SwingUtilities.invokeLater(new Runnable() {
+                                    public void run() {
+                                        progressBar.setValue(task.getPosition());
+                                    }
+                                });
+                                break;
+                            case MESSAGE_CHANGED:
+                                SwingUtilities.invokeLater(new Runnable() {
+                                    public void run() {
+                                        String text = task.getStatusMessage();
+                                        statusField.setText(text);
+                                        progressBar.setString(text);
+                                        int curWidth = statusField.getWidth();
+                                        if (text.length() > (curWidth/charSizeApprox)) {
+                                            int newWidth = new Double(text.length()*charSizeApprox).intValue();
+                                            pb.setSize(pb.getWidth()+(newWidth-curWidth),pb.getHeight());
+                                        }
+                                    }
+                                });
+                                break;
+                            case LENGTH_CHANGED:
+                                if (progressBar.isIndeterminate()) {
+                                    progressBar.setIndeterminate(false);
                                 }
-                            }
-                        });
-                        break;
-                    case LENGTH_CHANGED:
-                        if (progressBar.isIndeterminate()) {
-                            progressBar.setIndeterminate(false);
-                        }
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                progressBar.setMaximum(task.getLength());
-                            }
-                        });
-                        break;
-                    case STOPPING:
-                        setVisible(false);
-                        dispose(); // FIXME: Should not this method be invoked from the EDT?                    
-                        parent.setCursor(Cursor.getDefaultCursor());
-                        logger.debug( "ProgressBar:Stopping " + task );
-                        afterStopping();
-                        break;
-                    case STOPPED:
-                    	logger.debug( "ProgressBar:Stopped " + task );
-                        afterStopped(value);
-                        break;                    
-                }//switch
-            }//instanceof Message
-        }//instanceof Pair
+                                SwingUtilities.invokeLater(new Runnable() {
+                                    public void run() {
+                                        progressBar.setMaximum(task.getLength());
+                                    }
+                                });
+                                break;
+                            case STOPPING:
+                                setVisible(false);
+                                dispose(); // FIXME: Should not this method be invoked from the EDT?                    
+                                parent.setCursor(Cursor.getDefaultCursor());
+                                logger.debug( "ProgressBar:Stopping " + task );
+                                afterStopping();
+                                break;
+                            case STOPPED:
+                                logger.debug( "ProgressBar:Stopped " + task );
+                                afterStopped(value);
+                                break;                    
+                        }//switch
+                    }//instanceof Message
+
+                }//instanceof Pair
+            }//run()
+        });//invokeLater
         
         if (arg instanceof Exception) {
             exceptionHandler((Exception)arg);



From kovo at mail.berlios.de  Sun Sep  3 02:10:44 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sun, 3 Sep 2006 02:10:44 +0200
Subject: [Plantlore-dev] r640 - trunk/src/net/sf/plantlore/help/cs/html
Message-ID: <200609030010.k830Aing009103@sheep.berlios.de>

Author: kovo
Date: 2006-09-03 02:10:41 +0200 (Sun, 03 Sep 2006)
New Revision: 640

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
   trunk/src/net/sf/plantlore/help/cs/html/metadata.html
Log:
Testing help encoding. This is just to verify whether the it works so that the rest of the files can be modified.

Modified: trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-02 22:39:45 UTC (rev 639)
+++ trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-03 00:10:41 UTC (rev 640)
@@ -1,41 +1,40 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>P?id?v?n? a editace n?lez?</title>
-</head>
-<body>
-<h1>P?id?v?n? a editace n?lez?</h1>
-<p>Dialogy pro p?id?v?n? a editaci n?lezu jsou v z?sad? stejn?, li?? se jen v u?elu a detailech chov?n?.
-Editaci i p?id?v?n? je mo?n? vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze stromu n?lez?. 
-Pak se v p?id?vac?m dialogu p?edvypln? ?daje dan? lokality.</p>
-
-<img src="picture/addedit_place_cz.png" alt="Horn? ??st dialogu s polo?kami o m?st? n?lezu">
-
-<p>Dialog se v obou p??padech skl?d? ze t?? ??st?: zad?v?n? m?sta, zad?v?n? n?lezu a tabulky
- seznamu n?lez?. Tabulka se seznamem n?lez? obsahuje v?echny n?lezy obsa?en? v dan? lokalit?. Je zobrazena
- pro snaz?? orientaci v ji? zadan?ch n?lezech. V?dy je nutn? vyplnit v?echny povinn? polo?ky (jsou 
- ozna?eny hv?zdi?kou). Po zad?n? polo?ek se kliknut?m na tla??tko Ok p?id? nov? n?lez. Dialog z?stane 
- otev?en? i se v?emi vypln?n?mi hodnotami pro snaz?? zad?v?n? v?ce n?lez? na stejn?m m?st? (p??padn? 
- stejn?ho n?lezu na r?zn?ch m?stech). Vymaz?n? vypln?n?ch hodnot je mo?n? tla??tkem Vyma?, kter? vyma?e
- hodnoty v p??slu?n? sekci.</p>
-
-<img src="picture/addedit_occurrence_cz.png" alt="Prost?edn? ??st dialogu s polo?kami o n?lezu.">
-
-<p>Pokud byl dialog pro p?id?v?n? vyvol?n pro ur?itou lokalitu ze stromu lokalit, pak 
-u? je prvn? ??st dialogu, zad?v?n? m?sta, p?edvypln?na. </p>
-
-<p>M?sto je mo?n? up?esnit zad?n?m sou?adnic GPS. A to bu? prost?m veps?n?m sou?adnic anebo nahr?n?m 
-tabulky GPS sou?adnic a zad?n?m pouze symbolu konkr?tn? sou?adnice. Sou?adnice je mo?n? zadat v jednom 
-ze t?? sou?adn?ch syst?m?: SJTSK, S42 a WGS84. Plantlore pou??v? jako z?kladn? sou?adn? syst?m syst?m 
-WGS84, do kter?ho se zadan? sou?adnice v?dy p?evedou. Nahranou tabulku s GPS sou?adnicemi je mo?n? 
-zobrazit kliknut?m na tla??tko Zobrazit.</p>
-
-<p>Tabulka n?lez? v dan? lokalit?. Zobrazuje se pouze informace o autorech, taxonu a datu n?lezu.</p>
-
-<img src="picture/addedit_occurrence_table_cz.png" alt="Tabulka n?lez? v dan? lokalit?">
-<p></p>
-<p></p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - P?id?v?n? a editace n?lez?</title>
+</head>
+<body>
+<h1>P?id?v?n? a editace n?lez?</h1>
+<p>Dialogy pro p?id?v?n? a editaci n?lezu jsou v z?sad? stejn?, li?? se jen v u?elu a detailech chov?n?.
+Editaci i p?id?v?n? je mo?n? vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze stromu n?lez?. 
+Pak se v p?id?vac?m dialogu p?edvypln? ?daje dan? lokality.</p>
+
+<img src="picture/addedit_place_cz.png" alt="Horn? ??st dialogu s polo?kami o m?st? n?lezu">
+
+<p>Dialog se v obou p??padech skl?d? ze t?? ??st?: zad?v?n? m?sta, zad?v?n? n?lezu a tabulky
+ seznamu n?lez?. Tabulka se seznamem n?lez? obsahuje v?echny n?lezy obsa?en? v dan? lokalit?. Je zobrazena
+ pro snaz?? orientaci v ji? zadan?ch n?lezech. V?dy je nutn? vyplnit v?echny povinn? polo?ky (jsou 
+ ozna?eny hv?zdi?kou). Po zad?n? polo?ek se kliknut?m na tla??tko Ok p?id? nov? n?lez. Dialog z?stane 
+ otev?en? i se v?emi vypln?n?mi hodnotami pro snaz?? zad?v?n? v?ce n?lez? na stejn?m m?st? (p??padn? 
+ stejn?ho n?lezu na r?zn?ch m?stech). Vymaz?n? vypln?n?ch hodnot je mo?n? tla??tkem Vyma?, kter? vyma?e
+ hodnoty v p??slu?n? sekci.</p>
+
+<img src="picture/addedit_occurrence_cz.png" alt="Prost?edn? ??st dialogu s polo?kami o n?lezu.">
+
+<p>Pokud byl dialog pro p?id?v?n? vyvol?n pro ur?itou lokalitu ze stromu lokalit, pak 
+u? je prvn? ??st dialogu, zad?v?n? m?sta, p?edvypln?na. </p>
+
+<p>M?sto je mo?n? up?esnit zad?n?m sou?adnic GPS. A to bu? prost?m veps?n?m sou?adnic anebo nahr?n?m 
+tabulky GPS sou?adnic a zad?n?m pouze symbolu konkr?tn? sou?adnice. Sou?adnice je mo?n? zadat v jednom 
+ze t?? sou?adn?ch syst?m?: SJTSK, S42 a WGS84. Plantlore pou??v? jako z?kladn? sou?adn? syst?m syst?m 
+WGS84, do kter?ho se zadan? sou?adnice v?dy p?evedou. Nahranou tabulku s GPS sou?adnicemi je mo?n? 
+zobrazit kliknut?m na tla??tko Zobrazit.</p>
+
+<p>Tabulka n?lez? v dan? lokalit?. Zobrazuje se pouze informace o autorech, taxonu a datu n?lezu.</p>
+
+<img src="picture/addedit_occurrence_table_cz.png" alt="Tabulka n?lez? v dan? lokalit?">
+<p></p>
+<p></p>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/metadata.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/metadata.html	2006-09-02 22:39:45 UTC (rev 639)
+++ trunk/src/net/sf/plantlore/help/cs/html/metadata.html	2006-09-03 00:10:41 UTC (rev 640)
@@ -1,105 +1,105 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Spr?va metadat</title>
-</head>
-<body>
-<h1>Spr?va metadat</h1>
-<img src="picture/metadataEnter_cs.png">
-<br><br>
-
-Spr?vce metadat umo??uje administr?torovi p?id?vat, editovat a mazat metadata jednotliv?ch projekt?.  
-Spr?vce metadat otev?ete z menu <b>Data/Spr?va metadat</b> nebo kl?vesovou zkratkou CTRL + M.
-
-<h5>Dialog spr?vce metadat</h5>
-
-<img src="picture/metadataDialog_cs.png">
-<br><br>
-Dialog pro spr?vu metadat je rozd?len do dvou ??st?:
-<ul>
-  <li><b>Seznam metadat projekt?</b> - zobrazen? seznamu metadat existuj?c?ch projekt? podle kriteri? zadan?ch pro vyhled?v?n? a set??zen? 
-  <li><b>Vyhled?v?n?</b> - zad?n? po?adavk? pro vyhled?v?n? a set??zen? metadat
-</ul>
-
-<h2>Seznam metadat</h2>
-
-Po ?sp??n?m vyhled?v?n? je v t?to ??sti zobrazen seznam vyhledan?ch metadat projekt?. Po?et projekt? zobrazen?ch v tabulce si m??ete sami nastavit p?eps?n?m 
-hodnoty pro <b><i>Zobrazit ??dk?</i></b> a potvrzen?m nov? hodnoty kl?vesov?m tla??tkem ENTER. V tabulce se p?ep?n?te na dal?? nebo p?edchoz? 
-seznam u?ivatel? pomoc? tla??tek <b><i>P?edchoz?</i></b> a <b><i>N?sleduj?c?</i></b>. Informace o aktu?ln? zobrazen?m seznamu metadat projekt? jsou uvedeny v ??sti 
-pod tabulkou. 
-<br>
-Pro pr?ci se z?znamem jsou zde k dispozici tla??tka:
-<ul>    
-   <li><i><b>P?idej metadata</i></b> - <a href=#add>p?id?n? metadat projektu</a></li>
-   <li><i><b>Edituj metadata</i></b> - <a href=#edit>editace metadat projektu</a></li>
-   <li><i><b>Detail metadat</i></b> - <a href=#detail>detailn? metadata projektu</a></li>
-   <li><i><b>Sma? metadata</i></b> - <a href=#drop>smaz?n? metadat projektu</a></li> 
-</ul>   
-  
-<h2>Vyhled?v?n?</h2>
-
-Spr?vce metadat n?b?z? administr?torovi mo?nost vyhled?vat podle t?? parametr?: instituce, n?zev projektu a zdroj dat. V?sledek m??e b?t set??zen 
-podle n?zvu instituce, n?zvu projektu, zdroji dat, jm?no osoby pro technickou podporu, jm?no osoby pro obsahovou podporu, datumu vytvo?en? projektu a 
-datumu posledn? modifikace projektu. Pokud nejsou zad?ny, ?adn? parametry a omezen? budou vyhled?ny v?echny metadata projekt?. 
-<br><br>
-<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli??v?na velk? a mal? p?smena (case insensitive).
-
-<a name="add"></a><h2>P?id?n? metadat projektu</h2>
-  
-  <h5>Dialog pro p?id?n? metadat</h5>
-  
-  <img src="picture/metadataAdd_cs.png">
-  <br><br>
-  Dialog pro p?id?n? nov?ho projektu m??ete otev??t ze Spr?vce metadat. V zobrazen?m okn? jsou k vypln?n? n?sleduj?c? polo?ky:
-  <ul>
-    <li><b>Instituce</b> - jednozna?n? identifik?tor instituce, kter? je vlastn?kem origin?ln?ho datov?ho zdroje.
-    Tato polo?ka je povinn? a bez jej?ho vypln?n? v?m aplikace nedovol? metadata p?idat.</li>
-    <li><b>Organizace</b> - zkratka organizace.</li>
-    <li><b>Technick? podpora</b> - jm?no osoby, kter? se star? o technickou ??st projektu. Tato polo?ka je povinn?.</li>
-    <li><b>Technick? podpora - email</b> - kontaktn? email na osobu, kter? se star? o technickou ??st projektu.</li>
-    <li><b>Technick? podpora - adresa</b> - kontaktn? adresa na osobu,  kter? se star? o technickou ??st projektu.</li>
-    <li><b>Obsahov? podpora</b> - jm?no osoby, kter? m? na starosti obsahovou ??st projektu. Tato polo?ka je povinn?.</li>
-    <li><b>Obsahov? podpora - email</b> - kontaktn? email na osobu, kter? m? na starosti obsahovou projektu.</li>
-    <li><b>Obsahov? podpora - adresa</b> - kontaktn? adresa na osobu, kter? m? na starosti obsahovou ??st projektu.</li>
-    <li><b>N?zev projektu</b> - kr?tk? n?zev projektu. N?zev projektu je povinn? polo?ka a mus? b?t v r?mci datab?ze jednozna?n?.</li>
-    <li><b>Detail k projektu</b> - podrobn?j?? popis projektu.</li>
-    <li><b>Zdroj</b> - jm?no nebo k?d datov?ho zdroje. Tato polo?ka je povinn?.</li>
-    <li><b>Basis</b> -  informace o tom, co dan? z?znamy popisuj? (preservedSpecimen, ...).</li>
-    <li><b>Pozn?mka</b> - pozn?mka k projektu.</li>
-    <li><b>Datum vytvo?en? projektu</b> - datum a ?as, kdy byl projekt vytvo?en. Tato polo?ka je povinn?.</li>
-    <li><b>Datum posledn? modifikace projektu</b> - datum a ?as, kdy v projektu byly z?znamy naposled modifikov?ny, vlo?eny nebo smaz?ny.</li>        
- </ul>
- 
-<a name="edit"></a><h2>Editace u?ivatele</h2>
-  Dialog pro editaci metadat existuj?c?ho projektu otev?ete ze Spr?vce metadat. Nezapome?te, ?e pro otev?en? dialogu mus?te m?t ozna?en? projekt, 
-  k jeho? matadata se chyst?te editovat. Vzhled edit dialogu je t?m?? toto?n? s add dialogem. Povinn? polo?ky jsou: Instituce, jm?no osoby pro Technickou podporu, 
-  jm?no osoby pro Obsahovou podporu, N?zev projektu a Zdroj dat. <br>
-  Needitovatelen? polo?ky jsou: 
-  
-  <ul>    
-    <li><b>Datum vytvo?en? projektu</b> - datum a ?as informuj?c? o vytvo?en? u?ivatele. Needitovateln? polo?ka. </li>
-    <li><b>Datum posledn? modifikace projektu</b> - datum a ?as informuj?c? o zru?en? p??stupu u?ivatele do aplikace. Needitovateln? polo?ka.</li>
-  </ul>
-
-  Informace o zm?n?ch proveden?ch v jednoliv?ch metadatech m??e administr?tor dohledat v dialogu <a href="./history.html#historyData">celkov? historie</a>,
-  kde m??e vyu??t i mo?nosti n?vratu k d??v?j??m hodnot?m. 
-
-<a name="detail"></a><h2>Detailn? metadata projektu</h2>
-
-  Dialog zobrazuj?c? detailn? informaci o metadatech projektu. Pro otev?en? tohoto dialogu je nutn? 
-  ozna?it po?adovan? projekt. Dialog je t?m?? toto?n? s edit dialogem. V?echny polo?ky jsou needitovateln?, maj? jen 
-  informa?n? charakter.
-  
-<a name="drop"></a><h2>Smaz?n? metadat projektu</h2>
-
-  Pro smaz?n? metadat p??slu?n?ho projektu se pou?ije tla??tko <i><b>Sma? metadata</b></i> ve spr?vci metadat. P?ed stisknut?m tohoto tla??tka je nutn?
-  ozna?i po?adovan? metadata. Po stisku tohoto tla??tka bude u?ivatel informov?n o operaci, kterou se chyst? prov?st. Potvrzen?m
-  t?to operace budou metadata smaz?ny.   
-  <br><br>
-  <img src="picture/metadataDelete_cs.png">
-  <br><br>
-  Obnoven? smazan?ch metadat m??e administr?tor prost?ednicv?m dialogu pro sledov?n? <a href="./history.html#historyData">celkov? historie</a> 
-  n?lezov?ch dat.       
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - Spr?va metadat</title>
+</head>
+<body>
+<h1>Spr?va metadat</h1>
+<img src="picture/metadataEnter_cs.png">
+<br><br>
+
+Spr?vce metadat umo??uje administr?torovi p?id?vat, editovat a mazat metadata jednotliv?ch projekt?.  
+Spr?vce metadat otev?ete z menu <b>Data/Spr?va metadat</b> nebo kl?vesovou zkratkou CTRL + M.
+
+<h5>Dialog spr?vce metadat</h5>
+
+<img src="picture/metadataDialog_cs.png">
+<br><br>
+Dialog pro spr?vu metadat je rozd?len do dvou ??st?:
+<ul>
+  <li><b>Seznam metadat projekt?</b> - zobrazen? seznamu metadat existuj?c?ch projekt? podle kriteri? zadan?ch pro vyhled?v?n? a set??zen? 
+  <li><b>Vyhled?v?n?</b> - zad?n? po?adavk? pro vyhled?v?n? a set??zen? metadat
+</ul>
+
+<h2>Seznam metadat</h2>
+
+Po ?sp??n?m vyhled?v?n? je v t?to ??sti zobrazen seznam vyhledan?ch metadat projekt?. Po?et projekt? zobrazen?ch v tabulce si m??ete sami nastavit p?eps?n?m 
+hodnoty pro <b><i>Zobrazit ??dk?</i></b> a potvrzen?m nov? hodnoty kl?vesov?m tla??tkem ENTER. V tabulce se p?ep?n?te na dal?? nebo p?edchoz? 
+seznam u?ivatel? pomoc? tla??tek <b><i>P?edchoz?</i></b> a <b><i>N?sleduj?c?</i></b>. Informace o aktu?ln? zobrazen?m seznamu metadat projekt? jsou uvedeny v ??sti 
+pod tabulkou. 
+<br>
+Pro pr?ci se z?znamem jsou zde k dispozici tla??tka:
+<ul>    
+   <li><i><b>P?idej metadata</i></b> - <a href=#add>p?id?n? metadat projektu</a></li>
+   <li><i><b>Edituj metadata</i></b> - <a href=#edit>editace metadat projektu</a></li>
+   <li><i><b>Detail metadat</i></b> - <a href=#detail>detailn? metadata projektu</a></li>
+   <li><i><b>Sma? metadata</i></b> - <a href=#drop>smaz?n? metadat projektu</a></li> 
+</ul>   
+  
+<h2>Vyhled?v?n?</h2>
+
+Spr?vce metadat n?b?z? administr?torovi mo?nost vyhled?vat podle t?? parametr?: instituce, n?zev projektu a zdroj dat. V?sledek m??e b?t set??zen 
+podle n?zvu instituce, n?zvu projektu, zdroji dat, jm?no osoby pro technickou podporu, jm?no osoby pro obsahovou podporu, datumu vytvo?en? projektu a 
+datumu posledn? modifikace projektu. Pokud nejsou zad?ny, ?adn? parametry a omezen? budou vyhled?ny v?echny metadata projekt?. 
+<br><br>
+<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli??v?na velk? a mal? p?smena (case insensitive).
+
+<a name="add"></a><h2>P?id?n? metadat projektu</h2>
+  
+  <h5>Dialog pro p?id?n? metadat</h5>
+  
+  <img src="picture/metadataAdd_cs.png">
+  <br><br>
+  Dialog pro p?id?n? nov?ho projektu m??ete otev??t ze Spr?vce metadat. V zobrazen?m okn? jsou k vypln?n? n?sleduj?c? polo?ky:
+  <ul>
+    <li><b>Instituce</b> - jednozna?n? identifik?tor instituce, kter? je vlastn?kem origin?ln?ho datov?ho zdroje.
+    Tato polo?ka je povinn? a bez jej?ho vypln?n? v?m aplikace nedovol? metadata p?idat.</li>
+    <li><b>Organizace</b> - zkratka organizace.</li>
+    <li><b>Technick? podpora</b> - jm?no osoby, kter? se star? o technickou ??st projektu. Tato polo?ka je povinn?.</li>
+    <li><b>Technick? podpora - email</b> - kontaktn? email na osobu, kter? se star? o technickou ??st projektu.</li>
+    <li><b>Technick? podpora - adresa</b> - kontaktn? adresa na osobu,  kter? se star? o technickou ??st projektu.</li>
+    <li><b>Obsahov? podpora</b> - jm?no osoby, kter? m? na starosti obsahovou ??st projektu. Tato polo?ka je povinn?.</li>
+    <li><b>Obsahov? podpora - email</b> - kontaktn? email na osobu, kter? m? na starosti obsahovou projektu.</li>
+    <li><b>Obsahov? podpora - adresa</b> - kontaktn? adresa na osobu, kter? m? na starosti obsahovou ??st projektu.</li>
+    <li><b>N?zev projektu</b> - kr?tk? n?zev projektu. N?zev projektu je povinn? polo?ka a mus? b?t v r?mci datab?ze jednozna?n?.</li>
+    <li><b>Detail k projektu</b> - podrobn?j?? popis projektu.</li>
+    <li><b>Zdroj</b> - jm?no nebo k?d datov?ho zdroje. Tato polo?ka je povinn?.</li>
+    <li><b>Basis</b> -  informace o tom, co dan? z?znamy popisuj? (preservedSpecimen, ...).</li>
+    <li><b>Pozn?mka</b> - pozn?mka k projektu.</li>
+    <li><b>Datum vytvo?en? projektu</b> - datum a ?as, kdy byl projekt vytvo?en. Tato polo?ka je povinn?.</li>
+    <li><b>Datum posledn? modifikace projektu</b> - datum a ?as, kdy v projektu byly z?znamy naposled modifikov?ny, vlo?eny nebo smaz?ny.</li>        
+ </ul>
+ 
+<a name="edit"></a><h2>Editace u?ivatele</h2>
+  Dialog pro editaci metadat existuj?c?ho projektu otev?ete ze Spr?vce metadat. Nezapome?te, ?e pro otev?en? dialogu mus?te m?t ozna?en? projekt, 
+  k jeho? matadata se chyst?te editovat. Vzhled edit dialogu je t?m?? toto?n? s add dialogem. Povinn? polo?ky jsou: Instituce, jm?no osoby pro Technickou podporu, 
+  jm?no osoby pro Obsahovou podporu, N?zev projektu a Zdroj dat. <br>
+  Needitovatelen? polo?ky jsou: 
+  
+  <ul>    
+    <li><b>Datum vytvo?en? projektu</b> - datum a ?as informuj?c? o vytvo?en? u?ivatele. Needitovateln? polo?ka. </li>
+    <li><b>Datum posledn? modifikace projektu</b> - datum a ?as informuj?c? o zru?en? p??stupu u?ivatele do aplikace. Needitovateln? polo?ka.</li>
+  </ul>
+
+  Informace o zm?n?ch proveden?ch v jednoliv?ch metadatech m??e administr?tor dohledat v dialogu <a href="./history.html#historyData">celkov? historie</a>,
+  kde m??e vyu??t i mo?nosti n?vratu k d??v?j??m hodnot?m. 
+
+<a name="detail"></a><h2>Detailn? metadata projektu</h2>
+
+  Dialog zobrazuj?c? detailn? informaci o metadatech projektu. Pro otev?en? tohoto dialogu je nutn? 
+  ozna?it po?adovan? projekt. Dialog je t?m?? toto?n? s edit dialogem. V?echny polo?ky jsou needitovateln?, maj? jen 
+  informa?n? charakter.
+  
+<a name="drop"></a><h2>Smaz?n? metadat projektu</h2>
+
+  Pro smaz?n? metadat p??slu?n?ho projektu se pou?ije tla??tko <i><b>Sma? metadata</b></i> ve spr?vci metadat. P?ed stisknut?m tohoto tla??tka je nutn?
+  ozna?i po?adovan? metadata. Po stisku tohoto tla??tka bude u?ivatel informov?n o operaci, kterou se chyst? prov?st. Potvrzen?m
+  t?to operace budou metadata smaz?ny.   
+  <br><br>
+  <img src="picture/metadataDelete_cs.png">
+  <br><br>
+  Obnoven? smazan?ch metadat m??e administr?tor prost?ednicv?m dialogu pro sledov?n? <a href="./history.html#historyData">celkov? historie</a> 
+  n?lezov?ch dat.
+  </body>
+</html>



From lada at mail.berlios.de  Sun Sep  3 03:19:06 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sun, 3 Sep 2006 03:19:06 +0200
Subject: [Plantlore-dev] r641 - in trunk: analysis/database
	src/net/sf/plantlore/client/history
	src/net/sf/plantlore/client/metadata
	src/net/sf/plantlore/client/user src/net/sf/plantlore/common/record
	src/net/sf/plantlore/config/hibernate src/net/sf/plantlore/server
Message-ID: <200609030119.k831J6ZF024317@sheep.berlios.de>

Author: lada
Date: 2006-09-03 03:18:42 +0200 (Sun, 03 Sep 2006)
New Revision: 641

Modified:
   trunk/analysis/database/DBModel_postgres.sql
   trunk/analysis/database/DBmodel.sql
   trunk/analysis/database/DBmodel_MySQL.sql
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
   trunk/src/net/sf/plantlore/common/record/Occurrence.java
   trunk/src/net/sf/plantlore/config/hibernate/Occurrences.hbm.xml
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Prefix of user account is name of database now. You have to download actual database and create new account in database (I am writing mail about it).

Some changes in table tOccurrences 
- cUnitIdDB is varchar(40) now
- cUnitValue is integer now

History, User manager and metadata manager:
Fix bug in whole history - close details of record is working now.
Use function database.getNumRows is better.

Modified: trunk/analysis/database/DBModel_postgres.sql
===================================================================
--- trunk/analysis/database/DBModel_postgres.sql	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/analysis/database/DBModel_postgres.sql	2006-09-03 01:18:42 UTC (rev 641)
@@ -117,8 +117,8 @@
 /* Table: TOCCURRENCES */
 CREATE TABLE TOCCURRENCES (
     CID                SERIAL NOT NULL,
-    CUNITIDDB          VARCHAR(30) NOT NULL,
-    CUNITVALUE         VARCHAR(30) NOT NULL,
+    CUNITIDDB          VARCHAR(40) NOT NULL,
+    CUNITVALUE         INTEGER NOT NULL,
     CHABITATID         INTEGER NOT NULL,
     CPLANTID           INTEGER NOT NULL,
     CYEARCOLLECTED     SMALLINT DEFAULT 0 NOT NULL,
@@ -334,19 +334,19 @@
 CREATE OR REPLACE VIEW vauthorscollected
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'collected' AND ao.cdelete = 0
+WHERE ao.crole = 'collected' AND ao.cdelete = 0;
 
 /* View: VAUTHORSREVISED */
 CREATE OR REPLACE VIEW vauthorsrevised
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'revised' AND ao.cdelete = 0
+WHERE ao.crole = 'revised' AND ao.cdelete = 0;
 
 /* View: VAUTHORSIDENTIFIED */
 CREATE OR REPLACE VIEW vauthorsidentified
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'identified' AND ao.cdelete = 0
+WHERE ao.crole = 'identified' AND ao.cdelete = 0;
 
 INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (1, 'AUTHOROCCURRENCE', NULL);
 INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (2, 'OCCURRENCE', NULL);

Modified: trunk/analysis/database/DBmodel.sql
===================================================================
--- trunk/analysis/database/DBmodel.sql	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/analysis/database/DBmodel.sql	2006-09-03 01:18:42 UTC (rev 641)
@@ -125,8 +125,8 @@
 /* Table: TOCCURRENCES*/
 CREATE TABLE TOCCURRENCES (
     CID                INTEGER NOT NULL,
-    CUNITIDDB          VARCHAR(30) NOT NULL,
-    CUNITVALUE         VARCHAR(30) NOT NULL,
+    CUNITIDDB          VARCHAR(40) NOT NULL,
+    CUNITVALUE         INTEGER NOT NULL,
     CHABITATID         INTEGER NOT NULL,
     CPLANTID           INTEGER NOT NULL,
     CYEARCOLLECTED     SMALLINT DEFAULT 0 NOT NULL,
@@ -337,19 +337,19 @@
 CREATE OR REPLACE VIEW vauthorscollected
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'collected' AND ao.cdelete = 0
+WHERE ao.crole = 'collected' AND ao.cdelete = 0;
 
 /* View: VAUTHORSREVISED */
 CREATE OR REPLACE VIEW vauthorsrevised
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'revised' AND ao.cdelete = 0
+WHERE ao.crole = 'revised' AND ao.cdelete = 0;
 
 /* View: VAUTHORSIDENTIFIED */
 CREATE OR REPLACE VIEW vauthorsidentified
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'identified' AND ao.cdelete = 0
+WHERE ao.crole = 'identified' AND ao.cdelete = 0;
 
 
 INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (1, 'AUTHOROCCURRENCE', NULL);

Modified: trunk/analysis/database/DBmodel_MySQL.sql
===================================================================
--- trunk/analysis/database/DBmodel_MySQL.sql	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/analysis/database/DBmodel_MySQL.sql	2006-09-03 01:18:42 UTC (rev 641)
@@ -142,8 +142,8 @@
 
 CREATE TABLE TOCCURRENCES (
     CID                INTEGER NOT NULL auto_increment,
-    CUNITIDDB          VARCHAR(30) CHARACTER SET UTF8 NOT NULL,
-    CUNITVALUE         VARCHAR(30) CHARACTER SET UTF8 NOT NULL,
+    CUNITIDDB          VARCHAR(40) CHARACTER SET UTF8 NOT NULL,
+    CUNITVALUE         INTEGER NOT NULL,
     CHABITATID         INTEGER NOT NULL,
     CPLANTID           INTEGER NOT NULL,
     CYEARCOLLECTED     SMALLINT DEFAULT 0 NOT NULL,
@@ -358,16 +358,16 @@
 CREATE OR REPLACE VIEW vauthorscollected
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'collected' AND ao.cdelete = 0
+WHERE ao.crole = 'collected' AND ao.cdelete = 0;
 
 /* View: VAUTHORSREVISED */
 CREATE OR REPLACE VIEW vauthorsrevised
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'revised' AND ao.cdelete = 0
+WHERE ao.crole = 'revised' AND ao.cdelete = 0;
 
 /* View: VAUTHORSIDENTIFIED */
 CREATE OR REPLACE VIEW vauthorsidentified
 AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl
 FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid
-WHERE ao.crole = 'identified' AND ao.cdelete = 0
+WHERE ao.crole = 'identified' AND ao.cdelete = 0;

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -31,7 +31,7 @@
     public DetailsHistoryView(javax.swing.JDialog parent, boolean modal) {
         super(parent, modal);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);        
-        initComponents(); 
+        initComponents();                
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);        
@@ -49,14 +49,7 @@
     public void setDetailsMessage(String detailsMessage) {
         this.detailsTextArea.setText(detailsMessage);
     }
-    
-    /**
-     * Close this dialog.    
-     */
-    public void close() {
-        dispose();
-    }
-    
+       
     /** This method is called from within the constructor to
      * initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -73,6 +73,8 @@
     private String displayRow;              
     /** Result of the search query */
     private int resultId = 0;
+    /** Number of results for the current SelectQuery */
+    private int resultRows = 0;
     /** List of data (results of a search query) displayed in the view dialog */
     private ArrayList<HistoryRecord> historyDataList = new ArrayList<HistoryRecord>();     
     /** List of editing object */
@@ -262,7 +264,7 @@
         	   throw dbex; 		            
      	   }   
      	   if (isError()) {    
-          Exception ex = getException(); 		  
+                  Exception ex = getException(); 		  
      		  setError(null);
      		  setException(null);
      		  throw ex;
@@ -356,8 +358,15 @@
      */
     public void processResult(int from, int count) throws Exception{
         
-        if (this.resultId != 0) {
-            int currentRow = getResultRows();
+         int currentRow = 0;
+    	 if (this.resultId != 0) {  
+            try { 
+               currentRow = database.getNumRows(resultId);
+               setResultRows(currentRow);
+            } catch (Exception ex){
+                logger.error("Get number of results failed. Exception caught in History. Details: "+ex.getMessage());  
+                throw ex;
+            }
             logger.debug("Rows in the result: "+currentRow);
             logger.debug("Max available rows: "+(from+count-1));            
            
@@ -1428,13 +1437,15 @@
         } catch(Exception ex) {
         	logger.error("Search authors failed. DBLayer exception caught in History. Details: "+ex.getMessage());       	                                                   
                 setError(ERROR_SEARCH_AUTHOR);
-                setException(ex);       	    
+                setException(ex);  
+                return null;
         }  
           
         if (objects == null) {
         	logger.error("tAuthors doesn't contain required data");  
- 		    setError(ERROR_SEARCH_AUTHOR);
-                    setException(new DBLayerException(ERROR_SEARCH_AUTHOR));
+                setError(ERROR_SEARCH_AUTHOR);
+                setException(new DBLayerException(ERROR_SEARCH_AUTHOR));
+                return null;
         }
         
        return objects;
@@ -1448,6 +1459,7 @@
     public String getAllNameOfAuthors(Object[] objects) {
         if (objects == null || isError()) {
         	setError(null);
+                setException(null);
         	return "";	
         }            
         String allAuthor = "";
@@ -2226,20 +2238,21 @@
         return this.resultId;
     }
     
-    /**
-     * Get the number of results for the current SelectQuery
+     /**
+     * Get the number of results for the current SelectQuery. 
      * @return number of results for the current SelectQuery
      */
     public int getResultRows() {
-        int resultCount = 0;
-        if (resultId != 0) try {
-             resultCount = database.getNumRows(resultId);        	
-        } catch(RemoteException e) {
-        	logger.error("Get number of results failed.Remote exception caught in History. Details: "+e.getMessage());  
-        	setError(ERROR_NUMBER_ROWS);
-        }
-        return resultCount;
+       return this.resultRows;
     }
+    
+    /**
+     * Set the number of results for the current SelectQuery. 
+     * @param resultCount number of results for the current SelectQuery
+     */
+    public void setResultRows(int resultCount) {
+        this.resultRows = resultCount;
+    }
         
      /**
      *  Get index of the first row currently displayed in the list of record changes. This is an index in the results returned by a search query.

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -293,7 +293,7 @@
                detailsView.setDetailsMessage(detailsMessage);
                detailsView.setVisible(true);               
            } 
-           if (!model.isError()) {
+           if (model.isError()) {
 	           Exception ex = model.getException();
                    ex.printStackTrace();
                    DefaultExceptionHandler.handle(view, ex);  

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -157,6 +157,7 @@
                           logger.error("Searching metada failed. Exception caught in Metadata. Details: "+e.getMessage());
                            setError(ERROR_SEARCH);
                            setException(e);
+                           return null;
                     }
                     return null;
     	}
@@ -243,16 +244,16 @@
      */
     public void processResult(int from, int count) throws Exception{
         
-    	if (this.resultId != 0) {    		
-             int currentRow = getResultCount();
-            setResultRows(currentRow);
-            if (isError()) {
-                Exception ex = getException();
-                setError(null);
-                setException(null);
+        int currentRow = 0;
+    	if (this.resultId != 0) {  
+            try { 
+               currentRow = database.getNumRows(resultId);
+               setResultRows(currentRow);
+            } catch (Exception ex){
+                logger.debug("Catch Exception in History. GetNumRows called in function processResult failed. Details: "+ex.getMessage());
                 throw ex;
             }
-            logger.debug("Rows in the result: "+currentRow);
+            logger.debug("Rows in the result: "+ currentRow);
             logger.debug("Max available rows: "+(from+count-1));            
            
             // Find out how many rows we can retrieve - it cannot be more than number of rows in the result
@@ -563,28 +564,13 @@
     }
     
     /**
-     * Set the number of results for the current SelectQuery.     
+     * Set the number of results for the current SelectQuery. 
+     * @param resultCount number of results for the current SelectQuery
      */
     public void setResultRows(int resultCount) {
         this.resultRows = resultCount;
     }
     
-  
-    /**
-     * Get the number of results for the current SelectQuery
-     * @return number of results for the current SelectQuery
-     */
-    public int getResultCount() {
-        int resultCount = 0;
-        if (resultId != 0) try {
-                resultCount = database.getNumRows(resultId);        	
-        } catch(Exception e) {
-        	logger.error("Get number of results failed. Exception caught in MetadataManager. Details: "+e.getMessage());  
-        	setError(ERROR_NUMBER_ROWS);
-                setException(e);
-        }
-        return resultCount;
-    }
 
     /**
 	  * Get results of a search query for dislpaying in metadata dialog

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -192,7 +192,8 @@
                     } catch (Exception e) {
                             logger.error("Searching user failed. Exception caught in User. Details: "+e.getMessage());
                             setError(ERROR_SEARCH);
-                            setException(e);               
+                            setException(e);       
+                            return null;
                     }
                     return null;
     	}
@@ -272,15 +273,16 @@
      */
     public void processResult(int from, int count) throws Exception {
         
-        if (this.resultId != 0) {
-            int currentRow = getResultCount();
-            setResultRows(currentRow);
-            if (isError()) {
-                Exception ex = getException();
-                setError(null);
-                setException(null);
+         int currentRow = 0;
+    	if (this.resultId != 0) {  
+            try { 
+               currentRow = database.getNumRows(resultId);
+               setResultRows(currentRow);
+            } catch (Exception ex){
+                logger.error("Get number of results failed. Exception caught in UserManager. Details: "+ex.getMessage());  
                 throw ex;
             }
+                        
             logger.debug("Rows in the result: "+currentRow);
             logger.debug("Max available rows: "+(from+count-1));
            
@@ -720,23 +722,7 @@
      */
     public void setResultRows(int resultCount) {
         this.resultRows = resultCount;
-    }
-    
-    /**
-     * Get the number of results for the current SelectQuery
-     * @return number of results for the current SelectQuery
-     */
-    public int getResultCount() {
-        int resultCount = 0;
-        if (resultId != 0) try {
-                resultCount = database.getNumRows(resultId);        	
-        } catch(RemoteException e) {
-                logger.error("Get number of results failed.Remote exception caught in UserManager. Details: "+e.getMessage());  
-            	setError(ERROR_REMOTE_EXCEPTION);
-                setException(e);
-        }
-        return resultCount;
-    }
+    }   
 
     /**
 	  * Get results of a search query for dislpaying in userManager dialog

Modified: trunk/src/net/sf/plantlore/common/record/Occurrence.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -31,7 +31,7 @@
     /** Parameters of the occurrence. For detailed explanation see data model documentation. */
     private Integer id;
     private String unitIdDb;
-    private String unitValue;
+    private Integer unitValue;
     private Habitat habitat;
     private Plant plant;
     private Integer yearCollected;
@@ -130,7 +130,7 @@
 				setId((Integer)value);
 		}
 		else if(column.equalsIgnoreCase(UNITIDDB)) setUnitIdDb((String)value);
-		else if(column.equalsIgnoreCase(UNITVALUE)) setUnitValue((String)value);
+		else if(column.equalsIgnoreCase(UNITVALUE)) setUnitValue((Integer)value);
 		else if(column.equalsIgnoreCase(HABITAT)) setHabitat((Habitat)value);
 		else if(column.equalsIgnoreCase(PLANT)) setPlant((Plant)value);
 		else if(column.equalsIgnoreCase(YEARCOLLECTED)) {
@@ -234,7 +234,7 @@
      *   @return unique record value
      *   @see setUnitValue
      */
-    public String getUnitValue() {
+    public Integer getUnitValue() {
         //obligatory
         return this.unitValue;
     }
@@ -244,7 +244,7 @@
      *   @param unitValue unique record value
      *   @see getUnitValue
      */
-    public void setUnitValue(String unitValue) {
+    public void setUnitValue(Integer unitValue) {
         this.unitValue = unitValue;
     }
 

Modified: trunk/src/net/sf/plantlore/config/hibernate/Occurrences.hbm.xml
===================================================================
--- trunk/src/net/sf/plantlore/config/hibernate/Occurrences.hbm.xml	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/config/hibernate/Occurrences.hbm.xml	2006-09-03 01:18:42 UTC (rev 641)
@@ -10,15 +10,14 @@
       </id>
       <version name="version" column="CVERSION"/>
       <property column="CUNITIDDB"
-                length="30"
+                length="40"
                 name="unitIdDb"
                 not-null="true"
                 type="java.lang.String"/>
-      <property column="CUNITVALUE"
-                length="30"
+      <property column="CUNITVALUE"                
                 name="unitValue"
                 not-null="true"
-                type="java.lang.String"/>
+                type="java.lang.Integer"/>
       <many-to-one name="habitat" 
                    class="net.sf.plantlore.common.record.Habitat" 
                    column="CHABITATID"

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-03 00:10:41 UTC (rev 640)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-03 01:18:42 UTC (rev 641)
@@ -98,6 +98,8 @@
     private Right rights;    
     /** Unique identifier of the database we are connected to */
     private String databaseID;
+     /** Plantlore prefix of user name */
+    private String userPrefix = "plantlore_";
     
     private Session txSession;
     private Transaction longTx;            
@@ -108,10 +110,7 @@
     private static final int DELETE = 3;
     
     private DatabaseSettings settings;
-    private String currentlyConnectedUser = "";
-    
-    /** Plantlore prefix of user name */
-    private static final String USER_PREFIX = "plantlore_";
+    private String currentlyConnectedUser = "";         
         
     public HibernateDBLayer(DatabaseSettings settings) {
     	this(null, settings);
@@ -128,6 +127,7 @@
         logger.debug("Constructing a new HibernateDBLayer.");
         
         this.settings = settings;
+           
         
         // Initialize pool of result sets, initial capacity = INITIAL POOL SIZE
         results = new Hashtable<Integer, ScrollableResults>(INITIAL_POOL_SIZE); 
@@ -174,7 +174,8 @@
     public User initialize(String dbID, String user, String password) 
     throws DBLayerException, RemoteException {
         Configuration cfg;
-        currentlyConnectedUser = user;
+        currentlyConnectedUser = user;        
+        userPrefix = dbID.toLowerCase() + "_";
         
         // Load Hibernate configuration
         try {
@@ -190,13 +191,13 @@
         	cfg.setProperty("hibernate.connection.url", settings.getConnectionStringPrefix() + dbID 
         			+ "?" + settings.getConnectionStringSuffix());
         // Set username and password to access database
-        cfg.setProperty("hibernate.connection.username", HibernateDBLayer.USER_PREFIX + user);
+        cfg.setProperty("hibernate.connection.username", this.userPrefix + user);
         cfg.setProperty("hibernate.connection.password", password);
         
         // Build session factory & create a new session.
         Session sess = null;
         // Authenticate user
-        logger.debug("DBLayer Initialization - about to authenticate the user.");
+        logger.debug("DBLayer Initialization - about to authenticate the user. user" + this.userPrefix + user);
         try {
         	logger.debug("DBLayer Initialization - building session factory.");
         	sessionFactory = cfg.buildSessionFactory();
@@ -226,7 +227,7 @@
             	throw new DBLayerException(L10n.getString("Error.ConnectionFailed"), DBLayerException.ERROR_CONNECT);
             }
             Object[] unitiddatabase = sr.get();
-            this.databaseID = ((UnitIdDatabase)unitiddatabase[0]).getUnitIdDb();
+            this.databaseID = ((UnitIdDatabase)unitiddatabase[0]).getUnitIdDb();            
             logger.debug("DBLayer Initialization - finished!");
         } 
         catch (JDBCException e) {
@@ -273,7 +274,8 @@
             occ.setCreatedWho(this.plantloreUser);
             // Set UniqueID for the record and database
             occ.setUnitIdDb(this.databaseID);
-            occ.setUnitValue("TODO");
+            //TODO zjiskat unikatni identifikator zaznamu !!!
+            occ.setUnitValue(1);
         } else if(record instanceof Habitat) {
             ((Habitat)record).setCreatedWho(this.plantloreUser);
         } else if(record instanceof Publication) {
@@ -2089,9 +2091,9 @@
         }        
         try {
             Connection conn = txSession.connection();                    
-            PreparedStatement pstmt = conn.prepareStatement("CREATE USER " +HibernateDBLayer.USER_PREFIX + name+ " WITH PASSWORD '" +password+ "' "+admin);            
+            PreparedStatement pstmt = conn.prepareStatement("CREATE USER " + this.userPrefix + name+ " WITH PASSWORD '" +password+ "' "+admin);            
             pstmt.execute();
-            PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " +HibernateDBLayer.USER_PREFIX + name);   
+            PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " + this.userPrefix + name);   
             pstmtGrant.execute();
         } catch (HibernateException e) {
             logger.warn("Unable to retrieve JDBC connection from the Hibernate session. Details: "+e.getMessage());
@@ -2155,20 +2157,20 @@
             // In case password has changed, execute statement to change the password
             // In case admin right has changed, execute statement to change the access permission
             if ((password != null) && (!password.equals(""))) {                                    
-                PreparedStatement pstmt = conn.prepareStatement("ALTER USER " +HibernateDBLayer.USER_PREFIX +name+ " WITH PASSWORD '" +password+ "' " +admin);                
+                PreparedStatement pstmt = conn.prepareStatement("ALTER USER " + this.userPrefix +name+ " WITH PASSWORD '" +password+ "' " +admin);                
                 pstmt.execute();
                 if (changeRight) {
-                    PreparedStatement pstmtRevoke = conn.prepareStatement("REVOKE "+roleOld+" FROM "+HibernateDBLayer.USER_PREFIX +name);                
+                    PreparedStatement pstmtRevoke = conn.prepareStatement("REVOKE "+roleOld+" FROM "+ this.userPrefix +name);                
                     pstmtRevoke.execute();
-                    PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " +HibernateDBLayer.USER_PREFIX + name);   
+                    PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " + this.userPrefix + name);   
                     pstmtGrant.execute();
                 }
             } else {                
-                PreparedStatement pstmt = conn.prepareStatement("ALTER USER " +HibernateDBLayer.USER_PREFIX +name+ " " +admin);                
+                PreparedStatement pstmt = conn.prepareStatement("ALTER USER " + this.userPrefix +name+ " " +admin);                
                 pstmt.execute();  
-                PreparedStatement pstmtRevoke = conn.prepareStatement("REVOKE "+roleOld+" FROM "+HibernateDBLayer.USER_PREFIX +name);                
+                PreparedStatement pstmtRevoke = conn.prepareStatement("REVOKE "+roleOld+" FROM "+ this.userPrefix +name);                
                 pstmtRevoke.execute();
-                PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " +HibernateDBLayer.USER_PREFIX + name);   
+                PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " + this.userPrefix + name);   
                 pstmtGrant.execute();
             }            
         } catch (HibernateException e) {
@@ -2212,7 +2214,7 @@
         }
         try {
             Connection conn = txSession.connection();        
-            PreparedStatement pstmt = conn.prepareStatement("DROP USER " +HibernateDBLayer.USER_PREFIX + name);            
+            PreparedStatement pstmt = conn.prepareStatement("DROP USER " + this.userPrefix + name);            
             pstmt.execute();
         } catch (HibernateException e) {
             logger.warn("Unable to retrieve JDBC connection from the Hibernate session. Details: "+e.getMessage());



From ladaOb at seznam.cz  Sun Sep  3 03:39:50 2006
From: ladaOb at seznam.cz (=?iso-8859-2?Q?Lada_Oberreiterov=E1?=)
Date: Sun, 3 Sep 2006 03:39:50 +0200
Subject: [Plantlore-dev] Zmeny v databazi - co je potreba udelat
Message-ID: <004701c6cef9$dd877b20$913ca20a@Jose>

Ahojte,

doslo k nasledujizim zmenam:
  a.. v databazi v tabulce tOccurrences byli zmeneny polozky cUnitIdDb (zmenena velikost na varchar(40)) a cUnitValue (zmnenen typ na integer)
  b.. pri vytvareni uzicatele se jako prefix pouzije jmeno aktualni databaze
co musite udelat:
  a.. musite si stahnout aktualni databazi z urtaxu 
    a.. postup jak ji zprovoznit jsem jiz nekolikrat psala
  b.. pro nove vytvorenou databazi budete muset pustit sql skript a priradit prava prace s databazi jednotlivym rolim          
    a.. GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON tauthors TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON tauthorsoccurrences TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THABITATS TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORY TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCHANGE TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCOLUMN TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TMETADATA TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TOCCURRENCES TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPHYTOCHORIA TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPLANTS TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TTERRITORIES TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TUSER TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TRIGHT TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TVILLAGES TO Plantlore_Role_Admin;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPUBLICATIONS TO Plantlore_Role_Admin; 
    b.. GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TAUTHORS TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TAUTHORSOCCURRENCES TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THABITATS TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORY TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCHANGE TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TMETADATA TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TOCCURRENCES TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPHYTOCHORIA TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPLANTS TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TTERRITORIES TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TVILLAGES TO Plantlore_Role_User;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPUBLICATIONS TO Plantlore_Role_User;
    GRANT SELECT, REFERENCES ON THISTORYCOLUMN TO Plantlore_Role_User;
    GRANT SELECT, REFERENCES ON TUSER TO Plantlore_Role_User;
    GRANT SELECT, REFERENCES ON TRIGHT TO Plantlore_Role_User;
    c.. GRANT SELECT ON vhabitats TO Plantlore_Role_www;
    GRANT SELECT ON vmetadata TO Plantlore_Role_www;
    GRANT SELECT ON voccurrences TO Plantlore_Role_www;
    GRANT SELECT ON tphytochoria TO Plantlore_Role_www;
    GRANT SELECT ON tplants TO Plantlore_Role_www;
    GRANT SELECT ON tterritories TO Plantlore_Role_www;
    GRANT SELECT ON tuser TO Plantlore_Role_www;
    GRANT SELECT ON tvillages TO Plantlore_Role_www;
    GRANT SELECT ON vpublications TO Plantlore_Role_www;
    GRANT SELECT ON vauthorscollected TO Plantlore_Role_www;
    GRANT SELECT ON vauthorsrevised TO Plantlore_Role_www;
    GRANT SELECT ON vauthorsidentified TO Plantlore_Role_www;
  c.. budete si muset vytvorit noveho uzivatele,ktery bude mit stejny prefix jako databaze, s kterou pracujete 
    a.. 1.zpusob:
      a.. CREATE USER JmenoDatabase_Admin PASSWORD 'plantlore' ;
      GRANT Plantlore_Role_Admin TO JmenoDatabase_Admin;           
    b.. 2.  zpusob:
      a.. kliknout prvym mysitkem na uzivatele Plantlore_Admin a v properties ho prejmenovat
  d.. zkontrolujte si pro jistotu, ze mate v tabulce tUser uzivatele, pres ktereho se budete prihlasovat
  e.. zkontrolujte si pro jistotu, ze mate v tabulce tUnitIdDatabase vyplnenou nejaku hodnotu (mela by tam byt)
Lada
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060903/aff93841/attachment.html>

From kovo at mail.berlios.de  Sun Sep  3 08:24:29 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sun, 3 Sep 2006 08:24:29 +0200
Subject: [Plantlore-dev] r642 - in trunk/installer: . postgresql
Message-ID: <200609030624.k836OTPU020272@sheep.berlios.de>

Author: kovo
Date: 2006-09-03 08:24:27 +0200 (Sun, 03 Sep 2006)
New Revision: 642

Added:
   trunk/installer/postgresql/
   trunk/installer/postgresql/postgres_install.bat
   trunk/installer/postgresql/postgresql-int.msi
   trunk/installer/postgresql/readme.txt
   trunk/installer/userInputLang.xml_cze
   trunk/installer/userInputLang.xml_eng
   trunk/installer/userInputSpec.xml
Modified:
   trunk/installer/install.xml
Log:
Installer modified to support PostgreSQL installation on Windows. Some minor modifications still required (including my favourite encoding issues).

IMPORTANT: postgresql-int.msi is just a dummy file because we don't want Postgre installer in our repository. Substitute this file with real installer (further info in readme.txt)

Modified: trunk/installer/install.xml
===================================================================
--- trunk/installer/install.xml	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/install.xml	2006-09-03 06:24:27 UTC (rev 642)
@@ -1 +1 @@
-<?xml version="1.0" encoding="iso-8859-1" standalone="yes" ?><installation version="1.0">    <info>        <appname>Plantlore</appname>        <appversion>1.0</appversion>        <authors>            <author name="Lada Oberreiterova" email="lada at mail@berlios.de"/>            <author name="Erik Kratochvil" email="krater at mail.berlios.de"/>	    <author name="Tomas Kovarik" email="kovo at mail.berlios.de"/>	    <author name="Jakub Kotowski" email="fraktalek at mail.berlios.de"/>        </authors>        <url>http://plantlore.berlios.de</url>                <uninstaller write="yes"/>    </info>        <guiprefs width="640" height="480" resizable="no"/>        <locale>        <langpack iso3="cze"/>        <langpack iso3="eng"/>    </locale>        <resources>        <res id="LicencePanel.licence" src="resources/gpl.txt"/>        <res id="InfoPanel.info" src="installer/readme.txt"/>    </resources>        <panels>        <panel classname="Hell!
 oPanel"/>        <panel classname="InfoPanel"/>        <panel classname="LicencePanel"/>        <panel classname="TargetPanel"/>         <panel classname="PacksPanel"/>        <panel classname="InstallPanel"/>        <panel classname="FinishPanel"/>    </panels>        <packs>                <pack name="Core" required="yes">            <description>Files that Plantlore needs always</description>            <file src="dist/lib" targetdir="$INSTALL_PATH"/>        </pack>        	<pack name="Client" required="no">            <description>Plantlore Java Client</description>            <file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"/>        </pack>	<pack name="Server" required="no" preselected="no">            <description>Plantlore Server</description>            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>	</pack>		<pack name="PostgreSQL" requi!
 red="no">		<description>The PostgreSQL database machine</desc!
 ription>
	</pack>	        <pack name="Docs" required="no">            <description>The documentation</description>            <file src="documentation" targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->        </pack>        <pack name="Sources" required="no" preselected="no">            <description>The sources</description>            <file src="src" targetdir="$INSTALL_PATH"/>        </pack>    </packs>    </installation>
\ No newline at end of file
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?><installation version="1.0">    <info>        <appname>Plantlore</appname>        <appversion>1.0</appversion>        <authors>            <author name="Lada Oberreiterova" email="lada at mail@berlios.de"/>            <author name="Erik Kratochvil" email="krater at mail.berlios.de"/>	    <author name="Tomas Kovarik" email="kovo at mail.berlios.de"/>	    <author name="Jakub Kotowski" email="fraktalek at mail.berlios.de"/>        </authors>        <url>http://plantlore.berlios.de</url>                <uninstaller write="yes"/>    </info>        <guiprefs width="640" height="480" resizable="no"/>        <locale>        <langpack iso3="cze"/>        <langpack iso3="eng"/>    </locale>        <resources>        <res id="LicencePanel.licence" src="resources/gpl.txt"/>        <res id="InfoPanel.info" src="installer/readme.txt"/>        <res id="userInputSpec.xml" src="installer/userInputSpec.xml"/>  !
               <res id="userInputLang.xml_eng" src="installer/userInputLang.xml_eng" />        <res id="userInputLang.xml_cze" src="installer/userInputLang.xml_cze" />    </resources>        <panels>        <panel classname="HelloPanel"/>        <panel classname="InfoPanel"/>        <panel classname="LicencePanel"/>        <panel classname="TargetPanel"/>         <panel classname="PacksPanel"/>        <panel classname="UserInputPanel"/>                <panel classname="InstallPanel"/>        <panel classname="FinishPanel"/>    </panels>        <packs>                <pack name="Core" required="yes">            <description>Files that Plantlore needs always</description>            <file src="dist/lib" targetdir="$INSTALL_PATH"/>        </pack>        	<pack name="Client" required="no">            <description>Plantlore Java Client</description>            <file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"/>        </pack>	<pack n!
 ame="Server" required="no" preselected="no">            <desc!
 ription>
Plantlore Server</description>            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>	</pack>		<pack name="PostgreSQL" required="no">            <description>The PostgreSQL database machine</description>                        <file src="installer/postgresql/postgresql-int.msi" targetdir="$INSTALL_PATH" os="windows"/>            <file src="installer/postgresql/postgres_install.bat" targetdir="$INSTALL_PATH" os="windows"/>                        <parsable targetfile="$INSTALL_PATH/postgres_install.bat" os="windows" />            <executable targetfile="$INSTALL_PATH/postgres_install.bat"                         stage="postinstall"                         os="windows"                         failure="warn" />                        	</pack>	        <pack name="Docs" required="no">            <description>The documentation</description>            <file src="documentation!
 " targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->        </pack>        <pack name="Sources" required="no" preselected="no">            <description>The sources</description>            <file src="src" targetdir="$INSTALL_PATH"/>        </pack>    </packs>    </installation>
\ No newline at end of file

Added: trunk/installer/postgresql/postgres_install.bat
===================================================================
--- trunk/installer/postgresql/postgres_install.bat	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/postgresql/postgres_install.bat	2006-09-03 06:24:27 UTC (rev 642)
@@ -0,0 +1,3 @@
+msiexec /i "$INSTALL_PATH\postgresql-8.1-int.msi" /qr INTERNALLAUNCH=1 ADDLOCAL=server,psql SERVICEDOMAIN="%COMPUTERNAME%" SERVICEACCOUNT="$serviceaccount" SERVICEPASSWORD="$servicepassword" CREATESERVICEUSER=1 LISTENPORT="$listeningport" SUPERUSER="$superuser" SUPERPASSWORD="$superpassword" BASEDIR="$postgrehome" NOSHORTCUTS=$postgreshortcuts /log install.log
+
+del "$INSTALL_PATH\postgresql-8.1-int.msi"
\ No newline at end of file

Added: trunk/installer/postgresql/postgresql-int.msi
===================================================================

Added: trunk/installer/postgresql/readme.txt
===================================================================
--- trunk/installer/postgresql/readme.txt	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/postgresql/readme.txt	2006-09-03 06:24:27 UTC (rev 642)
@@ -0,0 +1,5 @@
+Contents of this directory:
+
+* postgresql-int.msi - Installer for PostgreSQL Database system. IMPORTANT: This is just a dummy file (since we do not want to have Postgre installer in our repository. On the other hand, IzPack should be able to compile installer from freshly checked out working copy therefore we need some file here). If you want to build windows installer, substitute this file for real PostgreSQL installer (use file with -int suffix).
+
+* postgre_intstall.bat - Script used for installing PostgreSQL database on Windows platform
\ No newline at end of file

Added: trunk/installer/userInputLang.xml_cze
===================================================================
--- trunk/installer/userInputLang.xml_cze	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/userInputLang.xml_cze	2006-09-03 06:24:27 UTC (rev 642)
@@ -0,0 +1,19 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<langpack>
+    <str id="title.PostgreSQL" txt="Detaily instalace PostgreSQL"/>
+    <str id="serviceaccount.description" txt="Datab?zov? syst?m PostgreSQL mus? b??et v opera?n?m syst?mu pod u?ivatelsk?m ??tem s omezen?mi pr?vy. Zadejte jm?no a heslo pro tohoto u?ivatele a instal?tor ho pro V?s vytvo??. Ujist?te se, ?e zadan? jm?no u?ivatele je v syst?mu unik?tn?"/>
+    <str id="serviceaccount.text" txt="Jm?no: "/>
+    <str id="servicepassword.text" txt="Heslo: "/>
+
+    <str id="superuser.description" txt="Pro pou??v?n? syst?mu PostgreSQL mus?te vytvo?it prvn?ho datab?zov?ho u?ivatele pomoc? kter?ho se po prv? p?ihl?s?te do Plantlore. Potom bude mo?n? pomoc? klienta Plantlore spravovat dal?? datab?zov? u?ivatele."/>
+    <str id="superuser.text" txt="Jm?no: "/>
+    <str id="superpassword.text" txt="Heslo: "/>
+
+    <str id="portnumber.text" txt="??slo portu: "/>
+
+    <str id="postgreshortcuts.description" txt="Vyberte jestli maj? b?t vytvo?eny odkazy na syst?m PostgreSQL v Start menu"/>
+    <str id="postgreshortcuts.create" txt="Vytvo?it odkazy"/>
+
+    <str id="postgrehome.description" txt="Czech:Pros?m vyberte adres?? do kter?ho bude syst?m PostgreSQL nainstalov?n. Tento adres?? mus? b?t na diskov?m odd?lu form?tu NTFS. Podrobn? informace najdete v instala?n? p??ru?ce p?ilo?en? k tomuto instal?toru."/>
+    <str id="postgrehome.text" txt="PostgreSQL adres??: "/>
+</langpack>
\ No newline at end of file

Added: trunk/installer/userInputLang.xml_eng
===================================================================
--- trunk/installer/userInputLang.xml_eng	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/userInputLang.xml_eng	2006-09-03 06:24:27 UTC (rev 642)
@@ -0,0 +1,20 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<langpack>
+    <str id="title.PostgreSQL" txt="PostgreSQL Installation Details"/>
+    <str id="serviceaccount.description" txt="PostgreSQL database system has to run under unpriviliged user account. Please specify the name and password of this user. Make sure that the name of the user is unique in your system"/>
+    <str id="serviceaccount.text" txt="Username: "/>
+    <str id="servicepassword.text" txt="Password: "/>
+
+    <str id="superuser.description" txt="In order to login to the PostgreSQL database system, you need to create a superuser account. Using this account you will login to Plantlore for the first time. After that, you can manage this account from within Plantlore client. Please enter username and password for the superuser"/>
+    <str id="superuser.text" txt="Username: "/>
+    <str id="superpassword.text" txt="Password: "/>
+
+    <str id="portnumber.text" txt="Port number: "/>
+
+    <str id="postgreshortcuts.description" txt="Specify whether the installation program should create Start menu shortcuts for PostgreSQL database"/>
+    <str id="postgreshortcuts.create" txt="Create shortcuts"/>
+
+    <str id="postgrehome.description" txt="Please specify a place where PostgreSQL database will be installed. Make sure that the location is on NTFS partition. For more details see installation instructions distributed with this install package."/>
+    <str id="postgrehome.text" txt="PostgreSQL directory: "/>
+
+</langpack>
\ No newline at end of file

Added: trunk/installer/userInputSpec.xml
===================================================================
--- trunk/installer/userInputSpec.xml	2006-09-03 01:18:42 UTC (rev 641)
+++ trunk/installer/userInputSpec.xml	2006-09-03 06:24:27 UTC (rev 642)
@@ -0,0 +1,58 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<userInput>
+    <panel order="0">
+        <createForPack name="PostgreSQL" />
+        <field type="title" align="center"
+               txt="PostgreSQL Installation Details" bold="true" size="2"
+               id="title.PostgreSQL"/>
+
+        <field type="text" variable="serviceaccount">
+            <description align="left" 
+                         txt="PostgreSQL database system has to run under unpriviliged user account. Please specify the name and password of this user. Make sure that the name of the user is unique in your system"
+                         id="serviceaccount.description"/>
+            <spec txt="Username: " id="serviceaccount.text" size="15"/>
+        </field>               
+        
+        <field type="text" variable="servicepassword">
+            <spec txt="Password: " id="servicepassword.text" size="15"/>
+        </field>               
+                   
+        <field type="text" variable="superuser">
+            <description align="left" 
+                         txt="In order to login to the PostgreSQL database system, you need to create a superuser account. Using this account you will login to Plantlore for the first time. After that, you can manage this account from within Plantlore client. Please enter username and password for the superuser"
+                         id="superuser.description"/>
+            <spec txt="Username: " id="superuser.text" size="15"/>
+        </field>               
+
+        <field type="text" variable="superpassword">
+            <spec txt="Password: " id="superpassword.text" size="15"/>
+        </field>               
+
+        <field type="text" variable="listeningport">
+            <spec txt="Port number: " id="portnumber.text" size="5" set="5432"/>
+        </field>               
+<!--        
+        <field type="rule" variable="listeningport">
+            <spec txt="Port number:" layout="N:5:5"
+                  set="5432" resultFormat="plainString" id="portnumber.text" />
+            <validator class="com.izforge.izpack.util.NotEmptyValidator" 
+                       txt="Invalid port number!" id="portnumber.error" />                                             
+        </field>
+--> 
+            
+        <field type="check" variable="postgreshortcuts">
+            <description align="left" 
+                         txt="Specify whether the installation program should create Start menu shortcuts for PostgreSQL database"
+                         id="postgreshortcuts.description"/>
+            <spec txt="Create shortcuts" id="postgreshortcuts.create" true="0" false="1" set="false" />
+        </field>        
+
+        <field type="search" variable="postgrehome">
+            <description align="left" 
+                         txt="Please specify a place where PostgreSQL database will be installed. Make sure that the location is on NTFS partition. For more details see installation instructions distributed with this install package."
+                         id="postgrehome.description"/>
+            <spec txt="PostgreSQL directory: " type="directory" result="directory" id="postgrehome.text" />
+        </field>        
+
+    </panel>
+</userInput>
\ No newline at end of file



From krater at mail.berlios.de  Sun Sep  3 13:35:55 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 3 Sep 2006 13:35:55 +0200
Subject: [Plantlore-dev] r643 - in trunk/src/net/sf/plantlore: common server
	server/manager
Message-ID: <200609031135.k83BZtBQ032356@sheep.berlios.de>

Author: krater
Date: 2006-09-03 13:35:42 +0200 (Sun, 03 Sep 2006)
New Revision: 643

Modified:
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
   trunk/src/net/sf/plantlore/server/CertificationException.java
   trunk/src/net/sf/plantlore/server/Plantlore.java
   trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/RMIServerControl.java
   trunk/src/net/sf/plantlore/server/Server.java
   trunk/src/net/sf/plantlore/server/ServerSettings.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMng.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
Log:
Server: Tested the creation/administration, JavaDoc added, Improved "Hide" behaviour, proper exception handling (do not offer reconnect, it does not make any sense within the server).
Bug: If A creates the server, B connects to it, B shuts the server down, A hides the manager => the server will stay there (although it should stop!). I don't know why. Even if someone else shuts the server down (remotely or so), the server won't terminate... :(

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -128,11 +128,19 @@
 			// Could be thrown while unmarshalling the parameters or results of a remote method call.
 			else if( e instanceof UnmarshalException )
 				problemDescription = L10n.getString("Error.Server.UnmarshallingFailed");
-
-			
 		}
 		
 		/*
+		 *	OTHER EXCEPTIONS CONNECTED WITH THE RMI 
+		 * (those exceptions that are not subclasses of the RemoteException) 
+		 */
+		else if( e instanceof AlreadyBoundException )
+			problemDescription = L10n.getString("Error.Server.AlreadyBound");
+		
+		else if( e instanceof NotBoundException )
+			problemDescription = L10n.getString("Error.Server.NotBound");
+		
+		/*
 		 * DBLAYER EXCEPTION HANDLER
 		 */
 		else if( e instanceof DBLayerException ) {

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -3,6 +3,8 @@
 import javax.swing.JDialog;
 import javax.swing.JFrame;
 
+import net.sf.plantlore.l10n.L10n;
+
 /**
  * A simple and convenient
  * implementation of the abstract ProgressBar with the default exception handler.
@@ -14,6 +16,8 @@
  */
 public class DefaultProgressBar extends ProgressBar {
 	
+	private boolean doNotOfferReconnect = false;
+	
 	/**
 	 * Create a new Default ProgressBar that will monitor the state 
 	 * of the supplied task.
@@ -33,12 +37,42 @@
 	 * @param task	The task this ProgressBar should monitor.
 	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
 	 * @param modal	True if the ProgressBar should be modal.
+	 * @param doNotOfferReconnect True if the Default Exception Handler should not offer
+	 * the Reconnect under any circumstances (convenient for the Server or Login).
 	 */
+	public DefaultProgressBar(Task task, JFrame parent, boolean modal, boolean doNotOfferReconnet) {
+		super(task, parent, modal);
+		this.doNotOfferReconnect = doNotOfferReconnet;
+	}
+	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
 	public DefaultProgressBar(Task task, JDialog parent, boolean modal) {
 		super(task, parent, modal);
 	}
 	
 	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 * @param doNotOfferReconnect True if the Default Exception Handler should not offer
+	 * the Reconnect under any circumstances (convenient for the Server or Login).
+	 */
+	public DefaultProgressBar(Task task, JDialog parent, boolean modal, boolean doNotOfferReconnet) {
+		super(task, parent, modal);
+		this.doNotOfferReconnect = doNotOfferReconnet;
+	}
+	
+	/**
 	 * Stop the task and handle the exception with the DefaultExceptionHandler.
 	 * 
 	 * @see DefaultExceptionHandler
@@ -46,7 +80,7 @@
 	@Override
 	public void exceptionHandler(Exception ex) {
 		getTask().stop();
-		DefaultExceptionHandler.handle(parent, ex);
+		DefaultExceptionHandler.handle(parent, ex, L10n.getString("Error.General"), doNotOfferReconnect);
 	}
 	
 }

Modified: trunk/src/net/sf/plantlore/server/CertificationException.java
===================================================================
--- trunk/src/net/sf/plantlore/server/CertificationException.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/CertificationException.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -1,7 +1,7 @@
 package net.sf.plantlore.server;
 
 /**
- * The Certification exception states that the access to the Administration
+ * The Certification exception is thrown if the access to the Administration
  * of the Server was denied, usually due to the incorrect authorization key.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
@@ -11,9 +11,11 @@
 public class CertificationException extends Exception {
 	
 	private static final long serialVersionUID = 2006060411064L;
-	
-	public CertificationException() { super(); }
-	
+
+	/**
+	 * @param msg	The message describing the reason why the Authorization
+	 * failed.
+	 */
 	public CertificationException(String msg) { super(msg); }
 	
 

Modified: trunk/src/net/sf/plantlore/server/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -17,7 +17,7 @@
 
 
 /**
- * The entry point when starting the Server. 
+ * The entry point when starting the Plantlore Server. 
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-03-30

Modified: trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -15,7 +15,7 @@
 import net.sf.plantlore.middleware.RemoteDBLayerFactory;
 
 /**
- * RMIRemoteDBLayerFactory is responsible for management of Database Layers
+ * RMIRemoteDBLayerFactory is responsible for the management of Database Layers
  * on the remote machine. It can create and destroy them, it stores the list of
  * all created Database Layers (i.e. list of connected clients) and can disconnect the
  * selected client.
@@ -128,7 +128,6 @@
 		try {
 			logger.debug("Exporting the database layer...");
 			stub = (DBLayer) UnicastRemoteObject.exportObject(database);
-			logger.debug("DBLayer exported.");
 		} catch(RemoteException e) {
 			logger.error("Unable to export the DBLayer. Is the `codebase` set properly? Are stubs generated properly? " + e.getMessage());
 			throw e;
@@ -150,7 +149,7 @@
 	 * 
 	 * @param db	The DBLayer object (not stub!) that should be disconnected.
 	 */	
-	void disconnect(DBLayer db)  
+	protected void disconnect(DBLayer db)  
 	throws RemoteException {
 		if(db == null)
 			return;

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -5,6 +5,7 @@
 import java.rmi.RemoteException;
 import java.rmi.registry.LocateRegistry;
 import java.rmi.registry.Registry;
+import java.rmi.server.RemoteObject;
 import java.rmi.server.UnicastRemoteObject;
 
 
@@ -57,7 +58,7 @@
 		this.settings = settings;
 		
 		// Control object that will return the server after the client passed a valid certif. information
-		guard = new RMIServerControl(this, password);
+		guard = new RMIServerControl( (Server) RemoteObject.toStub(this), password);
 		RMI.bind(settings.getPort(), guard, Guard.ID);
 	}
 	
@@ -163,5 +164,13 @@
 			logger.error("Unable to stop the server. " + e.getMessage());
 		}
 	}
+	
+	/**
+	 * Test, whether the Server is still alive.
+	 */
+	public void ping() 
+	throws RemoteException {
+		logger.debug("Pinged!");
+	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/RMIServerControl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -9,7 +9,7 @@
  * The Server Control guards the access to the Server 
  * and prevents unauthorized Users from shutting it down.
  * In order to manage the Server (terminate the Server, view
- * the list of connected clients, disconnecting the clients)
+ * the list of connected clients, disconnecting the clients, etc.)
  * the User must pass the authorization procedure and
  * supply valid authorization key (password).
  * 

Modified: trunk/src/net/sf/plantlore/server/Server.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Server.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/Server.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -10,7 +10,6 @@
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-03-29
- * @version 1.0
  */
 public interface Server extends Remote, Serializable {
 	
@@ -40,4 +39,11 @@
 	 */
 	void stop() throws RemoteException;
 	
+	
+	/**
+	 *	Test whether the server is alive.
+	 * 
+	 */
+	void ping() throws RemoteException;
+	
 }

Modified: trunk/src/net/sf/plantlore/server/ServerSettings.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ServerSettings.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/ServerSettings.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -19,8 +19,8 @@
 	/**
 	 * Create new Server Settings.
 	 * 
-	 * @param port	The port number where the listens.
-	 * @param timeout	The ammount of time after which the crashed client's database layer
+	 * @param port	The port number where the server listens.
+	 * @param timeout	The ammount of time in minutes after which the crashed client's database layer
 	 * is automatically destroyed. 
 	 * @param connectionsTotal	The maximum number of clients connected to the server simultaneously.
 	 * @param connectionsPerIP	The maximum number of clients connected to the server 
@@ -62,7 +62,7 @@
 	
 	/**
 	 * 
-	 * @return		The port number where the listens.
+	 * @return		The port number where the server listens.
 	 */
 	public int getPort() {
 		return port;
@@ -70,7 +70,7 @@
 	
 	/**
 	 * 
-	 * @return	The ammount of time after which the crashed client's database layer
+	 * @return	The ammount of time in minutes after which the crashed client's database layer
 	 * is automatically destroyed. 
 	 */
 	public int getTimeout() {

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -11,6 +11,14 @@
 import net.sf.plantlore.server.RMIServer;
 import net.sf.plantlore.server.ServerSettings;
 
+/**
+ * Gather the information from the dialog and
+ * perform the requested action - either conect to an already running
+ * Plantlore Server or create a new Plantlore Server.
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-05-30
+  */
 public class ServerCreateCtrl {
 
 	private ServerMngView mngView;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -14,13 +14,18 @@
 import net.sf.plantlore.server.ServerSettings;
 
 /**
+ * Open a dialog where the User can either create a new server (and specify the
+ * server's settings) or connect to an existing server (to administrate it).
  *
- * @author  yaa
+ * @author  Erik Kratochv?l
  */
 public class ServerCreateView extends javax.swing.JFrame implements Observer {
 	
+	private ServerMng model;
+	
     /** Creates new form ServerCreateView */
     public ServerCreateView(ServerMng model) {
+    	this.model = model; 
     	model.addObserver(this);
     	
         initComponents();
@@ -52,7 +57,8 @@
      * always regenerated by the Form Editor.
      */
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
-    private void initComponents() {
+    @SuppressWarnings("static-access")
+	private void initComponents() {
         plantloreLogo = new javax.swing.JPanel();
         next = new javax.swing.JButton();
         help = new javax.swing.JButton();
@@ -330,14 +336,19 @@
     protected javax.swing.JTextField serverPort;
     // End of variables declaration//GEN-END:variables
     
-    
+    /**
+     * Hide the dialog if the connection or creation was successful.
+     */
 	public void update(Observable source, Object parameter) {
-		if(parameter == ServerMng.CONNECTED)
+		
+		if(parameter == ServerMng.CONNECTED) {
+			model.deleteObserver(this);
 			java.awt.EventQueue.invokeLater(new Runnable() {
 				public void run() {
 					setVisible(false);
 				}
 			});
+		}
 	}
           
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMng.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -23,35 +23,47 @@
 import org.dom4j.io.XMLWriter;
 
 import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.Utils;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.*;
 import net.sf.plantlore.server.tools.RMI;
 
 /**
- * The server manager can
- * either create a new server or connect to an existing server.
+ * The server manager can create the following tasks:
+ * <ul>
+ * <li>the Create a New Server task,</li>
+ * <li>the Connect to an Existing Server task,</li>
+ * <li>and the Terminate the Server task.</li>
+ * </ol>
  * <br/>
  * After the Server Administrator is logged in, he can control the server:
  * <ul>
- * <li>see the connected clients,</li>
+ * <li>see the list of connected clients,</li>
  * <li>kick some of the connected clients,</li>
  * <li>terminate the server.</li>
  * </ul>
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-21
- * @version 1.0 final
+ * @version 1.0
  */
 public class ServerMng extends Observable {
 	
-	public static final Object UPDATE_LIST = new Object();
-	public static final Object CONNECTED = new Object();
+	/**
+	 * The message that is sent in case the list of connected clients
+	 * shall be refreshed.
+	 */
+	public static final Object UPDATE_LIST = "UpdateTheListOfConnectedUsers";
 	
+	/**
+	 * The message that is sent in case the connection to the server
+	 * (or the server's creation) was successful.
+	 */
+	public static final Object CONNECTED = "TheConnectionToTheServerIsAvailable";
+	
 	private static final String SERVER_CONFIG_NAME = "plantlore.server.xml";
 	private static final String PLANTLORE = "plantlore";
 	
-	private String codebase;
-	
 	/** The server control interface. */
 	private Server server;
 	private ServerSettings settings;
@@ -59,6 +71,8 @@
 	/** List of connected clients. */
 	private ConnectionInfo[] clients;
 	
+	private boolean didWeCreateTheServer = false;
+	
 	private Logger logger = Logger.getLogger(this.getClass().getPackage().getName());
 	private String settingsFileName; {
 		String userHome = System.getProperty("user.home"),
@@ -73,14 +87,20 @@
 		settingsFileName = plantloreConfDir + File.separator + SERVER_CONFIG_NAME;
 	}
 	
-	
+	/**
+	 * Create a new Server Manager.
+	 */
 	public ServerMng() {
 		getSettings(true);
-		if(codebase != null && codebase.length() > 0)
-			RMI.addToCodebase( codebase );
+		RMI.addToCodebase( Utils.getCodeBasePath() );
 	}
 	
-	
+	/**
+	 * Obtain the settings of the server.
+	 * 
+	 * @param refresh	True if the settings shoud be reloaded from the configuration file.
+	 * @return	The settings of the server.
+	 */
 	public ServerSettings getSettings(boolean refresh) {
 		if( !refresh )
 			return settings;
@@ -114,9 +134,6 @@
             settings = new ServerSettings(port, 3, connections, perip, 
             		new DatabaseSettings(databaseType, databasePort, databaseParameter));
             
-            // Load the codebase
-            Node path = document.selectSingleNode("/config/codebase");
-            codebase = path.getText();
             
 		} catch(Exception e) {
 			logger.error("Unable to load settings. " + e.getMessage());
@@ -125,7 +142,11 @@
 	}
 	
 	
-	
+	/**
+	 * Store the settings of the server into the file.
+	 * 
+	 * @param settings	The server's settings that shall be stored to the configuration file.
+	 */
 	public void setSettings(ServerSettings settings) {
 		this.settings = settings;
 		
@@ -141,8 +162,6 @@
 		db.addElement("port").setText( "" + settings.getDatabaseSettings().getPort() );
 		db.addElement("parameter").setText(settings.getDatabaseSettings().getConnectionStringSuffix());
 		
-		// Store the current codebase
-		config.addElement("codebase").setText(codebase);
 
 		try {
 			Writer outputWriter = new BufferedWriter(
@@ -163,9 +182,11 @@
 		
 	
 	/**
-	 * Try to create and start a new server on the specified <code>port</code>.
+	 * Create a new task, that will
+	 * try to create and start a new server on the specified <code>port</code>.
 	 * The server will be protected with a <code>password</code> so that 
-	 * anyone who will try to connect to the server will have use that password.
+	 * anyone who will try to connect to the server (to administrate it) 
+	 * will have to use that password.
 	 * <br/>
 	 * It is <b>not</b> possible to create a server on a remote machine
 	 * (because of security reasons).
@@ -187,6 +208,8 @@
 				logger.info("Server up and running (port " + settings.getPort() + ").");
 				setStatusMessage(L10n.getString("Server.Info.ServerUpAndRunning"));
 				
+				didWeCreateTheServer = true;
+				
 				announce(CONNECTED);
 				
 				fireStopped(null);
@@ -196,7 +219,8 @@
 	}
 
 	/**
-	 * Connect to an existing server on the selected <code>host</code>
+	 * Create a new task, that will
+	 * connect to an existing server on the selected <code>host</code>
 	 * listening on the selected <code>port</code> using the <code>password</code>.
 	 * 
 	 * @param host The hostname of the computer where the server is running.
@@ -222,7 +246,11 @@
 		};
 	}
 	
-	
+	/**
+	 * The notification of observers. 
+	 * 
+	 * @param event	The event that must be announced to the observers.
+	 */
 	private void announce(Object event) {
 		setChanged();
 		notifyObservers(event);
@@ -230,9 +258,10 @@
 	
 
 	/**
-	 * Get the list of connected clients.
-	 * @return The updated list of connected clients so that you can see whom you can kick, 
-	 * 	or null if we are not connected to some server.   
+	 * Crate a task, that will
+	 * update the list of currently connected clients; you should use
+	 * <code>getConnectedUsers()</code> to obtain the updated list.
+	 * 
 	 */
 	public Task createUpdateConnectedUsersTask() {
 		return new Task() {
@@ -256,7 +285,7 @@
 	}
 	
 	/**
-	 * Get the list of connected clients.
+	 * Obtain the list of connected clients.
 	 * 
 	 * @return The (possibly outdated) list of connected clients so that you can see whom you can kick, 
 	 * 	or null if we are not connected to some server.   
@@ -266,9 +295,10 @@
 	}
 	
 	/**
-	 * Disconnect the selected client from the server.
+	 * Create a task, that will
+	 * disconnect the selected client from the server.
 	 * 
-	 * @param client The client to be kicked out of the server.
+	 * @param client The client to be kicked from the server.
 	 */
 	public Task createKickTask(final ConnectionInfo client) {
 		return new Task() {
@@ -295,8 +325,10 @@
 	}
 	
 	/**
-	 * Terminate the server.
-	 * <b>Warning:</b> This will also kick all users as well.
+	 * Create a new task, that will
+	 * terminate the server and this application.
+	 * <br/>
+	 * <b>Warning:</b> This will immediately kick all connected clients.
 	 */
 	public Task createTerminateServerTask()  {
 		return new Task() {
@@ -319,5 +351,28 @@
 		};
 	}
 	
+	/**
+	 * 
+	 * @return	True if this model indeed created the server (i.e. it did not just connect to it). 
+	 */
+	public boolean didWeCreateTheServer() {
+		return didWeCreateTheServer;
+	}
 	
+	/**
+	 * 
+	 * @return	True if the server is alive.
+	 */
+	public boolean isServerAlive() {
+		boolean alive = true;
+		try {
+			server.ping();
+		} 
+		catch(Exception e) {
+			alive = false;
+		}
+		return alive;
+	}
+	
+	
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -8,6 +8,7 @@
 import net.sf.plantlore.server.ConnectionInfo;
 
 /**
+ * Perform the requested operation from the view.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-04-21
@@ -20,7 +21,7 @@
 		view.kick.setAction(new StandardAction("Server.KickUser") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createKickTask( (ConnectionInfo)view.users.getSelectedValue() );
-				new DefaultProgressBar(t, view, true);
+				new DefaultProgressBar(t, view, true, true);
 				t.start();			
 			}
 		});
@@ -28,7 +29,7 @@
 		view.terminate.setAction(new StandardAction("Server.Terminate") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createTerminateServerTask();
-				new DefaultProgressBar(t, view, true);
+				new DefaultProgressBar(t, view, true, true);
 				t.start();	
 			}
 		});
@@ -36,15 +37,19 @@
 		view.refresh.setAction(new StandardAction("Server.Refresh") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createUpdateConnectedUsersTask();
-				new DefaultProgressBar(t, view, true);
+				new DefaultProgressBar(t, view, true, true);
 				t.start();
 			}
 		});
 		
 		view.hide.setAction(new StandardAction("Server.Hide") {
 			public void actionPerformed(ActionEvent ae) {
+				model.deleteObserver( view );
 				view.setVisible(false);
 				view.dispose();
+				if( !model.didWeCreateTheServer() || !model.isServerAlive() ) {
+					System.exit(0);
+				}
 			}
 		});
 	}

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-03 06:24:27 UTC (rev 642)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-03 11:35:42 UTC (rev 643)
@@ -13,7 +13,9 @@
 import net.sf.plantlore.server.ConnectionInfo;
 
 /**
- * Server control dialog.
+ * The GUI for the Plantlore Server management.
+ * The User can see the list of currently connected clients,
+ * refresh it, kick some clients and terminate the Server.
  *
  * @author  Erik Kratochv?l
  */
@@ -118,7 +120,8 @@
 
 
     /**
-     * Reload the list of the connected clients.
+     * Reload the list of the connected clients and
+     * show the dialog when the connection or the creation was successful.
      */
 	public void update(Observable source, final Object parameter) {
 		if(parameter == ServerMng.UPDATE_LIST){



From krater at mail.berlios.de  Sun Sep  3 14:13:30 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 3 Sep 2006 14:13:30 +0200
Subject: [Plantlore-dev] r644 - in trunk/src/net/sf/plantlore/server: .
	manager
Message-ID: <200609031213.k83CDUsQ013448@sheep.berlios.de>

Author: krater
Date: 2006-09-03 14:13:28 +0200 (Sun, 03 Sep 2006)
New Revision: 644

Modified:
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/Server.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMng.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
Log:
The previous bug fixed  (the bug was: the server indeed terminated, but the thread refused to end). I forgot to get rid of (dispose of) one Swing dialog which prevented the thread to stop.

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -44,6 +44,7 @@
 	
 	private Logger logger;
 
+	private boolean isDead = true;
 
 	
 	/** 
@@ -120,6 +121,8 @@
 			// Bind the factory to the rmiregistry. 
 			registry.bind(RemoteDBLayerFactory.ID, remoteFactory);
 
+			isDead = false;
+			
 			logger.info("The RemoteDBLayerFactory has been bound to the rmiregistry.");
 		}
 		catch(RemoteException e) { 
@@ -148,17 +151,19 @@
 			// 3. Disconnect all users from the server.
 			remoteFactory.disconnectAll();
 			logger.info("All clients were disconnected.");
-
-			// 4. Disconnect this object from the RMI ->
-			UnicastRemoteObject.unexportObject(this, true);
-			logger.info("The RMIServer now stops accepting remote calls.");
 			
-			// 5. Disconnect the control guard and unexport it
+			// 4. Disconnect the control guard and unexport it
 			RMI.unbind(settings.getPort(), Guard.ID);
 			RMI.unexport(guard);
 			logger.debug("The ServerProxy is now unavailable.");
+
+			// 5. Disconnect this object from the RMI ->
+			RMI.unexport(this);
+			logger.info("The RMIServer now stops accepting remote calls.");
 			
 			logger.info("The Server terminates. Bye.");
+			
+			isDead = true;
 		}
 		catch(Exception e) { 
 			logger.error("Unable to stop the server. " + e.getMessage());
@@ -168,9 +173,10 @@
 	/**
 	 * Test, whether the Server is still alive.
 	 */
-	public void ping() 
+	public boolean ping() 
 	throws RemoteException {
 		logger.debug("Pinged!");
+		return !isDead;
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/Server.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Server.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/Server.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -42,8 +42,9 @@
 	
 	/**
 	 *	Test whether the server is alive.
-	 * 
+	 *
+	 * @return True if the server is alive. 
 	 */
-	void ping() throws RemoteException;
+	boolean ping() throws RemoteException;
 	
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -2,11 +2,9 @@
 
 import java.awt.event.ActionEvent;
 
-import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
-import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.DatabaseSettings;
 import net.sf.plantlore.server.RMIServer;
 import net.sf.plantlore.server.ServerSettings;
@@ -32,7 +30,7 @@
 			public void actionPerformed(ActionEvent arg0) {
 				
 				switch( view.choicePane.getSelectedIndex() ) {
-				/* CREATE A NEW SERVER */
+				/* CREATE A NEW SERVER AND CONNECT TO IT */
 				case 0:
 					// Take the stored information.
 					ServerSettings settings = model.getSettings(false);
@@ -71,15 +69,8 @@
 					
 					// Create and run a new server.
 					Task createServer = model.createNewServerTask( serverPassword );
-					new DefaultProgressBar(createServer, view, true) {
-						@Override
-						public void exceptionHandler(Exception ex) {
-							getTask().stop();
-							DefaultExceptionHandler.handle(parent, ex, L10n.getString("Error.CannotStartServer"), true);
-						}
-					};
+					new DefaultProgressBar(createServer, view, true, true);
 					createServer.start();
-					
 					break;
 				
 					
@@ -95,13 +86,7 @@
 					
 					Task connectToServer = model.createConnectToRunningServerTask(
 							view.remoteHost.getText(), port, password );
-					new DefaultProgressBar(connectToServer, view, true) {
-						@Override
-						public void exceptionHandler(Exception ex) {
-							getTask().stop();
-							DefaultExceptionHandler.handle(parent, ex, L10n.getString("Error.CannotConnectToTheServer"), true);
-						}
-					};
+					new DefaultProgressBar(connectToServer, view, true, true);
 					connectToServer.start();
 					
 					break;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -346,6 +346,7 @@
 			java.awt.EventQueue.invokeLater(new Runnable() {
 				public void run() {
 					setVisible(false);
+					dispose();
 				}
 			});
 		}

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMng.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -353,26 +353,16 @@
 	
 	/**
 	 * 
-	 * @return	True if this model indeed created the server (i.e. it did not just connect to it). 
+	 * @return	True if the server is alive. 
 	 */
-	public boolean didWeCreateTheServer() {
-		return didWeCreateTheServer;
-	}
-	
-	/**
-	 * 
-	 * @return	True if the server is alive.
-	 */
-	public boolean isServerAlive() {
-		boolean alive = true;
-		try {
-			server.ping();
-		} 
+	public boolean isAlive() {
+		try{
+			return didWeCreateTheServer && server.ping();
+		}
 		catch(Exception e) {
-			alive = false;
+			return false;
 		}
-		return alive;
 	}
 	
-	
+
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-03 11:35:42 UTC (rev 643)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-03 12:13:28 UTC (rev 644)
@@ -47,7 +47,7 @@
 				model.deleteObserver( view );
 				view.setVisible(false);
 				view.dispose();
-				if( !model.didWeCreateTheServer() || !model.isServerAlive() ) {
+				if( !model.isAlive() ) {
 					System.exit(0);
 				}
 			}



From krater at mail.berlios.de  Sun Sep  3 15:24:30 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 3 Sep 2006 15:24:30 +0200
Subject: [Plantlore-dev] r645 - trunk/src/net/sf/plantlore/common
Message-ID: <200609031324.k83DOUB4014177@sheep.berlios.de>

Author: krater
Date: 2006-09-03 15:24:27 +0200 (Sun, 03 Sep 2006)
New Revision: 645

Modified:
   trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
Log:
Improved use of DocumentSizeFilter:

       DocumentSizeFilter.patch( textField /comboBox/, size );

The whole procedure works flawlessly for text fields and combo boxes.

Modified: trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-03 12:13:28 UTC (rev 644)
+++ trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-03 13:24:27 UTC (rev 645)
@@ -9,9 +9,13 @@
 
 package net.sf.plantlore.common;
 
+import javax.swing.JComboBox;
+import javax.swing.JComponent;
+import javax.swing.JTextField;
 import javax.swing.text.AttributeSet;
 import javax.swing.text.BadLocationException;
 import javax.swing.text.DocumentFilter;
+import javax.swing.text.PlainDocument;
 
 
 /** Document filter that limits lenght of the text user can type, paste or maybe drag
@@ -67,6 +71,17 @@
             fb.replace(offs, length, str.substring(0,spaceLeft), a);
         }
     }//replace
+    
+    
+    public static void patch(JTextField textField, int size) {
+    	 PlainDocument pd = (PlainDocument) textField.getDocument();
+         pd.setDocumentFilter( new DocumentSizeFilter(size) );
+    }
+    
+    public static void patch(JComboBox comboBox, int size) {
+    	patch( (JTextField)comboBox.getEditor().getEditorComponent(), size );
+    }
+    
 
 }//DocumentSizeFilter
 



From fraktalek at mail.berlios.de  Sun Sep  3 19:27:44 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 3 Sep 2006 19:27:44 +0200
Subject: [Plantlore-dev] r646 - in trunk/src/net/sf/plantlore: client
	client/overview/search common
Message-ID: <200609031727.k83HRiYl001133@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-03 19:27:40 +0200 (Sun, 03 Sep 2006)
New Revision: 646

Added:
   trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/ProgressBarNew.form
   trunk/src/net/sf/plantlore/common/ProgressBarNew.java
Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
   trunk/src/net/sf/plantlore/common/Task.java
Log:
Task dispatcher together with new, synchronized, version of ProgressBar and DefaultProgressBar.
Also updated search and refresh not to notify SearchView if not necessary.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -80,7 +80,9 @@
 import net.sf.plantlore.client.user.UserManagerView;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.DefaultProgressBarEx;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.PlantloreHelp;
@@ -488,7 +490,7 @@
 					model.getMainConfig().setColumns(columns);
 
 					searchModel.setColumns(columns);
-					searchModel.clear();
+					searchModel.clearAndNotify();
 					searchModel.constructQuery();
 				}
 				if (s.equals("DYNAMIC_PAGE_LOADING")) {
@@ -882,7 +884,7 @@
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			searchModel.clear();
+			searchModel.clearAndNotify();
                         SwingUtilities.invokeLater(new Runnable() {
                             public void run() {
                                 searchView.setVisible(true);
@@ -955,7 +957,7 @@
                     if (message.equals("SEARCH")) {
                         switch (nodeInfo.getType()) {
                             case HABITAT:
-                                searchModel.clear();
+                                searchModel.clearAndNotify();
                                 searchModel.setHabitatId(nodeInfo.getId());
                                 searchModel.constructQuery();
                         }//switch
@@ -1693,7 +1695,7 @@
                                 fillDialogModels();
 
                                 view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
-                                searchModel.clear();
+                                searchModel.clearAndNotify();
                                 searchModel.constructQuery();
 
                                 view.getSBM().displayDefaultText();
@@ -1744,11 +1746,12 @@
 		if (createTask) {
 			Task task = new Task() {
 				public Object task() throws DBLayerException, RemoteException {
+                                    //refreshAction.setEnabled(false);
 					searchModel.clear();
 					searchModel.constructQuery();
 					fireStopped(null);
 					return null;
-				}
+				}                                
 			};
 
 			return task;
@@ -1761,6 +1764,8 @@
 
         /** Handles the refresh action invoked from overview. */
 	class RefreshAction extends AbstractAction {
+            Task task = refreshOverview(true);
+            
 		public RefreshAction() {
 			if (showButtonText)
 				putValue(NAME, L10n.getString("Overview.Refresh"));
@@ -1772,11 +1777,20 @@
 		}
 
 		public void actionPerformed(ActionEvent e) {
+                    /*if (task != null && task.isRunning()) {
+                        System.out.println("Refresh is already running. Returning...");
+                        return;
+                    }*/
+                        
 			// e can be null !!! - we call actionPerformed(null) in DeleteAction
-			Task task = refreshOverview(true);
-			ProgressBar progressBar = new DefaultProgressBar(task, view, true);
+			//task = refreshOverview(true);
+			/*ProgressBar progressBar = new DefaultProgressBarEx(task, view, true) {
+                            public void afterStopping() {
+                                refreshAction.setEnabled(true);
+                            }
+                        };*/
 
-			task.start();
+			System.out.println("Dispatcher: "+Dispatcher.getDispatcher().dispatch(task, view, true));
 		}
 
 	}

Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -117,7 +117,7 @@
         this.database = database;
         this.editMode = editMode;
         logger = Logger.getLogger(this.getClass().getPackage().getName());         
-        clear();
+        clearAndNotify();
     }
  
 
@@ -925,6 +925,11 @@
         return sq;
     }
     
+    public void clearAndNotify() {
+        clear();
+        setChanged(); notifyObservers("CLEAR");
+    }
+    
     public void clear() {
         clearAuthors();
     
@@ -950,9 +955,8 @@
         month  = null;
         fromDate = null;
         toDate = null;
-        setChanged(); notifyObservers("CLEAR");
     }
-    
+
     public void clearAuthors() {
         authorList = new ArrayList<Pair<Pair<String,Integer>,String>>();
         resultRevision = new ArrayList<String>();        

Added: trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -0,0 +1,52 @@
+package net.sf.plantlore.common;
+
+import javax.swing.JDialog;
+import javax.swing.JFrame;
+
+/**
+ * A simple and convenient
+ * implementation of the abstract ProgressBar with the default exception handler.
+ * <br/>
+ * 
+ * @author Erik Kratochv?l (discontinuum at gmail.com)
+ * @since 2006-07-26
+ *
+ */
+public class DefaultProgressBarNew extends ProgressBarNew {
+	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
+	public DefaultProgressBarNew(Task task, JFrame parent, boolean modal) {
+		super(task, parent, modal);
+	}
+	
+	/**
+	 * Create a new Default ProgressBar that will monitor the state 
+	 * of the supplied task.
+	 * 
+	 * @param task	The task this ProgressBar should monitor.
+	 * @param parent	The parent window in order to maintain the Swing window hierarchy.
+	 * @param modal	True if the ProgressBar should be modal.
+	 */
+	public DefaultProgressBarNew(Task task, JDialog parent, boolean modal) {
+		super(task, parent, modal);
+	}
+	
+	/**
+	 * Stop the task and handle the exception with the DefaultExceptionHandler.
+	 * 
+	 * @see DefaultExceptionHandler
+	 */
+	@Override
+	public void exceptionHandler(Exception ex) {
+		getTask().stop();
+		DefaultExceptionHandler.handle(parent, ex);
+	}
+	
+}

Added: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -0,0 +1,62 @@
+/*
+ * Dispatcher.java
+ *
+ * Created on 3. z??? 2006, 12:08
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.common;
+
+import java.util.Observable;
+import java.util.Observer;
+import javax.swing.JDialog;
+import javax.swing.JFrame;
+import javax.swing.SwingUtilities;
+import org.apache.log4j.Logger;
+
+/**
+ *
+ * @author fraktalek
+ */
+public class Dispatcher {
+    private Logger logger = Logger.getLogger(Dispatcher.class.getPackage().getName());
+    private boolean taskRunning = false;
+    private DefaultProgressBarNew dpb;
+    private Task task;
+    private static Dispatcher dispatcher = new Dispatcher();
+    
+    private Dispatcher() {
+    }
+ 
+    public synchronized boolean dispatch(Task task, JFrame parent, boolean stoppable) {
+        if (taskRunning) {
+            System.out.println("Dispatcher: task already RUNNING, RETURNING.");
+            return false;
+        }
+        
+        taskRunning = true;
+        this.task = task;
+        dpb = new DefaultProgressBarNew(task, parent, true);
+        
+        task.start();
+        
+        return true;
+    }
+
+    /** Tells the dispatcher that the progressbar and task finished.
+     *
+     * This tells the dispatcher that it is safe to dispatch another task.
+     */
+    public synchronized void finished() {
+        taskRunning = false;
+        task.deleteObservers();
+        logger.debug("Dispatcher: "+task+" finished, free to dispatch another.");
+    }    
+    
+    public static Dispatcher getDispatcher() {
+        return dispatcher;
+    }
+}
+

Added: trunk/src/net/sf/plantlore/common/ProgressBarNew.form
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarNew.form	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/common/ProgressBarNew.form	2006-09-03 17:27:40 UTC (rev 646)
@@ -0,0 +1,108 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+<Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
+  <Properties>
+    <Property name="defaultCloseOperation" type="int" value="0"/>
+    <Property name="resizable" type="boolean" value="false"/>
+    <Property name="undecorated" type="boolean" value="true"/>
+  </Properties>
+  <SyntheticProperties>
+    <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
+  </SyntheticProperties>
+  <AuxValues>
+    <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_layoutCodeTarget" type="java.lang.Integer" value="2"/>
+    <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
+    <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
+  </AuxValues>
+
+  <Layout>
+    <DimensionLayout dim="0">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
+      </Group>
+    </DimensionLayout>
+    <DimensionLayout dim="1">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
+      </Group>
+    </DimensionLayout>
+  </Layout>
+  <SubComponents>
+    <Container class="javax.swing.JPanel" name="jPanel1">
+      <Properties>
+        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+          <Border info="org.netbeans.modules.form.compat2.border.CompoundBorderInfo">
+            <CompundBorder>
+              <Border PropertyName="outside" info="org.netbeans.modules.form.compat2.border.SoftBevelBorderInfo">
+                <BevelBorder/>
+              </Border>
+              <Border PropertyName="inside" info="org.netbeans.modules.form.compat2.border.EtchedBorderInfo">
+                <EtchetBorder/>
+              </Border>
+            </CompundBorder>
+          </Border>
+        </Property>
+      </Properties>
+
+      <Layout>
+        <DimensionLayout dim="0">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="1" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="1" attributes="0">
+                      <Component id="statusField" alignment="0" pref="180" max="32767" attributes="0"/>
+                      <Component id="progressBar" alignment="0" pref="180" max="32767" attributes="2"/>
+                  </Group>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+        <DimensionLayout dim="1">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace min="-2" pref="21" max="-2" attributes="0"/>
+                  <Component id="progressBar" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="32767" attributes="0"/>
+                  <Component id="statusField" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+      </Layout>
+      <SubComponents>
+        <Component class="javax.swing.JProgressBar" name="progressBar">
+          <Properties>
+            <Property name="foreground" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="0" green="ff" id="green" palette="1" red="0" type="palette"/>
+            </Property>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+        <Component class="javax.swing.JTextField" name="statusField">
+          <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ee" green="ee" id="Panel.background" palette="3" red="ee" type="palette"/>
+            </Property>
+            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+              <Border info="null"/>
+            </Property>
+            <Property name="disabledTextColor" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="33" green="33" id="Button.foreground" palette="3" red="33" type="palette"/>
+            </Property>
+            <Property name="enabled" type="boolean" value="false"/>
+          </Properties>
+          <Events>
+            <EventHandler event="actionPerformed" listener="java.awt.event.ActionListener" parameters="java.awt.event.ActionEvent" handler="statusFieldActionPerformed"/>
+          </Events>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
+    </Container>
+  </SubComponents>
+</Form>

Added: trunk/src/net/sf/plantlore/common/ProgressBarNew.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarNew.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/common/ProgressBarNew.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -0,0 +1,328 @@
+/*
+ * ProgressBar.java
+ *
+ * Created on 28. kv?ten 2006, 23:31
+ */
+
+package net.sf.plantlore.common;
+
+import java.awt.Color;
+import java.awt.Cursor;
+import java.awt.Window;
+import java.util.Observable;
+import java.util.Observer;
+import java.awt.Frame;
+import javax.swing.SwingUtilities;
+import org.apache.log4j.Logger;
+
+/** ProgressBar dialog that works as an observer of a given Task.
+ *
+ * The dialog sets itself visible after it receives a STARTING Message, disposes
+ * itself after getting a STOPPED Message and in the time between it updates it's
+ * state according to POSITION_CHANGED, MESSAGE_CHANGED and LENGHT_CHANGED messages.
+ *
+ * If constructed with an indeterminate Task works in indeterminate mode until it
+ * receives a LENGHT_CHANGED message from the Task. Then it switches to determinate mode.
+ *
+ * Exceptions trhown by the task are processed by the abstract exceptionHandler() method.
+ *
+ * @author  fraktalek
+ */
+public abstract class ProgressBarNew extends javax.swing.JDialog implements Observer {
+    protected Logger logger;
+    protected Task task;
+    private int statusFieldWidth;
+    private double charSizeApprox = 180/27; //in 180 pixel wide JTextField first 27 characters are visible in Matisse
+    protected Window parent;
+    
+    private boolean ended = false;
+    
+    /** Creates a new progress bar, initially invisible. It becomes visible after it receives
+     * a STARTING Message from the Task.
+     *
+     * @param task the task to be monitored
+     * @param parent the parent frame of this dialog
+     * @modal whether to open in modal mode
+     *
+     */
+    public ProgressBarNew(Task task, java.awt.Frame parent, boolean modal) {
+        super(parent, modal);
+        
+        this.parent = parent;
+        this.task = task;
+        initialize();
+    }
+    
+    public ProgressBarNew(Task task, javax.swing.JDialog parent, boolean modal) {
+        super(parent, modal);
+
+        this.parent = parent;
+        this.task = task;        
+        initialize();        
+    }    
+   
+    
+    protected void initialize() {
+        logger = Logger.getLogger(this.getClass().getPackage().getName());
+        initComponents();
+        
+        if (task.isDeterminate()) {
+            progressBar.setIndeterminate(false);
+            progressBar.setMinimum(0);
+            progressBar.setMaximum(task.getLength());
+        } else {
+            progressBar.setIndeterminate(true);
+        }
+        statusFieldWidth = statusField.getWidth();
+        statusField.setBackground(javax.swing.UIManager.getDefaults().getColor("Panel.background"));
+        
+        setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+        parent.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+        
+        task.addObserver(this);    
+        setLocationRelativeTo(parent);
+    }
+    
+    /** Makes the ProgressBar visible, must be called from EDT.
+     *
+     */
+    private synchronized void start() {
+        if (ended)//we probably received message.STOPPING earlier than message.STARTING => do not begin again
+            return;
+        setVisible(true);
+        logger.debug(""+this+" VISIBLE");
+    }
+    
+    /** Makes the ProgressBar invisible and disposes it.
+     * Must be called from EDT!
+     *
+     */
+    private synchronized void stop() {
+        ended = true;
+        setVisible(false);
+        dispose(); // FIXME: Should not this method be invoked from the EDT?                    
+        parent.setCursor(Cursor.getDefaultCursor());
+        logger.debug(""+this+" STOPPING " + task );
+        afterStopping();        
+        Dispatcher.getDispatcher().finished();
+    }
+    
+    /** Changes the ProgressBar's state.
+     * Must be called from EDT!
+     */
+    private synchronized void changePosition(int position) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;
+        
+        progressBar.setValue(position);
+    }
+    
+    /** Changes the ProgressBar's message.
+     * Must be called from EDT!
+     */
+    private synchronized void changeMessage(String message) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;
+        
+        if (message == null) //just to be sure
+            message = "";
+        
+        statusField.setText(message);
+        progressBar.setString(message);
+        int curWidth = statusField.getWidth();
+        if (message.length() > (curWidth/charSizeApprox)) {
+            int newWidth = new Double(message.length()*charSizeApprox).intValue();
+            setSize(getWidth()+(newWidth-curWidth),getHeight());
+        }        
+    }
+    
+    /** Changes representation of the task length.
+     * Must be called from EDT!
+     */
+    private synchronized void changeLength(int length) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;        
+        
+        if (progressBar.isIndeterminate()) {
+            progressBar.setIndeterminate(false);
+        }
+        progressBar.setMaximum(length);
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
+    private void initComponents() {
+        jPanel1 = new javax.swing.JPanel();
+        progressBar = new javax.swing.JProgressBar();
+        statusField = new javax.swing.JTextField();
+
+        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
+        setResizable(false);
+        setUndecorated(true);
+        jPanel1.setBorder(javax.swing.BorderFactory.createCompoundBorder(new javax.swing.border.SoftBevelBorder(javax.swing.border.BevelBorder.RAISED), javax.swing.BorderFactory.createEtchedBorder()));
+        progressBar.setForeground(java.awt.Color.green);
+
+        statusField.setBackground(javax.swing.UIManager.getDefaults().getColor("Panel.background"));
+        statusField.setBorder(null);
+        statusField.setDisabledTextColor(javax.swing.UIManager.getDefaults().getColor("Button.foreground"));
+        statusField.setEnabled(false);
+        statusField.addActionListener(new java.awt.event.ActionListener() {
+            public void actionPerformed(java.awt.event.ActionEvent evt) {
+                statusFieldActionPerformed(evt);
+            }
+        });
+
+        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
+        jPanel1.setLayout(jPanel1Layout);
+        jPanel1Layout.setHorizontalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, statusField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 180, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, progressBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 180, Short.MAX_VALUE))
+                .addContainerGap())
+        );
+        jPanel1Layout.setVerticalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
+                .add(21, 21, 21)
+                .add(progressBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .add(statusField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap())
+        );
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+        );
+        pack();
+    }// </editor-fold>//GEN-END:initComponents
+
+    private void statusFieldActionPerformed(java.awt.event.ActionEvent evt) {//GEN-FIRST:event_statusFieldActionPerformed
+// TODO add your handling code here:
+    }//GEN-LAST:event_statusFieldActionPerformed
+    
+    /**
+     * @param args the command line arguments
+     */
+    public static void main(String args[]) {
+        java.awt.EventQueue.invokeLater(new Runnable() {
+            public void run() {
+                //new ProgressBar(new javax.swing.JFrame(), true).setVisible(true);
+            }
+        });
+    }
+
+    /** Updates the progress bar according to messages from the task.
+     *
+     * Adjusts widht of the dialog in case it receives a longer text message
+     * form the task than it is possible to display in current widht.
+     *
+     * Will set WAIT_CURSOR to it's parent and will restore it to defaultCursor
+     * after it disappears.
+     *
+     * Invokes exceptionHanlder on received exceptions.
+     */
+    public void update(final Observable o, final Object arg) {
+        final ProgressBarNew pb = this;
+        if (arg instanceof Pair) {
+            Pair p = (Pair)arg;
+            Object first = p.getFirst();
+            if (first instanceof Task.Message) {
+                Task.Message msg = (Task.Message)first;
+                Object value = p.getSecond();
+                logger.debug(""+this+" received message: "+msg);
+                switch (msg) {
+                    case STARTING:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                start();
+                            }
+                        });
+                        break;
+                    case POSITION_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changePosition(task.getPosition());
+                            }
+                        });
+                        break;
+                    case MESSAGE_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changeMessage(task.getStatusMessage());
+                            }
+                        });
+                        break;
+                    case LENGTH_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changeLength(task.getLength());
+                            }
+                        });
+                        break;
+                    case STOPPING:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                stop();
+                            }
+                        });
+                        break;
+                    case STOPPED:
+                        afterStopped(value);
+                        break;                    
+                }//switch
+            }//instanceof Message
+
+        }//instanceof Pair
+        
+        if (arg instanceof Exception) {
+            exceptionHandler((Exception)arg);
+        }
+    }
+    
+    /** This method receives exceptions thrown by the task.
+     * 
+     * You have to call task.proceed() if you want the task to continue it's 
+     * computation.
+     */
+    public abstract void exceptionHandler(Exception ex);
+    
+    public Task getTask() {
+        return task;
+    }
+    
+    public void afterStopped(Object value) {
+    	// Empty implementation = do nothing.        
+    }
+    
+    /** Be careful, will run in EDT! (if ProgressBar used properly)
+     *
+     */
+    public void afterStopping() {
+    	
+    }
+
+    public String toString() {
+        return "ProgressBarNew("+this.hashCode()+")";
+    }
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JPanel jPanel1;
+    protected javax.swing.JProgressBar progressBar;
+    protected javax.swing.JTextField statusField;
+    // End of variables declaration//GEN-END:variables
+    
+}

Modified: trunk/src/net/sf/plantlore/common/Task.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Task.java	2006-09-03 13:24:27 UTC (rev 645)
+++ trunk/src/net/sf/plantlore/common/Task.java	2006-09-03 17:27:40 UTC (rev 646)
@@ -269,6 +269,10 @@
     	setChanged();
         notifyObservers(new Pair<Message,Object>(Message.STOPPING,null));
     }
+    
+    public String toString() {
+        return "Task("+this.hashCode()+")";
+    }
 }
 
 



From krater at mail.berlios.de  Sun Sep  3 19:35:13 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 3 Sep 2006 19:35:13 +0200
Subject: [Plantlore-dev] r647 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609031735.k83HZDcZ003111@sheep.berlios.de>

Author: krater
Date: 2006-09-03 19:34:37 +0200 (Sun, 03 Sep 2006)
New Revision: 647

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
Log:
Partially updated L10N properties. More will follow.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 17:27:40 UTC (rev 646)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 17:34:37 UTC (rev 647)
@@ -712,28 +712,13 @@
 #=============================================================
 # ERRORS
 #=============================================================
-errorDBLayerException = The connection to the database could not be established.\n Please make sure you entered valid authentication information (misspelled username, incorrect password)\n and try again.
-errorDBLayerExceptionTitle = Database connection error! 
+Error.General=An error occurred.
+Error.Fatal=A serious error occurred.
 
-errorNotBoundException = The server is either unreachable or not running.\n Please make sure you entered valid connection information.\n Study the log for further details. 
-errorNotBoundExceptionTitle = Server unreachable!
-
-errorRemoteException = Either the network connection has failed or the server has crashed or gone off.\n Please make sure the network connection is working.\n Study the log for further details.  
-errorRemoteExceptionTitle = Network problem!
-
-errorAlreadyBoundException = Another server is already running on the specified port.\n Please choose another port and try again.
-errorAlreadyBoundExceptionTitle = Server collision!
-
-errorCertificationException = The certification failed - the password is incorrect.\n Please type the password again.
-errorCertificationExceptionTitle = Certification failure!
-
-
-
 Error.InvalidDBLayer = The database layer is not valid! 
 Error.InvalidBuilder = The supplied Builder is not valid!
 Error.InvalidResultset = The supplied result set identifier is not valid!
 Error.InvalidSelection = The supplied list of selected items is not valid!
-Error.TooManyTasks = There are too many exports running already.
 Error.InvalidQuery = The supplied select query is not valid!
 Error.InvalidFilter = The supplied file format is not valid!
 Error.InvalidChecklist = The checklist is not valid.
@@ -742,32 +727,72 @@
 Error.InvalidRootTable = The supplied root table is not valid!\n If you want to use projections,\n you must specify the root table.
 Error.InvalidRecord = The record is not valid!
 
-Error.Missing = Missing information.
-Error.MissingFileName = The file name was not specified.
-Error.MissingUserName = You forget to enter the account name.
-Error.MissingCompulsoryFieldTitle = Missing compulsory field
-Error.MissingCompulsoryField = is a compulsory field. Please fill in it.
-Error.WriterNotCreated = Unable to create the output file writer.
-Error.NothingSelected = Nothing is selected.
-Error.NoColumnsSelected = No columns are selected.
-Error.ExportFailed = Export ended prematurely. 
-Error.ImportFailed = Import failed.
-Error.LoginFailed = Login failed.
-Error.TransactionRaceConditions = The transaction could not be created.\n There is another transaction in progress already.
-Error.RecordNotFound = The record was not found.\n It cannot be entered into an immutable table.
-Error.FKIsNull = Some foreign keys are null! \n The record is incomplete.
-Error.ReaderNotCreated = Unable to create the file reader.
-Error.FileFormatCorrupted = The format of the file is corrupted.
-Error.ThreadFailed = Unable to create a new thread!
-Error.IncorrectXMLFile = Incorrect XML file!\n
-Error.DuplicateLogin = Login already exist. Please change it.
-Error.DuplicateLoginTitle = Incorrect data
-Error.DeletingSharedRecord = The {0} is shared by {1} other records.\nCannot delete.
-Error.UnableToProcess = The record No. {0} cannot be processed; 
-Error.MissingUpdateRecord = The update is not defined! 
-Error.GenericMessageTitle = Error
+Error.UnhandledExceptionalState=The Application performed an illegal operation\nand it will be terminated.
+Error.ImproperUse=Internal error: The method is not used properly.
 
+Error.Missing=Missing information.
+Error.MissingFileName=The file name was not specified.
+Error.MissingUserName=You forget to enter the account name.
+Error.MissingCompulsoryFieldTitle=Missing compulsory field
+Error.MissingCompulsoryField=is a compulsory field. Please fill in it.
+Error.WriterNotCreated=Unable to create the output file writer.
+Error.NothingSelected=Nothing is selected.
+Error.NoColumnsSelected=No columns are selected.
+Error.ExportFailed=Export ended prematurely. 
+Error.ImportFailed=Import failed.
+Error.LoginFailed=Login failed.
+Error.TransactionRaceConditions=The transaction could not be created.\n There is another transaction in progress already.
+Error.RecordNotFound=The record was not found.\n It cannot be entered into an immutable table.
+Error.FKIsNull=Some foreign keys are null! \n The record is incomplete.
+Error.ReaderNotCreated=Unable to create the file reader.
+Error.FileFormatCorrupted=The format of the file is corrupted.
+Error.ThreadFailed=Unable to create a new thread!
+Error.IncorrectXMLFile=Incorrect XML file!\n
+Error.DuplicateLogin=Login already exist. Please change it.
+Error.DuplicateLoginTitle=Incorrect data
+Error.DeletingSharedRecord=The {0} is shared by {1} other records.\nCannot delete.
+Error.UnableToProcess=The record No. {0} cannot be processed; 
+Error.MissingUpdateRecord=The update is not defined! 
+Error.GenericMessageTitle=Error
+Error.WrongAuthorizationKey=Incorrect authorization key.
+Error.TooManyConnections=Too many clients are already connected.
 
+Error.ConnectionLost=Connection lost
+
+Error.Server.AccessDenied=Access denied - insufficient permissions.
+Error.Server.ConnectionRefused=Connection refused. Is the Server running?
+Error.Server.ExportFailed=Unable to register an object within the RMI.
+Error.Server.MarshallingFailed=Unable to send the data.\nDo you have the correct version?
+Error.Server.ObjectDoesNotExistAnymore=You have been disconnected from the server\nby its Administrator.
+Error.Server.InTrouble=The Server has crashed.
+Error.Server.StubNotFound=Some parts of the program are missing.
+Error.Server.UnexpectedProblem=
+Error.Server.UnknownHost=Unknown host or IP address.
+Error.Server.UnmarshallingFailed=Unable to receive the data.\nDo you have the correct version?
+Error.Server.AlreadyBound=Another Server is already running on the specified port.
+Error.Server.NotBound=There is no Server on the specified port.
+
+DBLayer.Error.Unspecified=The reason is unknown.
+DBLayer.Error.LoadConfig=Unable to load the configuration file.
+DBLayer.Error.Connect=The connection was refused.
+DBLayer.Error.Login=Incorrect user name or password.
+DBLayer.Error.Username=Invalid user name.
+DBLayer.Error.Password=Incorrect password.
+DBLayer.Error.Save=Unable to insert the record into the database.
+DBLayer.Error.Delete=Unable to delete the record from the database.
+DBLayer.Error.Update=Unable to update the record in the database.
+DBLayer.Error.Select=Unable to find the data int the database.
+DBLayer.Error.LoadData=Unable to retrieve data from the database.
+DBLayer.Error.Close=Unable to close the database connection.
+DBLayer.Error.Rights=Insufficient access rights.
+DBLayer.Error.DB=The database is inconsistent.
+DBLayer.Error.Transaction=The operation was canceled.\nSomeone may have changed the data in the meantime.
+DBLayer.Error.Resources=The database run out of resources (memory, hard drive space).
+DBLayer.Error.DiskFull=The hard drive is full.
+DBLayer.Error.OutOfMemory=There is not enough memory to complete the request.
+DBLayer.Error.MaxConnections=Too many users are connected to the database.
+DBLayer.Error.Other=The reason is unknown.
+
 #=============================================================
 # QUESTIONS
 #=============================================================
@@ -1215,25 +1240,17 @@
 # SERVER
 #	net.sf.plantlore.server.manager
 #=============================================================
-Server.Login=Login
 Server.Host=Host
-Server.Next = Connect
-Server.NextTT = Connect to an existing server.
-Server.Create = Create
-Server.CreateTT = Create and start a new Plantlore server.
-
-Server.ConnectionsTotal = Connections Total
-Server.ConnectionsPerIP = Connections per IP
-Server.Timeout = Timeout
+Server.HostTT=The name or IP address where the Server runs.
+Server.Continue=Continue
+Server.ContinueTT=Proceed to the Server Manager.
 Server.Manage=Connections
-
 Server.ServerSettings=Server settings
 Server.Password=Password
 Server.PasswordTT=The password that will protect the server from being manipulated by unauthorized persons.
-Server.Port = Port
+Server.Port=Port
 Server.PortTT=The port where the Plantlore server should listen.
-
-
+Server.ConnectToSettings=Remote host settings
 Server.DatabaseSettings=Database settings
 Server.DatabaseUser=User
 Server.DatabaseUserTT=The power user of the database. \nThe Plantlore server will use this login \nto gain access to the database engine.
@@ -1241,9 +1258,9 @@
 Server.DatabasePasswordTT=The password of the power-user account. \nThe Plantlore server will use this password \nto gain access to the database engine.
 Server.DatabaseParameter=Parameter
 Server.DatabaseParameterTT=Some additional parameters the Plantlore server should use \nwhen connecting to the database, such as encoding.
-Server.DatabaseType = Database
+Server.DatabaseType=Database
 Server.DatabaseTypeTT=The database engine that contains the data.
-Server.DatabasePort = Port
+Server.DatabasePort=Port
 Server.DatabasePortTT=The port where the database engine listens.
 
 
@@ -1257,18 +1274,23 @@
 Server.TerminateTT=Terminate the Plantlore server and disconnect all its clients.
 Server.ListOfUsersTT=The list of currently connected users.
 
+Server.CreateNewServer=Create a new Server
+Server.ConnectToRunningServer=Connect to a running Server
 
-Server.SettingsLoaded = Settings loaded.
-Server.SettingsNotLoaded = Settings not loaded. 
-Server.SettingsSaved = Settings saved.
-Server.SettingsNotSaved = Settings not saved.
-Server.Info.CreatingNewServer = Creating a new server...
-Server.Info.StartingNewServer = Starting the server...
-Server.Info.ServerUpAndRunning = Server is up and running.
-Server.Info.ConnectingToServer = Connecting to the server...
-Server.Info.ClientsObtained = The list of clients refreshed.
-Server.Info.ClientKicked = The client {0} was kicked.
-Server.Info.Terminated = Server terminated (clients disconnected).
+Server.SettingsLoaded=Settings loaded.
+Server.SettingsNotLoaded=Settings not loaded. 
+Server.SettingsSaved=Settings saved.
+Server.SettingsNotSaved=Settings not saved.
+Server.Info.CreatingNewServer=Creating a new server...
+Server.Info.StartingNewServer=Starting the server...
+Server.Info.ServerUpAndRunning=Server is up and running.
+Server.Info.ConnectingToServer=Connecting to the server...
+Server.Info.ObtainingClients=Retrieving the list of users...
+Server.Info.ClientsObtained=The list of clients refreshed.
+Server.Info.KickingClient=Disconnecting the client...
+Server.Info.ClientKicked=The client {0} was kicked.
+Server.Info.TerminatingServer=Stopping the server...
+Server.Info.Terminated=Server stopped.
 
 
 
@@ -1453,3 +1475,5 @@
 collectionNameLbl=Collection name
 
 collectionNameTitle=Collection name
+
+Server.Continue=Continue



From krater at mail.berlios.de  Mon Sep  4 00:04:52 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 00:04:52 +0200
Subject: [Plantlore-dev] r648 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609032204.k83M4qlY014800@sheep.berlios.de>

Author: krater
Date: 2006-09-04 00:04:51 +0200 (Mon, 04 Sep 2006)
New Revision: 648

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
L10N strings added.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 17:34:37 UTC (rev 647)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 22:04:51 UTC (rev 648)
@@ -57,6 +57,8 @@
 Continue = C&ontinue
 ContinueTT = Continue with the operation 
 Common.Cancel=&Cancel
+Common.CancelTT=Cancel the operation.
+Common.Canceled=The operation was canceled.
 Close = Close
 Common.Help=&Help
 Common.GpsChange = Change
@@ -425,14 +427,20 @@
 Login.RemoveRecord = Remove
 Login.RemoveRecordTT = Remove the selected record (the database won't be deleted!).
 
+Login.LocalDatabase=Local connection
+Login.RemoteDatabase=Remote connection
+
 Login.Alias = Alias
 Login.AliasTT = The string that will be displayed to you.
 Login.HostName = Hostname
 Login.HostNameTT = The name of the computer where the server dwells.
-Login.Database = Database
-Login.DatabaseTT = The database engine that contains the data.
+Login.DatabaseEngine=Database
+Login.DatabaseEngineTT = The database engine that contains the data.
 Login.DatabaseIdentifier = DB Id.
 Login.DatabaseIdentifierTT = The identifier of the database that is stored within the database engine.
+Login.DatabaseParameter=Parameter
+Login.DatabaseParameterTT=Some additional parameters the Plantlore server should use \nwhen connecting to the database, such as encoding.
+
 Login.DatabasePort = DB Port
 Login.DatabasePortTT = The port where the database engine listens.
 Login.Port = Port
@@ -451,9 +459,9 @@
 Login.Discard=Discard
 Login.DiscardTT=Discard the record.
 
-Login.AddTitle = Add record
+Login.AddTitle = Add a new record.
 Login.Add = Add
-Login.AddTT = Add this record.
+Login.AddTT = Add the record.
 Login.EditTitle = Edit record
 Login.Change = Change
 Login.ChangeTT = Change this record.
@@ -467,11 +475,12 @@
 
 Login.SelectAutomatically = Select automatically.
 
-Login.Connecting = Connecting to the server...
-Login.Connected = Connection successful.
-Login.InitializingDBLayer = Initializing database connection...
-Login.DBLayerInitialized = Database connection successful.
-Login.Failed = Login failed!
+Login.Connecting=Connecting to the server...
+Login.Connected=Connection successful.
+Login.ConnectionFailed=Unable to connect to the database.
+Login.InitializingDBLayer=Initializing database connection...
+Login.DBLayerInitialized=Database connection successful.
+Login.Failed=Login failed!
 
 
 
@@ -497,33 +506,20 @@
 # IMPORT
 #	net.sf.plantlore.client.imports
 #=============================================================
-Import.Title = Import
-Import.Failed = Import failed.
-Import.Initializing = Initializing...
-Import.Aborted = Import aborted.
-Import.Completed = Import completed.
-Import.DecisionExpected = Your intervention is required.
-Import.RememberDecision = Do not ask again.
-Import.RememberDecisionTT = Remember my decision and use it from now on.
-Import.RecordsInserted = inserted.
-Import.RecordsDeleted = deleted.
-Import.RecordsUpdated = updated.
-Import.RecordsRejected = rejected.
-Import.RecordsProcessed = processed.
-Import.Abort=Abort
-Import.Hide = Hide
-Import.Skip = Skip
-Import.Update = Update
-Import.Insert = Insert new
-Import.Replace = Replace
-Import.Progress = completed.
-Import.CompletelyCorruptedRecord = The record No. {0} is corrupted (cannot be parsed).
-Import.PartialyCorruptedRecord = The record No. {0} (UID = {1}:{2}) is corrupted.
-Import.IncompleteRecord = The record No. {0} is incomplete - some parts are missing.
-Import.DuplicateRecord = The record No. {0} (UID = {1}:{2}) is in the database several times!\nIt is not clear which record should be updated!
-Import.ProblematicRecord = The record No. {0} (UID = {1}:{2}) cannot be processed;
-Import.NoAuthorsLeft = The record No. {0} would have no authors at all.
-Import.UnknownReason = The reason is uknown.
+Import.Title=Import
+Import.Failed=Import failed.
+Import.Initializing=Initializing import...
+Import.Initialized=Initialized.
+Import.Aborted=Import aborted.
+Import.Completed=Import completed.
+Import.CanceledByUser=Canceled by the User.
+Import.CompletelyCorruptedRecord=The record No. {0} is corrupted (cannot be parsed).
+Import.IncompleteRecord=The record No. {0} is incomplete - some parts are missing.
+Import.UnableToProcess=The record No. {0} cannot be processed.
+Import.UnknownReason=The reason is uknown.
+Import.RecordsImported={0} records processed.
+Import.RecordsProcessed={0} records processed.
+Import.UpdatingEnvironment=Updating environment...
  
 
 #=============================================================
@@ -531,12 +527,12 @@
 #	net.sf.plantlore.client.export
 #=============================================================
 Export.Title = Export
+Export.TitleTT=Export the selected records.
 Export.Initializing = Initializing export. This may take a while.
 Export.Aborted = Aborted by User.
 Export.Completed = Completed!
 Export.Failed = Export failed
 Export.Abort = Abort
-Export.Hide = Hide
 Export.SelectColumns = Select Columns
 Export.RecordsExported = records exported.
 Export.Progress = records exported
@@ -549,28 +545,11 @@
 Format.StdOut = Standard Output
 
 
-
-Next = &Next
-Refresh = &Refresh
-RefreshTT = Reload the list of the connected clients.
-Kick = &Kick users
-KickTT = Disconnect the selected clients from the server.
-StopServer = Stop server
-TerminateServer = Terminate server
-TerminateServerTT = Switch off the server.
-SelectNew = Create and start &new server.
-SelectNewTT = Run a new server on the specified port\n protected by the given password.
-SelectExisting = Connect to an existing server.
-SelectExistingTT = Connect to an existing server on the host:port\n.  
-
-
-AutoSelect = select automatically 
-
 #=============================================================
 # RECORDS
 #	net.sf.plantlore.client.export.component.XTree
 #=============================================================
-XTree.Plantlore = Plantlore
+ExtendedTree.Plantlore = Plantlore
 
 Author = Author
 Author.wholeName = Name
@@ -671,13 +650,11 @@
 Territory = Territory
 Territory.name = Name
 
-Village = Village
-Village.name = Name
+NearestVillage = The nearest bigger seat
+NearestVillage.name = Name
 
 Record.Property = Property
 Record.Value = Value
-Record.InDatabase = In DB
-Record.FromFile = From File
 
 
 
@@ -713,28 +690,33 @@
 # ERRORS
 #=============================================================
 Error.General=An error occurred.
+Error.Internal=An internal error of the Application.
 Error.Fatal=A serious error occurred.
 
-Error.InvalidDBLayer = The database layer is not valid! 
-Error.InvalidBuilder = The supplied Builder is not valid!
-Error.InvalidResultset = The supplied result set identifier is not valid!
-Error.InvalidSelection = The supplied list of selected items is not valid!
-Error.InvalidQuery = The supplied select query is not valid!
-Error.InvalidFilter = The supplied file format is not valid!
-Error.InvalidChecklist = The checklist is not valid.
-Error.InvalidParser = The supplied parser is not valid!
-Error.InvalidUser =  The supplied user is not valid!
-Error.InvalidRootTable = The supplied root table is not valid!\n If you want to use projections,\n you must specify the root table.
-Error.InvalidRecord = The record is not valid!
+Error.InvalidDBLayer=The database layer is not valid! 
+Error.InvalidBuilder=The supplied Builder is not valid!
+Error.InvalidResultset=The supplied result set identifier is not valid!
+Error.InvalidSelection=The supplied list of selected items is not valid!
+Error.InvalidQuery=The supplied select query is not valid!
+Error.InvalidFilter=The supplied file format is not valid!
+Error.InvalidChecklist=The checklist is not valid.
+Error.InvalidParser=The supplied parser is not valid!
+Error.InvalidUser=The supplied user is not valid!
+Error.InvalidRootTable=The supplied root table is not valid!\n If you want to use projections,\n you must specify the root table.
+Error.InvalidRecord=The record is not valid!
+Error.InvalidFileName=The supplied name of the file is not valid.
 
 Error.UnhandledExceptionalState=The Application performed an illegal operation\nand it will be terminated.
 Error.ImproperUse=Internal error: The method is not used properly.
+Error.NoAuthorsLeft=Every occurrence data must have at least one author.\nThis one would have no authors left.
+Error.DeletingSharedRecord=The record {0} is shared by {1} records.
 
 Error.Missing=Missing information.
 Error.MissingFileName=The file name was not specified.
 Error.MissingUserName=You forget to enter the account name.
 Error.MissingCompulsoryFieldTitle=Missing compulsory field
 Error.MissingCompulsoryField=is a compulsory field. Please fill in it.
+Error.MissingSeveralCompulsoryFields=Some compulsory fields are not filled.
 Error.WriterNotCreated=Unable to create the output file writer.
 Error.NothingSelected=Nothing is selected.
 Error.NoColumnsSelected=No columns are selected.
@@ -743,11 +725,13 @@
 Error.LoginFailed=Login failed.
 Error.TransactionRaceConditions=The transaction could not be created.\n There is another transaction in progress already.
 Error.RecordNotFound=The record was not found.\n It cannot be entered into an immutable table.
-Error.FKIsNull=Some foreign keys are null! \n The record is incomplete.
+Error.FKIsNull=Some foreign keys are null.\nThe record is incomplete.
 Error.ReaderNotCreated=Unable to create the file reader.
 Error.FileFormatCorrupted=The format of the file is corrupted.
 Error.ThreadFailed=Unable to create a new thread!
 Error.IncorrectXMLFile=Incorrect XML file!\n
+Error.CorruptedRecord=The record is incomplete.\nSome parts are missing.
+Error.CorruptedFileFormat=The format of the file is corrupted.
 Error.DuplicateLogin=Login already exist. Please change it.
 Error.DuplicateLoginTitle=Incorrect data
 Error.DeletingSharedRecord=The {0} is shared by {1} other records.\nCannot delete.
@@ -756,8 +740,13 @@
 Error.GenericMessageTitle=Error
 Error.WrongAuthorizationKey=Incorrect authorization key.
 Error.TooManyConnections=Too many clients are already connected.
-
 Error.ConnectionLost=Connection lost
+Error.AmbiguousRecord=There are two or more identical records.\nIt is not sure which one should be processed.
+Error.TransactionRaceConditions=The operation cannot be performed.\nAnother operation is already in progress.
+Error.RecordNotFound=The record is not in the table {0}.
+Error.AmbiguousUniqueIdentifier=There are two or more records with the same unique identifier.\nIt is not sure which one should be processed.
+Error.DeletingSharedRecord=Unable to delete a shared record.
+Error.SloppyProgramming=The programmer made a mistake here.\nThis should not have happened.
 
 Error.Server.AccessDenied=Access denied - insufficient permissions.
 Error.Server.ConnectionRefused=Connection refused. Is the Server running?
@@ -766,7 +755,7 @@
 Error.Server.ObjectDoesNotExistAnymore=You have been disconnected from the server\nby its Administrator.
 Error.Server.InTrouble=The Server has crashed.
 Error.Server.StubNotFound=Some parts of the program are missing.
-Error.Server.UnexpectedProblem=
+Error.Server.UnexpectedProblem=An unexpected problem on the server.
 Error.Server.UnknownHost=Unknown host or IP address.
 Error.Server.UnmarshallingFailed=Unable to receive the data.\nDo you have the correct version?
 Error.Server.AlreadyBound=Another Server is already running on the specified port.
@@ -793,6 +782,13 @@
 DBLayer.Error.MaxConnections=Too many users are connected to the database.
 DBLayer.Error.Other=The reason is unknown.
 
+Error.IncorrectXMLFile=The file format is corrupted.
+Error.UnsupportedTable=You cannot import data to the table {0}.\nIt is not an immutable table.
+Error.EmptyXMLFile=There are no records in the file.
+Error.OutOfMemory=Not enough memory to perform the operation.
+Error.MissingUpdateRecord=Records in the UPDATE branch must come in pairs.
+Error.PartialyCorruptedRecord=The record is partially corrupted.
+
 #=============================================================
 # QUESTIONS
 #=============================================================
@@ -1386,16 +1382,29 @@
 
 Overview.MenuFileLogout=Logout
 
+Overview.MenuFileLogoutTT=Disconnect from the current database.
+
 Overview.MenuFileReconnect=Reconnect
 
 Overview.MenuFileLogoutTT=Logs out current session
 
 Overview.MenuFileReconnectTT=Tries to renew lost connection
 
+Overview.MenutFileExit=E&xit
+
 Overview.MenuFileExitTT=Exits the application
 
+Overview.TableImport=Table import
+
+Overview.TableImportTT=Alters records in an immutable table.
+
+Overview.MenuFileCreateDB=Create a new database
+
+Overview.MenuFileCreateDB=Creates a new database.
+
 Search.Extended=&Extended
 
+
 DBLayer.Error.Unspecified=There is no additional information regarding to the problem.
 DBLayer.Error.LoadConfig=Unable to load the database configuration file. 
 DBLayer.Error.Connect=Unable to connect to the database engine.\nIs it running?
@@ -1407,9 +1416,9 @@
 DBLayer.Error.Update=Ubable to update the record in the database.
 DBLayer.Error.Select=Unable to perform the selection.
 DBLayer.Error.LoadData=Unable to obtain the data.
-DBLayer.Error.Close=Unable to close something.
+DBLayer.Error.Close=Unable to close the connection.
 DBLayer.Error.Rights=Insufficient access rights.
-DBLayer.Error.DB=Something happened to the database, devil knows what.
+DBLayer.Error.DB=The datbase is not in a consistent state.
 DBLayer.Error.Transaction=Another transaction is already running.
 DBLayer.Error.Resources=Out of resources!
 DBLayer.Error.DiskFull=The disk is full.
@@ -1428,16 +1437,12 @@
 Overview.Transformation.Change=Change
 CreateDB.DatabaseSettings=Database engine settings
 
-CreateDB.TakeFrom=Use from
-
 CreateDB.NewDatabaseOptions=Options
 
 CreateDB.LeaveEmpty=Leave the database empty (do not add plants, villages, etc.)
 
 CreateDB.Create=Create
 
-CreateDB.TakeFromTT=Use the same dat as in the item from the Login.
-
 CreateDB.LeaveEmptyTT=May be handy for someone who doesn't wish to polute the database \nwith the names of Czech villages, territories, etc.
 
 CreateDB.Title=Create a new database
@@ -1477,3 +1482,7 @@
 collectionNameTitle=Collection name
 
 Server.Continue=Continue
+
+Login.UserNameTT=The name of the account in the database.
+
+Login.PasswordTT=The password protecting the account.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 17:34:37 UTC (rev 647)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 22:04:51 UTC (rev 648)
@@ -52,7 +52,6 @@
 
 Next = &Pokracovat
 Refresh = &Obnovit
-Kick = &Vykopnout uzivatele
 StopServer = Stopnout server
 TerminateServer = Ukoncit server
 SelectNew = Vytvor a spust novy server.
@@ -520,11 +519,11 @@
 
 Common.Ok=&Ok
 
-Continue=
+Continue=Pokra\u010Duj
 
 Common.Cancel=&Storno
 
-Close=
+Close=Zav\u0159\u00EDt
 
 Settings.Czech=\u010cesk\u00fd
 
@@ -830,19 +829,19 @@
 
 Detail.PlaceDescriptionTitle=Place description
 
-AddEdit.InsufficientEditRights=You don't have sufficient rights to edit this record.
+AddEdit.InsufficientEditRights=Pro editaci z\u00E1znamu nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED.
 
-AddEdit.InsufficientAddRights=You don't have sufficient rights to add new records.
+AddEdit.InsufficientAddRights=Pro p\u0159id\u00E1n\u00ED z\u00E1znamu nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED.
 
-AddEdit.InsufficientRightsTitle=Insufficient rights
+AddEdit.InsufficientRightsTitle=Nedostate\u010Dn\u00E1 pr\u00E1va
 
-Message.CheckAnOccurrence=Check at least one occurrence, please.
+Message.CheckAnOccurrence=Vyberte pros\u00EDm alespo\u0148 jeden z\u00E1znam.
 
-Message.CheckAnOccurrenceTitle=No record checked
+Message.CheckAnOccurrenceTitle=Nevybr\u00E1ny \u017E\u00E1fn\u00E9 z\u00E1znamy
 
-Delete.InsufficientRights=You don't have sufficient rights to delete all the checked records.
+Delete.InsufficientRights=Pro vymaz\u00E1n\u00ED z\u00E1znamu nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED.
 
-Delete.InsufficientRightsTitle=Insufficient rights
+Delete.InsufficientRightsTitle=Nedostate\u010Dn\u00E1 pr\u00E1va
 
 Settings.GeneralTab=Obecn\u00E9
 
@@ -990,7 +989,7 @@
 
 Import.RecordsRejected=zam\u00EDtnuto.
 
-Import.RecordsProcessed=zpracov\u00E1no.
+Import.RecordsProcessed={0} z\u00E1znam\u016F zpracov\u00E1no.
 
 Import.Abort=Zru\u0161it
 
@@ -1236,8 +1235,6 @@
 
 Warning.EmptySelectionTitle=Pr\u00E1zdn\u00FD v\u00FDb\u011Br...
 
-Server.Login=P\u0159ihl\u00E1\u0161en\u00ED
-
 Server.Host=Host
 
 Server.Next=P\u0159ipojit
@@ -1326,7 +1323,7 @@
 
 Server.Info.ClientKicked=Klient {0} byl odpojen.
 
-Server.Info.Terminated=Server byl ukon\u010Den (klienti byli odpojeni).
+Server.Info.Terminated=Server byl zastaven.
 
 Question.AbortExport=Export bude zru\u0161en.
 
@@ -1687,3 +1684,201 @@
 Common.Ascending=Vzestupn\u011B
 
 Common.Descending=Sestupn\u011B
+
+Other=Jin\u00FD
+
+ContinueTT=Pokra\u010Duj v dan\u00E9 operaci.
+
+Common.CancelTT=Zru\u0161 prov\u00E1d\u011Bnou operaci.
+
+Common.Canceled=Operace zru\u0161ena.
+
+defaultLang=Implicitn\u00ED jazykov\u00E1 mutace
+
+Login.LocalDatabase=Lok\u00E1ln\u00ED datab\u00E1ze
+
+Login.RemoteDatabase=Vzd\u00E1len\u00E1 datab\u00E1ze
+
+Login.DatabaseEngine=Db. stroj
+
+Login.DatabaseEngineTT=Datab\u00E1zov\u00FD stroj na n\u011Bm\u017E jsou ulo\u017Eeny datab\u00E1ze Plantlore.
+
+Login.DatabaseParameter=Parametr
+
+Login.DatabaseParameterTT=Dodate\u010Dn\u00E9 informace, kter\u00E9 mohou b\u00FDt vyu\u017Eity p\u0159i p\u0159ipojov\u00E1n\u00ED (nap\u0159. k\u00F3dov\u00E1n\u00ED \u010De\u0161tiny).
+
+Login.ConnectionFailed=P\u0159ipojen\u00ED se nezda\u0159ilo.
+
+Import.Initialized=Inicializace prob\u011Bhla \u00FAsp\u011B\u0161n\u011B.
+
+Import.CanceledByUser=Zru\u0161eno u\u017Eivatelem.
+
+Import.UnableToProcess=Z\u00E1znam \u010D. {0} nelze zpracovat.
+
+Import.RecordsImported={0} z\u00E1znam\u016F zpracov\u00E1no
+
+Import.UpdatingEnvironment=Aktualizace prost\u0159ed\u00ED
+
+Export.TitleTT=Export vybran\u00FDch z\u00E1znam\u016F.
+
+ExtendedTree.Plantlore=Plantlore
+
+NearestVillage=Nejbli\u017E\u0161\u00ED v\u011Bt\u0161\u00ED s\u00EDdlo
+
+NearestVillage.name=Jm\u00E9no
+
+Error.General=Chyba
+
+Error.Internal=Vnit\u0159n\u00ED\u00ED chyba aplikace
+
+Error.Fatal=Z\u00E1va\u017En\u00E1 chyba
+
+Error.InvalidFileName=Neplatn\u00E9 jm\u00E9no souboru.
+
+Error.UnhandledExceptionalState=Neo\u0161et\u0159en\u00FD vyj\u00EDme\u010Dn\u00FD stav. Aplikace nem\u016F\u017Ee d\u00E1le pokra\u010Dovat.
+
+Error.ImproperUse=Vnit\u0159n\u00ED chyba aplikace\: Nespr\u00E1vn\u00E9 pou\u017Eit\u00ED metody.
+
+Error.NoAuthorsLeft=N\u00E1lezov\u00E1 data mus\u00ED m\u00EDt alespo\u0148 jednoho autora.\nTomuto z\u00E1znamu by autor chyb\u011Bl.
+
+Error.MissingSeveralCompulsoryFields=N\u011Bkolik povinn\u00FDch polo\u017Eek nen\u00ED vypln\u011Bno.
+
+Error.CorruptedRecord=Ne\u00FApln\u00FD z\u00E1znam. N\u011Bkter\u00E9 \u010D\u00E1sti chyb\u00ED.
+
+Error.CorruptedFileFormat=Neplatn\u00FD form\u00E1t souboru.
+
+Error.UnableToProcess=Z\u00E1znam \u010D. {0} nen\u00ED mo\u017En\u00E9 zpracovat.
+
+Error.GenericMessageTitle=Chyba
+
+Error.WrongAuthorizationKey=Neplatn\u00E9 autoriza\u010Dn\u00ED \u00FAdaje.
+
+Error.TooManyConnections=P\u0159ipojeno p\u0159\u00EDli\u0161 mnoho klient\u016F.
+
+Error.ConnectionLost=P\u0159ipojen\u00ED bylo ztraceno
+
+Error.AmbiguousRecord=V datab\u00E1zi se nach\u00E1z\u00ED n\u011Bkolik identick\u00FDch z\u00E1znam\u016F.\nNen\u00ED jasn\u00E9, kter\u00FD z\u00E1znam m\u00E1 b\u00FDt zpracov\u00E1n.
+
+Error.AmbiguousUniqueIdentifier=Nejednozna\u010Dn\u00FD unik\u00E1tn\u00ED identifik\u00E1tor\nNen\u00ED jasn\u00E9, kter\u00FD z\u00E1znam m\u00E1 b\u00FDt zpracov\u00E1n.
+
+Error.DeletingSharedRecord=Nelze smazat z\u00E1znam, kter\u00FD je sd\u00EDlen jin\u00FDmi z\u00E1znamy.
+
+Error.SloppyProgramming=Program\u00E1torsk\u00E1 chyba - tento k\u00F3d by se nem\u011Bl volat.
+
+Error.Server.AccessDenied=P\u0159\u00EDstup zam\u00EDtnut - nedostate\u010Dn\u00E1 p\u0159\u00EDstupov\u00E1 pr\u00E1va.
+
+Error.Server.ConnectionRefused=Spojen\u00ED se nezda\u0159ilo. Je server spu\u0161t\u011Bn?
+
+Error.Server.ExportFailed=Nezda\u0159ilo se zaregistrovat objekt pro vzd\u00E1lenou komunikaci.
+
+Error.Server.MarshallingFailed=Nen\u00ED mo\u017En\u00E9 odeslat data. M\u00E1te spr\u00E1vnou verzi programu?
+
+Error.Server.ObjectDoesNotExistAnymore=Byli jste odpojeni od serveru jeho Administr\u00E1torem.
+
+Error.Server.InTrouble=Chyba na stran\u011B serveru.
+
+Error.Server.StubNotFound=Nebylo mo\u017En\u00E9 nal\u00E9zt n\u011Bkter\u00E9 \u010D\u00E1sti programu.
+
+Error.Server.UnexpectedProblem=Neo\u010Dek\u00E1van\u00E1 chyba na stran\u011B serveru.
+
+Error.Server.UnknownHost=Nezn\u00E1m\u00FD host nebo IP adresa.
+
+Error.Server.UnmarshallingFailed=Nen\u00ED mo\u017En\u00E9 p\u0159ijmout data. M\u00E1te spr\u00E1vnou verzi programu?
+
+Error.Server.AlreadyBound=Na zvolen\u00E9m portu ji\u017E b\u011B\u017E\u00ED jin\u00FD server.
+
+Error.Server.NotBound=Na zvolen\u00E9m portu \u017E\u00E1dn\u00FD server neb\u011B\u017E\u00ED.
+
+Error.UnsupportedTable=Do tabulky {0} nelze vkl\u00E1dat data.
+
+Error.EmptyXMLFile=Soubor neobsahuje \u017E\u00E1dn\u00E9 z\u00E1znamy.
+
+Error.OutOfMemory=Nedostatek pam\u011Bti pro proveden\u00ED po\u017Eadovan\u00E9 operace.
+
+Error.MissingUpdateRecord=Z\u00E1znamy ur\u010Den\u00E9 k aktualizaci mus\u00ED b\u00FDt v p\u00E1rech.
+
+Error.PartialyCorruptedRecord=Z\u00E1znam je ne\u010Diteln\u00FD, nen\u00ED mo\u017En\u00E9 jej zpracovat.
+
+Server.HostTT=Jm\u00E9no nebo IP adresa po\u010D\u00EDta\u010De, na kter\u00E9m je spu\u0161t\u011Bn Server.
+
+Server.ContinueTT=Prov\u00E9st po\u017Eadovanou operaci.
+
+Server.ConnectToSettings=Nastaven\u00ED p\u0159ipojen\u00ED
+
+Server.CreateNewServer=Spustit nov\u00FD Server
+
+Server.ConnectToRunningServer=P\u0159ipojit se k Serveru
+
+Server.Info.ObtainingClients=Prob\u00EDh\u00E1 obnoven\u00ED seznamu klient\u016F...
+
+Server.Info.KickingClient=Prob\u00EDh\u00E1 odpojov\u00E1n\u00ED klienta.
+
+Server.Info.TerminatingServer=Prob\u00EDh\u00E1 zastavov\u00E1n\u00ED serveru...
+
+Overview.MenuFileLogout=Odpojit
+
+Overview.MenutFileExit=Konec
+
+Overview.TableImport=Import do tabulek
+
+Overview.TableImportTT=Zm\u011Bn\u00ED z\u00E1znamy ve vybran\u00FDch tabulk\u00E1ch.
+
+Overview.MenuFileCreateDB=Vytvo\u0159it novou datab\u00E1zi
+
+CreateDB.DatabaseSettings=Nastaven\u00ED datab\u00E1ze
+
+CreateDB.NewDatabaseOptions=Nastaven\u00ED
+
+CreateDB.LeaveEmpty=Nech datab\u00E1zi pr\u00E1zdnou.
+
+CreateDB.Create=Vytvo\u0159it
+
+CreateDB.LeaveEmptyTT=Nenaplni datab\u00E1zi po\u010D\u00E1te\u010Dn\u00EDmi daty (rostlinami, vesnicemi, fytochoriony, ..)
+
+CreateDB.Title=Vytvo\u0159 novou datab\u00E1zi
+
+Server.Continue=Pokra\u010Dovat
+
+Login.UserNameTT=N\u00E1zev u\u017Eivatelsk\u00E9ho \u00FA\u010Dtu k datab\u00E1zi.
+
+Login.PasswordTT=Heslo chr\u00E1n\u00EDc\u00ED tento \u00FA\u010Det.
+
+DBLayer.Error.Unspecified=O probl\u00E9mu nejsou zn\u00E1my dal\u0161\u00ED informace.
+
+DBLayer.Error.LoadConfig=Nepoda\u0159ilo se na\u010D\u00EDst konfigura\u010Dn\u00ED soubory datab\u00E1ze.
+
+DBLayer.Error.Connect=Nepoda\u0159ilo se p\u0159ipojit k datab\u00E1zi.\nJe datab\u00E1ze spu\u0161t\u011Bna.
+
+DBLayer.Error.Login=Autorizace se nezda\u0159ila. Neplatn\u00E9 jm\u00E9no nebo heslo
+
+DBLayer.Error.Username=Neexistuj\u00EDc\u00ED u\u017Eivatelsk\u00E9 jm\u00E9no.
+
+DBLayer.Error.Password=Neplatn\u00E9 heslo.
+
+DBLayer.Error.Save=Nepoda\u0159ilo se vlo\u017Eit data do datab\u00E1ze.
+
+DBLayer.Error.Delete=Nepoda\u0159ilo se vymazat data z datab\u00E1ze.
+
+DBLayer.Error.Update=Nepoda\u0159ilo se aktualizovat z\u00E1znam v datab\u00E1zi.
+
+DBLayer.Error.Select=Nepoda\u0159ilo se prov\u00E9st v\u00FDb\u011Br dat.
+
+DBLayer.Error.LoadData=Nepoda\u0159ilo se z\u00EDskat data z datab\u00E1ze.
+
+DBLayer.Error.Close=Nepoda\u0159ilo se uzav\u0159\u00EDt p\u0159ipojen\u00ED k datab\u00E1zi.
+
+DBLayer.Error.Rights=Nedosta\u010Duj\u00EDc\u00ED p\u0159\u00EDstupov\u00E1 pr\u00E1va.
+
+DBLayer.Error.DB=Datab\u00E1ze je v nekonsistentn\u00EDm stavu.
+
+DBLayer.Error.Transaction=Pr\u00E1v\u011B prob\u00EDh\u00E1 jin\u00E1 transakce.
+
+DBLayer.Error.Resources=Nedostatek syst\u00E9mov\u00FDch prost\u0159edk\u016F.
+
+DBLayer.Error.DiskFull=Pevn\u00FD disk je pln\u00FD.
+
+DBLayer.Error.OutOfMemory=Nedostatek pam\u011Bti.
+
+DBLayer.Error.MaxConnections=P\u0159ekro\u010Den maxim\u00E1ln\u00ED po\u010Det u\u017Eivatel\u016F.
+
+DBLayer.Error.Other=Operaci nelze prov\u00E9st.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-03 17:34:37 UTC (rev 647)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-03 22:04:51 UTC (rev 648)
@@ -306,29 +306,21 @@
 # EXPORT | IMPORT
 FilterPlantloreNative = Plantlore native (for future import)
 FilterXML = Extensible Markup Language (XML)
-FilterCSV = Comma Separated Value (CSV)
 FilterABCD = ABCD Schema native
 FilterDC = DarwinCore native
 FilterConsole = Console output
 
-Export = Export
-ExportColumns = Select columns you want to export
 
-
 import.Title = Import
 import.Failed = Import failed.
 import.Initializing = Initializing...
 import.Aborted = Import aborted.
-import.Completed = Import completed.
 import.DecisionExpected = Your intervention is required.
 import.RememberDecision = Do not ask me again.
 import.RecordsImported = records imported.
 import.RecordsRejected = records rejected.
-import.Abort = Abort
-import.Hide = Hide
 import.Skip = Skip
 import.Update = Update
-import.Insert = Insert new
 import.Replace = Replace
 
 
@@ -339,15 +331,12 @@
 Next = &Next
 Refresh = &Refresh
 RefreshTT = Reload the list of the connected clients.
-Kick = &Kick users
-KickTT = Disconnect the selected clients from the server.
 StopServer = Stop server
 TerminateServer = Terminate server
 TerminateServerTT = Switch off the server.
 SelectNew = Create and start &new server.
 SelectNewTT = Run a new server on the specified port\n protected by the given password.
 SelectExisting = Connect to an existing server.
-SelectExistingTT = Connect to an existing server on the host:port\n.  
 
 
 AutoSelect = select automatically 
@@ -375,19 +364,11 @@
 
 errorCertificationException = The certification failed - the password is incorrect.\n Please type the password again.
 errorCertificationExceptionTitle = Certification failure!
-
-
-
-error.InvalidDBLayer = The database layer is not valid! \n The DBLayer cannot be null.
-error.InvalidParser = The Parser is not valid! \n The Parser cannot be null.
-error.InvalidUser = The User is not valid! \n The User cannot be null.
 error.RecordNotFound = No matching record was found!
 error.FKIsNull = The foreign key is not set!
 error.ReaderNotCreated = Unable to create a new reader!
-error.MissingFileName = The name of the file is missing!
 error.ThreadFailed = Unable to create a new thread!
 error.NothingSelected = Nothing is selected!
-error.ImportFailed = Import failed!\n
 Error.IncorrectXMLFile = Incorrect XML file!\n
 
 
@@ -1239,3 +1220,19 @@
 Common.Ascending=Ascending
 
 Common.Descending=Descending
+
+Common.CancelTT=Cancel the current operation.
+
+Common.Canceled=The operation was cancelled.
+
+Login.LocalDatabase=Local database
+
+Login.RemoteDatabase=Remote database
+
+Login.Alias=Alias
+
+Login.AliasTT=The string that will be displayed to you.
+
+Login.HostName=Hostname
+
+Login.HostNameTT=The name of the computer where the server dwells.



From krater at mail.berlios.de  Mon Sep  4 00:17:16 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 00:17:16 +0200
Subject: [Plantlore-dev] r649 - in trunk/src/net/sf/plantlore: client
	client/checklist client/createdb client/export client/login
	client/tableimport client/tableimport/parsers common l10n
	server server/manager
Message-ID: <200609032217.k83MHGH9015576@sheep.berlios.de>

Author: krater
Date: 2006-09-04 00:17:09 +0200 (Mon, 04 Sep 2006)
New Revision: 649

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
   trunk/src/net/sf/plantlore/client/login/AuthView.java
   trunk/src/net/sf/plantlore/client/login/ItemView2.form
   trunk/src/net/sf/plantlore/client/login/ItemView2.java
   trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
   trunk/src/net/sf/plantlore/client/login/LoginView.form
   trunk/src/net/sf/plantlore/client/login/LoginView.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
   trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/server/Plantlore.java
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
Log:
AppCore: Proper handling of the CreateNewDatabase Action - the dialog was not opened.

Help + Cancel buttons + Escape Handler added to my dialogs.

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -414,7 +414,7 @@
 		dataHistoryAction.setEnabled(enabled);
 		dataWholeHistoryAction.setEnabled(enabled);
 		dataUserAction.setEnabled(enabled);
-                createNewDatabaseAction.setEnabled(enabled);
+                createNewDatabaseAction.setEnabled(!enabled);
 
 		historyAction.setEnabled(enabled);
 		schedaAction.setEnabled(enabled);
@@ -1535,7 +1535,7 @@
 				newDBView = new CreateDBView(view, newDBModel);
 				newDBCtrl = new CreateDBCtrl(newDBModel, newDBView);
 			}
-                        view.setVisible(true);
+			newDBView.setVisible(true);
 		}
 	}
 

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -11,6 +11,7 @@
 
 import net.sf.plantlore.client.resources.Resource;
 import net.sf.plantlore.common.AutoTextArea;
+import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -38,6 +39,7 @@
 		view.clear.setAction(new ClearSelection());
 		view.submit.setAction(new Submit());
 		view.restore.setAction(new Restore());
+		view.cancel.setAction( new DefaultCancelAction(view) );
 		
 		model.addPropertyChangeListener(
 				AutoTextArea.ALLOWED_VALUES_CHANGED,

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -22,9 +22,13 @@
       <Group type="103" groupAlignment="0" attributes="0">
           <Component id="jToolBar1" alignment="0" pref="400" max="32767" attributes="0"/>
           <Group type="102" alignment="1" attributes="0">
-              <EmptySpace pref="325" max="32767" attributes="0"/>
-              <Component id="submit" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
+              <Component id="help" min="-2" max="-2" attributes="0"/>
+              <EmptySpace pref="171" max="32767" attributes="0"/>
+              <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="submit" linkSize="1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
           </Group>
           <Group type="102" alignment="0" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
@@ -40,7 +44,11 @@
               <EmptySpace max="-2" attributes="0"/>
               <Component id="scrollpane" pref="229" max="32767" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="submit" min="-2" max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="submit" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+              </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
@@ -124,5 +132,25 @@
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JButton" name="help">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Help" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -5,6 +5,8 @@
 import javax.swing.JFileChooser;
 
 import net.sf.plantlore.common.AutoTextArea;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -28,6 +30,11 @@
         initComponents();
         choice = new JFileChooser();
         setLocationRelativeTo(null);
+        
+        PlantloreHelp.addKeyHelp(PlantloreHelp.ADD_CHECKLIST, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.ADD_CHECKLIST, this.help);
+        
+        new DefaultEscapeKeyPressed( this );
     }
     
     /** This method is called from within the constructor to
@@ -45,6 +52,8 @@
         scrollpane = new javax.swing.JScrollPane();
         checklist = new Checklist( model.getAllowedValues() );
         submit = new javax.swing.JButton();
+        cancel = new javax.swing.JButton();
+        help = new javax.swing.JButton();
 
         setTitle(L10n.getString("Checklist.Title"));
         setModal(true);
@@ -64,13 +73,21 @@
 
         submit.setText(L10n.getString("Checklist.Submit"));
 
+        cancel.setText(L10n.getString("Common.Cancel"));
+
+        help.setText(L10n.getString("Common.Help"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jToolBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 400, Short.MAX_VALUE)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                .addContainerGap(325, Short.MAX_VALUE)
+                .addContainerGap()
+                .add(help)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
+                .add(cancel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(submit)
                 .addContainerGap())
             .add(layout.createSequentialGroup()
@@ -78,6 +95,9 @@
                 .add(scrollpane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {cancel, submit}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
@@ -85,7 +105,10 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(scrollpane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 229, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(submit)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(submit)
+                    .add(cancel)
+                    .add(help))
                 .addContainerGap())
         );
         pack();
@@ -94,8 +117,10 @@
     
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
     protected javax.swing.JList checklist;
     protected javax.swing.JButton clear;
+    protected javax.swing.JButton help;
     private javax.swing.JToolBar jToolBar1;
     protected javax.swing.JButton load;
     protected javax.swing.JButton restore;

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -2,6 +2,7 @@
 
 import java.awt.event.ActionEvent;
 
+import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
@@ -21,6 +22,8 @@
 	public CreateDBAuthCtrl(CreateDB createModel, CreateDBAuthView authView) {
 		this.model = createModel; 
 		this.view = authView;
+		
+		view.cancel.setAction( new DefaultCancelAction(view) );
 
 		view.create.setAction(new StandardAction("CreateDB.Create") {
 			public void actionPerformed(ActionEvent arg0) {

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -1,6 +1,6 @@
 <?xml version="1.0" encoding="UTF-8" ?>
 
-<Form version="1.3" type="org.netbeans.modules.form.forminfo.JFrameFormInfo">
+<Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
   </SyntheticProperties>
@@ -28,7 +28,11 @@
                           <Component id="password" alignment="0" pref="208" max="32767" attributes="0"/>
                       </Group>
                   </Group>
-                  <Component id="create" alignment="1" min="-2" max="-2" attributes="0"/>
+                  <Group type="102" alignment="1" attributes="0">
+                      <Component id="cancel" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="create" linkSize="3" min="-2" max="-2" attributes="0"/>
+                  </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -48,7 +52,10 @@
                   <Component id="password" linkSize="2" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="32767" attributes="0"/>
-              <Component id="create" min="-2" max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="create" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
+              </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
@@ -70,6 +77,11 @@
       </Properties>
     </Component>
     <Component class="javax.swing.JPasswordField" name="password">
+      <Properties>
+        <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.PasswordTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
@@ -85,9 +97,24 @@
       </AuxValues>
     </Component>
     <Component class="javax.swing.JTextField" name="user">
+      <Properties>
+        <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.UserNameTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -5,6 +5,8 @@
 import java.util.Observer;
 
 import net.sf.plantlore.client.login.DBInfo;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -24,6 +26,13 @@
         
         setLocationRelativeTo(null); // center of the screen
         getRootPane().setDefaultButton(create);
+        /*
+        PlantloreHelp.addKeyHelp(PlantloreHelp.CREATE_DB, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.CREATE_DB, this.help);
+        */
+        new DefaultEscapeKeyPressed( this );
+        
+        DocumentSizeFilter.patch(password, 20);
     }
 
     
@@ -39,13 +48,20 @@
         password = new javax.swing.JPasswordField();
         create = new javax.swing.JButton();
         user = new javax.swing.JTextField();
+        cancel = new javax.swing.JButton();
 
         jLabel1.setText(L10n.getString("Login.UserName"));
 
         jLabel2.setText(L10n.getString("Login.Password"));
 
+        password.setToolTipText(L10n.getString("Login.PasswordTT"));
+
         create.setText(L10n.getString("CreateDB.Create"));
 
+        user.setToolTipText(L10n.getString("Login.UserNameTT"));
+
+        cancel.setText(L10n.getString("Common.Cancel"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -61,9 +77,15 @@
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(user, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 208, Short.MAX_VALUE)
                             .add(password, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 208, Short.MAX_VALUE)))
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, create))
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                        .add(cancel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(create)))
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {cancel, create}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
@@ -76,7 +98,9 @@
                     .add(jLabel2)
                     .add(password, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .add(create)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(create)
+                    .add(cancel))
                 .addContainerGap())
         );
 
@@ -88,6 +112,7 @@
 
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
     protected javax.swing.JButton create;
     private javax.swing.JLabel jLabel1;
     private javax.swing.JLabel jLabel2;

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -4,6 +4,7 @@
 
 import javax.swing.JOptionPane;
 
+import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
 
@@ -31,6 +32,8 @@
 		authView = new CreateDBAuthView( view, model );
 		/*authCtrl =*/ new CreateDBAuthCtrl( model, authView );
 		
+		view.cancel.setAction( new DefaultCancelAction(view) );
+		
 		view.next.setAction( new StandardAction("Login.Next") {
 			public void actionPerformed(ActionEvent arg0) {
 				String 

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -24,7 +24,13 @@
               <Group type="103" groupAlignment="1" attributes="0">
                   <Component id="jPanel2" alignment="0" max="32767" attributes="0"/>
                   <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
-                  <Component id="next" alignment="1" min="-2" max="-2" attributes="0"/>
+                  <Group type="102" alignment="1" attributes="0">
+                      <Component id="help" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="128" max="32767" attributes="0"/>
+                      <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                  </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -38,7 +44,11 @@
               <EmptySpace max="-2" attributes="0"/>
               <Component id="jPanel2" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
-              <Component id="next" min="-2" max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+              </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
@@ -235,6 +245,11 @@
           </Properties>
         </Component>
         <Component class="javax.swing.JTextField" name="databaseAlias">
+          <Properties>
+            <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.AliasTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+            </Property>
+          </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
@@ -251,5 +266,25 @@
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JButton" name="help">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Help" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -5,6 +5,9 @@
 import java.util.Observer;
 
 import net.sf.plantlore.client.login.DBInfo;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DocumentSizeFilter;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -25,6 +28,16 @@
     	
         setLocationRelativeTo(null); // center of the screen
         getRootPane().setDefaultButton(next);
+        /*
+        PlantloreHelp.addKeyHelp(PlantloreHelp.CREATE_DB, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.CREATE_DB, this.help);
+        */
+        new DefaultEscapeKeyPressed( this );
+        
+        DocumentSizeFilter.patch(databaseAlias, 50);
+        DocumentSizeFilter.patch(databaseEngine, 30);
+        DocumentSizeFilter.patch(databaseIdentifier, 30);
+        DocumentSizeFilter.patch(databasePort, 5);
     }
     
     /** This method is called from within the constructor to
@@ -46,6 +59,8 @@
         jLabel5 = new javax.swing.JLabel();
         databaseAlias = new javax.swing.JTextField();
         next = new javax.swing.JButton();
+        cancel = new javax.swing.JButton();
+        help = new javax.swing.JButton();
 
         setTitle(L10n.getString("CreateDB.Title"));
         jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("CreateDB.DatabaseSettings")));
@@ -97,6 +112,8 @@
 
         jLabel5.setText(L10n.getString("Login.Alias"));
 
+        databaseAlias.setToolTipText(L10n.getString("Login.AliasTT"));
+
         org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
         jPanel2.setLayout(jPanel2Layout);
         jPanel2Layout.setHorizontalGroup(
@@ -134,6 +151,10 @@
 
         next.setText(L10n.getString("Login.Next"));
 
+        cancel.setText(L10n.getString("Common.Cancel"));
+
+        help.setText(L10n.getString("Common.Help"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -143,9 +164,17 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                     .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(next))
+                    .add(layout.createSequentialGroup()
+                        .add(help)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 128, Short.MAX_VALUE)
+                        .add(cancel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(next)))
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {cancel, next}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
@@ -154,7 +183,10 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .add(next)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(next)
+                    .add(cancel)
+                    .add(help))
                 .addContainerGap())
         );
         pack();
@@ -163,10 +195,12 @@
 
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
     protected javax.swing.JTextField databaseAlias;
     protected javax.swing.JComboBox databaseEngine;
     protected javax.swing.JTextField databaseIdentifier;
     protected javax.swing.JTextField databasePort;
+    protected javax.swing.JButton help;
     private javax.swing.JLabel jLabel1;
     private javax.swing.JLabel jLabel2;
     private javax.swing.JLabel jLabel4;

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -8,6 +8,7 @@
 import javax.swing.filechooser.FileFilter;
 
 import net.sf.plantlore.client.export.component.FileFormat;
+import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultProgressBarEx;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
@@ -38,6 +39,7 @@
 		
 		viewB = new ExportMngViewB(view);
 		viewB.next.setAction( new NextAction() );
+		viewB.cancel.setAction( new DefaultCancelAction(view) );
 		choice = new JFileChooser();
 		choice.setAcceptAllFileFilterUsed(false);
 		for( FileFilter filter: model.getFileFormats() )

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -23,7 +23,13 @@
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="0" attributes="0">
                   <Component id="jScrollPane1" pref="380" max="32767" attributes="0"/>
-                  <Component id="next" alignment="1" min="-2" max="-2" attributes="0"/>
+                  <Group type="102" alignment="1" attributes="0">
+                      <Component id="help" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="171" max="32767" attributes="0"/>
+                      <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                  </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -35,7 +41,11 @@
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Component id="jScrollPane1" pref="229" max="32767" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="next" min="-2" max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+              </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
@@ -48,7 +58,7 @@
       <SubComponents>
         <Component class="javax.swing.JTree" name="tree">
           <AuxValues>
-            <AuxValue name="JavaCodeGenerator_CreateCodeCustom" type="java.lang.String" value="new XTree();"/>
+            <AuxValue name="JavaCodeGenerator_CreateCodeCustom" type="java.lang.String" value="new ExtendedTree();"/>
             <AuxValue name="JavaCodeGenerator_InitCodePost" type="java.lang.String" value="tree.setSelectionModel( tsm );"/>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
@@ -65,5 +75,25 @@
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JButton" name="help">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Help" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -10,6 +10,8 @@
 
 import net.sf.plantlore.client.export.component.ProjectionSelectionModel;
 import net.sf.plantlore.client.export.component.ExtendedTree;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -30,6 +32,11 @@
         initComponents();
         getRootPane().setDefaultButton(next);
         setLocationRelativeTo(null); // center of the screen
+                
+        PlantloreHelp.addKeyHelp(PlantloreHelp.EXPORT, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.EXPORT, this.help);
+        
+        new DefaultEscapeKeyPressed( this );
     }
     
     /** This method is called from within the constructor to
@@ -42,6 +49,8 @@
         jScrollPane1 = new javax.swing.JScrollPane();
         tree = new ExtendedTree();
         next = new javax.swing.JButton();
+        cancel = new javax.swing.JButton();
+        help = new javax.swing.JButton();
 
         setTitle(L10n.getString("Export.SelectColumns"));
         tree.setSelectionModel( tsm );
@@ -49,6 +58,10 @@
 
         next.setText(L10n.getString("Export.Title"));
 
+        cancel.setText(L10n.getString("Common.Cancel"));
+
+        help.setText(L10n.getString("Common.Help"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -57,16 +70,27 @@
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, next))
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                        .add(help)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
+                        .add(cancel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(next)))
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {cancel, next}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 229, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(next)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(next)
+                    .add(cancel)
+                    .add(help))
                 .addContainerGap())
         );
         pack();
@@ -75,6 +99,8 @@
     
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
+    protected javax.swing.JButton help;
     private javax.swing.JScrollPane jScrollPane1;
     protected javax.swing.JButton next;
     protected javax.swing.JTree tree;

Modified: trunk/src/net/sf/plantlore/client/login/AuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -6,6 +6,8 @@
 import java.util.Observer;
 
 import net.sf.plantlore.common.AutoComboBox;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 
@@ -28,6 +30,10 @@
         initComponents();
         getRootPane().setDefaultButton(next);
         setLocationRelativeTo(null); // center of the screen
+        
+        new DefaultEscapeKeyPressed( this );
+        
+        DocumentSizeFilter.patch(password, 20);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/client/login/ItemView2.form
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemView2.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/ItemView2.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -23,7 +23,7 @@
                   <Component id="jTabbedPane1" alignment="1" pref="380" max="32767" attributes="0"/>
                   <Group type="102" alignment="0" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="175" max="32767" attributes="0"/>
+                      <EmptySpace pref="171" max="32767" attributes="0"/>
                       <Component id="discard" linkSize="3" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
@@ -60,7 +60,7 @@
         <Container class="javax.swing.JPanel" name="jPanel1">
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="Direct connection (local)">
+              <JTabbedPaneConstraints tabName="Local connection">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
                   <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.LocalDatabase" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
@@ -82,11 +82,11 @@
                       </Group>
                       <EmptySpace max="-2" attributes="0"/>
                       <Group type="103" groupAlignment="0" attributes="0">
-                          <Component id="databaseParameter" alignment="0" pref="270" max="32767" attributes="0"/>
-                          <Component id="databasePort" alignment="0" pref="270" max="32767" attributes="0"/>
-                          <Component id="databaseIdentifier" alignment="0" pref="270" max="32767" attributes="0"/>
-                          <Component id="databaseEngine" alignment="0" pref="270" max="32767" attributes="0"/>
-                          <Component id="aliasLocal" alignment="0" pref="270" max="32767" attributes="0"/>
+                          <Component id="databaseParameter" alignment="0" pref="301" max="32767" attributes="0"/>
+                          <Component id="databasePort" alignment="0" pref="301" max="32767" attributes="0"/>
+                          <Component id="databaseIdentifier" alignment="0" pref="301" max="32767" attributes="0"/>
+                          <Component id="databaseEngine" alignment="0" pref="301" max="32767" attributes="0"/>
+                          <Component id="aliasLocal" alignment="0" pref="301" max="32767" attributes="0"/>
                       </Group>
                       <EmptySpace min="-2" max="-2" attributes="0"/>
                   </Group>
@@ -227,7 +227,7 @@
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
               <JTabbedPaneConstraints tabName="Remote connection">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.RemoteDabatase" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.RemoteDatabase" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
               </JTabbedPaneConstraints>
             </Constraint>
@@ -346,6 +346,11 @@
               </Properties>
             </Component>
             <Component class="javax.swing.JTextField" name="remoteDatabaseIdentifier">
+              <Properties>
+                <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.DatabaseIdentifierTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </Property>
+              </Properties>
               <AuxValues>
                 <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
               </AuxValues>
@@ -367,7 +372,7 @@
     <Component class="javax.swing.JButton" name="discard">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.Discard" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/login/ItemView2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -4,6 +4,9 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.DocumentSizeFilter;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -26,6 +29,21 @@
 		initComponents();
 		getRootPane().setDefaultButton(next);
 		setLocationRelativeTo(null);
+		
+		PlantloreHelp.addKeyHelp(PlantloreHelp.LOGIN, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.LOGIN, this.help);
+        
+        new DefaultEscapeKeyPressed( this );
+		
+		DocumentSizeFilter.patch(aliasLocal, 50);
+		DocumentSizeFilter.patch(aliasRemote, 50);
+		DocumentSizeFilter.patch(databaseEngine, 30);
+		DocumentSizeFilter.patch(databaseIdentifier, 30);
+		DocumentSizeFilter.patch(databaseParameter, 60);
+		DocumentSizeFilter.patch(databasePort, 5);
+		DocumentSizeFilter.patch(host, 50);
+		DocumentSizeFilter.patch(port, 5);
+		DocumentSizeFilter.patch(remoteDatabaseIdentifier, 30);
     }
     
     /** This method is called from within the constructor to
@@ -97,11 +115,11 @@
                     .add(jLabel2))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE)
-                    .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE)
-                    .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE)
-                    .add(databaseEngine, 0, 270, Short.MAX_VALUE)
-                    .add(aliasLocal, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 270, Short.MAX_VALUE))
+                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE)
+                    .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE)
+                    .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE)
+                    .add(databaseEngine, 0, 301, Short.MAX_VALUE)
+                    .add(aliasLocal, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 301, Short.MAX_VALUE))
                 .addContainerGap())
         );
         jPanel1Layout.setVerticalGroup(
@@ -145,6 +163,8 @@
 
         jLabel11.setText(L10n.getString("Login.DatabaseIdentifier"));
 
+        remoteDatabaseIdentifier.setToolTipText(L10n.getString("Login.DatabaseIdentifierTT"));
+
         org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
         jPanel2.setLayout(jPanel2Layout);
         jPanel2Layout.setHorizontalGroup(
@@ -187,11 +207,11 @@
                     .add(remoteDatabaseIdentifier, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap(39, Short.MAX_VALUE))
         );
-        jTabbedPane1.addTab(L10n.getString("Login.RemoteDabatase"), jPanel2);
+        jTabbedPane1.addTab(L10n.getString("Login.RemoteDatabase"), jPanel2);
 
         next.setText(L10n.getString("Login.Change"));
 
-        discard.setText(L10n.getString("Login.Discard"));
+        discard.setText(L10n.getString("Common.Cancel"));
 
         help.setText(L10n.getString("Common.Help"));
 
@@ -205,7 +225,7 @@
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, jTabbedPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
                         .add(help)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 175, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
                         .add(discard)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(next)))

Modified: trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -63,7 +63,7 @@
 	 * @param visible	True if the View should become visible.
 	 */
 	public void setVisible(boolean visible) {
-		JDialog dialog = view.remember.isSelected() && !view.choice.isSelectionEmpty() ? authView : view;
+		JDialog dialog = /*view.remember.isSelected() && !view.choice.isSelectionEmpty() ? authView : */view;
 		dialog.setVisible(visible);
 	}
 	

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -64,11 +64,11 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Component id="jScrollPane1" alignment="1" pref="343" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
-                      <Component id="remember" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="74" max="32767" attributes="0"/>
-                      <Component id="discard" min="-2" max="-2" attributes="0"/>
+                      <Component id="help" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="126" max="32767" attributes="0"/>
+                      <Component id="discard" linkSize="1" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" min="-2" max="-2" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -83,8 +83,8 @@
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="remember" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>
@@ -126,28 +126,20 @@
         </Component>
       </SubComponents>
     </Container>
-    <Component class="javax.swing.JCheckBox" name="remember">
+    <Component class="javax.swing.JButton" name="discard">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.SelectAutomatically" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
         </Property>
-        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
-          <Border info="org.netbeans.modules.form.compat2.border.EmptyBorderInfo">
-            <EmptyBorder bottom="0" left="0" right="0" top="0"/>
-          </Border>
-        </Property>
-        <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
-          <Insets value="[0, 0, 0, 0]"/>
-        </Property>
       </Properties>
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
-    <Component class="javax.swing.JButton" name="discard">
+    <Component class="javax.swing.JButton" name="help">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Help" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -10,6 +10,8 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 
@@ -35,9 +37,14 @@
         initComponents();
         setLocationRelativeTo(null); // center of the screen
         getRootPane().setDefaultButton(next);
+        
+        PlantloreHelp.addKeyHelp(PlantloreHelp.LOGIN, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.LOGIN, this.help);
+        
+        new DefaultEscapeKeyPressed( this );
+        
         // See what's new.
         update(null, Login.UPDATE_LIST);
-        remember.setVisible(false);
     }
     
     /** This method is called from within the constructor to
@@ -54,8 +61,8 @@
         next = new javax.swing.JButton();
         jScrollPane1 = new javax.swing.JScrollPane();
         choice = new javax.swing.JList();
-        remember = new javax.swing.JCheckBox();
         discard = new javax.swing.JButton();
+        help = new javax.swing.JButton();
 
         popup.setName("popup");
         add.setText(L10n.getString("Login.AddRecord"));
@@ -77,12 +84,10 @@
         choice.setSelectionMode(javax.swing.ListSelectionModel.SINGLE_SELECTION);
         jScrollPane1.setViewportView(choice);
 
-        remember.setText(L10n.getString("Login.SelectAutomatically"));
-        remember.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        remember.setMargin(new java.awt.Insets(0, 0, 0, 0));
-
         discard.setText(L10n.getString("Common.Cancel"));
 
+        help.setText(L10n.getString("Common.Help"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -92,13 +97,16 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(remember)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 74, Short.MAX_VALUE)
+                        .add(help)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 126, Short.MAX_VALUE)
                         .add(discard)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(next)))
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {discard, next}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
@@ -107,8 +115,8 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(next)
-                    .add(remember)
-                    .add(discard))
+                    .add(discard)
+                    .add(help))
                 .addContainerGap())
         );
         pack();
@@ -151,10 +159,10 @@
     protected javax.swing.JList choice;
     protected javax.swing.JButton discard;
     protected javax.swing.JMenuItem edit;
+    protected javax.swing.JButton help;
     private javax.swing.JScrollPane jScrollPane1;
     protected javax.swing.JButton next;
     private javax.swing.JPopupMenu popup;
-    protected javax.swing.JCheckBox remember;
     protected javax.swing.JMenuItem remove;
     // End of variables declaration//GEN-END:variables
     

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -83,10 +83,10 @@
 	public Object task() throws Exception {
 		logger.info("Table Import begins...");
 		
-		setStatusMessage("Import.Initializing");
+		setStatusMessage(L10n.getString("Import.Initializing"));
 		Class table = parser.initialize();
 		
-		setStatusMessage("Import.Initialized");
+		setStatusMessage(L10n.getString("Import.Initialized"));
 		setLength( parser.getNumberOfRecords() );
 				
 		while( !isCanceled() && parser.hasNext() ) {
@@ -151,7 +151,7 @@
 				setStatusMessage( ie.getMessage() );
 			} catch(DBLayerException de) {
 				logger.error("Delete/update/insert failed! " + de.getMessage());
-				setStatusMessage( L10n.getFormattedString("Error.UnableToProcess", count) + " " + 
+				setStatusMessage( L10n.getFormattedString("Import.UnableToProcess", count) + " " + 
 						((de.getMessage() == null) ? L10n.getString("Import.UnknownReason") : de.getMessage()) );
 			}
 		}

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -108,7 +108,7 @@
             	throw new ParserException(L10n.getString("Error.IncorrectXMLFile"));
             rootTable = tables.get( root.getName().toLowerCase() );
             if(rootTable == null)
-            	throw new ParserException("Error.UnsupportedTable");
+            	throw new ParserException(L10n.getFormattedString("Error.UnsupportedTable", rootTable.getSimpleName()));
             
             List nodes = root.selectNodes("//"+rootTable.getSimpleName().toLowerCase());
             if( nodes != null) {
@@ -164,10 +164,13 @@
 				data.replacement = (Record)rootTable.newInstance();
 				reconstruct( data.replacement, node );
 			}
-		} catch(Exception e) {
-			throw new ParserException(L10n.getString("Import.PartialyCorruptedRecord"));
+		} catch(IllegalAccessException e) {
+			throw new ParserException(L10n.getString("Error.Internal"));
+		}  catch(InstantiationException e) {
+			throw new ParserException(L10n.getString("Error.Internal"));
 		}
 		
+		
 		return data;
 	}
 

Modified: trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/common/DocumentSizeFilter.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -10,7 +10,6 @@
 package net.sf.plantlore.common;
 
 import javax.swing.JComboBox;
-import javax.swing.JComponent;
 import javax.swing.JTextField;
 import javax.swing.text.AttributeSet;
 import javax.swing.text.BadLocationException;

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-03 22:17:09 UTC (rev 649)
@@ -1390,7 +1390,7 @@
 
 Overview.MenuFileReconnectTT=Tries to renew lost connection
 
-Overview.MenutFileExit=E&xit
+Overview.MenuFileExit=E&xit
 
 Overview.MenuFileExitTT=Exits the application
 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 22:17:09 UTC (rev 649)
@@ -1525,6 +1525,8 @@
 
 Overview.MenuFileReconnectTT=Pokus\u00ED se obnovit ztracen\u00E9 spojen\u00ED
 
+Overview.MenuFileExit=Konec
+
 Overview.MenuFileExitTT=Ukon\u010D\u00ED aplikaci
 
 Search.Extended=&Roz\u0161\u00ED\u0159en\u00E9

Modified: trunk/src/net/sf/plantlore/server/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -12,6 +12,8 @@
 
 import com.jgoodies.looks.plastic.PlasticXPLookAndFeel;
 
+import net.sf.plantlore.common.PlantloreHelp;
+import net.sf.plantlore.common.exception.PlantloreException;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.manager.*;
 
@@ -44,7 +46,15 @@
 		} catch (IOException ex) {
 			ex.printStackTrace();
 		}
+		
+		 // Initialize Help
+        try {
+            PlantloreHelp.initialize();
+        } catch (PlantloreException e) {
+            // TODO: Display error message
+        }
 
+
         java.awt.EventQueue.invokeLater(new Runnable(){
         	public void run() {
         		ServerMng model = new ServerMng();

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -175,7 +175,6 @@
 	 */
 	public boolean ping() 
 	throws RemoteException {
-		logger.debug("Pinged!");
 		return !isDead;
 	}
 

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -26,8 +26,15 @@
 		mngView = new ServerMngView(model);
 		new ServerMngCtrl(model, mngView);
 		
-		view.next.setAction( new StandardAction("Server.Create") {
+        view.cancel.setAction( new StandardAction("Common.Cancel") {
 			public void actionPerformed(ActionEvent arg0) {
+				view.setVisible(false);
+				System.exit(0);
+			}
+        });
+		
+		view.next.setAction( new StandardAction("Server.Continue") {
+			public void actionPerformed(ActionEvent arg0) {
 				
 				switch( view.choicePane.getSelectedIndex() ) {
 				/* CREATE A NEW SERVER AND CONNECT TO IT */

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-03 22:17:09 UTC (rev 649)
@@ -24,13 +24,15 @@
           <Group type="102" alignment="1" attributes="0">
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Group type="103" groupAlignment="1" attributes="0">
-                  <Component id="choicePane" alignment="0" pref="356" max="32767" attributes="1"/>
+                  <Component id="choicePane" alignment="0" pref="408" max="32767" attributes="1"/>
                   <Group type="102" alignment="1" attributes="1">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="220" max="32767" attributes="0"/>
-                      <Component id="next" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="191" max="32767" attributes="0"/>
+                      <Component id="cancel" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
                   </Group>
-                  <Component id="plantloreLogo" alignment="0" pref="356" max="32767" attributes="2"/>
+                  <Component id="plantloreLogo" alignment="0" pref="408" max="32767" attributes="2"/>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>
@@ -47,6 +49,7 @@
               <Group type="103" groupAlignment="3" attributes="0">
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -70,7 +73,7 @@
       <Layout>
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
-              <EmptySpace min="0" pref="356" max="32767" attributes="0"/>
+              <EmptySpace min="0" pref="408" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
@@ -110,7 +113,7 @@
         <Container class="javax.swing.JPanel" name="jPanel3">
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="Create new Server">
+              <JTabbedPaneConstraints tabName="Create a new Server">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
                   <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Server.CreateNewServer" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
@@ -121,7 +124,7 @@
           <Layout>
             <DimensionLayout dim="0">
               <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jPanel1" alignment="0" pref="351" max="32767" attributes="1"/>
+                  <Component id="jPanel1" alignment="0" pref="403" max="32767" attributes="1"/>
                   <Component id="jPanel2" alignment="0" max="32767" attributes="0"/>
               </Group>
             </DimensionLayout>
@@ -239,13 +242,13 @@
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Group type="102" attributes="0">
-                                  <Component id="databaseType" pref="182" max="32767" attributes="0"/>
+                                  <Component id="databaseType" pref="234" max="32767" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Component id="jLabel6" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Component id="databasePort" min="-2" pref="51" max="-2" attributes="0"/>
                               </Group>
-                              <Component id="databaseParameter" pref="261" max="32767" attributes="0"/>
+                              <Component id="databaseParameter" pref="313" max="32767" attributes="0"/>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                       </Group>
@@ -339,7 +342,7 @@
         <Container class="javax.swing.JPanel" name="jPanel4">
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="Connect to a Running Server">
+              <JTabbedPaneConstraints tabName="Connect to a running Server">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
                   <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Server.ConnectToRunningServer" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
@@ -367,7 +370,7 @@
               <Properties>
                 <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
                   <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
-                    <TitledBorder title="Remote server">
+                    <TitledBorder title="Remote host settings">
                       <ResourceString PropertyName="titleX" bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Server.ConnectToSettings" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                     </TitledBorder>
                   </Border>
@@ -390,8 +393,8 @@
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="remoteHost" alignment="0" pref="187" max="32767" attributes="2"/>
-                              <Component id="remoteServerPassword" alignment="0" pref="187" max="32767" attributes="2"/>
+                              <Component id="remoteHost" alignment="0" pref="239" max="32767" attributes="2"/>
+                              <Component id="remoteServerPassword" alignment="0" pref="239" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="jLabel8" min="-2" max="-2" attributes="0"/>
@@ -432,6 +435,9 @@
                 <Component class="javax.swing.JTextField" name="remoteHost">
                   <Properties>
                     <Property name="text" type="java.lang.String" value="localhost"/>
+                    <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                      <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Server.HostTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                    </Property>
                   </Properties>
                   <AuxValues>
                     <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -445,6 +451,11 @@
                   </Properties>
                 </Component>
                 <Component class="javax.swing.JPasswordField" name="remoteServerPassword">
+                  <Properties>
+                    <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+                      <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Server.PasswordTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                    </Property>
+                  </Properties>
                   <AuxValues>
                     <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
                   </AuxValues>
@@ -474,5 +485,15 @@
         </Container>
       </SubComponents>
     </Container>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -9,6 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.ServerSettings;
@@ -31,10 +32,9 @@
         initComponents();
         getRootPane().setDefaultButton(next);
         setLocationRelativeTo(null); // center of the screen
-        /*
+        
         PlantloreHelp.addKeyHelp(PlantloreHelp.SERVER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.SERVER, this.help);
-        */
         
         // Initialize the components' contents.
         ServerSettings settings = model.getSettings(true);
@@ -49,6 +49,15 @@
         }
         
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
+        
+        DocumentSizeFilter.patch(serverPassword, 20);
+        DocumentSizeFilter.patch(serverPort, 5);
+        DocumentSizeFilter.patch(databaseType, 30);
+        DocumentSizeFilter.patch(databasePort, 5);
+        DocumentSizeFilter.patch(databaseParameter, 60);
+        DocumentSizeFilter.patch(remoteHost, 50);
+        DocumentSizeFilter.patch(remoteServerPort, 5);
+        DocumentSizeFilter.patch(remoteServerPassword, 20);
     }
     
     /** This method is called from within the constructor to
@@ -57,8 +66,7 @@
      * always regenerated by the Form Editor.
      */
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
-    @SuppressWarnings("static-access")
-	private void initComponents() {
+    private void initComponents() {
         plantloreLogo = new javax.swing.JPanel();
         next = new javax.swing.JButton();
         help = new javax.swing.JButton();
@@ -84,6 +92,7 @@
         remoteServerPassword = new javax.swing.JPasswordField();
         jLabel8 = new javax.swing.JLabel();
         remoteServerPort = new javax.swing.JTextField();
+        cancel = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         setTitle(L10n.getString("Server.Create"));
@@ -94,7 +103,7 @@
         plantloreLogo.setLayout(plantloreLogoLayout);
         plantloreLogoLayout.setHorizontalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 356, Short.MAX_VALUE)
+            .add(0, 408, Short.MAX_VALUE)
         );
         plantloreLogoLayout.setVerticalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -169,12 +178,12 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel2Layout.createSequentialGroup()
-                        .add(databaseType, 0, 182, Short.MAX_VALUE)
+                        .add(databaseType, 0, 234, Short.MAX_VALUE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jLabel6)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(databasePort, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 51, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 261, Short.MAX_VALUE))
+                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 313, Short.MAX_VALUE))
                 .addContainerGap())
         );
         jPanel2Layout.setVerticalGroup(
@@ -197,7 +206,7 @@
         jPanel3.setLayout(jPanel3Layout);
         jPanel3Layout.setHorizontalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 351, Short.MAX_VALUE)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 403, Short.MAX_VALUE)
             .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
         );
         jPanel3Layout.setVerticalGroup(
@@ -214,9 +223,12 @@
         jLabel3.setText(L10n.getString("Server.Host"));
 
         remoteHost.setText("localhost");
+        remoteHost.setToolTipText(L10n.getString("Server.HostTT"));
 
         jLabel4.setText(L10n.getString("Server.Password"));
 
+        remoteServerPassword.setToolTipText(L10n.getString("Server.PasswordTT"));
+
         jLabel8.setText(L10n.getString("Server.Port"));
 
         remoteServerPort.setHorizontalAlignment(javax.swing.JTextField.LEFT);
@@ -237,8 +249,8 @@
                         .add(jLabel4)))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(remoteHost, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 187, Short.MAX_VALUE)
-                    .add(remoteServerPassword, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 187, Short.MAX_VALUE))
+                    .add(remoteHost, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 239, Short.MAX_VALUE)
+                    .add(remoteServerPassword, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 239, Short.MAX_VALUE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jLabel8)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -276,6 +288,8 @@
         );
         choicePane.addTab(L10n.getString("Server.ConnectToRunningServer"), jPanel4);
 
+        cancel.setText(L10n.getString("Common.Cancel"));
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -283,14 +297,19 @@
             .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, choicePane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 356, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, choicePane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
                         .add(help)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 220, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 191, Short.MAX_VALUE)
+                        .add(cancel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(next))
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 356, Short.MAX_VALUE))
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE))
                 .addContainerGap())
         );
+
+        layout.linkSize(new java.awt.Component[] {cancel, next}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
@@ -301,7 +320,8 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(next)
-                    .add(help))
+                    .add(help)
+                    .add(cancel))
                 .addContainerGap())
         );
         pack();
@@ -309,6 +329,7 @@
     
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
     protected javax.swing.JTabbedPane choicePane;
     protected javax.swing.JTextField databaseParameter;
     protected javax.swing.JTextField databasePort;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-03 22:04:51 UTC (rev 648)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-03 22:17:09 UTC (rev 649)
@@ -9,6 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.ConnectionInfo;
 
@@ -30,7 +31,11 @@
     	model.addObserver(this);
     	
         initComponents();
-        //getRootPane().setDefaultButton(hide);
+        getRootPane().setDefaultButton(hide);
+        
+        PlantloreHelp.addKeyHelp(PlantloreHelp.SERVER, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.SERVER, this.help);
+        
         setLocationRelativeTo(null); // center of the screen
     }
     



From kovo at mail.berlios.de  Mon Sep  4 00:56:51 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 4 Sep 2006 00:56:51 +0200
Subject: [Plantlore-dev] r650 - in trunk/src/net/sf/plantlore/help: cs
	cs/html default default/html en en/html
Message-ID: <200609032256.k83Mupdk025902@sheep.berlios.de>

Author: kovo
Date: 2006-09-04 00:56:44 +0200 (Mon, 04 Sep 2006)
New Revision: 650

Added:
   trunk/src/net/sf/plantlore/help/cs/html/createdb.html
   trunk/src/net/sf/plantlore/help/default/html/checklist.html
   trunk/src/net/sf/plantlore/help/default/html/createdb.html
   trunk/src/net/sf/plantlore/help/default/html/picture/
   trunk/src/net/sf/plantlore/help/default/html/server.html
   trunk/src/net/sf/plantlore/help/default/html/table_import.html
   trunk/src/net/sf/plantlore/help/en/html/checklist.html
   trunk/src/net/sf/plantlore/help/en/html/createdb.html
   trunk/src/net/sf/plantlore/help/en/html/server.html
   trunk/src/net/sf/plantlore/help/en/html/table_import.html
Modified:
   trunk/src/net/sf/plantlore/help/cs/html/author.html
   trunk/src/net/sf/plantlore/help/cs/html/checklist.html
   trunk/src/net/sf/plantlore/help/cs/html/export.html
   trunk/src/net/sf/plantlore/help/cs/html/history.html
   trunk/src/net/sf/plantlore/help/cs/html/import.html
   trunk/src/net/sf/plantlore/help/cs/html/index.html
   trunk/src/net/sf/plantlore/help/cs/html/licence.html
   trunk/src/net/sf/plantlore/help/cs/html/login.html
   trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html
   trunk/src/net/sf/plantlore/help/cs/html/overview.html
   trunk/src/net/sf/plantlore/help/cs/html/publication.html
   trunk/src/net/sf/plantlore/help/cs/html/resources.html
   trunk/src/net/sf/plantlore/help/cs/html/search.html
   trunk/src/net/sf/plantlore/help/cs/html/server.html
   trunk/src/net/sf/plantlore/help/cs/html/settings.html
   trunk/src/net/sf/plantlore/help/cs/html/table_import.html
   trunk/src/net/sf/plantlore/help/cs/html/user.html
   trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm
   trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml
   trunk/src/net/sf/plantlore/help/default/jhelpmap.jhm
   trunk/src/net/sf/plantlore/help/default/jhelptoc.xml
   trunk/src/net/sf/plantlore/help/en/html/import.html
   trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm
   trunk/src/net/sf/plantlore/help/en/jhelptoc.xml
Log:
Encoding of help files should be ok now. Added czech version of GNU GPL licence, file for creating DB and czech version of author and publication manager help. In case you encounter a problem with encoding, please let me know.

Modified: trunk/src/net/sf/plantlore/help/cs/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,59 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Spr?va autor?</title>
-</head>
-<body>
-<h1>Spr?va autor?</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
+    <title>Spr??va autor??</title>
+  </head>
+  <body>
+<h1>Spr??va autor??</h1>
+Spr??va autor?? umo????uje u??ivateli p??id??vat, upravovat a vyhled??vat autory n??lez??. Dialogov?? okno se spr??vou autor?? je mo??n?? otev????t pomoc?? menu 
+<b>Data|Spr??va autor??</b>.
+
+Dialog pro spr??vu autor?? se skl??d?? ze dvou z??kladn??ch ????st??:
+<ul>
+<li>Seznam autor?? - auto??i, kte???? jsou v??sledkem posledn??ho hled??n??</li>
+<li>Vyhled??v??n?? autor??- zde m????ete zadat krit??ria pro vyhled??v??n?? auutor??</li>
+</ul>
+
+<h2>Seznam autor??</h2>
+Po ??sp????n??m vyhled??n?? jsou v??sledky zobrazeny v t??to ????sti formul????e. V??sledky jsou zobrazeny po str??nk??ch, proto nejsou bezprost??edn?? po vyhled??n?? 
+zobrazeni v??ichni auto??i. Pro p??ech??zen?? mezi jednotliv??mi str??nkami v??sledk?? pou??ijte tla????tek P??edchoz?? a N??sleduj??c?? kter?? najdete pod tabulkou 
+se seznamem autor??. V p????pad??, ??e chcete zobrazit v??ce z??znam?? na jedn?? str??nce, zadejte po??et zobrazovan??ch z??znam?? do pole pod tabulkou se seznamem 
+autor?? a stiskn??te kl??vesu enter. Vedle tohoto pole se takt???? nach??z?? informace celkov??m po??tu nalezn??ch z??znam?? a rozsah kter?? je pr??v?? zobrazen.
+<p>
+Tato ????st formul????e obsahuje taky tla????tka pro p??id??v??n??, ??pravu a maz??n?? autor??. Tla??itka P??idej autora a Uprav autora otev??ou dialogov?? okno pro 
+p??id??v??n??/??pravu autor?? (viz n????e). Tla????tko Odeber autora sma??e (po potvrzen?? u??ivatelem) vybran??ho autora. Pro ??pravu nebo smaz??n?? autora mus?? b??t 
+dan?? autor vybran?? v tabulce se seznamem autor?? (v opa??n??m p????pad?? syst??m u??ivatele upozorn?? ??e nen?? vybran?? ????dn?? autor). ??pravy a maz??n?? autor?? 
+podl??h?? syst??mu opr??vn??n?? v Plantlore. Pro podrobn??j???? informace o syst??mu opr??vn??n?? nav??tivte sekci Pr??va.
+
+<h2>Vyhled??v??n?? autor??</h2>
+Dialog pro spr??vu autor?? umo????uje vyhled??v??n?? podle 4 parametr??: Jm??no autora, organizace, role a email. V??sledky m????ou b??t uspo????dan?? podle jm??na, 
+organizace, role, emailu, telefonn??ho ????sla nebo URL vzestupn?? nebo sestupn??. ??et??zec pro vyhled??v??n?? nemus?? p??esn?? odpov??dat polo??ce v datab??zi, 
+nalezeny budou v??echny z??znamy, u kter??ch je zadan?? polo??ka pod??et??zcem odpov??daj??ci polo??ky v datab??zi. Po zadan?? parametr?? pro hled??n?? se vyhled??van?? 
+spou??t?? tla????tkem Vyhledej autory.
+<p>
+Vyhled??v??n?? nerozli??uje mal?? a velk?? p??smena.
+<p>
+Po otev??en?? dialogov??ho okna pro spr??vu autor?? se zobraz?? v??ichni dostupn?? auto??i. Pro pozd??j???? zobrazen?? v??ech autor??  stiskn??te tla????tko Vyhledej autory bez vypln??n?? vyhled??vac??ch parametr??.
+
+<h1>P??id??v??n?? a editace autor??</h1>
+Dialogov?? okno pro p??id??van?? nebo editaci autora se otev??r?? z hlavn??ho okna spr??vy autor?? tla????tkem P??idej autora resp. Uprav autora. Toto okno 
+obsahuje n??sleduj??c?? polo??ky:
+<ul>
+<li><b>Jm??no autora</b> - Cel?? jm??no autora. Tato polo??ka je povinn?? a nem????e z??stat nevypl??en??. Maxim??ln?? d??lka t??to polo??ky je 50 znak??.</li>
+<li><b>Organizace</b> - Organizace nebo instituce, do kter?? autor pat????. Maxim??ln?? d??lka t??to polo??ky je 50 znak??.</li>
+<li><b>Role</b> - Role autora v dan?? instituci. Maxim??ln?? d??lka t??tom polo??ky je 30 znak??.</li>
+<li><b>Adresa</b> - Adresa autora. Maxim??ln?? d??lka t??to polo??ky je ??? znak??.</li>
+<li><b>Telefon</b> - Telefonn?? ????slo autora. Maxim??ln?? d??lka t??to polo??ky je 20 znak??.</li>
+<li><b>Email</b> - Emailov?? adresa autora. Maxim??ln?? d??lka t??to polo??ky je 100 znak??.</li>
+<li><b>URL</b> - URL adresa (webstr??nka) autora. Maxim??ln?? d??lka t??to polo??ky je 255 znak??.</li>
+<li><b>Pozn??mka</b> - Jak??koli dal???? informace o autorovi. Tato polo??ka m????ze b??t dlouh?? a?? 4096 znak??.</li>
+</ul>
+Pokud p??id??v??te nov??ho autora, vypl??te jednotliv?? polo??ky a stiskn??te tla????tko Ulo?? autora. Jedin?? povinn?? polo??ka, kter?? nem????e z??stat pr??zdn??, je 
+Jm??no autora.
+<p>
+V p????pad??, ??e upravujete u?? existuj??c??ho autora, vypln?? se parametry vybran??ho autora do formul????e a m????ete je upravit. Pomoc?? tla????tka Ulo?? autora  
+se zm??ny ulo???? do datab??ze. Jedin?? polo??ka, kter?? nesm?? z??stat pr??zdn?? je tak jako u p??id??v??n?? Jm??no autora.  
+</body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,83 +1,79 @@
-<html>
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>??krt??k</title>
-	</head>
-
-<body>
-
-	<h1>??krtac?? seznam</h1>
-
-	<p>
-	??krtac?? seznam p??edstavuje u??ivatelsky pohodln?? zp??sob vkl??d??n?? n??zv?? rostlin.
-	Hned po spu??t??n?? obsahuje n??zvy v??ech rostlin tak, jak jsou ulo??eny v datab??zi.
-	</p>
-
-
-	<div style="position: relative; left: 30; top: 10;"><br>
-	<img src="picture/ChecklistDefault.jpg" alt="??krt??k po otev??en??.">
-	</div>
-
-	<p>
-	Jeliko?? se v datab??zi m????e nach??zet n??kolik tis??c rostlin, pr??ce se ??krt??kem by mohla b??t
-	nep????jemn??. Proto je mo??n?? se ve ??krt??ku pohybovat pomoc?? ??ipek nahoru i dol?? a ??ipek
-	doleva a doprava. Pro v??t???? pohodl?? je mo??n?? zadat i po????te??n?? p??smena z??znamu - 
-	??krt??k zobraz?? prvn?? vyhovuj??c?? n??zev. Nap????ete-li kup????kladu rychle po sob?? p??smena "ZELK",
-	??krt??k p??ejde na z??znam "Zelkova serrata (Thunb.) Makino". Na velikosti p??smen nez??le????.
-	</p>
-
-
-	<p>
-	V??b??r z??znamu lze prov??d??t klinut??m lev??ho tla????ka my??i nebo mezern??kem. 
-	Odzna??en?? z??znamu se prov??d?? stejn??.
-	</p>
-
-
-	<h2>Vlastn?? ??krtac?? seznam</h2>
-
-	<p>
-	Pro je??t?? v??t???? pohodl?? je mo??n?? vytvo??it si ze seznamu rostlin vlastn?? ??krt??k.
-	Vyberte ze z??kladn??ho seznamu v??echny z??znamy, ze kter??ch se m?? vytvo??it nov?? ??krt??k
-	a klikn??te na "Vytvo??it". 
-	</p>
-
-	<div style="position: relative; left: 30; top: 10"><br>
-	<img src="picture/ChecklistCreate.jpg" alt="Vytv????en?? ??krt??ku.">
-	</div>
-
-	<p>
-	Vytvo??en?? ??krt??k si m????ete ulo??it pod zvolen??m jm??nem a p??????t?? jej pomoc?? tla????tka
-	"Nahr??t" m????ete rovnou vyu????t.
-	</p>
-
-	<p>
-	??krtac?? seznam m????e vypadat n??jak takto:
-	</p>
-
-
-	<div style="position: relative; left: 30; top: 10"><br>
-	<img src="picture/ChecklistUsage.jpg" alt="Nov?? ??krt??k.">
-	</div>
-
-	
-	<p>
-	Pro odzna??en?? v??ech z??znam?? nar??z pou??ijte tla????tko "Odzna??it v??echny".
-	Pro zobrazen?? v??ech jmen rostlin (jako na za????tku), stiskn??te tla????tko "Obnovit".
-	</p>
-
-	<p>
-	Pozn??mka: Tla????tka "Obnovit" a "Nahr??t" nezru???? v??mi vybran?? polo??ky. Pokud se stane, ??e ve va??em
-	vlastn??m ??krt??ku nen?? n??jak?? rostlina, m????ete bez obav stisknout tla????tko "Obnovit", kter?? na??te seznam
-	v??ech rostlin, ani?? by po??kodilo seznam v??mi ji?? ozna??en??ch rostlin.
-	</p>
-
-
-	<p>
-	Po dokon??en?? v??b??ru rostlin stiskn??te "Vlo??it" a v??echny vybran?? rostliny budou vlo??eny do
-	seznamu v <a href="./addoccurrence.html">P??id??v??n?? z??znam??</a>.
-	</p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>??krt??k</title>
+  </head>
+  <body>
+  <h1>??krtac?? seznam</h1>
+	<p>
+	??krtac?? seznam p??edstavuje u??ivatelsky pohodln?? zp??sob vkl??d??n?? n??zv?? rostlin.
+	Hned po spu??t??n?? obsahuje n??zvy v??ech rostlin tak, jak jsou ulo??eny v datab??zi.
+	</p>
+
+
+	<div style="position: relative; left: 30; top: 10;"><br>
+	<img src="picture/ChecklistDefault.jpg" alt="??krt??k po otev??en??.">
+	</div>
+
+	<p>
+	Jeliko?? se v datab??zi m????e nach??zet n??kolik tis??c rostlin, pr??ce se ??krt??kem by mohla b??t
+	nep????jemn??. Proto je mo??n?? se ve ??krt??ku pohybovat pomoc?? ??ipek nahoru i dol?? a ??ipek
+	doleva a doprava. Pro v??t???? pohodl?? je mo??n?? zadat i po????te??n?? p??smena z??znamu - 
+	??krt??k zobraz?? prvn?? vyhovuj??c?? n??zev. Nap????ete-li kup????kladu rychle po sob?? p??smena "ZELK",
+	??krt??k p??ejde na z??znam "Zelkova serrata (Thunb.) Makino". Na velikosti p??smen nez??le????.
+	</p>
+
+
+	<p>
+	V??b??r z??znamu lze prov??d??t klinut??m lev??ho tla????ka my??i nebo mezern??kem. 
+	Odzna??en?? z??znamu se prov??d?? stejn??.
+	</p>
+
+
+	<h2>Vlastn?? ??krtac?? seznam</h2>
+
+	<p>
+	Pro je??t?? v??t???? pohodl?? je mo??n?? vytvo??it si ze seznamu rostlin vlastn?? ??krt??k.
+	Vyberte ze z??kladn??ho seznamu v??echny z??znamy, ze kter??ch se m?? vytvo??it nov?? ??krt??k
+	a klikn??te na "Vytvo??it". 
+	</p>
+
+	<div style="position: relative; left: 30; top: 10"><br>
+	<img src="picture/ChecklistCreate.jpg" alt="Vytv????en?? ??krt??ku.">
+	</div>
+
+	<p>
+	Vytvo??en?? ??krt??k si m????ete ulo??it pod zvolen??m jm??nem a p??????t?? jej pomoc?? tla????tka
+	"Nahr??t" m????ete rovnou vyu????t.
+	</p>
+
+	<p>
+	??krtac?? seznam m????e vypadat n??jak takto:
+	</p>
+
+
+	<div style="position: relative; left: 30; top: 10"><br>
+	<img src="picture/ChecklistUsage.jpg" alt="Nov?? ??krt??k.">
+	</div>
+
+	
+	<p>
+	Pro odzna??en?? v??ech z??znam?? nar??z pou??ijte tla????tko "Odzna??it v??echny".
+	Pro zobrazen?? v??ech jmen rostlin (jako na za????tku), stiskn??te tla????tko "Obnovit".
+	</p>
+
+	<p>
+	Pozn??mka: Tla????tka "Obnovit" a "Nahr??t" nezru???? v??mi vybran?? polo??ky. Pokud se stane, ??e ve va??em
+	vlastn??m ??krt??ku nen?? n??jak?? rostlina, m????ete bez obav stisknout tla????tko "Obnovit", kter?? na??te seznam
+	v??ech rostlin, ani?? by po??kodilo seznam v??mi ji?? ozna??en??ch rostlin.
+	</p>
+
+
+	<p>
+	Po dokon??en?? v??b??ru rostlin stiskn??te "Vlo??it" a v??echny vybran?? rostliny budou vlo??eny do
+	seznamu v <a href="./addoccurrence.html">P??id??v??n?? z??znam??</a>.
+	</p>  
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/cs/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/createdb.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/createdb.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,12 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Vytv????en?? nov?? datab??ze</title>
+  </head>
+  <body>
+  <h1>Vytv????en?? nov?? datab??ze</h1>
+  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,138 +1,135 @@
-???<html>
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<!--<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />-->
-		<title>Export dat</title>
-	</head>
-
-<body>
-
-	<h1>Export dat</h1>
-
-	<p>
-	Va??e n??lezov?? data jsou p??i pr??ci s Plantlore ukl??d??na do datab??ze. 
-	K datab??zi nelze p??istupovat p????mo a pokud byste cht??li svoje data p??en????et i na jin??
-	po????ta??e, je pot??eba pou????t Export. Export dat slou???? k "vyta??en??" n??lezov??ch dat z datab??ze
-	a ulo??en?? do souboru na disku Va??eho po????ta??e.
-	</p>
-
-	<p>
-	Export lze prov??d??t po p??ipojen?? k jak??koli datab??zi - tedy i k datab??zi vzd??len??.
-	Tehdy se vyplat?? zv????it p??enosovou kapacitu linky, kterou pou????v??te pro p??ipojen??,
-	nebo?? se m????e p??en????et velk?? mno??stv?? dat a doba nutn?? k vyexportov??n?? n??lezov??ch dat
-	by byla ne??nosn??.
-	</p>
-
-
-	<h2>1. D????ve, ne?? za??nete exportovat</h2>
-
-	<p>
-	P??ed vlastn??m exportem je nejprve nutn?? vybrat (ozna??it) n??lezov?? z??znamy, 
-	kter?? chcete exportovat. 
-	Pro z????en?? okruhu, z n??ho?? budete z??znamy vyb??rat, slou???? <a href="./search.html">Vyhled??v??n??</a>.
-	Ve vyhled??vac??m formul????i zad??te po??adovan?? kriteria a v 
-	<a href="./overview.html">P??ehledu</a> se zobraz?? v??echny relevantn??
-	z??znamy ulo??en?? v datab??zi. Z t??chto z??znam?? m????ete je??t?? explicitn?? ozna??it ty, kter?? jsou
-	pro v??s d??le??it??. Neozna????te-li ????dn?? z??znamy, Plantlore se bude chovat, jako byste ozna??ili
-	v??echny; t??m V??m usnadn?? pr??ci s jejich ozna??ov??n??m.
-	</p>
-
-	<p>
-	Na n??sleduj??c??m obr??zku je ozna??eno 11 z??znam?? z devaten??cti.
-	</p>
-
-	<p>
-	<img src="picture/ExportSelectingRecords.png" alt="Ozna??ov??n?? z??znam?? pro export.">
-	</p>
-
-
-
-	<h2>2. Vlastn?? export dat</h2>
-
-	<p>
-	Export prob??h?? ve dvou kroc??ch.
-	</p>
-
-	<h3>2.1. Volba jm??na souboru a form??tu dat</h3>
-
-	<p>
-	Zvolte jm??no souboru, do kter??ho se maj?? data ulo??it, a jeho form??t.
-	K dispozici je n??kolik z??kladn??ch form??t??:
-	<ul>
-		<li>PlantloreNative je form??t, kter?? je navr??en p????mo pro pohodln?? p??enos dat mezi
-		dv??ma programy Plantlore. Nev??te-li, kter?? form??t pro p??enos dat zvolit,
-		doporu??ujeme vybrat tento.
-		</li>
-		<li>XML je form??t vyu????vaj??c?? tzv. Extensible Markup Language (XML). Data jsou ukl??d??na v p??ehledn??
-		stromov?? struktu??e uvozen?? tzv. tagy. Form??t nav??c umo????uje v??b??r konkr??tn??ch ????st?? z??znamu,
-		kter?? chcete exportovat. Tento form??t je vhodn?? jak pro p??en????en?? dat, tak pro jejich vizualizaci
-		nap??. v programu Internet Explorer.
-		</li>
-		<li>ABCD Schema je form??t zalo??en?? na XML, ale struktura se li???? - odpov??d?? po??adavk??m kladen??m
-		na ABCD Schema.
-		</li>
-		<li>DarwinCore je form??t zalo??en?? na XML, ale struktura se li???? - odpov??d?? po??adavk??m kladen??m
-		na DarwinCore.
-		</li>
-		<li>CSV neboli Comma Separated Values (hodnoty odd??len?? ????rkami) je form??t obsahuj??c??
-		ka??d?? z??znam na jednom ????dku, p??i??em?? hodnoty sloupe??k?? jsou odd??leny ????rkami.
-		Prvn?? ????dek obsahuje n??zvy atribut?? z??znamu. Struktura souboru p??ipom??n?? tabulku.
-		Form??t se hod?? pro pohodln?? na????t??n?? v n??kter??ch jin??ch programech, nap??. tabulkov??ch procesorech
-		jako Microsoft Excel.
-		</li>
-		<li>StdOut neukl??d?? z??znamy do souboru, ale na tzv. standardn?? v??stup. Data jsou odes??l??na 
-		ve velmi ??iteln?? podob??. Tento druh form??tu je ur??en pro testov??n?? nebo proudov?? zpracov??n??
-		v p????kazov?? ????dce nebo shellu. 
-		</li>
-	</ul>
-	Nejste-li si jisti, kter?? form??t je pro V??s ten spr??vn??, doporu??ujeme volit PlantloreNative,
-	kter?? se nejl??pe hod?? pro p??enos mezi dv??ma programy Plantlore.
-	</p>
-
-	<p>
-	<img src="picture/ExportSupplyingName.png" alt="Zad??v??n?? jm??na souboru a form??tu dat.">
-	</p>
-
-	<h3>2.2. Atributy z??znam?? (voliteln??)</h3>
-
-	<p>
-	Tento krok je voliteln?? a nab??z?? jej pouze form??ty XML, CSV a StdOut. Zbyl?? form??ty automaticky exportuj??
-	z??znam se v??emi jeho atributy. Volba atribut?? (t???? sloupe??k??) n??lezov??ho z??znamu se prov??d?? ozna??ov??n??m
-	polo??ek v zobrazen??m strom??. ??erven?? jsou ozna??eny polo??ky, kter?? je nutn?? vybrat, pokud budete cht??t
-	data znovu nahr??t do Plantlore (v??ce viz <a href="./import.html">Import</a>).
-	</p>
-	
-	<p>
-	Nevyberete-li ????dn?? sloupe??ky, p??edpokl??d?? se, ??e jste ozna??ili v??echny.
-	</p>
-
-	<p>
-	<img src="picture/ExportSelectingColumns.png" alt="V??b??r atribut?? n??lezov??ch z??znam??.">
-	</p>
-
-
-	<h3>2.3. Export z??znam??</h3>
-
-	<p>
-	Po dokon??en?? v??b??ru atribut?? se spust?? Export. Pr??b??h procesu m????ete sledovat v otev??en??m okn??.
-	Rozhodnete-li se Export zru??it, stiskn??te tla????tko <i>Storno</i> a export bude p??ed??asn?? ukon??en.
-	</p>
-
-	<p>
-	<img src="picture/ExportProgress.png" alt="Pr??b??h exportu.">
-	<p>
-
-
-
-	<h2>3. Omezen??, kter?? je nutno zv????it p??i Exportu</h2>
-
-	<p>
-	Exportovat lze jak??koli n??lezov?? data, kter?? jste ozna??ili a tedy m??te pr??vo je prohl????et.
-	Pamatujte: <i>nic znamen?? v??e</i> - neozna????te-li explicitn?? ????dn?? z??znamy nebo sloupe??ky, Plantlore
-	se chov??, jako byste vybrali v??echny. 
-	Sou??asn?? m????e prob??hat v jedn?? instanci programu Plantlore pouze jeden Export n??lezov??ch dat.
-	</p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Export dat</title>
+  </head>
+  <body>
+  <h1>Export dat</h1>
+	<p>
+	Va??e n??lezov?? data jsou p??i pr??ci s Plantlore ukl??d??na do datab??ze. 
+	K datab??zi nelze p??istupovat p????mo a pokud byste cht??li svoje data p??en????et i na jin??
+	po????ta??e, je pot??eba pou????t Export. Export dat slou???? k "vyta??en??" n??lezov??ch dat z datab??ze
+	a ulo??en?? do souboru na disku Va??eho po????ta??e.
+	</p>
+
+	<p>
+	Export lze prov??d??t po p??ipojen?? k jak??koli datab??zi - tedy i k datab??zi vzd??len??.
+	Tehdy se vyplat?? zv????it p??enosovou kapacitu linky, kterou pou????v??te pro p??ipojen??,
+	nebo?? se m????e p??en????et velk?? mno??stv?? dat a doba nutn?? k vyexportov??n?? n??lezov??ch dat
+	by byla ne??nosn??.
+	</p>
+
+
+	<h2>1. D????ve, ne?? za??nete exportovat</h2>
+
+	<p>
+	P??ed vlastn??m exportem je nejprve nutn?? vybrat (ozna??it) n??lezov?? z??znamy, 
+	kter?? chcete exportovat. 
+	Pro z????en?? okruhu, z n??ho?? budete z??znamy vyb??rat, slou???? <a href="./search.html">Vyhled??v??n??</a>.
+	Ve vyhled??vac??m formul????i zad??te po??adovan?? kriteria a v 
+	<a href="./overview.html">P??ehledu</a> se zobraz?? v??echny relevantn??
+	z??znamy ulo??en?? v datab??zi. Z t??chto z??znam?? m????ete je??t?? explicitn?? ozna??it ty, kter?? jsou
+	pro v??s d??le??it??. Neozna????te-li ????dn?? z??znamy, Plantlore se bude chovat, jako byste ozna??ili
+	v??echny; t??m V??m usnadn?? pr??ci s jejich ozna??ov??n??m.
+	</p>
+
+	<p>
+	Na n??sleduj??c??m obr??zku je ozna??eno 11 z??znam?? z devaten??cti.
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingRecords.png" alt="Ozna??ov??n?? z??znam?? pro export.">
+	</p>
+
+
+
+	<h2>2. Vlastn?? export dat</h2>
+
+	<p>
+	Export prob??h?? ve dvou kroc??ch.
+	</p>
+
+	<h3>2.1. Volba jm??na souboru a form??tu dat</h3>
+
+	<p>
+	Zvolte jm??no souboru, do kter??ho se maj?? data ulo??it, a jeho form??t.
+	K dispozici je n??kolik z??kladn??ch form??t??:
+	<ul>
+		<li>PlantloreNative je form??t, kter?? je navr??en p????mo pro pohodln?? p??enos dat mezi
+		dv??ma programy Plantlore. Nev??te-li, kter?? form??t pro p??enos dat zvolit,
+		doporu??ujeme vybrat tento.
+		</li>
+		<li>XML je form??t vyu????vaj??c?? tzv. Extensible Markup Language (XML). Data jsou ukl??d??na v p??ehledn??
+		stromov?? struktu??e uvozen?? tzv. tagy. Form??t nav??c umo????uje v??b??r konkr??tn??ch ????st?? z??znamu,
+		kter?? chcete exportovat. Tento form??t je vhodn?? jak pro p??en????en?? dat, tak pro jejich vizualizaci
+		nap??. v programu Internet Explorer.
+		</li>
+		<li>ABCD Schema je form??t zalo??en?? na XML, ale struktura se li???? - odpov??d?? po??adavk??m kladen??m
+		na ABCD Schema.
+		</li>
+		<li>DarwinCore je form??t zalo??en?? na XML, ale struktura se li???? - odpov??d?? po??adavk??m kladen??m
+		na DarwinCore.
+		</li>
+		<li>CSV neboli Comma Separated Values (hodnoty odd??len?? ????rkami) je form??t obsahuj??c??
+		ka??d?? z??znam na jednom ????dku, p??i??em?? hodnoty sloupe??k?? jsou odd??leny ????rkami.
+		Prvn?? ????dek obsahuje n??zvy atribut?? z??znamu. Struktura souboru p??ipom??n?? tabulku.
+		Form??t se hod?? pro pohodln?? na????t??n?? v n??kter??ch jin??ch programech, nap??. tabulkov??ch procesorech
+		jako Microsoft Excel.
+		</li>
+		<li>StdOut neukl??d?? z??znamy do souboru, ale na tzv. standardn?? v??stup. Data jsou odes??l??na 
+		ve velmi ??iteln?? podob??. Tento druh form??tu je ur??en pro testov??n?? nebo proudov?? zpracov??n??
+		v p????kazov?? ????dce nebo shellu. 
+		</li>
+	</ul>
+	Nejste-li si jisti, kter?? form??t je pro V??s ten spr??vn??, doporu??ujeme volit PlantloreNative,
+	kter?? se nejl??pe hod?? pro p??enos mezi dv??ma programy Plantlore.
+	</p>
+
+	<p>
+	<img src="picture/ExportSupplyingName.png" alt="Zad??v??n?? jm??na souboru a form??tu dat.">
+	</p>
+
+	<h3>2.2. Atributy z??znam?? (voliteln??)</h3>
+
+	<p>
+	Tento krok je voliteln?? a nab??z?? jej pouze form??ty XML, CSV a StdOut. Zbyl?? form??ty automaticky exportuj??
+	z??znam se v??emi jeho atributy. Volba atribut?? (t???? sloupe??k??) n??lezov??ho z??znamu se prov??d?? ozna??ov??n??m
+	polo??ek v zobrazen??m strom??. ??erven?? jsou ozna??eny polo??ky, kter?? je nutn?? vybrat, pokud budete cht??t
+	data znovu nahr??t do Plantlore (v??ce viz <a href="./import.html">Import</a>).
+	</p>
+	
+	<p>
+	Nevyberete-li ????dn?? sloupe??ky, p??edpokl??d?? se, ??e jste ozna??ili v??echny.
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingColumns.png" alt="V??b??r atribut?? n??lezov??ch z??znam??.">
+	</p>
+
+
+	<h3>2.3. Export z??znam??</h3>
+
+	<p>
+	Po dokon??en?? v??b??ru atribut?? se spust?? Export. Pr??b??h procesu m????ete sledovat v otev??en??m okn??.
+	Rozhodnete-li se Export zru??it, stiskn??te tla????tko <i>Storno</i> a export bude p??ed??asn?? ukon??en.
+	</p>
+
+	<p>
+	<img src="picture/ExportProgress.png" alt="Pr??b??h exportu.">
+	<p>
+
+
+
+	<h2>3. Omezen??, kter?? je nutno zv????it p??i Exportu</h2>
+
+	<p>
+	Exportovat lze jak??koli n??lezov?? data, kter?? jste ozna??ili a tedy m??te pr??vo je prohl????et.
+	Pamatujte: <i>nic znamen?? v??e</i> - neozna????te-li explicitn?? ????dn?? z??znamy nebo sloupe??ky, Plantlore
+	se chov??, jako byste vybrali v??echny. 
+	Sou??asn?? m????e prob??hat v jedn?? instanci programu Plantlore pouze jeden Export n??lezov??ch dat.
+	</p>
+  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,182 +1,181 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Historie ??prav</title>
-</head>
-<body>
-<h1>Historie ??prav</h1>
-
-Plantlore v??m nab??z?? mo??nost sledovat historii zm??n va??ich n??lezov??ch dat. Diky t??to funkci m??te mo??nost zjistit kdo, kdy a jak zm??nil informace o 
-konkr??tn??m n??lezu, autorovi, publikaci ??i metadatech.<br> 
-Mezi z??kladn?? zaznamen??v??n?? informace o zm??n?? pat????:
-<ul> 
- <li>datum a ??as zm??ny
- <li>typ operace (vlo??en??, editov??n??, smaz??n??)
- <li>jm??no u??ivatel, kter?? zm??nu provedl 
- <li>n??zev editovan?? polo??ky, nebo identifikace vlo??en??ho/smzan??ho z??znamu 
- <li>star?? hodnota editovan?? polo??ky
- <li>nov?? hodnota editovan?? polo??ky
-</ul>
-  
-Plantlore krom?? mo??nosti sledovat zm??n??n?? zm??ny v n??lezov??ch datech v??m umo??n?? zru??it n??kter?? zm??ny a vr??tit se tak k d????v??j????m hodnot??m. Historie
-je siln??m n??strojem umo????uj??c?? z??sah do va??ich n??lezov??ch dat a proto je nutne, aby pr??ce s histori?? byla z bezpe??nostn??ch d??vod?? omezena jen na u??ivatele, kte???? maj?? dostate??n?? opr??vn??n?? (viz. <a href="./user.html">Pr??va u??ivatel??</a>).  
-
-<p>
-<i><b>Exituj?? dva odli??n?? zp??soby pr??ce s histori?? ??prav:</b></i> 
-</p>
-
-<a href="#historyRecord">Historie n??lezu</a> - d??v?? u??ivatelovi mo??nost sledovat historii zm??n vybran??ho n??lezu a pou????t operaci UNDO na vybran?? zm??ny<br> 
-<a href="#historyData">Celkov?? historie</a> - d??v?? administr??torovi n??stroj pro kontrolu proveden??ch zm??n v datech a mo??nost prov??st operaci UNDO ke konkr??tn??mu datumu/??asu
-
-<br><br>
-<a name="historyRecord"><h2>Historie n??lezu</h2></a>
-
-<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
-
-<p><br>
-Pro p????stup k historii vybran??ho n??lezu sta???? jen ozna??it tento n??lez a kliknout na tla????tko <i><b>History</b></i>. Pokud je tla????tko <i><b>History</b></i>
-neaktivn?? a p????stup k hsitorii ??prav v??m byl t??mto znemo??n??n, tak nem??te pr??vo na pr??ci s vybran??m n??lezem. Ur??it?? nebude na??kodu  
-zm??nit, kdy m??te pr??vo pracovat s histori?? n??lezu.
-</p>
-Historie n??lezu je p????stupn??:
-<ul>
-   <li>u??ivatelovi, kter?? dan?? n??lez vlo??il do datab??ze</li>
-   <li>u??ivatelovi, kter?? m?? pr??vo editovat z??znamy u??ivatele, kter?? tento n??lez vlo??il do datab??ze</li>
-   <li>u??ivatelovi, kter?? m?? pr??vo editovat v??echny n??lezy ulo??en?? v datab??zi</li>
-   <li>u??ivatelovi, kter?? m?? pr??vo administr??tor</li>   
-</ul>    
-
-Pokud nem??te p????stup k historii n??lezu a cht??li byste ho z??skat, tak kontaktujte administr??tora Plantlore.<br>
-Podrobn??j???? informace o pr??vech u??ivatel?? m????ete nastudovat v ??asti <a href="./user.html">Pr??va u??ivatel??</a>.
-
-<h5>Dialog historie n??lezu</h5>
-
-<img src="picture/historyOcc_cs.png">
-<br><br>
-
-Dialog historie n??lezu je rozd??len do t???? ????st??. 
-<ul>
-  <li><b>Detaily n??lezu</b> - zde jsou zobrazeny z??kladn?? informace o n??lezu (taxon, auto??i n??lezu a lokalita)
-  <li><b>Vytvo??en?? n??lezu</b> - zde jsou zobrazeny informace o vlo??en?? n??lezu do datab??ze (datum/??as vlo??en?? a u??ivatel, kter?? z??znam vlo??il do datab??ze)
-  <li><b>Seznam zm??n</b> - zde jsou zobrazeny z??kladn?? informace o jednotliv??ch zm??n??ch n??lezu 
-</ul>
-  
-<h3>Seznam zm??n</h3>
-
-Seznam zm??n n??lezu je set????zen od ??asov?? nejmlad????ch po ??asov?? nejstar???? zm??nu a je zobrazen v tabulce, kter?? obsahuje n??sleduj??c?? ??daje:  
-  
-<ul>
-<li><b>X</b> - slou???? pro v??b??r jednotliv??ch zm??n</li>
-<li><b>Datum/??as</b> - informuje o dob??, kdy ke zm??n?? do??lo</li>
-<li><b>U??ivatel</b> - odpov??d?? u??ivatelovi, kter?? zm??nu provedl</li>
-<li><b>Polo??ka</b> - informuje o polo??ce, kter?? byla zm??n??na</li>
-<li><b>Star?? hodnota</b> - obsahuje hodnotu polo??ky p??ed zm??nou </li>
-<li><b>Nov?? hodnota</b> - obseahuje novou hodnotu polo??ky </li>
-</ul>
-
-
-<h3>Operace UNDO na vybran?? polo??ky</h3>
-
-V historii n??lezu si m????ete vybrat zm??nu <b>jen konkr??tn?? polo??ky</b> v z??znamu a vr??tit se k jej?? star?? hodnot??. Li???? se tedy od klasick?? UNDO operace, 
-kde se proved??n?? zm??ny v z??znamu vrac?? od nejmlad???? po nejstar???? v ??asov??m sledu v jak??m k nim do??lo. Uve??m?? si p????klad, kdy vyu??ijeme zm??n??n??ho 
-vylep??en?? operace UNDO: 
-<div style="text-align:justify; padding: 20 20 30 20">
-<i> Ud??l??te opravy polo??ek "Herb????", "Rok n??lezu", "Pozn??mku k n??lezu" a po t??chto oprav??ch ud??l??te je??t?? dal????ch dvacet zm??n??m. 
-U?? si nepamatujete p??esn?? prvn?? ulo??en?? zn??n?? pozn??mky k n??lezu, ale chcete se k n??mu vr??tit. U klasick??ho operace UNDO byste museli zru??it postupn?? v??echny 
-posledn?? zm??n, abyste nastavili zp??t prvn?? zn??n?? pozn??ky k n??lezu. V dialogu historie je spln??n?? va??eho po??adavku jednoduch??. Pokud budete cht??t jen
-zjistit prvn?? zn??n?? pozn??mky k n??lezu, sta???? si v seznamu zm??n naj??t nejstar???? zn??mu pozn??mky a v sloupku STAR?? HODNOTA u?? vid??te hledan?? text.
-Pokud chcete pozn??mce nastavit jej?? prvn?? ulo??enou hodnotu, tak sta???? naj??t nejstar???? zm??nu v??sledku revize, vybrat dan?? ????dek pomoc??
-sloupku X a kliknout na tla????tko <b>UNDO</b>. Nelekn??te se, ??e v??b??rem dan??ho ????dku se v??m vyberou i ????dky, v kter??ch je zaznamen??na mlad????
-zm??na t??to pozn??mky, toto chov??n?? vych??z?? z logiky ozna??ov??n?? zm??n (pops??no n????e).</i> 
-</div>
-
-Jak ji?? bylo zm??n??no, tak pomoc?? sloubku X vyb??r??te ??pravy, kter?? chcete vr??tit. Ozna??en?? ??i odzna??en?? lze prov??st my???? kliknut??m v sloubku X po??adovan??ho
-????dku. Pro ozna??ov??n?? m????ete vyu????t i tla????tka <b><i>Vyber v??e</i></b> a <b><i>Odzna?? v??e</i></b>, kter?? ozna???? nebo odzna???? v??echny zm??ny n??lezu zobrazen?? v tabulce.
-Po??et polo??ek zobrazen??ch v tabulce si m????ete sami nastavit p??eps??n??m hodnoty pro <b><i>Zobrazit ????dk??</i></b> a potvrzen??m nov?? hodnoty kl??vesov??m tla????tkem 
-ENTER. V tabulce se p??ep??n??te na dal???? nebo p??edchoz?? seznam zm??n pomoc?? tla????tek <b><i>P??edchoz??</i></b> a <b><i>N??sleduj??c??</i></b>. Informace o aktu??ln?? 
-zobrazen??m seznamu zm??n jsou uvedeny v ????sti pod tabulkou.
-
-<br><br> 
-Po stisknut?? tla????tko <b><i>UNDO</i></b> se zobraz?? informace se seznamem zm??n, kter?? budou provedeny. Volbou tla????tka CANCLE zru????te operaci. 
-Volbou tla????tka OK naopak potvrd??te operaci a provede se n??vrat vybran??ch zm??n n??lezu. Z historie budou smaz??ny v??echny ozna??en?? ????dky v dob?? zavol??n??
-operace <b><i>UNDO</i></b> (na ozna??en?? ????dky byla provedena operace UNDO). 
-
-<br><br>
-<img src="picture/historyUndo_cs.png">
-<br><br>
-
-<h3><i>Logika ozna??ov??n?? zm??n</i></h3>
-
-Polo??ky v z??znamu m????ou b??t upravov??ny v??cekr??t, proto je p??i ozna??ov??n?? zm??n v dialogu historie nutn?? o??et??it n??kolik situac?? (viz. n????e).<br>
-Pro lep???? n??zorn??j???? vysv??tlen?? si to uve??me na p????kladu:<br><br> 
-
-<img src="picture/historyOccMark_cs.png">
-<br><br>
-
-<i>P??edpokl??dejme, ??e polo??ka HERB???? byla n-kr??t zm??n??na. V dialogu historie existuje n ????dk??, kter?? informuj?? o zm??n?? polo??ky HERB????. Ve v????e 
-uveden??m obr??zku je vid??t zm??na HERB???? 15.8.2006 11:39 z hodnoty CB/910 na hodnotu CB/913, mlad???? zm??na HERB???? 15.8.2006 11:40 z hodnoty CB/913 na hodnotu CB/918
-a nejmlad???? zm??na HERB???? 15.8.2006 12:36 z hodnoty CB/918 na hodnotu CB/968.
-P??i ozna??ov??n?? a odzna??ov??n?? t??chto zm??n m????e doj??t k n??sleduj??c??m situac??m:
-<ul> 
-<li> U??ivatel se chce vr??tit k situaci, kdy polo??ka HERB???? m??la hodnotu CB/910. Mus?? tedy ozna??it p????slu??n?? ????dek se zm??nou z 15.8.2006 11:39. Proto??e 
-existuj?? je??t?? mlad???? zm??ny polo??ky HERB????, budou ozna??eny i ????dky pro zm??ny HERB???? 15.8.2006 11:40 a HERB???? 15.8.2006 12:36. Po zavol??n?? operace 
-<b>UNDO</b> bude m??t polo??ka HERB???? zvolen??ho zaznamu hodnotu CB/910 a z historie budou smaz??ny v??echny ozna??en?? ????dky.  
-<li> U??ivatel m?? v dialogu ozna??en?? zm??ny polo??ky HERB???? z 15.8.2006 11:39, 15.8.2006 11:40 a 15.8.2006 12:36 a rozhodl se jen pro n??vrat zm??ny z 15.8.2006 11:39, to je k hodnot?? CB/918. 
-V t??to situaci mus?? u??ivatel odzna??it zm??nu z 15.8.2006 11:40. Pokud by byly ozna??eny i star???? zm??ny (nap??. 15.8.2006 11:39) polo??ky HERB????, 
-budou odzna??en??m zm??ny z 15.8.2006 11:40 automaticky odzna??eny. 
-<li> U??ivatel m?? v dialogu ozna??en?? zm??ny polo??ky HERB???? z 15.8.2006 11:39, 15.8.2006 11:40 a 15.8.2006 12:36 a rozhodl se tyto zm??ny neprov??st. 
-K odzna??en?? v??ech zm??n polo??ky HERB???? sta???? odzna??it nejmlad???? zm??nu a automaticky buou odzna??ny zm??ny star????. 
-U??ivatel odzna??en??m mlad???? zm??ny ??ekne, ??e chce zachovat tuto zm??nu polo??ky HERB????.  
-</ul>
-</i><br>
-
-<a name="historyData"><h2>Celkov?? historie</h2></a> 
-
-<br>
-<img src="picture/wholeHistoryEnter_cs.png">
-<br><br>
-
-Dialog celkov?? historie sledovan??ch zm??n je p????stupn?? pouze u??ivatelovi s pr??vem administr??tora. Pokud m??te administr??torsk?? pr??va m????ete tento 
-dialog otev???? z menu <b>Data/Celkov?? historie</b>. Pokud administr??torsk?? pr??va nem??te je polo??ka v menu pro v??s neaktivn??.
-
-<h5>Dialog celkov?? historie</h5>
-
-<img src="picture/wholeHistoryDialog_cs.png">
-<br><br>
-
-V dialogu je zobrazen seznam v??ech zm??n t??kaj??c??ch se metadat, n??lez??, autor?? a publikac??. Tento seznam je set????zen od ??asov?? nejmlad????ch po 
-??asov?? nejstar???? zm??nu a je zobrazen v tabulce, kter?? obsahuje n??sleduj??c?? ??daje:  
-  
-<ul>
-<li><b>Datum/??as</b> - informuje o dob??, kdy ke zm??n?? do??lo</li>
-<li><b>Operace</b> - informuje o operaci, kter?? byla provedena (vlo??en??, editov??n??, smaz??n??)</li>
-<li><b>U??ivatel</b> - odpov??d?? u??ivatelovi, kter?? zm??nu provedl</li>
-<li><b>Polo??ka</b> - informuje o polo??ce, kter?? byla zm??n??na</li>
-<li><b>Star?? hodnota</b> - obsahuje hodnotu polo??ky p??ed zm??nou (vypln??na jen pro operaci edit)</li>
-<li><b>Nov?? hodnota</b> - obseahuje novou hodnotu polo??ky (vypln??na jen pro operaci edit)</li>
-</ul>
-
-
-<img src="picture/wholeHistoryDetail_cs.png">
-<br><br>
-
-Pokud chcete zjistit podrobn??j???? informace o n??lezu, metadatech, autorovi nebo publikaci, tak ozna??te ????dek tabulky se zm??nou, pro kterou se 
-zaj??mate o podrobn??j???? informace, a stiskn??te tla????tko <b><i>Detail</i></b>. 
-
-<h3>Operace UNDO ke zvolen??mu datumu a ??asu</h3>
-
-Operace <b><i>Undo</i></b> vrac?? postupn?? zm??ny proveden?? v datab??zi a to od ??asov?? nejmlad???? po ??asov?? nejstar???? zm??nu. P??ed stisknut??m tla????tka
-UNDO je nutn?? ozna??it ????dek tabulky, do kter??ho (i v??etn?? n??j) se m?? prov??st n??vrat zm??n v datab??zi. Po stisknut?? tla????tka <b><i>Undo</i></b> 
-se zobraz?? informace o zvolen??m datumu/??ase pro tuto operaci. N??sledn??m potvrzen??m tla????tkem OK dojde k proveden?? operace UNDO a z??rove?? smaz??n?? 
-vr??cen??ch zm??n z historie.   
-
-<h3>Pro??i??t??n?? datab??ze a smaz??n?? historie</h3>
-
-V datab??zi jsou ulo??eny i neaktivn?? z??znamy, aby bylo mo??n?? p???? operaci UNDO je op??t aktivovat. M??te v??ak mo??nost vyu???? operace <b><i>Sma??</i></b>, 
-kter?? pro??ist?? datab??zi od neaktivn??ch z??znam?? a z??rove?? sma??e v??echny data z historie. P??ed proveden?? t??to operace by bylo dobr?? prov??st z??lohu 
-datab??ze. Po stisku tla????tka <b><i>Sma??</i></b> se objevi dilog s informaci o operaci, kterou se chyst??te prov??st, a teprve po potvrzen?? tohoto
-dialogu bude operace provedena.
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Historie ??prav</title>
+  </head>
+  <body>
+  <h1>Historie ??prav</h1>
+Plantlore v??m nab??z?? mo??nost sledovat historii zm??n va??ich n??lezov??ch dat. Diky t??to funkci m??te mo??nost zjistit kdo, kdy a jak zm??nil informace o 
+konkr??tn??m n??lezu, autorovi, publikaci ??i metadatech.<br> 
+Mezi z??kladn?? zaznamen??v??n?? informace o zm??n?? pat????:
+<ul> 
+ <li>datum a ??as zm??ny
+ <li>typ operace (vlo??en??, editov??n??, smaz??n??)
+ <li>jm??no u??ivatel, kter?? zm??nu provedl 
+ <li>n??zev editovan?? polo??ky, nebo identifikace vlo??en??ho/smzan??ho z??znamu 
+ <li>star?? hodnota editovan?? polo??ky
+ <li>nov?? hodnota editovan?? polo??ky
+</ul>
+  
+Plantlore krom?? mo??nosti sledovat zm??n??n?? zm??ny v n??lezov??ch datech v??m umo??n?? zru??it n??kter?? zm??ny a vr??tit se tak k d????v??j????m hodnot??m. Historie
+je siln??m n??strojem umo????uj??c?? z??sah do va??ich n??lezov??ch dat a proto je nutne, aby pr??ce s histori?? byla z bezpe??nostn??ch d??vod?? omezena jen na u??ivatele, kte???? maj?? dostate??n?? opr??vn??n?? (viz. <a href="./user.html">Pr??va u??ivatel??</a>).  
+
+<p>
+<i><b>Exituj?? dva odli??n?? zp??soby pr??ce s histori?? ??prav:</b></i> 
+</p>
+
+<a href="#historyRecord">Historie n??lezu</a> - d??v?? u??ivatelovi mo??nost sledovat historii zm??n vybran??ho n??lezu a pou????t operaci UNDO na vybran?? zm??ny<br> 
+<a href="#historyData">Celkov?? historie</a> - d??v?? administr??torovi n??stroj pro kontrolu proveden??ch zm??n v datech a mo??nost prov??st operaci UNDO ke konkr??tn??mu datumu/??asu
+
+<br><br>
+<a name="historyRecord"><h2>Historie n??lezu</h2></a>
+
+<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
+
+<p><br>
+Pro p????stup k historii vybran??ho n??lezu sta???? jen ozna??it tento n??lez a kliknout na tla????tko <i><b>History</b></i>. Pokud je tla????tko <i><b>History</b></i>
+neaktivn?? a p????stup k hsitorii ??prav v??m byl t??mto znemo??n??n, tak nem??te pr??vo na pr??ci s vybran??m n??lezem. Ur??it?? nebude na??kodu  
+zm??nit, kdy m??te pr??vo pracovat s histori?? n??lezu.
+</p>
+Historie n??lezu je p????stupn??:
+<ul>
+   <li>u??ivatelovi, kter?? dan?? n??lez vlo??il do datab??ze</li>
+   <li>u??ivatelovi, kter?? m?? pr??vo editovat z??znamy u??ivatele, kter?? tento n??lez vlo??il do datab??ze</li>
+   <li>u??ivatelovi, kter?? m?? pr??vo editovat v??echny n??lezy ulo??en?? v datab??zi</li>
+   <li>u??ivatelovi, kter?? m?? pr??vo administr??tor</li>   
+</ul>    
+
+Pokud nem??te p????stup k historii n??lezu a cht??li byste ho z??skat, tak kontaktujte administr??tora Plantlore.<br>
+Podrobn??j???? informace o pr??vech u??ivatel?? m????ete nastudovat v ??asti <a href="./user.html">Pr??va u??ivatel??</a>.
+
+<h5>Dialog historie n??lezu</h5>
+
+<img src="picture/historyOcc_cs.png">
+<br><br>
+
+Dialog historie n??lezu je rozd??len do t???? ????st??. 
+<ul>
+  <li><b>Detaily n??lezu</b> - zde jsou zobrazeny z??kladn?? informace o n??lezu (taxon, auto??i n??lezu a lokalita)
+  <li><b>Vytvo??en?? n??lezu</b> - zde jsou zobrazeny informace o vlo??en?? n??lezu do datab??ze (datum/??as vlo??en?? a u??ivatel, kter?? z??znam vlo??il do datab??ze)
+  <li><b>Seznam zm??n</b> - zde jsou zobrazeny z??kladn?? informace o jednotliv??ch zm??n??ch n??lezu 
+</ul>
+  
+<h3>Seznam zm??n</h3>
+
+Seznam zm??n n??lezu je set????zen od ??asov?? nejmlad????ch po ??asov?? nejstar???? zm??nu a je zobrazen v tabulce, kter?? obsahuje n??sleduj??c?? ??daje:  
+  
+<ul>
+<li><b>X</b> - slou???? pro v??b??r jednotliv??ch zm??n</li>
+<li><b>Datum/??as</b> - informuje o dob??, kdy ke zm??n?? do??lo</li>
+<li><b>U??ivatel</b> - odpov??d?? u??ivatelovi, kter?? zm??nu provedl</li>
+<li><b>Polo??ka</b> - informuje o polo??ce, kter?? byla zm??n??na</li>
+<li><b>Star?? hodnota</b> - obsahuje hodnotu polo??ky p??ed zm??nou </li>
+<li><b>Nov?? hodnota</b> - obseahuje novou hodnotu polo??ky </li>
+</ul>
+
+
+<h3>Operace UNDO na vybran?? polo??ky</h3>
+
+V historii n??lezu si m????ete vybrat zm??nu <b>jen konkr??tn?? polo??ky</b> v z??znamu a vr??tit se k jej?? star?? hodnot??. Li???? se tedy od klasick?? UNDO operace, 
+kde se proved??n?? zm??ny v z??znamu vrac?? od nejmlad???? po nejstar???? v ??asov??m sledu v jak??m k nim do??lo. Uve??m?? si p????klad, kdy vyu??ijeme zm??n??n??ho 
+vylep??en?? operace UNDO: 
+<div style="text-align:justify; padding: 20 20 30 20">
+<i> Ud??l??te opravy polo??ek "Herb????", "Rok n??lezu", "Pozn??mku k n??lezu" a po t??chto oprav??ch ud??l??te je??t?? dal????ch dvacet zm??n??m. 
+U?? si nepamatujete p??esn?? prvn?? ulo??en?? zn??n?? pozn??mky k n??lezu, ale chcete se k n??mu vr??tit. U klasick??ho operace UNDO byste museli zru??it postupn?? v??echny 
+posledn?? zm??n, abyste nastavili zp??t prvn?? zn??n?? pozn??ky k n??lezu. V dialogu historie je spln??n?? va??eho po??adavku jednoduch??. Pokud budete cht??t jen
+zjistit prvn?? zn??n?? pozn??mky k n??lezu, sta???? si v seznamu zm??n naj??t nejstar???? zn??mu pozn??mky a v sloupku STAR?? HODNOTA u?? vid??te hledan?? text.
+Pokud chcete pozn??mce nastavit jej?? prvn?? ulo??enou hodnotu, tak sta???? naj??t nejstar???? zm??nu v??sledku revize, vybrat dan?? ????dek pomoc??
+sloupku X a kliknout na tla????tko <b>UNDO</b>. Nelekn??te se, ??e v??b??rem dan??ho ????dku se v??m vyberou i ????dky, v kter??ch je zaznamen??na mlad????
+zm??na t??to pozn??mky, toto chov??n?? vych??z?? z logiky ozna??ov??n?? zm??n (pops??no n????e).</i> 
+</div>
+
+Jak ji?? bylo zm??n??no, tak pomoc?? sloubku X vyb??r??te ??pravy, kter?? chcete vr??tit. Ozna??en?? ??i odzna??en?? lze prov??st my???? kliknut??m v sloubku X po??adovan??ho
+????dku. Pro ozna??ov??n?? m????ete vyu????t i tla????tka <b><i>Vyber v??e</i></b> a <b><i>Odzna?? v??e</i></b>, kter?? ozna???? nebo odzna???? v??echny zm??ny n??lezu zobrazen?? v tabulce.
+Po??et polo??ek zobrazen??ch v tabulce si m????ete sami nastavit p??eps??n??m hodnoty pro <b><i>Zobrazit ????dk??</i></b> a potvrzen??m nov?? hodnoty kl??vesov??m tla????tkem 
+ENTER. V tabulce se p??ep??n??te na dal???? nebo p??edchoz?? seznam zm??n pomoc?? tla????tek <b><i>P??edchoz??</i></b> a <b><i>N??sleduj??c??</i></b>. Informace o aktu??ln?? 
+zobrazen??m seznamu zm??n jsou uvedeny v ????sti pod tabulkou.
+
+<br><br> 
+Po stisknut?? tla????tko <b><i>UNDO</i></b> se zobraz?? informace se seznamem zm??n, kter?? budou provedeny. Volbou tla????tka CANCLE zru????te operaci. 
+Volbou tla????tka OK naopak potvrd??te operaci a provede se n??vrat vybran??ch zm??n n??lezu. Z historie budou smaz??ny v??echny ozna??en?? ????dky v dob?? zavol??n??
+operace <b><i>UNDO</i></b> (na ozna??en?? ????dky byla provedena operace UNDO). 
+
+<br><br>
+<img src="picture/historyUndo_cs.png">
+<br><br>
+
+<h3><i>Logika ozna??ov??n?? zm??n</i></h3>
+
+Polo??ky v z??znamu m????ou b??t upravov??ny v??cekr??t, proto je p??i ozna??ov??n?? zm??n v dialogu historie nutn?? o??et??it n??kolik situac?? (viz. n????e).<br>
+Pro lep???? n??zorn??j???? vysv??tlen?? si to uve??me na p????kladu:<br><br> 
+
+<img src="picture/historyOccMark_cs.png">
+<br><br>
+
+<i>P??edpokl??dejme, ??e polo??ka HERB???? byla n-kr??t zm??n??na. V dialogu historie existuje n ????dk??, kter?? informuj?? o zm??n?? polo??ky HERB????. Ve v????e 
+uveden??m obr??zku je vid??t zm??na HERB???? 15.8.2006 11:39 z hodnoty CB/910 na hodnotu CB/913, mlad???? zm??na HERB???? 15.8.2006 11:40 z hodnoty CB/913 na hodnotu CB/918
+a nejmlad???? zm??na HERB???? 15.8.2006 12:36 z hodnoty CB/918 na hodnotu CB/968.
+P??i ozna??ov??n?? a odzna??ov??n?? t??chto zm??n m????e doj??t k n??sleduj??c??m situac??m:
+<ul> 
+<li> U??ivatel se chce vr??tit k situaci, kdy polo??ka HERB???? m??la hodnotu CB/910. Mus?? tedy ozna??it p????slu??n?? ????dek se zm??nou z 15.8.2006 11:39. Proto??e 
+existuj?? je??t?? mlad???? zm??ny polo??ky HERB????, budou ozna??eny i ????dky pro zm??ny HERB???? 15.8.2006 11:40 a HERB???? 15.8.2006 12:36. Po zavol??n?? operace 
+<b>UNDO</b> bude m??t polo??ka HERB???? zvolen??ho zaznamu hodnotu CB/910 a z historie budou smaz??ny v??echny ozna??en?? ????dky.  
+<li> U??ivatel m?? v dialogu ozna??en?? zm??ny polo??ky HERB???? z 15.8.2006 11:39, 15.8.2006 11:40 a 15.8.2006 12:36 a rozhodl se jen pro n??vrat zm??ny z 15.8.2006 11:39, to je k hodnot?? CB/918. 
+V t??to situaci mus?? u??ivatel odzna??it zm??nu z 15.8.2006 11:40. Pokud by byly ozna??eny i star???? zm??ny (nap??. 15.8.2006 11:39) polo??ky HERB????, 
+budou odzna??en??m zm??ny z 15.8.2006 11:40 automaticky odzna??eny. 
+<li> U??ivatel m?? v dialogu ozna??en?? zm??ny polo??ky HERB???? z 15.8.2006 11:39, 15.8.2006 11:40 a 15.8.2006 12:36 a rozhodl se tyto zm??ny neprov??st. 
+K odzna??en?? v??ech zm??n polo??ky HERB???? sta???? odzna??it nejmlad???? zm??nu a automaticky buou odzna??ny zm??ny star????. 
+U??ivatel odzna??en??m mlad???? zm??ny ??ekne, ??e chce zachovat tuto zm??nu polo??ky HERB????.  
+</ul>
+</i><br>
+
+<a name="historyData"><h2>Celkov?? historie</h2></a> 
+
+<br>
+<img src="picture/wholeHistoryEnter_cs.png">
+<br><br>
+
+Dialog celkov?? historie sledovan??ch zm??n je p????stupn?? pouze u??ivatelovi s pr??vem administr??tora. Pokud m??te administr??torsk?? pr??va m????ete tento 
+dialog otev???? z menu <b>Data/Celkov?? historie</b>. Pokud administr??torsk?? pr??va nem??te je polo??ka v menu pro v??s neaktivn??.
+
+<h5>Dialog celkov?? historie</h5>
+
+<img src="picture/wholeHistoryDialog_cs.png">
+<br><br>
+
+V dialogu je zobrazen seznam v??ech zm??n t??kaj??c??ch se metadat, n??lez??, autor?? a publikac??. Tento seznam je set????zen od ??asov?? nejmlad????ch po 
+??asov?? nejstar???? zm??nu a je zobrazen v tabulce, kter?? obsahuje n??sleduj??c?? ??daje:  
+  
+<ul>
+<li><b>Datum/??as</b> - informuje o dob??, kdy ke zm??n?? do??lo</li>
+<li><b>Operace</b> - informuje o operaci, kter?? byla provedena (vlo??en??, editov??n??, smaz??n??)</li>
+<li><b>U??ivatel</b> - odpov??d?? u??ivatelovi, kter?? zm??nu provedl</li>
+<li><b>Polo??ka</b> - informuje o polo??ce, kter?? byla zm??n??na</li>
+<li><b>Star?? hodnota</b> - obsahuje hodnotu polo??ky p??ed zm??nou (vypln??na jen pro operaci edit)</li>
+<li><b>Nov?? hodnota</b> - obseahuje novou hodnotu polo??ky (vypln??na jen pro operaci edit)</li>
+</ul>
+
+
+<img src="picture/wholeHistoryDetail_cs.png">
+<br><br>
+
+Pokud chcete zjistit podrobn??j???? informace o n??lezu, metadatech, autorovi nebo publikaci, tak ozna??te ????dek tabulky se zm??nou, pro kterou se 
+zaj??mate o podrobn??j???? informace, a stiskn??te tla????tko <b><i>Detail</i></b>. 
+
+<h3>Operace UNDO ke zvolen??mu datumu a ??asu</h3>
+
+Operace <b><i>Undo</i></b> vrac?? postupn?? zm??ny proveden?? v datab??zi a to od ??asov?? nejmlad???? po ??asov?? nejstar???? zm??nu. P??ed stisknut??m tla????tka
+UNDO je nutn?? ozna??it ????dek tabulky, do kter??ho (i v??etn?? n??j) se m?? prov??st n??vrat zm??n v datab??zi. Po stisknut?? tla????tka <b><i>Undo</i></b> 
+se zobraz?? informace o zvolen??m datumu/??ase pro tuto operaci. N??sledn??m potvrzen??m tla????tkem OK dojde k proveden?? operace UNDO a z??rove?? smaz??n?? 
+vr??cen??ch zm??n z historie.   
+
+<h3>Pro??i??t??n?? datab??ze a smaz??n?? historie</h3>
+
+V datab??zi jsou ulo??eny i neaktivn?? z??znamy, aby bylo mo??n?? p???? operaci UNDO je op??t aktivovat. M??te v??ak mo??nost vyu???? operace <b><i>Sma??</i></b>, 
+kter?? pro??ist?? datab??zi od neaktivn??ch z??znam?? a z??rove?? sma??e v??echny data z historie. P??ed proveden?? t??to operace by bylo dobr?? prov??st z??lohu 
+datab??ze. Po stisku tla????tka <b><i>Sma??</i></b> se objevi dilog s informaci o operaci, kterou se chyst??te prov??st, a teprve po potvrzen?? tohoto
+dialogu bude operace provedena.  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,92 +1,83 @@
-<html>
-
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>Import dat</title>
-
-	</head>
-
-<body>
-
-	<h1>Import n??lezov??ch dat</h1>
-
-	<p>
-	Import slou???? k znovuna??ten?? n??lezov??ch dat ze souboru na disku do datab??ze programu.
-	Jde o komplement <a href="./export.html">Exportu</a>.
-	</p>
-
-	<p>
-	Import lze prov??d??t po p??ihl????en?? k jak??koli datab??zi - tedy i k datab??zi vzd??len??.
-	U vzd??len??ho p??ipojen?? je nutn?? uv????it p??enosovou kapacitu linky, 
-	kterou pou????v??te pro p??ipojen??, 
-	nebo?? p??en????en?? mno??stv?? dat m????e b??t velk?? a doba nutn?? 
-	k naimportov??n?? n??lezov??ch dat by byla ne??nosn??.
-	</p>
-
-
-	<h2>1. Vlastn?? import n??lezov??ch dat</h2>
-
-	<p>
-	Import za????n?? v??b??rem souboru, v n??m?? jsou ulo??ena n??lezov?? data.
-	V sou??asn?? dob?? je podporov??n pouze import z XML soubor??, kter??
-	odpov??daj?? PlantloreNative form??tu.
-	</p>
-
-	<p>
-	Po v??b??ru souboru je zobrazeno okno zobrazuj??c?? pr??b??h procesu importov??n?? dat. 
-	Import lze p??eru??it stiskem tla????tka <i>Storno</i>. 
-	P??eru????te-li Import, n??lezov?? data, kter?? se stihla naimportovat, v datab??zi z??stanou.
-	</p>
-
-
-	<h2>2. Co je dobr?? v??d??t p??i importu n??lezov??ch dat</h2>
-
-	<p>
-	Import dat je <b>dlouhotrvaj??c??</b> operace, p??i n???? doch??z?? k modifikaci datab??ze. 
-	Plantlore mus?? zajistit,
-	aby nebyla po??kozena integrita st??vaj??c??ch n??lezov??ch dat. 
-	</p>
-
-	<p>
-	P??i importu m????e doj??t k situaci, kdy jsou n??kter?? ????sti n??lezov??ho z??znamu sd??leny v??ce z??znamy
-	(nap??. Habitat). Pokud se do datab??ze importuj?? n??lezov?? data, kter?? se ji?? v datab??zi
-	nach??z?? a p??itom se li????, budou sd??len?? ????sti, kter?? jsou odli??n??, nahrazeny nov??mi
-	(aktualizovan??mi), p??i??em?? p??vodn?? ????st z??stane nedot??ena.
-	<br/>
-	Pokud nap????klad n??lezov?? z??znamy A a B v datab??zi sd??l?? habitat H a p??i importu naraz??me
-	na modifikaci z??znamu A s habitatem I, bude z??znamu A p??i??azen nov?? habitat I, ale
-	nedojde k oprav?? habitatu H. V datab??zi se pak budou nach??zet z??znamy A-I a B-H, oba
-	dva s r??zn??mi habitaty.
-	</p>
-
-	<p>
-	Zam??tnut?? z??znamu, tj. neproveden?? po??adovan?? operace s n??lezov??m z??znamem, 
-	m????e nastat z n??sleduj??c??ch d??vod??:
-	<ol>
-		<li>
-		Nedostate??n?? opr??vn??n?? - nem??te-li pr??vo n??lezov?? data modifikovat -
-		typicky nesm??te modifikovat z??znamy, kter?? jste v datab??zi sami nevytvo??ili. 
-		V??ce o pr??vech lze nal??zt v sekci <a href="./user.html">Pr??va u??ivatel??</a>.
-		</li>
-
-		<li>
-		Ne??pln?? n??lezov?? z??znam, tj. z??znam neobsahuj??c?? v??echny povinn?? polo??ky.
-		</li>
-
-		<li>
-		Nekorektn?? z??znam, tj. z??znam, kter?? obsahuje data, kter?? nelze dohledat
-		v datab??zi - plat?? pro tabulky Plants, Villages, Phytochoria, Territories
-		a Metadata. Do datab??ze nap??. nelze vlo??it n??lez, kter?? obsahuje rostlinu,
-		kter?? se nenach??z?? v datab??zi. V??ce v 
-		<a href="./table_import.html">Import dat do tabulek</a>.
-		</li>
-	</ol>
-	</p>
-
-	<p>
-	</p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Import dat</title>
+  </head>
+  <body>
+  <h1>Import n??lezov??ch dat</h1>
+	<p>
+	Import slou???? k znovuna??ten?? n??lezov??ch dat ze souboru na disku do datab??ze programu.
+	Jde o komplement <a href="./export.html">Exportu</a>.
+	</p>
+
+	<p>
+	Import lze prov??d??t po p??ihl????en?? k jak??koli datab??zi - tedy i k datab??zi vzd??len??.
+	U vzd??len??ho p??ipojen?? je nutn?? uv????it p??enosovou kapacitu linky, 
+	kterou pou????v??te pro p??ipojen??, 
+	nebo?? p??en????en?? mno??stv?? dat m????e b??t velk?? a doba nutn?? 
+	k naimportov??n?? n??lezov??ch dat by byla ne??nosn??.
+	</p>
+
+
+	<h2>1. Vlastn?? import n??lezov??ch dat</h2>
+
+	<p>
+	Import za????n?? v??b??rem souboru, v n??m?? jsou ulo??ena n??lezov?? data.
+	V sou??asn?? dob?? je podporov??n pouze import z XML soubor??, kter??
+	odpov??daj?? PlantloreNative form??tu.
+	</p>
+
+	<p>
+	Po v??b??ru souboru je zobrazeno okno zobrazuj??c?? pr??b??h procesu importov??n?? dat. 
+	Import lze p??eru??it stiskem tla????tka <i>Storno</i>. 
+	P??eru????te-li Import, n??lezov?? data, kter?? se stihla naimportovat, v datab??zi z??stanou.
+	</p>
+
+
+	<h2>2. Co je dobr?? v??d??t p??i importu n??lezov??ch dat</h2>
+
+	<p>
+	Import dat je <b>dlouhotrvaj??c??</b> operace, p??i n???? doch??z?? k modifikaci datab??ze. 
+	Plantlore mus?? zajistit,
+	aby nebyla po??kozena integrita st??vaj??c??ch n??lezov??ch dat. 
+	</p>
+
+	<p>
+	P??i importu m????e doj??t k situaci, kdy jsou n??kter?? ????sti n??lezov??ho z??znamu sd??leny v??ce z??znamy
+	(nap??. Habitat). Pokud se do datab??ze importuj?? n??lezov?? data, kter?? se ji?? v datab??zi
+	nach??z?? a p??itom se li????, budou sd??len?? ????sti, kter?? jsou odli??n??, nahrazeny nov??mi
+	(aktualizovan??mi), p??i??em?? p??vodn?? ????st z??stane nedot??ena.
+	<br/>
+	Pokud nap????klad n??lezov?? z??znamy A a B v datab??zi sd??l?? habitat H a p??i importu naraz??me
+	na modifikaci z??znamu A s habitatem I, bude z??znamu A p??i??azen nov?? habitat I, ale
+	nedojde k oprav?? habitatu H. V datab??zi se pak budou nach??zet z??znamy A-I a B-H, oba
+	dva s r??zn??mi habitaty.
+	</p>
+
+	<p>
+	Zam??tnut?? z??znamu, tj. neproveden?? po??adovan?? operace s n??lezov??m z??znamem, 
+	m????e nastat z n??sleduj??c??ch d??vod??:
+	<ol>
+		<li>
+		Nedostate??n?? opr??vn??n?? - nem??te-li pr??vo n??lezov?? data modifikovat -
+		typicky nesm??te modifikovat z??znamy, kter?? jste v datab??zi sami nevytvo??ili. 
+		V??ce o pr??vech lze nal??zt v sekci <a href="./user.html">Pr??va u??ivatel??</a>.
+		</li>
+
+		<li>
+		Ne??pln?? n??lezov?? z??znam, tj. z??znam neobsahuj??c?? v??echny povinn?? polo??ky.
+		</li>
+
+		<li>
+		Nekorektn?? z??znam, tj. z??znam, kter?? obsahuje data, kter?? nelze dohledat
+		v datab??zi - plat?? pro tabulky Plants, Villages, Phytochoria, Territories
+		a Metadata. Do datab??ze nap??. nelze vlo??it n??lez, kter?? obsahuje rostlinu,
+		kter?? se nenach??z?? v datab??zi. V??ce v 
+		<a href="./table_import.html">Import dat do tabulek</a>.
+		</li>
+	</ol>
+	</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,10 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Plantlore</title>
-</head>
-<body>
-<h1>Plantlore</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+    <title>Plantlore - N??pov??da</title>
+  </head>
+  <body>
+    <h1>Plantlore - N??pov??da</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/licence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/licence.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/licence.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,310 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Licence</title>
-</head>
-<body>
-<h1>Licence</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
+    <title></title>
+  </head>
+  <body>
+<center>
+<h1>Obecn?? ve??ejn?? licence GNU</h1>
+
+??esk?? p??eklad verze 2, ??erven 1991<p>
+
+Copyright (C) 1989, 1991 <a href="http://www.gnu.org">Free Software Foundation</a>, Inc.
+675 Mass Ave, Cambridge, MA 02139, USA
+<p>
+Kop??rov??n?? a distribuce doslovn??ch kopi?? tohoto licen??n??ho dokumentu jsou
+dovoleny komukoliv, jeho zm??ny jsou v??ak zak??z??ny.
+
+</center>
+
+<h2>Preambule</h2>
+
+<p>Softwarov?? licence jsou v??t??inou navr??eny tak, ??e v??m odeb??raj?? pr??vo
+voln??ho sd??len?? a ??prav program??. Smyslem Obecn?? ve??ejn?? licence GNU
+je naproti tomu zaru??it volnost ke sd??len?? a ??prav??m voln??ho
+softwaru--pro zaji??t??n?? voln??ho p????stupu k tomuto softwaru pro
+v??echny jeho u??ivatele. Tato Obecn?? ve??ejn?? licence GNU se vztahuje
+na v??t??inu softwaru nadace Free Software Foundation a na jak??koli jin??
+program, jeho?? autor se p??iklon?? k jej??mu pou????v??n??. (N??kter?? dal????
+software od Free Software Foundation je nam??sto toho pokryt Obecnou
+knihovn?? ve??ejnou licenc?? GNU.) M????ete ji rovn???? pou????t pro sv?? programy.</p>
+
+<p>Pokud mluv??me o voln??m softwaru, m??me na mysli volnost, nikoliv
+cenu.  Na??e Obecn?? ve??ejn?? licence je navr??ena pro zaji??t??n?? toho, ??e
+m????ete voln?? ??????it kopie voln??ho softwaru (a ????tovat si poplatek za
+tuto slu??bu, pokud chcete), ??e obdr????te zdrojov?? k??d anebo jej m????ete
+z??skat, pokud ho chcete, ??e m????ete tento software modifikovat nebo
+jeho ????sti pou????t v nov??ch voln??ch programech; a ??e v??te, ??e tyto v??ci
+sm??te d??lat.</p>
+
+<p>Abychom mohli va??e pr??va chr??nit, mus??me vytvo??it omezen??, kter??
+zak?????? komukoli v??m tato pr??va odep??rat nebo v??s ????dat, abyste se
+t??chto pr??v vzdal. Tato omezen?? se prom??taj?? do jist??ch povinnost??,
+kter??m mus??te dost??t, pokud ????????te kopie doty??n??ho softwaru
+anebo ho modifikujete.</p>
+
+<p>Nap????klad, ????????te-li kopie takov??ho programu, a?? ji?? zdarma nebo za
+poplatek, mus??te poskytnout p????jemc??m v??echna pr??va, kter?? m??te s??m.
+Mus??te zaru??it, ??e p????jemci rovn???? dostanou anebo mohou z??skat
+zdrojov?? k??d. A mus??te jim uk??zat tyto podm??nky, aby znali sv?? pr??va.</p>
+
+<p>Va??e pr??va chr??n??me ve dvou kroc??ch: (1)&nbsp;autorizac?? softwaru, a
+(2)&nbsp;nab??dkou t??to licence, kter?? v??m d??v?? pr??voplatn?? svolen?? ke
+kop??rov??n??, ??????en?? a modifikaci softwaru.</p>
+
+<p>Kv??li ochran?? ka??d??ho autora i n??s samotn??ch chceme zajistit, aby ka??d??
+ch??pal skute??nost, ??e pro voln?? software neplat?? ????dn?? z??ruky. Je-li
+software n??k??m jin??m modifikov??n a posl??n d??le, chceme, aby p????jemci
+v??d??li, ??e to, co maj??, nen?? origin??l, tak??e jak??koliv probl??my
+vnesen?? jin??mi se neodraz?? na reputaci p??vodn??ch autor??.</p>
+
+<p>Kone??n??, ka??d?? voln?? program je neust??le ohro??en softwarov??mi
+patenty. P??ejeme si zamezit nebezpe????, ??e redistributo??i voln??ho
+programu obdr???? samostatn?? patentov?? osv??d??en?? a t??m u??in?? program
+v??zan??m. Abychom tomu zamezili, deklarovali jsme, ??e ka??d?? patent mus??
+b??t bu?? vyd??n s t??m, ??e umo????uje ka??d??mu voln?? u??it??, anebo nesm?? b??t
+vyd??n v??bec.</p>
+
+<p>P??esn?? ustanoven?? a podm??nky pro kop??rov??n??, ??????en?? a modifikaci
+jsou uvedeny d??le.</p>
+
+<h2>Ustanoven?? a podm??nky pro kop??rov??n??, distribuci a modifikaci</h2>
+
+<p><b>0.</b>
+Tato licence se vztahuje na kter??koliv program ??i jin?? d??lo, kter??
+obsahuje zm??nku, um??st??nou v n??m dr??itelem autorsk??ch pr??v, o tom, ??e
+d??lo m????e b??t ??????eno podle ustanoven?? Obecn?? ve??ejn?? licence GNU. V
+dal????m textu znamen?? "program" ka??d?? takov?? program nebo d??lo a
+"d??lo zalo??en?? na programu" znamen?? bu?? program samotn?? anebo
+ka??d?? jin?? d??lo z n??j odvozen??, kter?? podl??h?? autorsk??mu z??konu: t??m
+se m??n?? d??lo obsahuj??c?? program nebo jeho ????st, bu?? doslovn?? anebo s
+modifikacemi, pop????pad?? v p??ekladu do jin??ho jazyka. (Nad??le je
+p??eklad zahrnov??n bez omezen?? pod pojem "modifikace".) Ka??d??
+u??ivatel licence je ozna??ov??n jako "vy".</p>
+
+<p>Jin?? ??innosti ne?? kop??rov??n??, ??????en?? a modifikace nejsou pokryty touto
+licenc??; sahaj?? mimo jej?? r??mec. Akt spu??t??n?? programu nen?? omezen a
+v??stup z programu je pokryt pouze tehdy, jestli??e obsah v??stupu tvo????
+d??lo zalo??en?? na programu (nez??visle na tom, zda bylo vytvo??eno
+??innost?? programu). Posouzen?? platnosti p??edchoz?? v??ty z??vis?? na tom,
+co program d??l??.</p>
+
+<p><b>1.</b>
+Sm??te kop??rovat a ??????it doslovn?? kopie zdrojov??ho k??du
+programu tak, jak jste jej obdr??el, a na libovoln??m m??diu, za
+p??edpokladu, ??e na ka??d?? kopii viditeln?? a n??le??it?? zve??ejn??te zm??nku
+o autorsk??ch pr??vech a absenci z??ruky; ponech??te nedot??en?? v??echny
+zm??nky vztahuj??c?? se k t??to licenci a k absenci z??ruky; a d??te ka??d??mu
+p????jemci spolu s programem kopii t??to licence.</p>
+
+<p>Za fyzick?? akt p??enesen?? kopie m????ete ????dat poplatek a podle vlastn??ho
+uv????en?? m????ete nab??dnout za poplatek z??ru??n?? ochranu.</p>
+
+<p><b>2.</b>
+M????ete modifikovat va??i kopii ??i kopie programu anebo
+kter??koliv jeho ????sti, a tak vytvo??it d??lo zalo??en?? na programu, a
+kop??rovat a roz??i??ovat takov?? modifikace ??i d??lo podle podm??nek
+paragrafu&nbsp;1 v????e, za p??edpokladu, ??e spln??te v??echny tyto podm??nky:</p>
+
+<ul>
+<li><b>a)</b> Modifikovan?? soubory mus??te opat??it z??etelnou zm??nkou uv??d??j??c??,
+??e jste soubory zm??nil a datum ka??d?? zm??ny.
+<li><b>b)</b> Mus??te umo??nit, aby jak??koliv v??mi publikovan?? ??i roz??i??ovan??
+d??lo, kter?? obsahuje zcela nebo z????sti program nebo jakoukoli jeho
+????st, pop????pad?? je z programu nebo jeho ????sti odvozeno, mohlo b??t jako
+celek bezplatn?? poskytnuto ka??d?? t??et?? osob?? v souladu s ustanoven??mi
+t??to licence.
+<li><b>c)</b> Pokud modifikovan?? program pracuje norm??ln?? tak, ??e ??te
+interaktivn?? povely, mus??te zajistit, ??e p??i nejb????n??j????m zp??sobu jeho
+spu??t??n?? vytiskne nebo zobraz?? hl????en?? zahrnuj??c?? p????slu??nou zm??nku o
+autorsk??m pr??vu a uvede, ??e neexistuje ????dn?? z??ruka (nebo p????padn??, ??e
+z??ruku poskytujete vy), a ??e u??ivatel?? mohou za t??chto podm??nek
+program redistribuovat, a mus?? u??ivateli sd??lit, jak??m zp??sobem
+m????e nahl??dnout do kopie t??to licence. (V??jimka: v p????pad??, ??e s??m program
+je interaktivn??, av??ak ????dn?? takov?? hl????en?? nevypisuje, nepo??aduje se,
+aby va??e d??lo zalo??en?? na programu takov?? hl????en?? vypisovalo.)</ul>
+</p>
+
+<p>Tyto po??adavky se vztahuj?? k modifikovan??mu d??lu jako celku. Pokud lze
+identifikovat ????sti takov??ho d??la, kter?? z??ejm?? nejsou odvozeny z
+programu a mohou b??t samy o sob?? rozumn?? pova??ov??ny za nez??visl?? a
+samostatn?? d??la, pak se tato licence a jej?? ustanoven?? nevztahuj?? na
+tyto ????sti, jsou-li ??????eny jako nez??visl?? d??la. Av??ak jakmile tyt????
+????sti roz??i??ujete jako ????st celku, j??m?? je d??lo zalo??en?? na programu,
+mus?? b??t roz??i??ov??n?? tohoto celku pod????zeno ustanoven??m t??to licence
+tak, ??e povolen?? poskytnut?? dal????m u??ivatel??m se roz???????? na cel?? d??lo,
+tedy na v??echny jeho ????sti bez ohledu na to, kdo kterou ????st napsal.</p>
+
+<p>Smyslem tohoto paragrafu tedy nen?? z??sk??n?? pr??v na d??lo zcela napsan??
+v??mi ani pop??r??n?? va??ich pr??v v????i n??mu; skute??n??m smyslem je
+v??kon pr??va na ????zen?? distribuce odvozen??ch nebo kolektivn??ch d??l
+zalo??en??ch na programu.</p>
+
+<p>Pouh?? spojen?? jin??ho d??la, je?? nen?? na programu zalo??eno, s
+programem (anebo d??lem zalo??en??m na programu) na pam????ov??m nebo
+distribu??n??m m??diu neuvazuje toto jin?? d??lo do p??sobnosti t??to
+licence.</p>
+
+<p><b>3.</b>
+M????ete kop??rovat a roz??i??ovat program (nebo d??lo na n??m
+zalo??en??, viz paragraf 2) v objektov?? anebo spustiteln?? podob?? podle
+ustanoven?? paragraf?? 1 a&nbsp;2 v????e, pokud spln??te n??kterou z n??sleduj??c??ch
+n??le??itost??:</p>
+
+<ul>
+<li><b>a)</b> Doprovod??te jej zdrojov??m k??dem ve strojov?? ??iteln?? form??.
+Zdrojov?? k??d mus?? b??t roz??i??ov??n podle ustanoven?? paragraf?? 1 a&nbsp;2 v????e,
+a to na m??diu b????n?? pou????van??m pro v??m??nu softwaru; nebo
+
+<li><b>b)</b> Doprovod??te jej p??semnou nab??dkou s platnost?? nejm??n?? t??i roky,
+podle n???? poskytnete jak??koli t??et?? stran??, za poplatek nep??evy??uj??c??
+va??e v??daje vynalo??en?? na fyzickou v??robou zdrojov?? distribuce,
+kompletn?? strojov?? ??itelnou kopii odpov??daj??c??ho zdrojov??ho k??du, jen??
+mus?? b??t ??????en podle ustanoven?? paragraf?? 1 a&nbsp;2 v????e na m??diu b????n??
+pou????van??m pro v??m??nu softwaru; nebo
+<li><b>c)</b> Doprovod??te jej informacemi, kter?? jste dostal ohledn?? nab??dky
+na poskytnut?? zdrojov??ho k??du. (Tato alternativa je povolena jen pro
+nekomer??n?? ??????en?? a jenom tehdy, pokud jste obdr??el program v
+objektov??m nebo spustiteln??m tvaru spolu s takovou nab??dkou, v souladu
+s polo??kou b v????e.)
+</ul></p>
+
+<p>Zdrojov?? k??d k d??lu je nejvhodn??j???? formou d??la z hlediska jeho
+p????padn??ch modifikac??. Pro d??lo ve spustiteln??m tvaru znamen?? ??pln??
+zdrojov?? k??d ve??ker?? zdrojov?? k??d pro v??echny moduly, kter?? obsahuje,
+plus jak??koli dal???? soubory pro definici rozhran??, plus d??vkov??
+soubory pot??ebn?? pro kompilaci a instalaci spustiteln??ho programu.
+Zvl????tn?? v??jimkou jsou v??ak ty softwarov?? komponenty, kter?? jsou
+norm??ln?? ??????eny (bu?? ve zdrojov?? nebo bin??rn?? form??) s hlavn??mi
+sou????stmi opera??n??ho syst??mu, na n??m?? spustiteln?? program b?????? (tj.
+s p??eklada??em, j??drem apod.). Tyto komponenty nemus?? b??t ??????eny se
+zdrojov??m k??dem, pokud ov??em komponenta sama nedoprov??z?? spustitelnou
+podobu d??la.</p>
+
+<p>Je-li ??????en?? objektov??ho nebo spustiteln??ho k??du ??in??no nab??dkou
+p????stupu ke kop??rov??n?? z ur??it??ho m??sta, potom se za distribuci
+zdrojov??ho k??du po????t?? i nab??dnut?? ekvivalentn??ho p????stupu ke
+kop??rov??n?? zdrojov??ho k??du ze stejn??ho m??sta, by?? p??itom nejsou t??et??
+strany nuceny ke zkop??rov??n?? zdrojov??ho k??du spolu s objektov??m.</p>
+
+<p><b>4.</b>
+
+Nesm??te kop??rovat, modifikovat, poskytovat sublicence anebo
+??????it program jin??m zp??sobem ne?? v??slovn?? uveden??m v t??to licenci.
+Jak??koli jin?? pokus o kop??rov??n??, modifikov??n??, poskytnut?? sublicence anebo
+??????en?? programu je neplatn?? a automaticky ukon???? va??e pr??va dan?? touto
+licenc??. Strany, kter?? od v??s obdr??ely kopie anebo pr??va v souladu s
+touto licenc??, v??ak nemaj?? sv?? licence ukon??eny, dokud se jim pln?? pod??izuj??.</p>
+
+<p><b>5.</b>
+Nen?? va???? povinost?? tuto licenci p??ijmout, proto??e jste ji
+nepodepsal. Nic jin??ho v??m v??ak ned??v?? mo??nost kop??rovat nebo ??????it
+program nebo odvozen?? d??la. V p????pad??, ??e tuto licenci nep??ijmete,
+jsou tyto ??innosti z??konem zak??z??ny. T??m p??dem modifikac?? anebo
+??????en??m programu (anebo ka??d??ho d??la zalo??en??ho na programu)
+vyjad??ujete sv?? pod????zen?? se licenci a v??em jej??m ustanoven??m a
+podm??nk??m pro kop??rovan??, modifikov??n?? a ??????en?? programu a d??l na n??m
+zalo??en??ch.</p>
+
+<p><b>6.</b>
+Poka??d??, kdy?? redistribuujete program (nebo
+d??lo zalo??en?? na programu), z??sk??v?? p????jemce od p??vodn??ho dr??itele
+licence pr??vo kop??rovat, modifikovat a ??????it program v souladu s
+t??mito ustanoven??mi a podm??nkami. Nesm??te kl??st ????dn?? dal???? p??ek????ky
+v??konu zde zaru??en??ch p????jemcov??ch pr??v. Nejste odpov??dn?? za vym??h??n??
+dodr??ov??n?? t??to licence t??et??mi stranami.</p>
+
+<p><b>7.</b>
+Jsou-li v??m z rozhodnut?? soudu, obvin??n??m z poru??en?? patentu
+nebo z jak??hokoli jin??ho d??vodu (nejen v souvislosti s patenty)
+ulo??eny takov?? podm??nky (a?? ji?? p????kazem soudu, smlouvou nebo jinak),
+kter?? se vylu??uj?? s podm??nkami t??to licence, nejste t??m osvobozen od
+podm??nek t??to licence. Pokud nem????ete ??????it program tak, abyste
+vyhov??l z??rove?? sv??m z??vazk??m vypl??vaj??c??m z t??to licence a jin??m
+platn??m z??vazk??m, nesm??te jej v d??sledku toho ??????it v??bec. Pokud by
+nap????klad patentov?? osv??d??en?? nepovolovalo bezplatnou redistribuci
+programu v??emi, kdo va????m p??i??in??n??m z??skaj?? p????mo nebo nep????mo jeho
+kopie, pak by jedin?? mo??n?? zp??sob jak vyhov??t z??rove?? patentov??mu
+osv??d??en?? i t??to licenci spo????val v ukon??en?? distribuce programu.</p>
+
+<p>Pokud by se za n??jak??ch specifick??ch okolnost?? jevila n??kter?? ????st
+tohoto paragrafu jako neplatn?? nebo nevynutiteln??, pova??uje se za
+sm??rodatnou rovnov??ha vyj??d??en?? t??mto paragrafem a paragraf jako celek
+se pova??uje za sm??rodatn?? za jin??ch okolnost??.</p>
+
+<p>Smyslem tohoto paragrafu nen?? nav??d??t v??s k poru??ov??n?? patent?? ??i
+jin??ch ustanoven?? vlastnick??ho pr??va, anebo tato ustanoven??
+zpochyb??ovat; jedin??m jeho smyslem je ochrana integrity
+syst??mu ??????en?? voln??ho softwaru, kter?? je podlo??en ve??ejn??mi
+licen??n??mi p??edpisy. Mnoz?? lid?? poskytli sv?? p????sp??vky do ??irok??ho
+okruhu softwaru ??????en??ho t??mto syst??mem, spolehnuv??e se na jeho d??sledn??
+uplat??ov??n??; z??le???? na autorovi/d??rci, aby rozhodl, zda si p??eje ??????it
+software pomoc?? n??jak??ho jin??ho syst??mu a ????dn?? u??ivatel licence nem????e
+takov?? rozhodnut?? zpochyb??ovat.</p>
+
+<p>Smyslem tohoto paragrafu je zevrubn?? osv??tlit to, co je pova??ov??no za
+d??sledek plynouc?? ze zbytku t??to licence.</p>
+
+<p><b>8.</b>
+Pokud je ??????en?? ??i pou??it?? programu v n??kter??ch zem??ch
+omezeno bu?? patenty anebo autorsky chr??n??n??mi rozhran??mi, m????e dr??itel
+p??vodn??ch autorsk??ch pr??v, kter?? sv????uje program do p??sobnosti t??to
+licence, p??idat v??slovn?? omezen?? pro geografick?? ??????en??, vylu??uj??c??
+takov?? zem??, tak??e ??????en?? je povoleno jen v t??ch zem??ch nebo mezi t??mi
+zem??mi, kter?? nejsou t??mto zp??sobem vylou??eny. Tato licence zahrnuje v
+tomto p????pad?? takov?? omezen?? p??esn?? tak, jako by bylo zaps??no v textu
+t??to licence.</p>
+
+<p><b>9.</b>
+
+Free Software Foundation m????e ??as od ??asu vyd??vat upraven??
+nebo nov?? verze Obecn?? ve??ejn?? licence. Takov?? nov?? verze se budou
+sv??m duchem podobat sou??asn?? verzi, v jednotlivostech se v??ak mohou
+li??it s ohledem na nov?? probl??my ??i z??jmy.</p>
+
+<p>Ka??d?? verzi je p??id??leno rozli??uj??c?? ????slo verze. Pokud program
+specifikuje ????slo verze, kter?? se na n??j vztahuje, a "v??echny
+n??sleduj??c?? verze", m????ete se podle uv????en?? ????dit ustanoven??mi a
+podm??nkami bu??to on?? konkr??tn?? verze anebo kter??koliv n??sleduj??c??
+verze, kterou vydala Free Software Foundation. Jestli??e program
+nespecifikuje ????slo verze t??to licence, m????ete si vybrat libovolnou
+verzi, kterou kdy Free Software Foundation vydala.</p>
+
+<p><b>10.</b>
+Pokud si p??ejete zahrnout ????sti programu do jin??ch voln??ch
+program??, jejich?? distribu??n?? podm??nky jsou odli??n??, za??lete autorovi
+????dost o povolen??. V p????pad?? softwaru, k n??mu?? vlastn?? autorsk?? pr??va Free
+Software Foundation, napi??te Free Software Foundation; n??kdy ??in??me
+v??jimky ze zde uveden??ch ustanoven??. Na??e rozhodnut?? bude vedeno dv??ma
+c??li: zachov??n??m voln?? povahy v??ech odvozenin na??eho voln??ho softwaru
+a podporou sd??len?? a op??tovn??ho vyu??it?? softwaru obecn??.</p>
+
+<p><center><b>Z??RUKA SE NEPOSKYTUJE</b></center></p>
+
+<p><b>11.</b>
+VZHLEDEM K BEZPLATN??MU POSKYTNUT?? LICENCE K PROGRAMU SE NA
+PROGRAM NEVZTAHUJE ????DN?? Z??RUKA, A TO V M????E POVOLEN?? PLATN??M Z??KONEM.
+POKUD NEN?? P??SEMN?? STANOVENO JINAK, POSKYTUJ?? DR??ITEL?? AUTORSK??CH PR??V
+POP????PAD?? JIN?? STRANY PROGRAM "TAK, JAK JE", BEZ Z??RUKY
+JAK??HOKOLI DRUHU, A?? V??SLOVN?? NEBO VYPL??VAJ??C??, V??ETN??, ALE NIKOLI
+JEN, Z??RUK PRODEJNOSTI A VHODNOSTI PRO UR??IT?? ????EL. POKUD JDE O
+KVALITU A V??KONNOST PROGRAMU, LE???? VE??KER?? RIZIKO NA V??S. POKUD BY SE U
+PROGRAMU PROJEVILY Z??VADY, PADAJ?? N??KLADY ZA V??ECHNU POT??EBNOU ??DR??BU,
+OPRAVU ??I N??PRAVU NA V???? VRUB.</p>
+
+<p><b>12.</b>
+V ????DN??M P????PAD??, S V??JIMKOU TOHO, KDY?? TO VY??ADUJE PLATN??
+Z??KON, ANEBO KDY?? TO BYLO P??SEMN?? ODSOUHLASENO, V??M NEBUDE ????DN?? Z
+DR??ITEL?? AUTORSK??CH PR??V ANI ????DN?? JIN?? STRANA, KTER?? SM?? MODIFIKOVAT
+??I ??????IT PROGRAM V SOULADU S P??EDCHOZ??MI USTANOVEN??MI, ODPOV??DNI
+ZA ??KODY, V??ETN?? V??ECH OBECN??CH, SPECI??LN??CH, NAHODIL??CH NEBO
+N??SLEDN??CH ??KOD VYPL??VAJ??C??CH Z U????V??N?? ANEBO NESCHOPNOSTI U????VAT
+PROGRAMU (V??ETN??, ALE NIKOLI JEN, ZTR??TY NEBO ZKRESLEN?? DAT, NEBO
+TRVAL??CH ??KOD ZP??SOBEN??CH V??M NEBO T??ET??M STRAN??M, NEBO SELH??N?? FUNKCE
+PROGRAMU V SOU??INNOSTI S JIN??MI PROGRAMY), A TO I V P????PAD??, ??E TAKOV??
+DR??ITEL AUTORSK??CH PR??V NEBO JIN?? STRANA BYLI UPOZORN??NI NA MO??NOST
+TAKOV??CH ??KOD.</p>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,350 +1,345 @@
-<html>
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>P??ipojov??n?? k datab??zi</title>
-	</head>
-
-<body>
-
-	<h1>P??ipojov??n?? k datab??zi</h1>
-
-	<p>
-	V t??to sekci se dozv??te:
-	<ol>
-		<li><a href="#NewConnection">Jak se p??ipojit k datab??zi.</a></li>
-		<li><a href="#AddDBInfo">Jak vytvo??it nov?? z??znam pro p??ipojen?? k datab??zi.</a></li>
-		<li><a href="#EditDeleteDBInfo">Jak upravit nebo vymazat z??znam pro p??ipojen?? k datab??zi.</a></li>
-		<li><a href="#LoginErrorMessages">Jak?? probl??my p??i p??ipojov??n?? mohou nastat a jak je ??e??it.</a></li>
-	</ol>
-	</p>
-
-
-	<hr/>
-
-
-	<h2 id="NewConnection">1. Jak se p??ipojit k datab??zi</h2>
-
-	<p>
-	P??ihl????en?? k datab??zi, kde jsou Va??e data ulo??ena, je prvn?? krok p??i pr??ci s Plantlore. 
-	</p>
-
-	<h3>1.1. V??b??r datab??ze</h3>
-	
-	<p>
-	<img src="picture/LoginDBSelection.png" alt="Volba datab??ze.">
-	</p>
-
-	<p>
-	Po instalaci Plantlore je k disposici pouze jedna datab??ze pojmenovan?? <i>Uk??zkov?? datab??ze</i>.
-	Tato datab??ze neobsahuje ????dn?? z??znamy, ????dn?? n??lezov?? data, a je p??ipravena pro zapo??et?? pr??ce.
-	</p>
-
-	<p>
-	Neobsahuje-li seznam datab??z?? ????dn?? z??znam, budete jej muset nejprve <a href="#AddDBInfo">vytvo??it</a>. 
-	Po jist?? dob?? pou????v??n?? Plantlore m????e V???? seznam datab??z?? vypadat podobn?? jako ten na obr??zku.
-	Plantlore automaticky zv??razn?? jako vybranou tu datab??zi, kterou jste zvolili p??i posledn??m
-	p??ihla??ov??n??.
-	Vyberte jednu z datab??z?? v seznamu a stiskn??te tla????tko <i>Pokra??uj</i>.
-	</p>
-
-
-	<h3>1.2. Autentifikace - prokazov??n?? toto??nosti</h3>
-
-	<p>
-	Pro p??ihl????en?? k datab??zi je pot??eba se prok??zat p??ihla??ovac??mi ??daji 
-	- u??ivatelsk??m jm??nem a heslem. 
-
-	Pokud se p??ihla??ujete poprv??, zadejte p??ihla??ovac?? ??daje, 
-	kter?? jste pou??ili p??i instalaci Plantlore.
-
-	Nov?? u??ivatelsk?? jm??no a heslo sm?? p??id??lit pouze spr??vce datab??ze.
-	</p>
-	
-	<p>
-	<img src="picture/LoginAuthentication.png" alt="Vkl??d??n?? p??ihla??ovac??ch ??daj??.">
-	</p>
-
-	<p>
-	Plantlore si pamatuje n??kolik posledn??ch u??ivatelsk??ch jmen vkl??dan??ch p??i p??ihl????ov??n??;
-	m????ete vybrat jedno z p??ipraven??ho seznamu, nebo zadat jin?? u??ivatelsk?? jm??no.
-	Hesla si Plantlore nikdy neukl??d?? - automaticky je tedy nenab??z??.
-	Po zad??n?? ??daj?? stiskn??te tla????tko <i>P??ihl??sit</i>. 
-	</p>
-
-	<p>
-	Stiskem tla????tka p??ihl??sit se Plantlore pokus?? p??ipojit k vybran?? datab??zi se zadan??mi
-	p??ihla??ovac??mi ??daji. P??ipojen?? m????e (zejm??na pokud se p??ipojujete ke vzd??len?? datab??zi)
-	trvat del???? dobu - o pr??b??hu p??ipojov??n?? informuje jednoduch?? dialog.
-	</p>
-
-	<p>
-	<img src="picture/LoginInitialization.png" alt="Pr??b??h p??ipojov??n?? k datab??zi.">
-	</p>
-
-	<p>
-	Pokud se p??ihl????en?? z n??jak??ho d??vodu nezda????, budete o tom informov??ni kr??tkou 
-	<a href=#LoginErrorMessages">zpr??vou</a>.
-	 
-	V opa??n??m p????pad?? Plantlore zobraz?? z??kladn?? <a href="./overview.html">P??ehled</a>.
-	</p>
-
-
-	<h2 id="AddDBInfo">2. Jak vytvo??it a p??idat nov?? z??znam</h2>
-
-	<p>
-	Chcete-li se p??ipojit k jin?? datab??zi, 
-	kterou jste sami vytvo??ili nebo kterou vytvo??il n??kdo jin?? na sv??m po????ta??i,
-	mus??te vytvo??it nov?? z??znam, kter?? popisuje, kde se datab??ze nach??z?? a jak je nastavena.
-	</p>
-
-	<p>
-	Kontextov?? menu pro vytvo??en??, upraven?? nebo vymaz??n?? z??znamu lze vyvolat stiskem prav??ho
-	tla????tka my??i. Vyberte polo??ku <i>P??idat</i> a klikn??te na ni.
-	</p>
-
-	<p>
-	<img src="picture/LoginAddMenu.png" alt="P??id??n?? nov??ho z??znamu.">
-	</p>
-
-	<p>
-	P??id??n?? nov??ho z??znamu pro p??ipojen?? k jin?? datab??zi je rozd??leno na dv?? ????sti, 
-	jim?? odpov??daj?? dv?? z??lo??ky na dialogu. 
-	<ul>
-		<li>
-		Prvn?? z nich je <b>p????m?? p??ipojen??</b>, neboli lok??ln?? p??ipojen??. 
-		P????m?? p??ipojen?? k datab??zi lze pou????t pouze v p????pad??,
-		??e vytvo??en?? datab??ze se nach??z?? v datab??zov??m stroji (database engine), kter?? b?????? na
-		tomto po????ta??i, tzv. lok??ln??. P????m?? p??ipojen?? vy??aduje pon??kud odli??n?? parametry ne?? 
-		p??ipojen?? ke vzd??len?? datab??zi. V??hodou p????m??ho p??ipojen?? je jeho rychlost - komunikace
-		s datab??z?? se nemus?? nijak upravovat pro p??enos po s??ti.
-		</li>
-		<li>
-		Druh?? mo??nost je tzv. <b>vzd??len?? p??ipojen??</b>, neboli p??ipojen?? ke vzd??len?? datab??zi.
-		Vzd??len?? datab??ze se typicky nach??z?? v datab??zov??m stroji (database engine), kter?? je
-		spu??t??n na jin??m po????ta??i v s??ti. Pomoc?? tohoto p??ipojen?? je mo??n?? pracovat s datab??z??
-		"na d??lku". Nev??hodou je zpomalen?? dan?? jednak propustnost?? datov?? linky a jednak 
-		nutnost?? speci??ln?? upravovat p??en????en?? data kv??li p??enosu po s??ti. 
-		</li>
-	</ul>
-	Popi??me si parametry nutn?? pro p????m?? a vzd??len?? p??ihla??ov??n??.
-	</p>
-
-
-	<h3>A. P????m?? p??ipojen?? k datab??zi (lok??ln?? p??ipojen??)</h3>
-
-	<p>
-	Parametry popisuj??c?? p????m?? p??ipojen??:
-	<table>
-		<tr>
-			<th>N??zev</th>
-			<th>V??znam</th>
-		</tr>
-		<tr>
-			<td>Alias</td>
-			<td>
-				Alias je kr??tk?? ??et??zec, kter?? umo????uje snadnou identifikaci datab??ze u??ivatelem.
-				Tento ??et??zec je zobrazov??n v seznamu datab??z??. M??l by b??t kr??tk?? a v??sti??n??,
-				kup????kladu: <i>Dom??c?? datab??ze</i>, <i>Projekt mapov??n?? ??esk??ho st??edoho????</i>.
-			</td>
-		</tr>
-		<tr>
-			<td>Datab??zov?? stoj (engine)</td>
-			<td>
-				Existuje n??kolik datab??zov??ch stroj?? (database engine), kter?? umo????uj?? snadnou
-				pr??ci s datab??zemi, tabulkami, u??ivateli, dotazy a daty.
-				Ka??d?? datab??zov?? stroj m????e obsahovat n??kolik r??zn?? pojmenovan??ch datab??z??
-				s r??znou strukturou a s r??zn??m obsahem. Mezi nejzn??m??j???? datab??zov?? stroje
-				bezesporu pat???? Oracle, MSSQL, MySQL, Postgre a Firebird.
-				Plantlore podporuje pr??ci s r??zn??mi datab??zov??mi stroji,
-				ale je nutn?? p??esn?? specifikovat, o kter?? se jedn??, 
-				aby s n??m mohl bezchybn?? komunikovat. Plantlore je standardn?? dod??v??n
-				s Postgre. Aktu??ln?? podporovan?? DB stroje jsou seps??ny v rozbalovac??
-				nab??dce, ale je mo??n?? specifikovat i jin??.
-			</td>
-		</tr>
-		<tr>
-			<td>Identifik??tor DB</td>
-			<td>
-				Datab??zov?? stroj m????e obsahovat n??kolik r??zn??ch datab??z?? s r??znou strukturou
-				a obsahem. Datab??ze Plantlore maj?? vlastn?? specifickou strukturu. 
-				Pro spr??vn?? p??ipojen?? je nutn??, aby u??ivatel vyplnil i identifik??tor (jm??no)
-				datab??ze, se kterou chce pracovat.
-			</td>
-		</tr>
-		<tr>
-			<td>Port DB</td>
-			<td>
-				Datab??zov?? stroje umo????uj?? p??ipojen?? pouze p??es tzv. port. Ka??d?? datab??zov??
-				stroj m?? tento port jin?? a nav??c jej lze snadno zm??nit. Aby Plantlore v??d??l,
-				kde m?? datab??zov?? stroj kontaktovat, mus?? zn??t port, na kter??m stroj naslouch??.
-				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, ??e datab??zov?? stroje
-				vyu????vaj?? porty v rozsahu 1.024 a?? 10.000. Kup????kladu standardn?? port datab??zov??ho
-				stroje Postgre je 5432.
-			</td>
-		</tr>
-		<tr>
-			<td>Parametr</td>
-			<td>
-				Datab??zov?? stroj m????e b??t pot??eba je??t?? nakonfigurovat n??jak??m specifick??m
-				zp??sobem. N??kter?? stroje kup????kladu vy??aduj?? explicitn?? nastaven?? k??dov??n??
-				znak?? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou????
-				pro spr??vn?? nastaven?? dodate??n??ch paremetr?? p??ipojen?? k datab??zov??mu stroji.
-				P??ipojen?? k Postgre ????dn?? parametr nevy??aduje, ale nap??. pro spr??vn?? zobrazen??
-				diakritiky od Firebird je pot??eba k??dov??n?? nastavit.
-				<br/>
-				Odborn??: parametr je hodnota p??ed??van?? v p??ipojovac??m JDBC ??et??zci za ?
-			</td>
-		</tr>
-	</table>
-	</p>
-
-	<p>
-	Na uk??zku uve??me, jak by vypadalo lok??ln?? p??ipojen?? k datab??zi nazvan?? <i>plantlore</i>,
-	kter?? je ulo??ena v datab??zov??m stroji <i>Postgre</i>, kter?? naslouch?? na portu <i>5432</i>.
-	</p>
-
-	<p>
-	<img src="picture/LoginDBDirectConnection.png" alt="P??id??n?? nov??ho z??znamu.">
-	</p>
-
-
-	<h3>B. Vzd??len?? p??ipojen?? k datab??zi</h3>
-
-	<p>
-	Parametry popisuj??c?? vzd??len?? p??ipojen??:
-	<table>
-		<tr>
-			<th>N??zev</th>
-			<th>V??znam</th>
-		</tr>
-		<tr>
-			<td>Alias</td>
-			<td>
-				Alias je kr??tk?? ??et??zec, kter?? umo????uje snadnou identifikaci datab??ze u??ivatelem.
-				Tento ??et??zec je zobrazov??n v seznamu datab??z??. M??l by b??t kr??tk?? a v??sti??n??,
-				kup????kladu: <i>Ofici??ln?? datab??ze Jiho??esk?? pobo??ky ??BS</i>.
-			</td>
-		</tr>
-		<tr>
-			<td>Host</td>
-			<td>
-				Datab??zov?? stroj obsahuj??c?? datab??zi, k n???? se chceme p??ipojit, b?????? na jin??m
-				po????ta??i v s??ti. Tento parametr identifikuje tento po????ta?? a to bu?? podle
-				jeho tzv. hostname nebo IP adresy. Ka??d?? po????ta?? p??ipojen?? k s??ti mus?? m??t
-				svou vlastn?? unik??tn?? IP adresu, podle n???? je rozpozn??n. IP adresa je 
-				nej??ast??ji ??tve??ice ????sel odd??len?? te??kami, kup??. <i>192.168.0.247</i>.
-				N??kter?? po????ta??e maj?? krom?? IP adresy p??id??lena i jm??na, nap??. 
-				<i>data.domacisit.info</i>. C??lov?? po????ta?? lze tedy identifikovat 
-				ob??ma zp??soby.
-			</td>
-		</tr>
-		<tr>
-			<td>Port</td>
-			<td>
-				Aby bylo mo??n?? se p??ipojit ke vzd??len??mu datab??zov??mu stroji, je nutn??
-				na uveden??m vzd??len??m po????ta??i kontaktovat 
-				<a href="./server.html">Plantlore Server</a>, co?? je speci??ln??
-				aplikace, kter?? m?? za ??kol zprost??edkov??vat p??ipojen?? vzd??len??m klient??m a
-				dohl????et na po??et p??ipojen??ch u??ivatel??. Tato slu??ba (aplikace) mus?? b??t p????stupn??
-				na vzd??len??m po????ta??i, kde se nach??z?? i vzd??len?? datab??zov?? stroj, 
-				a naslouch?? na n??jak??m portu. Standardn?? port, na kter??m je tato slu??ba
-				dostupn??, je 1099.
-			</td>
-		</tr>
-		<tr>
-			<td>Identifik??tor DB</td>
-			<td>
-				Datab??zov?? stroj m????e obsahovat n??kolik r??zn??ch datab??z?? s r??znou strukturou
-				a obsahem. Datab??ze Plantlore maj?? vlastn?? specifickou strukturu. 
-				Pro spr??vn?? p??ipojen?? je nutn??, aby u??ivatel vyplnil i identifik??tor (jm??no)
-				datab??ze, se kterou chce pracovat.
-			</td>
-		</tr>
-	</table>
-	</p>
-	
-	<p>
-	Na uk??zku uve??me, jak by vypadalo nastaven?? pro vzd??len?? p??ipojen?? k datab??zi nazvan?? <i>plantlore</i>,
-	kter?? je ulo??ena v datab??zov??m stroji, 
-	kter?? se nach??z?? na po????ta??i s adresou <i>192.168.0.247</i>, 
-	a Plantlore Server naslouch?? na portu <i>1099</i>.
-	</p>
-
-	<p>
-	<img src="picture/LoginDBRemoteConnection.png" alt="P??id??n?? nov??ho z??znamu.">
-	</p>
-
-
-	<p>
-	<b>
-		P??id??v??te-li nov?? z??znam, ????dn?? nov?? datab??ze se nikde nevytv??????; vytv?????? se pouze
-		reference (odkaz) na n??jakou existuj??c?? datab??zi.
-	</b>
-	</p>
-
-
-
-	<h2 id="EditDeleteDBInfo">3. Jak upravit nebo vymazat z??znam pro p??ipojen?? k datab??zi</h2>
-
-	<p>
-	V seznamu datab??z?? ozna??te z??znam, kter?? chcete upravit nebo smazat.
-	Kontextov?? menu pro vytvo??en??, upraven?? nebo vymaz??n?? z??znamu lze vyvolat stiskem prav??ho tla????tka my??i. 
-	Vyberte polo??ku Editovat nebo Odstranit a klikn??te na ni.
-	</p>
-
-	<p>
-	<img src="picture/LoginEditMenu.png" alt="??prava st??vaj??c??ho z??znamu.">
-	</p>
-
-	<p>
-	??prava z??znam?? je shodn?? s dialogem pro p??id??n?? z??znamu, ale obsahuje p??edvypln??n?? hodnoty.
-	Detailn?? popis lze naj??t v ????sti <a href="#AddDBInfo">Jak vytvo??it nov?? z??znam pro p??ipojen?? k datab??zi</a>.
-	</p>
-
-	<p>
-	Odstran??n?? z??znamu se prov??d?? ??pln?? stejn??.
-	</p>
-
-	<p>
-	<img src="picture/LoginDeleteMenu.png" alt="Vymaz??n?? existuj??c??ho z??znamu.">
-	</p>
-
-
-	<p>
-	<b>
-		Ma??ete-li existuj??c?? z??znam, ????dn?? datab??ze se nikde nema??e; ru???? se pouze
-		reference (odkaz) na n??jakou existuj??c?? datab??zi.
-	</b>
-	</p>
-
-
-
-	<h2 id="LoginErrorMessages">Jak?? probl??my p??i p??ipojov??n?? mohou nastat a jak je ??e??it</h2>
-
-	<p>
-	Nej??ast??j???? probl??my p??i p??ipojov??n?? jsou tyto:
-	<ul>
-		<li>
-		Nespr??vn?? vypln??n?? p??ihla??ovac?? ??daje - u??ivatelsk?? jm??no nebo ??patn?? zadan?? heslo.
-		Ov????te, zda jste spr??vn?? vlo??ili ob?? hodnoty, p????padn?? zda m??te vytvo??en??
-		odpov??daj??c?? u??ivatelsk?? ????et v datab??zi, k n???? se p??ipojujete.
-		</li>
-		<li>
-		Nespr??vn?? zadan?? parametry pro p????m?? nebo vzd??len?? p??ipojen?? k datab??zi.
-		Ov????te, zda jsou vypln??ny v??echny polo??ky spr??vn?? a zda obsahuj?? aktu??ln?? data. 
-		Nap??. mohlo doj??t ke zm??n?? IP adresy po????ta??e, ke kter??mu se p??ihla??ujete, nebo jste
-		ud??lali p??eklep p??i zad??v??n?? identifik??toru datab??ze.
-		</li>
-		<li>
-		Vypnut?? datab??zov?? stroj nebo Plantlore Server.
-		Ov????te, ??e datab??zov?? stroj je zapnut??, resp. se ujist??te, ??e na vzd??len??m po????ta??i
-		je spu??t??n Plantlore Server.
-		</li>
-	</ul>
-	</p>
-
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>P??ipojov??n?? k datab??zi</title>
+  </head>
+  <body>
+  <h1>P??ipojov??n?? k datab??zi</h1>
+	<p>
+	V t??to sekci se dozv??te:
+	<ol>
+		<li><a href="#NewConnection">Jak se p??ipojit k datab??zi.</a></li>
+		<li><a href="#AddDBInfo">Jak vytvo??it nov?? z??znam pro p??ipojen?? k datab??zi.</a></li>
+		<li><a href="#EditDeleteDBInfo">Jak upravit nebo vymazat z??znam pro p??ipojen?? k datab??zi.</a></li>
+		<li><a href="#LoginErrorMessages">Jak?? probl??my p??i p??ipojov??n?? mohou nastat a jak je ??e??it.</a></li>
+	</ol>
+	</p>
+
+
+	<hr/>
+
+
+	<h2 id="NewConnection">1. Jak se p??ipojit k datab??zi</h2>
+
+	<p>
+	P??ihl????en?? k datab??zi, kde jsou Va??e data ulo??ena, je prvn?? krok p??i pr??ci s Plantlore. 
+	</p>
+
+	<h3>1.1. V??b??r datab??ze</h3>
+	
+	<p>
+	<img src="picture/LoginDBSelection.png" alt="Volba datab??ze.">
+	</p>
+
+	<p>
+	Po instalaci Plantlore je k disposici pouze jedna datab??ze pojmenovan?? <i>Uk??zkov?? datab??ze</i>.
+	Tato datab??ze neobsahuje ????dn?? z??znamy, ????dn?? n??lezov?? data, a je p??ipravena pro zapo??et?? pr??ce.
+	</p>
+
+	<p>
+	Neobsahuje-li seznam datab??z?? ????dn?? z??znam, budete jej muset nejprve <a href="#AddDBInfo">vytvo??it</a>. 
+	Po jist?? dob?? pou????v??n?? Plantlore m????e V???? seznam datab??z?? vypadat podobn?? jako ten na obr??zku.
+	Plantlore automaticky zv??razn?? jako vybranou tu datab??zi, kterou jste zvolili p??i posledn??m
+	p??ihla??ov??n??.
+	Vyberte jednu z datab??z?? v seznamu a stiskn??te tla????tko <i>Pokra??uj</i>.
+	</p>
+
+
+	<h3>1.2. Autentifikace - prokazov??n?? toto??nosti</h3>
+
+	<p>
+	Pro p??ihl????en?? k datab??zi je pot??eba se prok??zat p??ihla??ovac??mi ??daji 
+	- u??ivatelsk??m jm??nem a heslem. 
+
+	Pokud se p??ihla??ujete poprv??, zadejte p??ihla??ovac?? ??daje, 
+	kter?? jste pou??ili p??i instalaci Plantlore.
+
+	Nov?? u??ivatelsk?? jm??no a heslo sm?? p??id??lit pouze spr??vce datab??ze.
+	</p>
+	
+	<p>
+	<img src="picture/LoginAuthentication.png" alt="Vkl??d??n?? p??ihla??ovac??ch ??daj??.">
+	</p>
+
+	<p>
+	Plantlore si pamatuje n??kolik posledn??ch u??ivatelsk??ch jmen vkl??dan??ch p??i p??ihl????ov??n??;
+	m????ete vybrat jedno z p??ipraven??ho seznamu, nebo zadat jin?? u??ivatelsk?? jm??no.
+	Hesla si Plantlore nikdy neukl??d?? - automaticky je tedy nenab??z??.
+	Po zad??n?? ??daj?? stiskn??te tla????tko <i>P??ihl??sit</i>. 
+	</p>
+
+	<p>
+	Stiskem tla????tka p??ihl??sit se Plantlore pokus?? p??ipojit k vybran?? datab??zi se zadan??mi
+	p??ihla??ovac??mi ??daji. P??ipojen?? m????e (zejm??na pokud se p??ipojujete ke vzd??len?? datab??zi)
+	trvat del???? dobu - o pr??b??hu p??ipojov??n?? informuje jednoduch?? dialog.
+	</p>
+
+	<p>
+	<img src="picture/LoginInitialization.png" alt="Pr??b??h p??ipojov??n?? k datab??zi.">
+	</p>
+
+	<p>
+	Pokud se p??ihl????en?? z n??jak??ho d??vodu nezda????, budete o tom informov??ni kr??tkou 
+	<a href=#LoginErrorMessages">zpr??vou</a>.
+	 
+	V opa??n??m p????pad?? Plantlore zobraz?? z??kladn?? <a href="./overview.html">P??ehled</a>.
+	</p>
+
+
+	<h2 id="AddDBInfo">2. Jak vytvo??it a p??idat nov?? z??znam</h2>
+
+	<p>
+	Chcete-li se p??ipojit k jin?? datab??zi, 
+	kterou jste sami vytvo??ili nebo kterou vytvo??il n??kdo jin?? na sv??m po????ta??i,
+	mus??te vytvo??it nov?? z??znam, kter?? popisuje, kde se datab??ze nach??z?? a jak je nastavena.
+	</p>
+
+	<p>
+	Kontextov?? menu pro vytvo??en??, upraven?? nebo vymaz??n?? z??znamu lze vyvolat stiskem prav??ho
+	tla????tka my??i. Vyberte polo??ku <i>P??idat</i> a klikn??te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginAddMenu.png" alt="P??id??n?? nov??ho z??znamu.">
+	</p>
+
+	<p>
+	P??id??n?? nov??ho z??znamu pro p??ipojen?? k jin?? datab??zi je rozd??leno na dv?? ????sti, 
+	jim?? odpov??daj?? dv?? z??lo??ky na dialogu. 
+	<ul>
+		<li>
+		Prvn?? z nich je <b>p????m?? p??ipojen??</b>, neboli lok??ln?? p??ipojen??. 
+		P????m?? p??ipojen?? k datab??zi lze pou????t pouze v p????pad??,
+		??e vytvo??en?? datab??ze se nach??z?? v datab??zov??m stroji (database engine), kter?? b?????? na
+		tomto po????ta??i, tzv. lok??ln??. P????m?? p??ipojen?? vy??aduje pon??kud odli??n?? parametry ne?? 
+		p??ipojen?? ke vzd??len?? datab??zi. V??hodou p????m??ho p??ipojen?? je jeho rychlost - komunikace
+		s datab??z?? se nemus?? nijak upravovat pro p??enos po s??ti.
+		</li>
+		<li>
+		Druh?? mo??nost je tzv. <b>vzd??len?? p??ipojen??</b>, neboli p??ipojen?? ke vzd??len?? datab??zi.
+		Vzd??len?? datab??ze se typicky nach??z?? v datab??zov??m stroji (database engine), kter?? je
+		spu??t??n na jin??m po????ta??i v s??ti. Pomoc?? tohoto p??ipojen?? je mo??n?? pracovat s datab??z??
+		"na d??lku". Nev??hodou je zpomalen?? dan?? jednak propustnost?? datov?? linky a jednak 
+		nutnost?? speci??ln?? upravovat p??en????en?? data kv??li p??enosu po s??ti. 
+		</li>
+	</ul>
+	Popi??me si parametry nutn?? pro p????m?? a vzd??len?? p??ihla??ov??n??.
+	</p>
+
+
+	<h3>A. P????m?? p??ipojen?? k datab??zi (lok??ln?? p??ipojen??)</h3>
+
+	<p>
+	Parametry popisuj??c?? p????m?? p??ipojen??:
+	<table>
+		<tr>
+			<th>N??zev</th>
+			<th>V??znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr??tk?? ??et??zec, kter?? umo????uje snadnou identifikaci datab??ze u??ivatelem.
+				Tento ??et??zec je zobrazov??n v seznamu datab??z??. M??l by b??t kr??tk?? a v??sti??n??,
+				kup????kladu: <i>Dom??c?? datab??ze</i>, <i>Projekt mapov??n?? ??esk??ho st??edoho????</i>.
+			</td>
+		</tr>
+		<tr>
+			<td>Datab??zov?? stoj (engine)</td>
+			<td>
+				Existuje n??kolik datab??zov??ch stroj?? (database engine), kter?? umo????uj?? snadnou
+				pr??ci s datab??zemi, tabulkami, u??ivateli, dotazy a daty.
+				Ka??d?? datab??zov?? stroj m????e obsahovat n??kolik r??zn?? pojmenovan??ch datab??z??
+				s r??znou strukturou a s r??zn??m obsahem. Mezi nejzn??m??j???? datab??zov?? stroje
+				bezesporu pat???? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr??ci s r??zn??mi datab??zov??mi stroji,
+				ale je nutn?? p??esn?? specifikovat, o kter?? se jedn??, 
+				aby s n??m mohl bezchybn?? komunikovat. Plantlore je standardn?? dod??v??n
+				s Postgre. Aktu??ln?? podporovan?? DB stroje jsou seps??ny v rozbalovac??
+				nab??dce, ale je mo??n?? specifikovat i jin??.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik??tor DB</td>
+			<td>
+				Datab??zov?? stroj m????e obsahovat n??kolik r??zn??ch datab??z?? s r??znou strukturou
+				a obsahem. Datab??ze Plantlore maj?? vlastn?? specifickou strukturu. 
+				Pro spr??vn?? p??ipojen?? je nutn??, aby u??ivatel vyplnil i identifik??tor (jm??no)
+				datab??ze, se kterou chce pracovat.
+			</td>
+		</tr>
+		<tr>
+			<td>Port DB</td>
+			<td>
+				Datab??zov?? stroje umo????uj?? p??ipojen?? pouze p??es tzv. port. Ka??d?? datab??zov??
+				stroj m?? tento port jin?? a nav??c jej lze snadno zm??nit. Aby Plantlore v??d??l,
+				kde m?? datab??zov?? stroj kontaktovat, mus?? zn??t port, na kter??m stroj naslouch??.
+				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, ??e datab??zov?? stroje
+				vyu????vaj?? porty v rozsahu 1.024 a?? 10.000. Kup????kladu standardn?? port datab??zov??ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+		<tr>
+			<td>Parametr</td>
+			<td>
+				Datab??zov?? stroj m????e b??t pot??eba je??t?? nakonfigurovat n??jak??m specifick??m
+				zp??sobem. N??kter?? stroje kup????kladu vy??aduj?? explicitn?? nastaven?? k??dov??n??
+				znak?? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou????
+				pro spr??vn?? nastaven?? dodate??n??ch paremetr?? p??ipojen?? k datab??zov??mu stroji.
+				P??ipojen?? k Postgre ????dn?? parametr nevy??aduje, ale nap??. pro spr??vn?? zobrazen??
+				diakritiky od Firebird je pot??eba k??dov??n?? nastavit.
+				<br/>
+				Odborn??: parametr je hodnota p??ed??van?? v p??ipojovac??m JDBC ??et??zci za ?
+			</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	Na uk??zku uve??me, jak by vypadalo lok??ln?? p??ipojen?? k datab??zi nazvan?? <i>plantlore</i>,
+	kter?? je ulo??ena v datab??zov??m stroji <i>Postgre</i>, kter?? naslouch?? na portu <i>5432</i>.
+	</p>
+
+	<p>
+	<img src="picture/LoginDBDirectConnection.png" alt="P??id??n?? nov??ho z??znamu.">
+	</p>
+
+
+	<h3>B. Vzd??len?? p??ipojen?? k datab??zi</h3>
+
+	<p>
+	Parametry popisuj??c?? vzd??len?? p??ipojen??:
+	<table>
+		<tr>
+			<th>N??zev</th>
+			<th>V??znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr??tk?? ??et??zec, kter?? umo????uje snadnou identifikaci datab??ze u??ivatelem.
+				Tento ??et??zec je zobrazov??n v seznamu datab??z??. M??l by b??t kr??tk?? a v??sti??n??,
+				kup????kladu: <i>Ofici??ln?? datab??ze Jiho??esk?? pobo??ky ??BS</i>.
+			</td>
+		</tr>
+		<tr>
+			<td>Host</td>
+			<td>
+				Datab??zov?? stroj obsahuj??c?? datab??zi, k n???? se chceme p??ipojit, b?????? na jin??m
+				po????ta??i v s??ti. Tento parametr identifikuje tento po????ta?? a to bu?? podle
+				jeho tzv. hostname nebo IP adresy. Ka??d?? po????ta?? p??ipojen?? k s??ti mus?? m??t
+				svou vlastn?? unik??tn?? IP adresu, podle n???? je rozpozn??n. IP adresa je 
+				nej??ast??ji ??tve??ice ????sel odd??len?? te??kami, kup??. <i>192.168.0.247</i>.
+				N??kter?? po????ta??e maj?? krom?? IP adresy p??id??lena i jm??na, nap??. 
+				<i>data.domacisit.info</i>. C??lov?? po????ta?? lze tedy identifikovat 
+				ob??ma zp??soby.
+			</td>
+		</tr>
+		<tr>
+			<td>Port</td>
+			<td>
+				Aby bylo mo??n?? se p??ipojit ke vzd??len??mu datab??zov??mu stroji, je nutn??
+				na uveden??m vzd??len??m po????ta??i kontaktovat 
+				<a href="./server.html">Plantlore Server</a>, co?? je speci??ln??
+				aplikace, kter?? m?? za ??kol zprost??edkov??vat p??ipojen?? vzd??len??m klient??m a
+				dohl????et na po??et p??ipojen??ch u??ivatel??. Tato slu??ba (aplikace) mus?? b??t p????stupn??
+				na vzd??len??m po????ta??i, kde se nach??z?? i vzd??len?? datab??zov?? stroj, 
+				a naslouch?? na n??jak??m portu. Standardn?? port, na kter??m je tato slu??ba
+				dostupn??, je 1099.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik??tor DB</td>
+			<td>
+				Datab??zov?? stroj m????e obsahovat n??kolik r??zn??ch datab??z?? s r??znou strukturou
+				a obsahem. Datab??ze Plantlore maj?? vlastn?? specifickou strukturu. 
+				Pro spr??vn?? p??ipojen?? je nutn??, aby u??ivatel vyplnil i identifik??tor (jm??no)
+				datab??ze, se kterou chce pracovat.
+			</td>
+		</tr>
+	</table>
+	</p>
+	
+	<p>
+	Na uk??zku uve??me, jak by vypadalo nastaven?? pro vzd??len?? p??ipojen?? k datab??zi nazvan?? <i>plantlore</i>,
+	kter?? je ulo??ena v datab??zov??m stroji, 
+	kter?? se nach??z?? na po????ta??i s adresou <i>192.168.0.247</i>, 
+	a Plantlore Server naslouch?? na portu <i>1099</i>.
+	</p>
+
+	<p>
+	<img src="picture/LoginDBRemoteConnection.png" alt="P??id??n?? nov??ho z??znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		P??id??v??te-li nov?? z??znam, ????dn?? nov?? datab??ze se nikde nevytv??????; vytv?????? se pouze
+		reference (odkaz) na n??jakou existuj??c?? datab??zi.
+	</b>
+	</p>
+
+
+
+	<h2 id="EditDeleteDBInfo">3. Jak upravit nebo vymazat z??znam pro p??ipojen?? k datab??zi</h2>
+
+	<p>
+	V seznamu datab??z?? ozna??te z??znam, kter?? chcete upravit nebo smazat.
+	Kontextov?? menu pro vytvo??en??, upraven?? nebo vymaz??n?? z??znamu lze vyvolat stiskem prav??ho tla????tka my??i. 
+	Vyberte polo??ku Editovat nebo Odstranit a klikn??te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginEditMenu.png" alt="??prava st??vaj??c??ho z??znamu.">
+	</p>
+
+	<p>
+	??prava z??znam?? je shodn?? s dialogem pro p??id??n?? z??znamu, ale obsahuje p??edvypln??n?? hodnoty.
+	Detailn?? popis lze naj??t v ????sti <a href="#AddDBInfo">Jak vytvo??it nov?? z??znam pro p??ipojen?? k datab??zi</a>.
+	</p>
+
+	<p>
+	Odstran??n?? z??znamu se prov??d?? ??pln?? stejn??.
+	</p>
+
+	<p>
+	<img src="picture/LoginDeleteMenu.png" alt="Vymaz??n?? existuj??c??ho z??znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		Ma??ete-li existuj??c?? z??znam, ????dn?? datab??ze se nikde nema??e; ru???? se pouze
+		reference (odkaz) na n??jakou existuj??c?? datab??zi.
+	</b>
+	</p>
+
+
+
+	<h2 id="LoginErrorMessages">Jak?? probl??my p??i p??ipojov??n?? mohou nastat a jak je ??e??it</h2>
+
+	<p>
+	Nej??ast??j???? probl??my p??i p??ipojov??n?? jsou tyto:
+	<ul>
+		<li>
+		Nespr??vn?? vypln??n?? p??ihla??ovac?? ??daje - u??ivatelsk?? jm??no nebo ??patn?? zadan?? heslo.
+		Ov????te, zda jste spr??vn?? vlo??ili ob?? hodnoty, p????padn?? zda m??te vytvo??en??
+		odpov??daj??c?? u??ivatelsk?? ????et v datab??zi, k n???? se p??ipojujete.
+		</li>
+		<li>
+		Nespr??vn?? zadan?? parametry pro p????m?? nebo vzd??len?? p??ipojen?? k datab??zi.
+		Ov????te, zda jsou vypln??ny v??echny polo??ky spr??vn?? a zda obsahuj?? aktu??ln?? data. 
+		Nap??. mohlo doj??t ke zm??n?? IP adresy po????ta??e, ke kter??mu se p??ihla??ujete, nebo jste
+		ud??lali p??eklep p??i zad??v??n?? identifik??toru datab??ze.
+		</li>
+		<li>
+		Vypnut?? datab??zov?? stroj nebo Plantlore Server.
+		Ov????te, ??e datab??zov?? stroj je zapnut??, resp. se ujist??te, ??e na vzd??len??m po????ta??i
+		je spu??t??n Plantlore Server.
+		</li>
+	</ul>
+	</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,11 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Historie ?prav n?lez?</title>
-</head>
-<body>
-<h1>Historie ?prav n?lez?</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Historie ??prav n??lez??</title>
+  </head>
+  <body>
+  <h1>Historie ??prav n??lez??</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/overview.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,61 +1,61 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>P??ehled n??lez??</title>
-</head>
-<body>
-<h1>P??ehled n??lez??</h1>
-
-    <img src="picture/overview.png" alt="P??ehled n??lez??"><br>
-    <p>Centrem Plantlore je p??ehled n??lez??. Je to tabulka zobrazuj??c?? seznam n??lez??. Implicitn?? jsou zobrazeny
-    v??echny z??znamy. Jejich seznam je ale mo??n?? z????it <a href="search.html">vyhled??v??n??m</a>. </p>
-    
-    <p>V??sledek vyhled??v??n?? se v??dy zobrazuje v P??ehledu n??lez??. Pro n??vrat k seznamu v??ech n??lez?? sta????
-    vyvolat <a href="search.html">dialog hled??n??</a>, nic nevyplnit a pouze kliknout na Ok.</p>
-    
-    <p>Pokud s n??lezy pracujete, p??ehled n??lez?? se automaticky neaktualizuje, z??st??vaj?? v n??m zobrazeny
-    star?? hodnoty. To je kv??li efektivn??j???? pr??ci s aplikac?? p??i pomalej????m p??ipojen?? na s????. Obnoven??
-    p??ehledu se prov??d?? bu?? op??tovn??m hled??n??m anebo kliknut??m na tla????tko Obnovit v prav?? doln?? ????sti okna.</p>
-    
-    <img src="picture/overview_second_toolbar.png" alt="N??stroje pro pr??ci s p??ehledem n??lez??"><br>
-    
-    <p>Po??et z??znam?? na str??nku je mo??n?? p??eps??n??m ????sla mezi tla????tky P??edchoz?? a N??sleduj??c??. Po potvrzen??
-    stiskem kl??vesy Enter se velikost str??nky zm??n??. Po??et z??znam?? na str??nku se tak?? m????e ur??ovat dynamicky
-    podle aktu??ln?? velikosti okna. Toto chov??n?? lze zapnout v <a href="settings.html">Nastaven??ch</a>. P??i 
-    pr??ci po s??ti a pomalej????m p??ipojen?? ale doporu??ujeme m??t tuto funkci vypnutou.</p>
-    
-    <p>Chceteli z??znamy mazat, tisknout nebo exportovat je pot??eba je nejprve vybrat ozna??en??m ve sloupku
-        s n??zvem X. Ozna??en?? z??znamu je mo??n?? za??krtnut??m p????slu??n??ho pol????ka ve sloupku X. K hromadn??mu ozna??en??, 
-        odzna??en?? a invertov??n?? ozna??en??ch z??znam?? slou???? tla????tka V??e, Nic a Invertuj v lev?? doln?? ????sti okna.
-        <i>Akce se pak v??dy t??k?? pouze z??znam?? na aktu??ln?? str??nce!</i> Po ozna??en?? z??znam??, se kter??mi chcete pracovat,
-    u?? pouze sta???? vyvolat p????slu??n?? p????kaz bu?? z menu, z n??strojov?? li??ty anebo kl??vesovou zkratkou.</p>
-    
-    <img src="picture/overview_selecting.png" alt="V??b??r z??znam??"><br>
-    
-    <p>P??ehled n??lez?? tak?? poskytuje omezen?? mo??nosti t????d??n?? z??znam??. T????d?? se v??dy pouze z??znamy aktu??ln??
-    zobrazen?? na str??nce. Net????d?? se v??echny z??znamy v datab??zi, proto??e by to p??i velk??m mno??stv?? z??znam?? 
-    vy??adovalo mnoho ??asu v p????pad?? pomalej????ho spojen?? k serveru. Chcete-li set????dit z??znamy na str??nce 
-    nap????klad podle roku n??lezu, sta???? kliknout na z??hlav?? sloupku Rok. V z??hlav?? se objev?? ??ipka indikuj??c?? sm??r t????d??n??.
-    Z??znamy se po prvn??m kliknut?? set????d?? vzestupn?? podle roku.
-    Chcete-li je set????dit setupn?? sta???? znova kliknout na z??hlav?? sloupku Rok. T??et?? kliknut?? t????d??n?? zru????. 
-    P??ehled umo????uje i druhotn?? t????d??n??, tj. nap????klad nejd????ve podle roku a pak podle nejbli??????ho s??dla. 
-    To lze prov??st jednodu??e kliknut??m nejd????ve na z??hlav?? sloupku Rok a pak stisknout a dr??et kl??vesu Ctrl
-    a kliknout na z??hlav?? sloupku Nejbli??s?? s??dlo. Druhotn?? t????d??n?? indikuje o n??co men???? ??ipka v z??hlav??.</p>
-    
-    <img src="picture/overview_sorting.png" alt="T????d??n?? z??znam??"><br>
-    
-    <p>Po??ad?? zobrazen??ch sloupk?? je mo??n?? tak?? m??nit. A to bu?? do??asn?? prost??m p??esunut??m sloupku za jeho
-    z??hlav?? anebo trvale v <a href="settings.html">Nastaven??ch</a>. V nastaven??ch je mo??n?? si vybrat
-    i jin?? sloupky, kter?? se maj?? zobrazit, p????padn?? n??jak?? vynechat.</p>
-    
-    <p>V tabulce n??lez?? nejsou vid??t v??echny informace o n??lezu. Ty je mo??n?? zobrazit bu?? vyvol??n??m
-    dialogu pro editaci n??lezu nebo vyvol??n??m detailu n??lezu. Detail n??lezu se vyvol??v?? bu?? dvojklikem na 
-    p????slu??n?? n??lez anebo ozna??en??m n??lezu a stiskem Enteru.</p>
-    
-    <img src="picture/overview_detail.png" alt="Detail n??lezu"><br>
-    
-    <p>Detail n??lezu umo????uje p??echod na dal???? nebo p??edchoz?? n??lez kliknut??m na tla????tko P??edch??zej??c?? nebo
-    N??sleduj??c??. Zobrazuje i informace o tom, kter?? u??ivatel Plantlore n??lez vytvo??il, a kdo ho naposledy editoval.</p>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>P??ehled n??lez??</title>
+  </head>
+  <body>
+  <h1>P??ehled n??lez??</h1>
+   <img src="picture/overview.png" alt="P??ehled n??lez??"><br>
+    <p>Centrem Plantlore je p??ehled n??lez??. Je to tabulka zobrazuj??c?? seznam n??lez??. Implicitn?? jsou zobrazeny
+    v??echny z??znamy. Jejich seznam je ale mo??n?? z????it <a href="search.html">vyhled??v??n??m</a>. </p>
+    
+    <p>V??sledek vyhled??v??n?? se v??dy zobrazuje v P??ehledu n??lez??. Pro n??vrat k seznamu v??ech n??lez?? sta????
+    vyvolat <a href="search.html">dialog hled??n??</a>, nic nevyplnit a pouze kliknout na Ok.</p>
+    
+    <p>Pokud s n??lezy pracujete, p??ehled n??lez?? se automaticky neaktualizuje, z??st??vaj?? v n??m zobrazeny
+    star?? hodnoty. To je kv??li efektivn??j???? pr??ci s aplikac?? p??i pomalej????m p??ipojen?? na s????. Obnoven??
+    p??ehledu se prov??d?? bu?? op??tovn??m hled??n??m anebo kliknut??m na tla????tko Obnovit v prav?? doln?? ????sti okna.</p>
+    
+    <img src="picture/overview_second_toolbar.png" alt="N??stroje pro pr??ci s p??ehledem n??lez??"><br>
+    
+    <p>Po??et z??znam?? na str??nku je mo??n?? p??eps??n??m ????sla mezi tla????tky P??edchoz?? a N??sleduj??c??. Po potvrzen??
+    stiskem kl??vesy Enter se velikost str??nky zm??n??. Po??et z??znam?? na str??nku se tak?? m????e ur??ovat dynamicky
+    podle aktu??ln?? velikosti okna. Toto chov??n?? lze zapnout v <a href="settings.html">Nastaven??ch</a>. P??i 
+    pr??ci po s??ti a pomalej????m p??ipojen?? ale doporu??ujeme m??t tuto funkci vypnutou.</p>
+    
+    <p>Chceteli z??znamy mazat, tisknout nebo exportovat je pot??eba je nejprve vybrat ozna??en??m ve sloupku
+        s n??zvem X. Ozna??en?? z??znamu je mo??n?? za??krtnut??m p????slu??n??ho pol????ka ve sloupku X. K hromadn??mu ozna??en??, 
+        odzna??en?? a invertov??n?? ozna??en??ch z??znam?? slou???? tla????tka V??e, Nic a Invertuj v lev?? doln?? ????sti okna.
+        <i>Akce se pak v??dy t??k?? pouze z??znam?? na aktu??ln?? str??nce!</i> Po ozna??en?? z??znam??, se kter??mi chcete pracovat,
+    u?? pouze sta???? vyvolat p????slu??n?? p????kaz bu?? z menu, z n??strojov?? li??ty anebo kl??vesovou zkratkou.</p>
+    
+    <img src="picture/overview_selecting.png" alt="V??b??r z??znam??"><br>
+    
+    <p>P??ehled n??lez?? tak?? poskytuje omezen?? mo??nosti t????d??n?? z??znam??. T????d?? se v??dy pouze z??znamy aktu??ln??
+    zobrazen?? na str??nce. Net????d?? se v??echny z??znamy v datab??zi, proto??e by to p??i velk??m mno??stv?? z??znam?? 
+    vy??adovalo mnoho ??asu v p????pad?? pomalej????ho spojen?? k serveru. Chcete-li set????dit z??znamy na str??nce 
+    nap????klad podle roku n??lezu, sta???? kliknout na z??hlav?? sloupku Rok. V z??hlav?? se objev?? ??ipka indikuj??c?? sm??r t????d??n??.
+    Z??znamy se po prvn??m kliknut?? set????d?? vzestupn?? podle roku.
+    Chcete-li je set????dit setupn?? sta???? znova kliknout na z??hlav?? sloupku Rok. T??et?? kliknut?? t????d??n?? zru????. 
+    P??ehled umo????uje i druhotn?? t????d??n??, tj. nap????klad nejd????ve podle roku a pak podle nejbli??????ho s??dla. 
+    To lze prov??st jednodu??e kliknut??m nejd????ve na z??hlav?? sloupku Rok a pak stisknout a dr??et kl??vesu Ctrl
+    a kliknout na z??hlav?? sloupku Nejbli??s?? s??dlo. Druhotn?? t????d??n?? indikuje o n??co men???? ??ipka v z??hlav??.</p>
+    
+    <img src="picture/overview_sorting.png" alt="T????d??n?? z??znam??"><br>
+    
+    <p>Po??ad?? zobrazen??ch sloupk?? je mo??n?? tak?? m??nit. A to bu?? do??asn?? prost??m p??esunut??m sloupku za jeho
+    z??hlav?? anebo trvale v <a href="settings.html">Nastaven??ch</a>. V nastaven??ch je mo??n?? si vybrat
+    i jin?? sloupky, kter?? se maj?? zobrazit, p????padn?? n??jak?? vynechat.</p>
+    
+    <p>V tabulce n??lez?? nejsou vid??t v??echny informace o n??lezu. Ty je mo??n?? zobrazit bu?? vyvol??n??m
+    dialogu pro editaci n??lezu nebo vyvol??n??m detailu n??lezu. Detail n??lezu se vyvol??v?? bu?? dvojklikem na 
+    p????slu??n?? n??lez anebo ozna??en??m n??lezu a stiskem Enteru.</p>
+    
+    <img src="picture/overview_detail.png" alt="Detail n??lezu"><br>
+    
+    <p>Detail n??lezu umo????uje p??echod na dal???? nebo p??edchoz?? n??lez kliknut??m na tla????tko P??edch??zej??c?? nebo
+    N??sleduj??c??. Zobrazuje i informace o tom, kter?? u??ivatel Plantlore n??lez vytvo??il, a kdo ho naposledy editoval.</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,66 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Spr?va publikac?</title>
-</head>
-<body>
-<h1>Spr?va publikac?</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Spr??va publikac??</title>
+  </head>
+  <body>
+  <h1>Spr??va publikac??</h1>
+Spr??va publikac?? umo????uje u??ivateli p??id??vat, upravovat a vyhled??vat publikace, ve kter??ch byly n??lezy 
+publikovan??. Dialogov?? okno se spr??vou publikac?? je mo??n?? otev????t pomoc?? menu Data|Spr??va publikac??.
+<p>
+Dialog pro spr??vu publikac?? se skl??d?? ze dvou z??kladn??ch ????st??:
+<ul>
+<li><b>Seznam publikac??</b> - publikace, kter?? jsou v??sledkem posledn??ho hled??n??</li>
+<li><b>Vyhled??v??n?? publikac??</b> - zde m????ete zadat krit??ria pro vyhled??v??n?? publikac??</li>
+</ul>
+
+<h2>Seznam publikac??</h2>
+Po ??sp????n??m vyhled??n?? jsou v??sledky zobrazeny v t??to ????sti formul????e. V??sledky jsou zobrazeny po str??nk??ch, 
+proto nejsou bezprost??edn?? po vyhled??n?? zobrazen?? v??echny publikace. Pro p??ech??zen?? mezi jednotliv??mi 
+str??nkami v??sledk?? pou??ijte tla????tek P??edchoz?? a N??sleduj??c?? kter?? najdete pod tabulkou se seznamem 
+publikac??. V p????pad??, ??e chcete zobrazit v??ce z??znam?? na jedn?? str??nce, zadejte po??et zobrazovan??ch z??znam?? 
+do pole pod tabulkou se seznamem publikac?? a stiskn??te kl??vesu enter. Vedle tohoto pole se takt???? nach??z?? 
+informace celkov??m po??tu nalezn??ch z??znam?? a rozsah kter?? je pr??v?? zobrazen.
+<p>
+Tato ????st formul????e obsahuje taky tla????tka pro p??id??v??n??, ??pravu a maz??n?? publikac??. Tla??itka P??idej 
+publikaci a Uprav publikaci otev??ou dialogov?? okno pro p??id??v??n??/??pravu publikac?? (viz n????e). Tla????tko 
+Odeber publikaci sma??e (po potvrzen?? u??ivatelem) vybranou publikaci. Pro ??pravu nebo smaz??n?? publikace 
+mus?? b??t dan?? publikace vybran?? v tabulce se seznamem publikac?? (v opa??n??m p????pad?? syst??m u??ivatele 
+upozorn?? ??e nen?? vybran?? ????dn?? publikace). ??pravy a maz??n?? publikac?? podl??h?? syst??mu opr??vn??n?? v Plantlore. 
+Pro podrobn??j???? informace o syst??mu opr??vn??n?? nav??tivte sekci Pr??va.
+
+<h2>Vyhled??v??n?? publikac??</h2>
+Dialog pro spr??vu publikac?? umo????uje vyhled??v??n?? podle 4 parametr??: Jm??no kolekce, n??zev ??l??nku, citace a 
+podrobn?? informace. V??sledky m????ou b??t uspo????dan?? podle jm??na kolekce, roku publikace, jm??na ??l??nku, autora 
+??l??nku, citace a podrobn??ch informac?? vzestupn?? nebo sestupn??. ??et??zec pro vyhled??v??n?? nemus?? p??esn?? 
+odpov??dat polo??ce v datab??zi, nalezeny budou v??echny z??znamy, u kter??ch je zadan?? polo??ka pod??et??zcem 
+odpov??daj??ci polo??ky v datab??zi. Po zadan?? parametr?? pro hled??n?? se vyhled??van?? spou??t?? tla????tkem Vyhledej 
+publikace.
+<p>
+Vyhled??v??n?? nerozli??uje mal?? a velk?? p??smena.
+<p>
+Po otev??en?? dialogov??ho okna pro spr??vu publikac?? se zobraz?? v??echny dostupn?? publikace. Pro pozd??j???? 
+zobrazen?? v??ech publikac?? stiskn??te tla????tko Vyhledej publikace bez vypln??n?? vyhled??vac??ch parametr??.
+
+<h1>P??id??v??n?? a editace publikac??</h1>
+Dialogov?? okno pro p??id??van?? nebo editaci publikac?? se otev??r?? z hlavn??ho okna spr??vy publikac?? tla????tkem 
+P??idej publikaci resp. Uprav publikaci. Toto okno obsahuje n??sleduj??c?? polo??ky:
+<ul>
+<li><b>Jm??no kolekce</b> - Jm??no kolekce do kter?? dan?? publikace pat????.</li>
+<li><b>Rok publikace</b> - Rok, ve kter??m do??lo k publikaci n??lezu.</li>
+<li><b>N??zev ??l??nku</b> - N??zev ??l??nku, ve kter??m byl n??lez publikov??n.</li>
+<li><b>Jm??no autora ??l??nku</b> - Autor ??l??nku ve kter??m byl n??lez publikov??n.</li>
+<li><b>Detail</b> - Detail odkazu na ??l??nek.</li>
+<li><b>Pozn??mka</b> - Jak??koli dal???? informace o publikaci.</li>
+</ul>
+Pokud p??id??v??te novou publikaci, vypl??te jednotliv?? polo??ky a stiskn??te tla????tko Ulo?? publikaci. Alespo?? 
+jedna z n??sleduj??c??ch polo??ek mus?? b??t vypl??ena: Autor ??l??nku, rok publikace, jm??no ??l??nku, jm??no kolekce.
+<p>
+V p????pad??, ??e upravujete u?? existuj??c?? publikaci, vypln?? se parametry vybran?? publikace do formul????e a 
+m????ete je upravit. Pomoc?? tla????tka Ulo?? publikaci  se zm??ny ulo???? do datab??ze. Tak jako u p??id??v??n?? 
+publikac??, alespo?? jedna z t??chto polo??ek mus?? b??t vypln??n??: Autor ??l??nku, rok publikace, jm??no ??l??nku, 
+jm??no kolekce
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/resources.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,10 +1,11 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Zdroje</title>
-</head>
-<body>
-<h1>Zdroje</h1>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Zdroje</title>
+  </head>
+  <body>
+  <h1>Zdroje</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/search.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/search.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/search.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,81 +1,79 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Vyhled??v??n?? v n??lezov??ch datech</title>
-</head>
-<body>
-<h1>Vyhled??v??n?? v n??lezov??ch datech</h1>
-
-<p>V Plantlore existuj?? dva zp??soby jak vyhled??vat data - pomoc?? vyhled??vac??ho dialgu 
-a pomoc?? tzv. stromu lokalit.</p>
-
-<h2>Vyhled??vac?? dialog</h2>
-<p>Vyhled??vac?? dialog obsahuje t??m???? stejn?? pole jako dialog pro p??id??v??n?? a editaci n??lez??. Vyhled??vat
-je tedy mo??n?? podle jak??chkoli zadan??ch ??daj??.</p>
-
-<img src="picture/search_dialog_simple_cz.png" alt="Z??kladn?? vyhled??vac?? dialog">
-<br>
-
-<p>V??echna pole se zobraz?? a?? v roz??????en??m dialogu po kliknut?? na tla????tko Extended.</p>
-<img src="picture/search_dialog_extended_cz.png" alt="Roz??????en?? ????st vyhled??vac??ho dialogu">
-
-<p>Dialog se otev??r?? pr??zdn??. Pokud jej pr??zdn?? nech??te a rovnou stisknete Ok, tak
-se v <a href="overview.html">P??ehledu n??lez??</a> objev?? seznam v??ech n??lez??. Co?? je tedy
-zp??sob, jak se vr??tit ke zobrazen?? v??ech n??lez??.</p>
-
-<p>Je mo??n?? zadat jakoukoliv kombinaci zobrazen??ch vyplniteln??ch polo??ek, kterou
-dialog povol??. Nepovol?? nap????klad sou??asn?? zad??n?? ??asov??ho intervalu a m??s??ce. Stejn??
-jako dialogy pro p??id??v??n?? a editaci kontroluje spr??vnost zadan??ch hodnot. Tj. nap????klad, ??e 
-nadmo??sk?? v????ka obsahuje ????seln?? ??daj.</p>
-
-<h3>P??id??v??n?? autor??</h3>
-<p>Zad??n?? autora, role ??i pozn??mky u autora se prov??d?? stejn?? jako u P??id??vac??ho a editovac??ho dialogu.
-Pro p??id??n?? autora klikn??te na tla????tko P??idej/Add v lev?? horn?? ????sti z??kladn??ho formul????e.
-Objev?? se nov?? ????dek. Zde je mo??n?? vyplnit jm??no autora nebo roli autora nebo pozn??mku
-autora k n??lezu. Pokud zad??te jak autora, roli i pozn??mku autora, tak se nebude hledat tato trojice,
-ale budou hled??ny n??lezy bu?? se zadan??m autorem nebo se zadanou rol?? nebo se zadanou pozn??mkou. Tj.
-??daje se p??i vyhled??v??n?? spojuj?? logickou spojkou NEBO. P??id??te-li dal???? ????dek, op??t se bude vyhled??vat
-pomoc?? spojky NEBO. Pro n??zornost mal?? p????klad. U??ivatel v prvn??m ????dku zad?? jako autora "Nov??ka" a jako
-roli "collect". V druh??m ????dku zad?? autora "??irok??" a roli "revised". Pokud pot?? klikne na Ok, tak
-se v p??ehledu n??lez?? objev?? v??echny n??lezy u nich?? je jako jeden z autor?? uveden bu?? Nov??k nebo ??irok??
-a tak?? se zobraz?? v??echny n??lezy, u kter??ch existuje autor v roli "collect" nebo autor v roli "revised".</p>
-
-<h3>Logika vyhled??v??n??</h3>
-<p>Jak funguje dotaz v p????pad?? autor??, rol?? a pozn??mek autor?? k n??lez??m jsme si ji?? popsali. 
-Zbytek u?? je p????mo??ar??. Pokud zad??te dva nebo v??ce taxon??, nap????klad Pampeli??ku a He??m??nek, tak se vyhled??vaj?? n??lezy
-zadan??ch taxon?? spojen??ch spojkou NEBO, tedy v na??em p????kladu  se hledaj?? n??lezy bu?? Pampeli??ek 
-nebo He??m??nk??.</p>
-<p>Ostatn?? vypln??n?? polo??ky se do dotazu p??id??vaj?? logickou spojkou A Z??rove??. Nap????klad tedy po zad??n??
-He??m??nku a Pampeli??ky jako taxon?? a po vybr??n?? Bohemia centralis se po stisku Ok v P??ehledu zobraz?? n??lezy He??m??nk?? v 
-teritoriu Bohemia centralis a n??lezy Pampeli??ek v teritoriu Bohemia centralis.</p>
-<p>Za zm??nku je??t?? stoj?? vyhled??v??n?? v pozn??mk??ch. Nehled?? se p??esn?? shoda se 
-zadan??m textem, ale hled?? se zadan?? text jako pod??et??zec pozn??mky nebo popisu 
-m??sta. Zad??te-li tedy do popisu m??sta slovo louka a stisknete Ok, zobraz?? se v
- p??ehledu v??echny n??lezy, kter?? v popisu m??sta n??lezu obsahuj?? ??et??zec "louka".
- Stejn?? je tomu u hled??n?? v pozn??mce k n??lezu a v pozn??mce k m??stu.</p>
- 
- <h2>Strom lokalit</h2>
- <p>Strom lokalit slou???? k rychl??mu hled??n?? v n??lezech podle geografick??ho ??len??n??. Je mo??n?? ho vyvolat z panelu n??stroj??
- v hlavn??m okn?? aplikace.</p>
- 
- <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
- 
- <p>Prvn?? vrstva stromu obsahuje teritoria, ka??d?? uzel teritoria pak obsahuje fytochoriony a kone??n?? uzel ka??d??ho
- fytochorionu obsahuje seznam lokalit. Strom obsahuje pouze ty fytochoriony a teritoria, kter?? u?? n??jak?? n??lez obsahuj??.
-  Fytochoriony neobsahuj??c?? ????dn?? n??lez zobrazeny nejsou. Stejn?? tak teritoria, kter?? neobsahuj?? alespo?? jeden fytochorion
-  obsahuj??c?? n??lez nejsou zobrazena.</p>
-  
-  <p>Zobrazit n??lezy v dan?? lokalit?? lze bu?? dvojklikem na uzel lokality anebo je mo??n?? jednoduch??m kliknut??m uzel ozna??it
-   a pak bu?? kliknout na lev?? doln?? tla????tko hledat anebo prav??m kliknut??m my??i vyvolat kontextov?? menu a v n??m kliknout
-   na "Hledat".</p>
-   
-   <p>Informace ve stromu se automaticky neaktualizuj?? spolu s editac?? datab??ze, aby se p??ede??lo neo??ek??van??mu zpomalen?? 
-   aplikace p??i pomal??m p??ipojen?? k serveru Plantlore p??i komunikaci p??es s????. Seznam lokalit ve fytochorionu lze 
-   jednodu??e zav??en??m a op??tovn??m rozbalen??m uzlu dan??ho fytochorionu. Pro nov?? na??ten?? cel?? struktury stromu slou???? prav??
-   doln?? tla????tko Obnovit. Funkci Obnovit lze vyvolat i z kontextov??ho menu.
-   </p>
- 
-</p>
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Vyhled??v??n?? v n??lezov??ch datech</title>
+  </head>
+  <body>
+  <h1>Vyhled??v??n?? v n??lezov??ch datech</h1>
+<p>V Plantlore existuj?? dva zp??soby jak vyhled??vat data - pomoc?? vyhled??vac??ho dialgu 
+a pomoc?? tzv. stromu lokalit.</p>
+
+<h2>Vyhled??vac?? dialog</h2>
+<p>Vyhled??vac?? dialog obsahuje t??m???? stejn?? pole jako dialog pro p??id??v??n?? a editaci n??lez??. Vyhled??vat
+je tedy mo??n?? podle jak??chkoli zadan??ch ??daj??.</p>
+
+<img src="picture/search_dialog_simple_cz.png" alt="Z??kladn?? vyhled??vac?? dialog">
+<br>
+
+<p>V??echna pole se zobraz?? a?? v roz??????en??m dialogu po kliknut?? na tla????tko Extended.</p>
+<img src="picture/search_dialog_extended_cz.png" alt="Roz??????en?? ????st vyhled??vac??ho dialogu">
+
+<p>Dialog se otev??r?? pr??zdn??. Pokud jej pr??zdn?? nech??te a rovnou stisknete Ok, tak
+se v <a href="overview.html">P??ehledu n??lez??</a> objev?? seznam v??ech n??lez??. Co?? je tedy
+zp??sob, jak se vr??tit ke zobrazen?? v??ech n??lez??.</p>
+
+<p>Je mo??n?? zadat jakoukoliv kombinaci zobrazen??ch vyplniteln??ch polo??ek, kterou
+dialog povol??. Nepovol?? nap????klad sou??asn?? zad??n?? ??asov??ho intervalu a m??s??ce. Stejn??
+jako dialogy pro p??id??v??n?? a editaci kontroluje spr??vnost zadan??ch hodnot. Tj. nap????klad, ??e 
+nadmo??sk?? v????ka obsahuje ????seln?? ??daj.</p>
+
+<h3>P??id??v??n?? autor??</h3>
+<p>Zad??n?? autora, role ??i pozn??mky u autora se prov??d?? stejn?? jako u P??id??vac??ho a editovac??ho dialogu.
+Pro p??id??n?? autora klikn??te na tla????tko P??idej/Add v lev?? horn?? ????sti z??kladn??ho formul????e.
+Objev?? se nov?? ????dek. Zde je mo??n?? vyplnit jm??no autora nebo roli autora nebo pozn??mku
+autora k n??lezu. Pokud zad??te jak autora, roli i pozn??mku autora, tak se nebude hledat tato trojice,
+ale budou hled??ny n??lezy bu?? se zadan??m autorem nebo se zadanou rol?? nebo se zadanou pozn??mkou. Tj.
+??daje se p??i vyhled??v??n?? spojuj?? logickou spojkou NEBO. P??id??te-li dal???? ????dek, op??t se bude vyhled??vat
+pomoc?? spojky NEBO. Pro n??zornost mal?? p????klad. U??ivatel v prvn??m ????dku zad?? jako autora "Nov??ka" a jako
+roli "collect". V druh??m ????dku zad?? autora "??irok??" a roli "revised". Pokud pot?? klikne na Ok, tak
+se v p??ehledu n??lez?? objev?? v??echny n??lezy u nich?? je jako jeden z autor?? uveden bu?? Nov??k nebo ??irok??
+a tak?? se zobraz?? v??echny n??lezy, u kter??ch existuje autor v roli "collect" nebo autor v roli "revised".</p>
+
+<h3>Logika vyhled??v??n??</h3>
+<p>Jak funguje dotaz v p????pad?? autor??, rol?? a pozn??mek autor?? k n??lez??m jsme si ji?? popsali. 
+Zbytek u?? je p????mo??ar??. Pokud zad??te dva nebo v??ce taxon??, nap????klad Pampeli??ku a He??m??nek, tak se vyhled??vaj?? n??lezy
+zadan??ch taxon?? spojen??ch spojkou NEBO, tedy v na??em p????kladu  se hledaj?? n??lezy bu?? Pampeli??ek 
+nebo He??m??nk??.</p>
+<p>Ostatn?? vypln??n?? polo??ky se do dotazu p??id??vaj?? logickou spojkou A Z??rove??. Nap????klad tedy po zad??n??
+He??m??nku a Pampeli??ky jako taxon?? a po vybr??n?? Bohemia centralis se po stisku Ok v P??ehledu zobraz?? n??lezy He??m??nk?? v 
+teritoriu Bohemia centralis a n??lezy Pampeli??ek v teritoriu Bohemia centralis.</p>
+<p>Za zm??nku je??t?? stoj?? vyhled??v??n?? v pozn??mk??ch. Nehled?? se p??esn?? shoda se 
+zadan??m textem, ale hled?? se zadan?? text jako pod??et??zec pozn??mky nebo popisu 
+m??sta. Zad??te-li tedy do popisu m??sta slovo louka a stisknete Ok, zobraz?? se v
+ p??ehledu v??echny n??lezy, kter?? v popisu m??sta n??lezu obsahuj?? ??et??zec "louka".
+ Stejn?? je tomu u hled??n?? v pozn??mce k n??lezu a v pozn??mce k m??stu.</p>
+ 
+ <h2>Strom lokalit</h2>
+ <p>Strom lokalit slou???? k rychl??mu hled??n?? v n??lezech podle geografick??ho ??len??n??. Je mo??n?? ho vyvolat z panelu n??stroj??
+ v hlavn??m okn?? aplikace.</p>
+ 
+ <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
+ 
+ <p>Prvn?? vrstva stromu obsahuje teritoria, ka??d?? uzel teritoria pak obsahuje fytochoriony a kone??n?? uzel ka??d??ho
+ fytochorionu obsahuje seznam lokalit. Strom obsahuje pouze ty fytochoriony a teritoria, kter?? u?? n??jak?? n??lez obsahuj??.
+  Fytochoriony neobsahuj??c?? ????dn?? n??lez zobrazeny nejsou. Stejn?? tak teritoria, kter?? neobsahuj?? alespo?? jeden fytochorion
+  obsahuj??c?? n??lez nejsou zobrazena.</p>
+  
+  <p>Zobrazit n??lezy v dan?? lokalit?? lze bu?? dvojklikem na uzel lokality anebo je mo??n?? jednoduch??m kliknut??m uzel ozna??it
+   a pak bu?? kliknout na lev?? doln?? tla????tko hledat anebo prav??m kliknut??m my??i vyvolat kontextov?? menu a v n??m kliknout
+   na "Hledat".</p>
+   
+   <p>Informace ve stromu se automaticky neaktualizuj?? spolu s editac?? datab??ze, aby se p??ede??lo neo??ek??van??mu zpomalen?? 
+   aplikace p??i pomal??m p??ipojen?? k serveru Plantlore p??i komunikaci p??es s????. Seznam lokalit ve fytochorionu lze 
+   jednodu??e zav??en??m a op??tovn??m rozbalen??m uzlu dan??ho fytochorionu. Pro nov?? na??ten?? cel?? struktury stromu slou???? prav??
+   doln?? tla????tko Obnovit. Funkci Obnovit lze vyvolat i z kontextov??ho menu.
+   </p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,271 +1,260 @@
-<html>
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>Plantlore Server</title>
-	</head>
-
-<body>
-
-	<h1 id="PurposeOfTheServer">Smysl serveru</h1>
-
-	<p>
-	Aby se mohli k Va???? datab??zi p??ipojovat i jin?? u??ivatel?? z po????ta???? v s??ti, 
-	mus?? b??t spu??t??n Plantlore Server. 
-	Server zprost??edkov??v?? p??ipojen?? vzd??len??m klient??m a dohl?????? na dodr??ov??n??
-	p??edepsan??ho po??tu klient??. Standardn?? se z jednoho po????ta??e (z jedn?? IP adresy)
-	sm?? p??ihl??sit nejv????e t??i klienti a maxim??ln?? celkov?? po??et sou??asn?? p??ipojen??ch
-	u??ivatel?? je omezen na 32.
-	</p>
-
-	<h2 id="HowToRunTheServer">1. Spu??t??n?? (vytvo??en??) serveru</h2>
-
-	<p>
-	Nastaven?? serveru lze prov??st na z??lo??ce <i>Spustit nov?? server</i>.
-	</p>
-
-	<p>
-	<img src="picture/ServerCreate.png" alt="Spu??t??n?? serveru.">
-	</p>
-
-
-	<p>
-	Server lze spustit pouze na lok??ln??m po????ta??i. Jako spr??vce serveru m??te mo??nost nastavit n??sleduj??c?? parametry:
-	</p>
-
-	<p>
-	<table>
-		<tr>
-			<th colspan="2">
-				Nastaven?? serveru
-			</th>
-		</tr>
-
-		<tr>
-			<th>
-				Parametr
-			</th>
-			<th>
-				V??znam
-			</th>
-		</tr>
-
-		<tr>
-			<td>
-				Heslo
-			</td>
-			<td>
-				Po spu??t??n?? je mo??n?? server <a href="#ManagingTheServer">administrovat</a> 
-				i ze vzd??len??ho po????ta??e.
-				Aby k n??mu nem??ly p????stup nepovolan?? osoby, 
-				je mo??n?? nastavit heslo, kter??m bude server chr??n??n.
-				Kdokoli se bude cht??t k serveru p??ipojit za ????elem
-				administrace, bude se muset t??mto heslem prok??zat.
-			</td>
-		</tr>
-
-		<tr>
-			<td>
-				Port
-			</td>
-			<td>
-				Port ur??uje, kde bude server naslouchat, aby se k n??mu mohli 
-				p??ipojovat vzd??len?? klienti. 
-
-				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, 
-				??e servery vyu????vaj?? porty vy?????? ne?? 1.024, nebo?? ni?????? porty
-				b??vaj?? rezervov??ny pro zn??m?? slu??by (FTP, HTTP, Telnet, ...).
-
-				Porty nelze sd??let - mus??te se ujistit, ??e na zvolen?? port ji??
-				n??kter?? jin?? aplikace nepou????v??.
-
-				Standardn?? port je 1099.
-			</td>
-		</tr>
-
-		<tr>
-			<th colspan="2">
-				Nastaven?? datab??zov??ho stroje
-			</th>
-		</tr>
-
-		<tr>
-			<th>
-				Parametr
-			</th>
-			<th>
-				V??znam
-			</th>
-		</tr>
-
-		<tr>
-			<td>
-				Typ DB
-			</td>
-			<td>
-				Existuje n??kolik datab??zov??ch stroj?? (database engine), kter?? umo????uj?? snadnou
-				pr??ci s datab??zemi, tabulkami, u??ivateli, dotazy a daty.
-				Ka??d?? datab??zov?? stroj m????e obsahovat n??kolik r??zn?? pojmenovan??ch datab??z??
-				s r??znou strukturou a s r??zn??m obsahem. Mezi nejzn??m??j???? datab??zov?? stroje
-				bezesporu pat???? Oracle, MSSQL, MySQL, Postgre a Firebird.
-				Plantlore podporuje pr??ci s r??zn??mi datab??zov??mi stroji,
-				ale je nutn?? p??esn?? specifikovat, o kter?? se jedn??, 
-				aby s n??m mohl bezchybn?? komunikovat. Plantlore je standardn?? dod??v??n
-				s Postgre. Aktu??ln?? podporovan?? DB stroje jsou seps??ny v rozbalovac??
-				nab??dce, ale je mo??n?? specifikovat i jin??.
-			</td>
-		</tr>
-
-		<tr>
-			<td>
-				Port DB
-			</td>
-			<td>
-				Datab??zov?? stroje umo????uj?? p??ipojen?? pouze p??es tzv. port. Ka??d?? datab??zov??
-				stroj m?? tento port jin?? a nav??c jej lze snadno zm??nit. Aby Plantlore Server v??d??l,
-				kde m?? datab??zov?? stroj kontaktovat, mus?? zn??t port, na kter??m stroj naslouch??.
-				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, ??e datab??zov?? stroje
-				vyu????vaj?? porty v rozsahu 1.024 a?? 10.000. Kup????kladu standardn?? port datab??zov??ho
-				stroje Postgre je 5432.
-			</td>
-		</tr>
-
-		<tr>
-			<td>
-				Parametr
-			</td>
-			<td>
-				Datab??zov?? stroj m????e b??t pot??eba je??t?? nakonfigurovat n??jak??m specifick??m
-				zp??sobem. N??kter?? stroje kup????kladu vy??aduj?? explicitn?? nastaven?? k??dov??n??
-				znak?? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou????
-				pro spr??vn?? nastaven?? dodate??n??ch paremetr?? p??ipojen?? k datab??zov??mu stroji.
-				P??ipojen?? k Postgre ????dn?? parametr nevy??aduje, ale nap??. pro spr??vn?? zobrazen??
-				diakritiky od Firebird je pot??eba k??dov??n?? nastavit.
-				<br/>
-				Odborn??: parametr je hodnota p??ed??van?? v p??ipojovac??m JDBC ??et??zci za ?
-			</td>
-		</tr>
-
-	</table>
-	</p>
-
-
-
-	<h2 id="HowToConnectToTheServer">2. P??ipojen?? k b??????c??mu serveru</h2>
-
-
-	<p>
-	V??te-li, ??e n??kde b?????? server, kter?? jste spustili, m????ete jej vzd??len??  
-	<a href="#ManagingTheServer">administrovat</a>. Nejprve se k tomuto serveru
-	mus??te p??ipojit pomoc?? z??lo??ky <i>P??ipojen?? k b??????c??mu serveru</i>.
-	</p>
-
-	<p>
-	<img src="picture/ServerConnect.png" alt="Spu??t??n?? serveru.">
-	</p>
-
-
-	<p>
-	Pro p??ipojen?? je nutno specifikovat n??sleduj??c?? parametry
-	</p>
-
-	<p>
-	<table>
-		<tr>
-			<th>
-				Parametr
-			</th>
-			<th>
-				V??znam
-			</th>
-		</tr>
-
-		<tr>
-			<td>
-				Host
-			</td>
-			<td>
-				Tento parametr identifikuje po????ta??, kde server b??????, a to bu?? podle
-				jeho tzv. hostname nebo IP adresy. Ka??d?? po????ta?? p??ipojen?? k s??ti mus?? m??t
-				svou vlastn?? unik??tn?? IP adresu, podle n???? je rozpozn??n. IP adresa je 
-				nej??ast??ji ??tve??ice ????sel odd??len?? te??kami, kup??. <i>192.168.0.247</i>.
-				N??kter?? po????ta??e maj?? krom?? IP adresy p??id??lena i jm??na, nap??. 
-				<i>data.domacisit.info</i>. 
-			</td>
-		</tr>
-
-		<tr>
-			<td>
-				Port
-			</td>
-			<td>
-				Port ur??uje, kde vzd??len?? server naslouch??.
-
-				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, 
-				??e servery vyu????vaj?? porty vy?????? ne?? 1.024, nebo?? ni?????? porty
-				b??vaj?? rezervov??ny pro zn??m?? slu??by (FTP, HTTP, Telnet, ...).
-
-				Standardn?? port je 1099.
-			</td>
-		</tr>
-
-		<tr>
-			<td>
-				Heslo
-			</td>
-			<td>
-				Heslo chr??n??c?? p????stup k serveru pro ????ely administrace.
-			</td>
-		</tr>
-	</table>
-	</p>
-
-
-
-
-	<h2 id="ManagingTheServer">3. Administrace (spr??va) serveru</h2>
-
-	<p>
-	Administrace slou???? p??edev????m k z??sk??n?? informac?? o aktu??ln?? p??ipojen??ch u??ivatel??ch
-	a vyp??n??n?? serveru. Slu??n?? administr??tor by m??l vy??kat, a?? se v??ichni u??ivatel??
-	odpoj??, ne?? vypne server. Plantlore Server neimplementuje ????dn?? zp??sob 
-	notifikace klient??, m??-li b??t server vypnut.
-	</p>
-
-	<p>
-	<img src="picture/ServerManager.png" alt="Administrace serveru.">
-	</p>
-
-	<p>
-	Po p??ipojen??/vytvo??en?? k serveru je k disposici seznam aktu??ln?? p??ipojen??ch u??ivatel??.
-	D??le je mo??n?? prov??st n??sleduj??c?? operace:
-	<ul>
-		<li><b>Obnovit</b>.
-		Aktualizuje seznam s u??ivateli p??ihl????en??mi k tomuto serveru.
-		</li>
-		<li><b>Vyhodit</b>.
-		Odpoj?? v??echny vybran?? (ozna??en??) klienty od serveru (tzv. kick).
-		Odpojen?? je n??siln?? a p??eru???? v??echny operace, kter?? klient prov??d??.
-		Neslou???? k zabr??n??n?? op??tovn??ho p??ipojen?? k serveru.
-		</li>
-		<li><b>Zastavit</b>.
-		Ukon???? ??innost serveru, v??ichni u??ivatel?? p??ihl????en?? k tomuto serveru budou odpojeni
-		bez ohledu na to, zda maj?? spu??t??ny n??jak?? operace.
-		</li>
-		<li><b>Skr??t</b>.
-		Skryje okno, ale server nech?? b????et.
-		</li>
-	</ul>
-	</p>
-	
-
-	
-
-	<p>
-	</p>
-
-
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Plantlore Server</title>
+  </head>
+  <body>
+	<h1 id="PurposeOfTheServer">Smysl serveru</h1>
+
+	<p>
+	Aby se mohli k Va???? datab??zi p??ipojovat i jin?? u??ivatel?? z po????ta???? v s??ti, 
+	mus?? b??t spu??t??n Plantlore Server. 
+	Server zprost??edkov??v?? p??ipojen?? vzd??len??m klient??m a dohl?????? na dodr??ov??n??
+	p??edepsan??ho po??tu klient??. Standardn?? se z jednoho po????ta??e (z jedn?? IP adresy)
+	sm?? p??ihl??sit nejv????e t??i klienti a maxim??ln?? celkov?? po??et sou??asn?? p??ipojen??ch
+	u??ivatel?? je omezen na 32.
+	</p>
+
+	<h2 id="HowToRunTheServer">1. Spu??t??n?? (vytvo??en??) serveru</h2>
+
+	<p>
+	Nastaven?? serveru lze prov??st na z??lo??ce <i>Spustit nov?? server</i>.
+	</p>
+
+	<p>
+	<img src="picture/ServerCreate.png" alt="Spu??t??n?? serveru.">
+	</p>
+
+
+	<p>
+	Server lze spustit pouze na lok??ln??m po????ta??i. Jako spr??vce serveru m??te mo??nost nastavit n??sleduj??c?? parametry:
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th colspan="2">
+				Nastaven?? serveru
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V??znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Po spu??t??n?? je mo??n?? server <a href="#ManagingTheServer">administrovat</a> 
+				i ze vzd??len??ho po????ta??e.
+				Aby k n??mu nem??ly p????stup nepovolan?? osoby, 
+				je mo??n?? nastavit heslo, kter??m bude server chr??n??n.
+				Kdokoli se bude cht??t k serveru p??ipojit za ????elem
+				administrace, bude se muset t??mto heslem prok??zat.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur??uje, kde bude server naslouchat, aby se k n??mu mohli 
+				p??ipojovat vzd??len?? klienti. 
+
+				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, 
+				??e servery vyu????vaj?? porty vy?????? ne?? 1.024, nebo?? ni?????? porty
+				b??vaj?? rezervov??ny pro zn??m?? slu??by (FTP, HTTP, Telnet, ...).
+
+				Porty nelze sd??let - mus??te se ujistit, ??e na zvolen?? port ji??
+				n??kter?? jin?? aplikace nepou????v??.
+
+				Standardn?? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<th colspan="2">
+				Nastaven?? datab??zov??ho stroje
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V??znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Typ DB
+			</td>
+			<td>
+				Existuje n??kolik datab??zov??ch stroj?? (database engine), kter?? umo????uj?? snadnou
+				pr??ci s datab??zemi, tabulkami, u??ivateli, dotazy a daty.
+				Ka??d?? datab??zov?? stroj m????e obsahovat n??kolik r??zn?? pojmenovan??ch datab??z??
+				s r??znou strukturou a s r??zn??m obsahem. Mezi nejzn??m??j???? datab??zov?? stroje
+				bezesporu pat???? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr??ci s r??zn??mi datab??zov??mi stroji,
+				ale je nutn?? p??esn?? specifikovat, o kter?? se jedn??, 
+				aby s n??m mohl bezchybn?? komunikovat. Plantlore je standardn?? dod??v??n
+				s Postgre. Aktu??ln?? podporovan?? DB stroje jsou seps??ny v rozbalovac??
+				nab??dce, ale je mo??n?? specifikovat i jin??.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port DB
+			</td>
+			<td>
+				Datab??zov?? stroje umo????uj?? p??ipojen?? pouze p??es tzv. port. Ka??d?? datab??zov??
+				stroj m?? tento port jin?? a nav??c jej lze snadno zm??nit. Aby Plantlore Server v??d??l,
+				kde m?? datab??zov?? stroj kontaktovat, mus?? zn??t port, na kter??m stroj naslouch??.
+				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, ??e datab??zov?? stroje
+				vyu????vaj?? porty v rozsahu 1.024 a?? 10.000. Kup????kladu standardn?? port datab??zov??ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Parametr
+			</td>
+			<td>
+				Datab??zov?? stroj m????e b??t pot??eba je??t?? nakonfigurovat n??jak??m specifick??m
+				zp??sobem. N??kter?? stroje kup????kladu vy??aduj?? explicitn?? nastaven?? k??dov??n??
+				znak?? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou????
+				pro spr??vn?? nastaven?? dodate??n??ch paremetr?? p??ipojen?? k datab??zov??mu stroji.
+				P??ipojen?? k Postgre ????dn?? parametr nevy??aduje, ale nap??. pro spr??vn?? zobrazen??
+				diakritiky od Firebird je pot??eba k??dov??n?? nastavit.
+				<br/>
+				Odborn??: parametr je hodnota p??ed??van?? v p??ipojovac??m JDBC ??et??zci za ?
+			</td>
+		</tr>
+
+	</table>
+	</p>
+
+
+
+	<h2 id="HowToConnectToTheServer">2. P??ipojen?? k b??????c??mu serveru</h2>
+
+
+	<p>
+	V??te-li, ??e n??kde b?????? server, kter?? jste spustili, m????ete jej vzd??len??  
+	<a href="#ManagingTheServer">administrovat</a>. Nejprve se k tomuto serveru
+	mus??te p??ipojit pomoc?? z??lo??ky <i>P??ipojen?? k b??????c??mu serveru</i>.
+	</p>
+
+	<p>
+	<img src="picture/ServerConnect.png" alt="Spu??t??n?? serveru.">
+	</p>
+
+
+	<p>
+	Pro p??ipojen?? je nutno specifikovat n??sleduj??c?? parametry
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V??znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Host
+			</td>
+			<td>
+				Tento parametr identifikuje po????ta??, kde server b??????, a to bu?? podle
+				jeho tzv. hostname nebo IP adresy. Ka??d?? po????ta?? p??ipojen?? k s??ti mus?? m??t
+				svou vlastn?? unik??tn?? IP adresu, podle n???? je rozpozn??n. IP adresa je 
+				nej??ast??ji ??tve??ice ????sel odd??len?? te??kami, kup??. <i>192.168.0.247</i>.
+				N??kter?? po????ta??e maj?? krom?? IP adresy p??id??lena i jm??na, nap??. 
+				<i>data.domacisit.info</i>. 
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur??uje, kde vzd??len?? server naslouch??.
+
+				Port je ????slo v rozsahu 0 a?? 65.535, p??i??em?? je b????n??, 
+				??e servery vyu????vaj?? porty vy?????? ne?? 1.024, nebo?? ni?????? porty
+				b??vaj?? rezervov??ny pro zn??m?? slu??by (FTP, HTTP, Telnet, ...).
+
+				Standardn?? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Heslo chr??n??c?? p????stup k serveru pro ????ely administrace.
+			</td>
+		</tr>
+	</table>
+	</p>
+
+
+
+
+	<h2 id="ManagingTheServer">3. Administrace (spr??va) serveru</h2>
+
+	<p>
+	Administrace slou???? p??edev????m k z??sk??n?? informac?? o aktu??ln?? p??ipojen??ch u??ivatel??ch
+	a vyp??n??n?? serveru. Slu??n?? administr??tor by m??l vy??kat, a?? se v??ichni u??ivatel??
+	odpoj??, ne?? vypne server. Plantlore Server neimplementuje ????dn?? zp??sob 
+	notifikace klient??, m??-li b??t server vypnut.
+	</p>
+
+	<p>
+	<img src="picture/ServerManager.png" alt="Administrace serveru.">
+	</p>
+
+	<p>
+	Po p??ipojen??/vytvo??en?? k serveru je k disposici seznam aktu??ln?? p??ipojen??ch u??ivatel??.
+	D??le je mo??n?? prov??st n??sleduj??c?? operace:
+	<ul>
+		<li><b>Obnovit</b>.
+		Aktualizuje seznam s u??ivateli p??ihl????en??mi k tomuto serveru.
+		</li>
+		<li><b>Vyhodit</b>.
+		Odpoj?? v??echny vybran?? (ozna??en??) klienty od serveru (tzv. kick).
+		Odpojen?? je n??siln?? a p??eru???? v??echny operace, kter?? klient prov??d??.
+		Neslou???? k zabr??n??n?? op??tovn??ho p??ipojen?? k serveru.
+		</li>
+		<li><b>Zastavit</b>.
+		Ukon???? ??innost serveru, v??ichni u??ivatel?? p??ihl????en?? k tomuto serveru budou odpojeni
+		bez ohledu na to, zda maj?? spu??t??ny n??jak?? operace.
+		</li>
+		<li><b>Skr??t</b>.
+		Skryje okno, ale server nech?? b????et.
+		</li>
+	</ul>
+	</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/settings.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/settings.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/settings.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,35 +1,34 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Nastaven??</title>
-</head>
-<body>
-<h1>Nastaven??</h1>
-
-<p>Chov??n?? Plantlore je mo??n?? do jist?? m??ry ovlivnit nastaven??m. Mo??nosti nastaven?? se vyvol??vaj?? z menu
-Soubor. </p>
-
-<p>Dialog Nastaven?? obsahuje ??ty??i z??lo??ky. Z toho pouze nastaven?? jazyku se projev?? a?? po restartu
-aplikace. Ostatn?? zm??ny se projev?? hned po potvrzen?? kliknut??m na Ok.</p>
-
-<img src="picture/settings_languages_cz.png" alt="V??b??r jazyku aplikace">
-
-<p>V z??lo??ce Sloupky je mo??n?? si vybrat sloupky a po??ad??, ve kter??m se maj?? zobrazovat v p??ehledu n??lez??. 
-Nastaven?? se projev?? ihned po potvrzen?? kliknt??m na Ok.</p>
-
-<img src="picture/settings_columns_cz.png">
-
-<p>Plantlore dovoluje jednouduchou ??pravu nadpis??, kter?? se generuj?? ve sched??. Slou???? k tomu
-z??lo??ka Scheda.</p>
-
-<img src="picture/settings_scheda_cz.png">
-
-<p>Posledn?? z??lo??ka, Obecn??, umo????uje zapnut?? a vypnut?? automatick??ho nastavov??n?? velikosti
-str??nky v p??ehledu n??lez??. Automatick?? nastavov??n?? doporu??ujeme pou????vat pouze p??i pr??ci po
-lok??ln?? s??ti. P??i pomalej????m p??ipojen?? by tato funkce mohla zdr??ovat.</p>
-
-<img src="picture/settings_general_cz.png">
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Nastaven??</title>
+  </head>
+  <body>
+  <h1>Nastaven??</h1>
+<p>Chov??n?? Plantlore je mo??n?? do jist?? m??ry ovlivnit nastaven??m. Mo??nosti nastaven?? se vyvol??vaj?? z menu
+Soubor. </p>
+
+<p>Dialog Nastaven?? obsahuje ??ty??i z??lo??ky. Z toho pouze nastaven?? jazyku se projev?? a?? po restartu
+aplikace. Ostatn?? zm??ny se projev?? hned po potvrzen?? kliknut??m na Ok.</p>
+
+<img src="picture/settings_languages_cz.png" alt="V??b??r jazyku aplikace">
+
+<p>V z??lo??ce Sloupky je mo??n?? si vybrat sloupky a po??ad??, ve kter??m se maj?? zobrazovat v p??ehledu n??lez??. 
+Nastaven?? se projev?? ihned po potvrzen?? kliknt??m na Ok.</p>
+
+<img src="picture/settings_columns_cz.png">
+
+<p>Plantlore dovoluje jednouduchou ??pravu nadpis??, kter?? se generuj?? ve sched??. Slou???? k tomu
+z??lo??ka Scheda.</p>
+
+<img src="picture/settings_scheda_cz.png">
+
+<p>Posledn?? z??lo??ka, Obecn??, umo????uje zapnut?? a vypnut?? automatick??ho nastavov??n?? velikosti
+str??nky v p??ehledu n??lez??. Automatick?? nastavov??n?? doporu??ujeme pou????vat pouze p??i pr??ci po
+lok??ln?? s??ti. P??i pomalej????m p??ipojen?? by tato funkce mohla zdr??ovat.</p>
+
+<img src="picture/settings_general_cz.png">  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,222 +1,216 @@
-<html>
-
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>Import dat</title>
-
-	</head>
-
-<body>
-
-	<h1>Import dat do tabulek</h1>
-
-	<p>
-	Import dat do tabulek je ur??en pouze pro administr??tory datab??ze a slou???? k aktualizaci (p??edev????m k oprav??)
-	dat v n??sleduj??c??ch tabulk??ch: 
-	Rostliny (Plants), Metadata, Fytochoriony, Teritoria a Nejbli?????? v??t???? s??dla (Villages).
-	</p>
-
-	<p>
-	P??edpokl??d?? se, ??e Plantlore bude dod??v??n se seznamem rostlin, Fytochorion??, Teritori?? a
-	Nejbli??????ch v??t????ch s??del; z??znamy obsa??en?? v t??chto tabulk??ch mohou vznikat, zanikat, 
-	nebo obsahovat chyby. Jejich ??pravu lze zajistit naimportov??n??m speci??ln??ho souboru.
-	</p>
-
-
-	<h2>1. Vlastn?? import dat do tabulek</h2>
-
-	<p>
-	Import za????n?? v??b??rem souboru, v n??m?? jsou ulo??ena data.
-	Form??t souboru je speci??ln?? a je pops??n n????e.
-	</p>
-
-	<p>
-	Po v??b??ru souboru je zobrazeno okno zobrazuj??c?? pr??b??h procesu importov??n?? dat. 
-	Import lze p??eru??it stiskem tla????tka <i>Storno</i>. 
-	P??eru????te-li Import, n??lezov?? data, kter?? se stihla naimportovat, v datab??zi z??stanou.
-	</p>
-
-
-	<h2>2. Form??t souboru pro import dat do tabulek - pro Administr??tory datab??ze</h2>
-
-	<p>
-	Form??t souboru dovoluje p??id??v??n?? nov??ch z??znam??, odmaz??v??n?? p??vodn??ch z??znam?? v tabulk??ch
-	a aktualizaci st??vaj??c??ch z??znam??. Z??kladem je XML strom obsahuj??c?? na t??i v??tve - ADD, DELETE
-	a UPDATE. Ko??en stromu ur??uje tabulku, do kter?? budou data n??le??et.
-	</p>
-
-
-	<p>
-	<table>
-		<tr>
-			<th>Ko??enov?? tag</th><th>Tabulka</th>
-		</tr>
-		<tr>
- 			<td>plants</td><td>plant (rostliny)</td>
-		</tr>
-		<tr>
-			<td>villages</td><td>village (nejbli?????? v??t???? s??dla)</td>
-		</tr>
-		<tr>
-			<td>phytochoria</td><td>phytochorion (fytochoriony)</td>
-		</tr>
-		<tr>
-			<td>territories</td><td>territory (teritorium)</td>
-		</tr>
-		<tr>
-			<td>metadata</td><td>metadata (meta-data)</td>
-		</tr>
-	</table>
-	</p>
-
-	<p>
-	Uk??zka XML stromu pro ??pravu tabulky rostlin (Plants):
-	</p>
-
-
-	<p>
-	<pre>
-	&lt;plants&gt;
-
-	  &lt;add&gt;
-		&lt;plant&gt;&lt;/plant&gt;
-		&lt;plant&gt;&lt;/plant&gt;
-		...
-	  &lt;/add&gt;
-
-	  &lt;delete&gt;
-		&lt;plant&gt;&lt;/plant&gt;
-		&lt;plant&gt;&lt;/plant&gt;
-		...
-	  &lt;/delete&gt;
-
-	  &lt;update&gt;	  
-		&lt;plant&gt;&lt;/plant&gt;
-		&lt;plant&gt;&lt;/plant&gt;
-		...
-	  &lt;/update&gt;
-
-	&lt;/plants&gt;
-	</pre>
-	</p>
-	
-		  
-
-	<p>
-	</p>
-
-
-	<h3>2.1. Vlo??en?? nov??ho z??znamu - ADD</h3>
-
-	<p>
-	V??tev ADD obsahuje z??znamy, kter?? maj?? b??t do datab??ze p??id??ny. Pokud se v datab??zi ji?? nach??z??,
-	nejsou vkl??d??ny znovu, aby nedoch??zelo k vytv????en?? duplicitn??ch z??znam??.
-	</p>
-
-	<p>
-	<pre>
-	  &lt;add&gt;
-		&lt;plant&gt;
-		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
-		  &lt;genus&gt;Acinos&lt;/genus&gt;
-		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
-		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
-		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
-		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
-		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
-		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
-		&lt;/plant&gt;
-	  &lt;/add&gt;
-	</pre>
-	</p>
-
-
-
-	<h3>2.2. Vymaz??n?? existuj??c??ho z??znamu - DELETE </h3>
-
-	<p>
-	V??tev DELETE obsahuje z??znamy ur??en?? k vymaz??n??. Z??znam z tabulky nelze smazat, pokud na n??j
-	existuj?? reference.
-	</p>
-
-	<p>
-	<pre>
-	  &lt;delete&gt;
-		&lt;plant&gt;
-		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
-		  &lt;genus&gt;Acinos&lt;/genus&gt;
-		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
-		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
-		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
-		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
-		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
-		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
-		&lt;/plant&gt;
-	  &lt;/delete&gt;
-	</pre>
-	</p>
-
-
-
-	<h3>2.3. Akutalizace existuj??c??ho z??znamu - UPDATE </h3>
-
-	<p>
-	V??tev UPDATE obsahuje dvojice po sob?? jdouc??ch z??znam?? - <i>origin??l</i> a <i>n??hradu</i>. 
-	Pokud se origin??l v tabulce nenach??z??,
-	provede se s <i>n??hradou</i> operace vlo??en?? (jako kdyby byla ve v??tvi ADD).
-	Pokud u?? se <i>n??hrada</i> v datab??zi nal??z??, 
-	provede se s <i>origin??lem</i> operace smaz??n?? (jako kdyby byl um??st??n ve v??tvi DELETE).
-	</p>
-
-	<p>
-	<pre>
-	  &lt;update&gt;
-		&lt;plant&gt;
-		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
-		  &lt;genus&gt;Acinos&lt;/genus&gt;
-		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
-		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
-		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
-		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
-		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
-		  &lt;surveytaxid&gt;<font color=RED>ARVACoacg</font>&lt;/surveytaxid&gt;
-		&lt;/plant&gt;
-		&lt;plant&gt;
-		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
-		  &lt;genus&gt;Acinos&lt;/genus&gt;
-		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
-		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
-		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
-		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
-		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
-		  &lt;surveytaxid&gt;<font color=RED>ACIARVACoacg</font>&lt;/surveytaxid&gt;
-		&lt;/plant&gt;
-	  &lt;/update&gt;
-	</pre>
-	</p>
-
-
-
-
-
-	<h2>3. Omezen??, kter?? je nutno zv????it p??i Importu do tabulek</h2>
-
-	<p>
-	Import do zmi??ovan??ch tabulek je v??sadou administr??tora datab??ze. Jedn?? se o data, 
-	kter?? mus?? b??t udr??ov??na jednotn?? nap?????? v??emi datab??zemi, a tedy o jejich aktualizaci
-	by m??la pe??ovat zodpov??dn?? osoba. N??lezov?? data, kter?? obsahuj?? z??znamy s neplatn??mi ??daji 
-	v t??chto tabulk??ch, nen?? mo??n?? naimportovat z d??vodu ochrany kvality n??lezov??ch dat.
-	Nen?? nap??. mo??n?? p??i <a href="./import.html">Importu n??lezov??ch dat</a> vlo??it z??znam
-	obsahuj??c?? neplatn?? (tj. v tabulce Plants neexistuj??c??) jm??no rostliny.
-	</p>
-
-	<p>
-	Import do tabulek je prim??rn?? navr??en pro pr??ci s mal??mi rozd??lov??mi seznamy
-	(obsahuj??c?? ????dov?? tis??ce z??znam??). V??t???? soubory mohou m??t ne??nosn?? pam????ov??
-	n??roky.
-	</p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Import dat</title>
+  </head>
+  <body>
+  <h1>Import dat do tabulek</h1>
+	<p>
+	Import dat do tabulek je ur??en pouze pro administr??tory datab??ze a slou???? k aktualizaci (p??edev????m k oprav??)
+	dat v n??sleduj??c??ch tabulk??ch: 
+	Rostliny (Plants), Metadata, Fytochoriony, Teritoria a Nejbli?????? v??t???? s??dla (Villages).
+	</p>
+
+	<p>
+	P??edpokl??d?? se, ??e Plantlore bude dod??v??n se seznamem rostlin, Fytochorion??, Teritori?? a
+	Nejbli??????ch v??t????ch s??del; z??znamy obsa??en?? v t??chto tabulk??ch mohou vznikat, zanikat, 
+	nebo obsahovat chyby. Jejich ??pravu lze zajistit naimportov??n??m speci??ln??ho souboru.
+	</p>
+
+
+	<h2>1. Vlastn?? import dat do tabulek</h2>
+
+	<p>
+	Import za????n?? v??b??rem souboru, v n??m?? jsou ulo??ena data.
+	Form??t souboru je speci??ln?? a je pops??n n????e.
+	</p>
+
+	<p>
+	Po v??b??ru souboru je zobrazeno okno zobrazuj??c?? pr??b??h procesu importov??n?? dat. 
+	Import lze p??eru??it stiskem tla????tka <i>Storno</i>. 
+	P??eru????te-li Import, n??lezov?? data, kter?? se stihla naimportovat, v datab??zi z??stanou.
+	</p>
+
+
+	<h2>2. Form??t souboru pro import dat do tabulek - pro Administr??tory datab??ze</h2>
+
+	<p>
+	Form??t souboru dovoluje p??id??v??n?? nov??ch z??znam??, odmaz??v??n?? p??vodn??ch z??znam?? v tabulk??ch
+	a aktualizaci st??vaj??c??ch z??znam??. Z??kladem je XML strom obsahuj??c?? na t??i v??tve - ADD, DELETE
+	a UPDATE. Ko??en stromu ur??uje tabulku, do kter?? budou data n??le??et.
+	</p>
+
+
+	<p>
+	<table>
+		<tr>
+			<th>Ko??enov?? tag</th><th>Tabulka</th>
+		</tr>
+		<tr>
+ 			<td>plants</td><td>plant (rostliny)</td>
+		</tr>
+		<tr>
+			<td>villages</td><td>village (nejbli?????? v??t???? s??dla)</td>
+		</tr>
+		<tr>
+			<td>phytochoria</td><td>phytochorion (fytochoriony)</td>
+		</tr>
+		<tr>
+			<td>territories</td><td>territory (teritorium)</td>
+		</tr>
+		<tr>
+			<td>metadata</td><td>metadata (meta-data)</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	Uk??zka XML stromu pro ??pravu tabulky rostlin (Plants):
+	</p>
+
+
+	<p>
+	<pre>
+	&lt;plants&gt;
+
+	  &lt;add&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;/add&gt;
+
+	  &lt;delete&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;/delete&gt;
+
+	  &lt;update&gt;	  
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;/update&gt;
+
+	&lt;/plants&gt;
+	</pre>
+	</p>
+	
+		  
+
+	<p>
+	</p>
+
+
+	<h3>2.1. Vlo??en?? nov??ho z??znamu - ADD</h3>
+
+	<p>
+	V??tev ADD obsahuje z??znamy, kter?? maj?? b??t do datab??ze p??id??ny. Pokud se v datab??zi ji?? nach??z??,
+	nejsou vkl??d??ny znovu, aby nedoch??zelo k vytv????en?? duplicitn??ch z??znam??.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;add&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/add&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.2. Vymaz??n?? existuj??c??ho z??znamu - DELETE </h3>
+
+	<p>
+	V??tev DELETE obsahuje z??znamy ur??en?? k vymaz??n??. Z??znam z tabulky nelze smazat, pokud na n??j
+	existuj?? reference.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;delete&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/delete&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.3. Akutalizace existuj??c??ho z??znamu - UPDATE </h3>
+
+	<p>
+	V??tev UPDATE obsahuje dvojice po sob?? jdouc??ch z??znam?? - <i>origin??l</i> a <i>n??hradu</i>. 
+	Pokud se origin??l v tabulce nenach??z??,
+	provede se s <i>n??hradou</i> operace vlo??en?? (jako kdyby byla ve v??tvi ADD).
+	Pokud u?? se <i>n??hrada</i> v datab??zi nal??z??, 
+	provede se s <i>origin??lem</i> operace smaz??n?? (jako kdyby byl um??st??n ve v??tvi DELETE).
+	</p>
+
+	<p>
+	<pre>
+	  &lt;update&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>ARVACoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj??k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj??k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam??tn??k roln?? chlupat??&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>ACIARVACoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/update&gt;
+	</pre>
+	</p>
+
+
+
+
+
+	<h2>3. Omezen??, kter?? je nutno zv????it p??i Importu do tabulek</h2>
+
+	<p>
+	Import do zmi??ovan??ch tabulek je v??sadou administr??tora datab??ze. Jedn?? se o data, 
+	kter?? mus?? b??t udr??ov??na jednotn?? nap?????? v??emi datab??zemi, a tedy o jejich aktualizaci
+	by m??la pe??ovat zodpov??dn?? osoba. N??lezov?? data, kter?? obsahuj?? z??znamy s neplatn??mi ??daji 
+	v t??chto tabulk??ch, nen?? mo??n?? naimportovat z d??vodu ochrany kvality n??lezov??ch dat.
+	Nen?? nap??. mo??n?? p??i <a href="./import.html">Importu n??lezov??ch dat</a> vlo??it z??znam
+	obsahuj??c?? neplatn?? (tj. v tabulce Plants neexistuj??c??) jm??no rostliny.
+	</p>
+
+	<p>
+	Import do tabulek je prim??rn?? navr??en pro pr??ci s mal??mi rozd??lov??mi seznamy
+	(obsahuj??c?? ????dov?? tis??ce z??znam??). V??t???? soubory mohou m??t ne??nosn?? pam????ov??
+	n??roky.
+	</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/user.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/user.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/html/user.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,125 +1,124 @@
-<html>
-<head>
-<meta http-equiv="Content-Language" content="cs-CZ" />
-<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-<title>Spr??va u??ivatel??</title>
-</head>
-<body>
-<h1>Spr??va u??ivatel??</h1>
-
-<img src="picture/userEnter_cs.png">
-<br><br>
-
-Spr??vce u??ivatel?? umo????uje administr??torovi p??id??vat a editovat u??ivatele, nastavovat pr??va u??ivatel?? a tak?? ukon??ovat jejich p????stup do aplikace. 
-Spr??vce u??ivatel?? otev??ete z menu <b>Data/Spr??va u??ivatel??</b>.
-
-<h5>Dialog spr??vce u??ivatel??</h5>
-
-<img src="picture/userDialog_cs.png">
-<br><br>
-Dialog pro spr??vu u??ivatelsk??ch ????t?? je rozd??len do dvou ????st??:
-<ul>
-  <li><b>Seznam u??ivatel??</b> - zobrazen?? seznamu u??ivatel?? podle kriteri?? zadan??ch pro vyhled??v??n?? a set????zen?? 
-  <li><b>Vyhled??v??n??</b> - zad??n?? po??adavk?? pro vyhled??v??n?? a set????zen?? u??ivatel??
-</ul>
-
-<h2>Seznam u??ivatel??</h2>
-
-Po ??sp????n??m vyhled??v??n?? je v t??to ????sti zobrazen seznam vyhledan??ch u??ivatel??. Po??et u??ivatel?? zobrazen??ch v tabulce si m????ete sami nastavit p??eps??n??m 
-hodnoty pro <b><i>Zobrazit ????dk??</i></b> a potvrzen??m nov?? hodnoty kl??vesov??m tla????tkem ENTER. V tabulce se p??ep??n??te na dal???? nebo p??edchoz?? 
-seznam u??ivatel?? pomoc?? tla????tek <b><i>P??edchoz??</i></b> a <b><i>N??sleduj??c??</i></b>. Informace o aktu??ln?? zobrazen??m seznamu u??ivatel?? jsou uvedeny v ????sti 
-pod tabulkou. 
-<br>
-Pro pr??ci se z??znamem jsou zde k dispozici tla????tka:
-<ul>    
-   <li><i><b>P??idej u??ivatele </i></b> - <a href=#add>p??id??n?? u??ivatele</a></li>
-   <li><i><b>Edituj u??ivatele</i></b> - <a href=#edit>editace u??ivatele</a></li>
-   <li><i><b>Detail u??ivatele</i></b> - <a href=#detail>detailn?? data a pr??va u??ivatele</a></li>
-   <li><i><b>Zru?? u??ivatele</i></b> - <a href=#drop>zru??en?? p????stupu u??ivatele</a></li> 
-</ul>   
-  
-<h2>Vyhled??v??n??</h2>
-
-Spr??vce u??ivatel?? n??b??z?? administr??torovi mo??nost vyhled??vat podle ??ty?? parametr??: login, jm??no, email a adresa. V??sledek m????e b??t set????zen podle loginu,
-k??esn??ho jm??na, p????jmen?? a datumu vytvo??en?? u??ivatele a to sestupn??, nebo vzestupn??. Dal????m krit??riem pro vyhled??v??n?? je po??adavek zobrazen?? v??ech 
-u??ivatel??, nebo jen u??ivatel?? s platn??m p????stupem do aplikace (hodnota polo??ky <i>Datum zru??en?? u??ivatele</i> je u t??chto u??ivatel?? nevypln??na). 
-Pokud nejsou zad??ny, ??adn?? parametry a omezen?? budou vyhled??ni v??ichni u??ivatel??. 
-<br><br>
-<b>Pozor:</b>  p??i vyhled??v??n?? jsou rozli????v??na velk?? a mal?? p??smena (case insensitive).
-
-<a name="add"></a><h2>P??id??n?? u??ivatele</h2>
-  
-  <h5>Dialog pro p??id??n?? u??ivatele</h5>
-  
-  <img src="picture/userAdd_cs.png">
-  <br><br>
-  Dialog pro p??id??n?? nov??ho u??ivatele m????ete otev????t ze Spr??vce U??ivatel??. V zobrazen??m okn?? jsou k vypln??n?? n??sleduj??c?? polo??ky:
-  <ul>
-    <li><b>Login</b> - login u??ivatele, kter?? bude pou????vat k p??ihla??ov??n?? do aplikace. Tato polo??ka je povinn?? a bez jej??ho vypln??n?? v??m aplikace nedovol??
-    ??ivatele p??idat. Login musi b??t v r??mci datab??ze jednozna??n?? a nen?? po ulo??en?? u??ivatele editovateln??.</li>
-    <li><b>Heslo</b> - p??ihla??ovac?? heslo u??ivatele. Tato polo??ka je povinn??.</li>
-    <li><b>Jm??no</b> - k??esn?? jm??no u??ivatele. Tato polo??ka je povinn??.</li>
-    <li><b>P????jmen??</b> - p????jmen?? u??ivatele. Tato polo??ka je povinn??.</li>
-    <li><b>Email</b> - email u??ivatele. Tato polo??ka je povinn??.</li>
-    <li><b>Adresa</b> - adresa u??ivatele.</li>    
-    <li><b>Pozn??mka</b> - pozn??mka administr??tora o u??ivateli</li>    
-    <li><b>Administr??torsk?? pr??vo</b> - jeho ozna??en??m z??sk?? u??ivatel stejn?? pr??va jako administr??tor</li>
-    <li><b>Pr??vo editovat v??e</b> - jeho ozna??en??m z??sk?? u??ivatel pr??vo editovat v??echny n??lezy v datab??zy</li>
-    <li><b>Pr??vo p??id??vat z??znamy</b> - jeho ozna??en??m z??sk?? u??ivatel pr??vo pro p??id??v??n?? nov??ch n??lez??</li>
-    <li><b>Pravo editace n??lez?? u??ivatel??</b> - tato polo??ka obsahuje seznam u??ivatel??, jejich?? n??lezy bude moci dan?? u??ivatel editovat</li>    
- </ul>
- 
-<a name="edit"></a><h2>Editace u??ivatele</h2>
-<h5>Dialog pro editaci u??ivatele</h5>
-<img src="picture/userEdit_cs.png">
-<br><br>
-  Dialog pro editaci existuj??c??ho u??ivatele otev??ete ze Spr??vce u??ivatel??. Nezapome??te, ??e pro otev??en?? dialogu mus??te m??t ozna??en??ho u??ivatele.
-  Vzhled edit dialogu je t??m???? toto??n?? s add dialogem. Povinn?? polo??ky jsou: heslo, jm??no, p????jmen??, email.<br> 
-  Needitovatelen?? polo??ky jsou: 
-  <ul>
-    <li><b>Login</b></li>
-    <li><b>Datum vytvo??en??</b> - datum a ??as informuj??c?? o vytvo??en?? u??ivatele. Needitovateln?? polo??ka. </li>
-    <li><b>Datum zru??en??</b> - datum a ??as informuj??c?? o zru??en?? p????stupu u??ivatele do aplikace. Needitovateln?? polo??ka.</li>
-  </ul>
-
-<a name="detail"></a><h2>Detailn?? data a pr??va u??ivatele</h2>
-
-  Dialog zobrazuj??c?? detailn?? informaci o u??ivatelovi a jeho pr??vech otev??ete ze Spr??vce u??ivatel??. Pro otev??en?? tohoto dialogu je nutn?? 
-  ozna??it po??adovan??ho u??ivatele v seznamu u??ivatel??. Dialog je t??m???? toto??n?? s edit dialogem. V??echny polo??ky jsou needitovateln??, maj?? jen 
-  informa??n?? charakter.
-  
-<a name="drop"></a><h2>Zru??en?? p????stupu u??ivatele</h2>
-
-  Pro zru??en?? p????stupu u??ivatele do aplikace se pou??ije tla????tko <i><b>Zru?? u??ivatele</b></i> ve spr??vci u??ivatel??. P??ed stisknut??m tohoto tla????tka je nutn??
-  ozna??i po??adovan??ho u??ivatele v seznamu u??ivatel??. Po stisku tohoto tla????tka bude u??ivatel informov??n o operaci, kterou se chyst?? prov??st. Potvrzen??m
-  t??to operace bude u??ivatelovi nastaven aktualn?? ??as do polo??ky <i>Datum zru??en?? u??ivatele.</i>.   
-  <br><br>
-  <img src="picture/userDrop_cs.png">
-  <br><br>
-  Obnoven?? p????stupu pro zru??en??ho u??ivate znamen?? p??id??n?? nov??ho u??ivatele. V datab??zi tak z??st??v?? p??ehled o obdob??ch, kdy m??l kter?? u??ivatel 
-  p????stup do aplikace.  
-
-<a name="rights"></a><h2>Pr??va u??ivatele</h2>
-  
-  Administr??tor p??i p??id??v??n?? ??i editaci u??ivatele nastavuje pr??va pro pr??ci s n??lezov??mi daty.<br> 
-  
-  <h5>Nastaven?? pr??v</h5>
-  <img src="picture/userRight_cs.png">
-  <br><br>
-  U??ivatel m????e m??t n??sleduj??c?? pr??va:
-  <ul>
-    <li><b>pr??vo prohl????en?? dat</b> - toto pr??vo se nikde nenastavuje a u??ivatel je z??sk??v?? automaticky s vytvo??en??m p????stupu do aplikace</li>
-    <li><b>pr??vo p??id??vat data</b> - nastaven??m tohoto pr??va m?? u??ivatel mo??nost p????d??vat n??lezy, autory a publikace. Z??rove?? m?? automaticky pr??vo
-    editovat z??znamy, kter?? p??idal. D??le m?? pr??vo na zobrazen?? historie n??lezu, kter?? p??idal.</li>
-    <li><b>pr??vo editace data jin??ch u??ivatel??</b> - u??ivatel (Pepa) m????e po??adat administr??tora o p??id??n?? konkr??tn??ho  
-    u??ivatele (Franty) do senamu u??ivatel??, jejich?? z??znamy m?? pr??vo editovat (s pr??vem editovat z??znam je i spojeno pr??vo p??istupovat k historii 
-    tohoto z??znamu). P??id??n?? u??ivatel?? do tohoto seznamu z??le???? na administr??torovi a na vz??jemn?? domluv?? u??ivatel??.</li>
-    <li><b>pr??vo editovat v??e</b> - u??ivatel s t??mto pr??vem mu??e editovat jak??koliv z??znam n??lezu, autora a publikace bez ohledu na vlastn??ka tohoto z??znamu. 
-    D??le m?? pr??vo na pr??ci s hisotori?? jak??hokoliv n??lezu, ale st??le nem?? pr??vo na pr??ci s celkovou histori??.
-    <li><b>pr??vo administr??tora</b> - u??ivatel s pr??vem administr??tora m?? samoz??ejm?? ty nejvy?????? pr??va - m????e editovat n??lezy, metadata, publikace, autory, 
-    rostliny, u??ivatele. M?? pr??vo na <a href="./history.html#historyRecord">historii jednotliv??ch z??znam??</a>, ale i na <a href="./history.html#historyData">celkovou historii</a>.
-    </li>
-  </ul>   
-  
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Spr??va u??ivatel??</title>
+  </head>
+  <body>
+  <h1>Spr??va u??ivatel??</h1>
+<img src="picture/userEnter_cs.png">
+<br><br>
+
+Spr??vce u??ivatel?? umo????uje administr??torovi p??id??vat a editovat u??ivatele, nastavovat pr??va u??ivatel?? a tak?? ukon??ovat jejich p????stup do aplikace. 
+Spr??vce u??ivatel?? otev??ete z menu <b>Data/Spr??va u??ivatel??</b>.
+
+<h5>Dialog spr??vce u??ivatel??</h5>
+
+<img src="picture/userDialog_cs.png">
+<br><br>
+Dialog pro spr??vu u??ivatelsk??ch ????t?? je rozd??len do dvou ????st??:
+<ul>
+  <li><b>Seznam u??ivatel??</b> - zobrazen?? seznamu u??ivatel?? podle kriteri?? zadan??ch pro vyhled??v??n?? a set????zen?? 
+  <li><b>Vyhled??v??n??</b> - zad??n?? po??adavk?? pro vyhled??v??n?? a set????zen?? u??ivatel??
+</ul>
+
+<h2>Seznam u??ivatel??</h2>
+
+Po ??sp????n??m vyhled??v??n?? je v t??to ????sti zobrazen seznam vyhledan??ch u??ivatel??. Po??et u??ivatel?? zobrazen??ch v tabulce si m????ete sami nastavit p??eps??n??m 
+hodnoty pro <b><i>Zobrazit ????dk??</i></b> a potvrzen??m nov?? hodnoty kl??vesov??m tla????tkem ENTER. V tabulce se p??ep??n??te na dal???? nebo p??edchoz?? 
+seznam u??ivatel?? pomoc?? tla????tek <b><i>P??edchoz??</i></b> a <b><i>N??sleduj??c??</i></b>. Informace o aktu??ln?? zobrazen??m seznamu u??ivatel?? jsou uvedeny v ????sti 
+pod tabulkou. 
+<br>
+Pro pr??ci se z??znamem jsou zde k dispozici tla????tka:
+<ul>    
+   <li><i><b>P??idej u??ivatele </i></b> - <a href=#add>p??id??n?? u??ivatele</a></li>
+   <li><i><b>Edituj u??ivatele</i></b> - <a href=#edit>editace u??ivatele</a></li>
+   <li><i><b>Detail u??ivatele</i></b> - <a href=#detail>detailn?? data a pr??va u??ivatele</a></li>
+   <li><i><b>Zru?? u??ivatele</i></b> - <a href=#drop>zru??en?? p????stupu u??ivatele</a></li> 
+</ul>   
+  
+<h2>Vyhled??v??n??</h2>
+
+Spr??vce u??ivatel?? n??b??z?? administr??torovi mo??nost vyhled??vat podle ??ty?? parametr??: login, jm??no, email a adresa. V??sledek m????e b??t set????zen podle loginu,
+k??esn??ho jm??na, p????jmen?? a datumu vytvo??en?? u??ivatele a to sestupn??, nebo vzestupn??. Dal????m krit??riem pro vyhled??v??n?? je po??adavek zobrazen?? v??ech 
+u??ivatel??, nebo jen u??ivatel?? s platn??m p????stupem do aplikace (hodnota polo??ky <i>Datum zru??en?? u??ivatele</i> je u t??chto u??ivatel?? nevypln??na). 
+Pokud nejsou zad??ny, ??adn?? parametry a omezen?? budou vyhled??ni v??ichni u??ivatel??. 
+<br><br>
+<b>Pozor:</b>  p??i vyhled??v??n?? jsou rozli????v??na velk?? a mal?? p??smena (case insensitive).
+
+<a name="add"></a><h2>P??id??n?? u??ivatele</h2>
+  
+  <h5>Dialog pro p??id??n?? u??ivatele</h5>
+  
+  <img src="picture/userAdd_cs.png">
+  <br><br>
+  Dialog pro p??id??n?? nov??ho u??ivatele m????ete otev????t ze Spr??vce U??ivatel??. V zobrazen??m okn?? jsou k vypln??n?? n??sleduj??c?? polo??ky:
+  <ul>
+    <li><b>Login</b> - login u??ivatele, kter?? bude pou????vat k p??ihla??ov??n?? do aplikace. Tato polo??ka je povinn?? a bez jej??ho vypln??n?? v??m aplikace nedovol??
+    ??ivatele p??idat. Login musi b??t v r??mci datab??ze jednozna??n?? a nen?? po ulo??en?? u??ivatele editovateln??.</li>
+    <li><b>Heslo</b> - p??ihla??ovac?? heslo u??ivatele. Tato polo??ka je povinn??.</li>
+    <li><b>Jm??no</b> - k??esn?? jm??no u??ivatele. Tato polo??ka je povinn??.</li>
+    <li><b>P????jmen??</b> - p????jmen?? u??ivatele. Tato polo??ka je povinn??.</li>
+    <li><b>Email</b> - email u??ivatele. Tato polo??ka je povinn??.</li>
+    <li><b>Adresa</b> - adresa u??ivatele.</li>    
+    <li><b>Pozn??mka</b> - pozn??mka administr??tora o u??ivateli</li>    
+    <li><b>Administr??torsk?? pr??vo</b> - jeho ozna??en??m z??sk?? u??ivatel stejn?? pr??va jako administr??tor</li>
+    <li><b>Pr??vo editovat v??e</b> - jeho ozna??en??m z??sk?? u??ivatel pr??vo editovat v??echny n??lezy v datab??zy</li>
+    <li><b>Pr??vo p??id??vat z??znamy</b> - jeho ozna??en??m z??sk?? u??ivatel pr??vo pro p??id??v??n?? nov??ch n??lez??</li>
+    <li><b>Pravo editace n??lez?? u??ivatel??</b> - tato polo??ka obsahuje seznam u??ivatel??, jejich?? n??lezy bude moci dan?? u??ivatel editovat</li>    
+ </ul>
+ 
+<a name="edit"></a><h2>Editace u??ivatele</h2>
+<h5>Dialog pro editaci u??ivatele</h5>
+<img src="picture/userEdit_cs.png">
+<br><br>
+  Dialog pro editaci existuj??c??ho u??ivatele otev??ete ze Spr??vce u??ivatel??. Nezapome??te, ??e pro otev??en?? dialogu mus??te m??t ozna??en??ho u??ivatele.
+  Vzhled edit dialogu je t??m???? toto??n?? s add dialogem. Povinn?? polo??ky jsou: heslo, jm??no, p????jmen??, email.<br> 
+  Needitovatelen?? polo??ky jsou: 
+  <ul>
+    <li><b>Login</b></li>
+    <li><b>Datum vytvo??en??</b> - datum a ??as informuj??c?? o vytvo??en?? u??ivatele. Needitovateln?? polo??ka. </li>
+    <li><b>Datum zru??en??</b> - datum a ??as informuj??c?? o zru??en?? p????stupu u??ivatele do aplikace. Needitovateln?? polo??ka.</li>
+  </ul>
+
+<a name="detail"></a><h2>Detailn?? data a pr??va u??ivatele</h2>
+
+  Dialog zobrazuj??c?? detailn?? informaci o u??ivatelovi a jeho pr??vech otev??ete ze Spr??vce u??ivatel??. Pro otev??en?? tohoto dialogu je nutn?? 
+  ozna??it po??adovan??ho u??ivatele v seznamu u??ivatel??. Dialog je t??m???? toto??n?? s edit dialogem. V??echny polo??ky jsou needitovateln??, maj?? jen 
+  informa??n?? charakter.
+  
+<a name="drop"></a><h2>Zru??en?? p????stupu u??ivatele</h2>
+
+  Pro zru??en?? p????stupu u??ivatele do aplikace se pou??ije tla????tko <i><b>Zru?? u??ivatele</b></i> ve spr??vci u??ivatel??. P??ed stisknut??m tohoto tla????tka je nutn??
+  ozna??i po??adovan??ho u??ivatele v seznamu u??ivatel??. Po stisku tohoto tla????tka bude u??ivatel informov??n o operaci, kterou se chyst?? prov??st. Potvrzen??m
+  t??to operace bude u??ivatelovi nastaven aktualn?? ??as do polo??ky <i>Datum zru??en?? u??ivatele.</i>.   
+  <br><br>
+  <img src="picture/userDrop_cs.png">
+  <br><br>
+  Obnoven?? p????stupu pro zru??en??ho u??ivate znamen?? p??id??n?? nov??ho u??ivatele. V datab??zi tak z??st??v?? p??ehled o obdob??ch, kdy m??l kter?? u??ivatel 
+  p????stup do aplikace.  
+
+<a name="rights"></a><h2>Pr??va u??ivatele</h2>
+  
+  Administr??tor p??i p??id??v??n?? ??i editaci u??ivatele nastavuje pr??va pro pr??ci s n??lezov??mi daty.<br> 
+  
+  <h5>Nastaven?? pr??v</h5>
+  <img src="picture/userRight_cs.png">
+  <br><br>
+  U??ivatel m????e m??t n??sleduj??c?? pr??va:
+  <ul>
+    <li><b>pr??vo prohl????en?? dat</b> - toto pr??vo se nikde nenastavuje a u??ivatel je z??sk??v?? automaticky s vytvo??en??m p????stupu do aplikace</li>
+    <li><b>pr??vo p??id??vat data</b> - nastaven??m tohoto pr??va m?? u??ivatel mo??nost p????d??vat n??lezy, autory a publikace. Z??rove?? m?? automaticky pr??vo
+    editovat z??znamy, kter?? p??idal. D??le m?? pr??vo na zobrazen?? historie n??lezu, kter?? p??idal.</li>
+    <li><b>pr??vo editace data jin??ch u??ivatel??</b> - u??ivatel (Pepa) m????e po??adat administr??tora o p??id??n?? konkr??tn??ho  
+    u??ivatele (Franty) do senamu u??ivatel??, jejich?? z??znamy m?? pr??vo editovat (s pr??vem editovat z??znam je i spojeno pr??vo p??istupovat k historii 
+    tohoto z??znamu). P??id??n?? u??ivatel?? do tohoto seznamu z??le???? na administr??torovi a na vz??jemn?? domluv?? u??ivatel??.</li>
+    <li><b>pr??vo editovat v??e</b> - u??ivatel s t??mto pr??vem mu??e editovat jak??koliv z??znam n??lezu, autora a publikace bez ohledu na vlastn??ka tohoto z??znamu. 
+    D??le m?? pr??vo na pr??ci s hisotori?? jak??hokoliv n??lezu, ale st??le nem?? pr??vo na pr??ci s celkovou histori??.
+    <li><b>pr??vo administr??tora</b> - u??ivatel s pr??vem administr??tora m?? samoz??ejm?? ty nejvy?????? pr??va - m????e editovat n??lezy, metadata, publikace, autory, 
+    rostliny, u??ivatele. M?? pr??vo na <a href="./history.html#historyRecord">historii jednotliv??ch z??znam??</a>, ale i na <a href="./history.html#historyData">celkovou historii</a>.
+    </li>
+  </ul>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm	2006-09-03 22:56:44 UTC (rev 650)
@@ -28,7 +28,7 @@
     <mapID target="user.rights" url="html/user.html#rights"/>
     <mapID target="import" url="html/import.html"/>
     <mapID target="export" url="html/export.html"/>
-    <mapID target="id328078" url="html/cheat.html"/>
+    <mapID target="createdb" url="html/createdb.html"/>
     <mapID target="server" url="html/server.html"/>
     <mapID target="server.connection" url="html/server.html#connection"/>
     <mapID target="server.manager" url="html/server.html#manager"/>

Modified: trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml	2006-09-03 22:56:44 UTC (rev 650)
@@ -39,6 +39,7 @@
     </tocitem>
     <tocitem target="import" text="Import dat"/>
     <tocitem target="export" text="Export dat"/>
+    <tocitem target="createdb" text="Nov?? datab??ze"/>    
     <tocitem target="server" text="Server">
         <tocitem target="server.connection" text="Vytvo??eni a p??ipojen?? se k serveru"/>
         <tocitem target="server.manager" text="Spr??va serveru"/>        

Added: trunk/src/net/sf/plantlore/help/default/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/checklist.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/html/checklist.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Checklist</title>
+  </head>
+  <body>
+  <h1>Checklist</h1>
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/default/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/createdb.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/html/createdb.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Creating new database</title>
+  </head>
+  <body>
+  <h1>Creating new database</h1>
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/default/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/server.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/html/server.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
+    <title>Server</title>
+  </head>
+  <body>
+  <h1>Server</h1>
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/default/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/table_import.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/html/table_import.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Import</title>
+  </head>
+  <body>
+  <h1>Table import</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/jhelpmap.jhm
===================================================================
--- trunk/src/net/sf/plantlore/help/default/jhelpmap.jhm	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/jhelpmap.jhm	2006-09-03 22:56:44 UTC (rev 650)
@@ -14,7 +14,7 @@
     <mapID target="overview.addoccurrence.extended" url="html/addoccurrence.html#extended"/>
     <mapID target="overview.addoccurrence.checklist" url="html/addoccurrence.html#checklist"/>
     <mapID target="overview.search" url="html/search.html"/>
-    <mapID target="overview.history" url="html/occurr_history.html#historyRecord"/>
+    <mapID target="overview.history" url="html/history.html#historyRecord"/>
     <mapID target="author" url="html/author.html"/>
     <mapID target="author.add" url="html/author.html#add"/>
     <mapID target="publication" url="html/publication.html"/>
@@ -28,7 +28,7 @@
     <mapID target="user.rights" url="html/user.html#rights"/>
     <mapID target="import" url="html/import.html"/>
     <mapID target="export" url="html/export.html"/>
-    <mapID target="id328078" url="html/cheat.html"/>
+    <mapID target="createdb" url="html/createdb.html"/>
     <mapID target="server" url="html/server.html"/>
     <mapID target="server.connection" url="html/server.html#connection"/>
     <mapID target="server.manager" url="html/server.html#manager"/>

Modified: trunk/src/net/sf/plantlore/help/default/jhelptoc.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/default/jhelptoc.xml	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/default/jhelptoc.xml	2006-09-03 22:56:44 UTC (rev 650)
@@ -39,6 +39,7 @@
     </tocitem>
     <tocitem target="import" text="Import"/>
     <tocitem target="export" text="Export"/>
+    <tocitem target="createdb" text="New database"/>        
     <tocitem target="server" text="Server">
         <tocitem target="server.connection" text="Create server, Connect to server, Running server"/>
         <tocitem target="server.manager" text="Server manager"/>        

Added: trunk/src/net/sf/plantlore/help/en/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Checklist</title>
+  </head>
+  <body>
+  <h1>Checklist</h1>
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/en/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/createdb.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/html/createdb.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Creating new database</title>
+  </head>
+  <body>
+  <h1>Creating new database</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/import.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/html/import.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -1,109 +1,9 @@
 <html>
-
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>Import dat</title>
-
-	</head>
-
+<head>
+<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
+<title>Import</title>
+</head>
 <body>
-
-	<h1>Import dat</h1>
-
-	<p>
-	Chcete-li sv?? data, kter?? jste d????ve vyexportovali pomoc?? <a href="./export.html">Exportu</a>,
-	op??t nahr??t do datab??ze programu Plantlore, pot??ebujete pou????t Import.
-	Import dat tedy slou???? k znovu-na??ten?? n??lezov??ch dat ze souboru na disku do datab??ze programu.
-	</p>
-
-	<p>
-	Import lze prov??d??t po p??ihl????en?? k jak??koli datab??zi - tedy i k datab??zi vzd??len??.
-	Zde je ov??em nutn?? zv????it p??enosovou kapacitu linky, 
-	kterou pou????v??te pro p??ipojen??, 
-	nebo?? p??en????en?? mno??stv?? dat m????e b??t velk?? a doba nutn?? 
-	k naimportov??n?? n??lezov??ch dat by byla ne??nosn??.
-	</p>
-
-	<p>
-	Import z??znam?? je velmi snadn?? a podob?? se otev??en?? souboru.
-	Narozd??l od Exportu ov??em Import skr??v?? n??kter?? ??skal??, je?? budou pops??na podrobn??ji n????e.
-	</p>
-
-
-	<h2>Vlastn?? import dat</h2>
-
-	<p>
-	Import za????n?? v??b??rem souboru, v n??m?? jsou ulo??ena n??lezov?? data.
-	Detekce form??tu souboru je automatick??.
-	</p>
-
-	<p>
-	Po v??b??ru souboru je zobrazeno okno zobrazuj??c?? pr??b??h procesu importov??n?? dat. 
-	Podobn?? jako p??i Exportu zav??en?? okna nezru???? prob??haj??c?? Import, pouze skryje okno,
-	kter?? lze znovu zobrazit vybr??n??m polo??ky Import v hlavn??m menu aplikace.
-	</p>
-
-	<p>
-	Import lze p??eru??it stiskem tla????tka "Zru??it". V takov??m p????pad?? se nezru???? ji?? proveden?? zm??ny,
-	tzn. p??eru????te-li Import v polovin??, polovina z??znam?? v datab??zi ji?? z??stane.
-	</p>
-
-
-	<h2>Probl??my p??i importu dat</h2>
-
-	<p>
-	Import dat je delik??tn?? operace, p??i n???? doch??z?? k modifikaci datab??ze. Plantlore mus?? zajistit,
-	aby nebyla po??kozena integrita st??vaj??c??ch n??lezov??ch dat. 
-	V n??kter??ch p????padech s??m nedok????e rozhodnout,
-	jakou akci prov??st, proto m????e b??t nutn?? spolupr??ce u??ivatele.
-	</p>
-
-	<p>
-	<ul>
-		<li><b>??asov?? konflikt.</b>
-		Z??znam, kter?? se nach??z?? v souboru, se ji?? nach??z?? v datab??zi
-		a je nov??j????, ne?? z??znam v souboru. Plantlore nab??z?? dv?? mo??nosti: zachovat st??vaj??c??
-		soubor v datab??zi, nebo jej p??epsat. Problematick?? z??znam je zobrazen, aby u??ivatel mohl
-		l??pe rozhodnout, co d??lat.
-		</li>
-		<li><b>Konflikt sd??len??ch dat.</b>
-		P??i aktualizaci datab??ze mohou b??t n??kter?? ????sti z??znam?? sd??leny v??ce jin??mi z??znamy,
-		nap??. Publikace. P??i aktualizaci takov??to ????sti z??znamu by byla tato informace zm??n??na 
-		u v??em z??znam??m, kter?? ji sd??l??.
-		<br/>
-		Na p????kladu s Publikac??: z odborn?? publikace bylo vlo??eno do datab??ze 30 n??lezov??ch dat.
-		P??i importu (aktualizaci) by ov??em p??i??la informace, ??e u t??chto n??lezov??ch datech je
-		t??eba upravit publikaci - nap??. proto??e se jednalo o jin?? ??l??nek. U??ivatel pak mus?? 
-		rozhodnout, zda bude publikace zm??n??na u v??ech z??znam??, kter?? ji sd??l??, nebo pouze 
-		u vybran??ho.
-		<br/>
-		Plantlore tedy nab??z?? dv?? mo??nosti: zm??nit ????st z??znamu pouze u aktu??ln??ho n??lezu, 
-		nebo ji zm??nit v??em n??lezov??m dat??m, kter?? ji sd??l??. Pro lep???? p??ehled je inkriminovan??
-		????st z??znamu, kter?? je sd??lena, zobrazena u??ivateli.
-		</li>
-	</ul>
-	</p>
-
-
-	<h2>Pr??b??h Importu a omezen??</h2>
-
-	<p>
-	P??i Importu dat je d??le nutn?? zv????it, ??e n??kter?? n??lezov?? data nem??te pr??vo modifikovat -
-	typicky takov??, jejich?? nejste autorem. V??ce o pr??vech lze nal??zt v sekci  
-	<a href="./user.html">Pr??va u??ivatel??</a>.
-	<br/>
-	Z??znamy, kter?? nem??te pr??vo m??nit, jsou automaticky zavr??eny (zam??tnuty). 
-	Jsou-li n??kter?? z??znamy ne??pln?? (neobsahuj?? v??echny povinn?? polo??ky) nebo po??kozen??,
-	jsou automaticky zam??tnuty tak??. 
-	<br/>
-	Po??et zam??tnut??ch z??znam?? se zobrazuje spolu s informacemi o pr??b??hu procesu. 
-	Jin?? d??vody pro zam??tnut?? z??znamu nejsou
-	</p>
-
-	<p>
-	</p>
-
+<h1>Import</h1>
 </body>
-</html>
+</html>
\ No newline at end of file

Added: trunk/src/net/sf/plantlore/help/en/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
+    <title>Server</title>
+  </head>
+  <body>
+  <h1>Server</h1>
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/en/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-03 22:56:44 UTC (rev 650)
@@ -0,0 +1,11 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Import</title>
+  </head>
+  <body>
+  <h1>Table import</h1>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm
===================================================================
--- trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm	2006-09-03 22:56:44 UTC (rev 650)
@@ -14,7 +14,7 @@
     <mapID target="overview.addoccurrence.extended" url="html/addoccurrence.html#extended"/>
     <mapID target="overview.addoccurrence.checklist" url="html/addoccurrence.html#checklist"/>
     <mapID target="overview.search" url="html/search.html"/>
-    <mapID target="overview.history" url="html/occurr_history.html#historyRecord"/>
+    <mapID target="overview.history" url="html/history.html#historyRecord"/>
     <mapID target="author" url="html/author.html"/>
     <mapID target="author.add" url="html/author.html#add"/>
     <mapID target="publication" url="html/publication.html"/>
@@ -28,7 +28,7 @@
     <mapID target="user.rights" url="html/user.html#rights"/>
     <mapID target="import" url="html/import.html"/>
     <mapID target="export" url="html/export.html"/>
-    <mapID target="id328078" url="html/cheat.html"/>
+    <mapID target="createdb" url="html/createdb.html"/>
     <mapID target="server" url="html/server.html"/>
     <mapID target="server.connection" url="html/server.html#connection"/>
     <mapID target="server.manager" url="html/server.html#manager"/>

Modified: trunk/src/net/sf/plantlore/help/en/jhelptoc.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/en/jhelptoc.xml	2006-09-03 22:17:09 UTC (rev 649)
+++ trunk/src/net/sf/plantlore/help/en/jhelptoc.xml	2006-09-03 22:56:44 UTC (rev 650)
@@ -39,6 +39,7 @@
     </tocitem>
     <tocitem target="import" text="Import"/>
     <tocitem target="export" text="Export"/>
+    <tocitem target="createdb" text="New database"/>    
     <tocitem target="server" text="Server">
         <tocitem target="server.connection" text="Create server, Connect to server, Running server"/>
         <tocitem target="server.manager" text="Server manager"/>        



From fraktalek at mail.berlios.de  Mon Sep  4 01:13:35 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 01:13:35 +0200
Subject: [Plantlore-dev] r651 - in trunk/src/net/sf/plantlore: client common
Message-ID: <200609032313.k83NDZT2029308@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 01:12:32 +0200 (Mon, 04 Sep 2006)
New Revision: 651

Added:
   trunk/src/net/sf/plantlore/common/PostTaskAction.java
   trunk/src/net/sf/plantlore/common/ProgressBarManager.java
Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/Plantlore.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/Task.java
Log:
New progress bar in overview's status bar.
Dispatcher modified accordingly.
Refresh action and DataUserAction in AppCoreCtrl now use the new non-freezing progress bar.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -9,6 +9,7 @@
 
 import java.awt.Component;
 import java.awt.Cursor;
+import java.awt.EventQueue;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
 import java.awt.event.ComponentEvent;
@@ -86,6 +87,7 @@
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.PlantloreHelp;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.ProgressBar;
 import net.sf.plantlore.common.Selection;
 import net.sf.plantlore.common.StandardAction;
@@ -885,11 +887,7 @@
 
 		public void actionPerformed(ActionEvent actionEvent) {
 			searchModel.clearAndNotify();
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                searchView.setVisible(true);
-                            }
-                        });
+                        searchView.setVisible(true);
 		}//actionPerformed
 	}//SearchAction
 
@@ -916,11 +914,7 @@
                             DefaultExceptionHandler.handle(view,ex);
                             return;
                         }
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                habitatTreeView.setVisible(true);
-                            }
-                        });
+                        habitatTreeView.setVisible(true);
 		}//actionPerformed
 	}// HabitatTreeAction
 
@@ -986,12 +980,8 @@
                             DefaultExceptionHandler.handle(view,ex);
                             return;
                         }
-                        SwingUtilities.invokeLater( new Runnable() {
-                            public void run() {
-                                addView.loadComponentData();
-                                addView.setVisible(true);   
-                            }
-                        });//invokeLater
+                        addView.loadComponentData();
+                        addView.setVisible(true);   
                     }//if ADD
                 }//if
             }//update
@@ -1180,11 +1170,7 @@
 			AuthorManagerCtrl authCtrl = new AuthorManagerCtrl(authModel,
 					authView);
 			authModel.addObserver(managerBridge);
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                authView.setVisible(true);
-                            }
-                        });
+                        authView.setVisible(true);
 		}
 
 	}
@@ -1205,11 +1191,7 @@
 			publicationManagerCtrl = new PublicationManagerCtrl(
 					publicationManagerModel, publicationManagerView);
 			publicationManagerModel.addObserver(managerBridge);
-                        SwingUtilities.invokeLater(new Runnable() {
-                            public void run() {
-                                publicationManagerView.setVisible(true);
-                            }
-                        });
+                        publicationManagerView.setVisible(true);
 		}
 	}
 
@@ -1228,20 +1210,25 @@
 				userManagerCtrl = new UserManagerCtrl(userManagerModel,userManagerView);
 			}
 			Task task = userManagerModel.searchUser(true);
-			new DefaultProgressBar(task, view, true) {
+                        task.setPostTaskAction(new PostTaskAction() {
+                            public void afterStopped(Object value) {
+                                if (! userManagerModel.isFinishedTask()) return;
+                                userManagerModel.setInfoFinishedTask(false);
+                                userManagerCtrl.reloadData(1, UserManager.DEFAULT_DISPLAY_ROWS);
+                                userManagerView.setVisible(true);	
+                            }                            
+                        });
+                        Dispatcher.getDispatcher().dispatch(task, view, false);
+/**			new DefaultProgressBar(task, view, true) {
 				@Override
 	 	    	public void afterStopping() {
 					if (! userManagerModel.isFinishedTask()) return;
 					userManagerModel.setInfoFinishedTask(false);
 					userManagerCtrl.reloadData(1, UserManager.DEFAULT_DISPLAY_ROWS);
-                                        SwingUtilities.invokeLater(new Runnable() {
-                                            public void run() {
-                                                userManagerView.setVisible(true);	
-                                            }
-                                        });
+                                        userManagerView.setVisible(true);	
 	 	    	}
 			};			
-			task.start();					
+			task.start();					 */
 		}
 	}
         
@@ -1334,11 +1321,7 @@
 					if (! metadataManagerModel.isFinishedTask()) return;
 					metadataManagerModel.setInfoFinishedTask(false);
 					metadataManagerCtrl.reloadData(1, MetadataManager.DEFAULT_DISPLAY_ROWS);
-                                        SwingUtilities.invokeLater(new Runnable() {
-                                            public void run() {
-                                                metadataManagerView.setVisible(true);
-                                            }
-                                        });
+                                        metadataManagerView.setVisible(true);
 	 	    	}
 			};			
 			task.start();						
@@ -1424,11 +1407,7 @@
 					if (resultNumber != model.getResultsCount())
 						model.selectAndShow(resultNumber);
 					detailModel.load(model.getSelectedResultNumber());
-                                        SwingUtilities.invokeLater( new Runnable() {
-                                            public void run() {
-                                                detailView.setVisible(true);
-                                            }
-                                        });
+                                        detailView.setVisible(true);
 				} catch (RemoteException ex) {
                                     DefaultExceptionHandler.handle(view,ex);
                                     return;
@@ -1476,11 +1455,7 @@
 					// we need to
 					// correct that
 					detailModel.load(model.getSelectedResultNumber());
-                                        SwingUtilities.invokeLater( new Runnable() {
-                                            public void run() {
-                                                detailView.setVisible(true);
-                                            }
-                                        });
+                                        detailView.setVisible(true);
 				} catch (RemoteException ex) {
                                     DefaultExceptionHandler.handle(view,ex);
                                     return;
@@ -1564,11 +1539,7 @@
 			 * etc.)
 			 */
 
-                        SwingUtilities.invokeLater( new Runnable() {
-                            public void run() {
-                                setDatabaseDependentCommandsEnabled(false);
-                            }
-                        });
+                        setDatabaseDependentCommandsEnabled(false);
 		}
 
 	}
@@ -1747,13 +1718,13 @@
 			Task task = new Task() {
 				public Object task() throws DBLayerException, RemoteException {
                                     //refreshAction.setEnabled(false);
+                                    setStatusMessage("Loading overview data...");
 					searchModel.clear();
 					searchModel.constructQuery();
 					fireStopped(null);
-					return null;
-				}                                
+					return "Ahoj, uz koncim";
+				}
 			};
-
 			return task;
 		} else {
 			searchModel.clear();
@@ -1764,6 +1735,7 @@
 
         /** Handles the refresh action invoked from overview. */
 	class RefreshAction extends AbstractAction {
+            String prom = "Promenna z refresh action.";
             Task task = refreshOverview(true);
             
 		public RefreshAction() {

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-03 23:12:32 UTC (rev 651)
@@ -254,11 +254,11 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
-          <Component id="jPanel4" alignment="0" max="32767" attributes="0"/>
           <Component id="mainToolBar" alignment="0" pref="679" max="32767" attributes="0"/>
           <Component id="overviewPanel" alignment="1" max="32767" attributes="0"/>
+          <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
           <Component id="pageToolBar" alignment="0" pref="679" max="32767" attributes="0"/>
+          <Component id="jPanel4" alignment="0" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
@@ -267,12 +267,12 @@
               <Component id="mainToolBar" min="-2" max="-2" attributes="0"/>
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Component id="overviewPanel" max="32767" attributes="0"/>
-              <EmptySpace min="-2" max="-2" attributes="0"/>
+              <EmptySpace min="-2" pref="14" max="-2" attributes="0"/>
               <Component id="jPanel4" min="-2" max="-2" attributes="0"/>
-              <EmptySpace min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
               <Component id="pageToolBar" min="-2" pref="34" max="-2" attributes="0"/>
-              <EmptySpace min="-2" max="-2" attributes="0"/>
-              <Component id="jPanel1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="jPanel1" min="-2" pref="23" max="-2" attributes="0"/>
           </Group>
       </Group>
     </DimensionLayout>
@@ -378,13 +378,18 @@
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="0" attributes="0">
                   <Component id="statusLabel" min="-2" max="-2" attributes="0"/>
-                  <EmptySpace pref="582" max="32767" attributes="0"/>
+                  <EmptySpace pref="268" max="32767" attributes="0"/>
+                  <Component id="progressBar" min="-2" pref="314" max="-2" attributes="0"/>
               </Group>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="statusLabel" min="-2" max="-2" attributes="0"/>
+              <Group type="102" attributes="0">
+                  <Component id="statusLabel" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+              <Component id="progressBar" alignment="0" pref="19" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>
@@ -396,6 +401,16 @@
             </Property>
           </Properties>
         </Component>
+        <Component class="javax.swing.JProgressBar" name="progressBar">
+          <Properties>
+            <Property name="foreground" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="33" green="ff" red="33" type="rgb"/>
+            </Property>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
       </SubComponents>
     </Container>
     <Container class="javax.swing.JToolBar" name="pageToolBar">
@@ -522,7 +537,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="1" pref="100" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="85" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -55,6 +55,8 @@
         setLocationRelativeTo(null);
         model.addObserver(this); 
         model.addObserver(sbm);
+        progressBar.setVisible(false);
+        progressBar.setBorderPainted(false);
     }
     
     /** This method is called from within the constructor to
@@ -74,6 +76,7 @@
         habitatTreeButton = new javax.swing.JButton();
         jPanel1 = new javax.swing.JPanel();
         statusLabel = new javax.swing.JLabel();
+        progressBar = new javax.swing.JProgressBar();
         pageToolBar = new javax.swing.JToolBar();
         selectAll = new javax.swing.JButton();
         selectNone = new javax.swing.JButton();
@@ -155,17 +158,23 @@
         jPanel1.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
         statusLabel.setText(L10n.getString("Overview.StatusReady"));
 
+        progressBar.setForeground(new java.awt.Color(51, 255, 51));
+
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
         jPanel1.setLayout(jPanel1Layout);
         jPanel1Layout.setHorizontalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
                 .add(statusLabel)
-                .addContainerGap(582, Short.MAX_VALUE))
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 268, Short.MAX_VALUE)
+                .add(progressBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 314, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(statusLabel)
+            .add(jPanel1Layout.createSequentialGroup()
+                .add(statusLabel)
+                .addContainerGap())
+            .add(progressBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 19, Short.MAX_VALUE)
         );
 
         pageToolBar.setFloatable(false);
@@ -244,7 +253,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 100, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 85, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");
@@ -392,11 +401,11 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-            .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
             .add(mainToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 679, Short.MAX_VALUE)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewPanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
             .add(pageToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 679, Short.MAX_VALUE)
+            .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -404,12 +413,12 @@
                 .add(mainToolBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(overviewPanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(14, 14, 14)
                 .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(pageToolBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 34, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         pack();
     }// </editor-fold>//GEN-END:initComponents
@@ -770,6 +779,7 @@
     private javax.swing.JLabel pageStatusLabel;
     private javax.swing.JToolBar pageToolBar;
     private javax.swing.JButton prevPage;
+    protected javax.swing.JProgressBar progressBar;
     private javax.swing.JLabel recordsCount;
     private javax.swing.JLabel recordsCountLabel;
     protected javax.swing.JFormattedTextField recordsPerPage;

Modified: trunk/src/net/sf/plantlore/client/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -22,6 +22,7 @@
 import net.sf.plantlore.client.AppCore;
 import net.sf.plantlore.client.AppCoreCtrl;
 import net.sf.plantlore.client.AppCoreView;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.GlobalExceptionHandler;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.debug.ConnectionMonitor;
@@ -149,6 +150,7 @@
             model = new AppCore(mainConfig);
             view = new AppCoreView(model);
             ctrl = new AppCoreCtrl(model, view);
+            Dispatcher.initialize(view.progressBar);
             //view.init();
             view.setVisible(true);
             EventQueue.invokeLater( new SplashScreenCloser() );

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -13,6 +13,7 @@
 import java.util.Observer;
 import javax.swing.JDialog;
 import javax.swing.JFrame;
+import javax.swing.JProgressBar;
 import javax.swing.SwingUtilities;
 import org.apache.log4j.Logger;
 
@@ -26,6 +27,7 @@
     private DefaultProgressBarNew dpb;
     private Task task;
     private static Dispatcher dispatcher = new Dispatcher();
+    private static ProgressBarManager pbm;
     
     private Dispatcher() {
     }
@@ -38,7 +40,11 @@
         
         taskRunning = true;
         this.task = task;
-        dpb = new DefaultProgressBarNew(task, parent, true);
+        //dpb = new DefaultProgressBarNew(task, parent, true);
+
+        pbm.initialize();
+        pbm.setParent(parent);
+        pbm.setTask(task);
         
         task.start();
         
@@ -51,12 +57,26 @@
      */
     public synchronized void finished() {
         taskRunning = false;
-        task.deleteObservers();
+        pbm.removeTask();
+        pbm.setParent((JDialog)null);
+/*        do{
+        	try{ Thread.sleep(50); } catch(Exception e) {}
+        } while( dpb.isShowing() ); */
         logger.debug("Dispatcher: "+task+" finished, free to dispatch another.");
     }    
     
     public static Dispatcher getDispatcher() {
+        if (pbm == null) //FIXME: think of a better kind of exception
+            throw new IllegalArgumentException("You have to call Dispatcher.initialize() first!");
+        
         return dispatcher;
     }
+    
+    public static void initialize(JProgressBar pb) {
+        if (pb == null) {
+            throw new IllegalArgumentException("Dispatcher can't be initialized with null progress bar!");
+        }
+        pbm = new ProgressBarManager(pb);
+    }
 }
 

Added: trunk/src/net/sf/plantlore/common/PostTaskAction.java
===================================================================
--- trunk/src/net/sf/plantlore/common/PostTaskAction.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/common/PostTaskAction.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -0,0 +1,18 @@
+/*
+ * PostTaskAction.java
+ *
+ * Created on 3. z??? 2006, 23:59
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.common;
+
+/**
+ *
+ * @author fraktalek
+ */
+public interface PostTaskAction {    
+    public void afterStopped(Object value);
+}

Added: trunk/src/net/sf/plantlore/common/ProgressBarManager.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -0,0 +1,201 @@
+/*
+ * ProgressBarApp.java
+ *
+ * Created on 3. z??? 2006, 22:24
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.common;
+
+import java.awt.Cursor;
+import java.awt.Window;
+import java.util.Observable;
+import java.util.Observer;
+import javax.swing.JDialog;
+import javax.swing.JFrame;
+import javax.swing.JProgressBar;
+import javax.swing.SwingUtilities;
+import net.sf.plantlore.l10n.L10n;
+import org.apache.log4j.Logger;
+
+/**
+ *
+ * @author fraktalek
+ */
+public class ProgressBarManager implements Observer {
+    private Logger logger = Logger.getLogger(ProgressBarManager.class.getPackage().getName());
+    private boolean ended = false;
+    private JProgressBar progressBar;
+    private Window parent;
+    private Task task;
+    
+    /** Creates a new instance of ProgressBarApp */
+    public ProgressBarManager(JProgressBar progressBar) {
+        this.progressBar = progressBar;
+        progressBar.setString("");
+        progressBar.setStringPainted(true);
+    }
+
+    public void setParent(JDialog parent) {
+        this.parent = parent;       
+    }
+
+    public void setParent(JFrame parent) {
+        this.parent = parent;       
+    }
+
+    public synchronized void initialize() {
+        progressBar.setString("");
+        ended = false;
+    }
+    
+    public synchronized void setTask(Task task) {
+        this.task = task;
+        task.addObserver(this);
+    }
+    
+    public synchronized void removeTask() {
+        task.deleteObserver(this);
+        task = null;
+    }
+    
+    /** Makes the ProgressBar visible, must be called from EDT.
+     *
+     */
+    private synchronized void start() {
+        if (ended)//we probably received message.STOPPING earlier than message.STARTING => do not begin again
+            return;
+
+        if (task.isDeterminate()) {
+            progressBar.setIndeterminate(false);
+            progressBar.setMinimum(0);
+            progressBar.setMaximum(task.getLength());
+        } else {
+            progressBar.setIndeterminate(true);
+        }
+        
+        if (parent != null)
+            parent.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+        
+        task.addObserver(this);    
+        
+        progressBar.setString("");
+        progressBar.setVisible(true);
+        logger.debug(""+this+" VISIBLE");
+    }
+    
+    /** Makes the ProgressBar invisible and disposes it.
+     * Must be called from EDT!
+     *
+     */
+    private synchronized void stop() {
+        ended = true;
+        progressBar.setVisible(false);
+        if (parent != null)
+            parent.setCursor(Cursor.getDefaultCursor());
+        logger.debug(""+this+" STOPPING " + task );
+        //!!! afterStopping();        
+        Dispatcher.getDispatcher().finished();
+    }
+    
+    /** Changes the ProgressBar's state.
+     * Must be called from EDT!
+     */
+    private synchronized void changePosition(int position) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;
+        
+        progressBar.setValue(position);
+    }
+    
+    /** Changes the ProgressBar's message.
+     * Must be called from EDT!
+     */
+    private synchronized void changeMessage(String message) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;
+        
+        if (message == null) //just to be sure
+            message = "";
+        
+        progressBar.setString(message);
+    }
+    
+    /** Changes representation of the task length.
+     * Must be called from EDT!
+     */
+    private synchronized void changeLength(int length) {
+        if (ended) // we have already received a message that the task ended, do nothing
+            return;        
+        
+        if (progressBar.isIndeterminate()) {
+            progressBar.setIndeterminate(false);
+        }
+        progressBar.setMaximum(length);
+    }
+    
+    public void update(Observable o, Object arg) {
+        final ProgressBarManager pb = this;
+        if (arg instanceof Pair) {
+            Pair p = (Pair)arg;
+            Object first = p.getFirst();
+            if (first instanceof Task.Message) {
+                Task.Message msg = (Task.Message)first;
+                Object value = p.getSecond();
+                logger.debug(""+this+" received message: "+msg);
+                switch (msg) {
+                    case STARTING:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                start();
+                            }
+                        });
+                        break;
+                    case POSITION_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changePosition(task.getPosition());
+                            }
+                        });
+                        break;
+                    case MESSAGE_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changeMessage(task.getStatusMessage());
+                            }
+                        });
+                        break;
+                    case LENGTH_CHANGED:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                changeLength(task.getLength());
+                            }
+                        });
+                        break;
+                    case STOPPING:
+                        SwingUtilities.invokeLater(new Runnable() {
+                            public void run() {
+                                stop();
+                            }
+                        });
+                        break;
+                    case STOPPED:
+                        //!!! afterStopped(value);
+                        break;                    
+                }//switch
+            }//instanceof Message
+
+        }//instanceof Pair
+        
+        if (arg instanceof Exception) {
+            task.stop();
+            DefaultExceptionHandler.handle(parent, (Exception) arg, L10n.getString("Error.General"));
+        }        
+    }
+    
+    public String toString() {
+        return "ProgressBarManager ";
+    }
+}

Modified: trunk/src/net/sf/plantlore/common/Task.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Task.java	2006-09-03 22:56:44 UTC (rev 650)
+++ trunk/src/net/sf/plantlore/common/Task.java	2006-09-03 23:12:32 UTC (rev 651)
@@ -28,6 +28,7 @@
     private boolean canceled = false;
     private String statusMessage = "";
     private boolean determinate;
+    private PostTaskAction action;
     
     /** Creates new Task in determinate mode.
      */
@@ -43,6 +44,10 @@
         determinate = false;
     }
     
+    public void setPostTaskAction(PostTaskAction action) {
+        this.action = action;
+    }
+    
     /** Returns length of this task.
      *
      */
@@ -185,6 +190,9 @@
                     value = task();
                     setChanged();
                     notifyObservers(new Pair<Message,Object>(Message.STOPPING,null));
+                    if (action != null) {
+                        action.afterStopped(value);
+                    }
                 } catch (Exception ex) {
                     //FIXME:
                     ex.printStackTrace();
@@ -198,7 +206,9 @@
         worker.start();
     }
 
-    /** Continues processing of the task.
+    /** DON'T USE! NOT WELL TESTED!! + doesn't support afterStopping(), etc. 
+     * 
+     * Continues processing of the task.
      *
      * This method is supposed to be called after the task was interrupted by an exception.
      * Call to this method is almost the same as to start() but Observers are notified that
@@ -206,6 +216,7 @@
      * 
      *
      */
+    @Deprecated
     public void proceed() {
         worker = new SwingWorker() {
             public Object construct() {
@@ -253,7 +264,6 @@
         notifyObservers(new Pair<Message,Object>(Message.STOPPING,null));
     }
     
-    
     /**
      * Forcibly stops (cancels) the task.
      * <br/>
@@ -273,6 +283,7 @@
     public String toString() {
         return "Task("+this.hashCode()+")";
     }
+    
 }
 
 



From krater at mail.berlios.de  Mon Sep  4 01:48:03 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 01:48:03 +0200
Subject: [Plantlore-dev] r652 - in trunk/src/net/sf/plantlore:
	client/tableimport common l10n
Message-ID: <200609032348.k83Nm3Js005823@sheep.berlios.de>

Author: krater
Date: 2006-09-04 01:47:47 +0200 (Mon, 04 Sep 2006)
New Revision: 652

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
Log:
Minor improvements of TableImport. More stable now.

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-03 23:12:32 UTC (rev 651)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-03 23:47:47 UTC (rev 652)
@@ -117,7 +117,12 @@
 					""));
 			
 			
-			Record recordInDB = dbutils.findMatchInDB( data.record );
+			Record recordInDB = null;
+			try {
+				dbutils.findMatchInDB( data.record );
+			} catch(DBLayerException e) {
+				continue;
+			}
 			boolean isRecordInDB = recordInDB != null;
 			
 			// Take action.
@@ -148,11 +153,11 @@
 				}
 			} catch(ImportException ie) {
 				logger.error("The import of the record No. " + count + " was unsuccessful! " + ie.getMessage());
-				setStatusMessage( ie.getMessage() );
+				//setStatusMessage( ie.getMessage() );
 			} catch(DBLayerException de) {
 				logger.error("Delete/update/insert failed! " + de.getMessage());
-				setStatusMessage( L10n.getFormattedString("Import.UnableToProcess", count) + " " + 
-						((de.getMessage() == null) ? L10n.getString("Import.UnknownReason") : de.getMessage()) );
+				//setStatusMessage( L10n.getFormattedString("Import.UnableToProcess", count) + " " + 
+				//		((de.getMessage() == null) ? L10n.getString("Import.UnknownReason") : de.getMessage()) );
 			}
 		}
 		

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-03 23:12:32 UTC (rev 651)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-03 23:47:47 UTC (rev 652)
@@ -404,7 +404,7 @@
 			int results = db.executeQuery( query );
 			int rows = db.getNumRows( results );
 			if( rows > 1 ) {
-				logger.warn("There are " + rows + " completely identical records in the " + table.getSimpleName() + " table!");
+				logger.warn("There are " + rows + " completely identical records in the " + table.getSimpleName() + " table: " + record.toFullString());
 				throw new DBLayerException(L10n.getString("Error.AmbiguousRecord"));
 			}
 			

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 23:12:32 UTC (rev 651)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-03 23:47:47 UTC (rev 652)
@@ -1005,11 +1005,11 @@
 
 Import.Progress=dokon\u010Deno.
 
-Import.CompletelyCorruptedRecord=Z\u00E1znam \u010D. {0} je po\u0161kozen (nelze jej rozparsovat).
+Import.CompletelyCorruptedRecord=Z\u00E1znam {0} je nelze rozparsovat.
 
 Import.PartialyCorruptedRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) je po\u0161kozen.
 
-Import.IncompleteRecord=Z\u00E1znam \u010D. {0} je ne\u00FApln\u00FD - n\u011Bkter\u00E9 povinn\u00E9 \u00FAdaje sch\u00E1zej\u00ED.
+Import.IncompleteRecord=Z\u00E1znam {0} je ne\u00FApln\u00FD.
 
 Import.DuplicateRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) je v datab\u00E1zi n\u011Bkolikr\u00E1t\!\nNen\u00ED z\u0159ejm\u00E9, kter\u00FD z nich by se m\u011Bl aktualizovat\!
 



From ladaOb at seznam.cz  Mon Sep  4 02:14:35 2006
From: ladaOb at seznam.cz (=?iso-8859-2?Q?Lada_Oberreiterov=E1?=)
Date: Mon, 4 Sep 2006 02:14:35 +0200
Subject: [Plantlore-dev] Database - zruseni jednoho NN
Message-ID: <001f01c6cfb7$1b8c6b70$8a1aa20a@Jose>

Ahojte,

bylo nutne udelat malou zmenu v databazi a to v tabulce tPlants.
Byl zrusen pozadavek  NOT NULL u polocky  cScientificNameAuthor (ted muze byt null)

Aktualni databaze se opet objevi na Urtaxu, ale nemusite si ji stahovat. Staci vam udelat nasledujici jednoduchy postup v pgAdminovi...
  a.. v podstromku prislusne database poktacujte v rozvalovani vetvi a to: Schemas -> Public -> Tables -> tplants -> Columns
  b.. dvojklikem na sloupek cScientificNameAuthor otevrete properties, kde odznacite pozadavek na NOT NULL.
Lada
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060904/c6245cc6/attachment.html>

From fraktalek at mail.berlios.de  Mon Sep  4 02:44:28 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 02:44:28 +0200
Subject: [Plantlore-dev] r653 - in trunk/src/net/sf/plantlore: client
	client/createdb client/history client/metadata
	client/overview/tree client/publications common
Message-ID: <200609040044.k840iSrk017531@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 02:44:12 +0200 (Mon, 04 Sep 2006)
New Revision: 653

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
   trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
Log:
Modified most of the application to use the Dispatcher and PostTaskAction instead of (Default)ProgressBar and task.start().

Now you should never call task.start() yourself unless you are very sure about what you're doing!



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -745,8 +745,20 @@
                             setStatusMessage(L10n.getString("Overview.LoadingOccurrenceRecord"));
                             return editModel.loadRecord((Integer) row[row.length - 1]);
                         }
-                    };
-
+                    };                    
+                    t.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            SwingUtilities.invokeLater(new Runnable() {
+                                public void run() {
+                                    editView.loadComponentData();
+                                    editView.setVisible(true);    
+                                }
+                            });
+                        }                        
+                    });
+                    Dispatcher.getDispatcher().dispatch(t, view, false);
+                    
+                    /*
                     new DefaultProgressBar(t, view, true) {
                         public void afterStopping() {
                             SwingUtilities.invokeLater(new Runnable() {
@@ -757,7 +769,7 @@
                             });
                         }
                     };
-                    t.start();
+                    t.start(); */
 		}//actionPerformed()
 	}//EditAction
 
@@ -814,7 +826,16 @@
                                 logger.info("Deleting " + arg[0] + " records.");
                                 
                                 Task task = model.deleteSelected();
+                                task.setPostTaskAction(new PostTaskAction() {
+                                    public void afterStopped(Object value) {
+                                        refreshOverview(false); // false -> do not create task,
+                                        // refresh the overview directly
+                                        // in this thread
+                                    }                                    
+                                });
+                                Dispatcher.getDispatcher().dispatch(task, view, false);
                                 
+                                /*
                                 ProgressBar progressBar = new DefaultProgressBar(task, view, true) {                                    
                                     public void afterStopped(Object value) {
                                         refreshOverview(false); // false -> do not create task,
@@ -822,7 +843,7 @@
                                         // in this thread
                                     }
                                 };                                
-                                task.start();
+                                task.start(); */
                                 break;
                         }// switch
 		}//actionPerformed
@@ -1257,6 +1278,15 @@
 				historyModel.addObserver(managerBridge);
 			}
 			Task task = historyModel.initialize(model.getSelectedOccurrence());
+                        task.setPostTaskAction(new PostTaskAction() {
+                            public void afterStopped(Object value) {
+                                            if (! historyModel.isFinishedTask()) return;
+                                            historyModel.setInfoFinishedTask(false);
+                                                historyView.setVisible(true);		
+                            }                            
+                        });
+                        Dispatcher.getDispatcher().dispatch(task, view, false);
+                        /*
 			new DefaultProgressBar(task, view, true) {
 				@Override
 	 	    	public void afterStopping() {
@@ -1265,7 +1295,7 @@
                                             historyView.setVisible(true);		
 	 	    	}				
 			};			
-			task.start();							
+			task.start();	*/						
 		}
 	}
 
@@ -1285,6 +1315,15 @@
 				wholeHistoryModel.addObserver(managerBridge);
 			}
 			Task task = wholeHistoryModel.initializeWH();
+                        task.setPostTaskAction(new PostTaskAction() {
+                            public void afterStopped(Object value) {	
+                                            if (! wholeHistoryModel.isFinishedTask()) return;
+                                            wholeHistoryModel.setInfoFinishedTask(false);
+                                            wholeHistoryView.setVisible(true);
+                            }
+                        });
+                        Dispatcher.getDispatcher().dispatch(task, view, false);
+                        /*
 			new DefaultProgressBar(task, view, true) {
 				@Override
 	 	    	public void afterStopping() {	
@@ -1293,7 +1332,7 @@
                                         wholeHistoryView.setVisible(true);
 	 	    	}
 			};			
-			task.start();							
+			task.start();							 */
 		}
 	}
 	
@@ -1315,6 +1354,16 @@
 				metadataManagerModel.addObserver(managerBridge);								
 			}
 			Task task = metadataManagerModel.searchMetadata(true);
+                        task.setPostTaskAction(new PostTaskAction() {
+                            public void afterStopped(Object value) {	
+                                            if (! metadataManagerModel.isFinishedTask()) return;
+                                            metadataManagerModel.setInfoFinishedTask(false);
+                                            metadataManagerCtrl.reloadData(1, MetadataManager.DEFAULT_DISPLAY_ROWS);
+                                            metadataManagerView.setVisible(true);
+                            }
+                        });
+                        Dispatcher.getDispatcher().dispatch(task, view, false);
+                        /*
 			new DefaultProgressBar(task, view, true) {
 				@Override
 	 	    	public void afterStopping() {	
@@ -1325,6 +1374,7 @@
 	 	    	}
 			};			
 			task.start();						
+                         **/
 		}
 	}
 

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -4,6 +4,7 @@
 
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
 
@@ -30,8 +31,10 @@
 				String user = view.user.getText();
 
 				Task creation = model.createCreationTask(user, new String(view.password.getPassword()));
+                                Dispatcher.getDispatcher().dispatch(creation, view, false);
+                                /*
 				new DefaultProgressBar(creation, view, true);
-				creation.start();
+				creation.start(); */
 				
 				view.password.setText("");
 			}

Modified: trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -10,6 +10,8 @@
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 
@@ -222,7 +224,23 @@
             	   //Button OK was press
             	   logger.debug("Button OK was press.");
             	   Task task = model.commitUpdate(model.getResultRows(), true);  
-            	   
+            	   task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                                try {
+                                   if (! model.isFinishedTask()) return;
+                                   model.setInfoFinishedTask(false);	
+                                   model.searchEditHistory(model.getData());
+                                   reloadData(1,model.getDisplayRows());			   	            	          
+                                   view.setCountResutl(model.getResultRows());
+                                }catch (Exception ex) {                                   
+                                   ex.printStackTrace();
+                                   DefaultExceptionHandler.handle(view, ex);                                   
+                                   return;
+                                } 
+                        }                       
+                   });
+                   Dispatcher.getDispatcher().dispatch(task, view, false);
+                   /*
             	   new DefaultProgressBar(task, view, true) {                       
                         @Override
                         public void afterStopping() {
@@ -239,7 +257,7 @@
                                 } 
                         } 		   					
                   };		   					                   	                   
-	          task.start();     	                   
+	          task.start();     	    */               
                } else {            	  
             	   logger.debug("Button Cancle was press."); 
                }  

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -18,6 +18,8 @@
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 
@@ -234,7 +236,24 @@
 	                   //Button OK was press
 	                   logger.debug("Button OK was press.");    
 	                   Task task = model.commitUpdate(toResult, false);
-	                   
+	                   task.setPostTaskAction(new PostTaskAction() {
+                                    public void afterStopped(Object value) {
+                                        logger.debug("Load Data");	   
+                                        try {
+                                           if (! model.isFinishedTask()) return;
+                                           model.setInfoFinishedTask(false);	
+                                           model.searchWholeHistoryData();
+                                           reloadData(1,model.getDisplayRows());
+                                           view.setCountResult(model.getResultRows());
+                                        } catch (Exception ex) {                                                                   
+                                           ex.printStackTrace();
+                                           DefaultExceptionHandler.handle(view, ex);                                                                   
+                                           return;
+                                        } 
+                                    }                               
+                           });
+                           Dispatcher.getDispatcher().dispatch(task, view, false);
+                           /*
 	                   new DefaultProgressBar(task, view, true) {		   										
                                 @Override
                                     public void afterStopping() {
@@ -252,7 +271,7 @@
                                         } 
                                     }
                             };		   					                   	                  
-	                    task.start();
+	                    task.start(); */
 	                   
 	               } else {	                       	                     
 	                       logger.debug("Button Cancle was press.");
@@ -327,7 +346,21 @@
            logger.debug("Button OK was press.");  
            // delete records whit contition cdelete > 0
            Task task = model.clearDatabase();
-
+           task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {
+                //load data
+                try {
+                        model.searchWholeHistoryData();
+                        reloadData(1,model.getDisplayRows());
+                        view.totalResultValueLabel.setText("0");
+                        } catch (Exception ex) {                                                                                    
+                            ex.printStackTrace();
+                            DefaultExceptionHandler.handle(view, ex);                                                                                  		   	               
+                        }
+                }               
+           });
+           Dispatcher.getDispatcher().dispatch(task, view, false);
+           /*
            new DefaultProgressBar(task, view, true) {
                 @Override
                 public void afterStopping() {
@@ -342,7 +375,7 @@
                         }
                 }
            };		   					                   	                   
-           task.start();	                                                         
+           task.start();	      */                                                   
            }
        }
     }

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -23,6 +23,8 @@
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 
@@ -247,7 +249,23 @@
            model.setUsedClose(true);        	
            //save new record Metadata into database
            Task task = model.addMetedataRecord();
+           task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {
+                   if (! model.isFinishedTask()) return;
+                   model.setInfoFinishedTask(false);
+                   //load metadata
+    	           model.searchMetadata(false);
+    	           if (model.isError()) {
+    	        	   DefaultExceptionHandler.handle(view, model.getException());
+                           model.setError(null);
+    	        	   return;
+    	           }    	           
+    	           reloadData(1, model.getDisplayRows());    	                   
+               } 		   		               
+           });
+           Dispatcher.getDispatcher().dispatch(task, view, false);
            
+           /*
            new DefaultProgressBar(task, view, true) {		   							 
                 @Override
                 public void afterStopping() {
@@ -263,7 +281,7 @@
     	           reloadData(1, model.getDisplayRows());    	                   
                } 		   		
    		};   		               	                   
-        task.start();                                       
+        task.start();                                       */
        }
     }
     
@@ -302,8 +320,18 @@
                if (model.usedClose()) return;
                //Update metadata               
                Task task = model.editMetadataRecord();
+               task.setPostTaskAction(new PostTaskAction() {
+                    public void afterStopped(Object value) {
+                         if (! model.isFinishedTask()) return;
+                         model.setInfoFinishedTask(false);
+                       //load metadata          				
+                        if (model.isError()) return;
+                        view.tableMetadataList.setModel(new MetadataManagerTableModel(model));                         
+                     } 		   					                   
+               });
+               Dispatcher.getDispatcher().dispatch(task, view, false);
                
-               new DefaultProgressBar(task, view, true) {
+    /*           new DefaultProgressBar(task, view, true) {
             	   @Override
                 public void afterStopping() {
                      if (! model.isFinishedTask()) return;
@@ -313,7 +341,7 @@
                     view.tableMetadataList.setModel(new MetadataManagerTableModel(model));                         
                      } 		   					
           		};          		                 	                   
-                task.start();                                       
+                task.start();                                       */
               }
        }
     }
@@ -389,8 +417,24 @@
                 	   logger.debug("Button OK was press.");
 		               //delete selected record
 		               Task task = model.deleteMetadataRecord();
-		               
-		             new DefaultProgressBar(task, view, true) {		   								  		   				
+		               task.setPostTaskAction(new PostTaskAction() {
+                                     public void afterStopped(Object value) {
+                                            if (! model.isFinishedTask()) return;
+                                            model.setInfoFinishedTask(false);
+                                            // load metadata
+                                           model.searchMetadata(false);  
+                                           if (model.isError()) {
+                                               DefaultExceptionHandler.handle(view, model.getException());
+                                                model.setError(null);
+                                                model.setException(null);
+                                               return;
+                                           }
+                                           reloadData(1, model.getDisplayRows());		   	              		   	               
+        		                }//afterStopped 		   					                                   
+                               });
+                               Dispatcher.getDispatcher().dispatch(task, view, false);
+                               
+		             /*new DefaultProgressBar(task, view, true) {		   								  		   				
                                     @Override						
                                      public void afterStopping() {
                                         if (! model.isFinishedTask()) return;
@@ -406,7 +450,7 @@
 		   	               reloadData(1, model.getDisplayRows());		   	              		   	               
 		                } 		   					
 		   			};		   			                   	                   
-		            task.start();                                                                  
+		            task.start(); */                                                                 
 		          }else {
 		        	  logger.debug("Button Cancle was press.");
 		          }
@@ -439,7 +483,22 @@
            }          
            //Load metadata with specific conditions
            Task task = model.searchMetadata(true);   
-           
+           task.setPostTaskAction(new PostTaskAction() {
+        	   public void afterStopped(Object value) {
+                       if (! model.isFinishedTask()) return;
+                       model.setInfoFinishedTask(false);
+                       if (model.getDisplayRows() <= 0) {
+                       model.setDisplayRows(MetadataManager.DEFAULT_DISPLAY_ROWS);
+                       }
+                       //No record in result - show message to user
+                       if (model.getResultRows() < 1) {
+                           view.showInfoMessage(MetadataManager.INFORMATION_RESULT_TITLE,MetadataManager.INFORMATION_RESULT);
+                       }
+                       reloadData(1, model.getDisplayRows());		           		           
+               } 		   					               
+           });
+           Dispatcher.getDispatcher().dispatch(task, view, false);
+           /*
            new DefaultProgressBar(task, view, true) {		   								  			
 			   @Override 
         	   public void afterStopping() {
@@ -455,7 +514,7 @@
                        reloadData(1, model.getDisplayRows());		           		           
                } 		   					
 			};			                  	                   
-            task.start();                                                                  
+            task.start();    */                                                              
        }
     }
     

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -25,6 +25,8 @@
 import net.sf.plantlore.client.resources.Resource;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
@@ -79,10 +81,18 @@
                 Task task = new Task() {
                     @Override
                     public Object task() throws DBLayerException, RemoteException {
+                        setStatusMessage(L10n.getString("Overview.Tree.LoadingHabitats"));
                         model.addHabitats(node,nodeInfo.getId());
                         return null;
                     }
                 };
+                task.setPostTaskAction(new PostTaskAction() {
+                    public void afterStopped(Object value) {
+                        model.getTreeModel().nodeStructureChanged(node);                        
+                    }                    
+                });
+                Dispatcher.getDispatcher().dispatch(task, view, false);
+                /*
                 DefaultProgressBar dpb = new DefaultProgressBar(task,view,true) {
                     @Override
                     public void afterStopping() {
@@ -90,7 +100,7 @@
                     }
                 };
                 
-                task.start();
+                task.start(); */
         }
     }
 

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -10,6 +10,8 @@
 import java.rmi.RemoteException;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
@@ -73,7 +75,28 @@
             if (view.checkCompulsory()) {
                 if (model.getEditPublication() == null) {                    
                     // Save new publication
-                    Task task = model.savePublication();                
+                    Task task = model.savePublication();     
+                    task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            model.searchPublication(false);
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
+                            model.reloadCache();
+                        }                        
+                    });
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
+                    /*
                     DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                         @Override
                         public void afterStopped(Object value) {
@@ -93,13 +116,33 @@
                             }
                             model.reloadCache();
                         }
-                    };
-                    dpb.setTitle(L10n.getString("Publications.ProgressBar.Save"));
-                    task.start();
+                    };*/
+                    //dpb.setTitle(L10n.getString("Publications.ProgressBar.Save"));
+                    //task.start();
                 } else {                    
                     // Edit existing publication
                     Task task = model.editPublication();
-                    DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
+                    task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            model.searchPublication(false);
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
+                            model.reloadCache();                            
+                        }                        
+                    });
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
+/*                    DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                         @Override
                         public void afterStopped(Object value) {
                             model.searchPublication(false);
@@ -120,7 +163,7 @@
                         }
                     };
                     dpb.setTitle(L10n.getString("Publications.ProgressBar.Save"));
-                    task.start();                    
+                    task.start();                    */
                 }
                 // Close the add dialog when save finished
                 view.close();

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -60,6 +60,26 @@
         view.sortDirectionAddFocusListener(new SortDirectionRadioFocusListener());
         // Display all publication when Publication manager is opened using the Task
         Task task = model.searchPublication(true);
+        task.setPostTaskAction(new PostTaskAction() {
+            public void afterStopped(Object value) {
+                model.setCurrentFirstRow(1);
+                try {
+                    model.processResults(1, model.getDisplayRows());
+                } catch (RemoteException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                } catch (DBLayerException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                }
+            }            
+        });
+        Dispatcher.getDispatcher().dispatch(task, view, false);
+        /*
         DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
             // After Task is finished, display the results
             @Override
@@ -81,7 +101,7 @@
             }
         };
         dpb.setTitle(L10n.getString("Publications.ProgressBar.Search"));
-        task.start();
+        task.start(); */
     }
     
     
@@ -231,6 +251,27 @@
             model.setPublicationIndex(index);
             // Delete is executed in a separate thread using Task
             Task task = model.deletePublication();
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {                    
+                    model.searchPublication(false);
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }
+                    model.reloadCache();
+                }                
+            });
+            Dispatcher.getDispatcher().dispatch(task, view, false);
+            /*
             DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                 // Refresh the list of publications after a delete
                 @Override
@@ -253,7 +294,7 @@
                 }
             };
             dpb.setTitle(L10n.getString("Publications.ProgressBar.Delete"));
-            task.start();
+            task.start(); */
         }
     }    
 
@@ -264,7 +305,25 @@
         public void actionPerformed(ActionEvent e) {
             // Run DB search. The operation is executed in a separate thread
             Task task = model.searchPublication(true);
-
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }                        
+                }                
+            });
+            Dispatcher.getDispatcher().dispatch(task, view, false);
+            /*
             DefaultProgressBar dpb = new DefaultProgressBar(task, view, true) {
                 // Display the results of a search
                 @Override
@@ -285,7 +344,7 @@
                 }
             };
             dpb.setTitle(L10n.getString("Publications.ProgressBar.Search"));
-            task.start();
+            task.start(); */
         }
     }        
     

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-03 23:47:47 UTC (rev 652)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-04 00:44:12 UTC (rev 653)
@@ -34,7 +34,7 @@
  
     public synchronized boolean dispatch(Task task, JFrame parent, boolean stoppable) {
         if (taskRunning) {
-            System.out.println("Dispatcher: task already RUNNING, RETURNING.");
+            logger.debug("Dispatcher: task already RUNNING, RETURNING.");
             return false;
         }
         
@@ -51,6 +51,25 @@
         return true;
     }
 
+    public synchronized boolean dispatch(Task task, JDialog parent, boolean stoppable) {
+        if (taskRunning) {
+            logger.debug("Dispatcher: task already RUNNING, RETURNING.");
+            return false;
+        }
+        
+        taskRunning = true;
+        this.task = task;
+        //dpb = new DefaultProgressBarNew(task, parent, true);
+
+        pbm.initialize();
+        pbm.setParent(parent);
+        pbm.setTask(task);
+        
+        task.start();
+        
+        return true;
+    }
+
     /** Tells the dispatcher that the progressbar and task finished.
      *
      * This tells the dispatcher that it is safe to dispatch another task.



From krater at mail.berlios.de  Mon Sep  4 03:03:52 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 03:03:52 +0200
Subject: [Plantlore-dev] r654 - in trunk/src/net/sf/plantlore: common server
	server/manager
Message-ID: <200609040103.k8413q6r021311@sheep.berlios.de>

Author: krater
Date: 2006-09-04 03:03:25 +0200 (Mon, 04 Sep 2006)
New Revision: 654

Modified:
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java
   trunk/src/net/sf/plantlore/server/Plantlore.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.form
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
Log:
Now, with another way to handle the tasks, the DefaultExceptionHandler can have the ReconnectAction disabled globally.

Server makes use of the new (non-freezing?) progress bar wherever applicable.

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -20,7 +20,26 @@
  */
 public class DefaultExceptionHandler {
 	
+	private static boolean isReconnectDisabled = false;
+	
+	
 	private DefaultExceptionHandler() {}
+	
+	/**
+	 * Do not offer reconnect at all.
+	 *
+	 */
+	public static void disableReconnect() {
+		isReconnectDisabled = true;
+	}
+	
+	/**
+	 * Offer the reconnect procedure only where applicable.
+	 *
+	 */
+	public static void enableReconnect() {
+		isReconnectDisabled = false;
+	}
 
 
 	/**
@@ -151,7 +170,7 @@
 		}
 		
 		// Announce the error and offer the reconnection.
-		if( isReconnectReasonable && ! doNotOfferReconnect )
+		if( !isReconnectDisabled && isReconnectReasonable && ! doNotOfferReconnect )
 			DefaultReconnectDialog.show(parent, problemDescription);
 		// Just announce the problem.
 		else

Modified: trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/common/DefaultReconnectDialog.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -72,7 +72,9 @@
 	 * @param problemDescription	The string that will be displayed to the User.
 	 */
 	public static void show(Component parent, String problemDescription) {
-		defaultReconnectAction.setParent(parent);
+		if(defaultReconnectAction != null)
+			defaultReconnectAction.setParent(parent);
+		
 		int choice = JOptionPane.showOptionDialog(
 				parent, 
 				problemDescription, 

Modified: trunk/src/net/sf/plantlore/server/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -12,6 +12,7 @@
 
 import com.jgoodies.looks.plastic.PlasticXPLookAndFeel;
 
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.exception.PlantloreException;
 import net.sf.plantlore.l10n.L10n;
@@ -53,6 +54,9 @@
         } catch (PlantloreException e) {
             // TODO: Display error message
         }
+        
+        // Disable reconnect
+        DefaultExceptionHandler.disableReconnect();
 
 
         java.awt.EventQueue.invokeLater(new Runnable(){

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -2,7 +2,7 @@
 
 import java.awt.event.ActionEvent;
 
-import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.server.DatabaseSettings;
@@ -22,6 +22,8 @@
 	private ServerMngView mngView;
 	
 	public ServerCreateCtrl(final ServerMng model, final ServerCreateView view) {
+            
+		Dispatcher.initialize( view.progress );
 		
 		mngView = new ServerMngView(model);
 		new ServerMngCtrl(model, mngView);
@@ -76,8 +78,7 @@
 					
 					// Create and run a new server.
 					Task createServer = model.createNewServerTask( serverPassword );
-					new DefaultProgressBar(createServer, view, true, true);
-					createServer.start();
+					Dispatcher.getDispatcher().dispatch(createServer, view, true);
 					break;
 				
 					
@@ -93,8 +94,7 @@
 					
 					Task connectToServer = model.createConnectToRunningServerTask(
 							view.remoteHost.getText(), port, password );
-					new DefaultProgressBar(connectToServer, view, true, true);
-					connectToServer.start();
+					Dispatcher.getDispatcher().dispatch(connectToServer, view, true);
 					
 					break;
 				}

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-04 01:03:25 UTC (rev 654)
@@ -73,15 +73,33 @@
       <Layout>
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
-              <EmptySpace min="0" pref="408" max="32767" attributes="0"/>
+              <Group type="102" alignment="1" attributes="0">
+                  <EmptySpace pref="165" max="32767" attributes="0"/>
+                  <Component id="progress" min="-2" pref="233" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <EmptySpace min="0" pref="100" max="32767" attributes="0"/>
+              <Group type="102" alignment="1" attributes="0">
+                  <EmptySpace pref="71" max="32767" attributes="0"/>
+                  <Component id="progress" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
           </Group>
         </DimensionLayout>
       </Layout>
+      <SubComponents>
+        <Component class="javax.swing.JProgressBar" name="progress">
+          <Properties>
+            <Property name="borderPainted" type="boolean" value="false"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
     </Container>
     <Component class="javax.swing.JButton" name="next">
       <Properties>

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -50,6 +50,9 @@
         
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
         
+        // Show the progress bar only when necessary.
+        progress.setVisible( false );
+        
         DocumentSizeFilter.patch(serverPassword, 20);
         DocumentSizeFilter.patch(serverPort, 5);
         DocumentSizeFilter.patch(databaseType, 30);
@@ -68,6 +71,7 @@
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
         plantloreLogo = new javax.swing.JPanel();
+        progress = new javax.swing.JProgressBar();
         next = new javax.swing.JButton();
         help = new javax.swing.JButton();
         choicePane = new javax.swing.JTabbedPane();
@@ -99,15 +103,23 @@
         setResizable(false);
         plantloreLogo.setBackground(new java.awt.Color(0, 0, 0));
         plantloreLogo.setPreferredSize(new java.awt.Dimension(300, 100));
+        progress.setBorderPainted(false);
+
         org.jdesktop.layout.GroupLayout plantloreLogoLayout = new org.jdesktop.layout.GroupLayout(plantloreLogo);
         plantloreLogo.setLayout(plantloreLogoLayout);
         plantloreLogoLayout.setHorizontalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 408, Short.MAX_VALUE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, plantloreLogoLayout.createSequentialGroup()
+                .addContainerGap(165, Short.MAX_VALUE)
+                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 233, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap())
         );
         plantloreLogoLayout.setVerticalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 100, Short.MAX_VALUE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, plantloreLogoLayout.createSequentialGroup()
+                .addContainerGap(71, Short.MAX_VALUE)
+                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap())
         );
 
         next.setText(L10n.getString("Server.Continue"));
@@ -350,6 +362,7 @@
     private javax.swing.JPanel jPanel5;
     protected javax.swing.JButton next;
     protected javax.swing.JPanel plantloreLogo;
+    protected javax.swing.JProgressBar progress;
     protected javax.swing.JTextField remoteHost;
     protected javax.swing.JPasswordField remoteServerPassword;
     protected javax.swing.JTextField remoteServerPort;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -2,7 +2,7 @@
 
 import java.awt.event.ActionEvent;
 
-import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.server.ConnectionInfo;
@@ -21,24 +21,21 @@
 		view.kick.setAction(new StandardAction("Server.KickUser") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createKickTask( (ConnectionInfo)view.users.getSelectedValue() );
-				new DefaultProgressBar(t, view, true, true);
-				t.start();			
+				Dispatcher.getDispatcher().dispatch(t, view, true);			
 			}
 		});
 		
 		view.terminate.setAction(new StandardAction("Server.Terminate") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createTerminateServerTask();
-				new DefaultProgressBar(t, view, true, true);
-				t.start();	
+				Dispatcher.getDispatcher().dispatch(t, view, true);
 			}
 		});
 		
 		view.refresh.setAction(new StandardAction("Server.Refresh") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createUpdateConnectedUsersTask();
-				new DefaultProgressBar(t, view, true, true);
-				t.start();
+				Dispatcher.getDispatcher().dispatch(t, view, true);
 			}
 		});
 		

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.form	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.form	2006-09-04 01:03:25 UTC (rev 654)
@@ -20,22 +20,21 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" attributes="0">
+          <Component id="jToolBar1" alignment="0" pref="364" max="32767" attributes="0"/>
+          <Group type="102" alignment="1" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jScrollPane1" alignment="0" pref="343" max="32767" attributes="0"/>
+              <Group type="103" groupAlignment="1" attributes="0">
+                  <Component id="jScrollPane1" alignment="0" pref="344" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="166" max="32767" attributes="0"/>
+                      <EmptySpace pref="167" max="32767" attributes="0"/>
                       <Component id="terminate" linkSize="1" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="hide" linkSize="1" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
                   </Group>
               </Group>
-              <EmptySpace max="-2" attributes="0"/>
+              <EmptySpace min="-2" pref="10" max="-2" attributes="0"/>
           </Group>
-          <Component id="jToolBar1" alignment="0" pref="363" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
@@ -125,6 +124,14 @@
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
         </Component>
+        <Component class="javax.swing.JProgressBar" name="progress">
+          <Properties>
+            <Property name="borderPainted" type="boolean" value="false"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
       </SubComponents>
     </Container>
     <Component class="javax.swing.JButton" name="terminate">

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-04 00:44:12 UTC (rev 653)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-04 01:03:25 UTC (rev 654)
@@ -9,6 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.ConnectionInfo;
@@ -36,6 +37,9 @@
         PlantloreHelp.addKeyHelp(PlantloreHelp.SERVER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.SERVER, this.help);
         
+        // Show the progress bar only when necessary.
+        progress.setVisible( false );
+        
         setLocationRelativeTo(null); // center of the screen
     }
     
@@ -53,6 +57,7 @@
         jToolBar1 = new javax.swing.JToolBar();
         refresh = new javax.swing.JButton();
         kick = new javax.swing.JButton();
+        progress = new javax.swing.JProgressBar();
         terminate = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
@@ -71,25 +76,27 @@
         kick.setText(L10n.getString("Server.KickUser"));
         jToolBar1.add(kick);
 
+        progress.setBorderPainted(false);
+        jToolBar1.add(progress);
+
         terminate.setText(L10n.getString("Server.Terminate"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
+            .add(jToolBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 364, Short.MAX_VALUE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 344, Short.MAX_VALUE)
+                    .add(layout.createSequentialGroup()
                         .add(help)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 166, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 167, Short.MAX_VALUE)
                         .add(terminate)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(hide)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
-                .addContainerGap())
-            .add(jToolBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE)
+                        .add(hide)))
+                .add(10, 10, 10))
         );
 
         layout.linkSize(new java.awt.Component[] {hide, terminate}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
@@ -118,6 +125,7 @@
     private javax.swing.JScrollPane jScrollPane1;
     private javax.swing.JToolBar jToolBar1;
     protected javax.swing.JButton kick;
+    protected javax.swing.JProgressBar progress;
     protected javax.swing.JButton refresh;
     protected javax.swing.JButton terminate;
     protected javax.swing.JList users;
@@ -136,12 +144,15 @@
 			else 
 				users.setListData(new String[] {""});
 		} 
-		else if( parameter == ServerMng.CONNECTED ) 
+		else if( parameter == ServerMng.CONNECTED ) {
 			java.awt.EventQueue.invokeLater(new Runnable() {
 				public void run() {
 					setVisible(true);
 				}
 			});
+			
+			Dispatcher.initialize( progress );
+		}
 	}
     
 }



From fraktalek at mail.berlios.de  Mon Sep  4 03:13:38 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 03:13:38 +0200
Subject: [Plantlore-dev] r655 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609040113.k841Dc4g022994@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 03:13:32 +0200 (Mon, 04 Sep 2006)
New Revision: 655

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
Log:
Add and edit now use Task for storing changes.
Fixed a bug when edit fell down when you deleted day and clicked on store.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-04 01:03:25 UTC (rev 654)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-04 01:13:32 UTC (rev 655)
@@ -23,6 +23,7 @@
 import net.sf.plantlore.common.DBLayerUtils;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.Habitat;
@@ -911,7 +912,7 @@
         //cIsoDateTimeBegin construction
         Calendar c = Calendar.getInstance();
         c.set(Calendar.YEAR, year);
-        if (month != null) { //user entered month
+        if (month != null && day != null) { //user entered month
             c.set(Calendar.MONTH, month);
             c.set(Calendar.DAY_OF_MONTH,day);
         } else { //user didn't enter month, however we still have to compose cIsoDateTimeBegin column
@@ -1002,226 +1003,234 @@
      *
      * @param updateAllPlants says whether to create a new habitat if the user made a change to a habitat that is used also by other occurrences.
      */
-    public void storeRecord(boolean updateAllPlants) throws DBLayerException, RemoteException {
-        boolean newOccurrenceInserted = false;
-        DBLayerUtils dlu = new DBLayerUtils(database);
+    public Task storeRecord(final boolean updateAllPlants) {
+        return new Task() {
+            public Object task() throws RemoteException, DBLayerException {
+                
+                boolean newOccurrenceInserted = false;
+                DBLayerUtils dlu = new DBLayerUtils(database);
 
-        logger.info("Storing occurrence record...");
-        try {     
-                if (editMode) {
-                    boolean originalTaxonSurvived = originalTaxonSurvived();
-                    
-                    boolean ok = database.beginTransaction();
-                    if (!ok) {
-                        logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
-                        throw new DBLayerException("Can't create transaction. Another already running.");
-                    }
-                                            
-                    prepareOccurrenceUpdate(updateAllPlants);
-                    if (originalTaxonSurvived) {
-                        // update original occurrence
-                        logger.info("Updating original occurrence");
-                        database.executeUpdateInTransaction(o);
-                        logger.debug("Original occurrence id="+o.getId()+" updated.");
-                    } else {
-                        // delete original occurrence and bound author occurrences
-                        logger.info("Deleting original occurrence and associated author occurrences");
-                        o.setDeleted(1);
-                        database.executeUpdateInTransaction(o);
-                        dlu.deleteHabitatInTransaction(o.getHabitat());
-                        logger.debug("Occurrence id "+o.getId()+" "+o.getPlant().getTaxon()+" deleted.");
-                        Set<Map.Entry<Integer,AuthorOccurrence>> aoSet = authorOccurrences.entrySet();
-                        Iterator it = aoSet.iterator();
-                        while (it.hasNext()) {
-                            Map.Entry<Integer, AuthorOccurrence> entry = (Entry<Integer, AuthorOccurrence>) it.next();
-                            AuthorOccurrence tmp = entry.getValue();
-                            tmp.setDeleted(2);
-                            database.executeUpdateInTransactionHistory(tmp);
-                            logger.debug("AuthorOccurrence id "+tmp.getId()+" "+tmp.getAuthor().getWholeName()+" deleted.");
-                        }
-                        //clear the authorOccurrences so that we don't try to delete them once again further in this method
-                        authorOccurrences.clear();
-                        originalAuthors.clear();//user
-                    }//original taxon didn't survive
-                    
-                    /* original taxon survived but an author was removed
-                     *
-                     */
-                    
-                    
-                    //If the user removed some of the original authors then delete the corresponding authorOccurrences
-                    Iterator it = originalAuthors.iterator();
-                    while (it.hasNext()) {
-                        boolean originalSurvived = false;
-                        Pair<Integer,String> auth = (Pair<Integer,String>)it.next();
-                        AuthorOccurrence aoTmp = null;
-                        for (int i = 0; i < authorList.size(); i++) {
-                            Pair<Pair<String,Integer>,String> p = (Pair<Pair<String,Integer>,String>) authorList.get(i);
-                            Pair<String,Integer> pp = p.getFirst();
-                            if (p.getFirst().getSecond().equals(auth.getFirst()) && p.getSecond().equals(auth.getSecond())) {
-                                originalSurvived = true;
-                                break;
+                logger.info("Storing occurrence record...");
+                try {     
+                        if (editMode) {
+                            boolean originalTaxonSurvived = originalTaxonSurvived();
+
+                            boolean ok = database.beginTransaction();
+                            if (!ok) {
+                                logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
+                                throw new DBLayerException("Can't create transaction. Another already running.");
                             }
-                        }
-                        if (!originalSurvived) {
-                            aoTmp = authorOccurrences.get(auth.getFirst());
-                            aoTmp.setDeleted(1);
-                            database.executeUpdateInTransaction(aoTmp);
-                            logger.debug("AuthorOccurrence id="+aoTmp.getId()+" "+aoTmp.getAuthor().getWholeName()+" deleted.");
-                        }
-                    }
-                                        
-                    //Update original authors roles 
-                    for (int j = 0; j < authorList.size(); j++) {
-                        Pair<Pair<String,Integer>,String> pTmp = authorList.get(j);
-                        String role = pTmp.getSecond();
-                        if (role == null)
-                            role = "";
-                        if (originalAuthors.contains(
-                                new Pair<Integer,String>(pTmp.getFirst().getSecond(),role) )
-                            ) {
-                            logger.info("Updating authorOccurrence properties for "+pTmp.getFirst().getFirst());
-                            AuthorOccurrence aoTmp = authorOccurrences.get(pTmp.getFirst().getSecond());
-                            aoTmp.setRole(pTmp.getSecond());
-                            aoTmp.setNote(resultRevision.get(j));
-                            database.executeUpdateInTransaction(aoTmp);
-                            logger.debug("AuthorOccurrence id="+aoTmp.getId()+" "+pTmp.getFirst().getFirst()+" updated");
-                        } 
-                    }
-                    
-                    /*At this point we've deleted all that we should have deleted
-                     *
-                     *So we can start inserting
-                     */
-                    
-                    //K++ A?
-                    //create a new Occurrence for each new flower and also create new AuthorOccurrences
-                    for (int j = 0; j < taxonList.size(); j++) {
-                        if (taxonOriginal.equals(taxonList.get(j)))
-                            continue; //skip the original taxon, it's been already taken care of 
-                        logger.info("Creating a new occurrence for "+taxonList.get(j));
-                        Occurrence occTmp = cloneOccurrence();
-                        occTmp.setPlant((Plant) dlu.getObjectFor(lookupPlant(taxonList.get(j)),Plant.class));
-                        int occId = database.executeInsertInTransaction(occTmp);
-                        occTmp.setId(occId);
-                        logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occTmp.getId());
-                        Integer id = lookupPlant(taxonList.get(j));
-                        if (!id.equals(-1)) {
-                            Plant plTmp = (Plant) dlu.getObjectFor(id, Plant.class);
-                            occTmp.setPlant(plTmp);
-                        }
-                        
-                        for (int k = 0; k < authorList.size(); k++) {
-                            Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
-                            logger.info("Creating a new authorOccurrence for "+taxonList.get(j)+" and "+pTmp.getFirst().getFirst());
-                            AuthorOccurrence aoTmp = new AuthorOccurrence();
-                            aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
-                            aoTmp.setRole(pTmp.getSecond());
-                            aoTmp.setNote(resultRevision.get(k));
-                            aoTmp.setOccurrence(occTmp);
-                            aoTmp.setDeleted(0);
-                            database.executeInsertInTransaction(aoTmp);
-                            logger.debug("AuthorOccurrence for "+pTmp.getFirst().getFirst()+" inserted. Id="+aoTmp.getId());
-                            newOccurrenceInserted = true;
-                        }
-                    }
-                    
-                    
-                    //A++ K-orig
-                    //for the original taxon update the original taxon (that has already been done) and the author occurrence ( not needed)
-                    //and for new authors create a new author occurrence 
-                    if (originalTaxonSurvived)
-                        for (int k = 0; k < authorList.size(); k++) {
-                            Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
-                            String role = pTmp.getSecond();
-                            if (role == null)
-                                role = "";
-                            if (!originalAuthors.contains(
-                                    new Pair<Integer,String>(pTmp.getFirst().getSecond(),role) )
-                                ) {
-                                AuthorOccurrence aoTmp = new AuthorOccurrence();
-                                logger.info("Creating authorOccurrence for "+o.getPlant().getTaxon()+" and "+pTmp.getFirst().getFirst());
-                                aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
-                                aoTmp.setRole(pTmp.getSecond());
-                                aoTmp.setNote(resultRevision.get(k));
-                                aoTmp.setOccurrence(o);
-                                aoTmp.setDeleted(0);
-                                database.executeInsertInTransaction(aoTmp);    
-                                logger.debug("AuthorOccurrence for "+pTmp.getFirst().getFirst()+" inserted. Id="+aoTmp.getId());                            
+
+                            prepareOccurrenceUpdate(updateAllPlants);
+                            if (originalTaxonSurvived) {
+                                // update original occurrence
+                                logger.info("Updating original occurrence");
+                                database.executeUpdateInTransaction(o);
+                                logger.debug("Original occurrence id="+o.getId()+" updated.");
+                            } else {
+                                // delete original occurrence and bound author occurrences
+                                logger.info("Deleting original occurrence and associated author occurrences");
+                                o.setDeleted(1);
+                                database.executeUpdateInTransaction(o);
+                                dlu.deleteHabitatInTransaction(o.getHabitat());
+                                logger.debug("Occurrence id "+o.getId()+" "+o.getPlant().getTaxon()+" deleted.");
+                                Set<Map.Entry<Integer,AuthorOccurrence>> aoSet = authorOccurrences.entrySet();
+                                Iterator it = aoSet.iterator();
+                                while (it.hasNext()) {
+                                    Map.Entry<Integer, AuthorOccurrence> entry = (Entry<Integer, AuthorOccurrence>) it.next();
+                                    AuthorOccurrence tmp = entry.getValue();
+                                    tmp.setDeleted(2);
+                                    database.executeUpdateInTransactionHistory(tmp);
+                                    logger.debug("AuthorOccurrence id "+tmp.getId()+" "+tmp.getAuthor().getWholeName()+" deleted.");
+                                }
+                                //clear the authorOccurrences so that we don't try to delete them once again further in this method
+                                authorOccurrences.clear();
+                                originalAuthors.clear();//user
+                            }//original taxon didn't survive
+
+                            /* original taxon survived but an author was removed
+                             *
+                             */
+
+
+                            //If the user removed some of the original authors then delete the corresponding authorOccurrences
+                            Iterator it = originalAuthors.iterator();
+                            while (it.hasNext()) {
+                                boolean originalSurvived = false;
+                                Pair<Integer,String> auth = (Pair<Integer,String>)it.next();
+                                AuthorOccurrence aoTmp = null;
+                                for (int i = 0; i < authorList.size(); i++) {
+                                    Pair<Pair<String,Integer>,String> p = (Pair<Pair<String,Integer>,String>) authorList.get(i);
+                                    Pair<String,Integer> pp = p.getFirst();
+                                    if (p.getFirst().getSecond().equals(auth.getFirst()) && p.getSecond().equals(auth.getSecond())) {
+                                        originalSurvived = true;
+                                        break;
+                                    }
+                                }
+                                if (!originalSurvived) {
+                                    aoTmp = authorOccurrences.get(auth.getFirst());
+                                    aoTmp.setDeleted(1);
+                                    database.executeUpdateInTransaction(aoTmp);
+                                    logger.debug("AuthorOccurrence id="+aoTmp.getId()+" "+aoTmp.getAuthor().getWholeName()+" deleted.");
+                                }
                             }
-                        }
-                    
-                    database.commitTransaction();
-                    occurrenceTableModel.reload();
-                    newOccurrenceInserted = false;
-                    
-                } else { //Add Mode
-                    NearestVillage v;
-                    Phytochorion p;
-                    Territory t;
-                    Habitat h = new Habitat();
-                    v = (NearestVillage)dlu.getObjectFor(village.getSecond(),NearestVillage.class);
-                    p = (Phytochorion)dlu.getObjectFor(phytCode.getSecond(),Phytochorion.class);
-                    t = (Territory)dlu.getObjectFor(territoryName.getSecond(),Territory.class);                    
-                    if (altitude != null) h.setAltitude(altitude);
-                    if (phytCountry != null) h.setCountry(phytCountry);
-                    if (habitatDescription != null) h.setDescription(habitatDescription);
-                    if (latitude != null) h.setLatitude(latitude);
-                    if (longitude != null) h.setLongitude(longitude);
-                    h.setNearestVillage(v);
-                    if (habitatNote != null)h.setNote(habitatNote);
-                    h.setPhytochorion(p);
-                    if (quadrant != null) h.setQuadrant(quadrant);
-                    h.setTerritory(t);
-                    h.setDeleted(0);
-                    
-                    boolean ok = database.beginTransaction();
-                    if (!ok) {
-                        logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
-                        throw new DBLayerException(L10n.getString("Error.TransactionRaceConditions"),DBLayerException.ERROR_TRANSACTION);
-                    }
-                    
-                    logger.info("Creating a shared habitat");
-                    Record rec = dlu.findMatchInDB(h);
-                    if (rec == null) {
-                        logger.debug("THIS HABITAT is NOT in the database yet. Creating a new one.");
-                        int habId = database.executeInsertInTransaction(h);//insert the shared habitat
-                        h.setId(habId);
-                        logger.debug("Shared habitat created. Id="+h.getId());
-                    } else {
-                        logger.debug("THIS HABITAT ALREADY IS in the database! Using it.");
-                        h = (Habitat) rec;
-                    }
-                        
-                    for (int j = 0; j < taxonList.size(); j++) {
-                        logger.info("Creating an Occurrence using the shared habitat");
-                        Occurrence occ = prepareNewOccurrence(taxonList.get(j), h);//share the habitat
-                        int occId = database.executeInsertInTransaction(occ);
-                        occ.setId(occId);
-                        logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occ.getId());
-                        
-                        for (int k = 0; k < authorList.size(); k++) {
-                            Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
-                            logger.info("Creating an AuthorOccurrence for "+occ.getPlant().getTaxon()+" and "+pTmp.getFirst().getFirst());
-                            AuthorOccurrence aoTmp = new AuthorOccurrence();
-                            aoTmp.setRole(pTmp.getSecond());
-                            aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
-                            aoTmp.setNote(resultRevision.get(k));
-                            aoTmp.setOccurrence(occ);
-                            aoTmp.setDeleted(0);
-                            database.executeInsertInTransaction(aoTmp);                            
-                        }//for authorList
-                    }// for taxonList
-                    
-                    database.commitTransaction();
-                    occurrenceTableModel.load(h.getId());
-                }//add mode
-        } catch (DBLayerException ex) {
-            database.rollbackTransaction();
-            throw ex;
-        }        
-        
-        checkAndPropagateChanges();
+
+                            //Update original authors roles 
+                            for (int j = 0; j < authorList.size(); j++) {
+                                Pair<Pair<String,Integer>,String> pTmp = authorList.get(j);
+                                String role = pTmp.getSecond();
+                                if (role == null)
+                                    role = "";
+                                if (originalAuthors.contains(
+                                        new Pair<Integer,String>(pTmp.getFirst().getSecond(),role) )
+                                    ) {
+                                    logger.info("Updating authorOccurrence properties for "+pTmp.getFirst().getFirst());
+                                    AuthorOccurrence aoTmp = authorOccurrences.get(pTmp.getFirst().getSecond());
+                                    aoTmp.setRole(pTmp.getSecond());
+                                    aoTmp.setNote(resultRevision.get(j));
+                                    database.executeUpdateInTransaction(aoTmp);
+                                    logger.debug("AuthorOccurrence id="+aoTmp.getId()+" "+pTmp.getFirst().getFirst()+" updated");
+                                } 
+                            }
+
+                            /*At this point we've deleted all that we should have deleted
+                             *
+                             *So we can start inserting
+                             */
+
+                            //K++ A?
+                            //create a new Occurrence for each new flower and also create new AuthorOccurrences
+                            for (int j = 0; j < taxonList.size(); j++) {
+                                if (taxonOriginal.equals(taxonList.get(j)))
+                                    continue; //skip the original taxon, it's been already taken care of 
+                                logger.info("Creating a new occurrence for "+taxonList.get(j));
+                                Occurrence occTmp = cloneOccurrence();
+                                occTmp.setPlant((Plant) dlu.getObjectFor(lookupPlant(taxonList.get(j)),Plant.class));
+                                int occId = database.executeInsertInTransaction(occTmp);
+                                occTmp.setId(occId);
+                                logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occTmp.getId());
+                                Integer id = lookupPlant(taxonList.get(j));
+                                if (!id.equals(-1)) {
+                                    Plant plTmp = (Plant) dlu.getObjectFor(id, Plant.class);
+                                    occTmp.setPlant(plTmp);
+                                }
+
+                                for (int k = 0; k < authorList.size(); k++) {
+                                    Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
+                                    logger.info("Creating a new authorOccurrence for "+taxonList.get(j)+" and "+pTmp.getFirst().getFirst());
+                                    AuthorOccurrence aoTmp = new AuthorOccurrence();
+                                    aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
+                                    aoTmp.setRole(pTmp.getSecond());
+                                    aoTmp.setNote(resultRevision.get(k));
+                                    aoTmp.setOccurrence(occTmp);
+                                    aoTmp.setDeleted(0);
+                                    database.executeInsertInTransaction(aoTmp);
+                                    logger.debug("AuthorOccurrence for "+pTmp.getFirst().getFirst()+" inserted. Id="+aoTmp.getId());
+                                    newOccurrenceInserted = true;
+                                }
+                            }
+
+
+                            //A++ K-orig
+                            //for the original taxon update the original taxon (that has already been done) and the author occurrence ( not needed)
+                            //and for new authors create a new author occurrence 
+                            if (originalTaxonSurvived)
+                                for (int k = 0; k < authorList.size(); k++) {
+                                    Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
+                                    String role = pTmp.getSecond();
+                                    if (role == null)
+                                        role = "";
+                                    if (!originalAuthors.contains(
+                                            new Pair<Integer,String>(pTmp.getFirst().getSecond(),role) )
+                                        ) {
+                                        AuthorOccurrence aoTmp = new AuthorOccurrence();
+                                        logger.info("Creating authorOccurrence for "+o.getPlant().getTaxon()+" and "+pTmp.getFirst().getFirst());
+                                        aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
+                                        aoTmp.setRole(pTmp.getSecond());
+                                        aoTmp.setNote(resultRevision.get(k));
+                                        aoTmp.setOccurrence(o);
+                                        aoTmp.setDeleted(0);
+                                        database.executeInsertInTransaction(aoTmp);    
+                                        logger.debug("AuthorOccurrence for "+pTmp.getFirst().getFirst()+" inserted. Id="+aoTmp.getId());                            
+                                    }
+                                }
+
+                            database.commitTransaction();
+                            occurrenceTableModel.reload();
+                            newOccurrenceInserted = false;
+
+                        } else { //Add Mode
+                            NearestVillage v;
+                            Phytochorion p;
+                            Territory t;
+                            Habitat h = new Habitat();
+                            v = (NearestVillage)dlu.getObjectFor(village.getSecond(),NearestVillage.class);
+                            p = (Phytochorion)dlu.getObjectFor(phytCode.getSecond(),Phytochorion.class);
+                            t = (Territory)dlu.getObjectFor(territoryName.getSecond(),Territory.class);                    
+                            if (altitude != null) h.setAltitude(altitude);
+                            if (phytCountry != null) h.setCountry(phytCountry);
+                            if (habitatDescription != null) h.setDescription(habitatDescription);
+                            if (latitude != null) h.setLatitude(latitude);
+                            if (longitude != null) h.setLongitude(longitude);
+                            h.setNearestVillage(v);
+                            if (habitatNote != null)h.setNote(habitatNote);
+                            h.setPhytochorion(p);
+                            if (quadrant != null) h.setQuadrant(quadrant);
+                            h.setTerritory(t);
+                            h.setDeleted(0);
+
+                            boolean ok = database.beginTransaction();
+                            if (!ok) {
+                                logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
+                                throw new DBLayerException(L10n.getString("Error.TransactionRaceConditions"),DBLayerException.ERROR_TRANSACTION);
+                            }
+
+                            logger.info("Creating a shared habitat");
+                            Record rec = dlu.findMatchInDB(h);
+                            if (rec == null) {
+                                logger.debug("THIS HABITAT is NOT in the database yet. Creating a new one.");
+                                int habId = database.executeInsertInTransaction(h);//insert the shared habitat
+                                h.setId(habId);
+                                logger.debug("Shared habitat created. Id="+h.getId());
+                            } else {
+                                logger.debug("THIS HABITAT ALREADY IS in the database! Using it.");
+                                h = (Habitat) rec;
+                            }
+
+                            for (int j = 0; j < taxonList.size(); j++) {
+                                logger.info("Creating an Occurrence using the shared habitat");
+                                Occurrence occ = prepareNewOccurrence(taxonList.get(j), h);//share the habitat
+                                int occId = database.executeInsertInTransaction(occ);
+                                occ.setId(occId);
+                                logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occ.getId());
+
+                                for (int k = 0; k < authorList.size(); k++) {
+                                    Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
+                                    logger.info("Creating an AuthorOccurrence for "+occ.getPlant().getTaxon()+" and "+pTmp.getFirst().getFirst());
+                                    AuthorOccurrence aoTmp = new AuthorOccurrence();
+                                    aoTmp.setRole(pTmp.getSecond());
+                                    aoTmp.setAuthor((Author)dlu.getObjectFor(pTmp.getFirst().getSecond(),Author.class));
+                                    aoTmp.setNote(resultRevision.get(k));
+                                    aoTmp.setOccurrence(occ);
+                                    aoTmp.setDeleted(0);
+                                    database.executeInsertInTransaction(aoTmp);                            
+                                }//for authorList
+                            }// for taxonList
+
+                            database.commitTransaction();
+                            occurrenceTableModel.load(h.getId());
+                        }//add mode
+                } catch (DBLayerException ex) {
+                    database.rollbackTransaction();
+                    throw ex;
+                }        
+
+                checkAndPropagateChanges();
+                
+                return null;
+          }//task()
+        };//return new Task() {
+
     }//storeRecord()
 
     /** Checks whether the user created a new country or data source.

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-04 01:03:25 UTC (rev 654)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-04 01:13:32 UTC (rev 655)
@@ -32,12 +32,16 @@
 import javax.swing.JSpinner;
 import javax.swing.JTextArea;
 import javax.swing.JTextField;
+import javax.swing.SwingUtilities;
 import javax.swing.event.ChangeEvent;
 import javax.swing.event.ChangeListener;
 import javax.swing.event.DocumentEvent;
 import javax.swing.event.DocumentListener;
 import javax.swing.text.BadLocationException;
 import com.toedter.calendar.JCalendar;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
+import net.sf.plantlore.common.Task;
 import org.apache.log4j.Logger;
 
 import net.sf.plantlore.client.checklist.ChecklistCtrl;
@@ -621,25 +625,61 @@
                                 options,
                                 options[0]);
                         switch (choice) {
-                            case 0:
-                                model.storeRecord(true);
-                                view.setVisible(false);
+                            case 0:                                
+                                Task task = model.storeRecord(true);
+                                task.setPostTaskAction(new PostTaskAction() {
+                                    public void afterStopped(Object value) {
+                                        SwingUtilities.invokeLater(new Runnable() {
+                                            public void run() {
+                                                view.setVisible(false);
+                                            }
+                                        });
+                                    }
+                                });
+                                Dispatcher.getDispatcher().dispatch(task, view, false);
                                 break;
                             case 1:
-                                model.storeRecord(false);
-                                view.setVisible(false);
+                                task = model.storeRecord(false);
+                                task.setPostTaskAction(new PostTaskAction() {
+                                    public void afterStopped(Object value) {
+                                        SwingUtilities.invokeLater(new Runnable() {
+                                            public void run() {
+                                                view.setVisible(false);
+                                            }
+                                        });
+                                    }
+                                });
+                                Dispatcher.getDispatcher().dispatch(task, view, false);
                                 break;
                             case 2:
                             default:                        
                                 //we'll do nothing and leave the AddEdit dialog visible
                         }
                     } else {
-                            model.storeRecord(true);
-                            view.setVisible(false);                    
+                            Task task = model.storeRecord(true);
+                            task.setPostTaskAction(new PostTaskAction() {
+                                public void afterStopped(Object value) {
+                                    SwingUtilities.invokeLater(new Runnable() {
+                                        public void run() {
+                                            view.setVisible(false);
+                                        }
+                                    });
+                                }
+                            });
+                            Dispatcher.getDispatcher().dispatch(task, view, false);
                     }
                 } else {//inAddMode
-                    model.storeRecord(true);
-                    JOptionPane.showMessageDialog(view,L10n.getString("AddEdit.AddConfirmation"),L10n.getString("AddEdit.AddConfirmationTitle"),JOptionPane.INFORMATION_MESSAGE);
+                    Task task = model.storeRecord(true);
+                    task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            SwingUtilities.invokeLater(new Runnable() {
+                                public void run() {
+                                    JOptionPane.showMessageDialog(view,L10n.getString("AddEdit.AddConfirmation"),L10n.getString("AddEdit.AddConfirmationTitle"),JOptionPane.INFORMATION_MESSAGE);
+                                }
+                            });
+                        }
+                    });
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
                     //view.setVisible(false);
                 }
             } catch (RemoteException ex) {



From lada at mail.berlios.de  Mon Sep  4 03:19:48 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 4 Sep 2006 03:19:48 +0200
Subject: [Plantlore-dev] r656 - in trunk/src/net/sf/plantlore:
	client/export/builders common/record config/hibernate
Message-ID: <200609040119.k841Jmpi025371@sheep.berlios.de>

Author: lada
Date: 2006-09-04 03:19:44 +0200 (Mon, 04 Sep 2006)
New Revision: 656

Modified:
   trunk/src/net/sf/plantlore/client/export/builders/DarwinCoreBuilder.java
   trunk/src/net/sf/plantlore/common/record/Plant.java
   trunk/src/net/sf/plantlore/config/hibernate/Plants.hbm.xml
Log:
Database has been modified.
Columns tPlants.cScientificNameAuthor can be null now.

Modified: trunk/src/net/sf/plantlore/client/export/builders/DarwinCoreBuilder.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/builders/DarwinCoreBuilder.java	2006-09-04 01:13:32 UTC (rev 655)
+++ trunk/src/net/sf/plantlore/client/export/builders/DarwinCoreBuilder.java	2006-09-04 01:19:44 UTC (rev 656)
@@ -109,9 +109,9 @@
         recordElement.addElement("dateLastModified").setText(occurrence.getMetadata().getDateModified().toString());
         
         recordElement.addElement("genus").setText(occurrence.getPlant().getGenusNN());
-        recordElement.addElement("identifiedBy").setText(occurrence.getPlant().getScientificNameAuthor());
+        recordElement.addElement("identifiedBy").setText(occurrence.getPlant().getScientificNameAuthorNN());
         recordElement.addElement("scientificName").setText(occurrence.getPlant().getTaxon());
-        recordElement.addElement("specificNameAuthorYear").setText(occurrence.getPlant().getScientificNameAuthor());
+        recordElement.addElement("specificNameAuthorYear").setText(occurrence.getPlant().getScientificNameAuthorNN());
         
         recordElement.addElement("catalogNumber").setText(occurrence.getId().toString());
         recordElement.addElement("dayCollected").setText(occurrence.getDayCollectedNN().toString());

Modified: trunk/src/net/sf/plantlore/common/record/Plant.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Plant.java	2006-09-04 01:13:32 UTC (rev 655)
+++ trunk/src/net/sf/plantlore/common/record/Plant.java	2006-09-04 01:19:44 UTC (rev 656)
@@ -199,11 +199,21 @@
 
     /**
      *   Get scientific name of the author
+     *   @return scientific name of the author, returns "" instead of null
+     *   @see setScientificNameAuthor
+     */
+    public String getScientificNameAuthorNN() {
+        if (this.scientificNameAuthor == null)
+            return "";
+        return this.scientificNameAuthor;
+    }
+    
+     /**
+     *   Get scientific name of the author
      *   @return scientific name of the author
      *   @see setScientificNameAuthor
      */
-    public String getScientificNameAuthor() {
-        //obligatory
+    public String getScientificNameAuthor() {        
         return this.scientificNameAuthor;
     }
     

Modified: trunk/src/net/sf/plantlore/config/hibernate/Plants.hbm.xml
===================================================================
--- trunk/src/net/sf/plantlore/config/hibernate/Plants.hbm.xml	2006-09-04 01:13:32 UTC (rev 655)
+++ trunk/src/net/sf/plantlore/config/hibernate/Plants.hbm.xml	2006-09-04 01:19:44 UTC (rev 656)
@@ -32,7 +32,7 @@
       <property column="CSCIENTIFICNAMEAUTHOR"
                 length="150"
                 name="scientificNameAuthor"
-                not-null="true"
+                not-null="false"
                 type="java.lang.String"/>                
       <property column="CCZECHNAME"
                 length="30"



From fraktalek at mail.berlios.de  Mon Sep  4 03:56:26 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 03:56:26 +0200
Subject: [Plantlore-dev] r657 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609040156.k841uQGt001959@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 03:56:21 +0200 (Mon, 04 Sep 2006)
New Revision: 657

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
Log:
The same bugfix of date manipulation in AddEdit as in my previous commit. I just forgot about this case. 



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-04 01:19:44 UTC (rev 656)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-04 01:56:21 UTC (rev 657)
@@ -813,7 +813,7 @@
         //cIsoDateTimeBegin construction
         Calendar c = Calendar.getInstance();
         c.set(Calendar.YEAR, year);
-        if (month != null) { 
+        if (month != null && day != null) { 
             c.set(Calendar.MONTH, month);
             c.set(Calendar.DAY_OF_MONTH,day);
         } else {



From lada at mail.berlios.de  Mon Sep  4 04:15:42 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 4 Sep 2006 04:15:42 +0200
Subject: [Plantlore-dev] r658 - trunk/src/net/sf/plantlore/client/history
Message-ID: <200609040215.k842Fg9U006449@sheep.berlios.de>

Author: lada
Date: 2006-09-04 04:15:37 +0200 (Mon, 04 Sep 2006)
New Revision: 658

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
Log:
Fix bug in History. Undo of year, day, month and time of collected is working now.

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-04 01:56:21 UTC (rev 657)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-04 02:15:37 UTC (rev 658)
@@ -719,47 +719,42 @@
                //Set old value to attribute Year          		
                 occ.setYearCollected(Integer.parseInt(oldValue));
                 logger.debug("Set selected value for update of attribute Year.");
-                //Update attribute isoDateTimeBegin (Year + Mont + Day + Time)		                	                		
-                isoDateTime.setTime(occ.getTimeCollected());
-                isoDateTime.set(Integer.parseInt(oldValue),occ.getMonthCollected(),occ.getDayCollected());
-                occ.setIsoDateTimeBegin(isoDateTime.getTime());	                	              	            	
+                //Update attribute isoDateTimeBegin (Year + Mont + Day + Time)	
+                setIsoDateTimeBegin(occ,Integer.parseInt(oldValue),occ.getMonthCollected(),occ.getDayCollected(), occ.getTimeCollected());                
                 break;
         case 3: //Month 
                 // Set old value to attribute Month 
                 occ.setMonthCollected(Integer.parseInt(oldValue));
                 logger.debug("Set selected value for update of attribute Month.");
                 // Update attribute isoDateTimeBegin (Year + Mont + Day + Time)		                	
-                isoDateTime.setTime(occ.getTimeCollected());
-                isoDateTime.set(occ.getYearCollected(), Integer.parseInt(oldValue), occ.getDayCollected());
-                occ.setIsoDateTimeBegin(isoDateTime.getTime());              		
+                setIsoDateTimeBegin(occ,occ.getYearCollected(), Integer.parseInt(oldValue),occ.getDayCollected(), occ.getTimeCollected());                             		
             break;
         case 4: //Day	                	
                 // Set old value to attribute Day            		
                 occ.setDayCollected(Integer.parseInt(oldValue));
                 logger.debug("Set selected value for update of attribute Day.");
-                // Update attribute isoDateTimeBegin (Year + Mont + Day + Time)		                	
-                isoDateTime.setTime(occ.getTimeCollected());
-                isoDateTime.set(occ.getYearCollected(), occ.getMonthCollected(), Integer.parseInt(oldValue));
-                occ.setIsoDateTimeBegin(isoDateTime.getTime());
+                // Update attribute isoDateTimeBegin (Year + Mont + Day + Time)
+                setIsoDateTimeBegin(occ,occ.getYearCollected(), occ.getMonthCollected(), Integer.parseInt(oldValue), occ.getTimeCollected());                             		               
                 break;
         case 5: //Time 	                		                	
                 // Set old value to attribute Time   
-                Date time = new Date();
-                SimpleDateFormat df = new SimpleDateFormat( "HH:mm:ss.S" );
-                try {
-                        time = df.parse( oldValue );
-                } catch (ParseException e) {
-                        logger.error("Parse time failed. "+ e);
-                        setError(ERROR_PARSE_DATE);
-                        setException(e);
-                        return;
+                Date time = null;
+                if (oldValue != null) {                    
+                    time = new Date();
+                    SimpleDateFormat df = new SimpleDateFormat( "HH:mm:ss.S" );
+                    try {
+                            time = df.parse( oldValue );
+                    } catch (ParseException e) {
+                            logger.error("Parse time failed. "+ e);
+                            setError(ERROR_PARSE_DATE);
+                            setException(e);
+                            return;
+                    }
                 }
                 occ.setTimeCollected(time);
                 logger.debug("Set selected value for update of attribute Time.");
                 // Update attribute isoDateTimeBegin (Year + Mont + Day + Time)		                	
-                isoDateTime.setTime(time);
-                isoDateTime.set(occ.getYearCollected(), occ.getMonthCollected(), occ.getDayCollected());
-                occ.setIsoDateTimeBegin(isoDateTime.getTime());
+                setIsoDateTimeBegin(occ,occ.getYearCollected(), occ.getMonthCollected(),  occ.getDayCollected(), time);                             		                               
             break;
         case 6: //Source	                	
                 // Set old value to attribute Source 
@@ -827,6 +822,37 @@
             editObjectList.add(occ);
         }
     }
+    
+    /**
+     *  Set date and time of collected occurrence
+     *  @param occ occurrence
+     *  @param year year of collected
+     *  @param month month of collected
+     *  @param day day of collected
+     *  @param time time of collected
+     */
+    public void setIsoDateTimeBegin(Occurrence occ, Integer year, Integer month, Integer day, Date time) {
+         //cIsoDateTimeBegin construction
+        Calendar c = Calendar.getInstance();
+        c.set(Calendar.YEAR, year);
+        if (month != null && day != null) { 
+            c.set(Calendar.MONTH, month);
+            c.set(Calendar.DAY_OF_MONTH,day);
+        } else { 
+            c.set(Calendar.MONTH, 0);
+            c.set(Calendar.DAY_OF_MONTH,1);            
+        }
+        Calendar temp = Calendar.getInstance();
+        if (time != null) {
+            temp.setTime(time);
+            c.set(Calendar.HOUR_OF_DAY,temp.get(Calendar.HOUR_OF_DAY));
+            c.set(Calendar.MINUTE,temp.get(Calendar.MINUTE));
+        } else {
+            c.set(Calendar.HOUR_OF_DAY,0);
+            c.set(Calendar.MINUTE,1); 
+        }
+        occ.setIsoDateTimeBegin(c.getTime());
+    }
         
     /**
      * Rollback data editing concerned with specific habitat



From krater at mail.berlios.de  Mon Sep  4 11:15:31 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 11:15:31 +0200
Subject: [Plantlore-dev] r659 - in trunk/src/net/sf/plantlore: common
	common/record l10n
Message-ID: <200609040915.k849FVqM013575@sheep.berlios.de>

Author: krater
Date: 2006-09-04 11:15:30 +0200 (Mon, 04 Sep 2006)
New Revision: 659

Modified:
   trunk/src/net/sf/plantlore/common/ProgressBarManager.java
   trunk/src/net/sf/plantlore/common/record/UnitIdDatabase.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
Log:
Add some missing properties.

Make the ProgressBarManager a little bit resilient (in order to get rid of the null pointer exception if the JProgressBar is switched).

Modified: trunk/src/net/sf/plantlore/common/ProgressBarManager.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-04 02:15:37 UTC (rev 658)
+++ trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-04 09:15:30 UTC (rev 659)
@@ -57,7 +57,8 @@
     }
     
     public synchronized void removeTask() {
-        task.deleteObserver(this);
+    	if( task != null )
+    		task.deleteObserver(this);
         task = null;
     }
     

Modified: trunk/src/net/sf/plantlore/common/record/UnitIdDatabase.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/UnitIdDatabase.java	2006-09-04 02:15:37 UTC (rev 658)
+++ trunk/src/net/sf/plantlore/common/record/UnitIdDatabase.java	2006-09-04 09:15:30 UTC (rev 659)
@@ -1,6 +1,5 @@
 package net.sf.plantlore.common.record;
 
-import java.util.Date;
 
 /**
  *  Data holder object representing TUNITIDDATABASE table in the DB. This object is used as a data

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 02:15:37 UTC (rev 658)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 09:15:30 UTC (rev 659)
@@ -747,6 +747,7 @@
 Error.AmbiguousUniqueIdentifier=There are two or more records with the same unique identifier.\nIt is not sure which one should be processed.
 Error.DeletingSharedRecord=Unable to delete a shared record.
 Error.SloppyProgramming=The programmer made a mistake here.\nThis should not have happened.
+Error.DatabaseOperationFailed=Unable to perform the database operation.
 
 Error.Server.AccessDenied=Access denied - insufficient permissions.
 Error.Server.ConnectionRefused=Connection refused. Is the Server running?

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 02:15:37 UTC (rev 658)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 09:15:30 UTC (rev 659)
@@ -1397,6 +1397,8 @@
 
 Error.DuplicateLoginTitle=Neplatn\u00E1 data.
 
+Error.DatabaseOperationFailed=Nelze prov\u00E1st danou operaci.
+
 authorMgr=Autor mana\u017Eer
 
 publicationMgr=Celkov\u00E1 historie



From krater at mail.berlios.de  Mon Sep  4 12:48:16 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 12:48:16 +0200
Subject: [Plantlore-dev] r660 - in trunk/src/net/sf/plantlore:
	client/tableimport common common/record server/manager
Message-ID: <200609041048.k84AmGuR024011@sheep.berlios.de>

Author: krater
Date: 2006-09-04 12:48:12 +0200 (Mon, 04 Sep 2006)
New Revision: 660

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
   trunk/src/net/sf/plantlore/common/record/Occurrence.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
Log:
Minor bug that crippled the table import fixed.

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 09:15:30 UTC (rev 659)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 10:48:12 UTC (rev 660)
@@ -63,7 +63,7 @@
 		this.db = db;
 		this.parser = parser;
 		
-		dbutils = new DBLayerUtils( db );
+		dbutils = new DBLayerUtils( db, null, false );
 	}
 	
 	
@@ -119,11 +119,12 @@
 			
 			Record recordInDB = null;
 			try {
-				dbutils.findMatchInDB( data.record );
+				recordInDB = dbutils.findMatchInDB( data.record );
 			} catch(DBLayerException e) {
 				continue;
 			}
 			boolean isRecordInDB = recordInDB != null;
+			logger.debug("Is the record in the database? " + isRecordInDB);
 			
 			// Take action.
 			try {

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-04 09:15:30 UTC (rev 659)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-04 10:48:12 UTC (rev 660)
@@ -385,7 +385,7 @@
 		// Create a query that will look for the record with the same properties.
 		SelectQuery query = db.createQuery( table );
 		
-		logger.debug("Table is " + table.getSimpleName());
+		//logger.debug("Table is " + table.getSimpleName());
 
 		try {
 			// Equal properties.

Modified: trunk/src/net/sf/plantlore/common/record/Occurrence.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-09-04 09:15:30 UTC (rev 659)
+++ trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-09-04 10:48:12 UTC (rev 660)
@@ -130,7 +130,12 @@
 				setId((Integer)value);
 		}
 		else if(column.equalsIgnoreCase(UNITIDDB)) setUnitIdDb((String)value);
-		else if(column.equalsIgnoreCase(UNITVALUE)) setUnitValue((Integer)value);
+		else if(column.equalsIgnoreCase(UNITVALUE)) {
+			if (value != null && value instanceof String)
+				setUnitValue(Integer.parseInt((String) value));
+			else
+				setUnitValue((Integer)value);
+		}
 		else if(column.equalsIgnoreCase(HABITAT)) setHabitat((Habitat)value);
 		else if(column.equalsIgnoreCase(PLANT)) setPlant((Plant)value);
 		else if(column.equalsIgnoreCase(YEARCOLLECTED)) {

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 09:15:30 UTC (rev 659)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 10:48:12 UTC (rev 660)
@@ -17,7 +17,7 @@
 	
 	
 	public ServerMngCtrl(final ServerMng model, final ServerMngView view) {
-		
+
 		view.kick.setAction(new StandardAction("Server.KickUser") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createKickTask( (ConnectionInfo)view.users.getSelectedValue() );

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-04 09:15:30 UTC (rev 659)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-09-04 10:48:12 UTC (rev 660)
@@ -150,7 +150,6 @@
 					setVisible(true);
 				}
 			});
-			
 			Dispatcher.initialize( progress );
 		}
 	}



From krater at mail.berlios.de  Mon Sep  4 13:34:45 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 13:34:45 +0200
Subject: [Plantlore-dev] r661 - in trunk/src/net/sf/plantlore:
	client/occurrenceimport client/tableimport common l10n
Message-ID: <200609041134.k84BYjDA009704@sheep.berlios.de>

Author: krater
Date: 2006-09-04 13:34:42 +0200 (Mon, 04 Sep 2006)
New Revision: 661

Modified:
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
Log:
More informative messages in import.

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-04 10:48:12 UTC (rev 660)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-04 11:34:42 UTC (rev 661)
@@ -34,7 +34,7 @@
 	private Logger logger = Logger.getLogger(OccurrenceImportTask.class.getPackage().getName());
 	
 	private OccurrenceParser parser;
-	private int count;
+	private int count, rejected;
 	private DBLayerUtils dbutils;
 	
 	private DBLayerException canceledByUser = new DBLayerException(L10n.getString("Import.CanceledByUser"));
@@ -72,7 +72,7 @@
 
 	@Override
 	public Object task() throws Exception {
-		count = 0;
+		count = rejected = 0;
 		try {
 			parser.startParsing();
 		} catch(SAXException e) {
@@ -114,7 +114,7 @@
 		if( isCanceled() ) 
 			throw canceledByUser;
 		count++;
-		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count));
+		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, rejected));
 		try {
 			if(aos == null || aos.length == 0) {
 				logger.error("The occurrence record is either corrupted or incomplete. It will be skipped.");
@@ -124,7 +124,8 @@
 		} 
 		catch(DBLayerException e) {
 			if( IGNORE_ERRORS.contains(e.getErrorCode()) )
-				setStatusMessage( e.getMessage() );
+				//setStatusMessage( e.getMessage() );
+				rejected++;
 			else
 				throw e;
 		}

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 10:48:12 UTC (rev 660)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 11:34:42 UTC (rev 661)
@@ -94,7 +94,7 @@
 			try {
 				count++;
 				setPosition( count );
-				setStatusMessage(L10n.getFormattedString("Import.RecordsImported", count));
+				setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, (count - deleted - updated - inserted) ));
 				data = parser.getNext();
 			} catch( ParserException pe ) {
 				logger.warn("The record is corrupted. " + pe);
@@ -107,7 +107,7 @@
 					|| (data.action == TableParser.Action.UPDATE 
 							&& (data.replacement == null || !data.replacement.areAllNNSet()))   ) {
 				
-				logger.info("Rejecting the record No. "+count+"! Some of the not-null values are not specified!");
+				logger.warn("Rejecting the record No. "+count+"! Some of the not-null values are not specified!");
 				setStatusMessage(L10n.getFormattedString("Import.IncompleteRecord", count));					
 			}
 			
@@ -121,6 +121,7 @@
 			try {
 				recordInDB = dbutils.findMatchInDB( data.record );
 			} catch(DBLayerException e) {
+				logger.warn("Unable to find a match in the database. " + e.getMessage());
 				continue;
 			}
 			boolean isRecordInDB = recordInDB != null;

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-04 10:48:12 UTC (rev 660)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-04 11:34:42 UTC (rev 661)
@@ -473,7 +473,7 @@
 			logger.debug("The record belongs to an immutable table "+record.getClass().getSimpleName());
 			Record counterpart = findMatchInDB( record );
 			if( counterpart == null ) {
-				logger.fatal("The counterpart for the record (in the immutable table " +
+				logger.fatal("The counterpart for the " + record.toFullString() + " (in the immutable table " +
 						record.getClass().getSimpleName()	+ ") was not found!");
 				throw new DBLayerException( L10n.getString("Error.RecordNotFound") );
 			}

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 10:48:12 UTC (rev 660)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 11:34:42 UTC (rev 661)
@@ -518,7 +518,7 @@
 Import.UnableToProcess=The record No. {0} cannot be processed.
 Import.UnknownReason=The reason is uknown.
 Import.RecordsImported={0} records processed.
-Import.RecordsProcessed={0} records processed.
+Import.RecordsProcessed={0} processed ({1} rejected)
 Import.UpdatingEnvironment=Updating environment...
  
 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 10:48:12 UTC (rev 660)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 11:34:42 UTC (rev 661)
@@ -989,7 +989,7 @@
 
 Import.RecordsRejected=zam\u00EDtnuto.
 
-Import.RecordsProcessed={0} z\u00E1znam\u016F zpracov\u00E1no.
+Import.RecordsProcessed={0} zpracov\u00E1no ({1} zam\u00EDtnuto)
 
 Import.Abort=Zru\u0161it
 



From tkovarik at gmail.com  Mon Sep  4 13:38:23 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Mon, 4 Sep 2006 13:38:23 +0200
Subject: [Plantlore-dev] Request for comments: Co a ako prezentovat
Message-ID: <ea88f1620609040438u562b4b5bw91065164cd5e061a@mail.gmail.com>

Caute,

tu je moj navrh ako postupovat dnes pri tej prezentacii oponentovi. Ak
myslite ze tam nieco chyba alebo by malo byt inak, dajte vediet:

1. Instalacia Plantlore pomocou instalatora [bez instalacie Postgre - este
to zatial nejde na linuxe a predpokladam ze pojdeme na linuxe]
2. Spustenie klienta a servera, pripadne pridanie tripletu a prihlasenie sa
k prazdnej databazi [databaza uz bude vytvorena]
3. Import dat do tabuliek [ak bude trvat dlho tak len ukazka, prepneme sa
potom na plnu DB]
4. Pridanie autora, publikacie, metadat. Ukazka user managera. [pozor na to,
ze uzivatelom plantlore musia odpovedat aj uzivatelia v DB]
5. Prepnutie sa do plnej databaze [logout a nasledny login]
6. Ukazka overview, add, edit, search, print [scheda atp.]
7. Po zaeditovani zaznamu ukazka historie
8. Export vybranych nalezov
9. Import tychto nalezov naspat
10. Server - ukazka [vykopnutie uzivatela a skusku klienta po tejto operacii
by som asi radsej nerobil...]

Co tam nie je: Help, Settings [nie uplne najdolezitejsie casti...]


Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060904/5e7d19d1/attachment.html>

From kovo at mail.berlios.de  Mon Sep  4 14:18:01 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 4 Sep 2006 14:18:01 +0200
Subject: [Plantlore-dev] r662 - trunk/src/net/sf/plantlore/client/authors
Message-ID: <200609041218.k84CI1xm026863@sheep.berlios.de>

Author: kovo
Date: 2006-09-04 14:17:58 +0200 (Mon, 04 Sep 2006)
New Revision: 662

Modified:
   trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
Log:
Update of author manager. It now uses the new task and progressbar management. Some code cleanup and l10n changes still pending.

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-04 11:34:42 UTC (rev 661)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-04 12:17:58 UTC (rev 662)
@@ -1,9 +1,3 @@
-/*
- * AddAuthorCtrl.java
- *
- * Created on 21. leden 2006, 0:58
- *
- */
 
 package net.sf.plantlore.client.authors;
 
@@ -13,17 +7,23 @@
 import java.awt.event.FocusListener;
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
+import java.rmi.RemoteException;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.PlantloreHelp;
 import javax.swing.Timer;
 import net.sf.plantlore.client.authors.AuthorManagerCtrl.RoleFieldPropertyChangeListener;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.ProgressDialog;
+import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.exception.DBLayerException;
 import org.apache.log4j.Logger;
 
 /**
  * Controller for the Add/Edit author dialog in the AuthorManager MVC.
  *
  * @author Tomas Kovarik
- * @version 1.0 BETA, May 1, 2006
+ * @version 1.0
  */
 public class AddAuthorCtrl {
     /** Model of the Author manager MVC */
@@ -58,22 +58,6 @@
         view.emailAddPropertyChangeListener(new EmailFieldPropertyChangeListener());
         view.urlAddPropertyChangeListener(new UrlFieldPropertyChangeListener());
         view.noteAddFocusListener(new NoteAreaFocusListener());                
-        // Create a timer to check for the end of long running task
-        timer = new Timer(100, new ActionListener() {
-            public void actionPerformed(ActionEvent evt) {
-                if (model.isOperationDone() == true) {
-                    timer.stop();
-                    // Close progress bar dialog
-                    progress.close();
-                    view.setDialogEnabled(true);                    
-                    if (model.processErrors() == false) {    
-                        if (model.isResultAvailable()) {   
-                            model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());                        
-                        }
-                    }
-                }
-            }
-        });        
     }
     
     /**
@@ -92,22 +76,56 @@
      * This metod is used for saving new author as well as updating the existing one.
      */    
     class SaveAuthorButtonListener implements ActionListener {
-        public void actionPerformed(ActionEvent e) {            
+        public void actionPerformed(ActionEvent e) {                        
             // Check whether all the required fields are present
             if (view.checkNonEmpty("name")) {
-                if (model.getEditAuthor() == null) {
+                if (model.getEditAuthor() == null) {                    
                     // Save new author
-                    model.saveAuthor();                
-                } else {
+                    Task task = model.saveAuthor();     
+                    task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            model.searchAuthor(false);
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
+                            model.reloadCache();
+                        }                        
+                    });
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
+                } else {                    
                     // Edit existing author
-                    model.editAuthor();
+                    Task task = model.editAuthor();
+                    task.setPostTaskAction(new PostTaskAction() {
+                        public void afterStopped(Object value) {
+                            model.searchAuthor(false);
+                            try {
+                                model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                            } catch (RemoteException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            } catch (DBLayerException ex) {
+                                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                                ex.printStackTrace();
+                                DefaultExceptionHandler.handle(view, ex);
+                                return;                    
+                            }
+                            model.reloadCache();                            
+                        }                        
+                    });
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
                 }
-                // Disable the dialog while saving author
-                view.setDialogEnabled(false);                                
-                timer.start();                
-                // Display dialog with progress bar
-                progress = new ProgressDialog(view.getDialog(), true);
-                progress.show();
                 // Close the add dialog when save finished
                 view.close();
             }

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-04 11:34:42 UTC (rev 661)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-04 12:17:58 UTC (rev 662)
@@ -1,8 +1,3 @@
-/*
- * AddAuthorView.java
- *
- * Created on 30. duben 2006, 17:46
- */
 
 package net.sf.plantlore.client.authors;
 
@@ -24,7 +19,7 @@
  * Dialog used for adding / editing authors.
  *
  * @author  Tomas Kovarik
- * @version 1.0 BETA, May 1, 2006
+ * @version 1.0
  */
 public class AddAuthorView extends javax.swing.JDialog implements Observer {
     /** Model of the Author manager MVC */

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-04 11:34:42 UTC (rev 661)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-04 12:17:58 UTC (rev 662)
@@ -1,9 +1,3 @@
-/*
- * AuthorManager.java
- *
- * Created on 15. leden 2006, 2:04
- *
- */
 
 package net.sf.plantlore.client.authors;
 
@@ -11,6 +5,7 @@
 import java.util.ArrayList;
 import java.util.Observable;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.HistoryRecord;
@@ -84,6 +79,10 @@
     private int sortDirection = 0;
     /** Author we want to edit */
     private Author editAuthor;
+    /** Enum used for notifying AppCore to reload cached publications */
+    private PlantloreConstants.Table[] editTypeArray = new PlantloreConstants.Table[]{PlantloreConstants.Table.AUTHOR};
+    
+    
     /** Constants used for identification of fields for sorting */
     public static final int SORT_NAME = 1;
     public static final int SORT_ORGANIZATION = 2;
@@ -115,12 +114,16 @@
     /**
      *  Save new author to the database. Information about the author are stored in data fields of this class.
      *  Operation is executed in a separate thread using <code>SwingWorker</code>. Error is set in case of an exception.
+     *
+     *  @return Task instance of the Task with the long running operation (saving data)
      */
-    public void saveAuthor() {
-        final SwingWorker worker = new SwingWorker() {
-            public Object construct() {
+    public Task saveAuthor() {
+        // Create Task
+        final Task task = new Task() {
+            public Object task() throws Exception {
                 // The operation is not finished yet
                 done = false;
+                setStatusMessage(L10n.getString("Authors.ProgressBar.Save"));                
                 // Create Author object for author we want to add
                 Author author = new Author();
                 author.setWholeName(name);
@@ -133,95 +136,59 @@
                 author.setDeleted(0);
                 author.setNote(note);
                 int rowId = -1;
-                try {
-                    // Execute query
-                    rowId = database.executeInsert(author);
-                } catch (DBLayerException e) {
-                    // Check the type of an exception
-                    int errorCode = e.getErrorCode();
-                    switch (errorCode) {
-                        case DBLayerException.ERROR_RIGHTS:
-                            logger.info("Insufficient rights for the operation");
-                            setError(ERROR_RIGHTS);
-                            break;
-                        case DBLayerException.ERROR_SAVE:
-                            logger.error("Saving author failed. Unable to execute insert query");
-                            setError(ERROR_SAVE);                            
-                            break;
-                        default:
-                            logger.error("Saving author failed. An error occurred");                            
-                            setError(ERROR_SAVE);                            
-                    }
-                    // Set operation state to finished
-                    done = true;
-                    return null;
-                } catch(RemoteException e) {
-                    System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                }
-                logger.info("Author "+name+" saved successfuly.");
-                if (isResultAvailable()) {
-                    searchAuthor();
-                }                
+                clearDataHolders();                
+                // Execute query
+                rowId = database.executeInsert(author);
+                logger.info("Author "+name+" saved successfuly.");                
+                // Set operation state to finished
                 done = true;
-                return rowId;
+                // Stop the Task
+                fireStopped(null);               
+                return rowId;                
             }
         };
-        worker.start();
+        return task;
     }
     
     /**
      *  Delete an author from the database. To-be-deleted author is identified by his ID and is
      *  retrieved based on the value of <code>authorIndex</code> field. Error is set in case of an exception.
+     *
+     *  @return instance of the Task with the long running operation (deleting data)
      */
-    public void deleteAuthor() {
-        final SwingWorker worker = new SwingWorker() {
-            public Object construct() {
+    public Task deleteAuthor() {
+        // Create Task
+        final Task task = new Task() {
+            public Object task() throws Exception {
+                setStatusMessage(L10n.getString("Authors.ProgressBar.Delete"));
                 // Operation not finished yet
                 done = false;
-                try {
-                    // Execute query
-                    Author delAuthor = (Author)data.get(getAuthorIndex());
-                    delAuthor.setDeleted(1);
-                    database.executeUpdate(delAuthor);
-                } catch (DBLayerException e) {
-                    int errorCode = e.getErrorCode();
-                    switch (errorCode) {
-                        case DBLayerException.ERROR_RIGHTS:
-                            logger.info("Insufficient rights for the operation");
-                            setError(ERROR_RIGHTS);
-                            break;
-                        case DBLayerException.ERROR_DELETE:
-                            logger.error("Deleting author failed. Unable to execute delete query");
-                            setError(ERROR_DELETE);
-                            break;
-                        default:
-                            logger.error("Deleting author failed. An error occurred");                            
-                            setError(ERROR_DELETE);                            
-                    }                    
-                    // Set operation state to finished
-                    done = true;
-                    return false;
-                } catch(RemoteException e) {
-                    System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                }
+                // Execute query
+                Author delAuthor = (Author)data.get(getAuthorIndex());
+                delAuthor.setDeleted(1);
+                database.executeUpdate(delAuthor);
                 logger.info("Author "+name+" deleted succesfully");
-                // Execute author search - required in order to display up-to-date data in the table of authors
-                searchAuthor();
                 // Set operation state to finished
                 done = true;
+                // Stop the Task
+                fireStopped(null);
                 return true;
             }
         };
-        worker.start();
+        return task;
     }
 
     /**
      *  Update author in the database. To-be-updated author is stored in <code>editAuthor</code> field. Operation 
      *  is executed in a separate thread using <code>SwingWorker</code>. Error is set in case of an exception.
+     *
+     *  @return instance of the Task with the long running operation (updating data)
      */    
-    public void editAuthor() {
-        final SwingWorker worker = new SwingWorker() {
-            public Object construct() {
+    public Task editAuthor() {
+        // Create the Task
+        final Task task = new Task() {
+            public Object task() throws Exception {
+                setStatusMessage(L10n.getString("Authors.ProgressBar.Save"));
                 // The operation is not finished yet
                 done = false;
                 // Update to*be-updated author based on user input
@@ -234,138 +201,129 @@
                 author.setEmail(email);
                 author.setUrl(url);
                 author.setNote(note);
-                try {
-                    // Execute query
-                    database.executeUpdate(author);
-                } catch (DBLayerException e) {
-                    int errorCode = e.getErrorCode();
-                    switch (errorCode) {
-                        case DBLayerException.ERROR_RIGHTS:
-                            logger.info("Insufficient rights for the operation");
-                            setError(ERROR_RIGHTS);
-                            break;
-                        case DBLayerException.ERROR_UPDATE:
-                            logger.error("Updating author failed. Unable to execute update query");
-                            setError(ERROR_UPDATE);                            
-                            break;
-                        default:
-                            logger.error("Updating author failed. An error occurred");                            
-                            setError(ERROR_UPDATE);                            
-                    }                    
-                    // Set operation state to finished
-                    done = true;
-                    return false;
-                } catch(RemoteException e) {
-                    System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                }
+                clearDataHolders();                
+                // Execute query
+                database.executeUpdate(author);
                 logger.info("Author "+name+" updated successfuly.");
-                if (isResultAvailable()) {
-                    searchAuthor();
-                }
                 done = true;
+                // Stop the Task
+                fireStopped(null);
                 return true;
             }
         };
-        worker.start();        
+        return task;
     }
     
     /**
-     *  Search for authors in the database. Criteria for search are stored in data fields of this class.
-     *  Operation is executed in a separate thread using <code>SwingWorker</code>. Error is set in case of an exception
+     *  Search for authors in the database. Criteria for search are stored in data fields of 
+     *  this class. Operation might be executed in a separate thread using the Task class (depends
+     *  on the input parameters). the reason for this is that we are sometimes executing search from
+     *  another long running operation, teherefore we do not need a new thread.
+     *
+     *  @param createTask tells whether to execute search in a separate thread
+     *  @return instance of the Task with the long running operation (searching data)
+     *  @see #search()
      */
-    public void searchAuthor() {
-        final SwingWorker worker = new SwingWorker() {
-            public Object construct() {
-                // Operation not finished yet
-                done = false;
-                SelectQuery query;
-                try {
-                    // Create new Select query                    
-                    query = database.createQuery(Author.class);                    
-                    // Display only authors who haven't been deleted
-                    query.addRestriction(PlantloreConstants.RESTR_EQ, Author.DELETED, null, 0, null);
-                    // Add given restrictions (WHERE clause)
-                    if ((searchName != null) && (searchName != ""))
-                        query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.WHOLENAME, null, "%" + searchName + "%", null);
-                    if ((searchOrganization != null) && (searchOrganization != ""))
-                        query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.ORGANIZATION, null, "%" + searchOrganization + "%", null);
-                    if ((searchRole != null) && (searchRole != ""))
-                        query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.ROLE, null, "%" + searchRole + "%", null);
-                    if ((searchEmail != null) && (searchEmail != null))
-                        query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.EMAIL, null, "%" + searchEmail + "%", null);
-                    String field;
-                    // Add ORDER BY clause
-                    switch (sortField) {
-                        case 1: field = Author.WHOLENAME;
-                                break;
-                        case 2: field = Author.ORGANIZATION;
-                                break;
-                        case 3: field = Author.ROLE;
-                                break;
-                        case 4: field = Author.EMAIL;
-                                break;
-                        case 5: field = Author.PHONENUMBER;
-                                break;
-                        case 6: field = Author.URL;
-                                break;
-                        default:field = Author.WHOLENAME;
-                    }
-                    
-                    if (sortDirection == 0) {
-                        query.addOrder(PlantloreConstants.DIRECT_ASC, field);
-                    } else {
-                        query.addOrder(PlantloreConstants.DIRECT_DESC, field);
-                    }
-                    int resultId = 0;
-                    try {
-                        // Execute query
-                        resultId = database.executeQuery(query);
-                    } catch (DBLayerException e) {
-                        int errorCode = e.getErrorCode();
-                        switch (errorCode) {
-                            case DBLayerException.ERROR_SELECT:
-                                logger.error("Searching authors failed. Unable to execute search query.");
-                                setError(ERROR_SEARCH);
-                                break;
-                            default:
-                                logger.error("Saving author failed. An error occurred");                            
-                                setError(ERROR_SEARCH);
-                        }                        
-                    } finally {
-                        // Set operation state to finished
-                        done = true;
-                        logger.info("Authors successfuly retrieved from the database");
-                        // Save the results
-                        setResult(resultId);
-                    }
+    public Task searchAuthor(boolean createTask) {
+        // Use the Task class to execute the search in a new thread
+        if (createTask) {
+            final Task task = new Task() {
+                public Object task() throws Exception {
+                    setStatusMessage(L10n.getString("Authors.ProgressBar.Search"));                    
+                    // Search the data
+                    int resultId = search();
+                    setResult(resultId);
+                    logger.info("Authors successfuly retrieved from the database");
+                    // Stop the Task
+                    fireStopped(null);
                     return resultId;
-                } catch (RemoteException e) {
-                    System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                    return null;
-                } catch (DBLayerException e) {
-                    System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                    return null;
                 }
+            };
+            return task;
+        } else {
+            // Do not use Task. Catch exceptions but do not display error.
+            try {
+                int resultId = search();
+                setResult(resultId);
+            } catch (DBLayerException ex1) {
+                logger.error("DBLayerException caught while searching the database. Details: "+ex1.getMessage());
+                ex1.printStackTrace();
+                return null;
+            } catch (RemoteException ex2) {
+                logger.error("RemoteException caught while searching the database. Details: "+ex2.getMessage());
+                ex2.printStackTrace();
+                return null;
             }
-        };
-        worker.start();
-    }
+            logger.info("Authors successfuly retrieved from the database");
+            return null;
+        }
+    }   
     
     /**
-     * Checks whether an error is set. If yes, notifies observers to display it.
-     * Finally unsets the error flag.
+     *  Method to construct and execute the search query. This method is called from searchAuthor method.
      *
-     * @return <code>true</code> if an error was set (and observers were notified), <code>false</code> otherwise
+     *  @return id identifying the search result
+     *  @throws DBLayerException in case search failed
+     *  @throws RemoteException in case network communication failed
+     *  @see #searchAuthor(boolean)
      */
-    public boolean processErrors() {
-        if (this.error != null) {
-            setChanged();
-            notifyObservers();
-            this.error = null;
-            return true;
+    public Integer search() throws DBLayerException, RemoteException {
+        SelectQuery query;
+        // Create new Select query
+        query = database.createQuery(Author.class);
+        // Display only authors who haven't been deleted
+        query.addRestriction(PlantloreConstants.RESTR_EQ, Author.DELETED, null, 0, null);
+        // Add given restrictions (WHERE clause)
+        if ((searchName != null) && (searchName != ""))
+            query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.WHOLENAME, null, "%" + searchName + "%", null);
+        if ((searchOrganization != null) && (searchOrganization != ""))
+            query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.ORGANIZATION, null, "%" + searchOrganization + "%", null);
+        if ((searchRole != null) && (searchRole != ""))
+            query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.ROLE, null, "%" + searchRole + "%", null);
+        if ((searchEmail != null) && (searchEmail != null))
+            query.addRestriction(PlantloreConstants.RESTR_ILIKE, Author.EMAIL, null, "%" + searchEmail + "%", null);
+        String field;
+        // Add ORDER BY clause
+        switch (sortField) {
+            case 1: field = Author.WHOLENAME;
+            break;
+            case 2: field = Author.ORGANIZATION;
+            break;
+            case 3: field = Author.ROLE;
+            break;
+            case 4: field = Author.EMAIL;
+            break;
+            case 5: field = Author.PHONENUMBER;
+            break;
+            case 6: field = Author.URL;
+            break;
+            default:field = Author.WHOLENAME;
         }
-        return false;
+        
+        if (sortDirection == 0) {
+            query.addOrder(PlantloreConstants.DIRECT_ASC, field);
+        } else {
+            query.addOrder(PlantloreConstants.DIRECT_DESC, field);
+        }
+        int resultId = 0;
+        // Execute query
+        resultId = database.executeQuery(query);
+        return resultId;
     }
+     
+    /**
+     *  Clear the variables with author properties
+     */
+    private void clearDataHolders() {
+        this.name = null;
+        this.organization = null;
+        this.role = null;
+        this.address = null;
+        this.phoneNumber = null;
+        this.email = null;
+        this.url = null;
+        this.note = null;        
+    }
     
     /**
      * Process results of a search query. Retrieves results using the database
@@ -376,7 +334,7 @@
      * @param from  index of the first row to retrieve.
      * @param count number of rows to retrieve
      */
-    public void processResults(int from, int count) {
+    public void processResults(int from, int count) throws RemoteException, DBLayerException {
         if (this.resultId != 0) {
             logger.info("Processing "+count+" results from "+from);
             logger.debug("Rows in the result: "+getResultRows());
@@ -384,63 +342,73 @@
             int to = Math.min(getResultRows(), from+count-1);
             if (to == 0) {
                 this.data = new ArrayList();
-            } else {
-                try {
-                    // Retrieve selected row interval
-                    Object[] objArray;
-                    try {
-                        // FIXME: Should change all the usages of processResults to use 0 as the index of the forst row
-                        // from-1 and to-1 just temporary
-                        objArray = database.more(resultId, from-1, to-1);
-                    } catch(RemoteException e) {
-                        System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
-                        return;
-                    }
-                    logger.debug("Results retrieved. Count: "+objArray.length);
-                    // Create storage for the results
-                    this.data = new ArrayList(objArray.length);
-                    // Cast the results to the AuthorRecord objects
-                    for (int i=0;i<objArray.length;i++) {
-                        Object[] objAuth = (Object[])objArray[i];
-                        this.data.add((Author)objAuth[0]);
-                    }
-                } catch (DBLayerException e) {
-                    // Log and set error in case of an exception
-                    logger.error("Processing search results failed: "+e.toString());
-                    setError(this.ERROR_PROCESS);
+            } else {                
+                // Retrieve selected row interval
+                Object[] objArray;
+                
+                // FIXME: Should change all the usages of processResults to use 0 as the index of the forst row
+                // from-1 and to-1 just temporary
+                objArray = database.more(resultId, from-1, to-1);
+                logger.debug("Results retrieved. Count: "+objArray.length);
+                // Create storage for the results
+                this.data = new ArrayList(objArray.length);
+                // Cast the results to the AuthorRecord objects
+                for (int i=0;i<objArray.length;i++) {
+                    Object[] objAuth = (Object[])objArray[i];
+                    this.data.add((Author)objAuth[0]);
                 }
-                // Update current first displayed row (only if data retrieval was successful).
-                if (!this.isError()) {
-                    logger.info("Results successfuly retrieved");
-                    // Update current first displayed row
-                    setCurrentFirstRow(from);
-                }
+                logger.info("Results successfuly retrieved");
+                // Update current first displayed row
+                setCurrentFirstRow(from);
+                
             }
             // Tell observers to update
             setChanged();
             notifyObservers();
-            // Clean error flag (if it was set)
-            this.error = null;
         }
     }
+
+    /**
+     *  Notify observers  about the change in the list of publications (used to reload cached publications)
+     */
+    public void reloadCache() {
+        // Notify observers about the change in the list of publications. Used to reload cached publications
+        setChanged();
+        notifyObservers(editTypeArray);        
+    }    
     
-    public boolean hasRights(int operation) {
-        try {
-            if (operation == ADD) {
-                if (database.getUserRights().getAdd() == 1) {
+    /**
+     *  Check whether the user has appropriate rights for the given operation.
+     *
+     *  @param  operation operation that is executed (for operation codes see constants)
+     *  @return true if the user has the right to execute the operation, false otherwise
+     *  @throws RemoteException in case we could not get user's access privileges
+     */    
+    public boolean hasRights(int operation) throws RemoteException {       
+        if (operation == ADD) {
+            if (database.getUserRights().getAdd() == 1) {
+                return true;
+            } else {
+                return false;
+            }            
+        } else { // Same rules apply for EDIT and DELETE
+            // Check whether the user can edit all the records
+            if (database.getUserRights().getEditAll() == 1) {
+                return true;
+            }
+            // Check whether the user can edit the record through some other user
+            String[] group = database.getUserRights().getEditGroup().split(",");
+            // We will need Author that will be edited
+            Author selectedAuth = (Author)data.get(this.getAuthorIndex());
+            // Check whether someone in the group is an owner of the publication
+            for (int i=0;i<group.length;i++) {
+                if (selectedAuth.getCreatedWho().getId().toString().equals(group[i])) {
                     return true;
-                } else {
-                    return false;
-                }            
-            } else if (operation == EDIT) {
-                // TODO
-            } else if (operation == DELETE) {
-                // TODO
+                }
             }
-        } catch (RemoteException e) {
-            logger.error("Remote exception caught");
+            // No rights to edit the record
+            return false;            
         }
-        return false;
     }
     
     /**
@@ -494,10 +462,14 @@
      */
     public int getResultRows() {
         int result = 0;
-        if (resultId != 0) try {
-            result = database.getNumRows(resultId);
-        } catch(RemoteException e) {
-            System.err.println("Kdykoliv se pracuje s DBLayer nebo SelectQuery, musite hendlovat RemoteException");
+        if (resultId != 0) {
+            try {
+                result = database.getNumRows(resultId);
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while retrieving number of rows in the result. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return 0;
+            }
         }
         return result;
     }

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-04 11:34:42 UTC (rev 661)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-04 12:17:58 UTC (rev 662)
@@ -1,9 +1,3 @@
-/*
- * AuthorManagerCtrl.java
- *
- * Created on 15. leden 2006, 2:04
- *
- */
 
 package net.sf.plantlore.client.authors;
 
@@ -13,15 +7,18 @@
 import java.awt.event.FocusListener;
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
+import java.rmi.RemoteException;
 import net.sf.plantlore.common.*;
 import javax.swing.Timer;
+import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
 
 /**
  * Controller for the main AuthorManager dialog (part of the AutorManager MVC).
  *
  * @author Tomas Kovarik
- * @version 1.0 BETA, May 1, 2006
+ * @version 1.0
  */
 public class AuthorManagerCtrl {
     /** Instance of a logger */
@@ -30,12 +27,6 @@
     AuthorManager model;
     /** View of the AuthorManager MVC */
     AuthorManagerView view;
-         
-    private Timer timerSearch;          // Used for periodic checking of the state of other thread
-    private Timer timerDelete;          // Used for periodic checking of the state of other thread    
-    private ProgressDialog progress;    // Dialog showing progressbar
-    /** Frequency of the timer used for periodic checking of the state of other threads */
-    private final int TIMER_FREQUENCY = 100;
     
     /** 
      * Creates a new instance of AuthorManagerCtrl 
@@ -64,58 +55,27 @@
         view.rowsAddPropertyChangeListener(new RowsPropertyChangeListener());
         view.sortAddFocusListener(new SortComboFocusListener());
         view.sortDirectionAddFocusListener(new SortDirectionRadioFocusListener());
-        // Create a timer for search operation
-        timerSearch = new Timer(TIMER_FREQUENCY, new ActionListener() {
-            public void actionPerformed(ActionEvent evt) {
-                // Check whether the other thread is still running
-                if (model.isOperationDone() == true) {
-                    timerSearch.stop();                    
-                    progress.close();               // Close dialog with progress bar
-                    view.setDialogEnabled(true);    // Enable view dialog                
-                    // Check for errors which might have occured. If none occured, tell model to process the result
-                    if (model.processErrors() == false) {
-                        model.setCurrentFirstRow(1);                                                    
-                        // Display first n rows (n = model.getDisplayRows())                        
-                        model.processResults(1, model.getDisplayRows());                        
-                    }
+
+        Task task = model.searchAuthor(true);
+        task.setPostTaskAction(new PostTaskAction() {
+            public void afterStopped(Object value) {
+                model.setCurrentFirstRow(1);
+                try {
+                    model.processResults(1, model.getDisplayRows());
+                } catch (RemoteException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                } catch (DBLayerException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
                 }
-            }
-        });                
-        // Create a timer for delete operation
-        timerDelete = new Timer(TIMER_FREQUENCY, new ActionListener() {
-            public void actionPerformed(ActionEvent evt) {
-                // Check whether the other thread is still running
-                if (model.isOperationDone() == true) {
-                    timerDelete.stop();                    
-                    progress.close();               // Close dialog with progress bar
-                    view.setDialogEnabled(true);    // Enable view dialog                
-                    // Check for errors which might have occured. If none occured, tell model to process the result
-                    if (model.processErrors() == false) {
-                        // Update curent first row so that it is not greater than number of rows in the result
-                        // (this happens in case the last record in the list has been deleted and it was set as 
-                        // the current first row)
-                        if (model.getCurrentFirstRow() > model.getResultRows()) {                           
-                            int row = model.getCurrentFirstRow()-model.getDisplayRows();
-                            if (row < 1) {
-                                model.setCurrentFirstRow(1);                                
-                            } else {
-                                model.setCurrentFirstRow(row);                                                                
-                            }
-                        }
-                        // Update table with authors - remove deleted author                        
-                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
-                    }
-                }
-            }
-        });   
-        // Display all authors when Author manager is opened
-        model.searchAuthor();
-        // Disable current view and run timer
-        view.setDialogEnabled(false);                                
-        timerSearch.start();                
-        // Display dialog with progress bar
-        progress = new ProgressDialog(view.getDialog(), true);
-        progress.show();        
+            }            
+        });
+        Dispatcher.getDispatcher().dispatch(task, view, false);        
     }
     
     /**
@@ -134,10 +94,18 @@
     class AddAuthorButtonListener implements ActionListener {
         public void actionPerformed(ActionEvent e) {
             // Check whether we have rights for this operation
-            if (!model.hasRights(model.ADD)) {
-                view.showErrorMessage("Rights");
+            try {
+                if (!model.hasRights(model.ADD)) {
+                    view.showErrorMessage(L10n.getString("Authors.Add.InsufficientRights"));
+                    return;
+                }
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
                 return;
             }
+            
             // Display dialog for adding / editing authors. This dialog shares model with
             // the rest of the AuthorManager.
             AddAuthorView addAuthView = new AddAuthorView(model, view.getFrame(), true);
@@ -161,6 +129,18 @@
                 view.selectRowMsg();
                 return;
             }          
+            try {
+                // Check whether we have rights for this operation
+                if (!model.hasRights(model.EDIT)) {
+                    view.showErrorMessage(L10n.getString("Authors.Edit.InsufficientRights"));
+                    return;
+                }                        
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;
+            }                        
             AddAuthorView addAuthView = new AddAuthorView(model, view.getFrame(), false);
             AddAuthorCtrl addAuthCtrl = new AddAuthorCtrl(model, addAuthView);            
             // Save author we are going to edit
@@ -185,20 +165,47 @@
             if (index == -1) {
                 view.selectRowMsg();
                 return;
-            }           
+            }        
+            try {
+                // Check whether we have rights for this operation
+                if (!model.hasRights(model.DELETE)) {
+                    view.showErrorMessage(L10n.getString("Authors.Delete.InsufficientRights"));
+                    return;
+                }           
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while checking user's rights. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                
+            }
             // Confirm deletion
             if (!view.confirmDelete()) {
                 return;
             }
             // Call delete
-            model.setAuthorIndex(index);
-            model.deleteAuthor();
-            // Disable current view and run timer
-            view.setDialogEnabled(false);                    
-            timerDelete.start();                
-            // Display dialog with progress bar
-            progress = new ProgressDialog(view.getDialog(), true);
-            progress.show();                                                
+            model.setAuthorIndex(index);            
+            // Delete is executed in a separate thread using Task
+            Task task = model.deleteAuthor();
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {                    
+                    model.searchAuthor(false);
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }
+                    model.reloadCache();
+                }                
+            });
+            Dispatcher.getDispatcher().dispatch(task, view, false);            
         }
     }    
 
@@ -207,14 +214,25 @@
      */    
     class SearchAuthorButtonListener implements ActionListener {
         public void actionPerformed(ActionEvent e) {
-            // Run DB search
-            model.searchAuthor();
-            // Disable current view and run timer
-            view.setDialogEnabled(false);                                
-            timerSearch.start();                
-            // Display dialog with progress bar
-            progress = new ProgressDialog(view.getDialog(), true);
-            progress.show();                                                
+            Task task = model.searchAuthor(true);
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) {
+                    try {
+                        model.processResults(model.getCurrentFirstRow(), model.getDisplayRows());
+                    } catch (RemoteException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    } catch (DBLayerException ex) {
+                        logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                        ex.printStackTrace();
+                        DefaultExceptionHandler.handle(view, ex);
+                        return;                    
+                    }                        
+                }                
+            });
+            Dispatcher.getDispatcher().dispatch(task, view, false);            
         }
     }        
     
@@ -226,7 +244,19 @@
             // Call processResults only if we don't see the first page (should not happen, button should be disabled)
             if (model.getCurrentFirstRow() > 1) {
                 int firstRow = Math.max(model.getCurrentFirstRow()-view.getDisplayRows(), 1);
-                model.processResults(firstRow, view.getDisplayRows());                
+                try {
+                    model.processResults(firstRow, view.getDisplayRows());                
+                } catch (RemoteException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                } catch (DBLayerException ex) {
+                    logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                    ex.printStackTrace();
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;                    
+                }                    
             }
         }
     }
@@ -237,8 +267,20 @@
     class NextButtonListener implements ActionListener {    
         public void actionPerformed(ActionEvent e) {
             // Call processResults only if we don't see the last page (should not happen, button should be disabled)
-            if (model.getCurrentFirstRow()+view.getDisplayRows()<=model.getResultRows()) {
-                model.processResults(model.getCurrentFirstRow()+view.getDisplayRows(), view.getDisplayRows());
+            try {
+                if (model.getCurrentFirstRow()+view.getDisplayRows()<=model.getResultRows()) {
+                    model.processResults(model.getCurrentFirstRow()+view.getDisplayRows(), view.getDisplayRows());
+                }
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
             }
         }
     }    
@@ -328,9 +370,21 @@
             model.setDisplayRows(view.getDisplayRows());
             logger.debug("New number of rows to display: "+view.getDisplayRows());
             // If neccessary reload search results
-            if ((oldValue != view.getDisplayRows()) && (model.getDisplayRows() <= model.getResultRows())) {
-                model.processResults(model.getCurrentFirstRow(), view.getDisplayRows());
-                logger.debug("Search results reloaded. First row: "+model.getCurrentFirstRow()+"; Display rows: "+view.getDisplayRows());
+            try {                        
+                if ((oldValue != view.getDisplayRows()) && (model.getDisplayRows() <= model.getResultRows())) {
+                    model.processResults(model.getCurrentFirstRow(), view.getDisplayRows());
+                    logger.debug("Search results reloaded. First row: "+model.getCurrentFirstRow()+"; Display rows: "+view.getDisplayRows());
+                }
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while processing search results. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;                    
             }
         }        
     }            

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-04 11:34:42 UTC (rev 661)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-04 12:17:58 UTC (rev 662)
@@ -1,8 +1,3 @@
-/*
- * AuthorManagerView.java
- *
- * Created on 30. duben 2006, 14:58
- */
 
 package net.sf.plantlore.client.authors;
 
@@ -384,20 +379,14 @@
      *  @param message Message we want to display
      */
     public void showErrorMessage(String message) {
-        JOptionPane.showMessageDialog(this, message, L10n.getString("Common.ErrorMessageTitle"), JOptionPane.ERROR_MESSAGE);               
+        JOptionPane.showMessageDialog(this, message, L10n.getString("Error.GenericMessageTitle"), JOptionPane.ERROR_MESSAGE);               
     }
     
     /**
      *  Method used for updating the view (called when the model has changed and notifyObservers() was called)
      */
     public void update(Observable obs, Object obj) {       
-        // Check whether we have some kind of error to display
-        if (model.isError()) {
-            showErrorMessage(model.getError());            
-            return;
-        } else {
-            displayResults(model.getData());
-        }
+        displayResults(model.getData());
     }
 
     /**
@@ -509,7 +498,7 @@
      *  Close this dialog.
      */    
     public void close() {
-        this.hide();
+        this.dispose();
     }
 
     /**



From discontinuum at gmail.com  Mon Sep  4 14:18:31 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Mon, 4 Sep 2006 14:18:31 +0200
Subject: [Plantlore-dev] Why not Exception.printStackTrace()?
Message-ID: <f4dc39b90609040518w1b660138h8e5a3529227b15ea@mail.gmail.com>

14:05:03,042  INFO main client:72 - Plantlore client is starting up...
14:05:03,072  INFO main l10n:59 - Using default locale cs_CZ
14:05:04,404  INFO main client:67 - Loading main configuration file
C:\Documents and Settings\yaa\plantlore\plantlore.xml
14:05:04,645  INFO main client:147 - Constructing AppCore MVC
14:05:06,247  WARN main l10n:99 - The key "Settings" is not defined in the
property file!
14:05:06,247  WARN main l10n:99 - The key "SettingsTooltip" is not defined
in the property file!
14:05:06,247  WARN main l10n:149 - The key "Settings" is not defined in the
property file! Couldn't return mnemonic.
14:05:06,247  WARN main l10n:99 - The key "Print" is not defined in the
property file!
14:05:06,257  WARN main l10n:99 - The key "PrintTooltip" is not defined in
the property file!
14:05:06,257  WARN main l10n:149 - The key "Print" is not defined in the
property file! Couldn't return mnemonic.
14:05:06,447  WARN main l10n:99 - The key "Overview.MenuDataAuthorsTT" is
not defined in the property file!
14:05:06,457  WARN main l10n:99 - The key "Overview.MenuDataPublicationsTT"
is not defined in the property file!
14:05:06,497  WARN main l10n:99 - The key "Overview.HabitatTree" is not
defined in the property file!
14:05:06,497  WARN main l10n:99 - The key "Overview.HabitatTreeTT" is not
defined in the property file!
14:05:06,517  WARN main l10n:99 - The key "Overview.MenuFileLoginTT" is not
defined in the property file!
14:05:06,517  WARN main l10n:99 - The key "Overview.MenuFileCreateDBTT" is
not defined in the property file!
14:05:06,527  WARN main resources:27 - Missing resource for
Overview.MenuFileCreateDB.gif
14:05:06,648  WARN main l10n:99 - The key "Overview.AddEdit.TaxonColumn" is
not defined in the property file!
14:05:06,648  WARN main l10n:99 - The key "Overview.AddEdit.AuthorColumn" is
not defined in the property file!
14:05:06,648  WARN main l10n:99 - The key "Overview.AddEdit.DateColumn" is
not defined in the property file!
14:05:07,559  WARN main l10n:99 - The key "AddEdit.All" is not defined in
the property file!
14:05:07,559  WARN main l10n:99 - The key "AddEdit.JustThis" is not defined
in the property file!
14:05:07,579  WARN main l10n:99 - The key "Checklist.Description" is not
defined in the property file!
14:05:07,589  WARN main l10n:99 - The key "AddEdit.ClearLocation" is not
defined in the property file!
14:05:07,589  WARN main l10n:99 - The key "AddEdit.ClearLocationTT" is not
defined in the property file!
14:05:07,589  WARN main l10n:99 - The key "AddEdit.ClearOccurrence" is not
defined in the property file!
14:05:07,589  WARN main l10n:99 - The key "AddEdit.ClearOccurrenceTT" is not
defined in the property file!
14:05:07,599  WARN main l10n:99 - The key "AddEdit.Calendar" is not defined
in the property file!
14:05:07,609  WARN main l10n:99 - The key "AddEdit.CalendarTT" is not
defined in the property file!
14:05:07,979  WARN main l10n:99 - The key "AddEdit.SettingsEnableTT" is not
defined in the property file!
14:05:07,989  WARN main l10n:99 - The key "AddEdit.SettingsDisableTT" is not
defined in the property file!
14:05:08,050  WARN main l10n:99 - The key "Overview.AddEdit.TaxonColumn" is
not defined in the property file!
14:05:08,060  WARN main l10n:99 - The key "Overview.AddEdit.AuthorColumn" is
not defined in the property file!
14:05:08,060  WARN main l10n:99 - The key "Overview.AddEdit.DateColumn" is
not defined in the property file!
14:05:08,450  WARN main l10n:99 - The key "AddEdit.All" is not defined in
the property file!
14:05:08,450  WARN main l10n:99 - The key "AddEdit.JustThis" is not defined
in the property file!
14:05:08,450  WARN main l10n:99 - The key "Checklist.Description" is not
defined in the property file!
14:05:08,460  WARN main l10n:99 - The key "AddEdit.ClearLocation" is not
defined in the property file!
14:05:08,460  WARN main l10n:99 - The key "AddEdit.ClearLocationTT" is not
defined in the property file!
14:05:08,470  WARN main l10n:99 - The key "AddEdit.ClearOccurrence" is not
defined in the property file!
14:05:08,470  WARN main l10n:99 - The key "AddEdit.ClearOccurrenceTT" is not
defined in the property file!
14:05:08,470  WARN main l10n:99 - The key "AddEdit.Calendar" is not defined
in the property file!
14:05:08,470  WARN main l10n:99 - The key "AddEdit.CalendarTT" is not
defined in the property file!
14:05:08,951  WARN main l10n:99 - The key "AddEdit.SettingsEnableTT" is not
defined in the property file!
14:05:08,951  WARN main l10n:99 - The key "AddEdit.SettingsDisableTT" is not
defined in the property file!
14:05:10,042  WARN main l10n:99 - The key "Detail.PrevTT" is not defined in
the property file!
14:05:10,042  WARN main l10n:99 - The key "Detail.NextTT" is not defined in
the property file!
14:05:10,062  WARN main l10n:99 - The key "Overview.Tree.Habitats" is not
defined in the property file!
14:05:10,122  WARN main l10n:99 - The key "Overview.Tree.SearchMenuItem" is
not defined in the property file!
14:05:10,122  WARN main l10n:99 - The key "Overview.Tree.RefreschMenuItem"
is not defined in the property file!
14:05:10,143  WARN main l10n:99 - The key "Overview.Tree.SearchTT" is not
defined in the property file!
14:05:10,153  WARN main l10n:99 - The key "Overview.Tree.Search" is not
defined in the property file!
14:05:10,173  WARN main l10n:99 - The key "Overview.Tree.SearchTT" is not
defined in the property file!
14:05:10,183  WARN main l10n:99 - The key "Overview.Tree.RefreshTT" is not
defined in the property file!
14:05:10,183  WARN main l10n:99 - The key "Overview.Tree.Refresh" is not
defined in the property file!
14:05:10,183  WARN main l10n:99 - The key "Overview.Tree.RefreshTT" is not
defined in the property file!
14:05:10,183  WARN main l10n:99 - The key "Overview.Tree.Add" is not defined
in the property file!
14:05:10,183  WARN main l10n:99 - The key "Overview.Tree.AddTT" is not
defined in the property file!
14:05:10,293  INFO main client:157 - AppCore MVC constructed. Plantlore
client should be visible now.
java.rmi.server.codebase =
file:/C:/Documents%20and%20Settings/yaa/workspace/Plantlore/bin/
14:05:17,583  INFO Thread-6 middleware:108 - New DBLayer created:  @
localhost (direct connection)
14:05:17,723  INFO Thread-6 Environment:479 - Hibernate 3.1.3
14:05:17,753  INFO Thread-6 Environment:509 - hibernate.properties not found
14:05:17,753  INFO Thread-6 Environment:525 - using CGLIB reflection
optimizer
14:05:17,763  INFO Thread-6 Environment:555 - using JDK 1.4
java.sql.Timestamp handling
14:05:18,024  INFO Thread-6 Configuration:1308 - configuring from resource:
/hibernate.cfg.xml
14:05:18,024  INFO Thread-6 Configuration:1285 - Configuration resource:
/hibernate.cfg.xml
14:05:18,114  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/AuthorsOccurrences.hbm.xml
14:05:18,464  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.AuthorOccurrence -> TAUTHORSOCCURRENCES
14:05:18,715  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Authors.hbm.xml
14:05:18,825  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Author -> TAUTHORS
14:05:18,835  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Habitats.hbm.xml
14:05:18,935  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Habitat -> THABITATS
14:05:18,945  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/History.hbm.xml
14:05:18,995  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.HistoryRecord -> THISTORY
14:05:19,005  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/HistoryChange.hbm.xml
14:05:19,426  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.HistoryChange -> THISTORYCHANGE
14:05:19,426  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/HistoryColumn.hbm.xml
14:05:19,486  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.HistoryColumn -> THISTORYCOLUMN
14:05:19,486  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Metadata.hbm.xml
14:05:19,556  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Metadata -> TMETADATA
14:05:19,556  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Occurrences.hbm.xml
14:05:19,606  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Occurrence -> TOCCURRENCES
14:05:19,606  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Phytochoria.hbm.xml
14:05:19,646  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Phytochorion -> TPHYTOCHORIA
14:05:19,646  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Plants.hbm.xml
14:05:19,706  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Plant -> TPLANTS
14:05:19,716  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Publications.hbm.xml
14:05:19,756  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Publication -> TPUBLICATIONS
14:05:19,756  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Right.hbm.xml
14:05:19,796  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Right -> TRIGHT
14:05:19,796  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Territories.hbm.xml
14:05:19,826  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.Territory -> TTERRITORIES
14:05:19,826  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/User.hbm.xml
14:05:19,867  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.User -> TUSER
14:05:19,877  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/Villages.hbm.xml
14:05:19,907  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.NearestVillage -> TVILLAGES
14:05:19,907  INFO Thread-6 Configuration:469 - Reading mappings from
resource: net/sf/plantlore/config/hibernate/UnitIdDatabase.hbm.xml
14:05:19,937  INFO Thread-6 HbmBinder:309 - Mapping class:
net.sf.plantlore.common.record.UnitIdDatabase -> TUNITIDDATABASE
14:05:19,947  INFO Thread-6 Configuration:1419 - Configured SessionFactory:
null
14:05:19,977  INFO Thread-6 DriverManagerConnectionProvider:41 - Using
Hibernate built-in connection pool (not for production use!)
14:05:19,987  INFO Thread-6 DriverManagerConnectionProvider:42 - Hibernate
connection pool size: 20
14:05:19,987  INFO Thread-6 DriverManagerConnectionProvider:45 - autocommit
mode: false
14:05:19,997  INFO Thread-6 DriverManagerConnectionProvider:80 - using
driver: org.postgresql.Driver at URL: jdbc:postgresql://localhost:5432/empty
14:05:20,007  INFO Thread-6 DriverManagerConnectionProvider:86 - connection
properties: {user=empty_admin, password=****}
14:05:20,758  INFO Thread-6 SettingsFactory:77 - RDBMS: PostgreSQL, version:
8.1.4
14:05:20,768  INFO Thread-6 SettingsFactory:78 - JDBC driver: PostgreSQL
Native Driver, version: PostgreSQL 8.0 JDBC2 with NO SSL (build 311)
14:05:20,848  INFO Thread-6 Dialect:103 - Using dialect:
org.hibernate.dialect.PostgreSQLDialect
14:05:20,868  INFO Thread-6 TransactionFactoryFactory:31 - Using default
transaction strategy (direct JDBC transactions)
14:05:20,878  INFO Thread-6 TransactionManagerLookupFactory:33 - No
TransactionManagerLookup configured (in JTA environment, use of read-write
or transactional second-level cache is not recommended)
14:05:20,888  INFO Thread-6 SettingsFactory:125 - Automatic flush during
beforeCompletion(): disabled
14:05:20,888  INFO Thread-6 SettingsFactory:129 - Automatic session close at
end of transaction: disabled
14:05:20,888  INFO Thread-6 SettingsFactory:136 - JDBC batch size: 15
14:05:20,888  INFO Thread-6 SettingsFactory:139 - JDBC batch updates for
versioned data: disabled
14:05:20,898  INFO Thread-6 SettingsFactory:144 - Scrollable result sets:
enabled
14:05:20,898  INFO Thread-6 SettingsFactory:152 - JDBC3 getGeneratedKeys():
disabled
14:05:20,898  INFO Thread-6 SettingsFactory:160 - Connection release mode:
auto
14:05:20,898  INFO Thread-6 SettingsFactory:187 - Default batch fetch size:
1
14:05:20,908  INFO Thread-6 SettingsFactory:191 - Generate SQL with
comments: disabled
14:05:20,908  INFO Thread-6 SettingsFactory:195 - Order SQL updates by
primary key: disabled
14:05:20,908  INFO Thread-6 SettingsFactory:338 - Query translator:
org.hibernate.hql.ast.ASTQueryTranslatorFactory
14:05:20,918  INFO Thread-6 ASTQueryTranslatorFactory:24 - Using
ASTQueryTranslatorFactory
14:05:20,918  INFO Thread-6 SettingsFactory:203 - Query language
substitutions: {}
14:05:20,918  INFO Thread-6 SettingsFactory:209 - Second-level cache:
enabled
14:05:20,918  INFO Thread-6 SettingsFactory:213 - Query cache: disabled
14:05:20,918  INFO Thread-6 SettingsFactory:325 - Cache provider:
org.hibernate.cache.EhCacheProvider
14:05:20,928  INFO Thread-6 SettingsFactory:228 - Optimize cache for minimal
puts: disabled
14:05:20,928  INFO Thread-6 SettingsFactory:237 - Structured second-level
cache entries: disabled
14:05:20,958  INFO Thread-6 SettingsFactory:264 - Statistics: disabled
14:05:20,958  INFO Thread-6 SettingsFactory:268 - Deleted entity synthetic
identifier rollback: disabled
14:05:20,958  INFO Thread-6 SettingsFactory:283 - Default entity-mode: pojo
14:05:21,048  INFO Thread-6 SessionFactoryImpl:154 - building session
factory
14:05:21,078  WARN Thread-6 Configurator:126 - No configuration found.
Configuring ehcache from ehcache-failsafe.xml found in the classpath:
jar:file:/C:/Documents%20and%20Settings/yaa/workspace/Plantlore/lib/ehcache-
1.1.jar!/ehcache-failsafe.xml
14:05:23,221  INFO Thread-6 SessionFactoryObjectFactory:82 - Not binding
factory to JNDI, no JNDI name configured
14:05:23,732  INFO Thread-6 client:153 - Loading dialog data ...
Processing projection for: taxon
Processing projection for: id
Processing projection for: wholeName
Processing projection for: id
Processing projection for: name
Processing projection for: id
14:05:24,533  INFO Thread-6 client:495 - Loaded: 6306 villages.
Processing projection for: name
Processing projection for: code
Processing projection for: id
14:05:24,593  INFO Thread-6 client:560 - Loaded: 263 phytochoria.
Processing projection for: name
Processing projection for: id
14:05:24,613  INFO Thread-6 client:526 - Loaded: 10 territories.
Processing projection for: country
Processing projection for: dataSource
Processing projection for: referenceCitation
Processing projection for: id
Processing projection for: dataSetTitle
Processing projection for: id
Processing projection for: occ.id
Processing projection for: plant.taxon
Processing projection for: author.wholeName
Processing projection for: vill.name
Processing projection for: occ.yearCollected
Processing projection for: phyt.name
Processing projection for: habitat.description
Processing projection for: territory.name
returning resultid 10
returning resultid 10
14:05:51,322  INFO Thread-7 tableimport:84 - Table Import begins...
14:08:50,069  INFO Thread-7 tableimport:168 - Import completed. 5645 records
processed (5645 inserted, 0 updated, 0 deleted).
Processing projection for: taxon
Processing projection for: id
14:08:50,509  INFO Thread-7 client:403 - Loaded: 5645 plants.
14:08:54,285  WARN AWT-EventQueue-0 l10n:99 - The key "
Overview.CoordinateSystemLabel" is not defined in the property file!
14:08:54,355  WARN AWT-EventQueue-0 l10n:99 - The key "
Overview.CoordinateSystemLabel" is not defined in the property file!
14:08:56,087  WARN AWT-EventQueue-0 resources:27 - Missing resource for
Load.gif
14:08:56,087  WARN AWT-EventQueue-0 resources:27 - Missing resource for
Save.gif
14:08:56,097  WARN AWT-EventQueue-0 resources:27 - Missing resource for
Clear.gif
14:08:56,127  WARN AWT-EventQueue-0 resources:27 - Missing resource for
Restore.gif
14:10:06,118  INFO AWT-EventQueue-0 overview:665 - AddEdit dialog cancelled
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)14:10:31,334 FATAL Thread-8 common:476 - The counterpart for the
Plant.taxon = Taraxacum sp.; Plant.genus = Taraxacum; Plant.species =
Taraxacum sp.; Plant.scientificNameAuthor = null; Plant.czechName =
pampeli?ka; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = TARSPK52lP4u;  (in the immutable table
Plant) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Zru?eno u?ivatelem.
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.<init>(
OccurrenceImportTask.java:40)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMng.createOccurrenceImportTask
(OccurrenceImportMng.java:103)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMngCtrl.setVisible(
OccurrenceImportMngCtrl.java:52)
    at net.sf.plantlore.client.AppCoreCtrl$ImportAction.actionPerformed(
AppCoreCtrl.java:607)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown
Source)
    at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Zru?eno u?ivatelem.
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.<init>(
OccurrenceImportTask.java:40)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMng.createOccurrenceImportTask
(OccurrenceImportMng.java:103)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMngCtrl.setVisible(
OccurrenceImportMngCtrl.java:52)
    at net.sf.plantlore.client.AppCoreCtrl$ImportAction.actionPerformed(
AppCoreCtrl.java:607)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown
Source)
    at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
Processing projection for: wholeName
Processing projection for: id
Processing projection for: country
Processing projection for: dataSetTitle
Processing projection for: id
Processing projection for: dataSource
Dispatcher: true
Processing projection for: referenceCitation
Processing projection for: id
INTERRUPTED while loading Image
Processing projection for: occ.id
Processing projection for: plant.taxon
Processing projection for: author.wholeName
Processing projection for: vill.name
Processing projection for: occ.yearCollected
Processing projection for: phyt.name
Processing projection for: habitat.description
Processing projection for: territory.name
returning resultid 5669
returning resultid 5669
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
14:10:36,632 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Taraxacum sp.; Plant.genus = Taraxacum; Plant.species =
Taraxacum sp.; Plant.scientificNameAuthor = null; Plant.czechName =
pampeli?ka; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = TARSPK52lP4u;  (in the immutable table
Plant) was not found!
14:10:36,772 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Taraxacum sp.; Plant.genus = Taraxacum; Plant.species =
Taraxacum sp.; Plant.scientificNameAuthor = null; Plant.czechName =
pampeli?ka; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = TARSPK52lP4u;  (in the immutable table
Plant) was not found!
14:10:36,912 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Taraxacum sp.; Plant.genus = Taraxacum; Plant.species =
Taraxacum sp.; Plant.scientificNameAuthor = null; Plant.czechName =
pampeli?ka; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = TARSPK52lP4u;  (in the immutable table
Plant) was not found!
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)14:10:37,774 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Taraxacum sp.; Plant.genus = Taraxacum; Plant.species =
Taraxacum sp.; Plant.scientificNameAuthor = null; Plant.czechName =
pampeli?ka; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = TARSPK52lP4u;  (in the immutable table
Plant) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)14:10:45,134 FATAL Thread-10 common:476 - The
counterpart for the Phytochorion.code = .; Phytochorion.name = .;  (in the
immutable table Phytochorion) was not found!

    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
14:10:46,626 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)14:10:46,696 FATAL Thread-10 common:476 - The
counterpart for the Phytochorion.code = .; Phytochorion.name = .;  (in the
immutable table Phytochorion) was not found!
14:10:47,357 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Erigeron acris agg.; Plant.genus = Erigeron; Plant.species =
Erigeron acris agg.; Plant.scientificNameAuthor = null; Plant.czechName =
turan; Plant.synonyms = incl. Erigeron acris, E. angulosus, E. macrophyllus,
E. muralis, E. podolicus; Plant.note = Vydal: 6VWEc, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = ERIACRTbx2mP;  (in the immutable table Plant) was not
found!
14:10:48,669 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Pulmonaria officinalis agg.; Plant.genus = Pulmonaria;
Plant.species = Pulmonaria officinalis agg.; Plant.scientificNameAuthor =
null; Plant.czechName = plicn?k; Plant.synonyms = incl. Pulmonaria obscura,
P. offcinalis; Plant.note = Vydal: JD, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = PULOFFvC57e0;  (in the immutable table Plant) was not
found!

    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)14:10:50,372 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!

    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:50,532 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:51,003 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:52,054 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Galium palustre agg.; Plant.genus = Galium; Plant.species =
Galium palustre agg.; Plant.scientificNameAuthor = null; Plant.czechName =
sv?zel; Plant.synonyms = incl. Galium elongatum, G. palustre; Plant.note =
Vydal: 6VWEc, Soubor: cevt_r_sp2.dbf; Plant.surveyTaxId = GALPAL266agE;  (in
the immutable table Plant) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:52,905 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:54,758 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Alchemilla sp.; Plant.genus = Alchemilla; Plant.species =
Alchemilla sp.; Plant.scientificNameAuthor = null; Plant.czechName =
kontryhel xxx; Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor:
cevt_r_sp2.dbf; Plant.surveyTaxId = ALCSPKgwuoM2;  (in the immutable table
Plant) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:54,838 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:55,449 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Rubus sp.; Plant.genus = Rubus; Plant.species = Rubus sp.;
Plant.scientificNameAuthor = null; Plant.czechName = ostru?in?k;
Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = RUBSPKg1wxkP;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:55,559 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Rubus sp.; Plant.genus = Rubus; Plant.species = Rubus sp.;
Plant.scientificNameAuthor = null; Plant.czechName = ostru?in?k;
Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = RUBSPKg1wxkP;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:59,255 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Rubus sp.; Plant.genus = Rubus; Plant.species = Rubus sp.;
Plant.scientificNameAuthor = null; Plant.czechName = ostru?in?k;
Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = RUBSPKg1wxkP;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:59,415 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Rubus sp.; Plant.genus = Rubus; Plant.species = Rubus sp.;
Plant.scientificNameAuthor = null; Plant.czechName = ostru?in?k;
Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = RUBSPKg1wxkP;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:10:59,695 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Rubus sp.; Plant.genus = Rubus; Plant.species = Rubus sp.;
Plant.scientificNameAuthor = null; Plant.czechName = ostru?in?k;
Plant.synonyms = null; Plant.note = Vydal: JNTR, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = RUBSPKg1wxkP;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)14:11:01,147 FATAL Thread-10 common:476 - The counterpart for the
Plant.taxon = Pulmonaria officinalis agg.; Plant.genus = Pulmonaria;
Plant.species = Pulmonaria officinalis agg.; Plant.scientificNameAuthor =
null; Plant.czechName = plicn?k; Plant.synonyms = incl. Pulmonaria obscura,
P. offcinalis; Plant.note = Vydal: JD, Soubor: cevt_r_sp2.dbf;
Plant.surveyTaxId = PULOFFvC57e0;  (in the immutable table Plant) was not
found!

    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
14:11:05,634 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!
14:11:05,684 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!
14:11:05,704 FATAL Thread-10 common:476 - The counterpart for the
Phytochorion.code = .; Phytochorion.name = .;  (in the immutable table
Phytochorion) was not found!
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)14:11:06,054
FATAL Thread-10 common:476 - The counterpart for the Phytochorion.code = .;
Phytochorion.name = .;  (in the immutable table Phytochorion) was not found!

    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Z?znam nenalezen.
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:478)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.insert(DBLayerUtils.java:492)
    at net.sf.plantlore.common.DBLayerUtils.processRecord(DBLayerUtils.java
:1006)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.processRecord(
OccurrenceImportTask.java:123)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.endElement
(XMLOccurrenceParser.java:182)
    at
com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.endElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLNSDocumentScannerImpl.scanEndElement(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl$FragmentContentDispatcher.dispatch(Unknown
Source)
    at
com.sun.org.apache.xerces.internal.impl.XMLDocumentFragmentScannerImpl.scanDocument(Unknown
Source)Processing projection for: wholeName
Processing projection for: id
14:11:06,305  INFO Thread-10 client:436 - Loaded: 3 authors.
Processing projection for: country
14:11:06,395  INFO Thread-10 client:613 - Loaded: 1 countries.
Processing projection for: dataSetTitle
Processing projection for: id
14:11:06,415  INFO Thread-10 client:742 - Loaded: 1 projects.
Processing projection for: dataSource
14:11:06,425  INFO Thread-10 client:659 - Loaded: 1 sources.
Dispatcher: true
Processing projection for: referenceCitation
Processing projection for: id
Processing projection for: occ.id
Processing projection for: plant.taxon
Processing projection for: author.wholeName
Processing projection for: vill.name
Processing projection for: occ.yearCollected
Processing projection for: phyt.name
Processing projection for: habitat.description
Processing projection for: territory.name
14:11:06,795  INFO Thread-10 client:709 - Loaded: 1 publications.
returning resultid 6762
returning resultid 6762
returning resultid 6762

    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XML11Configuration.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.XMLParser.parse(Unknown
Source)
    at com.sun.org.apache.xerces.internal.parsers.AbstractSAXParser.parse(Unknown
Source)
    at
net.sf.plantlore.client.occurrenceimport.parsers.XMLOccurrenceParser.startParsing
(XMLOccurrenceParser.java:90)
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.task(
OccurrenceImportTask.java:77)
    at net.sf.plantlore.common.Task$1.construct(Task.java:190)
    at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
    at java.lang.Thread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Zru?eno u?ivatelem.
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.<init>(
OccurrenceImportTask.java:40)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMng.createOccurrenceImportTask
(OccurrenceImportMng.java:103)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMngCtrl.setVisible(
OccurrenceImportMngCtrl.java:52)
    at net.sf.plantlore.client.AppCoreCtrl$ImportAction.actionPerformed(
AppCoreCtrl.java:607)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.menuDragMouseReleased(Unknown
Source)
    at javax.swing.JMenuItem.fireMenuDragMouseReleased(Unknown Source)
    at javax.swing.JMenuItem.processMenuDragMouseEvent(Unknown Source)
    at javax.swing.JMenuItem.processMouseEvent(Unknown Source)
    at javax.swing.MenuSelectionManager.processMouseEvent(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown
Source)
    at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
net.sf.plantlore.common.exception.DBLayerException: Zru?eno u?ivatelem.
    at net.sf.plantlore.client.occurrenceimport.OccurrenceImportTask.<init>(
OccurrenceImportTask.java:40)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMng.createOccurrenceImportTask
(OccurrenceImportMng.java:103)
    at
net.sf.plantlore.client.occurrenceimport.OccurrenceImportMngCtrl.setVisible(
OccurrenceImportMngCtrl.java:52)
    at net.sf.plantlore.client.AppCoreCtrl$ImportAction.actionPerformed(
AppCoreCtrl.java:607)
    at javax.swing.AbstractButton.fireActionPerformed(Unknown Source)
    at javax.swing.AbstractButton$Handler.actionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.fireActionPerformed(Unknown Source)
    at javax.swing.DefaultButtonModel.setPressed(Unknown Source)
    at javax.swing.AbstractButton.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI.doClick(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.menuDragMouseReleased(Unknown
Source)
    at javax.swing.JMenuItem.fireMenuDragMouseReleased(Unknown Source)
    at javax.swing.JMenuItem.processMenuDragMouseEvent(Unknown Source)
    at javax.swing.JMenuItem.processMouseEvent(Unknown Source)
    at javax.swing.MenuSelectionManager.processMouseEvent(Unknown Source)
    at javax.swing.plaf.basic.BasicMenuItemUI$Handler.mouseReleased(Unknown
Source)
    at java.awt.AWTEventMulticaster.mouseReleased(Unknown Source)
    at java.awt.Component.processMouseEvent(Unknown Source)
    at javax.swing.JComponent.processMouseEvent(Unknown Source)
    at java.awt.Component.processEvent(Unknown Source)
    at java.awt.Container.processEvent(Unknown Source)
    at java.awt.Component.dispatchEventImpl(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.LightweightDispatcher.retargetMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.processMouseEvent(Unknown Source)
    at java.awt.LightweightDispatcher.dispatchEvent(Unknown Source)
    at java.awt.Container.dispatchEventImpl(Unknown Source)
    at java.awt.Window.dispatchEventImpl(Unknown Source)
    at java.awt.Component.dispatchEvent(Unknown Source)
    at java.awt.EventQueue.dispatchEvent(Unknown Source)
    at java.awt.EventDispatchThread.pumpOneEventForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEventsForHierarchy(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.pumpEvents(Unknown Source)
    at java.awt.EventDispatchThread.run(Unknown Source)
14:11:12,824  INFO AWT-EventQueue-0 middleware:169 - The DBLayer (Lada Jose
(admin) @ localhost (direct connection)) has been destroyed.
14:11:12,824  INFO AWT-EventQueue-0 SessionFactoryImpl:729 - closing
14:11:12,824  INFO AWT-EventQueue-0 DriverManagerConnectionProvider:147 -
cleaning up connection pool: jdbc:postgresql://localhost:5432/empty
14:11:12,844  INFO AWT-EventQueue-0 server:2297 - Database layer destroyed
properly. It will not be available any longer.
14:11:12,844  INFO AWT-EventQueue-0 login:373 - The client disconnected
itself from the server. The communication may no longer be possible.
14:11:12,844  INFO AWT-EventQueue-0 client:338 - Saving main window
preferences.



Who knows which records were rejected and why?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060904/9ed69fc1/attachment.html>

From krater at mail.berlios.de  Mon Sep  4 14:40:42 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 14:40:42 +0200
Subject: [Plantlore-dev] r663 - trunk/src/net/sf/plantlore/client/tableimport
Message-ID: <200609041240.k84Cegst031080@sheep.berlios.de>

Author: krater
Date: 2006-09-04 14:40:38 +0200 (Mon, 04 Sep 2006)
New Revision: 663

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
Log:
The number of rejected records displayed properly.

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 12:17:58 UTC (rev 662)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-04 12:40:38 UTC (rev 663)
@@ -92,9 +92,9 @@
 		while( !isCanceled() && parser.hasNext() ) {
 			DataHolder data = null;
 			try {
-				count++;
 				setPosition( count );
 				setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, (count - deleted - updated - inserted) ));
+				count++;
 				data = parser.getNext();
 			} catch( ParserException pe ) {
 				logger.warn("The record is corrupted. " + pe);



From fraktalek at mail.berlios.de  Mon Sep  4 14:44:47 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 14:44:47 +0200
Subject: [Plantlore-dev] r664 - in trunk/src/net/sf/plantlore: client
	client/overview client/overview/tree l10n
Message-ID: <200609041244.k84Cilbb032630@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 14:44:43 +0200 (Mon, 04 Sep 2006)
New Revision: 664

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/overview/AddEditView.form
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Plantlore window now opens bigger.
A few new localized strings.
Fixed overview to correctly close sessions if some table is empty.
Habitat tree now works with empty database too.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-04 12:44:43 UTC (rev 664)
@@ -387,6 +387,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             plants = null;
             return null;
         }
@@ -422,6 +423,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             authors = null;
             return null;
         }
@@ -481,7 +483,8 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
-            villages = null;
+           database.closeQuery(sq);
+           villages = null;
             return null;
         }
         records = database.more(resultid, 0, resultsCount-1);
@@ -512,6 +515,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             territories = null;
             return null;
         }
@@ -543,6 +547,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             phytNames = null;
             phytCodes = null;
             return null;
@@ -592,6 +597,7 @@
         resultid = database.executeQuery(sq); // the values can be doubled, we need to filter them 
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             countries = null;
             return null;
         }
@@ -639,6 +645,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             sources = null;
             return null;
         }
@@ -688,6 +695,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             publications = null;
             return null;
         }
@@ -727,6 +735,7 @@
         resultid = database.executeQuery(sq);
         resultsCount = database.getNumRows(resultid);
         if (resultsCount == 0) {
+            database.closeQuery(sq);
             projects = null;
             return null;
         }

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-04 12:44:43 UTC (rev 664)
@@ -254,10 +254,10 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Component id="mainToolBar" alignment="0" pref="679" max="32767" attributes="0"/>
+          <Component id="mainToolBar" alignment="0" pref="815" max="32767" attributes="0"/>
           <Component id="overviewPanel" alignment="1" max="32767" attributes="0"/>
           <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
-          <Component id="pageToolBar" alignment="0" pref="679" max="32767" attributes="0"/>
+          <Component id="pageToolBar" alignment="0" pref="815" max="32767" attributes="0"/>
           <Component id="jPanel4" alignment="0" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
@@ -378,7 +378,7 @@
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="0" attributes="0">
                   <Component id="statusLabel" min="-2" max="-2" attributes="0"/>
-                  <EmptySpace pref="268" max="32767" attributes="0"/>
+                  <EmptySpace pref="404" max="32767" attributes="0"/>
                   <Component id="progressBar" min="-2" pref="314" max="-2" attributes="0"/>
               </Group>
           </Group>
@@ -453,7 +453,7 @@
                       <Component id="recordsPerPage" min="-2" pref="45" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="nextPage" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="216" max="32767" attributes="0"/>
+                      <EmptySpace pref="352" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -532,12 +532,12 @@
       <Layout>
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="1" pref="679" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="1" pref="815" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="85" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="439" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>
@@ -575,7 +575,7 @@
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="1" attributes="0">
-                  <EmptySpace pref="537" max="32767" attributes="0"/>
+                  <EmptySpace pref="673" max="32767" attributes="0"/>
                   <Component id="recordsCountLabel" min="-2" max="-2" attributes="0"/>
                   <EmptySpace max="-2" attributes="0"/>
                   <Component id="recordsCount" min="-2" max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-04 12:44:43 UTC (rev 664)
@@ -166,7 +166,7 @@
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
                 .add(statusLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 268, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 404, Short.MAX_VALUE)
                 .add(progressBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 314, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         jPanel1Layout.setVerticalGroup(
@@ -212,7 +212,7 @@
                 .add(recordsPerPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(nextPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(216, Short.MAX_VALUE))
+                .addContainerGap(352, Short.MAX_VALUE))
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -249,11 +249,11 @@
         overviewPanel.setLayout(overviewPanelLayout);
         overviewPanelLayout.setHorizontalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 679, Short.MAX_VALUE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 815, Short.MAX_VALUE)
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 85, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 439, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");
@@ -269,7 +269,7 @@
         jPanel4Layout.setHorizontalGroup(
             jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel4Layout.createSequentialGroup()
-                .addContainerGap(537, Short.MAX_VALUE)
+                .addContainerGap(673, Short.MAX_VALUE)
                 .add(recordsCountLabel)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(recordsCount)
@@ -401,10 +401,10 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(mainToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 679, Short.MAX_VALUE)
+            .add(mainToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 815, Short.MAX_VALUE)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, overviewPanel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
             .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-            .add(pageToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 679, Short.MAX_VALUE)
+            .add(pageToolBar, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 815, Short.MAX_VALUE)
             .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
         );
         layout.setVerticalGroup(

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-04 12:44:43 UTC (rev 664)
@@ -86,7 +86,7 @@
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Component id="jPanel7" alignment="0" min="-2" max="-2" attributes="3"/>
-                              <Component id="jPanel5" alignment="0" min="-2" max="-2" attributes="1"/>
+                              <Component id="jPanel5" alignment="0" min="-2" pref="914" max="-2" attributes="1"/>
                           </Group>
                           <EmptySpace max="32767" attributes="0"/>
                       </Group>
@@ -169,7 +169,7 @@
                                                       <EmptySpace min="-2" pref="434" max="-2" attributes="0"/>
                                                   </Group>
                                                   <Group type="102" attributes="0">
-                                                      <Component id="jScrollPane2" pref="541" max="32767" attributes="1"/>
+                                                      <Component id="jScrollPane2" pref="561" max="32767" attributes="1"/>
                                                       <EmptySpace max="-2" attributes="0"/>
                                                   </Group>
                                               </Group>
@@ -612,13 +612,13 @@
                                       <Group type="103" groupAlignment="0" attributes="0">
                                           <Group type="102" alignment="0" attributes="0">
                                               <Component id="checklistButton" linkSize="21" min="-2" max="-2" attributes="0"/>
-                                              <EmptySpace pref="340" max="32767" attributes="0"/>
+                                              <EmptySpace pref="232" max="32767" attributes="0"/>
                                               <Component id="clearOccurrenceButton" linkSize="21" min="-2" max="-2" attributes="0"/>
                                           </Group>
                                           <Component id="jPanel4" min="-2" max="-2" attributes="1"/>
                                       </Group>
                                   </Group>
-                                  <Component id="jScrollPane1" pref="658" max="32767" attributes="1"/>
+                                  <Component id="jScrollPane1" pref="645" max="32767" attributes="1"/>
                               </Group>
                               <EmptySpace max="-2" attributes="0"/>
                               <Group type="103" groupAlignment="0" attributes="0">
@@ -631,11 +631,11 @@
                                       </Group>
                                       <EmptySpace max="-2" attributes="0"/>
                                       <Group type="103" groupAlignment="0" attributes="0">
-                                          <Component id="herbariumTextField" alignment="0" pref="146" max="32767" attributes="1"/>
-                                          <Component id="publicationCombo" alignment="0" pref="146" max="32767" attributes="1"/>
-                                          <Component id="projectCombo" alignment="0" pref="146" max="32767" attributes="1"/>
+                                          <Component id="herbariumTextField" alignment="0" pref="132" max="32767" attributes="1"/>
+                                          <Component id="publicationCombo" alignment="0" pref="132" max="32767" attributes="1"/>
+                                          <Component id="projectCombo" alignment="0" pref="132" max="32767" attributes="1"/>
                                           <Group type="102" alignment="0" attributes="0">
-                                              <Component id="sourceCombo" pref="146" max="32767" attributes="1"/>
+                                              <Component id="sourceCombo" pref="132" max="32767" attributes="1"/>
                                               <EmptySpace max="-2" attributes="0"/>
                                           </Group>
                                       </Group>
@@ -1067,7 +1067,7 @@
                           <Component id="settingsButton" linkSize="12" min="-2" max="-2" attributes="0"/>
                           <EmptySpace min="-2" pref="64" max="-2" attributes="0"/>
                           <Component id="requiredInfoLabel" min="-2" max="-2" attributes="0"/>
-                          <EmptySpace pref="436" max="32767" attributes="0"/>
+                          <EmptySpace pref="350" max="32767" attributes="0"/>
                           <Component id="okButton" linkSize="12" min="-2" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="cancelButton" linkSize="12" min="-2" max="-2" attributes="0"/>
@@ -1086,7 +1086,7 @@
                               <Component id="okButton" linkSize="13" alignment="3" min="-2" max="-2" attributes="0"/>
                               <Component id="requiredInfoLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                           </Group>
-                          <EmptySpace pref="16" max="32767" attributes="0"/>
+                          <EmptySpace pref="13" max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -1162,7 +1162,7 @@
                   <Group type="103" groupAlignment="0" attributes="0">
                       <Group type="102" alignment="0" attributes="0">
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="jScrollPane6" pref="905" max="32767" attributes="0"/>
+                          <Component id="jScrollPane6" pref="906" max="32767" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                       </Group>
                   </Group>

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-04 12:44:43 UTC (rev 664)
@@ -994,6 +994,8 @@
         phytNameLabel.setText(L10n.getString("AddEdit.PhytNameLabel")+REQUIRED_STRING);
         quadrantLabel.setText(L10n.getString("AddEdit.QuadrantLabel"));
         countryLabel.setText(L10n.getString("AddEdit.CountryLabel"));
+        occurrenceNoteLabel.setText(L10n.getString("AddEdit.OccurrenceNoteLabel"));
+        locationNoteLabel.setText(L10n.getString("AddEdit.LocationNoteLabel"));
         
         altitudeLabel.setText(L10n.getString("AddEdit.AltitudeLabel"));
         latitudeLabel.setText(L10n.getString("AddEdit.LatitudeLabel"));

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-04 12:44:43 UTC (rev 664)
@@ -68,6 +68,10 @@
         
         int resultid = dblayer.executeQuery(query);
         int resultsCount = dblayer.getNumRows(resultid);
+        if (resultsCount <= 0) {
+            dblayer.closeQuery(query);
+            return;
+        }
         Object[] records = (Object[]) dblayer.more(resultid, 0,resultsCount - 1);
         dblayer.closeQuery(query);
         Territory territory;

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 12:44:43 UTC (rev 664)
@@ -1401,7 +1401,7 @@
 
 Overview.MenuFileCreateDB=Create a new database
 
-Overview.MenuFileCreateDB=Creates a new database.
+=Creates a new database.
 
 Search.Extended=&Extended
 
@@ -1487,3 +1487,31 @@
 Login.UserNameTT=The name of the account in the database.
 
 Login.PasswordTT=The password protecting the account.
+
+Overview.HabitatTree=Habitats tree
+
+Overview.HabitatTreeTT=Opens a tree showing a hierarchy of localities
+
+AddEdit.Calendar=Calendar
+
+AddEdit.CalendarTT=Lets you choose a date in a calendar
+
+AddEdit.ClearOccurrence=Clear
+
+AddEdit.ClearOccurrenceTT=Clears the occurrence part of the dialog
+
+AddEdit.ClearLocation=Clear
+
+AddEdit.ClearLocationTT=Vy\u010Dist\u00ED \u010D\u00E1st dialogu ur\u010Duj\u00EDc\u00ED lokalitu n\u00E1lezu
+
+Overview.CoordinateSystemLabel=Coordinate system
+
+Overview.AddEdit.TaxonColumn=Taxon
+
+Overview.AddEdit.AuthorColumn=Authors
+
+Overview.AddEdit.DateColumn=Date
+
+AddEdit.OccurrenceNoteLabel=Occurrence note\:
+
+AddEdit.LocationNoteLabel=Location note\:

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-04 12:44:43 UTC (rev 664)
@@ -1527,7 +1527,7 @@
 
 Overview.MenuFileReconnectTT=Pokus\u00ED se obnovit ztracen\u00E9 spojen\u00ED
 
-Overview.MenuFileExit=Konec
+Overview.MenuFileExit=&Konec
 
 Overview.MenuFileExitTT=Ukon\u010D\u00ED aplikaci
 
@@ -1827,7 +1827,7 @@
 
 Overview.TableImportTT=Zm\u011Bn\u00ED z\u00E1znamy ve vybran\u00FDch tabulk\u00E1ch.
 
-Overview.MenuFileCreateDB=Vytvo\u0159it novou datab\u00E1zi
+=Vytvo\u0159it novou datab\u00E1zi
 
 CreateDB.DatabaseSettings=Nastaven\u00ED datab\u00E1ze
 
@@ -1886,3 +1886,31 @@
 DBLayer.Error.MaxConnections=P\u0159ekro\u010Den maxim\u00E1ln\u00ED po\u010Det u\u017Eivatel\u016F.
 
 DBLayer.Error.Other=Operaci nelze prov\u00E9st.
+
+Overview.HabitatTree=Strom habitat\u016F
+
+Overview.HabitatTreeTT=Otev\u0159e strom zobrazuj\u00EDc\u00ED hierarchii lokalit
+
+AddEdit.Calendar=Kalend\u00E1\u0159
+
+AddEdit.CalendarTT=Umo\u017En\u00ED v\u00E1m vybrat datum v kalend\u00E1\u0159i
+
+AddEdit.ClearOccurrence=Vy\u010Disti
+
+AddEdit.ClearOccurrenceTT=Vy\u010Dist\u00ED \u010D\u00E1st dialogu ur\u010Duj\u00EDc\u00ED taxon, datum, atp.
+
+AddEdit.ClearLocation=Vy\u010Disti
+
+AddEdit.ClearLocationTT=Vy\u010Dist\u00ED \u010D\u00E1st dialogu ur\u010Duj\u00EDc\u00ED lokalitu n\u00E1lezu
+
+Overview.CoordinateSystemLabel=Syst\u00E9m sou\u0159adnic
+
+Overview.AddEdit.TaxonColumn=Taxon
+
+Overview.AddEdit.AuthorColumn=Auto\u0159i
+
+Overview.AddEdit.DateColumn=Datum
+
+AddEdit.OccurrenceNoteLabel=Pozn\u00E1mka k n\u00E1lezu\:
+
+AddEdit.LocationNoteLabel=Pozn\u00E1mka k lokalit\u011B\:

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-04 12:40:38 UTC (rev 663)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-04 12:44:43 UTC (rev 664)
@@ -1236,3 +1236,31 @@
 Login.HostName=Hostname
 
 Login.HostNameTT=The name of the computer where the server dwells.
+
+Overview.HabitatTree=Habitats tree
+
+Overview.HabitatTreeTT=Opens a tree showing a hierarchy of localities
+
+AddEdit.Calendar=Calendar
+
+AddEdit.CalendarTT=Lets you choose a date in a calendar
+
+AddEdit.ClearOccurrence=Clear
+
+AddEdit.ClearOccurrenceTT=Clears the occurrence part of the dialog
+
+AddEdit.ClearLocation=Clear
+
+AddEdit.ClearLocationTT=Vy\u010Dist\u00ED \u010D\u00E1st dialogu ur\u010Duj\u00EDc\u00ED lokalitu n\u00E1lezu
+
+Overview.CoordinateSystemLabel=Coordinate system
+
+Overview.AddEdit.TaxonColumn=Taxon
+
+Overview.AddEdit.AuthorColumn=Authors
+
+Overview.AddEdit.DateColumn=Date
+
+AddEdit.OccurrenceNoteLabel=Occurrence note\:
+
+AddEdit.LocationNoteLabel=Location note\:



From kovo at mail.berlios.de  Mon Sep  4 14:51:23 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 4 Sep 2006 14:51:23 +0200
Subject: [Plantlore-dev] r665 - trunk/src/net/sf/plantlore/client/user
Message-ID: <200609041251.k84CpNRS002092@sheep.berlios.de>

Author: kovo
Date: 2006-09-04 14:51:20 +0200 (Mon, 04 Sep 2006)
New Revision: 665

Modified:
   trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
Log:
Modify user manager to use new progressbars

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-04 12:44:43 UTC (rev 664)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-04 12:51:20 UTC (rev 665)
@@ -21,6 +21,8 @@
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 
@@ -247,7 +249,25 @@
            model.setUsedClose(true);
            //save new record Metadata into database
            Task task = model.addUserRecord();
+           task.setPostTaskAction(new PostTaskAction() {
+               public void afterStopped(Object value) {
+                   if (! model.isFinishedTask()) return;
+                   model.setInfoFinishedTask(false);
+                   //load data
+                   model.searchUser(false);
+                   if (model.isError()) {
+                       DefaultExceptionHandler.handle(view, model.getException());
+                       model.setError(null);
+                       model.setException(null);
+                       return;
+                   }
+                   reloadData(1, model.getDisplayRows());
+               }
+               
+           });
+           Dispatcher.getDispatcher().dispatch(task, view, false);
            
+/*           
            new DefaultProgressBar(task, view, true) {		   							 
    			   @Override
         	   public void afterStopping() {
@@ -264,7 +284,8 @@
     	           reloadData(1, model.getDisplayRows());    	             	           
                } 		   		
    		};   			                   	                   
-        task.start();                                       
+            task.start();                                       
+ */
        }
     }
         	 
@@ -308,7 +329,20 @@
                model.setUsedClose(true);
                //Update User               
                Task task = model.editUserRecord();
+               task.setPostTaskAction(new PostTaskAction() {
+                   public void afterStopped(Object value) {
+                       if (! model.isFinishedTask()) return;
+                       model.setInfoFinishedTask(false);
+                       //load User
+                       if (model.isError()) return;
+                       view.tableUserList.setModel(new UserManagerTableModel(model));
+                   }
+                   
+               });
+               Dispatcher.getDispatcher().dispatch(task, view, false);
+
                
+/*               
                new DefaultProgressBar(task, view, true) {		   							 
           		   @Override
             	   public void afterStopping() {
@@ -320,6 +354,7 @@
                      } 		   					
           		};          			                   	                  
                 task.start();                                       
+ */
               }
        }
     }
@@ -390,31 +425,50 @@
                }
                int okCancle = view.showQuestionMessage(UserManager.QUESTION_DELETE_TITLE, UserManager.QUESTION_DELETE);               
                if (okCancle == 0){
-            	   //Button OK was press
-            	   logger.debug("Button OK was press.");
-	               //Delete selected record
-	               Task task = model.deleteUserRecord();
-	               
-	               new DefaultProgressBar(task, view, true) {		   								  		   									
-					   @Override
-	            	   public void afterStopping() {
+                   //Button OK was press
+                   logger.debug("Button OK was press.");
+                   //Delete selected record
+                   Task task = model.deleteUserRecord();
+                   task.setPostTaskAction(new PostTaskAction() {
+
+                       public void afterStopped(Object value) {
+                           if (! model.isFinishedTask()) return;
+                           model.setInfoFinishedTask(false);
+                           // load User
+                           model.searchUser(false);
+                           if (model.isError()) {
+                               DefaultExceptionHandler.handle(view, model.getException());
+                               model.setError(null);
+                               model.setException(null);
+                               return;
+                           }
+                           reloadData(1, model.getDisplayRows());
+                       }
+                   });
+                   Dispatcher.getDispatcher().dispatch(task, view, false);
+                   
+/*
+                       new DefaultProgressBar(task, view, true) {
+                                           @Override
+                           public void afterStopping() {
                                    if (! model.isFinishedTask()) return;
                                         model.setInfoFinishedTask(false);
                                        // load User
-		   	               model.searchUser(false); 
-		   	               if (model.isError()) {
-		    	        	   DefaultExceptionHandler.handle(view, model.getException());
+                                       model.searchUser(false);
+                                       if (model.isError()) {
+                                           DefaultExceptionHandler.handle(view, model.getException());
                                            model.setError(null);
                                            model.setException(null);
-		    	        	   return;
-		    	           }    	
-		   	               reloadData(1, model.getDisplayRows());		   	               		   	              
-	                      }
-			   			};			   			                   	                   
-			            task.start();                                                                  
-		          }else {
-		        	  logger.debug("Button Cancle was press.");
-		          }	           
+                                           return;
+                                   }
+                                       reloadData(1, model.getDisplayRows());
+                              }
+                                                };
+                                    task.start();
+ */
+               }else {
+                   logger.debug("Button Cancle was press.");
+               }
            }
        }
    }    	       
@@ -445,7 +499,24 @@
                      
            //Load User with specific conditions
            Task task = model.searchUser(true);   
-           
+           task.setPostTaskAction(new PostTaskAction() {
+               public void afterStopped(Object value) {
+                   if (! model.isFinishedTask()) return;
+                   model.setInfoFinishedTask(false);
+                   if (model.getDisplayRows() <= 0) {
+                       model.setDisplayRows(UserManager.DEFAULT_DISPLAY_ROWS);
+                   }
+                   //No record in result - show message to user
+                   if (model.getResultRows() < 1) {
+                       view.showInfoMessage(UserManager.INFORMATION_RESULT_TITLE,UserManager.INFORMATION_RESULT);
+                   }
+                   reloadData(1, model.getDisplayRows());
+               }
+               
+           });
+           Dispatcher.getDispatcher().dispatch(task, view, false);
+
+/*
            new DefaultProgressBar(task, view, true) {		   								  						    
         	   @Override
         	   public void afterStopping() {
@@ -462,7 +533,8 @@
                } 		   					
 			};				                   	                   
             task.start();                                                                  
-       }
+ */
+        }
     }
 
     /**



From fraktalek at mail.berlios.de  Mon Sep  4 20:37:22 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 20:37:22 +0200
Subject: [Plantlore-dev] r666 - in trunk/src/net/sf/plantlore: client
	client/overview client/settings config
Message-ID: <200609041837.k84IbMdX006433@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 20:37:08 +0200 (Mon, 04 Sep 2006)
New Revision: 666

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/overview/OverviewTableModel.java
   trunk/src/net/sf/plantlore/client/settings/SettingsView.form
   trunk/src/net/sf/plantlore/client/settings/SettingsView.java
   trunk/src/net/sf/plantlore/config/log4j.properties
Log:
Removed SwingUtilities call from AppCoreView.update() ... hope it will help in the fight against freezing.
Disabled the dynamic page size feature. It only causes problems and JTable doesn't seem to be built for such usage.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-04 18:37:08 UTC (rev 666)
@@ -80,7 +80,7 @@
     private Pair<String, Integer>[] publications = null;
     private Pair<String, Integer>[] projects = null;
     
-    protected boolean dynamicPageLoading;
+    protected boolean dynamicPageLoading = false;
     
     /** Creates a new instance of AppCore */
     public AppCore(MainConfig mainConfig)
@@ -224,6 +224,16 @@
         }
     }
 
+    public void setRecordsPerPageNotNotify(int recordsPerPage) throws RemoteException, DBLayerException {        
+        if (tableSorter != null)
+        {
+            logger.info("Setting records per page NN to "+recordsPerPage);
+            if (recordsPerPage == -1)
+                throw new IllegalArgumentException("KURVA");
+            tableSorter.setPageSize(recordsPerPage);
+        }
+    }
+
     public void nextPage() throws DBLayerException, RemoteException {
         if (tableSorter != null)
         {

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 18:37:08 UTC (rev 666)
@@ -9,6 +9,7 @@
 
 import java.awt.Component;
 import java.awt.Cursor;
+import java.awt.Dimension;
 import java.awt.EventQueue;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
@@ -35,6 +36,7 @@
 import javax.swing.AbstractAction;
 import javax.swing.JFormattedTextField;
 import javax.swing.JOptionPane;
+import javax.swing.JTable;
 import javax.swing.KeyStroke;
 import javax.swing.ListSelectionModel;
 import javax.swing.SwingUtilities;
@@ -1577,7 +1579,7 @@
                         //must be done to prevent problems when this listener would send commands to load data for a query
                         //that doesn't exist, or when the dblayer doesn't exist..
                         //it's again installed in the DatabaseChange bridge
-                        view.overviewScrollPane.removeComponentListener(overviewResizeListener);
+//                        view.overviewScrollPane.removeComponentListener(overviewResizeListener);
 
                         model.logout();
                     
@@ -1728,7 +1730,7 @@
                                 //this can't be done earlier. must be done after the query is created
                                 //otherwise this listener would give the overview table model commands to load data
                                 //for a query that doesn't exist yet
-                                view.overviewScrollPane.addComponentListener(overviewResizeListener);
+//                                view.overviewScrollPane.addComponentListener(overviewResizeListener);
 
                                 /*-------------------------------------------------------------------
                                  *  This may no longer be necessary:
@@ -1917,25 +1919,31 @@
 		}// update()
 	}// class ManagerBridge
 
-        /** Handles resizing of Plantlore's main window.
+        /** NOT USED, ONLY CAUSES PROBLEMS.
          *
+         * JTable simply doesn't seem to be suited for this kind of manipulation. 
+         * 
+         * Handles resizing of Plantlore's main window.
+         *
          * Computes and changes the page size if needed.
          */
 	class OverviewResizeListener implements ComponentListener {
 		private final static int sub = 20; // height of the header row perhaps
 
-		public void componentResized(ComponentEvent e) {
+		public synchronized void componentResized(ComponentEvent e) {
 			if (!model.loggedIn() || !model.dynamicPageLoading)
 				return;
 			Component c = e.getComponent();
 			int tableHeight = c.getSize().height - sub; // height of the row
+			//int tableHeight = ((JTable)c).getPreferredScrollableViewportSize().height;
 														// part of JTable ( -->
 														// without header)
+                        
 			int rowHeight = view.overview.getRowHeight();
 			int newRecordsCount = tableHeight / rowHeight;
 			try {
-				model.setRecordsPerPage(newRecordsCount);
-				view.recordsPerPage.setValue(newRecordsCount);
+				model.setRecordsPerPageNotNotify(newRecordsCount);
+				//view.recordsPerPage.setValue(newRecordsCount);
                         } catch (RemoteException ex) {
                             DefaultExceptionHandler.handle(view,ex);
                             return;

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-04 18:37:08 UTC (rev 666)
@@ -537,7 +537,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="439" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="403" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-04 18:37:08 UTC (rev 666)
@@ -443,8 +443,6 @@
     }
 
     public void update(final Observable observable, final Object object) {
-        SwingUtilities.invokeLater( new Runnable() {
-            public void run() {
                 if (object != null && object instanceof String) {
                     String arg = (String) object;
                     if (arg.equals("PAGE_CHANGED")||arg.equals("RECORDS_PER_PAGE")) {
@@ -479,8 +477,6 @@
                         overview.getSelectionModel().setSelectionInterval(model.getSelectedRowNumber(),model.getSelectedRowNumber());
                     }
                 }//if instanceof String        
-            }//run()
-        });//invokeLater()
     }//update()
 
     private void setPreferredColumnSizes() {

Modified: trunk/src/net/sf/plantlore/client/overview/OverviewTableModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/OverviewTableModel.java	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/overview/OverviewTableModel.java	2006-09-04 18:37:08 UTC (rev 666)
@@ -295,7 +295,7 @@
     }
     
     public int getResultId() {
-        System.out.println("returning resultid "+resultId);
+        logger.debug("returning resultid "+resultId);
         return resultId;
     }
 

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-04 18:37:08 UTC (rev 666)
@@ -10,6 +10,7 @@
   </SyntheticProperties>
   <AuxValues>
     <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_layoutCodeTarget" type="java.lang.Integer" value="2"/>
     <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
     <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
     <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
@@ -502,7 +503,7 @@
             </Container>
           </SubComponents>
         </Container>
-        <Container class="javax.swing.JPanel" name="jPanel7">
+        <Container class="javax.swing.JPanel" name="generalPanel">
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
               <JTabbedPaneConstraints tabName="General">
@@ -528,7 +529,7 @@
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jPanel8" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="159" max="32767" attributes="0"/>
+                      <EmptySpace pref="160" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-04 18:37:08 UTC (rev 666)
@@ -72,7 +72,8 @@
         headerTwoField.setText(model.getHeaderTwo());
         
         //--- GENERAL TAB
-        dynamicPageCheckBox.setSelected(model.isDynamicPageLoading());
+        //dynamicPageCheckBox.setSelected(model.isDynamicPageLoading());
+        generalPanel.setVisible(false); //contains only the dynamic page size option which only causes many problems
     }
     
     
@@ -137,7 +138,7 @@
         headerOneLabel = new javax.swing.JLabel();
         headerTwoLabel = new javax.swing.JLabel();
         headerTwoField = new javax.swing.JTextField();
-        jPanel7 = new javax.swing.JPanel();
+        generalPanel = new javax.swing.JPanel();
         jPanel8 = new javax.swing.JPanel();
         dynamicPageCheckBox = new javax.swing.JCheckBox();
         cancelButton = new javax.swing.JButton();
@@ -387,23 +388,23 @@
                 .addContainerGap(73, Short.MAX_VALUE))
         );
 
-        org.jdesktop.layout.GroupLayout jPanel7Layout = new org.jdesktop.layout.GroupLayout(jPanel7);
-        jPanel7.setLayout(jPanel7Layout);
-        jPanel7Layout.setHorizontalGroup(
-            jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel7Layout.createSequentialGroup()
+        org.jdesktop.layout.GroupLayout generalPanelLayout = new org.jdesktop.layout.GroupLayout(generalPanel);
+        generalPanel.setLayout(generalPanelLayout);
+        generalPanelLayout.setHorizontalGroup(
+            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(generalPanelLayout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addContainerGap())
         );
-        jPanel7Layout.setVerticalGroup(
-            jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel7Layout.createSequentialGroup()
+        generalPanelLayout.setVerticalGroup(
+            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(generalPanelLayout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel8, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(159, Short.MAX_VALUE))
+                .addContainerGap(160, Short.MAX_VALUE))
         );
-        jTabbedPane1.addTab(L10n.getString("Settings.GeneralTab"), jPanel7);
+        jTabbedPane1.addTab(L10n.getString("Settings.GeneralTab"), generalPanel);
 
         cancelButton.setText("Cancel");
         cancelButton.setActionCommand("CANCEL");
@@ -473,6 +474,7 @@
     protected javax.swing.JButton downButton;
     protected javax.swing.JCheckBox dynamicPageCheckBox;
     protected javax.swing.JRadioButton englishRadioButton;
+    private javax.swing.JPanel generalPanel;
     protected javax.swing.JTextField headerOneField;
     protected javax.swing.JLabel headerOneLabel;
     protected javax.swing.JTextField headerTwoField;
@@ -484,7 +486,6 @@
     private javax.swing.JPanel jPanel4;
     private javax.swing.JPanel jPanel5;
     private javax.swing.JPanel jPanel6;
-    private javax.swing.JPanel jPanel7;
     private javax.swing.JPanel jPanel8;
     private javax.swing.JScrollPane jScrollPane1;
     private javax.swing.JScrollPane jScrollPane2;

Modified: trunk/src/net/sf/plantlore/config/log4j.properties
===================================================================
--- trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-04 12:51:20 UTC (rev 665)
+++ trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-04 18:37:08 UTC (rev 666)
@@ -1,5 +1,5 @@
 ### set log levels - for more verbose logging change 'info' to 'debug' ###
-log4j.rootLogger=debug, stdout
+log4j.rootLogger=info, stdout
 
 ### direct log messages to stdout ###
 log4j.appender.stdout=org.apache.log4j.ConsoleAppender
@@ -16,16 +16,16 @@
 log4j.logger.org.apache.commons = info
 
 #log4j.logger.org.hibernate=info
-log4j.logger.org.hibernate=info
+log4j.logger.org.hibernate=error
 
 ### log HQL query parser activity
 #log4j.logger.org.hibernate.hql.ast.AST=debug
 
 ### log just the SQL
-log4j.logger.org.hibernate.SQL=info
+log4j.logger.org.hibernate.SQL=error
 
 ### log JDBC bind parameters ###
-log4j.logger.org.hibernate.type=info
+log4j.logger.org.hibernate.type=error
 #log4j.logger.org.hibernate.type=debug
 
 ### log schema export/update ###



From fraktalek at mail.berlios.de  Mon Sep  4 21:02:25 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 21:02:25 +0200
Subject: [Plantlore-dev] r667 - trunk/src/net/sf/plantlore/client/settings
Message-ID: <200609041902.k84J2P4H013630@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 21:02:14 +0200 (Mon, 04 Sep 2006)
New Revision: 667

Modified:
   trunk/src/net/sf/plantlore/client/settings/SettingsView.form
   trunk/src/net/sf/plantlore/client/settings/SettingsView.java
Log:
The general tab with dynamic page size option is now hidden.
Settings will open relative to parent now and close on pressed escape.



Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-04 18:37:08 UTC (rev 666)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-04 19:02:14 UTC (rev 667)
@@ -4,6 +4,85 @@
   <NonVisualComponents>
     <Component class="javax.swing.ButtonGroup" name="languagesButtonGroup">
     </Component>
+    <Container class="javax.swing.JPanel" name="generalPanel">
+      <Properties>
+        <Property name="enabled" type="boolean" value="false"/>
+      </Properties>
+
+      <Layout>
+        <DimensionLayout dim="0">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="jPanel8" max="32767" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+        <DimensionLayout dim="1">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="jPanel8" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace pref="160" max="32767" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+      </Layout>
+      <SubComponents>
+        <Container class="javax.swing.JPanel" name="jPanel8">
+          <Properties>
+            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+              <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
+                <TitledBorder title="Overview">
+                  <ResourceString PropertyName="titleX" bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Settings.General.OverviewPanel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                </TitledBorder>
+              </Border>
+            </Property>
+          </Properties>
+
+          <Layout>
+            <DimensionLayout dim="0">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Group type="102" alignment="0" attributes="0">
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="dynamicPageCheckBox" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="481" max="32767" attributes="0"/>
+                  </Group>
+              </Group>
+            </DimensionLayout>
+            <DimensionLayout dim="1">
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Group type="102" alignment="0" attributes="0">
+                      <EmptySpace max="-2" attributes="0"/>
+                      <Component id="dynamicPageCheckBox" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace pref="73" max="32767" attributes="0"/>
+                  </Group>
+              </Group>
+            </DimensionLayout>
+          </Layout>
+          <SubComponents>
+            <Component class="javax.swing.JCheckBox" name="dynamicPageCheckBox">
+              <Properties>
+                <Property name="text" type="java.lang.String" value="jCheckBox1"/>
+                <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+                  <Border info="org.netbeans.modules.form.compat2.border.EmptyBorderInfo">
+                    <EmptyBorder bottom="0" left="0" right="0" top="0"/>
+                  </Border>
+                </Property>
+                <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
+                  <Insets value="[0, 0, 0, 0]"/>
+                </Property>
+              </Properties>
+              <AuxValues>
+                <AuxValue name="JavaCodeGenerator_InitCodePost" type="java.lang.String" value="dynamicPageCheckBox.setActionCommand(&quot;DYNAMIC_PAGE_LOADING&quot;);"/>
+                <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+              </AuxValues>
+            </Component>
+          </SubComponents>
+        </Container>
+      </SubComponents>
+    </Container>
   </NonVisualComponents>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
@@ -503,91 +582,6 @@
             </Container>
           </SubComponents>
         </Container>
-        <Container class="javax.swing.JPanel" name="generalPanel">
-          <Constraints>
-            <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="General">
-                <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-                  <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Settings.GeneralTab" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
-                </Property>
-              </JTabbedPaneConstraints>
-            </Constraint>
-          </Constraints>
-
-          <Layout>
-            <DimensionLayout dim="0">
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Group type="102" alignment="0" attributes="0">
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="jPanel8" max="32767" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                  </Group>
-              </Group>
-            </DimensionLayout>
-            <DimensionLayout dim="1">
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Group type="102" alignment="0" attributes="0">
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="jPanel8" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="160" max="32767" attributes="0"/>
-                  </Group>
-              </Group>
-            </DimensionLayout>
-          </Layout>
-          <SubComponents>
-            <Container class="javax.swing.JPanel" name="jPanel8">
-              <Properties>
-                <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
-                  <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
-                    <TitledBorder title="Overview">
-                      <ResourceString PropertyName="titleX" bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Settings.General.OverviewPanel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
-                    </TitledBorder>
-                  </Border>
-                </Property>
-              </Properties>
-
-              <Layout>
-                <DimensionLayout dim="0">
-                  <Group type="103" groupAlignment="0" attributes="0">
-                      <Group type="102" alignment="0" attributes="0">
-                          <EmptySpace max="-2" attributes="0"/>
-                          <Component id="dynamicPageCheckBox" min="-2" max="-2" attributes="0"/>
-                          <EmptySpace pref="481" max="32767" attributes="0"/>
-                      </Group>
-                  </Group>
-                </DimensionLayout>
-                <DimensionLayout dim="1">
-                  <Group type="103" groupAlignment="0" attributes="0">
-                      <Group type="102" alignment="0" attributes="0">
-                          <EmptySpace max="-2" attributes="0"/>
-                          <Component id="dynamicPageCheckBox" min="-2" max="-2" attributes="0"/>
-                          <EmptySpace pref="73" max="32767" attributes="0"/>
-                      </Group>
-                  </Group>
-                </DimensionLayout>
-              </Layout>
-              <SubComponents>
-                <Component class="javax.swing.JCheckBox" name="dynamicPageCheckBox">
-                  <Properties>
-                    <Property name="text" type="java.lang.String" value="jCheckBox1"/>
-                    <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
-                      <Border info="org.netbeans.modules.form.compat2.border.EmptyBorderInfo">
-                        <EmptyBorder bottom="0" left="0" right="0" top="0"/>
-                      </Border>
-                    </Property>
-                    <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
-                      <Insets value="[0, 0, 0, 0]"/>
-                    </Property>
-                  </Properties>
-                  <AuxValues>
-                    <AuxValue name="JavaCodeGenerator_InitCodePost" type="java.lang.String" value="dynamicPageCheckBox.setActionCommand(&quot;DYNAMIC_PAGE_LOADING&quot;);"/>
-                    <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                  </AuxValues>
-                </Component>
-              </SubComponents>
-            </Container>
-          </SubComponents>
-        </Container>
       </SubComponents>
     </Container>
     <Component class="javax.swing.JButton" name="cancelButton">

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-04 18:37:08 UTC (rev 666)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-04 19:02:14 UTC (rev 667)
@@ -14,6 +14,7 @@
 import javax.swing.ListSelectionModel;
 import net.sf.plantlore.client.*;
 import net.sf.plantlore.client.overview.Column;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -31,6 +32,8 @@
         initComponents();
         setLabels();
         loadValues();
+        setLocationRelativeTo(parent);
+        new DefaultEscapeKeyPressed(this);
     }
     
     public void loadValues() {
@@ -114,6 +117,9 @@
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
         languagesButtonGroup = new javax.swing.ButtonGroup();
+        generalPanel = new javax.swing.JPanel();
+        jPanel8 = new javax.swing.JPanel();
+        dynamicPageCheckBox = new javax.swing.JCheckBox();
         jTabbedPane1 = new javax.swing.JTabbedPane();
         jPanel1 = new javax.swing.JPanel();
         jPanel2 = new javax.swing.JPanel();
@@ -138,13 +144,51 @@
         headerOneLabel = new javax.swing.JLabel();
         headerTwoLabel = new javax.swing.JLabel();
         headerTwoField = new javax.swing.JTextField();
-        generalPanel = new javax.swing.JPanel();
-        jPanel8 = new javax.swing.JPanel();
-        dynamicPageCheckBox = new javax.swing.JCheckBox();
         cancelButton = new javax.swing.JButton();
         okButton = new javax.swing.JButton();
         helpButton = new javax.swing.JButton();
 
+        generalPanel.setEnabled(false);
+        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Settings.General.OverviewPanel")));
+        dynamicPageCheckBox.setText("jCheckBox1");
+        dynamicPageCheckBox.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
+        dynamicPageCheckBox.setMargin(new java.awt.Insets(0, 0, 0, 0));
+        dynamicPageCheckBox.setActionCommand("DYNAMIC_PAGE_LOADING");
+
+        org.jdesktop.layout.GroupLayout jPanel8Layout = new org.jdesktop.layout.GroupLayout(jPanel8);
+        jPanel8.setLayout(jPanel8Layout);
+        jPanel8Layout.setHorizontalGroup(
+            jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel8Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(dynamicPageCheckBox)
+                .addContainerGap(481, Short.MAX_VALUE))
+        );
+        jPanel8Layout.setVerticalGroup(
+            jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel8Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(dynamicPageCheckBox)
+                .addContainerGap(73, Short.MAX_VALUE))
+        );
+
+        org.jdesktop.layout.GroupLayout generalPanelLayout = new org.jdesktop.layout.GroupLayout(generalPanel);
+        generalPanel.setLayout(generalPanelLayout);
+        generalPanelLayout.setHorizontalGroup(
+            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(generalPanelLayout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addContainerGap())
+        );
+        generalPanelLayout.setVerticalGroup(
+            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(generalPanelLayout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel8, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap(160, Short.MAX_VALUE))
+        );
+
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Settings.LanguagePanel")));
         languagesButtonGroup.add(englishRadioButton);
         englishRadioButton.setText("English");
@@ -365,47 +409,6 @@
         );
         jTabbedPane1.addTab(L10n.getString("Settings.SchedaTab"), jPanel5);
 
-        jPanel8.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Settings.General.OverviewPanel")));
-        dynamicPageCheckBox.setText("jCheckBox1");
-        dynamicPageCheckBox.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        dynamicPageCheckBox.setMargin(new java.awt.Insets(0, 0, 0, 0));
-        dynamicPageCheckBox.setActionCommand("DYNAMIC_PAGE_LOADING");
-
-        org.jdesktop.layout.GroupLayout jPanel8Layout = new org.jdesktop.layout.GroupLayout(jPanel8);
-        jPanel8.setLayout(jPanel8Layout);
-        jPanel8Layout.setHorizontalGroup(
-            jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel8Layout.createSequentialGroup()
-                .addContainerGap()
-                .add(dynamicPageCheckBox)
-                .addContainerGap(481, Short.MAX_VALUE))
-        );
-        jPanel8Layout.setVerticalGroup(
-            jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel8Layout.createSequentialGroup()
-                .addContainerGap()
-                .add(dynamicPageCheckBox)
-                .addContainerGap(73, Short.MAX_VALUE))
-        );
-
-        org.jdesktop.layout.GroupLayout generalPanelLayout = new org.jdesktop.layout.GroupLayout(generalPanel);
-        generalPanel.setLayout(generalPanelLayout);
-        generalPanelLayout.setHorizontalGroup(
-            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(generalPanelLayout.createSequentialGroup()
-                .addContainerGap()
-                .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .addContainerGap())
-        );
-        generalPanelLayout.setVerticalGroup(
-            generalPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(generalPanelLayout.createSequentialGroup()
-                .addContainerGap()
-                .add(jPanel8, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(160, Short.MAX_VALUE))
-        );
-        jTabbedPane1.addTab(L10n.getString("Settings.GeneralTab"), generalPanel);
-
         cancelButton.setText("Cancel");
         cancelButton.setActionCommand("CANCEL");
 



From fraktalek at mail.berlios.de  Mon Sep  4 21:27:58 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 21:27:58 +0200
Subject: [Plantlore-dev] r668 - in trunk/src/net/sf/plantlore/client: .
	overview/tree
Message-ID: <200609041927.k84JRwYq023972@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 21:27:14 +0200 (Mon, 04 Sep 2006)
New Revision: 668

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
Log:
Habitat tree is now showed using Task and dispatcher.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 19:02:14 UTC (rev 667)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 19:27:14 UTC (rev 668)
@@ -928,16 +928,17 @@
 
 		public void actionPerformed(ActionEvent actionEvent) {
                         habitatTreeModel.setDBLayer(model.getDatabase());
-                        try {
-                            habitatTreeModel.loadData();
-                        } catch (RemoteException ex) {
-                            DefaultExceptionHandler.handle(view,ex);
-                            return;
-                        } catch (DBLayerException ex) {
-                            DefaultExceptionHandler.handle(view,ex);
-                            return;
-                        }
-                        habitatTreeView.setVisible(true);
+                        Task task = habitatTreeModel.loadData();
+                        task.setPostTaskAction(new PostTaskAction() {
+                           public void afterStopped(Object value) {
+                               SwingUtilities.invokeLater(new Runnable() {
+                                  public void run() {
+                                    habitatTreeView.setVisible(true);                                      
+                                  } 
+                               });
+                           } 
+                        });
+                        Dispatcher.getDispatcher().dispatch(task, view, false);
 		}//actionPerformed
 	}// HabitatTreeAction
 

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-04 19:02:14 UTC (rev 667)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-04 19:27:14 UTC (rev 668)
@@ -21,6 +21,7 @@
 import net.sf.plantlore.common.DBLayerUtils;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.Habitat;
 import net.sf.plantlore.common.record.Occurrence;
@@ -58,33 +59,39 @@
         this.dblayer = dblayer;
     }
     
-    public void loadData() throws DBLayerException, RemoteException {
-        SelectQuery subQuery = dblayer.createSubQuery(Habitat.class,"h");
-        subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY,"h." + Habitat.TERRITORY);
-        subQuery.addRestriction(PlantloreConstants.RESTR_EQ,"h."+Habitat.DELETED,null,0,null);
-        
-        SelectQuery query = dblayer.createQuery(Territory.class);
-        query.addRestriction(PlantloreConstants.SUBQUERY_IN,Territory.ID,null,subQuery,null);
-        
-        int resultid = dblayer.executeQuery(query);
-        int resultsCount = dblayer.getNumRows(resultid);
-        if (resultsCount <= 0) {
-            dblayer.closeQuery(query);
-            return;
-        }
-        Object[] records = (Object[]) dblayer.more(resultid, 0,resultsCount - 1);
-        dblayer.closeQuery(query);
-        Territory territory;
-        DefaultMutableTreeNode node;
-        for (Object record : records) {
-            territory = (Territory) ((Object [])record)[0];
-            node = new DefaultMutableTreeNode(new NodeInfo(NodeInfo.NodeType.TERRITORY,territory.getName(),territory.getId(),getPhythochoriaCount(territory)));
-            rootNode.add(node);
-            addPhythochoria(node,territory);
-        }
-        
-        setChanged();
-        notifyObservers("LOADED_DATA");
+    public Task loadData() {
+        final HabitatTree model = this;
+        return new Task() {
+            public Object task() throws DBLayerException, RemoteException {
+                SelectQuery subQuery = dblayer.createSubQuery(Habitat.class,"h");
+                subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY,"h." + Habitat.TERRITORY);
+                subQuery.addRestriction(PlantloreConstants.RESTR_EQ,"h."+Habitat.DELETED,null,0,null);
+
+                SelectQuery query = dblayer.createQuery(Territory.class);
+                query.addRestriction(PlantloreConstants.SUBQUERY_IN,Territory.ID,null,subQuery,null);
+
+                int resultid = dblayer.executeQuery(query);
+                int resultsCount = dblayer.getNumRows(resultid);
+                if (resultsCount <= 0) {
+                    dblayer.closeQuery(query);
+                    return null;
+                }
+                Object[] records = (Object[]) dblayer.more(resultid, 0,resultsCount - 1);
+                dblayer.closeQuery(query);
+                Territory territory;
+                DefaultMutableTreeNode node;
+                for (Object record : records) {
+                    territory = (Territory) ((Object [])record)[0];
+                    node = new DefaultMutableTreeNode(new NodeInfo(NodeInfo.NodeType.TERRITORY,territory.getName(),territory.getId(),getPhythochoriaCount(territory)));
+                    rootNode.add(node);
+                    addPhythochoria(node,territory);
+                }
+
+                model.setChanged();
+                model.notifyObservers("LOADED_DATA");
+                return null;
+            }
+        };//return new Task;
     }
     
     public int getPhythochoriaCount(Territory t) throws RemoteException, DBLayerException {



From krater at mail.berlios.de  Mon Sep  4 21:39:07 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 4 Sep 2006 21:39:07 +0200
Subject: [Plantlore-dev] r669 - in trunk/src/net/sf/plantlore: client/export
	common l10n
Message-ID: <200609041939.k84Jd7IN007147@sheep.berlios.de>

Author: krater
Date: 2006-09-04 21:38:59 +0200 (Mon, 04 Sep 2006)
New Revision: 669

Added:
   trunk/src/net/sf/plantlore/common/SimpleProgressBar.form
   trunk/src/net/sf/plantlore/common/SimpleProgressBar.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
Modified:
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/Task.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
Log:
A feeble attempt to change the progress bar for cancellable operations to something more sturdy.

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 19:38:59 UTC (rev 669)
@@ -1,15 +1,20 @@
 package net.sf.plantlore.client.export;
 
+import java.awt.Cursor;
 import java.awt.event.ActionEvent;
 
 import javax.swing.JFileChooser;
 import javax.swing.JFrame;
 import javax.swing.JOptionPane;
+import javax.swing.SwingUtilities;
 import javax.swing.filechooser.FileFilter;
 
 import net.sf.plantlore.client.export.component.FileFormat;
 import net.sf.plantlore.common.DefaultCancelAction;
 import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.SimpleProgressBar;
+import net.sf.plantlore.common.SimpleProgressBar2;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
 
@@ -100,9 +105,9 @@
 	private void performExport() {
 		try {
 			ExportTask2 export = model.createExportTask();
-			new DefaultProgressBarEx(export, parentView, true);
-			export.start();
+			new SimpleProgressBar2(export, parentView).setVisible(true);
 		} catch(Exception e) {
+			e.printStackTrace();
 			JOptionPane.showMessageDialog(parentView,
 					e.getMessage(),
 					L10n.getString("Export.Failed"),

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-04 19:38:59 UTC (rev 669)
@@ -9,12 +9,9 @@
 
 package net.sf.plantlore.common;
 
-import java.util.Observable;
-import java.util.Observer;
 import javax.swing.JDialog;
 import javax.swing.JFrame;
 import javax.swing.JProgressBar;
-import javax.swing.SwingUtilities;
 import org.apache.log4j.Logger;
 
 /**
@@ -31,6 +28,19 @@
     
     private Dispatcher() {
     }
+    
+    
+    public synchronized boolean justDispatch(Task task) {
+        if (taskRunning) {
+            logger.debug("Dispatcher: task already RUNNING, RETURNING.");
+            return false;
+        }
+        
+        taskRunning = true;
+        task.start();
+
+        return true;
+    }
  
     public synchronized boolean dispatch(Task task, JFrame parent, boolean stoppable) {
         if (taskRunning) {
@@ -78,9 +88,7 @@
         taskRunning = false;
         pbm.removeTask();
         pbm.setParent((JDialog)null);
-/*        do{
-        	try{ Thread.sleep(50); } catch(Exception e) {}
-        } while( dpb.isShowing() ); */
+
         logger.debug("Dispatcher: "+task+" finished, free to dispatch another.");
     }    
     

Added: trunk/src/net/sf/plantlore/common/SimpleProgressBar.form
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar.form	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar.form	2006-09-04 19:38:59 UTC (rev 669)
@@ -0,0 +1,94 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+<Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
+  <Properties>
+    <Property name="modal" type="boolean" value="true"/>
+    <Property name="resizable" type="boolean" value="false"/>
+    <Property name="undecorated" type="boolean" value="true"/>
+  </Properties>
+  <SyntheticProperties>
+    <SyntheticProperty name="formSizePolicy" type="int" value="2"/>
+  </SyntheticProperties>
+  <AuxValues>
+    <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
+    <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
+  </AuxValues>
+
+  <Layout>
+    <DimensionLayout dim="0">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Group type="102" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Component id="jScrollPane1" alignment="0" pref="380" max="32767" attributes="0"/>
+                  <Component id="progress" alignment="0" pref="380" max="32767" attributes="0"/>
+                  <Component id="cancel" alignment="1" min="-2" max="-2" attributes="0"/>
+              </Group>
+              <EmptySpace max="-2" attributes="0"/>
+          </Group>
+      </Group>
+    </DimensionLayout>
+    <DimensionLayout dim="1">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Group type="102" alignment="0" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="progress" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="jScrollPane1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="cancel" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="32767" attributes="0"/>
+          </Group>
+      </Group>
+    </DimensionLayout>
+  </Layout>
+  <SubComponents>
+    <Component class="javax.swing.JProgressBar" name="progress">
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Container class="javax.swing.JScrollPane" name="jScrollPane1">
+      <Properties>
+        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+          <Border info="null"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="autoScrollPane" type="java.lang.Boolean" value="true"/>
+      </AuxValues>
+
+      <Layout class="org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout"/>
+      <SubComponents>
+        <Component class="javax.swing.JTextArea" name="status">
+          <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ed" green="e9" id="MenuBar.background" palette="3" red="eb" type="palette"/>
+            </Property>
+            <Property name="columns" type="int" value="20"/>
+            <Property name="editable" type="boolean" value="false"/>
+            <Property name="rows" type="int" value="2"/>
+            <Property name="tabSize" type="int" value="2"/>
+            <Property name="autoscrolls" type="boolean" value="false"/>
+            <Property name="enabled" type="boolean" value="false"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
+    </Container>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+  </SubComponents>
+</Form>

Added: trunk/src/net/sf/plantlore/common/SimpleProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar.java	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar.java	2006-09-04 19:38:59 UTC (rev 669)
@@ -0,0 +1,176 @@
+/*
+ * SimpleProgressBar.java
+ *
+ * Created on 4. z??? 2006, 18:44
+ */
+
+package net.sf.plantlore.common;
+
+import java.awt.Cursor;
+import java.awt.Window;
+import java.util.Observable;
+import java.util.Observer;
+
+import javax.swing.SwingUtilities;
+
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ *
+ * @author  yaa
+ */
+public class SimpleProgressBar extends javax.swing.JDialog implements Observer {
+	
+	protected Task task;
+	protected Window parent;
+    
+    /** Creates new form SimpleProgressBar */
+    public SimpleProgressBar(Task task, java.awt.Frame parent) {
+    	super(parent, true);
+    	this.task = task;
+    	this.parent = parent;
+    	
+        initComponents();
+        initialize();
+    }
+    
+    public SimpleProgressBar(Task task, java.awt.Dialog parent) {
+    	super(parent, true);
+    	this.task = task;
+    	this.parent = parent;
+    	
+        initComponents();
+        initialize();
+    }
+    
+    private void initialize() {
+    	setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+        cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+        task.addObserver( this );
+    	
+        if (task.isDeterminate()) {
+            progress.setIndeterminate(false);
+            progress.setMinimum(0);
+            progress.setMaximum(task.getLength());
+        } 
+        else
+            progress.setIndeterminate(true);
+        
+        cancel.setAction( new StandardAction("Common.Cancel") {
+        	public void actionPerformed(java.awt.event.ActionEvent arg0) {
+        		task.kill();
+        		task.deleteObservers();
+        		 SwingUtilities.invokeLater(new Runnable() {
+                     public void run() {
+                         setVisible( false );
+                         Dispatcher.getDispatcher().finished();
+                     }
+                 });
+        	}
+        });
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
+    private void initComponents() {
+        progress = new javax.swing.JProgressBar();
+        jScrollPane1 = new javax.swing.JScrollPane();
+        status = new javax.swing.JTextArea();
+        cancel = new javax.swing.JButton();
+
+        setModal(true);
+        setResizable(false);
+        setUndecorated(true);
+
+        jScrollPane1.setBorder(null);
+        status.setBackground(javax.swing.UIManager.getDefaults().getColor("MenuBar.background"));
+        status.setColumns(20);
+        status.setEditable(false);
+        status.setRows(2);
+        status.setTabSize(2);
+        status.setAutoscrolls(false);
+        status.setEnabled(false);
+        jScrollPane1.setViewportView(status);
+
+        cancel.setText(L10n.getString("Common.Cancel"));
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, cancel))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(cancel)
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+        );
+    }// </editor-fold>//GEN-END:initComponents
+    
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
+    private javax.swing.JScrollPane jScrollPane1;
+    protected javax.swing.JProgressBar progress;
+    protected javax.swing.JTextArea status;
+    // End of variables declaration//GEN-END:variables
+    
+    
+    
+    public void update(Observable source, Object parameter) {
+    	if(parameter instanceof Pair) {
+    		Pair p = (Pair)parameter;
+            Object first = p.getFirst();
+            if (first instanceof Task.Message) {
+            	Task.Message msg = (Task.Message)first;
+                Object value = p.getSecond();
+                
+                switch (msg) {
+                case POSITION_CHANGED:
+                    SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                            progress.setValue(task.getPosition());
+                        }
+                    });
+                    break;
+                case MESSAGE_CHANGED:
+                    SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                            status.setText( task.getStatusMessage() );
+                        }
+                    });
+                    break;
+                case STOPPING:
+                case STOPPED:
+                	SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                        	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+                        	cancel.setText(L10n.getString("Common.Hide"));
+                        }
+                    });
+                
+                }
+            }
+    	}
+    	else if (parameter instanceof Exception) {
+            DefaultExceptionHandler.handle(this, (Exception)parameter);
+        }
+    }
+    
+}

Added: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-04 19:38:59 UTC (rev 669)
@@ -0,0 +1,94 @@
+<?xml version="1.0" encoding="UTF-8" ?>
+
+<Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
+  <Properties>
+    <Property name="defaultCloseOperation" type="int" value="0"/>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+      <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Progress" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+    </Property>
+  </Properties>
+  <SyntheticProperties>
+    <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
+  </SyntheticProperties>
+  <AuxValues>
+    <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
+    <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
+  </AuxValues>
+
+  <Layout>
+    <DimensionLayout dim="0">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Group type="102" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Component id="jScrollPane1" alignment="0" pref="380" max="32767" attributes="0"/>
+                  <Component id="jProgressBar1" alignment="0" pref="380" max="32767" attributes="0"/>
+                  <Component id="cancel" alignment="1" min="-2" max="-2" attributes="0"/>
+              </Group>
+              <EmptySpace max="-2" attributes="0"/>
+          </Group>
+      </Group>
+    </DimensionLayout>
+    <DimensionLayout dim="1">
+      <Group type="103" groupAlignment="0" attributes="0">
+          <Group type="102" alignment="0" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="jProgressBar1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="jScrollPane1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
+              <Component id="cancel" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="32767" attributes="0"/>
+          </Group>
+      </Group>
+    </DimensionLayout>
+  </Layout>
+  <SubComponents>
+    <Component class="javax.swing.JProgressBar" name="jProgressBar1">
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Container class="javax.swing.JScrollPane" name="jScrollPane1">
+      <AuxValues>
+        <AuxValue name="autoScrollPane" type="java.lang.Boolean" value="true"/>
+      </AuxValues>
+
+      <Layout class="org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout"/>
+      <SubComponents>
+        <Component class="javax.swing.JTextArea" name="status">
+          <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ed" green="e9" id="Panel.background" palette="3" red="eb" type="palette"/>
+            </Property>
+            <Property name="columns" type="int" value="20"/>
+            <Property name="editable" type="boolean" value="false"/>
+            <Property name="rows" type="int" value="2"/>
+            <Property name="tabSize" type="int" value="2"/>
+            <Property name="autoscrolls" type="boolean" value="false"/>
+            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+              <Border info="null"/>
+            </Property>
+            <Property name="enabled" type="boolean" value="false"/>
+            <Property name="focusable" type="boolean" value="false"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
+    </Container>
+    <Component class="javax.swing.JButton" name="cancel">
+      <Properties>
+        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+  </SubComponents>
+</Form>

Added: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 19:38:59 UTC (rev 669)
@@ -0,0 +1,173 @@
+/*
+ * SimpleProgressBar2.java
+ *
+ * Created on 4. z??? 2006, 19:37
+ */
+
+package net.sf.plantlore.common;
+
+import java.awt.Cursor;
+import java.util.Observable;
+import java.util.Observer;
+
+import javax.swing.SwingUtilities;
+
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ *
+ * @author  yaa
+ */
+public class SimpleProgressBar2 extends javax.swing.JDialog implements Observer {
+	
+	private Task monitoredTask;
+    
+    /** Creates new form SimpleProgressBar2 */
+    public SimpleProgressBar2(Task task, java.awt.Frame parent) {
+    	super(parent, true);
+    	monitoredTask = task;
+    	task.addObserver( this );
+    	
+        initComponents();
+        
+        setLocationRelativeTo(null);
+        
+        cancel.setAction( new StandardAction("Common.Cancel") {
+        	public void actionPerformed(java.awt.event.ActionEvent arg0) {
+        		monitoredTask.kill();
+        		monitoredTask.deleteObservers();
+        		Dispatcher.getDispatcher().finished();
+        		
+        		 SwingUtilities.invokeLater(new Runnable() {
+                     public void run() {
+                         setVisible( false );
+                     }
+                 });
+        	}
+        });
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
+    private void initComponents() {
+        jProgressBar1 = new javax.swing.JProgressBar();
+        jScrollPane1 = new javax.swing.JScrollPane();
+        status = new javax.swing.JTextArea();
+        cancel = new javax.swing.JButton();
+
+        setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
+        setTitle(L10n.getString("Common.Progress"));
+
+        status.setBackground(javax.swing.UIManager.getDefaults().getColor("Panel.background"));
+        status.setColumns(20);
+        status.setEditable(false);
+        status.setRows(2);
+        status.setTabSize(2);
+        status.setAutoscrolls(false);
+        status.setBorder(null);
+        status.setEnabled(false);
+        status.setFocusable(false);
+        jScrollPane1.setViewportView(status);
+
+        cancel.setText(L10n.getString("Common.Cancel"));
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(jProgressBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, cancel))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jProgressBar1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(cancel)
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+        );
+        pack();
+    }// </editor-fold>//GEN-END:initComponents
+    
+        
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton cancel;
+    protected javax.swing.JProgressBar jProgressBar1;
+    private javax.swing.JScrollPane jScrollPane1;
+    protected javax.swing.JTextArea status;
+    // End of variables declaration//GEN-END:variables
+    
+    
+    @Override
+    public void setVisible(boolean visible) {
+    	super.setVisible(visible);
+    	if( visible )
+    		Dispatcher.getDispatcher().justDispatch( monitoredTask );
+
+    }
+    
+    
+	public void update(Observable arg0, Object parameter) {
+		System.out.println(parameter);
+		// TODO Auto-generated method stub
+		if(parameter instanceof Pair) {
+    		Pair p = (Pair)parameter;
+            Object first = p.getFirst();
+            if (first instanceof Task.Message) {
+            	Task.Message msg = (Task.Message)first;
+                Object value = p.getSecond();
+                
+                switch (msg) {
+                case STARTING:
+                	SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                        	  setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+                              cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+                        }
+                    });
+                
+                case POSITION_CHANGED:
+                    SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                        	jProgressBar1.setValue(monitoredTask.getPosition());
+                        }
+                    });
+                    break;
+                case MESSAGE_CHANGED:
+                    SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                            status.setText( monitoredTask.getStatusMessage() );
+                        }
+                    });
+                    break;
+                case STOPPING:
+                case STOPPED:
+                	SwingUtilities.invokeLater(new Runnable() {
+                        public void run() {
+                        	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+                        	cancel.setText(L10n.getString("Common.Hide"));
+                        }
+                    });
+                
+                }
+            }
+    	}
+    	else if (parameter instanceof Exception) {
+            DefaultExceptionHandler.handle(this, (Exception)parameter);
+        }
+		
+	}
+    
+}

Modified: trunk/src/net/sf/plantlore/common/Task.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Task.java	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/common/Task.java	2006-09-04 19:38:59 UTC (rev 669)
@@ -274,7 +274,8 @@
     public void kill() {
     	canceled = true;
     	
-    	worker.interrupt();
+    	if(worker != null)
+    		worker.interrupt();
     	
     	setChanged();
         notifyObservers(new Pair<Message,Object>(Message.STOPPING,null));

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 19:27:14 UTC (rev 668)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-04 19:38:59 UTC (rev 669)
@@ -1515,3 +1515,5 @@
 AddEdit.OccurrenceNoteLabel=Occurrence note\:
 
 AddEdit.LocationNoteLabel=Location note\:
+
+Common.Progress=Operation in progress



From fraktalek at mail.berlios.de  Mon Sep  4 22:13:53 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 4 Sep 2006 22:13:53 +0200
Subject: [Plantlore-dev] r670 - in trunk/src/net/sf/plantlore: client/export
	common
Message-ID: <200609042013.k84KDr9u018290@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-04 22:13:44 +0200 (Mon, 04 Sep 2006)
New Revision: 670

Modified:
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
Log:
Task dispatching moved from progress bar setvisible to exportMngCtrl2.performExport.
Doesn't freeze for me now.



Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 19:38:59 UTC (rev 669)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 20:13:44 UTC (rev 670)
@@ -1,6 +1,7 @@
 package net.sf.plantlore.client.export;
 
 import java.awt.Cursor;
+import java.awt.EventQueue;
 import java.awt.event.ActionEvent;
 
 import javax.swing.JFileChooser;
@@ -105,7 +106,9 @@
 	private void performExport() {
 		try {
 			ExportTask2 export = model.createExportTask();
-			new SimpleProgressBar2(export, parentView).setVisible(true);
+			new SimpleProgressBar2(export, parentView);
+            		Dispatcher.getDispatcher().justDispatch( export );
+                        
 		} catch(Exception e) {
 			e.printStackTrace();
 			JOptionPane.showMessageDialog(parentView,

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 19:38:59 UTC (rev 669)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 20:13:44 UTC (rev 670)
@@ -113,14 +113,12 @@
     @Override
     public void setVisible(boolean visible) {
     	super.setVisible(visible);
-    	if( visible )
-    		Dispatcher.getDispatcher().justDispatch( monitoredTask );
 
     }
     
     
 	public void update(Observable arg0, Object parameter) {
-		System.out.println(parameter);
+		System.out.println(""+parameter);
 		// TODO Auto-generated method stub
 		if(parameter instanceof Pair) {
     		Pair p = (Pair)parameter;
@@ -133,6 +131,7 @@
                 case STARTING:
                 	SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
+                            setVisible(true);
                         	  setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
                               cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
                         }



From fraktalek at mail.berlios.de  Tue Sep  5 00:11:28 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 00:11:28 +0200
Subject: [Plantlore-dev] r671 - in trunk: . installer installer/launch4j
Message-ID: <200609042211.k84MBSdd001113@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 00:11:28 +0200 (Tue, 05 Sep 2006)
New Revision: 671

Added:
   trunk/installer/launch4j/
   trunk/installer/launch4j/windows_config.xml
Modified:
   trunk/build.xml
Log:
Add support for building of a native windows installer that checks for the version of JRE.



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-04 20:13:44 UTC (rev 670)
+++ trunk/build.xml	2006-09-04 22:11:28 UTC (rev 671)
@@ -10,6 +10,10 @@
         <!-- Allows us to use the IzPack Ant task -->
         <taskdef name="izpack" classpath="${base.dir}/installer/standalone-compiler.jar"
          classname="com.izforge.izpack.ant.IzPackTask"/>
+        <taskdef name="launch4j"
+            classname="net.sf.launch4j.ant.Launch4jTask"
+            classpath="${base.dir}/installer/launch4j/launch4j.jar
+                :${base.dir}/installer/launch4j/lib/xstream.jar" />
          
 	<!-- the base classpath used for compilation -->
 	<path id="classpath.base">		
@@ -148,9 +152,23 @@
                     output="${dist.dir}/plantlore-install.jar"
                     installerType="standard"
                     basedir="${base.dir}"
-            />
+            />            
         </target>
         
+        <target name="nativeWinInstaller" depends="installer" description="Creates a native Windows installer using launch4j.">
+            <fail message="You have to install launch4j to the installer/launch4j directory first!">
+                <condition>
+                    <or> <!-- Just pick a few files from the ones that should be available and check if they are -->
+                        <not><available file="${base.dir}/installer/launch4j/launch4j.jar"/></not>
+                        <not><available file="${base.dir}/installer/launch4j/lib/xstream.jar"/></not>
+                        <not><available file="${base.dir}/installer/launch4j/head/head.o"/></not>
+                        <not><available file="${base.dir}/installer/launch4j/bin/windres"/></not>
+                    </or>
+                </condition>
+            </fail>
+            <launch4j configFile="installer/launch4j/windows_config.xml"/>            
+        </target>
+        
         <target name="javadoc" depends="init" description="Compile JavaDoc documentation for the project">
             <javadoc packagenames="net.sf.plantlore.*"
                      sourcepath="${base.dir}/src"

Added: trunk/installer/launch4j/windows_config.xml
===================================================================
--- trunk/installer/launch4j/windows_config.xml	2006-09-04 20:13:44 UTC (rev 670)
+++ trunk/installer/launch4j/windows_config.xml	2006-09-04 22:11:28 UTC (rev 671)
@@ -0,0 +1,39 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<launch4jConfig>
+    <!-- Header types: 0-GUI, 1-console -->
+    <headerType>0</headerType>
+    <outfile>../../dist/plantlore-installer-win.exe</outfile>
+    <jar>../../dist/plantlore-install.jar</jar>
+    <dontWrapJar>false</dontWrapJar>
+    <errTitle>Plantlore Install Error</errTitle>
+    <jarArgs></jarArgs>
+    <chdir>.</chdir>
+    <customProcName>true</customProcName>
+    <stayAlive>true</stayAlive>
+   <!-- <icon>install.ico</icon> -->
+    <jre>
+      <minVersion>1.5.0</minVersion>
+      <!-- Heap sizes in MB, 0-use default -->
+      <initialHeapSize>0</initialHeapSize>
+      <maxHeapSize>0</maxHeapSize>
+    </jre>
+<!--    <splash>
+      <file>splash.bmp</file>
+      <waitForWindow>true</waitForWindow>
+      <timeout>60</timeout>
+      <timeoutErr>true</timeoutErr>
+    </splash> -->
+    <versionInfo>
+      <fileVersion>1.0.0.0</fileVersion>
+      <txtFileVersion>1.0.0.0</txtFileVersion>
+      <fileDescription>Plantlore, Windows installer</fileDescription>
+      <copyright>Copyright the Plantlore team, 2000-2006</copyright>
+      <productVersion>1.0.0.0</productVersion>
+      <txtProductVersion>1.0</txtProductVersion>
+      <productName>Plantlore, Windows Installer</productName>
+<!--      <companyName>Plantlore</companyName> -->
+      <internalName>plantlore-install.jar</internalName>
+      <originalFilename>plantlore-installer-win.exe</originalFilename>
+    </versionInfo>
+  </launch4jConfig>



From krater at mail.berlios.de  Tue Sep  5 00:38:24 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 00:38:24 +0200
Subject: [Plantlore-dev] r672 - in trunk/src/net/sf/plantlore: client/export
	client/login client/occurrenceimport client/tableimport
	common server/manager
Message-ID: <200609042238.k84McOe2004591@sheep.berlios.de>

Author: krater
Date: 2006-09-05 00:38:19 +0200 (Tue, 05 Sep 2006)
New Revision: 672

Removed:
   trunk/src/net/sf/plantlore/common/SimpleProgressBar.java
Modified:
   trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
   trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
   trunk/src/net/sf/plantlore/client/login/Login.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java
   trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/ProgressBar.java
   trunk/src/net/sf/plantlore/common/ProgressBarEx.java
   trunk/src/net/sf/plantlore/common/ProgressBarManager.java
   trunk/src/net/sf/plantlore/common/ProgressBarNew.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
Log:
Dispatcher.dispatch: stoppable = true ~ argument used for extremely long running tasks whose monitor (SimpleProgressBar2) should remain visible until the user tells him to hide.

SimpleProgressBar2 can close itself when an error occurs.

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngCtrl2.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -1,21 +1,15 @@
 package net.sf.plantlore.client.export;
 
-import java.awt.Cursor;
-import java.awt.EventQueue;
 import java.awt.event.ActionEvent;
 
 import javax.swing.JFileChooser;
 import javax.swing.JFrame;
-import javax.swing.JOptionPane;
-import javax.swing.SwingUtilities;
 import javax.swing.filechooser.FileFilter;
 
 import net.sf.plantlore.client.export.component.FileFormat;
 import net.sf.plantlore.common.DefaultCancelAction;
-import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Dispatcher;
-import net.sf.plantlore.common.SimpleProgressBar;
-import net.sf.plantlore.common.SimpleProgressBar2;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
 
@@ -106,15 +100,9 @@
 	private void performExport() {
 		try {
 			ExportTask2 export = model.createExportTask();
-			new SimpleProgressBar2(export, parentView);
-            		Dispatcher.getDispatcher().justDispatch( export );
-                        
+			Dispatcher.getDispatcher().dispatch( export, parentView, true );
 		} catch(Exception e) {
-			e.printStackTrace();
-			JOptionPane.showMessageDialog(parentView,
-					e.getMessage(),
-					L10n.getString("Export.Failed"),
-					JOptionPane.WARNING_MESSAGE);
+			DefaultExceptionHandler.handle(parentView, e, L10n.getString("Export.Failed"));
 		}
 	}
 

Modified: trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -5,8 +5,7 @@
 import javax.swing.AbstractAction;
 
 import net.sf.plantlore.common.DefaultCancelAction;
-import net.sf.plantlore.common.DefaultExceptionHandler;
-import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 
@@ -39,18 +38,8 @@
 		public void actionPerformed(ActionEvent arg0) {
 			String user = ((javax.swing.JTextField)view.user.getEditor().getEditorComponent()).getText();
 			Task connect = model.createConnectionTask(user, new String(view.password.getPassword()));
+			Dispatcher.getDispatcher().dispatch( connect, view, false );
 			
-			// My own ProgressBar - 
-			// it would not be wise to offer reconnection right after the login failed...
-			new DefaultProgressBarEx(connect, view, true) {
-				@Override
-				public void exceptionHandler(Exception ex) {
-					getTask().stop();
-					DefaultExceptionHandler.handle(parent, ex, L10n.getString("Login.ConnectionFailed"), true);
-				}
-			};
-			connect.start();
-			
 			// Discard the password!
 			view.password.setText("");
 		}

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -5,6 +5,7 @@
 import java.util.ArrayList;
 import java.util.Observable;
 import net.sf.plantlore.client.MainConfig;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.User;
@@ -350,6 +351,8 @@
 			// there is a new DBLayer and the observers of Login must know about it.
 			announceConnection();
 			
+			DefaultExceptionHandler.enableReconnect();
+			
 			return null;
 		}
 		
@@ -369,6 +372,7 @@
 				currentDBLayer = null; accessRights = null; plantloreUser = null;
 				
 				proxyLayer.wrap( null );
+				DefaultExceptionHandler.disableReconnect();
 				
 				logger.info("The client disconnected itself from the server. The communication may no longer be possible.");
 			} catch(RemoteException e) {

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportMngCtrl.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -6,7 +6,8 @@
 import net.sf.plantlore.client.AppCoreView;
 import net.sf.plantlore.client.export.component.FileFormat;
 
-import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 
@@ -50,13 +51,9 @@
 				}
 				try {
 					Task task = model.createOccurrenceImportTask( choice.getSelectedFile().getAbsolutePath() );
-					new DefaultProgressBarEx(task, view, true);
-					task.start();
+					Dispatcher.getDispatcher().dispatch(task, view, true);
 				} catch(Exception e) {
-					JOptionPane.showMessageDialog(view,
-							L10n.getString("Error.ImportFailed") + "\n" + e.getMessage(),
-							L10n.getString("Import.Failed"),
-							JOptionPane.ERROR_MESSAGE);
+					DefaultExceptionHandler.handle(view, e, L10n.getString("Import.Failed"));
 				}
 			}
 		}

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportMngCtrl.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -5,7 +5,8 @@
 
 import net.sf.plantlore.client.AppCoreView;
 import net.sf.plantlore.client.export.component.FileFormat;
-import net.sf.plantlore.common.DefaultProgressBarEx;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 
@@ -49,13 +50,9 @@
 				}
 				try {
 					Task task = model.createTableImportTask( choice.getSelectedFile().getAbsolutePath() );
-					new DefaultProgressBarEx(task, view, true);
-					task.start();
+					Dispatcher.getDispatcher().dispatch( task, view, true );
 				} catch(Exception e) {
-					JOptionPane.showMessageDialog(view,
-							L10n.getString("Error.ImportFailed") + "\n" + e.getMessage(),
-							L10n.getString("Import.Failed"),
-							JOptionPane.ERROR_MESSAGE);
+					DefaultExceptionHandler.handle(view, e, L10n.getString("Import.Failed"));
 				}
 			}
 		}

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -20,7 +20,7 @@
  */
 public class DefaultExceptionHandler {
 	
-	private static boolean isReconnectDisabled = false;
+	private static boolean isReconnectDisabled = true;
 	
 	
 	private DefaultExceptionHandler() {}
@@ -77,7 +77,7 @@
 			Exception e, 
 			String title, 
 			boolean doNotOfferReconnect) {
-		e.printStackTrace();//FIXME - print to log perhaps!
+//		e.printStackTrace();//FIXME - print to log perhaps!
 		boolean isReconnectReasonable = false;
 		String problemDescription = e.getMessage();
 		

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBar.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -14,6 +14,7 @@
  * @since 2006-07-26
  *
  */
+ at Deprecated
 public class DefaultProgressBar extends ProgressBar {
 	
 	private boolean doNotOfferReconnect = false;

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBarEx.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -12,6 +12,7 @@
  * @since 2006-07-26
  *
  */
+ at Deprecated
 public class DefaultProgressBarEx extends ProgressBarEx {
 	
 	/**

Modified: trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/DefaultProgressBarNew.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -12,6 +12,7 @@
  * @since 2006-07-26
  *
  */
+ at Deprecated
 public class DefaultProgressBarNew extends ProgressBarNew {
 	
 	/**

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -21,7 +21,7 @@
 public class Dispatcher {
     private Logger logger = Logger.getLogger(Dispatcher.class.getPackage().getName());
     private boolean taskRunning = false;
-    private DefaultProgressBarNew dpb;
+    //private DefaultProgressBarNew dpb;
     private Task task;
     private static Dispatcher dispatcher = new Dispatcher();
     private static ProgressBarManager pbm;
@@ -51,11 +51,15 @@
         taskRunning = true;
         this.task = task;
         //dpb = new DefaultProgressBarNew(task, parent, true);
-
-        pbm.initialize();
-        pbm.setParent(parent);
-        pbm.setTask(task);
         
+        if( stoppable )
+        	new SimpleProgressBar2(task, parent);
+        else {
+        	pbm.initialize();
+        	pbm.setParent(parent);
+        	pbm.setTask(task);
+        }
+        
         task.start();
         
         return true;
@@ -70,11 +74,15 @@
         taskRunning = true;
         this.task = task;
         //dpb = new DefaultProgressBarNew(task, parent, true);
-
-        pbm.initialize();
-        pbm.setParent(parent);
-        pbm.setTask(task);
         
+        if( stoppable )
+        	new SimpleProgressBar2(task, parent);
+        else {
+        	pbm.initialize();
+        	pbm.setParent(parent);
+        	pbm.setTask(task);
+        }
+        
         task.start();
         
         return true;

Modified: trunk/src/net/sf/plantlore/common/ProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -28,6 +28,7 @@
  *
  * @author  fraktalek
  */
+ at Deprecated
 public abstract class ProgressBar extends javax.swing.JDialog implements Observer {
     protected Logger logger;
     protected Task task;

Modified: trunk/src/net/sf/plantlore/common/ProgressBarEx.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarEx.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/ProgressBarEx.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -32,6 +32,7 @@
  *
  * @author  Erik Kratochv?l
  */
+ at Deprecated
 public abstract class ProgressBarEx extends ProgressBar {
     
     /** 

Modified: trunk/src/net/sf/plantlore/common/ProgressBarManager.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -77,8 +77,10 @@
             progressBar.setIndeterminate(true);
         }
         
-        if (parent != null)
+        if (parent != null) {
             parent.setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+            parent.setEnabled(false);
+        }
         
         task.addObserver(this);    
         
@@ -94,8 +96,10 @@
     private synchronized void stop() {
         ended = true;
         progressBar.setVisible(false);
-        if (parent != null)
+        if (parent != null) {
             parent.setCursor(Cursor.getDefaultCursor());
+            parent.setEnabled(true);
+        }
         logger.debug(""+this+" STOPPING " + task );
         //!!! afterStopping();        
         Dispatcher.getDispatcher().finished();

Modified: trunk/src/net/sf/plantlore/common/ProgressBarNew.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarNew.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/ProgressBarNew.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -28,6 +28,7 @@
  *
  * @author  fraktalek
  */
+ at Deprecated
 public abstract class ProgressBarNew extends javax.swing.JDialog implements Observer {
     protected Logger logger;
     protected Task task;
@@ -104,7 +105,7 @@
         parent.setCursor(Cursor.getDefaultCursor());
         logger.debug(""+this+" STOPPING " + task );
         afterStopping();        
-        Dispatcher.getDispatcher().finished();
+        
     }
     
     /** Changes the ProgressBar's state.
@@ -274,11 +275,14 @@
                         });
                         break;
                     case STOPPING:
-                        SwingUtilities.invokeLater(new Runnable() {
+                    	try {
+                        SwingUtilities.invokeAndWait(new Runnable() {
                             public void run() {
                                 stop();
                             }
                         });
+                    	}catch(Exception e) {}
+                        Dispatcher.getDispatcher().finished();
                         break;
                     case STOPPED:
                         afterStopped(value);

Deleted: trunk/src/net/sf/plantlore/common/SimpleProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -1,176 +0,0 @@
-/*
- * SimpleProgressBar.java
- *
- * Created on 4. z??? 2006, 18:44
- */
-
-package net.sf.plantlore.common;
-
-import java.awt.Cursor;
-import java.awt.Window;
-import java.util.Observable;
-import java.util.Observer;
-
-import javax.swing.SwingUtilities;
-
-import net.sf.plantlore.l10n.L10n;
-
-/**
- *
- * @author  yaa
- */
-public class SimpleProgressBar extends javax.swing.JDialog implements Observer {
-	
-	protected Task task;
-	protected Window parent;
-    
-    /** Creates new form SimpleProgressBar */
-    public SimpleProgressBar(Task task, java.awt.Frame parent) {
-    	super(parent, true);
-    	this.task = task;
-    	this.parent = parent;
-    	
-        initComponents();
-        initialize();
-    }
-    
-    public SimpleProgressBar(Task task, java.awt.Dialog parent) {
-    	super(parent, true);
-    	this.task = task;
-    	this.parent = parent;
-    	
-        initComponents();
-        initialize();
-    }
-    
-    private void initialize() {
-    	setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
-        cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-        task.addObserver( this );
-    	
-        if (task.isDeterminate()) {
-            progress.setIndeterminate(false);
-            progress.setMinimum(0);
-            progress.setMaximum(task.getLength());
-        } 
-        else
-            progress.setIndeterminate(true);
-        
-        cancel.setAction( new StandardAction("Common.Cancel") {
-        	public void actionPerformed(java.awt.event.ActionEvent arg0) {
-        		task.kill();
-        		task.deleteObservers();
-        		 SwingUtilities.invokeLater(new Runnable() {
-                     public void run() {
-                         setVisible( false );
-                         Dispatcher.getDispatcher().finished();
-                     }
-                 });
-        	}
-        });
-    }
-    
-    /** This method is called from within the constructor to
-     * initialize the form.
-     * WARNING: Do NOT modify this code. The content of this method is
-     * always regenerated by the Form Editor.
-     */
-    // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
-    private void initComponents() {
-        progress = new javax.swing.JProgressBar();
-        jScrollPane1 = new javax.swing.JScrollPane();
-        status = new javax.swing.JTextArea();
-        cancel = new javax.swing.JButton();
-
-        setModal(true);
-        setResizable(false);
-        setUndecorated(true);
-
-        jScrollPane1.setBorder(null);
-        status.setBackground(javax.swing.UIManager.getDefaults().getColor("MenuBar.background"));
-        status.setColumns(20);
-        status.setEditable(false);
-        status.setRows(2);
-        status.setTabSize(2);
-        status.setAutoscrolls(false);
-        status.setEnabled(false);
-        jScrollPane1.setViewportView(status);
-
-        cancel.setText(L10n.getString("Common.Cancel"));
-
-        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
-        getContentPane().setLayout(layout);
-        layout.setHorizontalGroup(
-            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
-                .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, cancel))
-                .addContainerGap())
-        );
-        layout.setVerticalGroup(
-            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
-                .addContainerGap()
-                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(cancel)
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-        );
-    }// </editor-fold>//GEN-END:initComponents
-    
-    
-    // Variables declaration - do not modify//GEN-BEGIN:variables
-    protected javax.swing.JButton cancel;
-    private javax.swing.JScrollPane jScrollPane1;
-    protected javax.swing.JProgressBar progress;
-    protected javax.swing.JTextArea status;
-    // End of variables declaration//GEN-END:variables
-    
-    
-    
-    public void update(Observable source, Object parameter) {
-    	if(parameter instanceof Pair) {
-    		Pair p = (Pair)parameter;
-            Object first = p.getFirst();
-            if (first instanceof Task.Message) {
-            	Task.Message msg = (Task.Message)first;
-                Object value = p.getSecond();
-                
-                switch (msg) {
-                case POSITION_CHANGED:
-                    SwingUtilities.invokeLater(new Runnable() {
-                        public void run() {
-                            progress.setValue(task.getPosition());
-                        }
-                    });
-                    break;
-                case MESSAGE_CHANGED:
-                    SwingUtilities.invokeLater(new Runnable() {
-                        public void run() {
-                            status.setText( task.getStatusMessage() );
-                        }
-                    });
-                    break;
-                case STOPPING:
-                case STOPPED:
-                	SwingUtilities.invokeLater(new Runnable() {
-                        public void run() {
-                        	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-                        	cancel.setText(L10n.getString("Common.Hide"));
-                        }
-                    });
-                
-                }
-            }
-    	}
-    	else if (parameter instanceof Exception) {
-            DefaultExceptionHandler.handle(this, (Exception)parameter);
-        }
-    }
-    
-}

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-04 22:38:19 UTC (rev 672)
@@ -6,6 +6,9 @@
     <Property name="title" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
       <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Progress" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
     </Property>
+    <Property name="modal" type="boolean" value="true"/>
+    <Property name="resizable" type="boolean" value="false"/>
+    <Property name="undecorated" type="boolean" value="true"/>
   </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
@@ -20,11 +23,11 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" attributes="0">
+          <Group type="102" alignment="1" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jScrollPane1" alignment="0" pref="380" max="32767" attributes="0"/>
-                  <Component id="jProgressBar1" alignment="0" pref="380" max="32767" attributes="0"/>
+              <Group type="103" groupAlignment="1" attributes="0">
+                  <Component id="status" alignment="0" pref="380" max="32767" attributes="0"/>
+                  <Component id="progress" alignment="0" pref="380" max="32767" attributes="0"/>
                   <Component id="cancel" alignment="1" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
@@ -35,9 +38,9 @@
       <Group type="103" groupAlignment="0" attributes="0">
           <Group type="102" alignment="0" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="jProgressBar1" min="-2" max="-2" attributes="0"/>
+              <Component id="progress" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="jScrollPane1" min="-2" max="-2" attributes="0"/>
+              <Component id="status" min="-2" pref="16" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Component id="cancel" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
@@ -46,40 +49,11 @@
     </DimensionLayout>
   </Layout>
   <SubComponents>
-    <Component class="javax.swing.JProgressBar" name="jProgressBar1">
+    <Component class="javax.swing.JProgressBar" name="progress">
       <AuxValues>
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
-    <Container class="javax.swing.JScrollPane" name="jScrollPane1">
-      <AuxValues>
-        <AuxValue name="autoScrollPane" type="java.lang.Boolean" value="true"/>
-      </AuxValues>
-
-      <Layout class="org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout"/>
-      <SubComponents>
-        <Component class="javax.swing.JTextArea" name="status">
-          <Properties>
-            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
-              <Color blue="ed" green="e9" id="Panel.background" palette="3" red="eb" type="palette"/>
-            </Property>
-            <Property name="columns" type="int" value="20"/>
-            <Property name="editable" type="boolean" value="false"/>
-            <Property name="rows" type="int" value="2"/>
-            <Property name="tabSize" type="int" value="2"/>
-            <Property name="autoscrolls" type="boolean" value="false"/>
-            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
-              <Border info="null"/>
-            </Property>
-            <Property name="enabled" type="boolean" value="false"/>
-            <Property name="focusable" type="boolean" value="false"/>
-          </Properties>
-          <AuxValues>
-            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-          </AuxValues>
-        </Component>
-      </SubComponents>
-    </Container>
     <Component class="javax.swing.JButton" name="cancel">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
@@ -90,5 +64,10 @@
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JLabel" name="status">
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -7,6 +7,8 @@
 package net.sf.plantlore.common;
 
 import java.awt.Cursor;
+import java.awt.Dialog;
+import java.awt.Frame;
 import java.util.Observable;
 import java.util.Observer;
 
@@ -26,10 +28,20 @@
     public SimpleProgressBar2(Task task, java.awt.Frame parent) {
     	super(parent, true);
     	monitoredTask = task;
-    	task.addObserver( this );
+    	initialize();
+    }
+    
+    public SimpleProgressBar2(Task task, java.awt.Dialog parent) {
+    	super(parent, true);
+    	monitoredTask = task;
+    	initialize();
+    }
+    
+    
+    private void initialize() {
+    	monitoredTask.addObserver( this );
     	
         initComponents();
-        
         setLocationRelativeTo(null);
         
         cancel.setAction( new StandardAction("Common.Cancel") {
@@ -38,11 +50,11 @@
         		monitoredTask.deleteObservers();
         		Dispatcher.getDispatcher().finished();
         		
-        		 SwingUtilities.invokeLater(new Runnable() {
-                     public void run() {
-                         setVisible( false );
-                     }
-                 });
+        		SwingUtilities.invokeLater(new Runnable() {
+        			public void run() {
+        				setVisible( false );
+        			}
+        		});
         	}
         });
     }
@@ -54,46 +66,37 @@
      */
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
-        jProgressBar1 = new javax.swing.JProgressBar();
-        jScrollPane1 = new javax.swing.JScrollPane();
-        status = new javax.swing.JTextArea();
+        progress = new javax.swing.JProgressBar();
         cancel = new javax.swing.JButton();
+        status = new javax.swing.JLabel();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
         setTitle(L10n.getString("Common.Progress"));
+        setModal(true);
+        setResizable(false);
+        setUndecorated(true);
 
-        status.setBackground(javax.swing.UIManager.getDefaults().getColor("Panel.background"));
-        status.setColumns(20);
-        status.setEditable(false);
-        status.setRows(2);
-        status.setTabSize(2);
-        status.setAutoscrolls(false);
-        status.setBorder(null);
-        status.setEnabled(false);
-        status.setFocusable(false);
-        jScrollPane1.setViewportView(status);
-
         cancel.setText(L10n.getString("Common.Cancel"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(jProgressBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, cancel))
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
+                    .add(cancel))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(jProgressBar1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(status, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 16, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancel)
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
@@ -104,22 +107,13 @@
         
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton cancel;
-    protected javax.swing.JProgressBar jProgressBar1;
-    private javax.swing.JScrollPane jScrollPane1;
-    protected javax.swing.JTextArea status;
+    protected javax.swing.JProgressBar progress;
+    protected javax.swing.JLabel status;
     // End of variables declaration//GEN-END:variables
     
     
-    @Override
-    public void setVisible(boolean visible) {
-    	super.setVisible(visible);
+	public void update(Observable arg0, Object parameter) {
 
-    }
-    
-    
-	public void update(Observable arg0, Object parameter) {
-		System.out.println(""+parameter);
-		// TODO Auto-generated method stub
 		if(parameter instanceof Pair) {
     		Pair p = (Pair)parameter;
             Object first = p.getFirst();
@@ -130,20 +124,35 @@
                 switch (msg) {
                 case STARTING:
                 	SwingUtilities.invokeLater(new Runnable() {
-                        public void run() {
-                            setVisible(true);
-                        	  setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
-                              cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-                        }
-                    });
+                		public void run() {
+                			setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
+                			cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+                	        if( monitoredTask.isDeterminate() ) {
+                	            progress.setIndeterminate(false);
+                	            progress.setMinimum(0);
+                	            progress.setMaximum(monitoredTask.getLength());
+                	        } else {
+                	            progress.setIndeterminate(true);
+                	        }
+                	        setVisible(true);
+                		}
+                	});
                 
                 case POSITION_CHANGED:
                     SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
-                        	jProgressBar1.setValue(monitoredTask.getPosition());
+                        	 if( monitoredTask.isDeterminate() && progress.isIndeterminate() ) {
+                 	            progress.setIndeterminate(false);
+                 	            progress.setMinimum(0);
+                 	            progress.setMaximum(monitoredTask.getLength());
+                 	        } else if( !monitoredTask.isDeterminate() && !progress.isIndeterminate()){
+                 	            progress.setIndeterminate(true);
+                 	        }
+                        	progress.setValue(monitoredTask.getPosition());
                         }
                     });
                     break;
+                    
                 case MESSAGE_CHANGED:
                     SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
@@ -151,6 +160,7 @@
                         }
                     });
                     break;
+                    
                 case STOPPING:
                 case STOPPED:
                 	SwingUtilities.invokeLater(new Runnable() {
@@ -164,7 +174,9 @@
             }
     	}
     	else if (parameter instanceof Exception) {
-            DefaultExceptionHandler.handle(this, (Exception)parameter);
+    		monitoredTask.stop();
+   			DefaultExceptionHandler.handle(this, (Exception)parameter);
+   			cancel.doClick();
         }
 		
 	}

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -78,7 +78,7 @@
 					
 					// Create and run a new server.
 					Task createServer = model.createNewServerTask( serverPassword );
-					Dispatcher.getDispatcher().dispatch(createServer, view, true);
+					Dispatcher.getDispatcher().dispatch(createServer, view, false);
 					break;
 				
 					
@@ -94,7 +94,7 @@
 					
 					Task connectToServer = model.createConnectToRunningServerTask(
 							view.remoteHost.getText(), port, password );
-					Dispatcher.getDispatcher().dispatch(connectToServer, view, true);
+					Dispatcher.getDispatcher().dispatch(connectToServer, view, false);
 					
 					break;
 				}

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 22:11:28 UTC (rev 671)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-09-04 22:38:19 UTC (rev 672)
@@ -21,21 +21,21 @@
 		view.kick.setAction(new StandardAction("Server.KickUser") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createKickTask( (ConnectionInfo)view.users.getSelectedValue() );
-				Dispatcher.getDispatcher().dispatch(t, view, true);			
+				Dispatcher.getDispatcher().dispatch(t, view, false);			
 			}
 		});
 		
 		view.terminate.setAction(new StandardAction("Server.Terminate") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createTerminateServerTask();
-				Dispatcher.getDispatcher().dispatch(t, view, true);
+				Dispatcher.getDispatcher().dispatch(t, view, false);
 			}
 		});
 		
 		view.refresh.setAction(new StandardAction("Server.Refresh") {
 			public void actionPerformed(ActionEvent arg0) {
 				Task t = model.createUpdateConnectedUsersTask();
-				Dispatcher.getDispatcher().dispatch(t, view, true);
+				Dispatcher.getDispatcher().dispatch(t, view, false);
 			}
 		});
 		



From lada at mail.berlios.de  Tue Sep  5 00:56:41 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 00:56:41 +0200
Subject: [Plantlore-dev] r673 - trunk/src/net/sf/plantlore/server
Message-ID: <200609042256.k84MufSc012357@sheep.berlios.de>

Author: lada
Date: 2006-09-05 00:56:34 +0200 (Tue, 05 Sep 2006)
New Revision: 673

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Fix bug in history: UNDO of occ.metadata, occ.publication, hab.village, hab.territories, hab.phytochoria is working correctly now. (tHistoryChange.cOldRecordId was saving wrong).

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-04 22:38:19 UTC (rev 672)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-04 22:56:34 UTC (rev 673)
@@ -1683,20 +1683,20 @@
                     		// Save OldRecordId if neccessary
                     		 if (((String)columnName).equals(Occurrence.PLANT)) {
                     			 //this situation is improbability (new occurrence is insert into database during editinig of plant)   
-                    			 historyRecord.setOldRecordId(((Plant)newRec.getValue(columnName)).getId());
+                    			 historyRecord.setOldRecordId(((Plant)origRec.getValue(columnName)).getId());
                     			 historyRecord.setOldValue(((Plant)origValue).getTaxon());
                          		 historyRecord.setNewValue(((Plant)newValue).getTaxon());
                     		 } else if (((String)columnName).equals(Occurrence.PUBLICATION)) {
-                    			 historyRecord.setOldRecordId(((Publication)newRec.getValue(columnName)).getId());
+                    			 historyRecord.setOldRecordId(((Publication)origRec.getValue(columnName)).getId());
                                          String referenceCitation = (origValue == null) ? "" : ((Publication)origValue).getReferenceCitation();
                     			 historyRecord.setOldValue(referenceCitation);
                          		 historyRecord.setNewValue(((Publication)newValue).getReferenceCitation());
                     		 } else if (((String)columnName).equals(Occurrence.HABITAT)) {
-                    			 historyRecord.setOldRecordId(((Habitat)newRec.getValue(columnName)).getId());
+                    			 historyRecord.setOldRecordId(((Habitat)origRec.getValue(columnName)).getId());
                     			 historyRecord.setOldValue(((Habitat)origValue).getDescription());
                          		 historyRecord.setNewValue(((Habitat)newValue).getDescription());
                     		 } else if (((String)columnName).equals(Occurrence.METADATA)) {
-                    			 historyRecord.setOldRecordId(((Metadata)newRec.getValue(columnName)).getId());                    			 
+                    			 historyRecord.setOldRecordId(((Metadata)origRec.getValue(columnName)).getId());                    			 
                     			 historyRecord.setOldValue(((Metadata)origValue).getDataSetTitle());
                          		 historyRecord.setNewValue(((Metadata)newValue).getDataSetTitle());
                     		 } else {
@@ -1791,7 +1791,7 @@
                     ArrayList cols = (ArrayList)origRec.getColumns();
                     for (int i=0;i<cols.size();i++) {
                         Object origValue = (origRec.getValue((String)cols.get(i)) == null) ? new String("") : origRec.getValue((String)cols.get(i));                        
-                        Object newValue = (newRec.getValue((String)cols.get(i)) == null) ? new String("") : newRec.getValue((String)cols.get(i));                                                
+                        Object newValue = (newRec.getValue((String)cols.get(i)) == null) ? new String("") : newRec.getValue((String)cols.get(i));                                                                        
                         if (!origValue.equals(newValue)) {
                         	System.out.println(" >> DIFFERENT_COLUMN: " + (String)cols.get(i));
                             // Read record from THISTORYCOLUMN first                           	
@@ -1812,22 +1812,16 @@
                             // Save OldRecordId if neccessary
                             
                     		 //TODO: Save oldRecordId
-                    		 if (((String)cols.get(i)).equals(Habitat.TERRITORY)) { 
-                    			 logger.debug("TERRITORY: " + ((Territory)newRec.getValue((String)cols.get(i))).getId());
-                    			 logger.debug("TERRITORY: " + ((Territory)newRec.getValue((String)cols.get(i))).getName());
-                    			 hist.setOldRecordId(((Territory)newRec.getValue((String)cols.get(i))).getId());
+                    		 if (((String)cols.get(i)).equals(Habitat.TERRITORY)) {                     			 
+                    			 hist.setOldRecordId(((Territory)origRec.getValue((String)cols.get(i))).getId());
                     			 hist.setOldValue(((Territory)origRec.getValue((String)cols.get(i))).getName());
                                  hist.setNewValue(((Territory)newRec.getValue((String)cols.get(i))).getName());
-                    		 } else if (((String)cols.get(i)).equals(Habitat.PHYTOCHORION)) {
-                    			 logger.debug("PHYTOCHORION: " + ((Phytochorion)newRec.getValue((String)cols.get(i))).getId());
-                    			 logger.debug("PHYTOCHORION: " + ((Phytochorion)newRec.getValue((String)cols.get(i))).getName());
-                    			 hist.setOldRecordId(((Phytochorion)newRec.getValue((String)cols.get(i))).getId());
+                    		 } else if (((String)cols.get(i)).equals(Habitat.PHYTOCHORION)) {                    			 
+                    			 hist.setOldRecordId(((Phytochorion)origRec.getValue((String)cols.get(i))).getId());
                     			 hist.setOldValue(((Phytochorion)origRec.getValue((String)cols.get(i))).getName());
                                  hist.setNewValue(((Phytochorion)newRec.getValue((String)cols.get(i))).getName());
-                    		 } else if (((String)cols.get(i)).equals(Habitat.NEARESTVILLAGE)) {
-                    			 logger.debug("VILLAGE: " + ((NearestVillage)newRec.getValue((String)cols.get(i))).getId());
-                    			 logger.debug("VILLAGE: " + ((NearestVillage)newRec.getValue((String)cols.get(i))).getName());
-                    			 hist.setOldRecordId(((NearestVillage)newRec.getValue((String)cols.get(i))).getId());
+                    		 } else if (((String)cols.get(i)).equals(Habitat.NEARESTVILLAGE)) {                    			 
+                    			 hist.setOldRecordId(((NearestVillage)origRec.getValue((String)cols.get(i))).getId());
                     			 hist.setOldValue(((NearestVillage)origRec.getValue((String)cols.get(i))).getName());
                                  hist.setNewValue(((NearestVillage)newRec.getValue((String)cols.get(i))).getName());
                     		 } else {



From fraktalek at mail.berlios.de  Tue Sep  5 01:31:53 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 01:31:53 +0200
Subject: [Plantlore-dev] r674 - in trunk: installer/launch4j
	src/net/sf/plantlore/client
	src/net/sf/plantlore/client/overview/search
	src/net/sf/plantlore/config
Message-ID: <200609042331.k84NVrPi019783@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 01:30:38 +0200 (Tue, 05 Sep 2006)
New Revision: 674

Added:
   trunk/installer/launch4j/launch4j.jar
Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
   trunk/src/net/sf/plantlore/client/overview/search/SearchCtrl.java
   trunk/src/net/sf/plantlore/config/log4j.properties
Log:
Our build script now needs the launch4j.jar to be able to execute, adding it.
Log4j properties back to debug level.
Better exception propagation from search.



Added: trunk/installer/launch4j/launch4j.jar
===================================================================
(Binary files differ)


Property changes on: trunk/installer/launch4j/launch4j.jar
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 22:56:34 UTC (rev 673)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-04 23:30:38 UTC (rev 674)
@@ -495,7 +495,15 @@
 
 					searchModel.setColumns(columns);
 					searchModel.clearAndNotify();
-					searchModel.constructQuery();
+                                        try {
+                                            searchModel.constructQuery();
+                                        } catch (RemoteException ex) {
+                                            DefaultExceptionHandler.handle(view, ex);
+                                            return;
+                                        } catch (DBLayerException ex) {
+                                            DefaultExceptionHandler.handle(view, ex);
+                                            return;
+                                        }
 				}
 				if (s.equals("DYNAMIC_PAGE_LOADING")) {
 					model.dynamicPageLoading = prefs.getBoolean(
@@ -977,7 +985,16 @@
                             case HABITAT:
                                 searchModel.clearAndNotify();
                                 searchModel.setHabitatId(nodeInfo.getId());
-                                searchModel.constructQuery();
+
+                                try {
+                                    searchModel.constructQuery();
+                                } catch (RemoteException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                } catch (DBLayerException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                }
                         }//switch
                     }//if search
                     
@@ -1720,14 +1737,23 @@
 
                                 view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
                                 searchModel.clearAndNotify();
-                                searchModel.constructQuery();
+                                
+                                try {
+                                    searchModel.constructQuery();
+                                } catch (RemoteException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                } catch (DBLayerException ex) {
+                                    DefaultExceptionHandler.handle(view, ex);
+                                    return;
+                                }
 
                                 view.getSBM().displayDefaultText();
 
                                 view.initOverview();
                                 view.setCursor(Cursor.getDefaultCursor());
                                 setDatabaseDependentCommandsEnabled(true);
-
+                                logger.debug("======= rows: "+model.getResultsCount());
                                 //this can't be done earlier. must be done after the query is created
                                 //otherwise this listener would give the overview table model commands to load data
                                 //for a query that doesn't exist yet
@@ -1771,7 +1797,7 @@
 			Task task = new Task() {
 				public Object task() throws DBLayerException, RemoteException {
                                     //refreshAction.setEnabled(false);
-                                    setStatusMessage("Loading overview data...");
+                                    setStatusMessage(L10n.getString("Overview.Message.LoadingOccurrences"));
 					searchModel.clear();
 					searchModel.constructQuery();
 					fireStopped(null);
@@ -1781,14 +1807,21 @@
 			return task;
 		} else {
 			searchModel.clear();
-			searchModel.constructQuery();
+                        try {
+                            searchModel.constructQuery();
+                        } catch (DBLayerException ex) {
+                            DefaultExceptionHandler.handle(view, ex);
+                            return null;
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view, ex);
+                            return null;
+                        }
 			return null;
 		}
 	}
 
         /** Handles the refresh action invoked from overview. */
 	class RefreshAction extends AbstractAction {
-            String prom = "Promenna z refresh action.";
             Task task = refreshOverview(true);
             
 		public RefreshAction() {
@@ -1815,7 +1848,7 @@
                             }
                         };*/
 
-			System.out.println("Dispatcher: "+Dispatcher.getDispatcher().dispatch(task, view, true));
+			Dispatcher.getDispatcher().dispatch(task, view, true);
 		}
 
 	}

Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-04 22:56:34 UTC (rev 673)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-04 23:30:38 UTC (rev 674)
@@ -628,7 +628,7 @@
     
     
     
-    public SelectQuery constructQuery() {
+    public SelectQuery constructQuery() throws DBLayerException, RemoteException {
         DBLayerUtils dlu = new DBLayerUtils(database);
         SelectQuery sq = null;
         // ExportQuery restriction storage requires these variables.
@@ -636,292 +636,285 @@
         Object arg;
         String habitatAlias = Record.alias(Habitat.class) +".";
         
-            //FIXME:
-            try {
-                // Create subquery first
-                SelectQuery subQuery = database.createSubQuery(AuthorOccurrence.class, "ao");
-                // In the subquery select authors for the given occurrence (occurrence comes from the main query)
-                subQuery.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, "ao."+AuthorOccurrence.OCCURRENCE, "occ."+Occurrence.ID, null, null);
-                subQuery.addRestriction(PlantloreConstants.RESTR_EQ, "ao."+AuthorOccurrence.DELETED, null, 0, null);
-                subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY, AuthorOccurrence.AUTHOR);
-                // create the main query
-                sq = database.createQuery(AuthorOccurrence.class);
-                sq.createAlias(AuthorOccurrence.AUTHOR,"author");
-                sq.createAlias(AuthorOccurrence.OCCURRENCE,"occ");                
-                sq.createAlias("occ."+Occurrence.HABITAT,"habitat");
-                sq.createAlias("occ."+Occurrence.PLANT,"plant");
-                // Add publications using LEFT OUTER JOIN - so that occurrences without a publication are displayed as well
-                sq.createAlias("occ."+Occurrence.PUBLICATION,"publication", PlantloreConstants.LEFT_OUTER_JOIN);
-                sq.createAlias("occ."+Occurrence.METADATA,"metadata");
-                sq.createAlias("habitat."+Habitat.PHYTOCHORION,"phyt");
-                sq.createAlias("habitat."+Habitat.NEARESTVILLAGE,"vill");
-                sq.createAlias("habitat."+Habitat.TERRITORY,"territory");
-                // Add subquery to the query. Compare authoroccurrence.authorid with the result of a subquery (LEALL: <= all(...))
-                sq.addRestriction(PlantloreConstants.SUBQUERY_LEALL, AuthorOccurrence.AUTHOR, null, subQuery, null);    
-                sq.addRestriction(PlantloreConstants.RESTR_EQ, AuthorOccurrence.DELETED, null, 0, null);
-                sq.addOrder(PlantloreConstants.DIRECT_DESC, "occ."+Occurrence.YEARCOLLECTED); //setridit podle roku
-                sq.addRestriction(PlantloreConstants.RESTR_EQ, "occ."+Occurrence.DELETED, null, 0, null);
-                for (Column column : columns) {
-                    switch (column.type) {
-                        case AUTHOR:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"author."+Author.WHOLENAME);
-                            break;
-                        case HABITAT_ALTITUDE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.ALTITUDE);
-                            break;
-                        case HABITAT_COUNTRY:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.COUNTRY);
-                            break;
-                        case HABITAT_DESCRIPTION:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.DESCRIPTION);                    
-                            break;
-                        case HABITAT_LATITUDE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LATITUDE);
-                            break;
-                        case HABITAT_LONGITUDE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LONGITUDE);
-                            break;
-                        case HABITAT_NEAREST_VILLAGE_NAME:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"vill."+NearestVillage.NAME);
-                            break;
-                        case HABITAT_NOTE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.NOTE);
-                            break;
-                        case HABITAT_QUADRANT:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.QUADRANT);
-                            break;
-                        case METADATA_DATASETTITLE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"metadata."+Metadata.DATASETTITLE);
-                            break;
-                        case NUMBER:
-                            break;
-                        case OCCURRENCE_DATASOURCE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.DATASOURCE);
-                            break;
-                        case OCCURRENCE_DAYCOLLECTED:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.DAYCOLLECTED);
-                            break;
-                        case OCCURRENCE_HERBARIUM:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.HERBARIUM);
-                            break;
-                        case OCCURRENCE_ID:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.ID);                            
-                            break;
-                        case OCCURRENCE_MONTHCOLLECTED:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.MONTHCOLLECTED);
-                            break;
-                        case OCCURRENCE_NOTE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.NOTE);
-                            break;
-                        case OCCURRENCE_TIMECOLLECTED:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.TIMECOLLECTED);
-                            break;
-                        case OCCURRENCE_YEARCOLLECTED:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.YEARCOLLECTED);
-                            break;
-                        case PHYTOCHORION_CODE:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.CODE);                    
-                            break;
-                        case PHYTOCHORION_NAME:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.NAME);                    
-                            break;
-                        case PLANT_TAXON:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"plant."+Plant.TAXON);
-                            break;
-                        case PUBLICATION_COLLECTIONNAME:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"publication."+Publication.REFERENCECITATION);
-                            break;
-                        case SELECTION:
-                            break;
-                        case TERRITORY_NAME:
-                            sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"territory."+Territory.NAME);
-                            break;
-                        default:                                                
-                    }
+            // Create subquery first
+            SelectQuery subQuery = database.createSubQuery(AuthorOccurrence.class, "ao");
+            // In the subquery select authors for the given occurrence (occurrence comes from the main query)
+            subQuery.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, "ao."+AuthorOccurrence.OCCURRENCE, "occ."+Occurrence.ID, null, null);
+            subQuery.addRestriction(PlantloreConstants.RESTR_EQ, "ao."+AuthorOccurrence.DELETED, null, 0, null);
+            subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY, AuthorOccurrence.AUTHOR);
+            // create the main query
+            sq = database.createQuery(AuthorOccurrence.class);
+            sq.createAlias(AuthorOccurrence.AUTHOR,"author");
+            sq.createAlias(AuthorOccurrence.OCCURRENCE,"occ");                
+            sq.createAlias("occ."+Occurrence.HABITAT,"habitat");
+            sq.createAlias("occ."+Occurrence.PLANT,"plant");
+            // Add publications using LEFT OUTER JOIN - so that occurrences without a publication are displayed as well
+            sq.createAlias("occ."+Occurrence.PUBLICATION,"publication", PlantloreConstants.LEFT_OUTER_JOIN);
+            sq.createAlias("occ."+Occurrence.METADATA,"metadata");
+            sq.createAlias("habitat."+Habitat.PHYTOCHORION,"phyt");
+            sq.createAlias("habitat."+Habitat.NEARESTVILLAGE,"vill");
+            sq.createAlias("habitat."+Habitat.TERRITORY,"territory");
+            // Add subquery to the query. Compare authoroccurrence.authorid with the result of a subquery (LEALL: <= all(...))
+            sq.addRestriction(PlantloreConstants.SUBQUERY_LEALL, AuthorOccurrence.AUTHOR, null, subQuery, null);    
+            sq.addRestriction(PlantloreConstants.RESTR_EQ, AuthorOccurrence.DELETED, null, 0, null);
+            sq.addOrder(PlantloreConstants.DIRECT_DESC, "occ."+Occurrence.YEARCOLLECTED); //setridit podle roku
+            sq.addRestriction(PlantloreConstants.RESTR_EQ, "occ."+Occurrence.DELETED, null, 0, null);
+            for (Column column : columns) {
+                switch (column.type) {
+                    case AUTHOR:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"author."+Author.WHOLENAME);
+                        break;
+                    case HABITAT_ALTITUDE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.ALTITUDE);
+                        break;
+                    case HABITAT_COUNTRY:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.COUNTRY);
+                        break;
+                    case HABITAT_DESCRIPTION:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.DESCRIPTION);                    
+                        break;
+                    case HABITAT_LATITUDE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LATITUDE);
+                        break;
+                    case HABITAT_LONGITUDE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LONGITUDE);
+                        break;
+                    case HABITAT_NEAREST_VILLAGE_NAME:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"vill."+NearestVillage.NAME);
+                        break;
+                    case HABITAT_NOTE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.NOTE);
+                        break;
+                    case HABITAT_QUADRANT:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.QUADRANT);
+                        break;
+                    case METADATA_DATASETTITLE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"metadata."+Metadata.DATASETTITLE);
+                        break;
+                    case NUMBER:
+                        break;
+                    case OCCURRENCE_DATASOURCE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.DATASOURCE);
+                        break;
+                    case OCCURRENCE_DAYCOLLECTED:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.DAYCOLLECTED);
+                        break;
+                    case OCCURRENCE_HERBARIUM:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.HERBARIUM);
+                        break;
+                    case OCCURRENCE_ID:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.ID);                            
+                        break;
+                    case OCCURRENCE_MONTHCOLLECTED:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.MONTHCOLLECTED);
+                        break;
+                    case OCCURRENCE_NOTE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.NOTE);
+                        break;
+                    case OCCURRENCE_TIMECOLLECTED:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.TIMECOLLECTED);
+                        break;
+                    case OCCURRENCE_YEARCOLLECTED:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"occ."+Occurrence.YEARCOLLECTED);
+                        break;
+                    case PHYTOCHORION_CODE:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.CODE);                    
+                        break;
+                    case PHYTOCHORION_NAME:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.NAME);                    
+                        break;
+                    case PLANT_TAXON:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"plant."+Plant.TAXON);
+                        break;
+                    case PUBLICATION_COLLECTIONNAME:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"publication."+Publication.REFERENCECITATION);
+                        break;
+                    case SELECTION:
+                        break;
+                    case TERRITORY_NAME:
+                        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"territory."+Territory.NAME);
+                        break;
+                    default:                                                
                 }
-                
-                if (isNotEmpty(village)) {
-                	arg = dlu.getObjectFor(village.getSecond(),NearestVillage.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.NEARESTVILLAGE,null,arg,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.NEARESTVILLAGE, arg));
-                }
-                
-                int notEmpty = 0;
+            }
+
+            if (isNotEmpty(village)) {
+                    arg = dlu.getObjectFor(village.getSecond(),NearestVillage.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.NEARESTVILLAGE,null,arg,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.NEARESTVILLAGE, arg));
+            }
+
+            int notEmpty = 0;
+            for (int i = 0; i < authorList.size(); i++) {
+                Pair<Pair<String,Integer>,String> authorPair = authorList.get(i);
+                if (isNotEmpty(authorPair.getFirst()))
+                    notEmpty++;
+                if (isNotEmpty(authorPair.getSecond()))
+                    notEmpty++;
+            }
+
+            if (notEmpty > 0) {
+                Object[] args = new Object[notEmpty*4];
+                int conditionNumber = 0;
                 for (int i = 0; i < authorList.size(); i++) {
                     Pair<Pair<String,Integer>,String> authorPair = authorList.get(i);
-                    if (isNotEmpty(authorPair.getFirst()))
-                        notEmpty++;
-                    if (isNotEmpty(authorPair.getSecond()))
-                        notEmpty++;
-                }
-                
-                if (notEmpty > 0) {
-                    Object[] args = new Object[notEmpty*4];
-                    int conditionNumber = 0;
-                    for (int i = 0; i < authorList.size(); i++) {
-                        Pair<Pair<String,Integer>,String> authorPair = authorList.get(i);
-                        if (isNotEmpty(authorPair.getFirst())) {
-                            args[4*conditionNumber] = PlantloreConstants.RESTR_EQ;
-                            args[4*conditionNumber+1] = AuthorOccurrence.AUTHOR;
-                            args[4*conditionNumber+2] = null;
-                            args[4*conditionNumber+3] = dlu.getObjectFor(authorPair.getFirst().getSecond(),Author.class);
-                            conditionNumber++;
-                        }
-                        if (isNotEmpty(authorPair.getSecond())) {
-                            args[4*conditionNumber] = PlantloreConstants.RESTR_EQ;
-                            args[4*conditionNumber+1] = AuthorOccurrence.ROLE;
-                            args[4*conditionNumber+2] = null;
-                            args[4*conditionNumber+3] = authorPair.getSecond();
-                            conditionNumber++;
-                        }
+                    if (isNotEmpty(authorPair.getFirst())) {
+                        args[4*conditionNumber] = PlantloreConstants.RESTR_EQ;
+                        args[4*conditionNumber+1] = AuthorOccurrence.AUTHOR;
+                        args[4*conditionNumber+2] = null;
+                        args[4*conditionNumber+3] = dlu.getObjectFor(authorPair.getFirst().getSecond(),Author.class);
+                        conditionNumber++;
                     }
-                    sq.addOrRestriction(args);
-                    //ExportQuery is over the Occurrence table!   exportQuery.addOrRestriction(args); 
-                }
-
-                notEmpty = 0;
-                if (taxonList != null)
-                    for (int i = 0; i < taxonList.size(); i++) {
-                        if (isNotEmpty(taxonList.get(i)))
-                            notEmpty++;
+                    if (isNotEmpty(authorPair.getSecond())) {
+                        args[4*conditionNumber] = PlantloreConstants.RESTR_EQ;
+                        args[4*conditionNumber+1] = AuthorOccurrence.ROLE;
+                        args[4*conditionNumber+2] = null;
+                        args[4*conditionNumber+3] = authorPair.getSecond();
+                        conditionNumber++;
                     }
-                
-                if (notEmpty > 0) {
-                    Object[] args = new Object[notEmpty*4], exportQueryArgs = new Object[notEmpty*4];
-                    for (int i = 0; i < taxonList.size(); i++) {
-                        String taxon = taxonList.get(i);
-                        if (isNotEmpty(taxon)) {
-                            args[4*i] = exportQueryArgs[4*i] = PlantloreConstants.RESTR_EQ;
-                            args[4*i+1] = "occ."+Occurrence.PLANT; exportQueryArgs[4*i+1] = Occurrence.PLANT; 
-                            args[4*i+2] = exportQueryArgs[4*i+2] = null;
-                            args[4*i+3] = exportQueryArgs[4*i+3] = dlu.getObjectFor(lookupPlant(taxon),Plant.class);
-                        }
-                    }
-                    sq.addOrRestriction(args);
-                    restrictions.add(new Restriction(-1, null, exportQueryArgs));
                 }
-                if (isNotEmpty(localityDescription)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"habitat."+Habitat.DESCRIPTION,null,"%"+localityDescription+"%",null);
-                    restrictions.add(new Restriction(RESTR_ILIKE, habitatAlias+Habitat.DESCRIPTION, "%"+localityDescription+"%"));
-                }
-                
-                if (isNotEmpty(occurrenceNote)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"occ."+Occurrence.NOTE,null,"%"+occurrenceNote+"%",null);
-                    restrictions.add(new Restriction(RESTR_ILIKE, Occurrence.NOTE, "%"+occurrenceNote+"%"));
-                }
-                
-                if (isNotEmpty(habitatId)) {
-                    arg = dlu.getObjectFor(habitatId,Habitat.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.HABITAT,null,arg,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.HABITAT, arg));                    
-                }
-                
-                if (isNotEmpty(habitatNote)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"habitat."+Habitat.NOTE,null,"%"+habitatNote+"%",null);
-                    restrictions.add(new Restriction(RESTR_ILIKE, habitatAlias+Habitat.NOTE, "%"+habitatNote+"%"));
-                }
-                
-                if (isNotEmpty(territoryName)) {
-                	arg = dlu.getObjectFor(territoryName.getSecond(),Territory.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.TERRITORY,null, arg, null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.TERRITORY, arg));
-                }
-                
-                if (isNotEmpty(phytName)) {
-                	arg = dlu.getObjectFor(phytName.getSecond(),Phytochorion.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.PHYTOCHORION,null,arg,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.PHYTOCHORION, arg));
-                }
-                
-                if (isNotEmpty(phytCountry)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.COUNTRY,null,phytCountry,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.COUNTRY, phytCountry));
-                }
-                
-                if (isNotEmpty(quadrant)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.QUADRANT,null,quadrant,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.QUADRANT, quadrant));
-                }
-                
-                if (isNotEmpty(altitude)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.ALTITUDE,null,altitude,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.ALTITUDE, altitude));
-                }
-                
-                if (isNotEmpty(longitude)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.LONGITUDE,null,longitude,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.LONGITUDE, longitude));
-                }
+                sq.addOrRestriction(args);
+                //ExportQuery is over the Occurrence table!   exportQuery.addOrRestriction(args); 
+            }
 
-                if (isNotEmpty(latitude)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.LATITUDE,null,latitude,null);
-                    restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.LATITUDE, latitude));
+            notEmpty = 0;
+            if (taxonList != null)
+                for (int i = 0; i < taxonList.size(); i++) {
+                    if (isNotEmpty(taxonList.get(i)))
+                        notEmpty++;
                 }
 
-                if (isNotEmpty(source)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.DATASOURCE,null,source,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.DATASOURCE, source));
+            if (notEmpty > 0) {
+                Object[] args = new Object[notEmpty*4], exportQueryArgs = new Object[notEmpty*4];
+                for (int i = 0; i < taxonList.size(); i++) {
+                    String taxon = taxonList.get(i);
+                    if (isNotEmpty(taxon)) {
+                        args[4*i] = exportQueryArgs[4*i] = PlantloreConstants.RESTR_EQ;
+                        args[4*i+1] = "occ."+Occurrence.PLANT; exportQueryArgs[4*i+1] = Occurrence.PLANT; 
+                        args[4*i+2] = exportQueryArgs[4*i+2] = null;
+                        args[4*i+3] = exportQueryArgs[4*i+3] = dlu.getObjectFor(lookupPlant(taxon),Plant.class);
+                    }
                 }
-                
-                if (isNotEmpty(publication)) {
-                    //FIXME: mozna pridat addOrRestriction na vsechny relevantni sloupky Publication
-                	arg = dlu.getObjectFor(publication.getSecond(),Publication.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.PUBLICATION,null,arg,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.PUBLICATION, arg));
-                }
-                
-                if (isNotEmpty(herbarium)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.HERBARIUM,null,herbarium,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.HERBARIUM, herbarium));
-                }
-                
-                if (isNotEmpty(project)) {
-                	arg = dlu.getObjectFor(project.getSecond(),Metadata.class);
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.METADATA,null,arg,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.METADATA, arg));
-                }
-                
-                if (timeChoice == INTERVAL && isNotEmpty(fromDate)) {
-                    Calendar from = Calendar.getInstance(), to = Calendar.getInstance();
-                    from.setTime(fromDate); to.setTime(toDate);
-                    
-                    //set the begining of the day
-                    from.set(Calendar.HOUR_OF_DAY,0);
-                    from.set(Calendar.MINUTE, 0);
-                    from.set(Calendar.SECOND, 0);
-                    from.set(Calendar.MILLISECOND, 0);
+                sq.addOrRestriction(args);
+                restrictions.add(new Restriction(-1, null, exportQueryArgs));
+            }
+            if (isNotEmpty(localityDescription)) {
+                sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"habitat."+Habitat.DESCRIPTION,null,"%"+localityDescription+"%",null);
+                restrictions.add(new Restriction(RESTR_ILIKE, habitatAlias+Habitat.DESCRIPTION, "%"+localityDescription+"%"));
+            }
 
-                    //set the end of the day
-                    to.set(Calendar.HOUR_OF_DAY,23);
-                    to.set(Calendar.MINUTE, 59);
-                    to.set(Calendar.SECOND, 59);
-                    to.set(Calendar.MILLISECOND, 999);
-                    
-                    ArrayList a = new ArrayList();
-                    a.add(from.getTime());
-                    a.add(to.getTime());
-                    System.out.println("Searching between "+from.getTime()+" and "+to.getTime());
-                    sq.addRestriction(PlantloreConstants.RESTR_BETWEEN,"occ."+Occurrence.ISODATETIMEBEGIN,null,null,a);
-                    
-                    restrictions.add(new Restriction(RESTR_BETWEEN, Occurrence.ISODATETIMEBEGIN, a));
-                }
-                
-                if (timeChoice == MONTH && isNotEmpty(month)) {
-                    sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.MONTHCOLLECTED,null,month,null);
-                    restrictions.add(new Restriction(RESTR_EQ, Occurrence.MONTHCOLLECTED, month));
-                }
-                int resultId = database.executeQuery(sq);
-                this.newResultId = resultId;
-                this.newSelectQuery = sq;
-                logger.debug("Created new query. Number of results: "+database.getNumRows(resultId));
-                //let the SearchBridge in AppCoreCtrl know that new result is there
-                setChanged(); 
-                notifyObservers(resultId);
-            } catch (RemoteException ex) {                
-                ex.printStackTrace();
-            } catch (DBLayerException ex) {
-                ex.printStackTrace();
+            if (isNotEmpty(occurrenceNote)) {
+                sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"occ."+Occurrence.NOTE,null,"%"+occurrenceNote+"%",null);
+                restrictions.add(new Restriction(RESTR_ILIKE, Occurrence.NOTE, "%"+occurrenceNote+"%"));
             }
+
+            if (isNotEmpty(habitatId)) {
+                arg = dlu.getObjectFor(habitatId,Habitat.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.HABITAT,null,arg,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.HABITAT, arg));                    
+            }
+
+            if (isNotEmpty(habitatNote)) {
+                sq.addRestriction(PlantloreConstants.RESTR_ILIKE,"habitat."+Habitat.NOTE,null,"%"+habitatNote+"%",null);
+                restrictions.add(new Restriction(RESTR_ILIKE, habitatAlias+Habitat.NOTE, "%"+habitatNote+"%"));
+            }
+
+            if (isNotEmpty(territoryName)) {
+                    arg = dlu.getObjectFor(territoryName.getSecond(),Territory.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.TERRITORY,null, arg, null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.TERRITORY, arg));
+            }
+
+            if (isNotEmpty(phytName)) {
+                    arg = dlu.getObjectFor(phytName.getSecond(),Phytochorion.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.PHYTOCHORION,null,arg,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.PHYTOCHORION, arg));
+            }
+
+            if (isNotEmpty(phytCountry)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.COUNTRY,null,phytCountry,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.COUNTRY, phytCountry));
+            }
+
+            if (isNotEmpty(quadrant)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.QUADRANT,null,quadrant,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.QUADRANT, quadrant));
+            }
+
+            if (isNotEmpty(altitude)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.ALTITUDE,null,altitude,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.ALTITUDE, altitude));
+            }
+
+            if (isNotEmpty(longitude)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.LONGITUDE,null,longitude,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.LONGITUDE, longitude));
+            }
+
+            if (isNotEmpty(latitude)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"habitat."+Habitat.LATITUDE,null,latitude,null);
+                restrictions.add(new Restriction(RESTR_EQ, habitatAlias+Habitat.LATITUDE, latitude));
+            }
+
+            if (isNotEmpty(source)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.DATASOURCE,null,source,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.DATASOURCE, source));
+            }
+
+            if (isNotEmpty(publication)) {
+                //FIXME: mozna pridat addOrRestriction na vsechny relevantni sloupky Publication
+                    arg = dlu.getObjectFor(publication.getSecond(),Publication.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.PUBLICATION,null,arg,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.PUBLICATION, arg));
+            }
+
+            if (isNotEmpty(herbarium)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.HERBARIUM,null,herbarium,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.HERBARIUM, herbarium));
+            }
+
+            if (isNotEmpty(project)) {
+                    arg = dlu.getObjectFor(project.getSecond(),Metadata.class);
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.METADATA,null,arg,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.METADATA, arg));
+            }
+
+            if (timeChoice == INTERVAL && isNotEmpty(fromDate)) {
+                Calendar from = Calendar.getInstance(), to = Calendar.getInstance();
+                from.setTime(fromDate); to.setTime(toDate);
+
+                //set the begining of the day
+                from.set(Calendar.HOUR_OF_DAY,0);
+                from.set(Calendar.MINUTE, 0);
+                from.set(Calendar.SECOND, 0);
+                from.set(Calendar.MILLISECOND, 0);
+
+                //set the end of the day
+                to.set(Calendar.HOUR_OF_DAY,23);
+                to.set(Calendar.MINUTE, 59);
+                to.set(Calendar.SECOND, 59);
+                to.set(Calendar.MILLISECOND, 999);
+
+                ArrayList a = new ArrayList();
+                a.add(from.getTime());
+                a.add(to.getTime());
+                System.out.println("Searching between "+from.getTime()+" and "+to.getTime());
+                sq.addRestriction(PlantloreConstants.RESTR_BETWEEN,"occ."+Occurrence.ISODATETIMEBEGIN,null,null,a);
+
+                restrictions.add(new Restriction(RESTR_BETWEEN, Occurrence.ISODATETIMEBEGIN, a));
+            }
+
+            if (timeChoice == MONTH && isNotEmpty(month)) {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.MONTHCOLLECTED,null,month,null);
+                restrictions.add(new Restriction(RESTR_EQ, Occurrence.MONTHCOLLECTED, month));
+            }
+            int resultId = database.executeQuery(sq);
+            this.newResultId = resultId;
+            this.newSelectQuery = sq;
+            logger.debug("Created new query. Number of results: "+database.getNumRows(resultId));
+            //let the SearchBridge in AppCoreCtrl know that new result is there
+            setChanged(); 
+            notifyObservers(resultId);
         return sq;
     }
     

Modified: trunk/src/net/sf/plantlore/client/overview/search/SearchCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/SearchCtrl.java	2006-09-04 22:56:34 UTC (rev 673)
+++ trunk/src/net/sf/plantlore/client/overview/search/SearchCtrl.java	2006-09-04 23:30:38 UTC (rev 674)
@@ -40,9 +40,11 @@
 import net.sf.plantlore.client.*;
 import net.sf.plantlore.client.overview.*;
 import net.sf.plantlore.common.AutoTextArea;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Pair;
 import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.PlantloreHelp;
+import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.Habitat;
 import net.sf.plantlore.common.record.Occurrence;
@@ -472,8 +474,16 @@
                 JOptionPane.showMessageDialog(view,check.getSecond());
                 return;
             }
-            
-            model.constructQuery();
+            try {
+                
+                model.constructQuery();
+            } catch (DBLayerException ex) {
+                DefaultExceptionHandler.handle(view, ex);
+                return;
+            } catch (RemoteException ex) {
+                DefaultExceptionHandler.handle(view, ex);
+                return;
+            }
             view.setVisible(false);
         }
     }//OkButtonListener

Modified: trunk/src/net/sf/plantlore/config/log4j.properties
===================================================================
--- trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-04 22:56:34 UTC (rev 673)
+++ trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-04 23:30:38 UTC (rev 674)
@@ -1,5 +1,5 @@
 ### set log levels - for more verbose logging change 'info' to 'debug' ###
-log4j.rootLogger=info, stdout
+log4j.rootLogger=debug, stdout
 
 ### direct log messages to stdout ###
 log4j.appender.stdout=org.apache.log4j.ConsoleAppender



From lada at mail.berlios.de  Tue Sep  5 08:53:41 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 08:53:41 +0200
Subject: [Plantlore-dev] r675 -
	trunk/src/biocase/DataproBioCASE/www/querytool
Message-ID: <200609050653.k856rfFu006255@sheep.berlios.de>

Author: lada
Date: 2006-09-05 08:53:27 +0200 (Tue, 05 Sep 2006)
New Revision: 675

Modified:
   trunk/src/biocase/DataproBioCASE/www/querytool/raw.cgi
Log:
Fix bug: don`t write info to file.

Modified: trunk/src/biocase/DataproBioCASE/www/querytool/raw.cgi
===================================================================
--- trunk/src/biocase/DataproBioCASE/www/querytool/raw.cgi	2006-09-04 23:30:38 UTC (rev 674)
+++ trunk/src/biocase/DataproBioCASE/www/querytool/raw.cgi	2006-09-05 06:53:27 UTC (rev 675)
@@ -38,11 +38,8 @@
 # generate the protocol
 QG = QueryGenerator(protocol)
 
-ff = open("infoXML.txt",'w')
-ff.write(str(schemaObj) + "\n\n")  
 protocolXML = QG.getSearchProtocol(NS=schemaObj.NS, respNS=schemaObj.NS, count=False, filterObj=filterObj, destination=wrapper_url)
 log.info("QUERY PROTOCOL CREATED:\n%s"%protocolXML)
-ff.write(str(protocolXML))
 # query the wrapper
 QD = QueryDispatcher(protocolNS=protocol)
 recStatus = QD.sendQuery(wrapper_url, protocolXML, security_role=security_role)



From lada at mail.berlios.de  Tue Sep  5 11:01:47 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 11:01:47 +0200
Subject: [Plantlore-dev] r676 - trunk/src/net/sf/plantlore/client/metadata
Message-ID: <200609050901.k8591lM7022831@sheep.berlios.de>

Author: lada
Date: 2006-09-05 11:01:43 +0200 (Tue, 05 Sep 2006)
New Revision: 676

Modified:
   trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
Log:
Fix bug: Propagates changes made in metadata manager to AppCore (NotifyObserver must be call without task).

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-05 06:53:27 UTC (rev 675)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-05 09:01:43 UTC (rev 676)
@@ -372,10 +372,7 @@
 		        	logger.error("Process add metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                    
                                 throw e; 		            
-		        } 		       
-		        //Tell AppCore observerber
-		        setChanged(); 
-		        notifyObservers(editTypeArray);	
+		        } 		       		      
 		        setInfoFinishedTask(true);
 		        return null;
     		}
@@ -400,16 +397,21 @@
 		        	logger.error("Process update metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                   
                                 throw e; 		            
-		        } 		        
-		        //Tell AppCore observerber
-		        setChanged(); 
-		        notifyObservers(editTypeArray);	
+		        } 		        		        
 		        setInfoFinishedTask(true);
 		        return null;
     		}
-	    };
-	    return task;
+	    };            
+	    return task;            
     } 
+    
+    /**
+     * Propagates changes made in metadata manager to the rest of the application.
+     */
+    public void callNotifyObserver() {
+        setChanged(); 
+        notifyObservers(editTypeArray); 
+    }
     	    	    	
     /**     
      *  Update metadata in the database. To-be-updated metadata is stored in <code>metadataRecord</code> field.
@@ -427,10 +429,7 @@
 		        }catch (Exception e) {
 		        	logger.error("Process delete metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());		        	
                                 throw e; 		            
-		        } 			        
-		        //Tell AppCore observerber
-		        setChanged(); 
-		        notifyObservers(editTypeArray);		
+		        } 			        		       
 		        setInfoFinishedTask(true);
 		        return null;
     		}

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-05 06:53:27 UTC (rev 675)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-05 09:01:43 UTC (rev 676)
@@ -260,7 +260,8 @@
                            model.setError(null);
     	        	   return;
     	           }    	           
-    	           reloadData(1, model.getDisplayRows());    	                   
+    	           reloadData(1, model.getDisplayRows());   
+                   model.callNotifyObserver();
                } 		   		               
            });
            Dispatcher.getDispatcher().dispatch(task, view, false);
@@ -326,7 +327,8 @@
                          model.setInfoFinishedTask(false);
                        //load metadata          				
                         if (model.isError()) return;
-                        view.tableMetadataList.setModel(new MetadataManagerTableModel(model));                         
+                        view.tableMetadataList.setModel(new MetadataManagerTableModel(model));  
+                        model.callNotifyObserver();
                      } 		   					                   
                });
                Dispatcher.getDispatcher().dispatch(task, view, false);
@@ -429,7 +431,8 @@
                                                 model.setException(null);
                                                return;
                                            }
-                                           reloadData(1, model.getDisplayRows());		   	              		   	               
+                                           reloadData(1, model.getDisplayRows());
+                                           model.callNotifyObserver();
         		                }//afterStopped 		   					                                   
                                });
                                Dispatcher.getDispatcher().dispatch(task, view, false);

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-05 06:53:27 UTC (rev 675)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-05 09:01:43 UTC (rev 676)
@@ -484,17 +484,7 @@
         pack();
     }// </editor-fold>//GEN-END:initComponents
     
-    /**
-     * @param args the command line arguments
-     */
-    public static void main(String args[]) {
-        java.awt.EventQueue.invokeLater(new Runnable() {
-            public void run() {
-                new MetadataManagerView(null, new javax.swing.JFrame(), true).setVisible(true);
-            }
-        });
-    }
-    
+   
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton addButtons;
     protected javax.swing.JButton closeButton;



From krater at mail.berlios.de  Tue Sep  5 11:06:19 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 11:06:19 +0200
Subject: [Plantlore-dev] r677 - in trunk/src/net/sf/plantlore: client/export
	common
Message-ID: <200609050906.k8596JYl025514@sheep.berlios.de>

Author: krater
Date: 2006-09-05 11:06:17 +0200 (Tue, 05 Sep 2006)
New Revision: 677

Modified:
   trunk/src/net/sf/plantlore/client/export/ExportMng2.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
Log:
SimpleProgressBar2 finished. Also export was updated to display the proper length of the task (and ignore those that are dead).

Modified: trunk/src/net/sf/plantlore/client/export/ExportMng2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-05 09:01:43 UTC (rev 676)
+++ trunk/src/net/sf/plantlore/client/export/ExportMng2.java	2006-09-05 09:06:17 UTC (rev 677)
@@ -1,5 +1,7 @@
 package net.sf.plantlore.client.export;
 
+import static net.sf.plantlore.common.PlantloreConstants.RESTR_EQ;
+
 import java.io.BufferedWriter;
 import java.io.FileOutputStream;
 import java.io.IOException;
@@ -259,6 +261,9 @@
 		
 		logger.debug("Creating necessary participants.");
 		projections.set(Occurrence.class, Occurrence.ID);
+		projections.set(Occurrence.class, Deletable.DELETED);
+		projections.set(AuthorOccurrence.class, Deletable.DELETED);
+		projections.set(Habitat.class, Deletable.DELETED);
 		
 		// Prepare the query for projections.
 		if(useProjections) {
@@ -298,6 +303,9 @@
 			writer.close();
 			(new java.io.File(filename)).delete();
 		}
+		
+		if( format.ignoreDead() )
+			query.addRestriction(RESTR_EQ, Deletable.DELETED, null, 0, null);
 
 		// Create the task!
 		ExportTask2 t;

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-05 09:01:43 UTC (rev 676)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-05 09:06:17 UTC (rev 677)
@@ -23,51 +23,80 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" alignment="1" attributes="0">
-              <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="1" attributes="0">
-                  <Component id="status" alignment="0" pref="380" max="32767" attributes="0"/>
-                  <Component id="progress" alignment="0" pref="380" max="32767" attributes="0"/>
-                  <Component id="cancel" alignment="1" min="-2" max="-2" attributes="0"/>
-              </Group>
-              <EmptySpace max="-2" attributes="0"/>
-          </Group>
+          <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" alignment="0" attributes="0">
-              <EmptySpace max="-2" attributes="0"/>
-              <Component id="progress" min="-2" max="-2" attributes="0"/>
-              <EmptySpace max="-2" attributes="0"/>
-              <Component id="status" min="-2" pref="16" max="-2" attributes="0"/>
-              <EmptySpace max="-2" attributes="0"/>
-              <Component id="cancel" min="-2" max="-2" attributes="0"/>
-              <EmptySpace max="32767" attributes="0"/>
-          </Group>
+          <Component id="jPanel1" min="-2" max="-2" attributes="0"/>
       </Group>
     </DimensionLayout>
   </Layout>
   <SubComponents>
-    <Component class="javax.swing.JProgressBar" name="progress">
-      <AuxValues>
-        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-      </AuxValues>
-    </Component>
-    <Component class="javax.swing.JButton" name="cancel">
+    <Container class="javax.swing.JPanel" name="jPanel1">
       <Properties>
-        <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-          <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+          <Border info="org.netbeans.modules.form.compat2.border.LineBorderInfo">
+            <LineBorder/>
+          </Border>
         </Property>
       </Properties>
-      <AuxValues>
-        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-      </AuxValues>
-    </Component>
-    <Component class="javax.swing.JLabel" name="status">
-      <AuxValues>
-        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-      </AuxValues>
-    </Component>
+
+      <Layout>
+        <DimensionLayout dim="0">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="0" attributes="0">
+                      <Component id="progress" alignment="0" pref="378" max="32767" attributes="0"/>
+                      <Component id="status" alignment="0" pref="378" max="32767" attributes="0"/>
+                      <Component id="cancel" alignment="1" min="-2" max="-2" attributes="0"/>
+                  </Group>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+        <DimensionLayout dim="1">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="progress" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="status" min="-2" pref="16" max="-2" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="cancel" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace max="32767" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+      </Layout>
+      <SubComponents>
+        <Component class="javax.swing.JProgressBar" name="progress">
+          <Properties>
+            <Property name="foreground" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="0" green="0" red="0" type="rgb"/>
+            </Property>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+        <Component class="javax.swing.JLabel" name="status">
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+        <Component class="javax.swing.JButton" name="cancel">
+          <Properties>
+            <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
+              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Common.Cancel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+            </Property>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
+    </Container>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 09:01:43 UTC (rev 676)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 09:06:17 UTC (rev 677)
@@ -7,8 +7,6 @@
 package net.sf.plantlore.common;
 
 import java.awt.Cursor;
-import java.awt.Dialog;
-import java.awt.Frame;
 import java.util.Observable;
 import java.util.Observer;
 
@@ -66,33 +64,36 @@
      */
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
+        jPanel1 = new javax.swing.JPanel();
         progress = new javax.swing.JProgressBar();
+        status = new javax.swing.JLabel();
         cancel = new javax.swing.JButton();
-        status = new javax.swing.JLabel();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DO_NOTHING_ON_CLOSE);
         setTitle(L10n.getString("Common.Progress"));
         setModal(true);
         setResizable(false);
         setUndecorated(true);
+        jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
+        progress.setForeground(new java.awt.Color(0, 0, 0));
 
         cancel.setText(L10n.getString("Common.Cancel"));
 
-        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
-        getContentPane().setLayout(layout);
-        layout.setHorizontalGroup(
-            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
+        jPanel1.setLayout(jPanel1Layout);
+        jPanel1Layout.setHorizontalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 380, Short.MAX_VALUE)
-                    .add(cancel))
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 378, Short.MAX_VALUE)
+                    .add(status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 378, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, cancel))
                 .addContainerGap())
         );
-        layout.setVerticalGroup(
-            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
+        jPanel1Layout.setVerticalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -101,12 +102,24 @@
                 .add(cancel)
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+        );
         pack();
     }// </editor-fold>//GEN-END:initComponents
     
         
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton cancel;
+    private javax.swing.JPanel jPanel1;
     protected javax.swing.JProgressBar progress;
     protected javax.swing.JLabel status;
     // End of variables declaration//GEN-END:variables
@@ -127,31 +140,39 @@
                 		public void run() {
                 			setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
                 			cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-                	        if( monitoredTask.isDeterminate() ) {
-                	            progress.setIndeterminate(false);
-                	            progress.setMinimum(0);
-                	            progress.setMaximum(monitoredTask.getLength());
-                	        } else {
-                	            progress.setIndeterminate(true);
-                	        }
+                			progress.setIndeterminate(true);
                 	        setVisible(true);
                 		}
                 	});
-                
-                case POSITION_CHANGED:
+                	
+                case LENGTH_CHANGED:
                     SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
-                        	 if( monitoredTask.isDeterminate() && progress.isIndeterminate() ) {
-                 	            progress.setIndeterminate(false);
-                 	            progress.setMinimum(0);
-                 	            progress.setMaximum(monitoredTask.getLength());
-                 	        } else if( !monitoredTask.isDeterminate() && !progress.isIndeterminate()){
-                 	            progress.setIndeterminate(true);
-                 	        }
-                        	progress.setValue(monitoredTask.getPosition());
+                            if(progress.isIndeterminate())
+                                progress.setIndeterminate(false);
+                            progress.setMaximum(monitoredTask.getLength());
                         }
                     });
                     break;
+                
+                case POSITION_CHANGED:
+                    SwingUtilities.invokeLater(new Runnable() {
+                    	public void run() {
+                    		if( monitoredTask.isDeterminate() && progress.isIndeterminate() ) {
+                    			progress.setIndeterminate(false);
+                    			progress.setMinimum(0);
+                    			progress.setMaximum( monitoredTask.getLength() );
+//                    			progress.setStringPainted(true);
+                    		} 
+                    		progress.setValue( monitoredTask.getPosition() );
+//                    		int 
+//                    		length = monitoredTask.getLength(), 
+//                    		position = monitoredTask.getPosition();
+//                    		if( length > 0 )
+//                    			progress.setString( "" + (100*position)/length + "%" );
+                    	}
+                    });
+                    break;
                     
                 case MESSAGE_CHANGED:
                     SwingUtilities.invokeLater(new Runnable() {
@@ -165,6 +186,10 @@
                 case STOPPED:
                 	SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
+                        	progress.setIndeterminate(false);
+             	            progress.setMinimum(0);
+             	            progress.setMaximum(100);
+             	            progress.setValue(100);
                         	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
                         	cancel.setText(L10n.getString("Common.Hide"));
                         }



From fraktalek at mail.berlios.de  Tue Sep  5 12:49:18 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 12:49:18 +0200
Subject: [Plantlore-dev] r678 - trunk/src/net/sf/plantlore/client
Message-ID: <200609051049.k85AnIth019582@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 12:49:13 +0200 (Tue, 05 Sep 2006)
New Revision: 678

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
Log:
Scheda generation now started using task and dispatcher.
Changed refresh progressbar to the one in status bar.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 09:06:17 UTC (rev 677)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 10:49:13 UTC (rev 678)
@@ -1098,17 +1098,35 @@
 				Task task = new Task() {
 					JasperPrint jasperPrint;
 
-					public Object task() throws JRException {
-						jasperPrint = JasperFillManager.fillReport(
+					public Object task() throws DBLayerException {
+                                                setStatusMessage(L10n.getString("Overview.Scheda.Generating"));
+                                                try {
+                                                    jasperPrint = JasperFillManager.fillReport(
 								schedaReport, params,
 								new JasperDataSource(model.getDatabase(), model
 										.getTableModel().getSelection()));
-						fireStopped(jasperPrint);
+                                                } catch (JRException jrException) {
+                                                    throw new DBLayerException(L10n.getString("Print.Message.BrokenReport"),jrException);
+                                                }
+						//fireStopped(jasperPrint);
+                                                setStatusMessage(L10n.getString("Common.Done"));
 						return jasperPrint;
 					}
 				};
-
-				ProgressBar pb = new ProgressBar(task, view, true) {
+                                task.setPostTaskAction(new PostTaskAction() {
+                                    public void afterStopped(final Object value) {
+                                        SwingUtilities.invokeLater( new Runnable() {
+                                            public void run() {
+                                                new SchedaView(view, true, (JasperPrint) value)
+                                                                .setVisible(true);
+                                            }
+                                        });//SwingUtils
+                                    }//afterStopped
+                                });//setPostTaskAction
+                                
+                                Dispatcher.getDispatcher().dispatch(task, view, false);
+                                
+/*				ProgressBar pb = new ProgressBar(task, view, true) {
 					public void exceptionHandler(final Exception ex) {
 						logger.error("Error while filling jasper report in SchedaAction: "+ ex);
 						ex.printStackTrace();
@@ -1126,7 +1144,7 @@
                                                                 .setVisible(true);
 					}
 				};
-				task.start();
+				task.start(); */
 			} catch (Exception ex) { 
 				logger.error("Broken report: " + ex);
 				JOptionPane.showMessageDialog(view, L10n
@@ -1848,7 +1866,7 @@
                             }
                         };*/
 
-			Dispatcher.getDispatcher().dispatch(task, view, true);
+			Dispatcher.getDispatcher().dispatch(task, view, false);
 		}
 
 	}



From krater at mail.berlios.de  Tue Sep  5 13:54:27 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 13:54:27 +0200
Subject: [Plantlore-dev] r679 - in trunk/src/net/sf/plantlore:
	client/checklist client/occurrenceimport client/tableimport
	client/tableimport/parsers middleware server
Message-ID: <200609051154.k85BsR9k013282@sheep.berlios.de>

Author: krater
Date: 2006-09-05 13:54:20 +0200 (Tue, 05 Sep 2006)
New Revision: 679

Modified:
   trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/TableParser.java
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
   trunk/src/net/sf/plantlore/middleware/SelectQuery.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
   trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
   trunk/src/net/sf/plantlore/server/SubQueryImplementation.java
Log:
Extremely nasty bug fixed: resultset identifier & its associated scrollable result were not removed in closeQuery(). This posed extreme memory requirements particularly during import (several thousands scrollable results were kept in the database layer which lead to increased memory consumption).

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistCtrl.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -63,7 +63,6 @@
 		public void actionPerformed(ActionEvent arg0) {
 			model.addLines( view.checklist.getSelectedValues() );
 			view.setVisible(false);
-			view.checklist.clearSelection();
 		}
 	}
 	

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -131,4 +131,15 @@
     protected JFileChooser choice;
 
     
+    @Override
+    public void setVisible(boolean arg0) {
+    	if( !arg0 ) {
+    		checklist.clearSelection();
+    		if(checklist.getModel().getSize() > 0)
+    			checklist.ensureIndexIsVisible(0);
+    	}
+    	
+    	super.setVisible(arg0);
+    }
+    
 }

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -85,6 +85,9 @@
 			setChanged();
 			notifyObservers( TABLES_TO_UPDATE );
 		}
+		
+		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, rejected));
+		
 		fireStopped(null);
 		return null;
 	}
@@ -113,8 +116,8 @@
 	throws DBLayerException, RemoteException {
 		if( isCanceled() ) 
 			throw canceledByUser;
+		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, rejected));
 		count++;
-		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, rejected));
 		try {
 			if(aos == null || aos.length == 0) {
 				logger.error("The occurrence record is either corrupted or incomplete. It will be skipped.");

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -89,6 +89,7 @@
 		setStatusMessage(L10n.getString("Import.Initialized"));
 		setLength( parser.getNumberOfRecords() );
 				
+		try {
 		while( !isCanceled() && parser.hasNext() ) {
 			DataHolder data = null;
 			try {
@@ -153,6 +154,7 @@
 					updated ++;
 					break;
 				}
+				
 			} catch(ImportException ie) {
 				logger.error("The import of the record No. " + count + " was unsuccessful! " + ie.getMessage());
 				//setStatusMessage( ie.getMessage() );
@@ -161,9 +163,15 @@
 				//setStatusMessage( L10n.getFormattedString("Import.UnableToProcess", count) + " " + 
 				//		((de.getMessage() == null) ? L10n.getString("Import.UnknownReason") : de.getMessage()) );
 			}
+			
 		}
+		}
+		finally {
+			parser.cleanup();
+		}
 		
 		
+		
 		if( !isCanceled() ) {
 			logger.info("Import completed. "+count+" records processed ("+
 					inserted+" inserted, "+updated+" updated, "+deleted+" deleted).");
@@ -179,6 +187,8 @@
 		setChanged();
 		notifyObservers( new PlantloreConstants.Table[] { PlantloreConstants.classToTable.get(table) } );
 		
+		setStatusMessage(L10n.getFormattedString("Import.RecordsProcessed", count, (count - deleted - updated - inserted) ));
+		
 		fireStopped(null);
 		return null;
 	}

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableParser.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableParser.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -60,5 +60,10 @@
 	 * @return	The total number of records on the input, or -1 if the number could not be determined. 
 	 */
 	int getNumberOfRecords();
-
+	
+	/**
+	 * Made some final cleanup.
+	 * 
+	 */
+	void cleanup();
 }

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -70,6 +70,7 @@
 	private int numberOfRecords = -1;
 	private Class rootTable;
 	private Iterator recIterator;
+	private SAXReader saxReader;
 	
 	private Reader reader;
 	
@@ -100,8 +101,11 @@
 	 */
 	public Class initialize() throws ParserException {
 		try {
-        	SAXReader saxReader = new SAXReader();
+        	saxReader = new SAXReader();
+        	
+        	System.out.println("ABOUT TO PARSER THE DOCUMENT WITH DOM4J");
             document = saxReader.read( reader );
+            System.out.println("COMPLETED.");
             
             Node root = document.getRootElement();
             if(root == null)
@@ -149,8 +153,9 @@
 			
 			Node node = (Node) recIterator.next();
 			reconstruct( data.record, node );
-			node = node.getParent();
-			String name = (node == null) ? "add" : node.getName().toLowerCase();
+			Node parent = node.getParent();
+			String name = (parent == null) ? "add" : parent.getName().toLowerCase();
+			node.detach();
 			
 			if( name.startsWith("add") )
 				data.action = Action.INSERT;
@@ -163,6 +168,7 @@
 					throw new ParserException(L10n.getString("Error.MissingUpdateRecord"));
 				data.replacement = (Record)rootTable.newInstance();
 				reconstruct( data.replacement, node );
+				node.detach();
 			}
 		} catch(IllegalAccessException e) {
 			throw new ParserException(L10n.getString("Error.Internal"));
@@ -196,5 +202,18 @@
     		part.setValue(property, value);
     	}
     }
+
+    
+	public void cleanup() {
+		recIterator = null;
+		saxReader.resetHandlers();
+		document.clearContent();
+		document = null;
+		data = null;
+		saxReader = null;
+		try {
+			reader.close();
+		} catch(Exception e) {}
+	}
      
 }

Modified: trunk/src/net/sf/plantlore/middleware/SelectQuery.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/SelectQuery.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/middleware/SelectQuery.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -100,4 +100,9 @@
      */
     void addAssociation(String associationPath) throws RemoteException;
     
+    
+    Integer getResultsetIdentifier() throws RemoteException;
+    
+    void setResultsetIdentifier(Integer id) throws RemoteException;
+    
 }

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -718,6 +718,7 @@
         // Update current maximum result id and save the results
         maxResultId++; 
         results.put(maxResultId, res);
+        sq.setResultsetIdentifier( maxResultId );
         return maxResultId;
     }
        
@@ -791,7 +792,6 @@
      *  @param query query we want to close
      */
     public void closeQuery(SelectQuery query) throws RemoteException, DBLayerException {
-        
         // TODO: Problem - we don't have any session for subqueries
         // TODO: We should probably catch HibernateException...
         Session session = sessions.remove(query);
@@ -802,13 +802,16 @@
         }
         session.close();     
     	// Remove the query from the list of opened queries
-        SelectQuery selectQuery = queries.remove(query);        
+        SelectQuery selectQuery = queries.remove(query);
         // Unexport the SelectQuery object
         if(undertaker != null && selectQuery != null) {
             try {
                 UnicastRemoteObject.unexportObject(selectQuery, true);
             } catch(NoSuchObjectException e) {}
         }
+        
+        Integer resultsetIdentifier = selectQuery.getResultsetIdentifier();
+        results.remove( resultsetIdentifier  );
     }
     
     /**

Modified: trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -46,6 +46,7 @@
 public class SelectQueryImplementation implements SelectQuery {
 	
 	private static final long serialVersionUID = 2006060433450880L;
+	private Integer resultsetIdentifier = null;
 	
     // Hibernate criteria used in criteria query
     private Criteria criteria;
@@ -402,4 +403,14 @@
     public void addAssociation(String associationPath) throws RemoteException {
         criteria.createCriteria(associationPath);
     }
+
+	public Integer getResultsetIdentifier() throws RemoteException {
+		return resultsetIdentifier;
+	}
+
+	public synchronized void setResultsetIdentifier(Integer id) throws RemoteException {
+		if(resultsetIdentifier != null)
+			throw new IllegalArgumentException("The identifier is set already!");
+		resultsetIdentifier = id;
+	}
 }

Modified: trunk/src/net/sf/plantlore/server/SubQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SubQueryImplementation.java	2006-09-05 10:49:13 UTC (rev 678)
+++ trunk/src/net/sf/plantlore/server/SubQueryImplementation.java	2006-09-05 11:54:20 UTC (rev 679)
@@ -328,4 +328,14 @@
     public void addAssociation(String associationPath) throws RemoteException {
         criteria.createCriteria(associationPath);
     }
+
+	public Integer getResultsetIdentifier() throws RemoteException {
+		// TODO Auto-generated method stub
+		return null;
+	}
+
+	public void setResultsetIdentifier(Integer id) throws RemoteException {
+		// TODO Auto-generated method stub
+		
+	}
 }



From fraktalek at mail.berlios.de  Tue Sep  5 14:07:13 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 14:07:13 +0200
Subject: [Plantlore-dev] r680 - in trunk/src/net/sf/plantlore: client
	client/overview client/overview/search client/overview/tree common
Message-ID: <200609051207.k85C7DUJ002033@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 14:07:06 +0200 (Tue, 05 Sep 2006)
New Revision: 680

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/MainConfig.java
   trunk/src/net/sf/plantlore/client/Plantlore.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
   trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/Task.java
Log:
Fixed a few FIXMEs and TODOs.
Better exception handling and propagation.

Finished fix of Bug #008588     Author table breaks sometimes for Search dialog.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -268,14 +268,9 @@
         }
     }
     
-    public int getResultsCount() {
-        //FIXME
+    public int getResultsCount() throws RemoteException {
         if (tableSorter != null) {        
-        	try {
-                return database.getNumRows(this.getTableModel().getResultId());
-            } catch (RemoteException e) {
-                //
-            }
+            return database.getNumRows(this.getTableModel().getResultId());
         }
         return 0;
     }
@@ -911,8 +906,8 @@
                         setStatusMessage(L10n.getFormattedString("Delete.Message.ProgressInfo",deleted,toBeDeleted.size()));
                     }
                 } catch (DBLayerException ex) {
-                    database.rollbackTransaction();//FIXME:
-                    DBLayerException dbex = new DBLayerException("Delete rolled back. Some database problem occurred: "+ex);
+                    database.rollbackTransaction();
+                    DBLayerException dbex = new DBLayerException(L10n.getString("DBLayer.Error.Transaction"),DBLayerException.ERROR_TRANSACTION,ex);
                     dbex.setStackTrace(ex.getStackTrace());
                     throw dbex;
                 }
@@ -948,8 +943,8 @@
             int resId = database.executeQuery(sq);
             int resCount = database.getNumRows(resId);
             assert resCount == 1;
-            if (resCount == 0) //FIXME
-                throw new DBLayerException("The record is no longer in the database.");
+            if (resCount == 0)
+                throw new DBLayerException(L10n.getString("Error.RecordNoLongerInDatabase"));
             Object[] obj = database.more(resId, 0, 0);
             Object[] res = (Object[])obj[0];
             String userId = ""+res[0];            

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -11,6 +11,7 @@
 import java.awt.Cursor;
 import java.awt.Dimension;
 import java.awt.EventQueue;
+import java.awt.HeadlessException;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
 import java.awt.event.ComponentEvent;
@@ -727,9 +728,17 @@
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {                    
-                    if (model.getResultsCount() == 0) {
-                        JOptionPane.showMessageDialog(view,L10n.getString("Overview.NothingToEdit"),L10n.getString("Overview.NothingToEditTitle"),JOptionPane.INFORMATION_MESSAGE);
+                    try {
+                        if (model.getResultsCount() == 0) {
+                            JOptionPane.showMessageDialog(view,L10n.getString("Overview.NothingToEdit"),L10n.getString("Overview.NothingToEditTitle"),JOptionPane.INFORMATION_MESSAGE);
+                            return;
+                        }
+                    } catch (HeadlessException ex) {
+                        DefaultExceptionHandler.handle(view,ex);  
                         return;
+                    } catch (RemoteException ex) {
+                        DefaultExceptionHandler.handle(view,ex);  
+                        return;
                     }
                         
                     final Object[] row = model.getSelectedRow();
@@ -869,8 +878,13 @@
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			if (model.getResultsCount() > 0)
-				model.selectAll();
+                        try {
+                            if (model.getResultsCount() > 0)
+                                    model.selectAll();
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);  
+                            return;
+                        }
 		}
 	}
 
@@ -884,8 +898,13 @@
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			if (model.getResultsCount() > 0)
-				model.selectNone();
+                        try {
+                            if (model.getResultsCount() > 0)
+                                    model.selectNone();
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);  
+                            return;
+                        }
 		}
 	}
 
@@ -900,8 +919,13 @@
 		}
 
 		public void actionPerformed(ActionEvent actionEvent) {
-			if (model.getResultsCount() > 0)
-				model.invertSelected();
+                    try {
+                        if (model.getResultsCount() > 0)
+                                model.invertSelected();
+                    } catch (RemoteException ex) {
+                        DefaultExceptionHandler.handle(view,ex);  
+                        return;
+                    }
 		}
 	}
 
@@ -1302,11 +1326,19 @@
 		}
 
 		public void actionPerformed(ActionEvent e) {
-			logger.debug("Showing history of record: "+ model.getSelectedOccurrence());	
-			
-                        if (model.getResultsCount() == 0) {
-                            JOptionPane.showMessageDialog(view,L10n.getString("Overview.NoOccurrence"),L10n.getString("Overview.NoOccurrenceTitle"),JOptionPane.INFORMATION_MESSAGE);                            
+			logger.debug("Showing history of record: "+ model.getSelectedOccurrence());
+                        try {
+
+                            if (model.getResultsCount() == 0) {
+                                JOptionPane.showMessageDialog(view,L10n.getString("Overview.NoOccurrence"),L10n.getString("Overview.NoOccurrenceTitle"),JOptionPane.INFORMATION_MESSAGE);                            
+                                return;
+                            }
+                        } catch (HeadlessException ex) {
+                            DefaultExceptionHandler.handle(view,ex);  
                             return;
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(view,ex);  
+                            return;
                         }
                         
 			if (historyModel == null) {
@@ -1730,8 +1762,6 @@
                                 logger.debug("Database layer retrieval.");
                                 DBLayer dblayer = loginModel.getDBLayer();
 
-                                // FIXME: neni potreba zresetovat stav treba loginModelu, pokdu
-                                // neco takhle selze? pripadne stav jinyho objektu?
                                 try {
                                         model.setDatabase(dblayer);
                                 } catch (RemoteException ex) {
@@ -1771,7 +1801,6 @@
                                 view.initOverview();
                                 view.setCursor(Cursor.getDefaultCursor());
                                 setDatabaseDependentCommandsEnabled(true);
-                                logger.debug("======= rows: "+model.getResultsCount());
                                 //this can't be done earlier. must be done after the query is created
                                 //otherwise this listener would give the overview table model commands to load data
                                 //for a query that doesn't exist yet

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-05 12:07:06 UTC (rev 680)
@@ -537,7 +537,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="403" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="367" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -9,6 +9,7 @@
 import java.awt.Dimension;
 import java.awt.event.ActionListener;
 import java.beans.PropertyChangeListener;
+import java.rmi.RemoteException;
 import java.util.Observable;
 import java.util.Observer;
 import java.util.prefs.Preferences;
@@ -19,6 +20,7 @@
 import javax.swing.event.ListSelectionListener;
 import javax.swing.table.TableColumn;
 import net.sf.plantlore.client.overview.*;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.StatusBarManager;
 import net.sf.plantlore.l10n.L10n;
@@ -446,9 +448,14 @@
                 if (object != null && object instanceof String) {
                     String arg = (String) object;
                     if (arg.equals("PAGE_CHANGED")||arg.equals("RECORDS_PER_PAGE")) {
-                        recordsCount.setText(""+model.getResultsCount());
+                        try {
+                            recordsCount.setText(""+model.getResultsCount());
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(this, ex);
+                            return;
+                        }
                         pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount());
-                        //FIXME: change selection only if really required
+                        //TODO: change selection only if really required
                         overview.changeSelection(model.getSelectedRowNumber(),0,false,false);
                         return;
                     }
@@ -456,7 +463,12 @@
                         //setPreferredColumnSizes();
                         overview.setEnabled(true);
                         overview.setVisible(true);
-                        recordsCount.setText(""+model.getResultsCount());
+                        try {
+                            recordsCount.setText(""+model.getResultsCount());
+                        } catch (RemoteException ex) {
+                            DefaultExceptionHandler.handle(this, ex);
+                            return;
+                        }
                         pageStatus.setText(""+model.getCurrentPage()+"/"+model.getPagesCount()); 
                         overview.getSelectionModel().setSelectionInterval(0,0);
                         return;
@@ -494,7 +506,6 @@
         OverviewTableModel otm = model.getTableModel();
         TableSorter tableSorter = model.getTableSorter();
 
-        //FIXME: what if otm == null ????????????
         overview.setModel(tableSorter);
         tableSorter.setTableHeader(overview.getTableHeader());
         overview.setSelectionMode(ListSelectionModel.SINGLE_SELECTION);

Modified: trunk/src/net/sf/plantlore/client/MainConfig.java
===================================================================
--- trunk/src/net/sf/plantlore/client/MainConfig.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/MainConfig.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -93,7 +93,7 @@
             }
             if (c != null) {
                 Number preferredSize = n.numberValueOf("@preferredSize");
-                if (!preferredSize.toString().equals("NaN")) //FIXME: better way to recognize a NaN?
+                if (!preferredSize.toString().equals("NaN")) //TODO: better way to recognize a NaN?
                     c.setPreferredSize(preferredSize.intValue());
                 columns.add(c);
             }

Modified: trunk/src/net/sf/plantlore/client/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -59,11 +59,10 @@
         ClassLoader cl = this.getClass().getClassLoader();
         InputStream is = cl.getResourceAsStream(LOGGER_PROPS);
         Properties props = new Properties();
-        //FIXME:
         try {
             props.load(is);
         } catch (IOException ex) {
-            ex.printStackTrace();
+            JOptionPane.showMessageDialog(null, L10n.getString("Message.CorruptedJarMissingResource"),L10n.getString("Message.CorruptedJarMissingResourceTitle"),JOptionPane.ERROR_MESSAGE);
         }
         //maybe CHANGE to configureAndWatch()
         PropertyConfigurator.configure(props);
@@ -94,7 +93,7 @@
         try {
             PlantloreHelp.initialize();
         } catch (PlantloreException e) {
-            // TODO: Display error message
+            JOptionPane.showMessageDialog(null, L10n.getString("Message.HelpInitProblem"),L10n.getString("Message.HelpInitProblemTitle"),JOptionPane.ERROR_MESSAGE);
         }
         
         plantlore.run();

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -39,6 +39,7 @@
 import javax.swing.event.DocumentListener;
 import javax.swing.text.BadLocationException;
 import com.toedter.calendar.JCalendar;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
@@ -684,12 +685,12 @@
                 }
             } catch (RemoteException ex) {
                 logger.error("Remote problem: "+ex);
-                ex.printStackTrace();
-                DefaultReconnectDialog.show(view,ex);
+                DefaultExceptionHandler.handle(view, ex);
+                return;
             } catch (DBLayerException ex) {
                 logger.error("Database problem: "+ex);
-                ex.printStackTrace();
-                DefaultReconnectDialog.show(view,ex);
+                DefaultExceptionHandler.handle(view, ex);
+                return;
             }
         }//mouseClicked
             

Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -454,7 +454,6 @@
     }
     
     public Pair<Boolean,String> checkData() {
-        //TODO: check that the author set contains reasonable (not null) values
         boolean allNull = true;
         for (int i = 0; i < authorList.size(); i++) {
             Pair<Pair<String,Integer>,String> p = authorList.get(i);
@@ -862,7 +861,7 @@
             }
 
             if (isNotEmpty(publication)) {
-                //FIXME: mozna pridat addOrRestriction na vsechny relevantni sloupky Publication
+                //TODO: mozna pridat addOrRestriction na vsechny relevantni sloupky Publication
                     arg = dlu.getObjectFor(publication.getSecond(),Publication.class);
                 sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.PUBLICATION,null,arg,null);
                 restrictions.add(new Restriction(RESTR_EQ, Occurrence.PUBLICATION, arg));

Modified: trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -716,18 +716,18 @@
 
         JComboBox cb;
         if (model.getAuthors() == null) 
-            cb = new AutoComboBoxNG3();
+            cb = new JComboBox();
         else
-            cb = new AutoComboBoxNG3(model.getAuthors());
+            cb = new JComboBox(model.getAuthors());
         
         //Fix of Bug #008588	Author table breaks sometimes
         PopupListener pl = new PopupListener(); cb.addPopupMenuListener(pl); DefaultCellEditor dce = new DefaultCellEditor(cb); pl.setCellEditor(dce);
         tc1.setCellEditor(dce);  
 
         if (model.getAuthorRoles() == null) 
-            cb = new AutoComboBoxNG3();
+            cb = new JComboBox();
         else
-            cb = new AutoComboBoxNG3(model.getAuthorRoles());
+            cb = new JComboBox(model.getAuthorRoles());
 
         //Fix of Bug #008588	Author table breaks sometimes
         pl = new PopupListener(); cb.addPopupMenuListener(pl); dce = new DefaultCellEditor(cb); pl.setCellEditor(dce);
@@ -900,9 +900,9 @@
                         JComboBox cb;
 
                         if (model.getAuthors() == null) 
-                            cb = new AutoComboBoxNG3();
+                            cb = new JComboBox();
                         else
-                            cb = new AutoComboBoxNG3(model.getAuthors());
+                            cb = new JComboBox(model.getAuthors());
 
                         TableColumn tc1 = authorTable.getColumnModel().getColumn(0);
 
@@ -916,9 +916,9 @@
                         JComboBox cb;
 
                         if (model.getAuthorRoles() == null)
-                            cb = new AutoComboBoxNG3();
+                            cb = new JComboBox();
                         else
-                            cb = new AutoComboBoxNG3(model.getAuthorRoles());
+                            cb = new JComboBox(model.getAuthorRoles());
 
                         TableColumn tc2 = authorTable.getColumnModel().getColumn(1);
 

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -23,6 +23,7 @@
 import javax.swing.tree.DefaultMutableTreeNode;
 import javax.swing.tree.TreePath;
 import net.sf.plantlore.client.resources.Resource;
+import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.DefaultReconnectDialog;
 import net.sf.plantlore.common.Dispatcher;
@@ -173,10 +174,8 @@
                 try {
                     model.reload();
                 } catch (Exception ex) {
-                    if (ex instanceof DBLayerException || ex instanceof RemoteException)
-                        DefaultReconnectDialog.show(view,ex);
-                    else
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.General"));//FIXME
+                    DefaultExceptionHandler.handle(view, ex);
+                    return;
                 }
             }
     }//RefreshAction
@@ -204,10 +203,7 @@
                 try {
                     model.reload();
                 } catch (Exception ex) {
-                    if (ex instanceof DBLayerException || ex instanceof RemoteException)
-                        DefaultReconnectDialog.show(view,ex);
-                    else
-                        JOptionPane.showMessageDialog(view,L10n.getString("Error.General"));//FIXME
+                    DefaultExceptionHandler.handle(view,ex);
                 }
             }
     }//RefreshAction

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -101,7 +101,7 @@
     }    
     
     public static Dispatcher getDispatcher() {
-        if (pbm == null) //FIXME: think of a better kind of exception
+        if (pbm == null) //TODO: think of a better kind of exception
             throw new IllegalArgumentException("You have to call Dispatcher.initialize() first!");
         
         return dispatcher;

Modified: trunk/src/net/sf/plantlore/common/Task.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Task.java	2006-09-05 11:54:20 UTC (rev 679)
+++ trunk/src/net/sf/plantlore/common/Task.java	2006-09-05 12:07:06 UTC (rev 680)
@@ -194,8 +194,6 @@
                         action.afterStopped(value);
                     }
                 } catch (Exception ex) {
-                    //FIXME:
-                    ex.printStackTrace();
                     setChanged();
                     notifyObservers(ex);
                 }



From krater at mail.berlios.de  Tue Sep  5 14:14:49 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 14:14:49 +0200
Subject: [Plantlore-dev] r681 - trunk/src/net/sf/plantlore/client/tableimport
Message-ID: <200609051214.k85CEn0c003089@sheep.berlios.de>

Author: krater
Date: 2006-09-05 14:14:49 +0200 (Tue, 05 Sep 2006)
New Revision: 681

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
Log:
Proper out-of-memory handler.

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 12:07:06 UTC (rev 680)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 12:14:49 UTC (rev 681)
@@ -84,7 +84,13 @@
 		logger.info("Table Import begins...");
 		
 		setStatusMessage(L10n.getString("Import.Initializing"));
-		Class table = parser.initialize();
+		Class table = null;
+		try {
+			table = parser.initialize();
+		} catch(OutOfMemoryError e) {
+			parser.cleanup();
+			throw new Exception(L10n.getString("Error.OutOfMemory"), e);
+		}
 		
 		setStatusMessage(L10n.getString("Import.Initialized"));
 		setLength( parser.getNumberOfRecords() );



From lada at mail.berlios.de  Tue Sep  5 14:21:44 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 14:21:44 +0200
Subject: [Plantlore-dev] r682 - trunk/src/net/sf/plantlore/client/metadata
Message-ID: <200609051221.k85CLiV1004010@sheep.berlios.de>

Author: lada
Date: 2006-09-05 14:21:43 +0200 (Tue, 05 Sep 2006)
New Revision: 682

Modified:
   trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
Log:
Fix bug: we can edit one metadata for more time now.

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-05 12:14:49 UTC (rev 681)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-05 12:21:43 UTC (rev 682)
@@ -78,7 +78,7 @@
     /**Metadata - istitution*/
     private String sourceInstitutionId;
     /**Metadata - data source*/
-    private String sourceId;    
+    private String sourceId;        
     
     /** Constants with error descriptions */
     public static final String ERROR_SEARCH = L10n.getString("Error.MetadataSearchFailed");        
@@ -369,11 +369,11 @@
     			try {
 		            database.executeInsert(metadataRecord);		            		            
 		        }catch (Exception e) {
-		        	logger.error("Process add metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();                    
+		        	logger.error("Process add metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());		        	               
                                 throw e; 		            
 		        } 		       		      
 		        setInfoFinishedTask(true);
+                         // Stop the Task                        
 		        return null;
     		}
 	    };
@@ -392,13 +392,12 @@
     		public Object task() throws Exception {
     			try {
 		        	database.executeUpdate(metadataRecord);
-		        	metadataList.set(idRecord, metadataRecord);
+		        	//metadataList.set(idRecord, metadataRecord);
 		        }catch (Exception e) {
-		        	logger.error("Process update metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());
-		        	database.rollbackTransaction();                   
+		        	logger.error("Process update metadata failed. Remote exception caught in MetadataManager. Details: "+e.getMessage());		        	                  
                                 throw e; 		            
 		        } 		        		        
-		        setInfoFinishedTask(true);
+		        setInfoFinishedTask(true);                                               
 		        return null;
     		}
 	    };            

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-05 12:14:49 UTC (rev 681)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-05 12:21:43 UTC (rev 682)
@@ -253,16 +253,17 @@
                 public void afterStopped(Object value) {
                    if (! model.isFinishedTask()) return;
                    model.setInfoFinishedTask(false);
-                   //load metadata
-    	           model.searchMetadata(false);
-    	           if (model.isError()) {
-    	        	   DefaultExceptionHandler.handle(view, model.getException());
-                           model.setError(null);
-    	        	   return;
-    	           }    	           
-    	           reloadData(1, model.getDisplayRows());   
+                     // load metadata
+                   model.searchMetadata(false);  
+                   if (model.isError()) {
+                       DefaultExceptionHandler.handle(view, model.getException());
+                        model.setError(null);
+                        model.setException(null);
+                       return;
+                   }
+                   reloadData(1, model.getDisplayRows());
                    model.callNotifyObserver();
-               } 		   		               
+                }//afterStopped 		               
            });
            Dispatcher.getDispatcher().dispatch(task, view, false);
            
@@ -325,11 +326,17 @@
                     public void afterStopped(Object value) {
                          if (! model.isFinishedTask()) return;
                          model.setInfoFinishedTask(false);
-                       //load metadata          				
-                        if (model.isError()) return;
-                        view.tableMetadataList.setModel(new MetadataManagerTableModel(model));  
-                        model.callNotifyObserver();
-                     } 		   					                   
+                          // load metadata
+                           model.searchMetadata(false);  
+                           if (model.isError()) {
+                               DefaultExceptionHandler.handle(view, model.getException());
+                                model.setError(null);
+                                model.setException(null);
+                               return;
+                           }
+                           reloadData(1, model.getDisplayRows());
+                           model.callNotifyObserver();
+                        }//afterStopped 		
                });
                Dispatcher.getDispatcher().dispatch(task, view, false);
                



From fraktalek at mail.berlios.de  Tue Sep  5 14:40:04 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 14:40:04 +0200
Subject: [Plantlore-dev] r683 -
	trunk/src/net/sf/plantlore/client/overview/tree
Message-ID: <200609051240.k85Ce4F1005696@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 14:40:03 +0200 (Tue, 05 Sep 2006)
New Revision: 683

Modified:
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
Log:
Forgot to modify habitat tree reloading when I changed it to use task and dispatcher.



Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-05 12:21:43 UTC (rev 682)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-05 12:40:03 UTC (rev 683)
@@ -203,9 +203,9 @@
      * Removes all children of the <code>rootNode</code> and then calls <code>loadData()</code>
      *
      */
-    public void reload() throws DBLayerException, RemoteException {
+    public Task reload() {
         rootNode.removeAllChildren();
-        loadData();
+        return loadData();
     }
     
     /** Invokes the Add dialog on given habitat.

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-05 12:21:43 UTC (rev 682)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-05 12:40:03 UTC (rev 683)
@@ -171,12 +171,8 @@
             }
 
             public void actionPerformed(ActionEvent actionEvent) {
-                try {
-                    model.reload();
-                } catch (Exception ex) {
-                    DefaultExceptionHandler.handle(view, ex);
-                    return;
-                }
+                    Task task = model.reload();
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
             }
     }//RefreshAction
    



From krater at mail.berlios.de  Tue Sep  5 15:17:10 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 15:17:10 +0200
Subject: [Plantlore-dev] r684 -
	trunk/src/net/sf/plantlore/client/tableimport/parsers
Message-ID: <200609051317.k85DHAFY008761@sheep.berlios.de>

Author: krater
Date: 2006-09-05 15:17:09 +0200 (Tue, 05 Sep 2006)
New Revision: 684

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
Log:
Proper cleanup (that doesn't throw NullPointerExceptions).

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 12:40:03 UTC (rev 683)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 13:17:09 UTC (rev 684)
@@ -206,14 +206,16 @@
     
 	public void cleanup() {
 		recIterator = null;
-		saxReader.resetHandlers();
-		document.clearContent();
+		if(document != null)
+			document.clearContent();
 		document = null;
 		data = null;
 		saxReader = null;
 		try {
 			reader.close();
 		} catch(Exception e) {}
+		// Get rid of the ugly memory consuming DOM4J tree.
+		System.gc();
 	}
      
 }



From fraktalek at mail.berlios.de  Tue Sep  5 15:37:30 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 15:37:30 +0200
Subject: [Plantlore-dev] r685 - trunk/lib
Message-ID: <200609051337.k85DbUHD013188@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 15:37:27 +0200 (Tue, 05 Sep 2006)
New Revision: 685

Added:
   trunk/lib/jxl.jar
   trunk/lib/poi-2.5.1-final-20040804.jar
Modified:
   trunk/lib/README.txt
Log:
Added two missing Jasper Reports dependencies, so that it is possible to export schedas to xls format.



Modified: trunk/lib/README.txt
===================================================================
--- trunk/lib/README.txt	2006-09-05 13:17:09 UTC (rev 684)
+++ trunk/lib/README.txt	2006-09-05 13:37:27 UTC (rev 685)
@@ -1,4 +1,3 @@
-jasper/			Directory with JasperReports dependencies
 log4j-1.2.13.jar	Log4j logging library from Apache
 jcalendar-1.3.1.jar	Library used for calendar and date components (JCalendar, JMonthChooser, JDayChooser, ...)
 looks-2.0.2.jar		JGoodies look & feel
@@ -6,3 +5,12 @@
 swing-layout-1.0.jar	Library used by dialogs created in Netbeans Matisse editor
 spin.jar		A special library that supports a creation of a non-freezing Swing GUI. See http://spin.sourceforge.net/ for more details.
 
+Jasper reports dependencies:
+	postgresql-8.0-311.jdbc2.jar
+	jxl.jar
+	jasperreports-1.2.1.jar
+	itext-1.4.jar
+	commons-beanutils.jar
+	commons-collections-3.1.jar 
+	commons-logging-1.0.4.jar
+	commons-digester-1.7.jar

Added: trunk/lib/jxl.jar
===================================================================
(Binary files differ)


Property changes on: trunk/lib/jxl.jar
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/lib/poi-2.5.1-final-20040804.jar
===================================================================
(Binary files differ)


Property changes on: trunk/lib/poi-2.5.1-final-20040804.jar
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Tue Sep  5 16:23:08 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 16:23:08 +0200
Subject: [Plantlore-dev] r686 - in trunk/src/net/sf/plantlore: client
	client/tableimport client/tableimport/parsers common
Message-ID: <200609051423.k85EN8aT019993@sheep.berlios.de>

Author: krater
Date: 2006-09-05 16:23:06 +0200 (Tue, 05 Sep 2006)
New Revision: 686

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
Log:
Reconnect is dispatched by the dispatcher now.

*************************************************
System.gc() is called immediately after the OutOfMemoryError occurs in the table import. It is still error prone - if the creation of the DOM4j tree consumes all memory, a call from EDT may occur and it may not have enough memory -> the program ends in a loop that announces OutOfMemoryException. EDT's behaviour....
*************************************************

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 13:37:27 UTC (rev 685)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 14:23:06 UTC (rev 686)
@@ -1697,7 +1697,7 @@
 					// the last task surely had one and it will become
 					// active once we start the task again.
 					logger.debug("Performing the connection procedure again...");
-					t.start(); 
+					Dispatcher.getDispatcher().dispatch(t, view, false);
 				}
 			}
 		}

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 13:37:27 UTC (rev 685)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 14:23:06 UTC (rev 686)
@@ -88,8 +88,7 @@
 		try {
 			table = parser.initialize();
 		} catch(OutOfMemoryError e) {
-			parser.cleanup();
-			throw new Exception(L10n.getString("Error.OutOfMemory"), e);
+			throw new Exception(L10n.getString("Error.OutOfMemory"));
 		}
 		
 		setStatusMessage(L10n.getString("Import.Initialized"));
@@ -174,6 +173,9 @@
 		}
 		finally {
 			parser.cleanup();
+			parser = null;
+			logger.debug("Removing the DOM4J tree from memory?");
+			System.gc();
 		}
 		
 		

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 13:37:27 UTC (rev 685)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-05 14:23:06 UTC (rev 686)
@@ -94,6 +94,7 @@
 	 */
 	public UnifiedTableParser(Reader reader) {
 		this.reader = reader;
+		saxReader = new SAXReader();
 	}
 	
 	/**
@@ -101,11 +102,7 @@
 	 */
 	public Class initialize() throws ParserException {
 		try {
-        	saxReader = new SAXReader();
-        	
-        	System.out.println("ABOUT TO PARSER THE DOCUMENT WITH DOM4J");
             document = saxReader.read( reader );
-            System.out.println("COMPLETED.");
             
             Node root = document.getRootElement();
             if(root == null)
@@ -123,6 +120,8 @@
             	throw new ParserException(L10n.getString("Error.EmptyXMLFile"));
 			
 		} catch( OutOfMemoryError er ) {
+			cleanup();
+			System.gc();
 			throw new ParserException(L10n.getString("Error.OutOfMemory"));			
         } catch (DocumentException e) {
         	throw new ParserException(L10n.getString("Error.IncorrectXMLFile"));
@@ -214,8 +213,6 @@
 		try {
 			reader.close();
 		} catch(Exception e) {}
-		// Get rid of the ugly memory consuming DOM4J tree.
-		System.gc();
 	}
      
 }

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 13:37:27 UTC (rev 685)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 14:23:06 UTC (rev 686)
@@ -173,12 +173,13 @@
 		if( !isReconnectDisabled && isReconnectReasonable && ! doNotOfferReconnect )
 			DefaultReconnectDialog.show(parent, problemDescription);
 		// Just announce the problem.
-		else
+		else {
 			JOptionPane.showMessageDialog( 
 					parent, 
 					problemDescription, 
 					title, 
 					JOptionPane.ERROR_MESSAGE );
+		}
 		
 	}
 	



From fraktalek at mail.berlios.de  Tue Sep  5 16:33:06 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 16:33:06 +0200
Subject: [Plantlore-dev] r687 - in trunk/src/net/sf/plantlore: client/print
	common
Message-ID: <200609051433.k85EX6uq020679@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 16:33:05 +0200 (Tue, 05 Sep 2006)
New Revision: 687

Modified:
   trunk/src/net/sf/plantlore/client/print/Print.java
   trunk/src/net/sf/plantlore/client/print/PrintCtrl.java
   trunk/src/net/sf/plantlore/client/print/PrintView.form
   trunk/src/net/sf/plantlore/client/print/PrintView.java
   trunk/src/net/sf/plantlore/common/PostTaskAction.java
Log:
Print now uses Task and Dispatcher.
It is also now possible to throw an exception from PostTaskAction.



Modified: trunk/src/net/sf/plantlore/client/print/Print.java
===================================================================
--- trunk/src/net/sf/plantlore/client/print/Print.java	2006-09-05 14:23:06 UTC (rev 686)
+++ trunk/src/net/sf/plantlore/client/print/Print.java	2006-09-05 14:33:05 UTC (rev 687)
@@ -30,6 +30,9 @@
 import net.sf.plantlore.client.AppCoreCtrl;
 import net.sf.plantlore.client.overview.JasperDataSource;
 import net.sf.plantlore.common.Selection;
+import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 import org.apache.log4j.Logger;
 
@@ -100,35 +103,46 @@
         notifyObservers("REPORT_CHOSEN");
     }
     
-    public JasperPrint createJasperPrint() throws JRException {
-        JasperReport jasperReport;
-        switch (reportToUse) {
-            case SCHEDA:
-                jasperReport = schedaReport;
-                break;
-            case A4LIST:
-                jasperReport = a4listReport;
-                break;
-            case OWNREPORT:
-                jasperReport = this.jasperReport;
-                break;
-            default:
-                jasperReport = a4listReport;
-                logger.warn("Inconsistency detected. Unknown report constant: "+reportToUse);
-        }
+    public Task createJasperPrint() {
+        final JasperReport report = this.jasperReport;
         
-        if (jasperPrint == null || reportChanged) { //jasperPrint is nulled in setSource()
-            Preferences prefs = Preferences.userNodeForPackage(AppCoreCtrl.class);
-            String h1 = prefs.get("HEADER_ONE","Set the first header in settings, please.");
-            String h2 = prefs.get("HEADER_TWO","Set the second header in settings, please.");
-            HashMap params = new HashMap();
-            params.put("HEADER_ONE",h1);
-            params.put("HEADER_TWO",h2);
-            jasperPrint = JasperFillManager.fillReport(
-                  jasperReport, params, new JasperDataSource(database, selection)  );    
-            reportChanged = false;
-        }
-        return jasperPrint;
+        Task task = new Task() {
+            public Object task() throws DBLayerException {
+                JasperReport jasperReport;
+                switch (reportToUse) {
+                    case SCHEDA:
+                        jasperReport = schedaReport;
+                        break;
+                    case A4LIST:
+                        jasperReport = a4listReport;
+                        break;
+                    case OWNREPORT:
+                        jasperReport = report;
+                        break;
+                    default:
+                        jasperReport = a4listReport;
+                        logger.warn("Inconsistency detected. Unknown report constant: "+reportToUse);
+                }
+
+                if (jasperPrint == null || reportChanged) { //jasperPrint is nulled in setSource()
+                    Preferences prefs = Preferences.userNodeForPackage(AppCoreCtrl.class);
+                    String h1 = prefs.get("HEADER_ONE","Set the first header in settings, please.");
+                    String h2 = prefs.get("HEADER_TWO","Set the second header in settings, please.");
+                    HashMap params = new HashMap();
+                    params.put("HEADER_ONE",h1);
+                    params.put("HEADER_TWO",h2);
+                    try {
+                        jasperPrint = JasperFillManager.fillReport(
+                              jasperReport, params, new JasperDataSource(database, selection)  );    
+                    } catch (JRException jrException) {
+                        throw new DBLayerException(L10n.getString("Print.Message.BrokenReport"),jrException);
+                    }
+                    reportChanged = false;
+                }
+                return jasperPrint;
+            }
+        };
+        return task;
     }
 
     public Selection getSelection() {

Modified: trunk/src/net/sf/plantlore/client/print/PrintCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/print/PrintCtrl.java	2006-09-05 14:23:06 UTC (rev 686)
+++ trunk/src/net/sf/plantlore/client/print/PrintCtrl.java	2006-09-05 14:33:05 UTC (rev 687)
@@ -20,6 +20,7 @@
 import javax.swing.AbstractAction;
 import javax.swing.JFileChooser;
 import javax.swing.JOptionPane;
+import javax.swing.SwingUtilities;
 import javax.swing.filechooser.FileFilter;
 import net.sf.jasperreports.engine.JRException;
 import net.sf.jasperreports.engine.JasperCompileManager;
@@ -29,6 +30,10 @@
 import net.sf.jasperreports.engine.JasperReport;
 import net.sf.plantlore.client.*;
 import net.sf.plantlore.client.overview.SchedaView;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.PostTaskAction;
+import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
 import org.xml.sax.SAXParseException;
@@ -111,21 +116,20 @@
             putValue(MNEMONIC_KEY, L10n.getMnemonic("Print.Print"));                                    
         }
         public void actionPerformed(ActionEvent e) {
-            try {
-                model.createJasperPrint();
-            } catch (JRException ex) {
-                logger.error("Broken report: "+ex);
-                JOptionPane.showMessageDialog(view.getParent(), L10n.getString("Print.Message.BrokenReport")+"\n"+ex.getMessage(),L10n.getString("Print.Message.BrokenReport"),JOptionPane.WARNING_MESSAGE);            
-                return;
-            }
-            
-            try {
-                JasperPrintManager.printReport(model.getJasperPrint(), true);
-            } catch (JRException ex) {
-                logger.error("Problem while trying to print: "+ex);
-                JOptionPane.showMessageDialog(view.getParent(), L10n.getString("Print.Message.PrintProblem")+"\n"+ex.getMessage(),L10n.getString("Print.Message.PrintingProblemTitle"),JOptionPane.WARNING_MESSAGE);
-                return;
-            }
+            Task task = model.createJasperPrint();
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(Object value) throws DBLayerException, Exception {
+                    if (value == null || !(value instanceof JasperPrint))
+                        throw new Exception(L10n.getString("Print.Message.PrintProblem"));
+                    try {
+                        JasperPrintManager.printReport((JasperPrint)value, true);
+                    } catch (JRException ex) {
+                        logger.error("Problem while trying to print: "+ex);
+                        throw new DBLayerException(L10n.getString("Print.Message.PrintProblem"),ex);
+                    }
+                }
+            });
+            Dispatcher.getDispatcher().dispatch(task, view, false);
         }
         
     }
@@ -158,17 +162,22 @@
             putValue(MNEMONIC_KEY, L10n.getMnemonic("Print.Preview"));                                    
         }
         public void actionPerformed(ActionEvent e) {     
-            try {
-                model.createJasperPrint();
-            } catch (JRException ex) {
-                logger.error("Broken report: "+ex);
-                JOptionPane.showMessageDialog(view.getParent(), L10n.getString("Print.Message.BrokenReport")+"\n"+ex.getMessage(),L10n.getString("Print.Message.BrokenReport"),JOptionPane.WARNING_MESSAGE);                            
-                return;
-            }
-            new SchedaView((Frame) view.getParent(), true, model.getJasperPrint()).setVisible(true);
-        }
+            Task task = model.createJasperPrint();
+            task.setPostTaskAction(new PostTaskAction() {
+                public void afterStopped(final Object value) throws Exception {
+                    if (value == null || !(value instanceof JasperPrint))
+                        throw new Exception(L10n.getString("Print.Message.PrintProblem"));
+                    SwingUtilities.invokeLater(new Runnable() {
+                       public void run() {
+                            new SchedaView((Frame) view.getParent(), true, (JasperPrint)value).setVisible(true);                           
+                       } 
+                    });//SwingUtils
+                }//afterStopped
+            });//setPostTaskAction
+            Dispatcher.getDispatcher().dispatch(task, view, false);
+        }//actionPerformed
         
-    }
+    }//PreviewAction
     
     class PrintFileFilter extends FileFilter {
         public boolean accept(File f) {

Modified: trunk/src/net/sf/plantlore/client/print/PrintView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/print/PrintView.form	2006-09-05 14:23:06 UTC (rev 686)
+++ trunk/src/net/sf/plantlore/client/print/PrintView.form	2006-09-05 14:33:05 UTC (rev 687)
@@ -10,6 +10,7 @@
   </SyntheticProperties>
   <AuxValues>
     <AuxValue name="FormSettings_generateMnemonicsCode" type="java.lang.Boolean" value="false"/>
+    <AuxValue name="FormSettings_layoutCodeTarget" type="java.lang.Integer" value="2"/>
     <AuxValue name="FormSettings_listenerGenerationStyle" type="java.lang.Integer" value="0"/>
     <AuxValue name="FormSettings_variablesLocal" type="java.lang.Boolean" value="false"/>
     <AuxValue name="FormSettings_variablesModifier" type="java.lang.Integer" value="2"/>
@@ -38,7 +39,7 @@
               <Component id="numOfRecordsLabel" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Component id="jPanel2" min="-2" max="-2" attributes="0"/>
-              <EmptySpace pref="7" max="32767" attributes="0"/>
+              <EmptySpace pref="8" max="32767" attributes="0"/>
               <Component id="jPanel1" min="-2" max="-2" attributes="0"/>
           </Group>
       </Group>

Modified: trunk/src/net/sf/plantlore/client/print/PrintView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/print/PrintView.java	2006-09-05 14:23:06 UTC (rev 686)
+++ trunk/src/net/sf/plantlore/client/print/PrintView.java	2006-09-05 14:33:05 UTC (rev 687)
@@ -9,6 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 import net.sf.plantlore.client.*;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -39,6 +40,9 @@
                 break;
             default:                
         }
+        
+        setLocationRelativeTo(parent);
+        new DefaultEscapeKeyPressed(this);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/common/PostTaskAction.java
===================================================================
--- trunk/src/net/sf/plantlore/common/PostTaskAction.java	2006-09-05 14:23:06 UTC (rev 686)
+++ trunk/src/net/sf/plantlore/common/PostTaskAction.java	2006-09-05 14:33:05 UTC (rev 687)
@@ -14,5 +14,5 @@
  * @author fraktalek
  */
 public interface PostTaskAction {    
-    public void afterStopped(Object value);
+    public void afterStopped(Object value) throws Exception;
 }



From krater at mail.berlios.de  Tue Sep  5 17:41:54 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 17:41:54 +0200
Subject: [Plantlore-dev] r688 - trunk/src/net/sf/plantlore/common
Message-ID: <200609051541.k85FfsnF026487@sheep.berlios.de>

Author: krater
Date: 2006-09-05 17:41:51 +0200 (Tue, 05 Sep 2006)
New Revision: 688

Modified:
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
Log:
Reconnect Disabled for good.

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 14:33:05 UTC (rev 687)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 15:41:51 UTC (rev 688)
@@ -13,6 +13,8 @@
 /**
  * The Default Exception Handler offers a united exception handling and
  * error presentation. It can offer reconnect if it is reasonable.
+ * <br/>
+ * The reconnect has been disabled permanently.
  * 
  * @author Erik Kratochv?l (discontinuum at gmail.com)
  * @since 2006-08-28
@@ -170,17 +172,18 @@
 		}
 		
 		// Announce the error and offer the reconnection.
-		if( !isReconnectDisabled && isReconnectReasonable && ! doNotOfferReconnect )
+		if( false && !isReconnectDisabled && isReconnectReasonable && ! doNotOfferReconnect )
 			DefaultReconnectDialog.show(parent, problemDescription);
+		
 		// Just announce the problem.
-		else {
+		else 
 			JOptionPane.showMessageDialog( 
 					parent, 
 					problemDescription, 
 					title, 
 					JOptionPane.ERROR_MESSAGE );
-		}
 		
+		
 	}
 	
 	



From kovo at mail.berlios.de  Tue Sep  5 19:33:47 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 5 Sep 2006 19:33:47 +0200
Subject: [Plantlore-dev] r689 - in trunk/src/net/sf/plantlore:
	client/createdb client/login client/overview common
	common/exception config config/database middleware server
Message-ID: <200609051733.k85HXliP016085@sheep.berlios.de>

Author: kovo
Date: 2006-09-05 19:33:32 +0200 (Tue, 05 Sep 2006)
New Revision: 689

Added:
   trunk/src/net/sf/plantlore/config/database/
   trunk/src/net/sf/plantlore/config/database/createtables_postgres.sql
   trunk/src/net/sf/plantlore/config/database/createusers_postgres.sql
Modified:
   trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/client/login/Login.java
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/common/PlantloreConstants.java
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Update of the DBLayer in order to solve Hibernate-RMI problem which caused exceptions when saving associated tables. DBLayer interface was changed as well therefore you have to update your sources in order to compile Plantlore. For details see my email to plantlore-dev.
The following was implemented as well:
* Assigning unique database identifier and unique record identifier to newlz created occurrences
* Create database - it only works for PostgreSQL database and still needs testing and minor adjustments (currently it will only work on fresh Postgre installations)

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -2,6 +2,11 @@
 
 import java.util.ArrayList;
 import java.util.Observable;
+import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.common.record.User;
+import net.sf.plantlore.middleware.DBLayer;
+import net.sf.plantlore.middleware.DBLayerFactory;
+import net.sf.plantlore.middleware.RMIDBLayerFactory;
 
 import org.apache.log4j.Logger;
 
@@ -43,7 +48,9 @@
 	private MainConfig config;
 	private DBInfo info;
 	private boolean leaveEmpty = false;
-		
+	private DBLayerFactory factory = null;
+	private DBLayer currentDBLayer; 
+		        
 	/**
 	 * Create a new CreateDB.
 	 * 
@@ -135,15 +142,68 @@
 		public Object task() throws Exception {
 			
 			try {
-				if(isCanceled())
+				if(isCanceled()) {
 					throw new Exception(L10n.getString("Common.Canceled"));
+                                }				
+                                                               
+				// Create a new database layer ~ ask the DBLayerFactory to create it for us..
+				logger.debug("Asking the DBLayerFactory for a new DBLayer @ " + dbinfo.getHost() + ":" + dbinfo.getPort());
+				setStatusMessage(L10n.getString("Login.Connecting") );
+                                factory = RMIDBLayerFactory.getDBLayerFactory();
+				currentDBLayer = factory.create(dbinfo);
+				if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }		
+                                logger.debug("Connection successful.");
 				
+				// Initialize the database layer.
+				setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
+				logger.debug("Initializing that DBLayer.");				
+                                // Connect to template1 database. TODO: this should not be hardcoded
+				currentDBLayer.initializeNewDB("template1", name, password);
+				if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
+				logger.debug("Initialization successful. Connected to template1 database");
+                                
+                                // Create users in the database
+                                setStatusMessage(L10n.getString("CreateDB.CreatingUsers") );                                
+                                currentDBLayer.executeSQLScript(DBLayer.CREATE_USERS, dbinfo.getDatabaseIdentifier(), name, password);
+                                logger.debug("Database "+dbinfo.getDatabaseIdentifier()+" users created successfuly");
+                                
+                                // Create new database
+                                setStatusMessage(L10n.getString("CreateDB.CreatingDatabase") );                                
+                                currentDBLayer.createDatabase(dbinfo.getDatabaseIdentifier());
+                                logger.debug("New database created succesfully");
+
+                                // Disconnect - destroy DBLayer
+                                factory.destroy(currentDBLayer);
+                                logger.debug("Disconnected from the database template1");
+                                
+                                // Connect to the newly created database
+				currentDBLayer = factory.create(dbinfo);
+				if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }
+				logger.debug("Connection successful.");
+				setStatusMessage( L10n.getString("Login.Connected") );
+				
+				// Initialize the database layer.
+				setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
+				logger.debug("Initializing that DBLayer.");
+				
+				currentDBLayer.initializeNewDB(dbinfo.getDatabaseIdentifier(), name, password);
+				if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
+				logger.debug("Initialization successful. Connected to database "+dbinfo.getDatabaseIdentifier());
+                                
+                                // Create tables in the new database
+				setStatusMessage(L10n.getString("CreateDB.CreatingTables"));                                
+                                currentDBLayer.executeSQLScript(DBLayer.CREATE_TABLES, dbinfo.getDatabaseIdentifier(), name, password);
+                                logger.debug("New database tables created");
+                                // Disconnect - destroy DBLayer
+                                factory.destroy(currentDBLayer);
+                                logger.debug("Disconnected from the database "+dbinfo.getDatabaseIdentifier());
+                                
 				/*
 				 * TODO:
 				 * 
 				 * HERE GOES YOUR CODE THAT PERFORMS 
 				 * 1. THE CONNECTION TO THE DATABASE ENGINE
-				 *    You should use ifnormation stored in dbinfo and the stored name and password.
+				 *    You should use inormation stored in dbinfo and the stored name and password.
 				 *    See HibernateDBLayer.initialize().
 				 * 2. THE CREATION OF THE NEW DATABASE
 				 *    Here it is up to you, I have no idea what should be done here.
@@ -159,8 +219,7 @@
 
 			} 
 			catch (Exception e) {
-				logger.error("The creation of the database failed! " + e.getMessage());
-				
+				logger.error("The creation of the database failed! " + e.getMessage());			
 				// Re-throw the exception so that the view is updated as well.
 				throw e;
 			}

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -1,10 +1,13 @@
 package net.sf.plantlore.client.createdb;
 
 import java.awt.event.ActionEvent;
+import java.awt.event.FocusEvent;
+import java.awt.event.FocusListener;
 
 import javax.swing.JOptionPane;
 
 import net.sf.plantlore.common.DefaultCancelAction;
+import net.sf.plantlore.common.PlantloreConstants;
 import net.sf.plantlore.common.StandardAction;
 import net.sf.plantlore.l10n.L10n;
 
@@ -33,7 +36,7 @@
 		/*authCtrl =*/ new CreateDBAuthCtrl( model, authView );
 		
 		view.cancel.setAction( new DefaultCancelAction(view) );
-		
+                view.databaseEngineAddFocusListener(new DatabaseEngineComboFocusListener());
 		view.next.setAction( new StandardAction("Login.Next") {
 			public void actionPerformed(ActionEvent arg0) {
 				String 
@@ -61,6 +64,32 @@
 			}
 		});
 	}
-	
+        
+    /**
+     *  Focus listener for the <strong>DatabaseEngine combobox</strong>. After losing focus
+     *  automaticaly loads default port for the given database.
+     */
+    class DatabaseEngineComboFocusListener implements FocusListener {
+        public void focusLost(FocusEvent e) {
+            switch (view.getDatabaseEngine()) {
+                case 0: // PostgreSQL
+                    view.setDatabasePort(PlantloreConstants.POSTGRE_PORT);
+                    break;
+                case 1: // Firebird
+                    view.setDatabasePort(PlantloreConstants.FIREBIRD_PORT);
+                    break;                    
+                case 2: // MySQL
+                    view.setDatabasePort(PlantloreConstants.MYSQL_PORT);
+                    break;                    
+                case 3: // Oracle
+                    view.setDatabasePort(PlantloreConstants.ORACLE_PORT);
+                    break;
+            }
+        }        
 
+        public void focusGained(FocusEvent e) {
+            // Empty, no action when focus gained
+        }
+    }            	
+
 }

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-05 17:33:32 UTC (rev 689)
@@ -73,11 +73,11 @@
                   <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Component id="jLabel1" min="-2" max="-2" attributes="0"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
-                  <Component id="databaseEngine" pref="144" max="32767" attributes="2"/>
+                  <Component id="databaseEngine" pref="149" max="32767" attributes="2"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Component id="jLabel2" min="-2" max="-2" attributes="0"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
-                  <Component id="databasePort" pref="71" max="32767" attributes="0"/>
+                  <Component id="databasePort" pref="76" max="32767" attributes="0"/>
                   <EmptySpace max="-2" attributes="0"/>
               </Group>
           </Group>
@@ -166,8 +166,8 @@
                           </Group>
                           <EmptySpace min="-2" pref="11" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="databaseAlias" alignment="0" pref="268" max="32767" attributes="0"/>
-                              <Component id="databaseIdentifier" alignment="0" pref="268" max="32767" attributes="0"/>
+                              <Component id="databaseAlias" alignment="0" pref="278" max="32767" attributes="0"/>
+                              <Component id="databaseIdentifier" alignment="0" pref="278" max="32767" attributes="0"/>
                           </Group>
                       </Group>
                       <Group type="102" alignment="0" attributes="0">

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -1,6 +1,7 @@
 package net.sf.plantlore.client.createdb;
 
 import java.awt.Frame;
+import java.awt.event.FocusListener;
 import java.util.Observable;
 import java.util.Observer;
 
@@ -223,5 +224,28 @@
     		}
 		});
 	}
+ 
+    /**
+     *  Add FocusListener to DatabaseEngine combo.
+     *  @param fl FocusListener for the DatabaseEngine combo
+     */    
+    void databaseEngineAddFocusListener(FocusListener fl) {
+        databaseEngine.addFocusListener(fl);
+    }
+        
+    /**
+     *  Return index of the selected database engine in the combobox
+     *  @return index of the selected item in the combobox
+     */
+    public int getDatabaseEngine() {
+        return databaseEngine.getSelectedIndex();
+    }
     
+    /**
+     *  Set the database port in the dialog to the given value
+     *  @param port port number to set
+     */
+    public void setDatabasePort(String port) {
+        databasePort.setText(port);
+    }
 }

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -8,6 +8,7 @@
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.common.record.Record;
 import net.sf.plantlore.common.record.User;
 
 import org.apache.log4j.Logger;
@@ -454,12 +455,17 @@
 			return wrappedDBLayer.initialize(dbID, user, password);
 		}
 
+		synchronized public void initializeNewDB(String dbID, String user, String password) throws DBLayerException, RemoteException {
+			verifyValidity();
+			wrappedDBLayer.initializeNewDB(dbID, user, password);
+		}
+                
 		synchronized public void setLanguage(String locale) throws DBLayerException, RemoteException {
 			verifyValidity();
 			wrappedDBLayer.setLanguage(locale);
 		}
 
-		synchronized public int executeInsert(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeInsert(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
 			return wrappedDBLayer.executeInsert(data);
 		}
@@ -469,12 +475,12 @@
 			wrappedDBLayer.executeDelete(data);
 		}
 
-		synchronized public void executeUpdate(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeUpdate(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
-			wrappedDBLayer.executeUpdate(data);
+			return wrappedDBLayer.executeUpdate(data);
 		}
 
-		synchronized public int executeInsertHistory(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeInsertHistory(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
 			return wrappedDBLayer.executeInsertHistory(data);
 		}
@@ -489,14 +495,14 @@
 			wrappedDBLayer.executeDeleteInTransactionHistory(data);
 		}
                 
-		synchronized public void executeUpdateHistory(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeUpdateHistory(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
-			wrappedDBLayer.executeUpdateHistory(data);
+			return wrappedDBLayer.executeUpdateHistory(data);
 		}
 
-		synchronized public void executeUpdateInTransactionHistory(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeUpdateInTransactionHistory(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
-			wrappedDBLayer.executeUpdateInTransactionHistory(data);
+			return wrappedDBLayer.executeUpdateInTransactionHistory(data);
 		}
 
 		synchronized public Object[] more(int resultId, int from, int to) throws DBLayerException, RemoteException {
@@ -564,19 +570,19 @@
 			return wrappedDBLayer.rollbackTransaction();
 		}
 
-		synchronized public int executeInsertInTransaction(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeInsertInTransaction(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
 			return wrappedDBLayer.executeInsertInTransaction(data);
 		}
-
-		synchronized public int executeInsertInTransactionHistory(Object data) throws DBLayerException, RemoteException {
+               
+		synchronized public Record executeInsertInTransactionHistory(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
 			return wrappedDBLayer.executeInsertInTransactionHistory(data);
 		}
 
-		synchronized public void executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException {
+		synchronized public Record executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException {
 			verifyValidity();
-			wrappedDBLayer.executeUpdateInTransaction(data);
+			return wrappedDBLayer.executeUpdateInTransaction(data);
 		}
 
 		synchronized public void executeDeleteInTransaction(Object data) throws DBLayerException, RemoteException {
@@ -613,6 +619,16 @@
 			throw new Error("It is forbidden to call this method. The proper way to destroy a database layer is the logout() method!");
 		}
 		
+                synchronized public void createDatabase(String dbname) throws RemoteException, DBLayerException {
+			verifyValidity();
+			wrappedDBLayer.createDatabase(dbname);
+                }
+
+                synchronized public void executeSQLScript(int scriptid, String dbname, String username, String password) throws RemoteException, DBLayerException {
+			verifyValidity();
+			wrappedDBLayer.executeSQLScript(scriptid, dbname, username, password);
+                }                
+                
 		@Override
 		public String toString() {
 			return "Safety wrapper of " + super.toString();

Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -888,8 +888,7 @@
         } else {
             //we've already created and set up a new Habitat now we have to store it into the database
             h.setDeleted(0);
-            int habId = database.executeInsertInTransaction(h);
-            h.setId(habId);
+            h = (Habitat)database.executeInsertInTransaction(h);
         }
         
         m = o.getMetadata();
@@ -959,8 +958,7 @@
         hTmp.setTerritory(o.getHabitat().getTerritory());
         hTmp.setDeleted(0);
         
-        int habId = database.executeInsertInTransaction(hTmp);
-        hTmp.setId(habId);
+        hTmp = (Habitat)database.executeInsertInTransaction(hTmp);
         
         occTmp.setDataSource(o.getDataSource());
         occTmp.setDayCollected(o.getDayCollected());
@@ -1106,8 +1104,7 @@
                                 logger.info("Creating a new occurrence for "+taxonList.get(j));
                                 Occurrence occTmp = cloneOccurrence();
                                 occTmp.setPlant((Plant) dlu.getObjectFor(lookupPlant(taxonList.get(j)),Plant.class));
-                                int occId = database.executeInsertInTransaction(occTmp);
-                                occTmp.setId(occId);
+                                occTmp = (Occurrence)database.executeInsertInTransaction(occTmp);
                                 logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occTmp.getId());
                                 Integer id = lookupPlant(taxonList.get(j));
                                 if (!id.equals(-1)) {
@@ -1187,23 +1184,22 @@
 
                             logger.info("Creating a shared habitat");
                             Record rec = dlu.findMatchInDB(h);
+
                             if (rec == null) {
                                 logger.debug("THIS HABITAT is NOT in the database yet. Creating a new one.");
-                                int habId = database.executeInsertInTransaction(h);//insert the shared habitat
-                                h.setId(habId);
+                                h = (Habitat)database.executeInsertInTransaction(h);//insert the shared habitat                                
                                 logger.debug("Shared habitat created. Id="+h.getId());
                             } else {
                                 logger.debug("THIS HABITAT ALREADY IS in the database! Using it.");
                                 h = (Habitat) rec;
                             }
-
+                            int aoTmpId = 0;
                             for (int j = 0; j < taxonList.size(); j++) {
                                 logger.info("Creating an Occurrence using the shared habitat");
                                 Occurrence occ = prepareNewOccurrence(taxonList.get(j), h);//share the habitat
-                                int occId = database.executeInsertInTransaction(occ);
-                                occ.setId(occId);
+                                occ = (Occurrence)database.executeInsertInTransaction(occ);
                                 logger.debug("Occurrence for "+taxonList.get(j)+" inserted. Id="+occ.getId());
-
+                                
                                 for (int k = 0; k < authorList.size(); k++) {
                                     Pair<Pair<String,Integer>,String> pTmp = authorList.get(k);
                                     logger.info("Creating an AuthorOccurrence for "+occ.getPlant().getTaxon()+" and "+pTmp.getFirst().getFirst());
@@ -1213,12 +1209,11 @@
                                     aoTmp.setNote(resultRevision.get(k));
                                     aoTmp.setOccurrence(occ);
                                     aoTmp.setDeleted(0);
-                                    database.executeInsertInTransaction(aoTmp);                            
+                                    aoTmp = (AuthorOccurrence)database.executeInsertInTransaction(aoTmp);
                                 }//for authorList
-                            }// for taxonList
-
+                            }// for taxonList                            
                             database.commitTransaction();
-                            occurrenceTableModel.load(h.getId());
+                            occurrenceTableModel.load(h.getId());                                
                         }//add mode
                 } catch (DBLayerException ex) {
                     database.rollbackTransaction();

Modified: trunk/src/net/sf/plantlore/common/PlantloreConstants.java
===================================================================
--- trunk/src/net/sf/plantlore/common/PlantloreConstants.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/common/PlantloreConstants.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -143,9 +143,10 @@
     /** Constants used for Preferences keys */
     public static final String PREF_DYNAMIC_PAGE_SIZE = "Overview.dynamicPageSize";
     
-    
-//    /** Creates a new instance of PlantloreConstants */
-//    public PlantloreConstants() {
-//    }
-    
+    /** Default port numbers for different databases */
+    public static final String POSTGRE_PORT = "5432";
+    public static final String FIREBIRD_PORT = "3050";
+    public static final String MYSQL_PORT = "3306";
+    public static final String ORACLE_PORT = "1521";        
+        
 }

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -61,7 +61,9 @@
         /** Out of memmory error occurred */
         public static final int ERROR_OUT_OF_MEMORY = 15;        
         /** Maximum number of connections achieved */
-        public static final int ERROR_MAX_CONNECTIONS = 16;                
+        public static final int ERROR_MAX_CONNECTIONS = 16;  
+        /** CREATE DATABASE statement failed or unable to create tables/users */
+        public static final int ERROR_CREATEDB = 17;
         /** Some other error */        
         public static final int ERROR_OTHER = 20;
         // ==============================================

Added: trunk/src/net/sf/plantlore/config/database/createtables_postgres.sql
===================================================================
--- trunk/src/net/sf/plantlore/config/database/createtables_postgres.sql	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/config/database/createtables_postgres.sql	2006-09-05 17:33:32 UTC (rev 689)
@@ -0,0 +1,360 @@
+SET client_encoding = 'UNICODE';
+
+SET search_path = public, pg_catalog;
+
+SET default_tablespace = '';
+
+SET default_with_oids = true;
+
+CREATE TABLE TUNITIDDATABASE (
+    CID                  INTEGER NOT NULL,
+    CUNITIDDB            VARCHAR(30) NOT NULL,    
+PRIMARY KEY (CID));
+
+CREATE TABLE TAUTHORS (
+    CID               SERIAL NOT NULL,    
+    CWHOLENAME        VARCHAR(50) NOT NULL,
+    CORGANIZATION     VARCHAR(50),
+    CTELEPHONENUMBER  VARCHAR(20),
+    CROLE             VARCHAR(30),
+    CADDRESS          VARCHAR(255),
+    CEMAIL            VARCHAR(100),
+    CURL              VARCHAR(255),
+    CNOTE             VARCHAR(4096),
+    CCREATEWHO        INTEGER NOT NULL, 
+    CDELETE           SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TAUTHORSOCCURRENCES (
+    CAUTHORID          SERIAL NOT NULL,
+    COCCURRENCEID      INTEGER NOT NULL,
+    CID                INTEGER NOT NULL,
+    CROLE              VARCHAR(20),
+    CNOTE              VARCHAR(4096),
+    CDELETE           SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE THABITATS (
+    CID                SERIAL NOT NULL,
+    CTERRITORYID       INTEGER NOT NULL,
+    CPHYTOCHORIAID     INTEGER NOT NULL,
+    CQUADRANT          VARCHAR(10),
+    CDESCRIPTION       VARCHAR(255),
+    CNEARESTVILLAGEID  INTEGER NOT NULL,
+    CCOUNTRY           VARCHAR(30),
+    CALTITUDE          DECIMAL(6,2),
+    CLATITUDE          DOUBLE PRECISION,
+    CLONGITUDE         DOUBLE PRECISION,
+    CNOTE              VARCHAR(4096),
+    CCREATEWHO        INTEGER NOT NULL,
+    CDELETE            SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE THISTORY (
+        CID       SERIAL NOT NULL,
+        CCOLUMNID INTEGER NOT NULL,
+        CCHANGEID INTEGER NOT NULL,
+        COLDVALUE VARCHAR(4096),
+        CNEWVALUE VARCHAR(4096),
+        COLDRECORDID   INTEGER,
+        CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE THISTORYCHANGE (
+    CID            SERIAL NOT NULL,    
+    CRECORDID      INTEGER  DEFAULT 0 NOT NULL,    
+    COPERATION     SMALLINT  DEFAULT 0 NOT NULL,
+    CWHEN          TIMESTAMP NOT NULL,
+    CWHO           INTEGER NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE THISTORYCOLUMN (
+    CID          SERIAL NOT NULL,
+    CTABLENAME   VARCHAR(20) NOT NULL,
+    CCOLUMNNAME  VARCHAR(30),
+PRIMARY KEY (CID));
+
+CREATE TABLE TMETADATA (
+    CID                       SERIAL NOT NULL,
+    CTECHNICALCONTACTNAME     VARCHAR(50) NOT NULL,
+    CTECHNICALCONTACTEMAIL    VARCHAR(100),
+    CTECHNICALCONTACTADDRESS  VARCHAR(255),
+    CCONTENTCONTACTNAME       VARCHAR(50) NOT NULL,
+    CCONTENTCONTACTEMAIL      VARCHAR(100),
+    CCONTENTCONTACTADDRESS    VARCHAR(255),
+    CDATASETTITLE             VARCHAR(50) NOT NULL,
+    CDATASETDETAILS           VARCHAR(255),
+    CSOURCEINSTITUTIONID      VARCHAR(50) NOT NULL,
+    CSOURCEID                 VARCHAR(50) NOT NULL,
+    COWNERORGANIZATIONABBREV  VARCHAR(50),
+    CDATECREATE               TIMESTAMP NOT NULL,
+    CDATEMODIFIED             TIMESTAMP NOT NULL,
+    CRECORDBASIS              VARCHAR(15),
+    CBIOTOPETEXT              VARCHAR(50),
+    CDELETE                   SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TOCCURRENCES (
+    CID                SERIAL NOT NULL,
+    CUNITIDDB          VARCHAR(40) NOT NULL,
+    CUNITVALUE         INTEGER NOT NULL,
+    CHABITATID         INTEGER NOT NULL,
+    CPLANTID           INTEGER NOT NULL,
+    CYEARCOLLECTED     SMALLINT DEFAULT 0 NOT NULL,
+    CMONTHCOLLECTED    SMALLINT DEFAULT 0,
+    CDAYCOLLECTED      SMALLINT DEFAULT 0,
+    CTIMECOLLECTED     TIME,
+    CISODATETIMEBEGIN  TIMESTAMP,
+    CDATASOURCE        VARCHAR(50),
+    CPUBLICATIONSID    INTEGER,
+    CHERBARIUM         VARCHAR(20),
+    CCREATEWHEN        TIMESTAMP NOT NULL,
+    CCREATEWHO         INTEGER NOT NULL,
+    CUPDATEWHEN        TIMESTAMP NOT NULL,
+    CUPDATEWHO         INTEGER NOT NULL,
+    CNOTE              VARCHAR(4096),
+    CMETADATAID        INTEGER NOT NULL,
+    CDELETE            SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TPHYTOCHORIA (
+    CID    SERIAL NOT NULL,
+    CCODE  VARCHAR(5) NOT NULL,
+    CNAME  VARCHAR(50) NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TPLANTS (
+    CID                    SERIAL NOT NULL,
+    CSURVEYTAXID           VARCHAR(20) NOT NULL,
+    CTAXON                 VARCHAR(255) NOT NULL,
+    CGENUS                 VARCHAR(30),
+    CSPECIES               VARCHAR(100),
+    CSCIENTIFICNAMEAUTHOR  VARCHAR(150),
+    CCZECHNAME             VARCHAR(50),
+    CSYNONYMS              VARCHAR(255),
+    CNOTE                  VARCHAR(255),
+PRIMARY KEY (CID));
+
+CREATE TABLE TPUBLICATIONS (
+    CID                         SERIAL NOT NULL,
+    CCOLLECTIONNAME             VARCHAR(255),
+    CCOLLECTIONYEARPUBLICATION  SMALLINT,
+    CJOURNALNAME                VARCHAR(255),
+    CJOURNALAUTHORNAME          VARCHAR(255),
+    CREFERENCECITATION          VARCHAR(4096) NOT NULL,
+    CREFERENCEDETAIL            VARCHAR(100),
+    CURL                        VARCHAR(100),
+    CNOTE                       VARCHAR(4096),
+    CCREATEWHO                  INTEGER NOT NULL,
+    CDELETE                     SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TRIGHT (
+    CID             SERIAL NOT NULL,
+    CADMINISTRATOR  SMALLINT DEFAULT 0 NOT NULL,
+    CEDITALL        SMALLINT DEFAULT 0 NOT NULL,
+    CEDITGROUP      VARCHAR(4096),
+    CADD            SMALLINT DEFAULT 0 NOT NULL,
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TTERRITORIES (
+    CID    SERIAL NOT NULL,
+    CNAME  VARCHAR(100) NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TUSER (
+    CID          SERIAL NOT NULL,
+    CLOGIN       VARCHAR(20) NOT NULL,   
+    CFIRSTNAME   VARCHAR(20),
+    CSURNAME     VARCHAR(30),
+    CWHOLENAME   VARCHAR(50) NOT NULL,
+    CEMAIL       VARCHAR(50),
+    CADDRESS     VARCHAR(255),
+    CCREATEWHEN  TIMESTAMP NOT NULL,
+    CDROPWHEN    TIMESTAMP,
+    CRIGHTID     INTEGER NOT NULL,
+    CNOTE        VARCHAR(4096),
+    CVERSION          INTEGER DEFAULT 0 NOT NULL,
+PRIMARY KEY (CID));
+
+CREATE TABLE TVILLAGES (
+    CID    SERIAL NOT NULL,
+    CNAME  VARCHAR(50) NOT NULL,
+PRIMARY KEY (CID));
+
+ALTER TABLE TAUTHORSOCCURRENCES ADD FOREIGN KEY (CAUTHORID) REFERENCES TAUTHORS (CID);
+
+ALTER TABLE TAUTHORSOCCURRENCES ADD FOREIGN KEY (COCCURRENCEID) REFERENCES TOCCURRENCES (CID);
+
+ALTER TABLE THABITATS ADD FOREIGN KEY (CTERRITORYID) REFERENCES TTERRITORIES (CID);
+
+ALTER TABLE THABITATS ADD FOREIGN KEY (CPHYTOCHORIAID) REFERENCES TPHYTOCHORIA (CID);
+
+ALTER TABLE THABITATS ADD FOREIGN KEY (CNEARESTVILLAGEID) REFERENCES TVILLAGES (CID);
+
+ALTER TABLE THISTORY ADD FOREIGN KEY (CCOLUMNID) REFERENCES THISTORYCOLUMN (CID);
+
+ALTER TABLE THISTORY ADD FOREIGN KEY (CCHANGEID) REFERENCES THISTORYCHANGE (CID);
+
+ALTER TABLE THISTORYCHANGE ADD FOREIGN KEY (CWHO) REFERENCES TUSER (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CHABITATID) REFERENCES THABITATS (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CPLANTID) REFERENCES TPLANTS (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CCREATEWHO) REFERENCES TUSER (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CUPDATEWHO) REFERENCES TUSER (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CMETADATAID) REFERENCES TMETADATA (CID);
+
+ALTER TABLE TOCCURRENCES ADD FOREIGN KEY (CPUBLICATIONSID) REFERENCES TPUBLICATIONS (CID);
+
+ALTER TABLE TUSER ADD FOREIGN KEY (CRIGHTID) REFERENCES TRIGHT (CID);
+
+ALTER TABLE TAUTHORS ADD FOREIGN KEY (CCREATEWHO) REFERENCES TUSER (CID);
+
+ALTER TABLE TPUBLICATIONS ADD FOREIGN KEY (CCREATEWHO) REFERENCES TUSER (CID);
+
+ALTER TABLE THABITATS ADD FOREIGN KEY (CCREATEWHO) REFERENCES TUSER (CID);
+
+CREATE VIEW voccurrences AS SELECT * FROM toccurrences WHERE cdelete = 0;        
+
+CREATE VIEW vmetadata AS SELECT * FROM tmetadata WHERE cdelete = 0;
+
+CREATE VIEW vhabitats AS SELECT * FROM thabitats WHERE cdelete = 0;
+
+CREATE VIEW vpublications AS SELECT * FROM tpublications WHERE cdelete = 0;
+
+CREATE OR REPLACE VIEW vauthorscollected AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid WHERE ao.crole = 'collected' AND ao.cdelete = 0;
+
+CREATE OR REPLACE VIEW vauthorsrevised AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid WHERE ao.crole = 'revised' AND ao.cdelete = 0;
+
+CREATE OR REPLACE VIEW vauthorsidentified AS SELECT ao.cid, ao.coccurrenceid, ao.cnote, a.cwholename, a.corganization, a.ctelephonenumber, a.crole, a.cemail, a.caddress, a.curl FROM  tauthors a JOIN tauthorsoccurrences ao on a.cid = ao.cauthorid WHERE ao.crole = 'identified' AND ao.cdelete = 0;
+
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON tauthors TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON tauthorsoccurrences TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THABITATS TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORY TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCHANGE TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCOLUMN TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TMETADATA TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TOCCURRENCES TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPHYTOCHORIA TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPLANTS TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TTERRITORIES TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TUSER TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TRIGHT TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TVILLAGES TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPUBLICATIONS TO Plantlore_Role_Admin;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TUNITIDDATABASE TO Plantlore_Role_Admin;
+
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TAUTHORS TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TAUTHORSOCCURRENCES TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THABITATS TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORY TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON THISTORYCHANGE TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TMETADATA TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TOCCURRENCES TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPHYTOCHORIA TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPLANTS TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TTERRITORIES TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TVILLAGES TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TPUBLICATIONS TO Plantlore_Role_User;
+GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TUNITIDDATABASE TO Plantlore_Role_User;
+
+GRANT SELECT, REFERENCES ON THISTORYCOLUMN TO Plantlore_Role_User;
+GRANT SELECT, REFERENCES ON TUSER TO Plantlore_Role_User;
+GRANT SELECT, REFERENCES ON TRIGHT TO Plantlore_Role_User;
+
+GRANT SELECT ON vhabitats TO Plantlore_Role_www;
+GRANT SELECT ON vmetadata TO Plantlore_Role_www;
+GRANT SELECT ON voccurrences TO Plantlore_Role_www;
+GRANT SELECT ON tphytochoria TO Plantlore_Role_www;
+GRANT SELECT ON tplants TO Plantlore_Role_www;
+GRANT SELECT ON tterritories TO Plantlore_Role_www;
+GRANT SELECT ON tuser TO Plantlore_Role_www;
+GRANT SELECT ON tvillages TO Plantlore_Role_www;
+GRANT SELECT ON vpublications TO Plantlore_Role_www;
+GRANT SELECT ON vauthorscollected TO Plantlore_Role_www;
+GRANT SELECT ON vauthorsrevised TO Plantlore_Role_www;
+GRANT SELECT ON vauthorsidentified TO Plantlore_Role_www;
+
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (1, 'AUTHOROCCURRENCE', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (2, 'OCCURRENCE', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (3, 'HABITAT', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (4, 'AUTHOR', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (5, 'METADATA', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (6, 'PUBLICATION', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (7, 'TERRITORY', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (8, 'VILLAGE', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (9, 'PHYTOCHORION', NULL);
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (10, 'AUTHOROCCURRENCE', 'role');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (11, 'AUTHOROCCURRENCE', 'note');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (12, 'OCCURRENCE', 'plant');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (13, 'OCCURRENCE', 'habitat');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (14, 'OCCURRENCE', 'yearCollected');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (15, 'OCCURRENCE', 'monthCollected');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (16, 'OCCURRENCE', 'dayCollected');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (17, 'OCCURRENCE', 'timeCollected');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (18, 'OCCURRENCE', 'dataSource');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (19, 'OCCURRENCE', 'publication');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (20, 'OCCURRENCE', 'herbarium');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (21, 'OCCURRENCE', 'metadata');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (22, 'OCCURRENCE', 'note');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (23, 'HABITAT', 'territory');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (24, 'HABITAT', 'phytochorion');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (25, 'HABITAT', 'village');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (26, 'HABITAT', 'quadrant');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (27, 'HABITAT', 'description');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (28, 'HABITAT', 'country');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (29, 'HABITAT', 'altitude');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (30, 'HABITAT', 'latitude');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (31, 'HABITAT', 'longitude');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (32, 'HABITAT', 'note');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (33, 'AUTHOR', 'wholeName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (34, 'AUTHOR', 'organization');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (35, 'AUTHOR', 'role');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (36, 'AUTHOR', 'address');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (37, 'AUTHOR', 'phoneNumber');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (38, 'AUTHOR', 'email');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (39, 'AUTHOR', 'url');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (40, 'AUTHOR', 'note');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (41, 'METADATA', 'technicalContactName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (42, 'METADATA', 'technicalContactAddress');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (43, 'METADATA', 'technicalContactEmail');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (44, 'METADATA', 'contentContactName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (45, 'METADATA', 'contentContactAddress');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (46, 'METADATA', 'contentContactEmail');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (47, 'METADATA', 'dataSetTitle');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (48, 'METADATA', 'dataSetDetails');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (49, 'METADATA', 'sourceInstitutionId');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (50, 'METADATA', 'sourceId');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (51, 'METADATA', 'ownerOrganizationAbbrev');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (52, 'METADATA', 'dateCreate');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (53, 'METADATA', 'dateModified');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (54, 'METADATA', 'recordBasis');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (55, 'METADATA', 'biotopeText');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (56, 'METADATA', 'versionPlantsFile');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (57, 'PUBLICATION', 'collectionName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (58, 'PUBLICATION', 'collectionYearPUBLICATION');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (59, 'PUBLICATION', 'journalName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (60, 'PUBLICATION', 'journalAuthorName');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (61, 'PUBLICATION', 'referenceCitation');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (62, 'PUBLICATION', 'referenceDetail');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (63, 'PUBLICATION', 'url');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (64, 'PUBLICATION', 'note');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (65, 'VILLAGE', 'name');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (66, 'TERRITORY', 'name');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (67, 'PHYTOCHORIA', 'name');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (68, 'PHYTOCHORIA', 'code');
+INSERT INTO thistorycolumn (cid, ctablename, ccolumnname) VALUES (69, 'HABITAT', 'nearestVillage');

Added: trunk/src/net/sf/plantlore/config/database/createusers_postgres.sql
===================================================================
--- trunk/src/net/sf/plantlore/config/database/createusers_postgres.sql	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/config/database/createusers_postgres.sql	2006-09-05 17:33:32 UTC (rev 689)
@@ -0,0 +1,11 @@
+SET client_encoding = 'UNICODE';
+
+SET search_path = public, pg_catalog;
+
+SET default_tablespace = '';
+
+SET default_with_oids = true;
+
+CREATE ROLE Plantlore_Role_www WITH NOSUPERUSER NOCREATEDB NOCREATEROLE LOGIN;
+CREATE ROLE  Plantlore_Role_User WITH NOSUPERUSER NOCREATEDB NOCREATEROLE LOGIN;
+CREATE ROLE Plantlore_Role_Admin WITH SUPERUSER CREATEDB CREATEROLE LOGIN;

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -10,6 +10,7 @@
 import java.io.Serializable;
 import java.rmi.Remote;
 import java.rmi.RemoteException;
+import net.sf.plantlore.common.record.Record;
 
 import net.sf.plantlore.common.record.Right;
 import net.sf.plantlore.common.record.User;
@@ -23,18 +24,22 @@
  */
 public interface DBLayer extends Remote, Serializable {
 	
+    public static final int CREATE_USERS = 1;
+    public static final int CREATE_TABLES = 2;
+    
     /**
      *  Initialize database connection. Authenticate user and Load rights of this user
      *
      *  @param dbID identifier of the database we want to connect to
      *  @param user username for the access to plantlore on the server
      *  @param password password for the access to plantlore on the server
-     *  @return array with two objects - User object with logged in user (index 0) and user's rights 
+ t     *  @return array with two objects - User object with logged in user (index 0) and user's rights 
      *          (Right object, index 1)
      *  @throws DBLayerException when the database connection cannot be initialized
      */
     public User initialize(String dbID, String user, String password) throws DBLayerException, RemoteException;
 
+    public void initializeNewDB(String dbID, String user, String password) throws DBLayerException, RemoteException;
     /**
      * The database layer performs several kinds of operations each of which may
      * fail at any time. In order to notify the User and present him with a reasonable
@@ -51,10 +56,10 @@
      *  Insert data into the database.
      *
      *  @param data data to insert (one of the data holder objects)
-     *  @return identifier (primary key) of the inserted row
+     *  @return inserted record including the primary key ID
      *  @throws DBLayerException when saving data into the database fails
      */    
-    public int executeInsert(Object data) throws DBLayerException, RemoteException;
+    public Record executeInsert(Object data) throws DBLayerException, RemoteException;
     
     /**
      *  Delete data from the database.
@@ -68,18 +73,19 @@
      *  Update data in the database.
      *
      *  @param data to update (must be one of the holder objects)
+     *  @return updated record
      *  @throws DBLayerException when updating data fails
      */    
-    public void executeUpdate(Object data) throws DBLayerException, RemoteException;
+    public Record executeUpdate(Object data) throws DBLayerException, RemoteException;
 
     /**
      *  Insert data into the database without modifying history tables
      *
      *  @param data data to insert (one of the data holder objects)
-     *  @return identifier (primary key) of the inserted row
+     *  @return inserted record including the primary key ID
      *  @throws DBLayerException when saving data into the database fails
      */    
-    public int executeInsertHistory(Object data) throws DBLayerException, RemoteException;
+    public Record executeInsertHistory(Object data) throws DBLayerException, RemoteException;
     
     /**
      *  Delete data from the database without modifying history tables
@@ -93,9 +99,10 @@
      *  Update data in the database without modifying history tables.
      *
      *  @param data to update (must be one of the holder objects)
+     *  @return updated record
      *  @throws DBLayerException when updating data fails
      */    
-    public void executeUpdateHistory(Object data) throws DBLayerException, RemoteException;
+    public Record executeUpdateHistory(Object data) throws DBLayerException, RemoteException;
 
     /**
      *  Execute DB update using a long running transaction. For this method to work, it is neccessary
@@ -104,11 +111,12 @@
      *  This method checks whether the user has appropriate priviliges and DOES NOT save history
      *
      *  @param data holder object with the record we want to update
+     *  @return updated record
      *  @throws DBLayerException in case we are not connected to the database or an error occurred
      *                           while executing the update
      *  @throws RemoteException in case network connection failed
      */
-    public void executeUpdateInTransactionHistory(Object data) throws DBLayerException, RemoteException;
+    public Record executeUpdateInTransactionHistory(Object data) throws DBLayerException, RemoteException;
     
     /**
      *  Get more rows from the current result set.
@@ -244,12 +252,13 @@
      *  the holder with the author (CCREATEDWHO) and time of creation (CREATEDWHEN).
      *
      *  @param data holder object with the record we want to insert
+     *  @return inserted record including the primary key ID
      *  @throws DBLayerException in case we are not connected to the database or an error occurred
      *                           while executing the insert
      *  @throws RemoteException in case server connection failed
      */        
-    public int executeInsertInTransaction(Object data) throws DBLayerException, RemoteException;
-            
+    public Record executeInsertInTransaction(Object data) throws DBLayerException, RemoteException;
+                
     /**
      *  Execute DB insert using a long running transaction. For this method to work, it is neccessary
      *  to begin long running transaction using beginTransaction() method of this class.
@@ -258,11 +267,12 @@
      *  updates the holder with the author (CCREATEDWHO) and time of creation (CREATEDWHEN).
      *
      *  @param data holder object with the record we want to insert
+     *  @return inserted record including the primary key ID
      *  @throws DBLayerException in case we are not connected to the database or an error occurred
      *                           while executing the insert
      *  @throws RemoteException in case server connection failed
      */    
-    public int executeInsertInTransactionHistory(Object data) throws DBLayerException, RemoteException;
+    public Record executeInsertInTransactionHistory(Object data) throws DBLayerException, RemoteException;
     
     /**
      *  Execute DB update using a long running transaction. For this method to work, it is neccessary
@@ -271,11 +281,12 @@
      *  This method checks whether the user has appropriate priviliges and saves history
      *
      *  @param data holder object with the record we want to update
+     *  @return updated record
      *  @throws DBLayerException in case we are not connected to the database or an error occurred
      *                           while executing the update
      *  @throws RemoteException in case network connection failed
      */
-    public void executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException;
+    public Record executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException;
     
     /**
      *  Execute DB delete using a long running transaction. For this method to work, it is neccessary
@@ -353,6 +364,16 @@
     public int getConnectionCount() throws RemoteException;
     
     /**
+     *  TODO: JavaDoc pending     
+     */
+    public void createDatabase(String dbname) throws DBLayerException, RemoteException;
+
+    /**
+     *  TODO: JavaDoc pending     
+     */    
+    public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException;
+    
+    /**
      * This method is intended for final cleanup. <b>Do not call this method
      * yourself! The proper way for you to get rid of a DBLayer is to call
      * DBLayerFactory.destroy() method!</b> <br/> Terminates all processes running in

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 15:41:51 UTC (rev 688)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 17:33:32 UTC (rev 689)
@@ -1,14 +1,12 @@
-/*
- * HibernateDBLayer.java
- *
- * Created on April 18, 2006, 22:31
- *
- */
 
 package net.sf.plantlore.server;
 
+import java.io.BufferedReader;
 import java.io.File;
+import java.io.FileReader;
 import java.io.IOException;
+import java.io.InputStreamReader;
+import java.net.URL;
 import java.rmi.NoSuchObjectException;
 import java.rmi.RemoteException;
 import java.rmi.server.UnicastRemoteObject;
@@ -16,6 +14,7 @@
 import java.sql.Connection;
 import java.sql.PreparedStatement;
 import java.sql.SQLException;
+import java.sql.Statement;
 import java.util.Date;
 import java.util.HashSet;
 import java.util.Hashtable;
@@ -57,6 +56,7 @@
 import java.util.ArrayList;
 
 import org.hibernate.Transaction;
+import org.hibernate.criterion.Projections;
 import org.hibernate.criterion.Restrictions;
 import org.hibernate.exception.JDBCConnectionException;
 
@@ -64,11 +64,9 @@
 /**
  *  Implementation of DBLayer using Hibernate OR mapping to access the database.
  *  
- *  TODO: Nezapominat generovat stub! (rmic net.sf.plantlore.server.HibernateDBLayer)
- *
  *  @author Tomas Kovarik (database parts), 
  *  @author Erik Kratochv?l (RMI parts, some code purification)
- *  @version far from ready!
+ *  @version almost complete!
  */
 public class HibernateDBLayer implements DBLayer, Unreferenced {
 	
@@ -98,7 +96,7 @@
     private Right rights;    
     /** Unique identifier of the database we are connected to */
     private String databaseID;
-     /** Plantlore prefix of user name */
+     /** Default prefix of database username */
     private String userPrefix = "plantlore_";
     
     private Session txSession;
@@ -126,8 +124,7 @@
         logger = Logger.getLogger(this.getClass().getPackage().getName());
         logger.debug("Constructing a new HibernateDBLayer.");
         
-        this.settings = settings;
-           
+        this.settings = settings;         
         
         // Initialize pool of result sets, initial capacity = INITIAL POOL SIZE
         results = new Hashtable<Integer, ScrollableResults>(INITIAL_POOL_SIZE); 
@@ -223,11 +220,20 @@
             // Load unique database identifier
             sr = sess.createCriteria(UnitIdDatabase.class).scroll();            
             if( ! sr.next() ) {
-            	logger.debug("DBLayer Initialization - things are not going well. sr.get() returned null!");
-            	throw new DBLayerException(L10n.getString("Error.ConnectionFailed"), DBLayerException.ERROR_CONNECT);
+                // No record in the table - we have to insert it (this is the first time the database is accessed)
+                UnitIdDatabase unitid = new UnitIdDatabase();
+                unitid.setUnitIdDb(UniqueIDGenerator.generate());
+                sess.save(unitid);
+                if (unitid.getUnitIdDb() == null) {
+                    logger.error("Failed to generate unique id for the database");
+                    throw new DBLayerException(L10n.getString("Error.ConnectionFailed"));
+                } else {
+                    this.databaseID = unitid.getUnitIdDb();
+                }
+            } else {
+                Object[] unitiddatabase = sr.get();
+                this.databaseID = ((UnitIdDatabase)unitiddatabase[0]).getUnitIdDb();            
             }
-            Object[] unitiddatabase = sr.get();
-            this.databaseID = ((UnitIdDatabase)unitiddatabase[0]).getUnitIdDb();            
             logger.debug("DBLayer Initialization - finished!");
         } 
         catch (JDBCException e) {
@@ -254,6 +260,33 @@
         return plantloreUser;
     }
     
+    // TODO: JavaDoc, cleanup
+    public void initializeNewDB(String dbID, String user, String password) throws DBLayerException, RemoteException {
+        Configuration cfg;
+        // Load Hibernate configuration
+        try {
+            cfg = new Configuration().configure(); //load the configuration from application's resource called hibernate.cfg.xml
+        } catch (HibernateException e) {
+            logger.fatal("Cannot load Hibernate configuration. Details: "+e.getMessage());
+            throw new DBLayerException(L10n.getString("Error.InvalidConfiguration"), DBLayerException.ERROR_LOAD_CONFIG, e);
+        }
+        // Create connections string from the provided data
+        if( settings.getConnectionStringSuffix() == null || "".equals(settings.getConnectionStringSuffix()) )
+        	cfg.setProperty("hibernate.connection.url", settings.getConnectionStringPrefix() + dbID);
+        else
+        	cfg.setProperty("hibernate.connection.url", settings.getConnectionStringPrefix() + dbID 
+        			+ "?" + settings.getConnectionStringSuffix());
+        // Set username and password to access database
+        cfg.setProperty("hibernate.connection.username", user);            
+        cfg.setProperty("hibernate.connection.password", password);
+        try {
+        	logger.debug("DBLayer Initialization - building session factory.");
+        	sessionFactory = cfg.buildSessionFactory();
+        } catch (HibernateException e) {
+            logger.fatal("DBLayer initialization: Could not build session factory");
+            throw new DBLayerException(L10n.getString("Error.ConnectionFailed"), DBLayerException.ERROR_CONNECT, e);
+        }   
+    }
     
     protected void touchRecord(Object record) {
     	java.util.Date now = new Date();
@@ -265,6 +298,22 @@
         	((Metadata)record).setDateModified(now);
         }
     }
+        
+    protected int getUniqueRecordId() throws DBLayerException {
+        Session sess = sessionFactory.openSession();
+        ScrollableResults sr = sess.createCriteria(Occurrence.class)
+            .setProjection(Projections.max(Occurrence.UNITVALUE))
+            .scroll();
+        if (!sr.next()) {
+            // No records in the database, set the first unitvalue to 1
+            return 1;
+        }
+        Object[] result = sr.get();
+        sess.close();
+        int maxUnitValue = (Integer)result[0];
+        maxUnitValue++;
+        return maxUnitValue;
+    }
     
     protected void completeRecord(Object record) throws DBLayerException {
     	java.util.Date now = new Date();
@@ -272,10 +321,11 @@
             Occurrence occ = (Occurrence)record;
             occ.setCreatedWhen(now);
             occ.setCreatedWho(this.plantloreUser);
+//            occ.getHabitat().setCreatedWho(this.plantloreUser);
             // Set UniqueID for the record and database
             occ.setUnitIdDb(this.databaseID);
-            //TODO zjiskat unikatni identifikator zaznamu !!!
-            occ.setUnitValue(1);
+            // Unique identifier of the record
+            occ.setUnitValue(getUniqueRecordId());
         } else if(record instanceof Habitat) {
             ((Habitat)record).setCreatedWho(this.plantloreUser);
         } else if(record instanceof Publication) {
@@ -283,9 +333,19 @@
         } else if(record instanceof Author) {
             ((Author)record).setCreatedWho(this.plantloreUser);
         } else if(record instanceof Metadata) {
-        	((Metadata)record).setDateCreate(now);
-        }
-        
+            ((Metadata)record).setDateCreate(now);                
+        } else if (record instanceof AuthorOccurrence) {
+            AuthorOccurrence ao = (AuthorOccurrence)record;
+//            ao.getOccurrence().setCreatedWhen(now);
+//            ao.getOccurrence().setCreatedWho(this.plantloreUser);
+//            ao.getOccurrence().setUpdatedWhen(now);
+//            ao.getOccurrence().setUpdatedWho(this.plantloreUser);
+//            ao.getOccurrence().getHabitat().setCreatedWho(this.plantloreUser);
+            // Set UniqueID for the record and database
+//            ao.getOccurrence().setUnitIdDb("aaa");
+            //TODO zjiskat unikatni identifikator zaznamu !!!
+//            ao.getOccurrence().setUnitValue(1);       
+         }        
         touchRecord(record);
     }
     
@@ -295,21 +355,20 @@
             logger.warn("SessionFactory not available. Not connected to the database. Must call initialize() prior to any other method!");
             throw new DBLayerException("Exception.NotConnected", DBLayerException.ERROR_CONNECT, null);
         }
-    }
+    }       
     
-    
-    
-    protected int lowLevelOperation(int operation, Object data, boolean saveHistory, boolean useOwnTransaction) 
+    protected Record lowLevelOperation(int operation, Object data, boolean saveHistory, boolean useOwnTransaction) 
     throws DBLayerException, RemoteException {
     	 // Check whether the connection to the databse has been established.
         checkConnection();
         
         // INSERT: Fill in missing parts that DBLayer must complete.
         // UPDATE & DELETE: Update timestamps of the record.
-        if(operation == INSERT)
+        if(operation == INSERT) {
         	completeRecord(data);
-        else
+        } else {
         	touchRecord(data);
+        }
         
         // Check whether we have sufficient rights.
         checkRights(data, operation);
@@ -320,6 +379,7 @@
         // If we should not use our own transaction, we must use the stored one.
         Session session = useOwnTransaction ? sessionFactory.openSession() : this.txSession;
         int recordId = -1;
+        Record record = null;
         try {            
             // Begin transaction, if it is required. If not, the `tx` stays null.
             if(useOwnTransaction) tx = session.beginTransaction();
@@ -327,12 +387,15 @@
             // Make changes in the database.
             switch(operation) {
                 case INSERT:
-                    recordId = (Integer)session.save(data);
+                    recordId = (Integer)session.save(data);                    
                     if(saveHistory) saveHistory(session, data, INSERT, recordId);
+                    record = (Record)data;
+                    record.setId(recordId);
                     break;
                 case UPDATE:
                     session.update(data);
                     if(saveHistory) saveHistory(session, data, UPDATE, null);
+                    record = (Record)data;                    
                     break;
                 case DELETE:
                     session.delete(data);
@@ -376,7 +439,7 @@
             // We must close only our own sessions!
             if(useOwnTransaction) session.close();
         }
-        return recordId;
+        return record;
     }
     
     
@@ -384,11 +447,10 @@
      *  Insert data into the database.
      *
      *  @param data data to insert (one of the data holder objects)
-     *  @return identifier (primary key) of the inserted row
+     *  @return inserted record including ID which was used as a primary key
      *  @throws DBLayerException when saving data into the database fails
      */
-    public int executeInsert(Object data) 
-    throws DBLayerException, RemoteException {
+    public Record executeInsert(Object data) throws DBLayerException, RemoteException {
        return lowLevelOperation(INSERT, data, true, true);
     }
 
@@ -396,11 +458,10 @@
      *  Insert data into the database without modifying history tables
      *
      *  @param data data to insert (one of the data holder objects)
-     *  @return identifier (primary key) of the inserted row
+     *  @return inserted record including ID which was used as a primary key
      *  @throws DBLayerException when saving data into the database fails
      */
-    public int executeInsertHistory(Object data) 
-    throws DBLayerException, RemoteException {
+    public Record executeInsertHistory(Object data) throws DBLayerException, RemoteException {
       return lowLevelOperation(INSERT, data, false, true);  
     }
     
@@ -410,8 +471,7 @@
      *  @param data data we want to delete (must be one of the holder objects)
      *  @throws DBLayerException when deleting data fails
      */
-    public void executeDelete(Object data) 
-    throws DBLayerException, RemoteException {
+    public void executeDelete(Object data) throws DBLayerException, RemoteException {
         lowLevelOperation(DELETE, data, true, true);
     }
 
@@ -421,8 +481,7 @@
      *  @param data data we want to delete (must be one of the holder objects)
      *  @throws DBLayerException when deleting data fails
      */
-    public void executeDeleteHistory(Object data) 
-    throws DBLayerException, RemoteException {
+    public void executeDeleteHistory(Object data) throws DBLayerException, RemoteException {
     	lowLevelOperation(DELETE, data, false, true);
     }
     
@@ -430,22 +489,22 @@
      *  Update data in the database.
      *
      *  @param data to update (must be one of the holder objects)
+     *  @return updated record
      *  @throws DBLayerException when updating data fails
      */
-    public void executeUpdate(Object data) 
-    throws DBLayerException, RemoteException {
-    	lowLevelOperation(UPDATE, data, true, true);
+    public Record executeUpdate(Object data) throws DBLayerException, RemoteException {
+    	return lowLevelOperation(UPDATE, data, true, true);
     }
 
     /**
      *  Update data in the database without modifying history tables.
      *
      *  @param data to update (must be one of the holder objects)
+     *  @return updated record
      *  @throws DBLayerException when updating data fails
      */
-    public void executeUpdateHistory(Object data) 
-    throws DBLayerException, RemoteException {
-    	lowLevelOperation(UPDATE, data, false, true);
+    public Record executeUpdateHistory(Object data) throws DBLayerException, RemoteException {
+    	return lowLevelOperation(UPDATE, data, false, true);
     }
     
     /**
@@ -459,9 +518,8 @@
      *                           while executing the update
      *  @throws RemoteException in case network connection failed
      */
-    public void executeUpdateInTransactionHistory(Object data) 
-    throws DBLayerException, RemoteException {
-       lowLevelOperation(UPDATE, data, false, false);
+    public Record executeUpdateInTransactionHistory(Object data) throws DBLayerException, RemoteException {
+       return lowLevelOperation(UPDATE, data, false, false);
     }
     
     /**
@@ -478,15 +536,11 @@
         // Check validity of arguments
         if (from>to) {
             logger.error("Cannot read rows from "+from+" to "+to+" because from > to");            
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.ERROR_OTHER, "Cannot read rows from "+from+" to "+to+" because from > to");
-            throw ex;
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"));            
         } 
         if (from < 0) {
             logger.error("Cannot read rows starting at the given index: "+from);
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.ERROR_OTHER, "Cannot read rows starting at the given index: "+from);
-            throw ex;
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"));
         }
         // Get results for the given resultId
         ScrollableResults res = results.get(resultId);
@@ -500,14 +554,10 @@
             }
         } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while retrieving the data from the database. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"), DBLayerException.ERROR_LOAD_DATA, e);
         } catch (HibernateException e) {
             logger.error("Cannot move to the given row of results: "+from+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.ERROR_LOAD_DATA, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"), DBLayerException.ERROR_LOAD_DATA, e);
         }
         // Allocate space for data
         Object[] data = new Object[to-from+1];
@@ -518,16 +568,12 @@
                     data[i] = res.get();
                 } else {
                     logger.error("Result doesn't have enough rows");
-                    DBLayerException ex = new DBLayerException("Exception.RetrieveData");                
-                    ex.setError(ex.ERROR_LOAD_DATA, "Result doesn't have enough rows");
-                    throw ex;
+                    throw new DBLayerException(L10n.getString("Exception.RetrieveData"));
                 }                
             }
         } catch (HibernateException e) {
             logger.error("Cannot read data from the results");
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.ERROR_LOAD_DATA, "Cannot read data from the results");
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"));
         }
         return data;
     }
@@ -550,9 +596,7 @@
             }
         } catch (HibernateException e) {
             logger.error("Call to next() failed");
-            DBLayerException ex = new DBLayerException("Exception.RetrieveData");
-            ex.setError(ex.ERROR_LOAD_DATA, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"), DBLayerException.ERROR_LOAD_DATA, e);
         }        
         return res.get();        
     }
@@ -572,8 +616,7 @@
             logger.error("HibernateDBLayer: getNumRows(): trying to ask about nonexisting resultId.");                    
             return 0; //this may be better than throwing nullpointerexception on res.getRowNumber() a few lines lower
                       //the application may well recover from this state later
-        }
-        
+        }        
         // Get the current row in the results
         int currentRow = res.getRowNumber();
         // Go to the first row of the results        
@@ -595,18 +638,8 @@
         }
         return numRows;
     }
-    
+        
     /**
-     *  Close the DBLayer. Close the session factory
-     *
-     *  @throws DBLayerException when closing session fails
-     */
-    @Deprecated
-    public void close() throws DBLayerException, RemoteException {    
-    	throw new Error("THIS CODE MUST NOT BE INVOKED YOU IDIOT! SEE shutdown() INSTEAD!");
-    }
-    
-    /**
      *  Start building a select query.
      *
      *  @param classname entity we want to select from the database (given holder object class)
@@ -615,12 +648,7 @@
      */
     public SelectQuery createQuery(Class classname) throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         SelectQuery query = null;
         Session session = null;
         try {
@@ -628,9 +656,7 @@
             query = new SelectQueryImplementation(session.createCriteria(classname), queries);
         } catch (HibernateException e) {
             logger.fatal("Cannot create new query (Failed to create session)");
-            DBLayerException ex = new DBLayerException("Exception.DatabaseQuery");
-            ex.setError(ex.ERROR_SELECT, e.getMessage());
-            throw ex;                        
+            throw new DBLayerException(L10n.getString("Exception.DatabaseQuery"), DBLayerException.ERROR_SELECT, e);
         }
         SelectQuery stub = query;
         
@@ -655,12 +681,7 @@
      */
     public SelectQuery createSubQuery(Class classname, String alias) throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         SelectQuery query = new SubQueryImplementation(classname, alias), 
         	stub = query;
         
@@ -681,9 +702,7 @@
     	SelectQuery selectQuery = queries.get(query);
     	if(selectQuery == null) {
             logger.error("You can only pass queries created by this DBLayer!");
-            DBLayerException ex = new DBLayerException("Exception.DatabaseQuery");
-            ex.setError(ex.ERROR_SELECT, "You can only pass queries created by this DBLayer!");
-            throw ex;
+            throw new DBLayerException(L10n.getString("Exception.DatabaseQuery"));
         }
     	
     	assert(selectQuery instanceof SelectQueryImplementation);
@@ -702,18 +721,17 @@
             // Commit transaction
             tx.commit();  
         } catch (JDBCException e) {
+            if (tx != null) {
+                tx.rollback();
+            }            
             logger.fatal("JDBC Exception caught while executing Select query. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.DatabaseQuery");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());
-            throw ex;                        
+            throw new DBLayerException(L10n.getString("Exception.DatabaseQuery"), DBLayerException.ERROR_SELECT, e);            
         } catch (HibernateException e) {
             if (tx != null) {
                 tx.rollback();
             }
             logger.fatal("Selecting records from the database failed. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.DatabaseQuery");
-            ex.setError(ex.ERROR_SELECT, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.DatabaseQuery"), DBLayerException.ERROR_SELECT, e);            
         }
         // Update current maximum result id and save the results
         maxResultId++; 
@@ -737,12 +755,7 @@
         int deletedEntities = 0;
         
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         Transaction tx = null;
         Session session = null;
         try {
@@ -770,16 +783,13 @@
                 tx.rollback();
             }
             logger.fatal("JDBC Exception caught while deleting the record from the database. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.DeleteRecord");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());            
+            throw new DBLayerException(L10n.getString("Exception.DeleteRecord"), DBLayerException.ERROR_DELETE, e);
         } catch (HibernateException e) {
             if (tx != null) {
                 tx.rollback();
             }            
             logger.fatal("Cannot execute conditional delete on table "+tableClass.getName());
-            DBLayerException ex = new DBLayerException("Exception.DeleteRecord");
-            ex.setError(ex.ERROR_DELETE, tableClass.getName());
-            throw ex;
+            throw new DBLayerException(L10n.getString("Exception.DeleteRecord"), DBLayerException.ERROR_DELETE, e);            
         } finally {
             if (session != null) session.close();
         }
@@ -811,7 +821,11 @@
         }
         
         Integer resultsetIdentifier = selectQuery.getResultsetIdentifier();
-        results.remove( resultsetIdentifier  );
+        // resultsetIdentifier is null in case executeQuery() failed and no result was returned (but
+        // we still have to close the query). Thx goes to Fraktalek
+        if (resultsetIdentifier != null) {
+            results.remove(resultsetIdentifier);
+        }
     }
     
     /**
@@ -841,12 +855,7 @@
      */
     synchronized public boolean beginTransaction() throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether there is some other running transaction
         if (this.longTx != null) {
             return false;               // Return with an error indicating other transaction is running
@@ -858,13 +867,10 @@
             this.longTx = this.txSession.beginTransaction();
        } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while starting database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.StartTransaction");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
+            throw new DBLayerException(L10n.getString("Exception.StartTransaction"), DBLayerException.ERROR_TRANSACTION, e);
         } catch (HibernateException e) {
             logger.fatal("Cannot start database transaction");
-            DBLayerException ex = new DBLayerException("Exception.StartTransaction");
-            ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.StartTransaction"), DBLayerException.ERROR_TRANSACTION, e);
         }
         return true;                    // Transaction succesfully started
     }
@@ -880,12 +886,7 @@
      */    
     public boolean commitTransaction() throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether we have an opened session and running transaction
         if ((this.longTx == null) || (this.txSession == null)) {
             return false;               // Return with an error indicating we don't have proper conditions
@@ -898,14 +899,13 @@
             // Close the session
             this.txSession.close();            
        } catch (JDBCException e) {
+            this.rollbackTransaction();
             logger.fatal("JDBC Exception caught while commiting database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
+            throw new DBLayerException(L10n.getString("Exception.CommitTransaction"), DBLayerException.ERROR_TRANSACTION, e);
         } catch (HibernateException e) {
+            this.rollbackTransaction();            
             logger.fatal("Cannot commit database transaction");
-            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
-            ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.CommitTransaction"), DBLayerException.ERROR_TRANSACTION, e);        
         }
         return true;
     }
@@ -922,12 +922,7 @@
      */
     public boolean rollbackTransaction() throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.warn("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether we have an opened session and running transaction
         if ((this.longTx == null) || (this.txSession == null)) {
             return false;               // Return with an error indicating we don't have proper conditions
@@ -941,13 +936,10 @@
             this.txSession.close();
        } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while rollbacking database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.RollbackTransaction");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
+            throw new DBLayerException(L10n.getString("Exception.RollbackTransaction"), DBLayerException.ERROR_TRANSACTION, e);
         } catch (HibernateException e) {
             logger.fatal("Cannot rollback database transaction");
-            DBLayerException ex = new DBLayerException("Exception.RollbackTransaction");
-            ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.RollbackTransaction"), DBLayerException.ERROR_TRANSACTION, e);            
         }            
         return true;        
     }
@@ -964,11 +956,47 @@
      *                           while executing the insert
      *  @throws RemoteException in case server connection failed
      */    
-    public int executeInsertInTransaction(Object data) 
-    throws DBLayerException, RemoteException {
+    public Record executeInsertInTransaction(Object data) throws DBLayerException, RemoteException {
     	return lowLevelOperation(INSERT, data, true, false);
     }
 
+    public Object executeInsertInTransactionTest(Object data) 
+    throws DBLayerException, RemoteException {
+        
+    	 // Check whether the connection to the databse has been established.
+        checkConnection();
+        // Complete record
+      	completeRecord(data);
+        // Check whether we have sufficient rights.
+        checkRights(data, 1);
+
+        // If we should not use our own transaction, we must use the stored one.
+        Session session = this.txSession;
+        int recordId = -1;
+        try {                       
+            recordId = (Integer)session.save(data);
+            ((Record)data).setId(recordId);
+            saveHistory(session, data, INSERT, recordId);           
+        } 
+        catch (StaleObjectStateException e) {
+            this.rollbackTransaction();
+            logger.warn("StaleObjectStateException caught (Concurrent transactions running and trying to commit). Details: "+e.getMessage());
+            throw new DBLayerException("Error.ConcurrentUpdate", DBLayerException.ERROR_TRANSACTION, e);
+        } 
+        catch (JDBCException e) {
+            this.rollbackTransaction();
+            logger.fatal("JDBC Exception caught while saving the record into the database. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
+            throw new DBLayerException(L10n.getString("Error.DatabaseOperationFailed"), e);
+        } 
+        catch (HibernateException e) {
+            this.rollbackTransaction();
+            logger.fatal("Saving record into the database failed. Details: "+e.getMessage());
+            int exceptionType = -1;
+            throw new DBLayerException(L10n.getString("Error.DatabaseOperationFailed"), exceptionType, e);
+        }
+        return data;
+    }
+    
     /**
      *  Execute DB insert using a long running transaction. For this method to work, it is neccessary
      *  to begin long running transaction using beginTransaction() method of this class.
@@ -981,8 +1009,7 @@
      *                           while executing the insert
      *  @throws RemoteException in case server connection failed
      */    
-    public int executeInsertInTransactionHistory(Object data) 
-    throws DBLayerException, RemoteException {
+    public Record executeInsertInTransactionHistory(Object data) throws DBLayerException, RemoteException {
     	return lowLevelOperation(INSERT, data, false, false);
     }    
     
@@ -997,8 +1024,8 @@
      *                           while executing the update
      *  @throws RemoteException in case network connection failed
      */
-    public void executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException {
-    	lowLevelOperation(UPDATE, data, true, false);
+    public Record executeUpdateInTransaction(Object data) throws DBLayerException, RemoteException {
+    	return lowLevelOperation(UPDATE, data, true, false);
     }
     
     /**
@@ -1045,11 +1072,9 @@
                     .scroll();
                 // If we haven't found the author in the database, raise exception
                 if (!sc.next()) {
+                    sess.close();                    
                     logger.error("To-be-updated/deleted author not found in the database. Author ID:"+((Author)data).getId());
-                    ex = new DBLayerException("To-be-updated/deleted author not found in the database. Author ID:"+((Author)data).getId());
-                    ex.setError(ex.ERROR_OTHER, null);
-                    sess.close();
-                    throw ex;                                        
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));
                 }
                 Object[] res = sc.get();
                 Author aut = (Author)res[0];
@@ -1082,18 +1107,14 @@
                 }
                 if (equal == false) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOR);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOR);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_AUTHOR);                    
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }
             }
             if (type == INSERT) {
                 // Insert only if CADD = 1
                 if (this.rights.getAdd() == 0) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOR);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOR);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_AUTHOR);
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }                
             }            
         }
@@ -1102,9 +1123,7 @@
             // Only admin can insert/update/delete from this table
             if (this.rights.getAdministrator() != 1) {
                 logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_USER);
-                ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_USER);
-                ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_USER);
-                throw ex;
+                throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
             }
             // User can edit his own data except for login name
             
@@ -1123,17 +1142,13 @@
             // Only admin can insert/update/delete from this table
             if (this.rights.getAdministrator() != 1) {
                 logger.warn("User doesn't have sufficient rights for this operation. Entity: "+entity);
-                ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+entity);
-                ex.setError(ex.ERROR_RIGHTS, entity);
-                throw ex;
-            }            
+                throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);            
+            }
         }
         // Check rights for table THISTORYCOLUMN
         if (data instanceof HistoryColumn) {
             logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HISTORYCOLUMN);
-            ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HISTORYCOLUMN);
-            ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_HISTORYCOLUMN);
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);        
         }
         // Check rights for table THISTORY and THISTORYCHANGE
         if ((data instanceof HistoryChange) || (data instanceof HistoryRecord)) {
@@ -1142,12 +1157,10 @@
                 if (data instanceof HistoryChange) { entity = PlantloreConstants.ENTITY_HISTORYCHANGE; }
                 if (data instanceof HistoryRecord) { entity = PlantloreConstants.ENTITY_HISTORYRECORD; }                
                 logger.warn("User doesn't have sufficient rights for this operation. Entity: "+entity);
-                ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+entity);
-                ex.setError(ex.ERROR_RIGHTS, entity);
-                throw ex;                            
+                throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);          
             } else if (type == DELETE) {
                 // Tu to bude zlozitejsie...
-                // TODO
+                // TODO ???
             }           
         }        
         // Check rights for table TPUBLICATIONS
@@ -1160,11 +1173,9 @@
                     .scroll();
                 // If we haven't found the publication in the database, raise exception
                 if (!sc.next()) {
+                    sess.close();                    
                     logger.error("To-be-updated/deleted publication not found in the database. Publication ID:"+((Publication)data).getId());
-                    ex = new DBLayerException("To-be-updated/deleted publication not found in the database. Publication ID:"+((Publication)data).getId());                    
-                    ex.setError(ex.ERROR_OTHER, null);
-                    sess.close();
-                    throw ex;                                        
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));        
                 }
                 Object[] res = sc.get();
                 Publication pub = (Publication)res[0];
@@ -1194,18 +1205,14 @@
                 }
                 if (equal == false) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_PUBLICATION);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_PUBLICATION);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_PUBLICATION);
-                    throw ex;
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);          
                 }
             }
             if (type == INSERT) {
                 // Only if CADD = 1
                 if (this.rights.getAdd() == 0) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_PUBLICATION);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_PUBLICATION);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_PUBLICATION);
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }                
             }                        
         }
@@ -1219,11 +1226,9 @@
                     .scroll();
                 // If we haven't found the occurrence in the database, raise exception
                 if (!sc.next()) {
+                    sess.close();                    
                     logger.error("To-be-updated/deleted occurrence not found in the database. Occurrence ID:"+((Publication)data).getId());
-                    ex = new DBLayerException("To-be-updated/deleted occurrence not found in the database. Occurrence ID:"+((Publication)data).getId());
-                    ex.setError(ex.ERROR_OTHER, null);
-                    sess.close();
-                    throw ex;                                        
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));        
                 }
                 Object[] res = sc.get();
                 Occurrence occ = (Occurrence)res[0];
@@ -1254,18 +1259,14 @@
                 }
                 if (equal == false) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_OCCURRENCE);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_OCCURRENCE);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_OCCURRENCE);
-                    throw ex;
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }
             }
             if (type == INSERT) {
                 // Insert only if CADD = 1
                 if (this.rights.getAdd() == 0) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_OCCURRENCE);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_OCCURRENCE);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_OCCURRENCE);
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }                
             }                            
         }
@@ -1279,11 +1280,9 @@
                     .scroll();
                 // If we haven't found the habitat in the database, raise exception
                 if (!sc.next()) {
+                    sess.close();                    
                     logger.error("To-be-updated/deleted habitat not found in the database. Occurrence ID:"+((Habitat)data).getId());
-                    ex = new DBLayerException("To-be-updated/deleted habitat not found in the database. Occurrence ID:"+((Habitat)data).getId());
-                    ex.setError(ex.ERROR_OTHER, null);
-                    sess.close();
-                    throw ex;                                        
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));        
                 }
                 Object[] res = sc.get();
                 Habitat hab = (Habitat)res[0];
@@ -1296,11 +1295,9 @@
                     .scroll();
                 // If no occurrence was found
                 if (!sc.next()) {
-                    logger.error("No occurrence references selected habitat. Habitat ID:"+hab.getId());
-                    ex = new DBLayerException("No occurrence references selected habitat. Habitat ID:"+hab.getId());
-                    ex.setError(ex.ERROR_DB, null);
                     sess.close();
-                    throw ex;                          
+                    logger.error("No occurrence references selected habitat. Habitat ID:"+hab.getId());                    
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));        
                 }    
                 res = sc.get();
                 Occurrence occ = (Occurrence)res[0];
@@ -1330,18 +1327,14 @@
                 }
                 if (equal == false) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HABITAT);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HABITAT);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_HABITAT);
-                    throw ex;
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }
             }            
             if (type == INSERT) {
                 // Insert only if CADD = 1
                 if (this.rights.getAdd() == 0) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HABITAT);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_HABITAT);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_HABITAT);
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS); 
                 }                
             }                                        
         }
@@ -1355,11 +1348,9 @@
                     .scroll();
                 // If we haven't found the occurrence in the database, raise exception
                 if (!sc.next()) {
+                    sess.close();                    
                     logger.error("To-be-updated/deleted authoroccurrence not found in the database. Occurrence ID:"+((AuthorOccurrence)data).getId());
-                    ex = new DBLayerException("To-be-updated/deleted authoroccurrence not found in the database. Occurrence ID:"+((AuthorOccurrence)data).getId());
-                    ex.setError(ex.ERROR_OTHER, null);
-                    sess.close();
-                    throw ex;                                        
+                    throw new DBLayerException(L10n.getString("Error.RecordNotFound"));        
                 }
                 Object[] res = sc.get();
                 AuthorOccurrence ao = (AuthorOccurrence)res[0];
@@ -1391,18 +1382,14 @@
                 }
                 if (equal == false) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    throw ex;
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
                 }
             }            
             if (type == INSERT) {
                 // Insert only if CADD = 1
                 if (this.rights.getAdd() == 0) {
                     logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    ex = new DBLayerException("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_AUTHOROCCURRENCE);
-                    throw ex;                    
+                    throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);   
                 }                
             }            
         }        
@@ -1668,7 +1655,6 @@
                     		continue;
                     	
                     	if( origValue == null || newValue == null || !origValue.equals(newValue) ) {
-                    		System.out.println(" >> DIFFERENT_COLUMN: " + columnName);
                     		// Read record from THISTORYCOLUMN first
                     		res = sess.createCriteria(HistoryColumn.class).
                     		add(Restrictions.eq(HistoryColumn.TABLENAME, PlantloreConstants.ENTITY_OCCURRENCE)).
@@ -1796,7 +1782,6 @@
                         Object origValue = (origRec.getValue((String)cols.get(i)) == null) ? new String("") : origRec.getValue((String)cols.get(i));                        
                         Object newValue = (newRec.getValue((String)cols.get(i)) == null) ? new String("") : newRec.getValue((String)cols.get(i));                                                                        
                         if (!origValue.equals(newValue)) {
-                        	System.out.println(" >> DIFFERENT_COLUMN: " + (String)cols.get(i));
                             // Read record from THISTORYCOLUMN first                           	
                             res = sess.createCriteria(HistoryColumn.class)
                                 .add(Restrictions.eq(HistoryColumn.TABLENAME, PlantloreConstants.ENTITY_HABITAT))
@@ -2065,18 +2050,11 @@
      */
     public void createUser(String name, String password, boolean isAdmin) throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.error("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether the user is administrator - only admin can modify users
         if (this.rights.getAdministrator() != 1) {
             logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_USER);
-            DBLayerException ex = new DBLayerException("Exception.InsufficientRights");
-            ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_USER);
-            throw ex;
+            throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
         }
         // TODO: This is PostgreSQL specific. Think of a way how to provide different statements for
         //       different databases
@@ -2094,14 +2072,10 @@
             pstmtGrant.execute();
         } catch (HibernateException e) {
             logger.warn("Unable to retrieve JDBC connection from the Hibernate session. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.CreateUser");
-            ex.setError(ex.ERROR_SAVE, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.CreateUser"), DBLayerException.ERROR_SAVE, e);            
         } catch (SQLException e) {
             logger.warn("Unable to create new database user using CREATE USER statement. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.CreateUser");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());
-            throw ex;                        
+            throw new DBLayerException(L10n.getString("Exception.CreateUser"), DBLayerException.ERROR_SAVE, e);            
         }
     }
     
@@ -2121,18 +2095,11 @@
      */    
     public void alterUser(String name, String password, boolean isAdmin, boolean changeRight ) throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.error("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether the user is administrator - only admin can modify users
         if (this.rights.getAdministrator() != 1) {
             logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_USER);
-            DBLayerException ex = new DBLayerException("Exception.InsufficientRights");
-            ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_USER);
-            throw ex;
+            throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
         }
         // TODO: This is PostgreSQL specific. Think of a way how to provide different statements for
         //       different databases
@@ -2172,14 +2139,10 @@
             }            
         } catch (HibernateException e) {
             logger.warn("Unable to retrieve JDBC connection from the Hibernate session. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.AlterUser");
-            ex.setError(ex.ERROR_SAVE, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.AlterUser"), DBLayerException.ERROR_SAVE, e);
         } catch (SQLException e) {
             logger.warn("Unable to alter the database user using ALTER USER statement. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.AlterUser");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());
-            throw ex;                        
+            throw new DBLayerException(L10n.getString("Exception.AlterUser"), DBLayerException.ERROR_SAVE, e);
         }        
     }
     
@@ -2196,18 +2159,11 @@
      */    
     public void dropUser(String name) throws DBLayerException, RemoteException {
         // Check whether we are connected to the database
-        if (sessionFactory == null) {
-            logger.error("SessionFactory not avilable. Not connected to the database.");
-            DBLayerException ex = new DBLayerException("Exception.NotConnected");
-            ex.setError(ex.ERROR_CONNECT, null);
-            throw ex;
-        }
+        checkConnection();
         // Check whether the user is administrator - only admin can modify users
         if (this.rights.getAdministrator() != 1) {
             logger.warn("User doesn't have sufficient rights for this operation. Entity: "+PlantloreConstants.ENTITY_USER);
-            DBLayerException ex = new DBLayerException("Exception.InsufficientRights");
-            ex.setError(ex.ERROR_RIGHTS, PlantloreConstants.ENTITY_USER);
-            throw ex;
+            throw new DBLayerException(L10n.getString("Error.InsufficientRights"), DBLayerException.ERROR_RIGHTS);
         }
         try {
             Connection conn = txSession.connection();        
@@ -2215,14 +2171,10 @@
             pstmt.execute();
         } catch (HibernateException e) {
             logger.warn("Unable to retrieve JDBC connection from the Hibernate session. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.DropUser");
-            ex.setError(ex.ERROR_SAVE, e.getMessage());
-            throw ex;            
+            throw new DBLayerException(L10n.getString("Exception.DropUser"), DBLayerException.ERROR_SAVE, e);            
         } catch (SQLException e) {
             logger.warn("Unable to drop database user using the DROP USER statement. Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.DropUser");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());
-            throw ex;                        
+            throw new DBLayerException(L10n.getString("Exception.DropUser"), DBLayerException.ERROR_SAVE, e);            
         }
     }
             
@@ -2235,7 +2187,90 @@
         return sessions.size();
     }
     
+    public void createDatabase(String dbname) throws DBLayerException, RemoteException {
+        // Check whether we are connected and obtain a session
+        checkConnection();     
+        // Open new session
+        Session session = sessionFactory.openSession();
+        // Obtain JDBC connection from session
+        Connection con = session.connection();
+        // Execute CREATE DATABASE statement
+        try {
+            con.setAutoCommit(true);
+            Statement stmt = con.createStatement();
+            logger.debug("----- SQL: CREATE DATABASE "+dbname+" WITH OWNER = plantlore_role_admin ENCODING = 'UTF8' TABLESPACE = pg_default");
+            stmt.execute("CREATE DATABASE "+dbname+" WITH OWNER = plantlore_role_admin ENCODING = 'UTF8' TABLESPACE = pg_default");            
+        } catch (SQLException e) {
+            // Deal with the exception
+            logger.error("SQLException caught while executing SQL script. Details: "+e.getMessage()+"; SQL State: "+e.getSQLState());
+            throw new DBLayerException(L10n.getString("Error.CreateDatabase"), DBLayerException.ERROR_CREATEDB, e);            
+        }
+    }
     
+    public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException {
+        String file;
+        switch (scriptid) {
+            case DBLayer.CREATE_USERS: file = "net/sf/plantlore/config/database/createusers_postgres.sql";
+                    break;
+            case DBLayer.CREATE_TABLES: file = "net/sf/plantlore/config/database/createtables_postgres.sql";
+                    break;
+            default: file = "";
+                    break;
+        }
+        // Check whether we are connected and obtain a session
+        checkConnection();     
+        // Read the script file from resources
+        StringBuffer sql = new StringBuffer();
+        try {
+            ClassLoader cl = HibernateDBLayer.class.getClassLoader();
+            URL sqlfile = cl.getResource(file);
+            BufferedReader in = new BufferedReader(new InputStreamReader(sqlfile.openStream()));
+            String str;
+            while ((str = in.readLine()) != null) {
+                sql.append(str);
+            }
+            in.close();
+        } catch (IOException e) {
+            // Deal with I/O Exception
+            logger.error("I/O Exception caught. Cannot read sql script from file. Details: "+e.getMessage());
+            throw new DBLayerException(L10n.getString("Error.CreateDatabase"), DBLayerException.ERROR_CREATEDB, e);
+        }
+        // Open new session
+        Session session = sessionFactory.openSession();
+        // Obtain JDBC connection from session
+        Connection con = session.connection();        
+        // In case we are creating users, add statement to create first user for accesing plantlore
+        if (scriptid == DBLayer.CREATE_USERS) {
+            sql.append("CREATE USER "+dbname+"_"+username+" PASSWORD '"+password+"';");
+            sql.append("GRANT Plantlore_Role_Admin TO "+dbname+"_"+username+";");
+        }
+        // In case we are creating tables, insert data into TUSER table so that the user can login
+        if (scriptid == DBLayer.CREATE_TABLES) {
+            sql.append("INSERT INTO tright (cid, cadministrator, cadd, ceditall) VALUES (1,1, 1, 1);");
+            sql.append("INSERT INTO tuser (clogin, cwholename, ccreatewhen, crightid) VALUES ('"+username+"', '', 'NOW', 1);");
+        }
+        // Split the file with semicolon as the separator
+        String[] statements = sql.toString().split(";");        
+        // Execute batch SQL
+        try {
+            con.setAutoCommit(false);        
+            Statement stmt = con.createStatement();
+            for (int i=0;i<statements.length;i++) {
+                logger.debug("----- SQL: "+statements[i]);
+                stmt.addBatch(statements[i]);
+            }
+            int [] updateCounts = stmt.executeBatch();
+            con.commit();
+            con.setAutoCommit(true);                
+        } catch (SQLException e) {
+            // Deal with the exception
+            logger.error("SQLException caught while executing SQL script. Details: "+e.getMessage()+"; SQL State: "+e.getSQLState());
+            throw new DBLayerException(L10n.getString("Error.CreateDatabase"), DBLayerException.ERROR_CREATEDB, e);
+        } finally {
+            session.close();
+        }
+    }
+    
     /**
      * This method is intended for final cleanup. <b>Do not call this method
      * yourself! The proper way for you to get rid of a DBLayer is to call



From kovo at mail.berlios.de  Tue Sep  5 19:36:01 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 5 Sep 2006 19:36:01 +0200
Subject: [Plantlore-dev] r690 - trunk/analysis/database
Message-ID: <200609051736.k85Ha1Co016842@sheep.berlios.de>

Author: kovo
Date: 2006-09-05 19:35:59 +0200 (Tue, 05 Sep 2006)
New Revision: 690

Modified:
   trunk/analysis/database/DBModel_postgres.sql
Log:
Minor glitches in the script fixed. Hopefully it is up to date now. In case you update DB schema, do not forget to update also files used for DB creation located in src/net/sf/plantlore/config/database/

Modified: trunk/analysis/database/DBModel_postgres.sql
===================================================================
--- trunk/analysis/database/DBModel_postgres.sql	2006-09-05 17:33:32 UTC (rev 689)
+++ trunk/analysis/database/DBModel_postgres.sql	2006-09-05 17:35:59 UTC (rev 690)
@@ -183,7 +183,6 @@
     CADMINISTRATOR  SMALLINT DEFAULT 0 NOT NULL,
     CEDITALL        SMALLINT DEFAULT 0 NOT NULL,
     CEDITGROUP      VARCHAR(4096),
-    CSEECOLUMNS     VARCHAR(4096),
     CADD            SMALLINT DEFAULT 0 NOT NULL,
     CVERSION          INTEGER DEFAULT 0 NOT NULL,
 PRIMARY KEY (CID));



From tkovarik at gmail.com  Tue Sep  5 19:53:51 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Tue, 5 Sep 2006 19:53:51 +0200
Subject: [Plantlore-dev] Dnesne upravy DBLayer
Message-ID: <ea88f1620609051053r3c829452wa7cc3b4944c8a5cb@mail.gmail.com>

Ahojte,

takze som upravil DBLayer aby sa uz nevyskytovali chyby pri ukladani
naviaznych tabuliek pri pouziti RMI. Je potreba upravit vas kod a to
nasledovne:

Metodam  executeInsertXXX a executeUpdateXXX (XXX nahrad za InTransaction,
History atd.) sa zmenila navratova hodnota z int na Record. Vdaka tomu vam
Plantlore teraz nepojde prelozit (asle aspon rychle uvidite co treba
upravit). Tieto metody teraz vracaju namiesti IDcka vlozeneho zaznamu (alebo
voidu v pripade editu) objekt, ktory bol vlozeny (resp. upraveny). Vyhodou
je to, ze sa jedna o objekt ktory Hibernate rozpozna ako "uz ulozeny v
databazi" takze ho mozete pridat do inych objektov a ukladat bez problemov
tie ine objekty.

Ako upravit kod:

STARA VERZIA

int habId = database.executeInsertInTransaction(h);   // Insert habitat and
get the id used as a primary key
h.setId(habId);                                                        //
Save the ID to the holder object
Occurrence occ = new Occurrence;
occ.setHabitat(h);                                                   //
Attach newly created habitat to occurrence

NOVA VERZIA

h = (Habitat)database.executeInsertInTransaction(h); // Do not forget the
cast from Record to your subclass
Occurrence occ = new Occurrence();
occ.setHabitat(h);                                                   // Same
as before...

Upravte cim skor prosim vas kod aby sa to dalo prelozit a otestovat.
AddEdit.java je uz upraveny, na nom som to skusal.

Pridal som do DBLayer aj ukladanie unikatnych ideciek, bude to ale treba
este otestovat. Taktiez pribudla moznost vytvarat databazu (len PostgreSQL),
zatial tam je ale este par drobnosti na dotiahnutie ktore verim ze sa podari
sfuknut este dnes - dam vam potom vediet aby ste si to mohli vyskusat.

Majte sa

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060905/ab0ffcfb/attachment.html>

From kovo at mail.berlios.de  Tue Sep  5 20:01:36 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 5 Sep 2006 20:01:36 +0200
Subject: [Plantlore-dev] r691 - in trunk/src/net/sf/plantlore/client:
	authors publications
Message-ID: <200609051801.k85I1aQP025683@sheep.berlios.de>

Author: kovo
Date: 2006-09-05 20:01:29 +0200 (Tue, 05 Sep 2006)
New Revision: 691

Modified:
   trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
Log:
executeInsert() and executeUpdate() methods updated in AuthorManager and PublicationManager to work with the new DBLayer.

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-05 17:35:59 UTC (rev 690)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-05 18:01:29 UTC (rev 691)
@@ -138,7 +138,7 @@
                 int rowId = -1;
                 clearDataHolders();                
                 // Execute query
-                rowId = database.executeInsert(author);
+                author = (Author)database.executeInsert(author);
                 logger.info("Author "+name+" saved successfuly.");                
                 // Set operation state to finished
                 done = true;

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-05 17:35:59 UTC (rev 690)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-05 18:01:29 UTC (rev 691)
@@ -156,8 +156,8 @@
                 // Clear variables with publication properties
                 clearDataHolders();
                 // Execute query
-                rowId = database.executeInsert(publication);
-                logger.info("Publication "+collectionName+" saved successfuly.");
+                publication = (Publication)database.executeInsert(publication);
+                logger.info("Publication "+publication.getCollectionName()+" saved successfuly.");
                 // Stop the Task
                 fireStopped(null);               
                 return rowId;
@@ -245,7 +245,7 @@
                 clearDataHolders();
                 // Execute query
                 database.executeUpdate(publication);
-                logger.info("Publication "+collectionName+" updated successfuly.");
+                logger.info("Publication "+publication.getCollectionName()+" updated successfuly.");
                 // Stop the Task
                 fireStopped(null);
                 return true;



From tkovarik at gmail.com  Tue Sep  5 20:16:44 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Tue, 5 Sep 2006 20:16:44 +0200
Subject: [Plantlore-dev] CreateDB iface
Message-ID: <ea88f1620609051116t12d964ei952b36f6dc0b5d3f@mail.gmail.com>

Cau Erik,

pridal som teraz v tych poslednych commitoch do DBLayer aj Create Database
pre Postgre. Povodna myslienka bola vyrobit interface podobny DBLayer pre
CreateDatabase a rozne jeho implementacie pre jednotlive databazove systemy.
Pre jednoduchost a rychlost som sa na to ale vykaslal a pridal to vsetko do
DBLayer, kedze s najvacsou pravdepodobnostou nebude cas na implementaciu
CreateDatabase pre Oracle, MySQL a Firebird (to vytvaranie databaze,
tabuliek a uzivatelov je silne zavisle na implementacii jednotlivych
databazovych systemov).

Ak myslis, ze by to nebol problem pridat tam ten interface (z pohladu RMI
atp.) tak daj vediet. Ak by to ale malo zabrat viac casu tak by som to asi
nechal tak ako to je teraz.

Maj sa

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060905/c2350ffb/attachment.html>

From fraktalek at mail.berlios.de  Tue Sep  5 20:18:39 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 20:18:39 +0200
Subject: [Plantlore-dev] r692 - in trunk/src/net/sf/plantlore: client
	client/overview client/overview/search client/overview/tree
	client/print common
Message-ID: <200609051818.k85IId1q030750@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 20:18:12 +0200 (Tue, 05 Sep 2006)
New Revision: 692

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/overview/JasperDataSource.java
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
   trunk/src/net/sf/plantlore/client/print/Print.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
Now closing queries even on exception.
Better exception propagation from JasperReports (Scheda and Print).



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -1122,7 +1122,7 @@
 				Task task = new Task() {
 					JasperPrint jasperPrint;
 
-					public Object task() throws DBLayerException {
+					public Object task() throws DBLayerException, RemoteException {
                                                 setStatusMessage(L10n.getString("Overview.Scheda.Generating"));
                                                 try {
                                                     jasperPrint = JasperFillManager.fillReport(
@@ -1130,7 +1130,14 @@
 								new JasperDataSource(model.getDatabase(), model
 										.getTableModel().getSelection()));
                                                 } catch (JRException jrException) {
-                                                    throw new DBLayerException(L10n.getString("Print.Message.BrokenReport"),jrException);
+                                                    Throwable t = jrException.getCause();
+                                                    if (t != null) {
+                                                        if (t instanceof RemoteException)
+                                                            throw (RemoteException)t;
+                                                        if (t instanceof DBLayerException)
+                                                            throw (DBLayerException)t;
+                                                    }
+                                                    throw new DBLayerException(L10n.getString("Print.Message.BrokenReport")+" "+jrException.getMessage(),jrException);
                                                 }
 						//fireStopped(jasperPrint);
                                                 setStatusMessage(L10n.getString("Common.Done"));
@@ -1842,11 +1849,16 @@
 	private Task refreshOverview(boolean createTask) {
 		if (createTask) {
 			Task task = new Task() {
-				public Object task() throws DBLayerException, RemoteException {
+				public Object task() throws DBLayerException, RemoteException, Exception {
                                     //refreshAction.setEnabled(false);
                                     setStatusMessage(L10n.getString("Overview.Message.LoadingOccurrences"));
 					searchModel.clear();
-					searchModel.constructQuery();
+                                        try {
+                                            searchModel.constructQuery();
+                                        } catch (Exception ex) {
+                                            searchModel.closeQuery();
+                                            throw ex;
+                                        }
 					fireStopped(null);
 					return "Ahoj, uz koncim";
 				}

Modified: trunk/src/net/sf/plantlore/client/overview/JasperDataSource.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/JasperDataSource.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/client/overview/JasperDataSource.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -35,6 +35,7 @@
 import net.sf.plantlore.common.record.Territory;
 import net.sf.plantlore.common.record.User;
 import net.sf.plantlore.common.record.NearestVillage;
+import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 import org.apache.log4j.Logger;
 
@@ -70,9 +71,9 @@
             try {
                 occurrence = (Occurrence) dlu.getObjectFor(it.next(), Occurrence.class);
             } catch (RemoteException ex) {
-                throw new JRException(ex);
+                throw new JRException(ex.getMessage(),ex);
             } catch (DBLayerException ex) {
-                throw new JRException(ex);
+                throw new JRException(ex.getMessage(),ex);
             }
             return true;
         } else

Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -634,7 +634,6 @@
         restrictions = new ArrayList<Restriction>(20);
         Object arg;
         String habitatAlias = Record.alias(Habitat.class) +".";
-        
             // Create subquery first
             SelectQuery subQuery = database.createSubQuery(AuthorOccurrence.class, "ao");
             // In the subquery select authors for the given occurrence (occurrence comes from the main query)
@@ -907,9 +906,9 @@
                 sq.addRestriction(PlantloreConstants.RESTR_EQ,"occ."+Occurrence.MONTHCOLLECTED,null,month,null);
                 restrictions.add(new Restriction(RESTR_EQ, Occurrence.MONTHCOLLECTED, month));
             }
+            this.newSelectQuery = sq;
             int resultId = database.executeQuery(sq);
             this.newResultId = resultId;
-            this.newSelectQuery = sq;
             logger.debug("Created new query. Number of results: "+database.getNumRows(resultId));
             //let the SearchBridge in AppCoreCtrl know that new result is there
             setChanged(); 
@@ -917,6 +916,15 @@
         return sq;
     }
     
+    /** To be used in exceptional states to close the query.
+     * Otherwise the query is closed in {@link OverviewTableModel.setResultId() }.
+     */
+    public void closeQuery() throws RemoteException, DBLayerException {
+        if (newSelectQuery == null)
+            return;
+        database.closeQuery(newSelectQuery);
+    }
+    
     public void clearAndNotify() {
         clear();
         setChanged(); notifyObservers("CLEAR");

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -69,9 +69,17 @@
 
                 SelectQuery query = dblayer.createQuery(Territory.class);
                 query.addRestriction(PlantloreConstants.SUBQUERY_IN,Territory.ID,null,subQuery,null);
-
-                int resultid = dblayer.executeQuery(query);
-                int resultsCount = dblayer.getNumRows(resultid);
+                
+                int resultid;
+                int resultsCount;
+                try {
+                    resultid = dblayer.executeQuery(query);
+                    resultsCount = dblayer.getNumRows(resultid);
+                } catch(DBLayerException ex) {
+                    if (query != null)
+                        dblayer.closeQuery(query);
+                    throw ex;
+                }
                 if (resultsCount <= 0) {
                     dblayer.closeQuery(query);
                     return null;

Modified: trunk/src/net/sf/plantlore/client/print/Print.java
===================================================================
--- trunk/src/net/sf/plantlore/client/print/Print.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/client/print/Print.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -18,6 +18,7 @@
 import java.io.ObjectInputStream;
 import java.io.ObjectOutputStream;
 import java.io.Serializable;
+import java.rmi.RemoteException;
 import java.util.HashMap;
 import java.util.Observable;
 import java.util.prefs.Preferences;
@@ -107,7 +108,7 @@
         final JasperReport report = this.jasperReport;
         
         Task task = new Task() {
-            public Object task() throws DBLayerException {
+            public Object task() throws DBLayerException, RemoteException {
                 JasperReport jasperReport;
                 switch (reportToUse) {
                     case SCHEDA:
@@ -135,7 +136,14 @@
                         jasperPrint = JasperFillManager.fillReport(
                               jasperReport, params, new JasperDataSource(database, selection)  );    
                     } catch (JRException jrException) {
-                        throw new DBLayerException(L10n.getString("Print.Message.BrokenReport"),jrException);
+                        Throwable t = jrException.getCause();
+                        if (t != null) {
+                            if (t instanceof RemoteException)
+                                throw (RemoteException) t;
+                            if (t instanceof DBLayerException)
+                                throw (DBLayerException) t;
+                        }
+                        throw new DBLayerException(L10n.getString("Print.Message.BrokenReport")+" "+jrException.getMessage(),jrException);
                     }
                     reportChanged = false;
                 }

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-05 18:01:29 UTC (rev 691)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-05 18:18:12 UTC (rev 692)
@@ -153,17 +153,23 @@
      * @return null in case an exception is thrown or no row with that id exists
      */
     public Record getObjectFor(int id, Class c) throws DBLayerException, RemoteException {
-        logger.debug("Looking up "+c.getName()+" object in the database for id "+id);
-        SelectQuery sq = db.createQuery(c);
-        sq.addRestriction(PlantloreConstants.RESTR_EQ,"id",null,id,null);
-        int resultid = db.executeQuery(sq);
-        int resultCount = db.getNumRows(resultid);
-        if (resultCount == 0)
-            return null;
-        Object[] results = db.more(resultid, 0, 0);
-        Object[] tmp = (Object[]) results[0];
-        db.closeQuery(sq);
-        return (Record)tmp[0];
+            SelectQuery sq = db.createQuery(c);
+            logger.debug("Looking up "+c.getName()+" object in the database for id "+id);
+            try {
+                sq.addRestriction(PlantloreConstants.RESTR_EQ,"id",null,id,null);
+                int resultid = db.executeQuery(sq);
+                int resultCount = db.getNumRows(resultid);
+                if (resultCount == 0)
+                    return null;
+                Object[] results = db.more(resultid, 0, 0);
+                Object[] tmp = (Object[]) results[0];
+                db.closeQuery(sq);
+                return (Record)tmp[0];
+            } catch(DBLayerException ex) {
+                if (sq != null) //clean up and propagate
+                    db.closeQuery(sq);
+                throw ex;
+            }
     }
 
     /**



From krater at mail.berlios.de  Tue Sep  5 21:22:42 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 21:22:42 +0200
Subject: [Plantlore-dev] r693 - in trunk/src/net/sf/plantlore/client: . login
Message-ID: <200609051922.k85JMgEo019487@sheep.berlios.de>

Author: krater
Date: 2006-09-05 21:22:41 +0200 (Tue, 05 Sep 2006)
New Revision: 693

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/login/Login.java
Log:
More careful logout.

Reconnect behaviour fixed.

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 18:18:12 UTC (rev 692)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 19:22:41 UTC (rev 693)
@@ -11,6 +11,7 @@
 import java.awt.Cursor;
 import java.awt.Dimension;
 import java.awt.EventQueue;
+import java.awt.Graphics;
 import java.awt.HeadlessException;
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
@@ -36,6 +37,7 @@
 import java.util.prefs.Preferences;
 import javax.swing.AbstractAction;
 import javax.swing.JFormattedTextField;
+import javax.swing.JLabel;
 import javax.swing.JOptionPane;
 import javax.swing.JTable;
 import javax.swing.KeyStroke;
@@ -407,6 +409,8 @@
 	}
 
 	private void setDatabaseDependentCommandsEnabled(boolean enabled) {
+		if( enabled )
+			view.overviewScrollPane.setViewportView( view.overview );
 		settingsAction.setEnabled(enabled);
 		printAction.setEnabled(enabled);
 		exportAction.setEnabled(enabled);
@@ -1676,6 +1680,14 @@
 	public class ReconnectAction extends AbstractAction {
 
 		private Component parent = view;
+		
+		private JLabel connectionLost = new JLabel(L10n.getString("Error.ConnectionLost")) {
+			{ setOpaque( false ); }
+			public void paintComponent (Graphics g) {
+				g.drawString(L10n.getString("Error.ConnectionLost"), 10, 20);
+		        //super.paintComponent(g);
+		      }
+		};
 
 		public ReconnectAction() {
 			putValue(NAME, L10n.getString("Overview.MenuFileReconnect"));
@@ -1699,6 +1711,15 @@
 					// 1. Log out ( ~ dispose of the current DBLayer)
 					logger.debug("Logging out...");
 					loginModel.logout();
+					
+					// Make changes to the GUI.
+					setDatabaseDependentCommandsEnabled( false );
+					logoutAction.setEnabled( true);
+	                reconnectAction.setEnabled( true );
+	                loginAction.setEnabled( false );
+	                createNewDatabaseAction.setEnabled( false );
+	                view.overviewScrollPane.setViewportView( connectionLost );
+	                
 					// 2. Log in again ( ~ create a new DBLayer)
 					// Note that the ProgressBar is no longer needed - 
 					// the last task surely had one and it will become

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-05 18:18:12 UTC (rev 692)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-05 19:22:41 UTC (rev 693)
@@ -59,7 +59,7 @@
 	
 	private MainConfig mainConfig = null;
 	private DBLayerFactory factory = null;
-	private DBLayer currentDBLayer; 
+	private DBLayer newDBLayer = null; 
 	private DBLayerProxy proxyLayer;
 	private Logger logger  = Logger.getLogger(this.getClass().getPackage().getName());
 	
@@ -307,7 +307,7 @@
 				// Create a new database layer ~ ask the DBLayerFactory to create it for us..
 				logger.debug("Asking the DBLayerFactory for a new DBLayer @ " + dbinfo.host + ":" + dbinfo.port);
 				setStatusMessage( L10n.getString("Login.Connecting") );
-				currentDBLayer = factory.create( dbinfo );
+				newDBLayer = factory.create( dbinfo );
 				if(isCanceled())
 					throw new Exception(L10n.getString("Common.Canceled"));
 				
@@ -318,7 +318,7 @@
 				setStatusMessage( L10n.getString("Login.InitializingDBLayer") );
 				logger.debug("Initializing that DBLayer.");
 				
-				User init = currentDBLayer.initialize(dbinfo.getDatabaseIdentifier(), name, password);
+				User init = newDBLayer.initialize(dbinfo.getDatabaseIdentifier(), name, password);
 				if(isCanceled())
 					throw new DBLayerException(L10n.getString("Common.Canceled"));
 				plantloreUser = init;
@@ -330,9 +330,9 @@
 				logger.error("The initialization of the DBLayer failed! " + e.getMessage());
 				// If the initialization of the DBLayer failed, the uninitialized DBLayer must be destroyed!
 				// Otherwise, the server's policy may not allow another connection from this client!
-				if(currentDBLayer != null)
+				if(newDBLayer != null)
 					try {
-						factory.destroy(currentDBLayer);
+						factory.destroy(newDBLayer);
 					} catch(Exception re) {
 						// There's nothing we can do; 
 						// the server is probably in trouble, or the network connection failed. 
@@ -341,11 +341,12 @@
 				throw e;
 			}
 			
-			proxyLayer.wrap( currentDBLayer );
+			proxyLayer.wrap( newDBLayer );
 			
 			setStatusMessage( L10n.getString("Login.DBLayerInitialized") );
 			logger.debug("DBLayer initialized.");
 			
+		
 			fireStopped(null);
 			
 			// Everything went fine - 
@@ -367,22 +368,23 @@
 	 * everyone using the database layer will get an exception from now on. 
 	 */
 	public void logout() {
-		if(currentDBLayer != null) 
+		if(newDBLayer != null) {
 			try {
-				factory.destroy(currentDBLayer);
-				currentDBLayer = null; accessRights = null; plantloreUser = null;
-				
+				factory.destroy(newDBLayer);
+			} catch(RemoteException e) {
+				logger.warn("Unable to disconnect from the server. " + e.getMessage());
+				// Not this time, this is supposed to be silent.
+			} finally {
+				newDBLayer = null; accessRights = null; plantloreUser = null;
 				proxyLayer.wrap( null );
 				DefaultExceptionHandler.disableReconnect();
-				
 				logger.info("The client disconnected itself from the server. The communication may no longer be possible.");
-			} catch(RemoteException e) {
-				logger.warn("Unable to disconnect from the server. " + e.getMessage());
-				// Not this time, this is supposed to be silent.
 			}
+		}
 	}
 	
 	
+	
 	/**
 	 * 
 	 * @return The last connection task, ie. the last task that was used to create a connection



From lada at mail.berlios.de  Tue Sep  5 21:27:46 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 21:27:46 +0200
Subject: [Plantlore-dev] r694 - in trunk/src/net/sf/plantlore/client:
	history user
Message-ID: <200609051927.k85JRkAS022002@sheep.berlios.de>

Author: lada
Date: 2006-09-05 21:27:43 +0200 (Tue, 05 Sep 2006)
New Revision: 694

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.form
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
Log:
UserManager - use new executeInsert.
History is bigger now.
Fix bug in History: UNDO to date - call update record only once.

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-05 19:22:41 UTC (rev 693)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-05 19:27:43 UTC (rev 694)
@@ -41,6 +41,7 @@
 import net.sf.plantlore.common.exception.DBLayerException;
 import org.apache.log4j.Logger;
 
+
 /**
  * History model. Contains bussines logic and data fields of the History. Implements
  * operations including search history data, undo, cleare database.
@@ -116,7 +117,9 @@
     /** Name of author for specific occurrence*/
     private String nameAuthor;
     /** Informaciton about location for specific occurrence*/
-    private String location;    
+    private String location;  
+    /**Model of history*/
+    final History model = this;    
     
     /** Instances of Record */
     private Object data;   
@@ -435,8 +438,8 @@
     		historyRecord = (HistoryRecord)historyDataList.get(i);    		
     		historyChange = historyRecord.getHistoryChange();
     		tableName = historyRecord.getHistoryColumn().getTableName();
-            recordId = historyChange.getRecordId();
-            operation = historyChange.getOperation();
+                recordId = historyChange.getRecordId();
+                operation = historyChange.getOperation();
 		  
             if (operation == HistoryChange.HISTORYCHANGE_INSERT) {
                 undoInsertDelete(1);
@@ -487,14 +490,20 @@
      *   @param isDelete int containing informaciton about insertion or erasure of record. 
      */
     public void undoInsertDelete(int isDelete) {
+        int contains = -1;
         if (tableName.equals(PlantloreConstants.ENTITY_OCCURRENCE)){        	
         	Object[] object = searchObject(PlantloreConstants.ENTITY_OCCURRENCE,recordId);        	        	
         	if (isError()) return; //tOccurrence doesn`t contain required data        	       		        		
         	Occurrence occurrence = (Occurrence)object[0];             
             occurrence.setDeleted(isDelete);                      	     	 
              //Add to list of changed Record
-             if (!editObjectList.contains((Record)occurrence))                 
-                editObjectList.add((Record)occurrence);       
+             contains = this.isInObjectList(Occurrence.class, occurrence.getId());
+             if (contains == -1) {
+                 logger.debug("ObjectList - add occurrence " + occurrence.getId());
+                 editObjectList.add((Record)occurrence);
+             } else {
+                 editObjectList.set(contains, (Record)occurrence); 
+             }       
              //Update author of specific occurrence
              isDelete = (isDelete == 1) ? 2 : isDelete;
              Object[] objects = getAllAuthors(occurrence, 2-isDelete);
@@ -505,8 +514,13 @@
                 AuthorOccurrence authorOccurrence = (AuthorOccurrence)autOcc[0];
                 authorOccurrence.setDeleted(isDelete);
                  //Add to list of changed Record
-                 if (!editObjectList.contains((Record)authorOccurrence))                 
-                    editObjectList.add((Record)authorOccurrence);                 
+                contains = this.isInObjectList(AuthorOccurrence.class, authorOccurrence.getId());
+                 if (contains == -1) {
+                     logger.debug("ObjectList - add authorOccurrence " + authorOccurrence.getId());
+                     editObjectList.add((Record)authorOccurrence);
+                 } else {
+                     editObjectList.set(contains, (Record)authorOccurrence); 
+                 }      
             }                                     
         } else if (tableName.equals(PlantloreConstants.ENTITY_AUTHOROCCURRENCE)) {
              Object[] object = searchObject(PlantloreConstants.ENTITY_AUTHOROCCURRENCE,recordId);               
@@ -514,45 +528,86 @@
              AuthorOccurrence authorOccurrence = (AuthorOccurrence)object[0];
              authorOccurrence.setDeleted(isDelete);             
              //Add to list of changed Record             
-             if (!editObjectList.contains((Record)authorOccurrence))                 
-                editObjectList.add((Record)authorOccurrence);             
+             contains = this.isInObjectList(AuthorOccurrence.class, authorOccurrence.getId());
+             if (contains == -1) {
+                 logger.debug("ObjectList - add authorOccurrence " + authorOccurrence.getId());
+                 editObjectList.add((Record)authorOccurrence);
+             } else {
+                 editObjectList.set(contains, (Record)authorOccurrence); 
+             }                
        } else if (tableName.equals(PlantloreConstants.ENTITY_HABITAT)) {            
                Object[] object = searchObject(PlantloreConstants.ENTITY_HABITAT,recordId);  
                if (isError()) return; //tHabitat doesn`t contain required data
                Habitat habitat = (Habitat)object[0];
                habitat.setDeleted(isDelete);
                //Add to list of changed Record             
-               if (!editObjectList.contains((Record)habitat))                 
-                   editObjectList.add((Record)habitat);             
+               contains = this.isInObjectList(Habitat.class, habitat.getId());
+                 if (contains == -1) {
+                     logger.debug("ObjectList - add habitat " + habitat.getId());
+                     editObjectList.add((Record)habitat);
+                 } else {
+                     editObjectList.set(contains, (Record)habitat); 
+                 }   
         } else if (tableName.equals(PlantloreConstants.ENTITY_METADATA)) {
              Object[] object = searchObject(PlantloreConstants.ENTITY_METADATA,recordId); 
              if (isError()) return; //tMetadata doesn`t contain required data
              Metadata metadata = (Metadata)object[0];
              metadata.setDeleted(isDelete);
              //Add to list of changed Record             
-             if (!editObjectList.contains((Record)metadata))                 
-                editObjectList.add((Record)metadata);             
+             contains = this.isInObjectList(Metadata.class, metadata.getId());
+             if (contains == -1) {
+                 logger.debug("ObjectList - add metadata ID " + metadata.getId());
+                 editObjectList.add((Record)metadata);
+             } else {
+                 editObjectList.set(contains, (Record)metadata); 
+             }                                
         } else if (tableName.equals(PlantloreConstants.ENTITY_PUBLICATION)) {
              Object[] object = searchObject(PlantloreConstants.ENTITY_PUBLICATION,recordId);
              if (isError()) return; //tPublication doesn`t contain required data
              Publication publication = (Publication)object[0];
              publication.setDeleted(isDelete);
              //Add to list of changed Record             
-             if (!editObjectList.contains((Record)publication))                 
-                editObjectList.add((Record)publication);             
+             contains = this.isInObjectList(Publication.class, publication.getId());
+             if (contains == -1) {
+                 logger.debug("ObjectList - add publications");
+                 editObjectList.add((Record)publication);
+             } else {
+                 editObjectList.set(contains, (Record)publication); 
+             }                       
         } else if (tableName.equals(PlantloreConstants.ENTITY_AUTHOR)) {             
              Object[] object = searchObject(PlantloreConstants.ENTITY_AUTHOR,recordId);  
              if (isError()) return; //tAuthor doesn`t contain required data
              Author author = (Author)object[0];
              author.setDeleted(isDelete);
              //Add to list of changed Record             
-             if (!editObjectList.contains((Record)author))                 
-                editObjectList.add((Record)author);             
+             contains = this.isInObjectList(Author.class, author.getId());
+             if (contains == -1) {
+                 logger.debug("ObjectList - add authors");
+                 editObjectList.add((Record)author);
+             } else {
+                 editObjectList.set(contains, (Record)author); 
+             }                       
         }  else {
             logger.error("Name of table is incorrect.");
         }
     }
     
+    
+    public int isInObjectList(Class type, int historyRecordId) {     
+    	int placings = -1;        
+    	for (int i=0; i < editObjectList.size(); i++) {                
+    		if (editObjectList.get(i).getClass().equals(type)) {                        
+    			int listId = ((Record)editObjectList.get(i)).getId();                       
+    			if (historyRecordId == listId) {    				
+    				placings = i;       				
+    				break;
+    			}
+    		}
+    	}             
+        return placings;
+    }
+    
+    
     /**
      * Rollaback operation Update.
      */
@@ -613,14 +668,8 @@
         	// Select record AuthorOccurrence where id = authorOccurrenceId 
     		Object[] object = searchObject(PlantloreConstants.ENTITY_AUTHOROCCURRENCE, authorOccId);
     		if (isError()) return; //tAuthorOccurrence doesn`t contain required data
-            authorOccurrence = (AuthorOccurrence)object[0];
-        }     	                 
-                
-        boolean objectList = editObjectList.contains((Record)authorOccurrence); 
-        if (!objectList) {
-        	//add object to list of editing object
-            editObjectList.add((Record)authorOccurrence);
-        }
+               authorOccurrence = (AuthorOccurrence)object[0];
+        }     	                                        
        
        // Get number of columnName from authorOccurrence mapping
         int columnConstant;
@@ -922,8 +971,8 @@
                         Object[] objectVill = searchObject(PlantloreConstants.ENTITY_VILLAGE,oldRecordId);
                         if (isError()) return; //tVillage doesn`t contain required data
                         NearestVillage village = (NearestVillage)objectVill[0];
-                hab.setNearestVillage(village);
-                logger.debug("Set selected value for update of attribute NearesVillage.");
+                        hab.setNearestVillage(village);                        
+                        logger.debug("Set selected value for update of attribute NearesVillage." + village.getName());
                 } else {
                         logger.error("UNDO - Incorrect oldRecordId for NearestVillage.");
                 }                
@@ -1140,10 +1189,10 @@
         Metadata metadata = null;
     	int placings = 0;
     	boolean contain = false;
-    	for (int i=0; i < editObjectList.size(); i++) {
-    		if (editObjectList.get(i) instanceof Metadata) {    			
-    			int listOccId = ((Metadata)(editObjectList.get(i))).getId();
-    			if (metadataId == listOccId) {
+    	for (int i=0; i < editObjectList.size(); i++) {                        
+    		if (editObjectList.get(i) instanceof Metadata) {                                               
+    			int listId = ((Metadata)(editObjectList.get(i))).getId();                        
+    			if (metadataId == listId) {                                
     				contain = true;
     				placings = i; 
     				metadata = (Metadata)(editObjectList.get(i));
@@ -1156,7 +1205,7 @@
         	// Select record Metadata where id = metadataId 
     		Object[] object = searchObject(PlantloreConstants.ENTITY_METADATA, metadataId);
     		if (isError()) return; //tMetadata doesn`t contain required data
-    	    metadata = (Metadata)object[0];
+                metadata = (Metadata)object[0];
         }
     	
         // Get number of columnName from metadata mapping.
@@ -1229,7 +1278,7 @@
         	editObjectList.set(placings,(Record)metadata);        
         } else {
         	// add object to list of editing object
-            logger.debug("ObjectList - add metadata");
+            logger.debug("ObjectList - add metadata "+metadata.getId());
             editObjectList.add(metadata);
         }
     }
@@ -1531,7 +1580,7 @@
 		        
 		        try {
 			    	for (int i=0; i< count; i++) {			    		
-			    			logger.debug("Object for update: "+ ((Record)editObjectList.get(i)).getId());                         
+			                logger.debug("Object for update: "+ editObjectList.get(i).getClass()+ ", id" + ((Record)editObjectList.get(i)).getId());                         
 			                type = editObjectList.get(i).getClass().getSimpleName();			                		               
 			                 if (editTypeHash.containsKey(type)) {
 			                         key = (Enum)editTypeHash.get(type); 
@@ -1540,9 +1589,9 @@
 			                }                                  			                
 			                database.executeUpdateInTransactionHistory(editObjectList.get(i));
 			    		}
-			    	//Delete selected data from history tables 
+			    	//Delete selected data from history tables                                 
 			    	deleteHistory();
-		        } catch (Exception e) {
+                        } catch (Exception e) {
 		        	logger.error("Process UNDO failed. Exception caught in History. Details: "+e.getMessage());
 		        	database.rollbackTransaction();                    
                                  throw e; 		           		       	    
@@ -1569,8 +1618,8 @@
             logger.debug("Type of editing object (array for appcore): " + editType.get(i));
             editTypeArray[i] = editType.get(i);
         }
-        setChanged(); 
-        notifyObservers(editTypeArray);
+        model.setChanged(); 
+        model.notifyObservers(editTypeArray);
     }
     
     /**
@@ -1601,6 +1650,7 @@
                         logger.debug("Deleting historyRecord successfully. Number of result: "+i);
                 } catch (Exception e) {								
                         logger.error("Process UNDO failed. Deleting historyRecord failed. Exception caught in History. Details: "+e.getMessage());	        	                
+                        //database.rollbackTransaction();  
                         throw e; 		           
 		} 						
                 try {
@@ -1613,6 +1663,7 @@
                         }
                 } catch (Exception e) {
                         logger.error("Process UNDO failed. Deleting historyChange failed. Exception caught in History. Details: "+e.getMessage());	        		                
+                        //database.rollbackTransaction();  
                         throw e; 		           
 			} 		 
     	}    	
@@ -1851,6 +1902,8 @@
 		            database.conditionDelete(Occurrence.class, Occurrence.DELETED, "=", 1);
 		            // delete data from table tHabitat with contidion cDelete == 1
 		            database.conditionDelete(Habitat.class, Habitat.DELETED, "=", 1);
+                            // delete data from table tMetadata with contidion cDelete == 1
+		            database.conditionDelete(Metadata.class, Metadata.DELETED, "=", 1);
 		            // delete data from table tPublication with contidion cDelete == 1
 		            database.conditionDelete(Publication.class, Publication.DELETED, "=", 1);
 		            //Delete all date from tables tHistory and tHistoryChange

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-09-05 19:22:41 UTC (rev 693)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-09-05 19:27:43 UTC (rev 694)
@@ -25,7 +25,7 @@
                   <Component id="jPanel3" alignment="1" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="helpButton" min="-2" pref="80" max="-2" attributes="0"/>
-                      <EmptySpace pref="568" max="32767" attributes="0"/>
+                      <EmptySpace pref="646" max="32767" attributes="0"/>
                       <Component id="closeButton" min="-2" pref="80" max="-2" attributes="0"/>
                   </Group>
               </Group>
@@ -80,7 +80,7 @@
                       <Component id="locationValueLabel" alignment="0" max="32767" attributes="1"/>
                       <Component id="authorValueLabel" alignment="0" max="32767" attributes="1"/>
                   </Group>
-                  <EmptySpace pref="538" max="32767" attributes="0"/>
+                  <EmptySpace pref="616" max="32767" attributes="0"/>
               </Group>
           </Group>
         </DimensionLayout>
@@ -178,7 +178,7 @@
                       <Component id="whenInsertValueLabel" min="-2" max="-2" attributes="0"/>
                       <Component id="whoInsertValueLabel" min="-2" max="-2" attributes="0"/>
                   </Group>
-                  <EmptySpace pref="552" max="32767" attributes="0"/>
+                  <EmptySpace pref="630" max="32767" attributes="0"/>
               </Group>
           </Group>
         </DimensionLayout>
@@ -248,7 +248,7 @@
               <Group type="102" alignment="1" attributes="0">
                   <EmptySpace max="-2" attributes="0"/>
                   <Group type="103" groupAlignment="1" attributes="0">
-                      <Component id="jScrollPane1" alignment="0" pref="692" max="32767" attributes="0"/>
+                      <Component id="jScrollPane1" alignment="0" pref="770" max="32767" attributes="0"/>
                       <Group type="102" alignment="1" attributes="0">
                           <Component id="undoButton" min="-2" pref="90" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
@@ -270,7 +270,7 @@
                           <Component id="displayedLabel" min="-2" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="displayedValueLabel" min="-2" max="-2" attributes="0"/>
-                          <EmptySpace pref="79" max="32767" attributes="0"/>
+                          <EmptySpace pref="157" max="32767" attributes="0"/>
                           <Component id="nextButton" min="-2" pref="80" max="-2" attributes="0"/>
                       </Group>
                   </Group>

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-05 19:22:41 UTC (rev 693)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-05 19:27:43 UTC (rev 694)
@@ -168,7 +168,7 @@
                     .add(taxonValueLabel)
                     .add(locationValueLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(authorValueLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-                .addContainerGap(538, Short.MAX_VALUE))
+                .addContainerGap(616, Short.MAX_VALUE))
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -210,7 +210,7 @@
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(whenInsertValueLabel)
                     .add(whoInsertValueLabel))
-                .addContainerGap(552, Short.MAX_VALUE))
+                .addContainerGap(630, Short.MAX_VALUE))
         );
         jPanel2Layout.setVerticalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -269,7 +269,7 @@
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 692, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 770, Short.MAX_VALUE)
                     .add(jPanel3Layout.createSequentialGroup()
                         .add(undoButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -290,7 +290,7 @@
                         .add(displayedLabel)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(displayedValueLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 79, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 157, Short.MAX_VALUE)
                         .add(nextButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
@@ -332,7 +332,7 @@
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 568, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 646, Short.MAX_VALUE)
                         .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-05 19:22:41 UTC (rev 693)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-05 19:27:43 UTC (rev 694)
@@ -346,8 +346,7 @@
     				//Create database user
     				database.createUser(userRecord.getLogin(), getPassword(), isAdmin); 
     				//Insert information about user into tRight, tUser
-    				int rightId = database.executeInsert(right);
-                                right.setId(rightId);
+    				right = (Right)database.executeInsert(right);                               
                                 database.executeInsertInTransaction(userRecord);		                                
                                 //Add new name (login) of user to user list    	            
                                 int count = users.length;



From krater at mail.berlios.de  Tue Sep  5 21:31:26 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 21:31:26 +0200
Subject: [Plantlore-dev] r695 - in trunk/src/net/sf/plantlore:
	client/tableimport common
Message-ID: <200609051931.k85JVQpW023927@sheep.berlios.de>

Author: krater
Date: 2006-09-05 21:31:17 +0200 (Tue, 05 Sep 2006)
New Revision: 695

Modified:
   trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
DBLayers utils fixed (using the new dblayer interface).

Tableimport fixed (using the new dblayer interface).

Modified: trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 19:27:43 UTC (rev 694)
+++ trunk/src/net/sf/plantlore/client/tableimport/TableImportTask.java	2006-09-05 19:31:17 UTC (rev 695)
@@ -207,8 +207,7 @@
 	 */
 	protected void insert(Record record) 
 	throws RemoteException, DBLayerException {
-		Integer newId = db.executeInsertHistory( record );
-		record.setId( newId ); // It is not important here - these records won't be referenced (in here).
+		db.executeInsertHistory( record );
 	}
 	
 	/**

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-05 19:27:43 UTC (rev 694)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-05 19:31:17 UTC (rev 695)
@@ -507,9 +507,7 @@
 		if(counterpart == null) {
 			logger.debug("The record is not in the database. It will be inserted.");
 			// Insert it!
-			Integer newId = db.executeInsertInTransaction(record);
-			record.setId( newId );
-			return record;
+			return db.executeInsertInTransaction(record);
 		}
 		
 		// The record is in the database.
@@ -534,9 +532,7 @@
 		if( recordInDB != null)
 			return recordInDB;
 		
-		Integer newId = db.executeInsertHistory( record );
-		record.setId( newId );
-		return record;
+		return db.executeInsertHistory( record );
 	}
 	
 	/**
@@ -667,8 +663,7 @@
 						db.executeUpdateInTransaction(current);
 					else {
 						// User decided to insert new copy (safer).
-						Integer newId = db.executeInsertInTransaction(current);
-						current.setId(newId);
+						current = db.executeInsertInTransaction(current);
 					}
 				}
 			}
@@ -697,8 +692,7 @@
 		
 		if( replacementInDB == null ) {
 			if( currentInDB == null ) {
-				Integer newId = db.executeInsertHistory( replacement );
-				replacement.setId( newId );
+				replacement = db.executeInsertHistory( replacement );
 				return replacement;
 			}
 			else {



From lada at mail.berlios.de  Tue Sep  5 22:17:18 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Tue, 5 Sep 2006 22:17:18 +0200
Subject: [Plantlore-dev] r696 - trunk/src/net/sf/plantlore/server
Message-ID: <200609052017.k85KHIP9020286@sheep.berlios.de>

Author: lada
Date: 2006-09-05 22:17:17 +0200 (Tue, 05 Sep 2006)
New Revision: 696

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Catch StaleObjectStateException in commitTransaction and call rollback if commit is failed.

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 19:31:17 UTC (rev 695)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 20:17:17 UTC (rev 696)
@@ -898,15 +898,24 @@
             this.longTx = null;
             // Close the session
             this.txSession.close();            
-       } catch (JDBCException e) {
+       } catch (StaleObjectStateException e) {   
             this.rollbackTransaction();
+            logger.error("StaleObjectStateException caught (Concurrent transactions running and trying to commit). Details: "+e.getMessage());
+            throw new DBLayerException("Error.ConcurrentUpdate", DBLayerException.ERROR_TRANSACTION, e);
+        }   catch (JDBCException e) {
+            this.rollbackTransaction();
             logger.fatal("JDBC Exception caught while commiting database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Exception.CommitTransaction"), DBLayerException.ERROR_TRANSACTION, e);
+            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
+            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
+            throw ex;
         } catch (HibernateException e) {
             this.rollbackTransaction();            
             logger.fatal("Cannot commit database transaction");
-            throw new DBLayerException(L10n.getString("Exception.CommitTransaction"), DBLayerException.ERROR_TRANSACTION, e);        
+            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
+            ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
+            throw ex;            
         }
+
         return true;
     }
     
@@ -1406,29 +1415,7 @@
         Integer updatedId = null;
         ScrollableResults sr;
         
-        // Update tMetaData.cDateModified for any operation on Occurrences and Habitats
-/*        
-        if (data instanceof Occurrence) {
-            Integer occId = ((Occurrence)data).getId();
-            // Read the associated metadata
-            Session tmpSess = this.sessionFactory.openSession();
-            sr = tmpSess.createCriteria(Occurrence.class)
-                .add(Restrictions.eq(Occurrence.ID, occId))
-                .scroll();
-            if (!sr.next()) {
-                logger.error("Occurrence record for the given Metadata not found");
-                DBLayerException ex = new DBLayerException("Occurrence record for the given Metadata not found");
-                ex.setError(ex.ERROR_OTHER, null);
-                tmpSess.close();
-                throw ex;                    
-            }
-            Object[] res = sr.get();
-            tmpSess.close();
-            Occurrence occ = (Occurrence)res[0];
-            occ.getMetadata().setDateModified(new java.util.Date());
-            sess.update(occ.getMetadata());
-        }
-*/ 
+      
         // Set right type of operation for AuthorOccurrence
         int aoInsert = 0;
         if (data instanceof AuthorOccurrence) {



From fraktalek at mail.berlios.de  Tue Sep  5 22:33:33 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 5 Sep 2006 22:33:33 +0200
Subject: [Plantlore-dev] r697 - in trunk: installer
	src/net/sf/plantlore/client
	src/net/sf/plantlore/client/overview/detail
Message-ID: <200609052033.k85KXXTJ021506@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-05 22:33:31 +0200 (Tue, 05 Sep 2006)
New Revision: 697

Added:
   trunk/installer/intro_cze.html
   trunk/installer/intro_eng.html
Modified:
   trunk/installer/install.xml
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/overview/detail/Detail.java
   trunk/src/net/sf/plantlore/client/overview/detail/DetailCtrl.java
Log:
Detail now closes queries on exceptions too and loads using task and dispatcher.
Introductory text for the installer.



Modified: trunk/installer/install.xml
===================================================================
--- trunk/installer/install.xml	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/installer/install.xml	2006-09-05 20:33:31 UTC (rev 697)
@@ -1 +1 @@
-<?xml version="1.0" encoding="utf-8" standalone="yes" ?>

<installation version="1.0">

    <info>

        <appname>Plantlore</appname>

        <appversion>1.0</appversion>

        <authors>
            <author name="Lada Oberreiterova" email="lada at mail@berlios.de"/>
            <author name="Erik Kratochvil" email="krater at mail.berlios.de"/>
	    <author name="Tomas Kovarik" email="kovo at mail.berlios.de"/>
	    <author name="Jakub Kotowski" email="fraktalek at mail.berlios.de"/>
        </authors>

        <url>http://plantlore.berlios.de</url>
        
        <uninstaller write="yes"/>

    </info>

    
    <guiprefs width="640" height="480" resizable="no"/>

    
    <locale>
        <langpack iso3="cze"/>
        <langpack iso3="eng"/>
    </locale>

    


    <resources>
        <res id="LicencePanel.licence" src="resources/gpl.txt"/>
        <res id="InfoPanel.info" src="installer/readme.txt"/>
        <res id="userInputSpec.xml" src="installer/userInputSpec.xml"/>  !
       
        <res id="userInputLang.xml_eng" src="installer/userInputLang.xml_eng" />
        <res id="userInputLang.xml_cze" src="installer/userInputLang.xml_cze" />
    </resources>

    


    <panels>
        <panel classname="HelloPanel"/>
        <panel classname="InfoPanel"/>
        <panel classname="LicencePanel"/>
        <panel classname="TargetPanel"/> 
        <panel classname="PacksPanel"/>
        <panel classname="UserInputPanel"/>        
        <panel classname="InstallPanel"/>
        <panel classname="FinishPanel"/>
    </panels>

    

    <packs>
        
        <pack name="Core" required="yes">
            <description>Files that Plantlore needs always</description>
            <file src="dist/lib" targetdir="$INSTALL_PATH"/>
        </pack>
        
	<pack name="Client" required="no">
            <description>Plantlore Java Client</description>
            <file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"/>
        </pack>

	<pack n!
 ame="Server" required="no" preselected="no">
            <desc!
 ription>
Plantlore Server</description>
            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>
            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>
	</pack>
	
	<pack name="PostgreSQL" required="no">
            <description>The PostgreSQL database machine</description>            
            <file src="installer/postgresql/postgresql-int.msi" targetdir="$INSTALL_PATH" os="windows"/>
            <file src="installer/postgresql/postgres_install.bat" targetdir="$INSTALL_PATH" os="windows"/>            
            <parsable targetfile="$INSTALL_PATH/postgres_install.bat" os="windows" />
            <executable targetfile="$INSTALL_PATH/postgres_install.bat" 
                        stage="postinstall" 
                        os="windows" 
                        failure="warn" />                        
	</pack>
	
        <pack name="Docs" required="no">
            <description>The documentation</description>
            <file src="documentation!
 " targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->
        </pack>

        <pack name="Sources" required="no" preselected="no">
            <description>The sources</description>
            <file src="src" targetdir="$INSTALL_PATH"/>
        </pack>

    </packs>

    

</installation>
\ No newline at end of file
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>

<installation version="1.0">

    <info>

        <appname>Plantlore</appname>

        <appversion>1.0</appversion>

        <authors>
            <author name="Lada Oberreiterova" email="lada at mail@berlios.de"/>
            <author name="Erik Kratochvil" email="krater at mail.berlios.de"/>
	    <author name="Tomas Kovarik" email="kovo at mail.berlios.de"/>
	    <author name="Jakub Kotowski" email="fraktalek at mail.berlios.de"/>
        </authors>

        <url>http://plantlore.berlios.de</url>
        
        <uninstaller write="yes"/>

    </info>

    
    <guiprefs width="640" height="480" resizable="no"/>

    
    <locale>
        <langpack iso3="cze"/>
        <langpack iso3="eng"/>
    </locale>

    


    <resources>
        <res id="LicencePanel.licence" src="resources/gpl.txt"/>
        <res id="HTMLInfoPanel.info_cze" src="installer/intro_cze.html"/>
        <res id="HTMLInfoPanel.info_eng" src="installer/intro!
 _eng.html"/>
        <res id="userInputSpec.xml" src="installer/userInputSpec.xml"/>        
        <res id="userInputLang.xml_eng" src="installer/userInputLang.xml_eng" />
        <res id="userInputLang.xml_cze" src="installer/userInputLang.xml_cze" />
    </resources>

    


    <panels>
        <panel classname="HelloPanel"/>
        <panel classname="HTMLInfoPanel"/>
        <panel classname="LicencePanel"/>
        <panel classname="TargetPanel"/> 
        <panel classname="PacksPanel"/>
        <panel classname="UserInputPanel"/>        
        <panel classname="InstallPanel"/>
        <panel classname="FinishPanel"/>
    </panels>

    

    <packs>
        
        <pack name="Core" required="yes">
            <description>Files that Plantlore needs always</description>
            <file src="dist/lib" targetdir="$INSTALL_PATH"/>
        </pack>
        
	<pack name="Client" required="no">
            <description>Plantlore Java Client</description>
            <!
 file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"!
 />
     
   </pack>

	<pack name="Server" required="no" preselected="no">
            <description>Plantlore Server</description>
            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>
            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>
	</pack>
	
	<pack name="PostgreSQL" required="no">
            <description>The PostgreSQL database machine</description>            
            <file src="installer/postgresql/postgresql-int.msi" targetdir="$INSTALL_PATH" os="windows"/>
            <file src="installer/postgresql/postgres_install.bat" targetdir="$INSTALL_PATH" os="windows"/>            
            <parsable targetfile="$INSTALL_PATH/postgres_install.bat" os="windows" />
            <executable targetfile="$INSTALL_PATH/postgres_install.bat" 
                        stage="postinstall" 
                        os="windows" 
                        failure="warn" />                        
	</pack>
	
        <pack name="Docs" required="no">
   !
          <description>The documentation</description>
            <file src="documentation" targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->
        </pack>

        <pack name="Sources" required="no" preselected="no">
            <description>The sources</description>
            <file src="src" targetdir="$INSTALL_PATH"/>
        </pack>

    </packs>

    

</installation>
\ No newline at end of file

Added: trunk/installer/intro_cze.html
===================================================================
--- trunk/installer/intro_cze.html	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/installer/intro_cze.html	2006-09-05 20:33:31 UTC (rev 697)
@@ -0,0 +1,26 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <title>Plantlore</title>
+  </head>
+  <body>
+      <h1>Plantlore</h1>
+      <h2>?vod</h2>
+      <p>Plantlore je datab?zov? syst?m pro zad?v?n? a vyhled?v?n? dat o v?skytu rostlin ???en? pod licenc? GPL.
+      Je navr?en jako aplikace s architekturou klient server. Umo??uje jak pr?ci lok?ln?
+      tak i vzd?lenou po s?ti. Tento instal?tor instaluje Plantlore klienta a server
+      napsan? v programovac?m jazyce Java. Sou??st? projektu Plantlore je i webov? klient,
+      kter? se instaluje zvl???.</p>
+      <h2>Vybran? funkce</h2>
+      <ul>
+          <li>Rychl? zad?v?n? a editace n?lez? ("?krt?k", automatick? dopl?ov?n?, ...)</li>
+          <li>Spr?va dat o u?ivatel?ch, autorech a projektech</li>
+          <li>Import a export do XML kompatibiln?ho s ABCD schema a DarwinCore</li>
+          <li>Lokalizace - zat?m ?e?tina a angli?tina</li>
+          <li>Tisk sched</li>
+          <li>Voln? dostupn? zdrojov? k?dy pod licenc? GPL</li>
+          <li>... a dal??</li>
+      </ul>
+  </body>
+</html>

Added: trunk/installer/intro_eng.html
===================================================================
--- trunk/installer/intro_eng.html	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/installer/intro_eng.html	2006-09-05 20:33:31 UTC (rev 697)
@@ -0,0 +1,26 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <title>Plantlore</title>
+  </head>
+  <body>
+      <h1>Plantlore</h1>
+      <h2>Introduction</h2>
+      <p>Plantlore is a database system to be used for occurrence data management. 
+      It is a client-server application written in Java and developed under the GPL license. 
+      Plantlore supports local and remote work via a network. This installer installs the Plantlore
+      rich client and Plantlore server. The project also includes a web client which you have
+      to install separately.</p>
+      <h2>Feature highlights</h2>
+      <ul>
+          <li>Simple and fast occurrence adding and editation (the checklist, auto completition, ...)</li>
+          <li>User, author and project management</li>
+          <li>Import and export of ABCD schema and DarwinCore compatible XML</li>
+          <li>Localization - English and Czech for the moment</li>
+          <li>Scheda printing</li>
+          <li>Open sourced under the GPL license</li>
+          <li>... and more</li>
+      </ul>
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 20:33:31 UTC (rev 697)
@@ -1531,14 +1531,22 @@
 					int resultNumber = model.getSelectedResultNumber();
                                         if (resultNumber > model.getResultsCount()) {
                                             logger.error("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
-                                            JOptionPane.showMessageDialog(view,L10n.getString("Error.LostConnection"));
-                                            return;
+                                            throw new DBLayerException(L10n.getString("DBLayer.Error.Login"), DBLayerException.ERROR_CONNECT);
                                         }
                                         
 					if (resultNumber != model.getResultsCount())
 						model.selectAndShow(resultNumber);
-					detailModel.load(model.getSelectedResultNumber());
-                                        detailView.setVisible(true);
+					Task task = detailModel.load(model.getSelectedResultNumber());
+                                        task.setPostTaskAction(new PostTaskAction() {
+                                           public void afterStopped(Object value) {
+                                               SwingUtilities.invokeLater(new Runnable() {
+                                                   public void run() {
+                                                        detailView.setVisible(true);                                                       
+                                                   }
+                                               });
+                                           } 
+                                        });
+                                        Dispatcher.getDispatcher().dispatch(task, view, false);
 				} catch (RemoteException ex) {
                                     DefaultExceptionHandler.handle(view,ex);
                                     return;
@@ -1572,8 +1580,7 @@
 					int resultNumber = model.getSelectedResultNumber();
                                         if (resultNumber > model.getResultsCount()) {
                                             logger.error("Trying to show detail for a record number of which is bigger than results count. Have we been disconnected?");
-                                            JOptionPane.showMessageDialog(view,"The connection has been probably lost.");
-                                            return;
+                                            throw new DBLayerException(L10n.getString("DBLayer.Error.Login"), DBLayerException.ERROR_CONNECT);
                                         }
                                         
 					if (resultNumber != model.getResultsCount())
@@ -1585,8 +1592,17 @@
 					// next row, so
 					// we need to
 					// correct that
-					detailModel.load(model.getSelectedResultNumber());
-                                        detailView.setVisible(true);
+					Task task = detailModel.load(model.getSelectedResultNumber());
+                                        task.setPostTaskAction(new PostTaskAction() {
+                                           public void afterStopped(Object value) {
+                                               SwingUtilities.invokeLater(new Runnable() {
+                                                   public void run() {
+                                                        detailView.setVisible(true);                                                       
+                                                   }
+                                               });
+                                           } 
+                                        });
+                                        Dispatcher.getDispatcher().dispatch(task, view, false);
 				} catch (RemoteException ex) {
                                     DefaultExceptionHandler.handle(view,ex);
                                     return;

Modified: trunk/src/net/sf/plantlore/client/overview/detail/Detail.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/Detail.java	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/src/net/sf/plantlore/client/overview/detail/Detail.java	2006-09-05 20:33:31 UTC (rev 697)
@@ -16,6 +16,8 @@
 import net.sf.plantlore.client.*;
 import net.sf.plantlore.client.AppCore;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.PostTaskAction;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
@@ -76,90 +78,105 @@
     }
     
     
-    public void load(int result) throws DBLayerException, RemoteException {
-        this.currentResult = result;
-        Integer occurrenceId = appCore.getOccurrence(result);
-        logger.debug("Detail model: loading data for occurrence id "+occurrenceId);
-        SelectQuery sq = null;
-        
-        sq = database.createQuery(Occurrence.class);
-        sq.createAlias(Occurrence.HABITAT,"habitat");
-        sq.createAlias(Occurrence.PLANT,"plant");
-        // Add publications using LEFT OUTER JOIN - so that occurrences without a publication are displayed as well
-        sq.createAlias(Occurrence.PUBLICATION,"publication", PlantloreConstants.LEFT_OUTER_JOIN);
-        sq.createAlias(Occurrence.METADATA,"metadata");
-        sq.createAlias("habitat."+Habitat.PHYTOCHORION,"phyt");
-        sq.createAlias("habitat."+Habitat.NEARESTVILLAGE,"vill");
-        sq.createAlias("habitat."+Habitat.TERRITORY,"territory");
-        // Add subquery to the query. Compare authoroccurrence.authorid with the result of a subquery (LEALL: <= all(...))
-        sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.ID, null, occurrenceId, null);
-        
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.DATASOURCE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.HERBARIUM);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.TIMECOLLECTED);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.DAYCOLLECTED);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.MONTHCOLLECTED);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.YEARCOLLECTED);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.NOTE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.CREATEDWHO);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.CREATEDWHEN);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.UPDATEDWHO);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.UPDATEDWHEN);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.ALTITUDE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LATITUDE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LONGITUDE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.COUNTRY);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.DESCRIPTION);                    
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.NOTE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.QUADRANT);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"vill."+NearestVillage.NAME);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"metadata."+Metadata.DATASETTITLE);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.CODE);                    
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.NAME);                    
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"plant."+Plant.TAXON);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"publication."+Publication.REFERENCECITATION);
-        sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"territory."+Territory.NAME);
-        
-        int resultId = database.executeQuery(sq);
-        int resultsCount = database.getNumRows(resultId);
-        if (resultsCount == 0) {
-            logger.error("Detail: occurrence "+occurrenceId+" has no record in the database.");
-            throw new DBLayerException("The occurrence you selected is no longer in the database.");
-        }
-        assert resultsCount == 1;
-        
-        Object[] records = database.more(resultId, 0, resultsCount - 1);
-        database.closeQuery(sq);
-        Object[] pa = (Object[]) records[0];
-        source = (String)pa[0];
-        herbarium = (String)pa[1];
-        time = (Date)pa[2];
-        day = (Integer)pa[3];
-        month = (Integer)pa[4];
-        year = (Integer)pa[5];
-        occNote = (String)pa[6];
-        createdWho = ((User)pa[7]).getWholeName();
-        createdWhen= (Date)pa[8];
-        updatedWho = ((User)pa[9]).getWholeName();
-        updatedWhen = (Date)pa[10];
-        altitude= (Double)pa[11];
-        latitude = (Double)pa[12];
-        longitude = (Double)pa[13];
-        country = (String)pa[14];
-        placeDescription = (String)pa[15];
-        quadrant = (String)pa[16];
-        habNote = (String)pa[17];
-        village = (String)pa[18];
-        project = (String)pa[19];
-        phytCode = (String)pa[20];
-        phytName = (String)pa[21];
-        taxon = (String)pa[22];
-        publication = (String)pa[23];
-        territory = (String)pa[24];
-        
-        detailTableModel = new DetailTableModel(occurrenceId);
-        setChanged();
-        notifyObservers("NEW_DETAIL_LOADED");
+    public Task load(final int result) {
+        final Detail model = this;
+        Task task = new Task() {
+            public Object task() throws DBLayerException, RemoteException {
+                setStatusMessage(L10n.getString("Overview.Detail.Loading"));
+                currentResult = result;
+                Integer occurrenceId = appCore.getOccurrence(result);
+                logger.debug("Detail model: loading data for occurrence id "+occurrenceId);
+                SelectQuery sq = null;
+
+                sq = database.createQuery(Occurrence.class);
+                sq.createAlias(Occurrence.HABITAT,"habitat");
+                sq.createAlias(Occurrence.PLANT,"plant");
+                // Add publications using LEFT OUTER JOIN - so that occurrences without a publication are displayed as well
+                sq.createAlias(Occurrence.PUBLICATION,"publication", PlantloreConstants.LEFT_OUTER_JOIN);
+                sq.createAlias(Occurrence.METADATA,"metadata");
+                sq.createAlias("habitat."+Habitat.PHYTOCHORION,"phyt");
+                sq.createAlias("habitat."+Habitat.NEARESTVILLAGE,"vill");
+                sq.createAlias("habitat."+Habitat.TERRITORY,"territory");
+                // Add subquery to the query. Compare authoroccurrence.authorid with the result of a subquery (LEALL: <= all(...))
+                sq.addRestriction(PlantloreConstants.RESTR_EQ, Occurrence.ID, null, occurrenceId, null);
+
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.DATASOURCE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.HERBARIUM);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.TIMECOLLECTED);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.DAYCOLLECTED);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.MONTHCOLLECTED);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.YEARCOLLECTED);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.NOTE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.CREATEDWHO);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.CREATEDWHEN);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.UPDATEDWHO);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,Occurrence.UPDATEDWHEN);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.ALTITUDE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LATITUDE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.LONGITUDE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.COUNTRY);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.DESCRIPTION);                    
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.NOTE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"habitat."+Habitat.QUADRANT);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"vill."+NearestVillage.NAME);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"metadata."+Metadata.DATASETTITLE);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.CODE);                    
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"phyt."+Phytochorion.NAME);                    
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"plant."+Plant.TAXON);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"publication."+Publication.REFERENCECITATION);
+                sq.addProjection(PlantloreConstants.PROJ_PROPERTY,"territory."+Territory.NAME);
+
+                int resultId;
+                int resultsCount;
+                try {
+                    resultId = database.executeQuery(sq);
+                    resultsCount = database.getNumRows(resultId);
+                } catch(DBLayerException ex) {
+                    database.closeQuery(sq);
+                    throw ex;
+                }
+                if (resultsCount == 0) {
+                    logger.error("Detail: occurrence "+occurrenceId+" has no record in the database.");
+                    throw new DBLayerException("The occurrence you selected is no longer in the database.");
+                }
+                assert resultsCount == 1;
+
+                Object[] records = database.more(resultId, 0, resultsCount - 1);
+                database.closeQuery(sq);
+                Object[] pa = (Object[]) records[0];
+                source = (String)pa[0];
+                herbarium = (String)pa[1];
+                time = (Date)pa[2];
+                day = (Integer)pa[3];
+                month = (Integer)pa[4];
+                year = (Integer)pa[5];
+                occNote = (String)pa[6];
+                createdWho = ((User)pa[7]).getWholeName();
+                createdWhen= (Date)pa[8];
+                updatedWho = ((User)pa[9]).getWholeName();
+                updatedWhen = (Date)pa[10];
+                altitude= (Double)pa[11];
+                latitude = (Double)pa[12];
+                longitude = (Double)pa[13];
+                country = (String)pa[14];
+                placeDescription = (String)pa[15];
+                quadrant = (String)pa[16];
+                habNote = (String)pa[17];
+                village = (String)pa[18];
+                project = (String)pa[19];
+                phytCode = (String)pa[20];
+                phytName = (String)pa[21];
+                taxon = (String)pa[22];
+                publication = (String)pa[23];
+                territory = (String)pa[24];
+
+                detailTableModel = new DetailTableModel(occurrenceId);
+                model.setChanged();
+                model.notifyObservers("NEW_DETAIL_LOADED");
+                return null;
+            }//task()
+        };
+        return task;
     }
         
     
@@ -168,20 +185,30 @@
         logger.debug("Detail model - database set.");
     }
     
-    public void next() throws DBLayerException, RemoteException {
+    public Task next() throws RemoteException {
         if (appCore.getResultsCount() <= currentResult+1)
-            return;
+            return null;
         currentResult++;
-        load(currentResult);
-        appCore.selectAndShow(currentResult);
+        Task task = load(currentResult);
+        task.setPostTaskAction(new PostTaskAction() {
+            public void afterStopped(Object value) throws DBLayerException, RemoteException {
+                appCore.selectAndShow(currentResult);                        
+            }
+        });
+        return task;
     }
     
-    public void prev() throws DBLayerException, RemoteException {
+    public Task prev() throws RemoteException {
         if (currentResult <=0)
-            return;
+            return null;
         currentResult--;
-        load(currentResult);
-        appCore.selectAndShow(currentResult);
+        Task task = load(currentResult);
+        task.setPostTaskAction(new PostTaskAction() {
+            public void afterStopped(Object value) throws DBLayerException, RemoteException {
+                appCore.selectAndShow(currentResult);                        
+            }
+        });
+        return task;
     }
     
     class DetailTableModel extends AbstractTableModel {

Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailCtrl.java	2006-09-05 20:17:17 UTC (rev 696)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailCtrl.java	2006-09-05 20:33:31 UTC (rev 697)
@@ -14,6 +14,9 @@
 import javax.swing.AbstractAction;
 import javax.swing.JOptionPane;
 import net.sf.plantlore.client.*;
+import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.Dispatcher;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.l10n.L10n;
 import org.apache.log4j.Logger;
@@ -44,13 +47,13 @@
         public void actionPerformed(ActionEvent e) {
             logger.debug("Next detail.");
             try {
-                model.next();
-            } catch (DBLayerException ex) {
-                JOptionPane.showMessageDialog(view,"Database problem: "+ex);
-                ex.printStackTrace();
+                Task task = model.next();
+                if (task == null)
+                    return;
+                Dispatcher.getDispatcher().dispatch(task, view, false);
             } catch (RemoteException ex) {
-                JOptionPane.showMessageDialog(view,"Remote connection problem: "+ex);
-                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;
             }
         }
         
@@ -64,13 +67,13 @@
         public void actionPerformed(ActionEvent e) {
             logger.debug("Prev detail.");
             try {
-                model.prev();
-            } catch (DBLayerException ex) {
-                JOptionPane.showMessageDialog(view,"Database problem: "+ex);
-                ex.printStackTrace();
+                Task task = model.prev();
+                if (task == null)
+                    return;
+                Dispatcher.getDispatcher().dispatch(task, view, false);
             } catch (RemoteException ex) {
-                JOptionPane.showMessageDialog(view,"Remote connection problem: "+ex);
-                ex.printStackTrace();
+                DefaultExceptionHandler.handle(view, ex);
+                return;
             }
         }
         



From krater at mail.berlios.de  Tue Sep  5 22:38:06 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 5 Sep 2006 22:38:06 +0200
Subject: [Plantlore-dev] r698 - in trunk/src/net/sf/plantlore: client
	client/login common l10n server
Message-ID: <200609052038.k85Kc61I021714@sheep.berlios.de>

Author: krater
Date: 2006-09-05 22:38:04 +0200 (Tue, 05 Sep 2006)
New Revision: 698

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
   trunk/src/net/sf/plantlore/client/login/AuthView.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Minor changes.

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 20:38:04 UTC (rev 698)
@@ -1700,7 +1700,7 @@
 		private JLabel connectionLost = new JLabel(L10n.getString("Error.ConnectionLost")) {
 			{ setOpaque( false ); }
 			public void paintComponent (Graphics g) {
-				g.drawString(L10n.getString("Error.ConnectionLost"), 10, 20);
+				g.drawString(L10n.getString("Information.NoConnectionAvailable"), 10, 20);
 		        //super.paintComponent(g);
 		      }
 		};

Modified: trunk/src/net/sf/plantlore/client/login/AuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/client/login/AuthCtrl.java	2006-09-05 20:38:04 UTC (rev 698)
@@ -39,9 +39,6 @@
 			String user = ((javax.swing.JTextField)view.user.getEditor().getEditorComponent()).getText();
 			Task connect = model.createConnectionTask(user, new String(view.password.getPassword()));
 			Dispatcher.getDispatcher().dispatch( connect, view, false );
-			
-			// Discard the password!
-			view.password.setText("");
 		}
 	}
 	

Modified: trunk/src/net/sf/plantlore/client/login/AuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-05 20:38:04 UTC (rev 698)
@@ -115,6 +115,8 @@
     public void setVisible(boolean arg0) {
     	next.setEnabled(true);
     	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
+		// Discard the password!
+		password.setText("");
     	super.setVisible(arg0);
     }
     

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 20:38:04 UTC (rev 698)
@@ -191,7 +191,7 @@
              	            progress.setMaximum(100);
              	            progress.setValue(100);
                         	setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-                        	cancel.setText(L10n.getString("Common.Hide"));
+                        	cancel.setText(L10n.getString("Common.Ok"));
                         }
                     });
                 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-05 20:38:04 UTC (rev 698)
@@ -684,8 +684,11 @@
 Information.SearchMetadata = No search field has been filled in. All metadata will display.
 Information.SearchMetadataTitle = Search metadata
 Information.NoMetadataInResult = No metadata with the given attributes were found. Please modify search criteria.
-Information.NoMetadataInResultTitle = No search results 
+Information.NoMetadataInResultTitle = No search results
 
+
+Information.NoConnectionAvailable=The database connection is not available. 
+
 #=============================================================
 # ERRORS
 #=============================================================
@@ -748,6 +751,7 @@
 Error.DeletingSharedRecord=Unable to delete a shared record.
 Error.SloppyProgramming=The programmer made a mistake here.\nThis should not have happened.
 Error.DatabaseOperationFailed=Unable to perform the database operation.
+Error.ConnectionFailed=The connetion failed
 
 Error.Server.AccessDenied=Access denied - insufficient permissions.
 Error.Server.ConnectionRefused=Connection refused. Is the Server running?
@@ -810,11 +814,8 @@
 Question.ClearHistoryMessage = Whole history will be deleted.
 Question.ClearHistoryMessageTitle = Clean history.
 
-questionAlreadyBoundException = Another server is already running on the selected port.\n Maybe you wanted to connect to it. Shall I do it for you?
-questionAlreadyBoundExceptionTitle = Server collision!
 
 
-
 Author.list=List of authors
 #Add author button
 Author.AddButton=Add author
@@ -1003,8 +1004,6 @@
 
 AddEdit.RequiredInfoLabel=The symbol {0} marks required items.
 
-Login.Edit=
-
 Search.FromLabel=From\: 
 
 Search.ToLabel=To\: 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-05 20:38:04 UTC (rev 698)
@@ -49,14 +49,6 @@
 Overview.ColumnOccurrenceId=Occurrence ID
 Overview.ColumnSelection=X
 
-
-Next = &Pokracovat
-Refresh = &Obnovit
-StopServer = Stopnout server
-TerminateServer = Ukoncit server
-SelectNew = Vytvor a spust novy server.
-SelectExisting = Pripoj se k existujicimu serveru.
-
 #=============================================================
 # HISTORY
 #	net.sf.plantlore.client.history
@@ -289,22 +281,9 @@
 
 # Seznam varov\u75a3\ufffd syst\u99d1u
 warningEmptySelection = Nen\ufffd vybr\u75a3 ?\u7586n\ufffd z\u75d9nam.\n Zvolte nejprve n?jak\ufffd z\u75d9nam a zkuste to znovu. 
-warningEmptySelectionTitle = Nic nen\ufffd vybr\u75a3o
 
 warningNoUsername = Nen\u00ED vybr\u00E1no \u017E\u00E1dn\u00E9 jm\u00E9no ze seznamu.
 warningNoUsernameTitle = Nen\u00ED vybr\u00E1no u\u017E. jm\u00E9no.
-
-# LIST OF ERRORS AND EXCEPTIONS
-errorDBLayerException = P?ipojen\ufffd k datab\u75d9i se nezda?ilo nebo selhalo.\n Ujist?te se, ?e jste zadali spr\u75b1n\ufffd p?ihla?ovac\ufffd \u68c8aje (spr\u75b1n\ufffd u?iv. jm\u99edo i heslo)\n a zkuste to znovu. 
-errorDBLayerExceptionTitle = Probl\u99d1 s p?ipojen\u5307 k DB 
-
-errorNotBoundException = Server je nedostupn\ufffd nebo neb??\ufffd.\n Ujist?te se, ?e jste zadali spr\u75b1n\ufffd informace o p?ipojen\ufffd.\n  V\u5164e detail? o probl\u99d1u lze naj\u549c v logu.
-errorNotBoundExceptionTitle = Server neb??\ufffd
-
-errorRemoteException = Pravd?podobn? spadlo s\ufffd?ov\ufffd p?ipojen\ufffd nebo byl vypnut server.\n Ujist?te se, ?e s\ufffd?ov\ufffd p?ipojen\ufffd je aktivn\ufffd.\n V\u5164e detail? o probl\u99d1u lze naj\u549c v logu. 
-errorRemoteExceptionTitle = Probl\u99d1 se s\u549c\ufffd
-
-errorAlreadyBoundException = Na zadan\u99d1 portu ji? b??\ufffd jin\ufffd server.\n Vyberte pros\u5307 jin\ufffd port a zkuste to znovu. 
 errorAlreadyBoundExceptionTitle = Kolize serveru
 Author.list=Seznam autor\u016F
 
@@ -400,8 +379,6 @@
 
 referenceCitationLbl=Reference citation\:
 
-journalNameLbl=Journal name
-
 collectionNameLbl=N\u00E1zev kolekce
 
 referenceDetailLbl=Reference detail
@@ -436,8 +413,6 @@
 
 addPublicationReferenceCitationLbl=Reference citation\:
 
-addPublicationJournalAuthorNameLbl=Journal author\:
-
 addPublicationJournalNameLbl=Journal name\:
 
 addPublicationCollectionYearPublicationLbl=Year of publication\:
@@ -977,10 +952,6 @@
 
 Import.Completed=Import prob\u011Bhl \u00FAsp\u011B\u0161n\u011B.
 
-Import.RememberDecision=P\u0159\u00ED\u0161t\u011B se neptat
-
-Import.RememberDecisionTT=Zapamatuj si moje rozhodnut\u00ED a od p\u0159\u00ED\u0161t\u011B jej pou\u017Eij.
-
 Import.RecordsInserted=vlo\u017Eeno.
 
 Import.RecordsDeleted=smaz\u00E1no.
@@ -991,18 +962,6 @@
 
 Import.RecordsProcessed={0} zpracov\u00E1no ({1} zam\u00EDtnuto)
 
-Import.Abort=Zru\u0161it
-
-Import.Hide=Skr\u00FDt
-
-Import.Skip=P\u0159esko\u010Dit
-
-Import.Update=Aktualizovat
-
-Import.Insert=Vlo\u017Eit nov\u00FD
-
-Import.Replace=Nahradit
-
 Import.Progress=dokon\u010Deno.
 
 Import.CompletelyCorruptedRecord=Z\u00E1znam {0} je nelze rozparsovat.
@@ -1011,8 +970,6 @@
 
 Import.IncompleteRecord=Z\u00E1znam {0} je ne\u00FApln\u00FD.
 
-Import.DuplicateRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) je v datab\u00E1zi n\u011Bkolikr\u00E1t\!\nNen\u00ED z\u0159ejm\u00E9, kter\u00FD z nich by se m\u011Bl aktualizovat\!
-
 Import.ProblematicRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) nelze zpracovat;
 
 Import.NoAuthorsLeft=Z\u00E1znam \u010D. {0} by nem\u011Bl \u017E\u00E1dn\u00E9 autory - aktualizaci nelze prov\u00E9st.
@@ -1031,8 +988,6 @@
 
 Export.Abort=Storno
 
-Export.Hide=Skr\u00FDt
-
 Export.SelectColumns=V\u00FDb\u011Br sloupe\u010Dk\u016F
 
 Export.RecordsExported=exportov\u00E1no.
@@ -1051,8 +1006,6 @@
 
 Format.StdOut=Standardn\u00ED v\u00FDstup
 
-XTree.Plantlore=Plantlore
-
 Author=Autor
 
 Author.wholeName=Jm\u00E9no a p\u0159\u00EDjmen\u00ED
@@ -1221,30 +1174,16 @@
 
 Village=S\u00EDdlo
 
-Village.name=Jm\u00E9no
-
 Record.Property=Atribut
 
 Record.Value=Hodnota
 
-Record.InDatabase=V datab\u00E1zi
-
-Record.FromFile=Ze souboru
-
 Warning.EmptySelection=Nen\u00ED ozna\u010Den \u017E\u00E1dn\u00FD z\u00E1znam\!
 
 Warning.EmptySelectionTitle=Pr\u00E1zdn\u00FD v\u00FDb\u011Br...
 
 Server.Host=Host
 
-Server.Next=P\u0159ipojit
-
-Server.NextTT=P\u0159ipojen\u00ED k existuj\u00EDc\u00EDmu serveru.
-
-Server.Create=Vytvo\u0159it
-
-Server.CreateTT=Vytvo\u0159en\u00ED a spu\u0161t\u011Bn\u00ED nov\u00E9ho serveru.
-
 Server.ConnectionsTotal=Celkov\u00FD po\u010Det p\u0159ipojen\u00ED
 
 Server.ConnectionsPerIP=P\u0159ipojen\u00ED z jedn\u00E9 IP
@@ -1341,8 +1280,6 @@
 
 Error.InvalidSelection=Vnit\u0159n\u00ED chyba aplikace\: Neplatn\u00FD seznam vybran\u00FDch z\u00E1znam\u016F.
 
-Error.TooManyTasks=Prob\u00EDh\u00E1 p\u0159\u00EDli\u0161 mnoho export\u016F najednou.
-
 Error.InvalidQuery=Vnit\u0159n\u00ED chyba aplikace\: Neplatn\u00FD dotaz.
 
 Error.InvalidFilter=Vnit\u0159n\u00ED chyba aplikace\: Neplatn\u00FD form\u00E1t souboru.
@@ -1733,7 +1670,7 @@
 
 Error.General=Chyba
 
-Error.Internal=Vnit\u0159n\u00ED\u00ED chyba aplikace
+Error.Internal=Vnit\u0159n\u00ED chyba aplikace
 
 Error.Fatal=Z\u00E1va\u017En\u00E1 chyba
 
@@ -1914,3 +1851,11 @@
 AddEdit.OccurrenceNoteLabel=Pozn\u00E1mka k n\u00E1lezu\:
 
 AddEdit.LocationNoteLabel=Pozn\u00E1mka k lokalit\u011B\:
+
+Information.NoConnectionAvailable=P\u0159ipojen\u00ED k datab\u00E1zi nen\u00ED moment\u00E1ln\u011B k dispozici.
+
+Error.ConnectionFailed=P\u0159ipojen\u00ED se nezda\u0159ilo
+
+Overview.MenuFileCreateDB=Vytvo\u0159it novou datab\u00E1zi
+
+Common.Progress=Dlouhotrvaj\u00EDc\u00ED operace

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-05 20:38:04 UTC (rev 698)
@@ -253,13 +253,6 @@
 HABITAT.note = Note of habitat 
 
 
-record.Property = Property
-record.Value = Value
-record.ForeignKey = Foreign Key
-record.InDatabase = Value (In DB)
-record.FromFile = Value (In File)
-
-
 #Title of border and other titles 
 netadata.project = PROJECT
 metadata.institution = INSTITUTION
@@ -284,104 +277,21 @@
 
 # History - message
 clearHistoryMessage = All history will be delete.
-
-# LOGIN
-loginAdd = &Add
-loginRemove = &Remove
-loginEdit = &Edit
 # LOGIN - AUTHORIZE
 Username = Username
-Password = Password
-Authorize = Authorize
-ConnectingTo = Connecting to
-# LOGIN - RECORDS
-AddTitle = Add a record
-EditTitle = Edit the record 
-Alias = Alias
-Hostname = Hostname
-HostPort = Hostname:Port
-Database = Database
 Change = Change
 
-# EXPORT | IMPORT
-FilterPlantloreNative = Plantlore native (for future import)
-FilterXML = Extensible Markup Language (XML)
-FilterABCD = ABCD Schema native
-FilterDC = DarwinCore native
-FilterConsole = Console output
 
-
-import.Title = Import
-import.Failed = Import failed.
-import.Initializing = Initializing...
-import.Aborted = Import aborted.
-import.DecisionExpected = Your intervention is required.
-import.RememberDecision = Do not ask me again.
-import.RecordsImported = records imported.
-import.RecordsRejected = records rejected.
-import.Skip = Skip
-import.Update = Update
-import.Replace = Replace
-
-
-
-
-
-
-Next = &Next
-Refresh = &Refresh
-RefreshTT = Reload the list of the connected clients.
-StopServer = Stop server
-TerminateServer = Terminate server
-TerminateServerTT = Switch off the server.
-SelectNew = Create and start &new server.
-SelectNewTT = Run a new server on the specified port\n protected by the given password.
-SelectExisting = Connect to an existing server.
-
-
-AutoSelect = select automatically 
-
-
 # LIST OF WARNINGS
 warningEmptySelection = No record has been selected.\n Please select some record and try again.
-warningEmptySelectionTitle = Empty selection...
 
 warningNoUsername = No username has been entered.\n Please select or type a username and try again.
 warningNoUsernameTitle = Missing username...
-
-# LIST OF ERRORS AND EXCEPTIONS
-errorDBLayerException = The connection to the database could not be established.\n Please make sure you entered valid authentication information (misspelled username, incorrect password)\n and try again.
-errorDBLayerExceptionTitle = Database connection error! 
-
-errorNotBoundException = The server is either unreachable or not running.\n Please make sure you entered valid connection information.\n Study the log for further details. 
-errorNotBoundExceptionTitle = Server unreachable!
-
-errorRemoteException = Either the network connection has failed or the server has crashed or gone off.\n Please make sure the network connection is working.\n Study the log for further details.  
-errorRemoteExceptionTitle = Network problem!
-
-errorAlreadyBoundException = Another server is already running on the specified port.\n Please choose another port and try again.
 errorAlreadyBoundExceptionTitle = Server collision!
-
-errorCertificationException = The certification failed - the password is incorrect.\n Please type the password again.
-errorCertificationExceptionTitle = Certification failure!
-error.RecordNotFound = No matching record was found!
-error.FKIsNull = The foreign key is not set!
-error.ReaderNotCreated = Unable to create a new reader!
-error.ThreadFailed = Unable to create a new thread!
-error.NothingSelected = Nothing is selected!
 Error.IncorrectXMLFile = Incorrect XML file!\n
 
 
-question.AbortImport = Import will be aborted.
-question.SharedRecord = This record is is shared. Updating it may affect other records.
-question.NewerRecord = The record in the database is newer than the record in the file.
 
-
-questionAlreadyBoundException = Another server is already running on the selected port.\n Maybe you wanted to connect to it. Shall I do it for you?
-questionAlreadyBoundExceptionTitle = Server collision!
-
-
-
 Author.list=List of authors
 
 Author.AddButton=Add author
@@ -474,8 +384,6 @@
 
 referenceCitationLbl=Reference citation\:
 
-journalNameLbl=Journal name
-
 collectionNameLbl=Collection name
 
 referenceDetailLbl=Reference detail
@@ -510,8 +418,6 @@
 
 addPublicationReferenceCitationLbl=Reference citation\:
 
-addPublicationJournalAuthorNameLbl=Journal author\:
-
 addPublicationJournalNameLbl=Journal name\:
 
 addPublicationCollectionYearPublicationLbl=Year of publication\:

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 20:33:31 UTC (rev 697)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-05 20:38:04 UTC (rev 698)
@@ -725,7 +725,7 @@
                 tx.rollback();
             }            
             logger.fatal("JDBC Exception caught while executing Select query. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Exception.DatabaseQuery"), DBLayerException.ERROR_SELECT, e);            
+            throw new DBLayerException(L10n.getString("Error.DatabaseQuery"), /*DBLayerException.ERROR_SELECT, */e);            
         } catch (HibernateException e) {
             if (tx != null) {
                 tx.rollback();



From discontinuum at gmail.com  Tue Sep  5 23:36:54 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Tue, 5 Sep 2006 23:36:54 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
Message-ID: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>

Sjednoceni vzhledu

   - Levy dolni roh: Napoveda - pouzit Common.Help
   - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto poradi. Tj. OK
   nalevo od Storno - pouzit Common.Ok, Common.Cancel. Tlacitka jsou
   stejne siroka (lze nastavit v Matisse: Same width).
   - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
   Common.Previous - stejna sirka.
   - Pozadi v komponentach JTable je bile
   - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N, popisky
   tlacitek a dulezitych policek - textfieldu apod. (tooltipy)


Oprava vyjimek

V database layer opravit hazeni vyjimek. JDBCException osetrovat readeji
  throw new DBLayerException(L10n.getString("Error.MyDescription"), ex);

Doporucene testy

   - chovani pri odpojeni databaze
   - chovani pri odpojeni serveru
   - chovani vubec pres vzdalene pripojeni (bude-li to fungovat remote,
   pak lokalne uz to asi chodit bude taky. naopak to neplati.)
   - vice klientu zaraz?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060905/dca09e27/attachment.html>

From discontinuum at gmail.com  Tue Sep  5 23:38:31 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Tue, 5 Sep 2006 23:38:31 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
In-Reply-To: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
References: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
Message-ID: <f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>

Jo a jeste sjednotit chovani manageru pri chybejicim db spojeni - nezobrazit
dialog, jenom hlasku, jak to ma treba Habitat tree.

On 9/5/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Sjednoceni vzhledu
>
>    - Levy dolni roh: Napoveda - pouzit Common.Help
>    - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto poradi. Tj.
>    OK nalevo od Storno - pouzit Common.Ok, Common.Cancel. Tlacitka jsou
>    stejne siroka (lze nastavit v Matisse: Same width).
>    - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
>    Common.Previous - stejna sirka.
>    - Pozadi v komponentach JTable je bile
>    - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N, popisky
>    tlacitek a dulezitych policek - textfieldu apod. ( tooltipy)
>
>
> Oprava vyjimek
>
> V database layer opravit hazeni vyjimek. JDBCException osetrovat readeji
>   throw new DBLayerException(L10n.getString("Error.MyDescription"), ex);
>
> Doporucene testy
>
>    - chovani pri odpojeni databaze
>    - chovani pri odpojeni serveru
>    - chovani vubec pres vzdalene pripojeni ( bude-li to fungovat
>    remote, pak lokalne uz to asi chodit bude taky. naopak to neplati.)
>    - vice klientu zaraz?
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060905/ac001635/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 00:07:10 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 00:07:10 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
In-Reply-To: <f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>
References: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
	<f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>
Message-ID: <f4dc39b90609051507u655cc474k71ece3b0289e31b7@mail.gmail.com>

Zkusit si praci s uzivatelem s omezenymi pravy.

On 9/5/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Jo a jeste sjednotit chovani manageru pri chybejicim db spojeni -
> nezobrazit dialog, jenom hlasku, jak to ma treba Habitat tree.
>
>
> On 9/5/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
> >
> > Sjednoceni vzhledu
> >
> >    - Levy dolni roh: Napoveda - pouzit Common.Help
> >    - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto poradi. Tj.
> >    OK nalevo od Storno - pouzit Common.Ok, Common.Cancel. Tlacitka
> >    jsou stejne siroka (lze nastavit v Matisse: Same width).
> >    - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
> >    Common.Previous - stejna sirka.
> >    - Pozadi v komponentach JTable je bile
> >    - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N, popisky
> >    tlacitek a dulezitych policek - textfieldu apod. ( tooltipy)
> >
> >
> > Oprava vyjimek
> >
> > V database layer opravit hazeni vyjimek. JDBCException osetrovat readeji
> >
> >   throw new DBLayerException(L10n.getString("Error.MyDescription"), ex);
> >
> > Doporucene testy
> >
> >    - chovani pri odpojeni databaze
> >    - chovani pri odpojeni serveru
> >    - chovani vubec pres vzdalene pripojeni ( bude-li to fungovat
> >    remote, pak lokalne uz to asi chodit bude taky. naopak to neplati
> >    .)
> >    - vice klientu zaraz?
> >
> >
> >
> >
> >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/7c4e26de/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 00:08:26 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 00:08:26 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
In-Reply-To: <f4dc39b90609051507u655cc474k71ece3b0289e31b7@mail.gmail.com>
References: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
	<f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>
	<f4dc39b90609051507u655cc474k71ece3b0289e31b7@mail.gmail.com>
Message-ID: <f4dc39b90609051508j6be98c8fh1bb7349699fa6f7a@mail.gmail.com>

Dopsat vsem oknum (dialogum) nadpisy. Spouste oken ted chybi.

On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Zkusit si praci s uzivatelem s omezenymi pravy.
>
>
> On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> >
> > Jo a jeste sjednotit chovani manageru pri chybejicim db spojeni -
> > nezobrazit dialog, jenom hlasku, jak to ma treba Habitat tree.
> >
> >
> > On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > >
> > > Sjednoceni vzhledu
> > >
> > >    - Levy dolni roh: Napoveda - pouzit Common.Help
> > >    - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto poradi.
> > >    Tj. OK nalevo od Storno - pouzit Common.Ok, Common.Cancel.
> > >    Tlacitka jsou stejne siroka (lze nastavit v Matisse: Same width
> > >    ).
> > >    - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
> > >    Common.Previous - stejna sirka.
> > >    - Pozadi v komponentach JTable je bile
> > >    - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N, popisky
> > >    tlacitek a dulezitych policek - textfieldu apod. ( tooltipy)
> > >
> > >
> > > Oprava vyjimek
> > >
> > > V database layer opravit hazeni vyjimek. JDBCException osetrovat
> > > readeji
> > >   throw new DBLayerException(L10n.getString("Error.MyDescription"),
> > > ex);
> > >
> > > Doporucene testy
> > >
> > >    - chovani pri odpojeni databaze
> > >    - chovani pri odpojeni serveru
> > >    - chovani vubec pres vzdalene pripojeni ( bude-li to fungovat
> > >    remote, pak lokalne uz to asi chodit bude taky. naopak to neplati
> > >    .)
> > >    - vice klientu zaraz?
> > >
> > >
> > >
> > >
> > >
> > >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/87af6a30/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 00:14:15 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 00:14:15 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
In-Reply-To: <f4dc39b90609051508j6be98c8fh1bb7349699fa6f7a@mail.gmail.com>
References: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
	<f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>
	<f4dc39b90609051507u655cc474k71ece3b0289e31b7@mail.gmail.com>
	<f4dc39b90609051508j6be98c8fh1bb7349699fa6f7a@mail.gmail.com>
Message-ID: <f4dc39b90609051514n2c1451d0s51b877e0d53f6a72@mail.gmail.com>

V taskach pouzivat mnohem vic setStatusMessage() - n?m? tasky pusobi dojmem,
ze tam sice neco lita, ale nic se nedeje.

On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Dopsat vsem oknum (dialogum) nadpisy. Spouste oken ted chybi.
>
>
> On 9/6/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> >
> > Zkusit si praci s uzivatelem s omezenymi pravy.
> >
> >
> > On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > >
> > > Jo a jeste sjednotit chovani manageru pri chybejicim db spojeni -
> > > nezobrazit dialog, jenom hlasku, jak to ma treba Habitat tree.
> > >
> > >
> > > On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > > >
> > > > Sjednoceni vzhledu
> > > >
> > > >    - Levy dolni roh: Napoveda - pouzit Common.Help
> > > >    - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto poradi.
> > > >    Tj. OK nalevo od Storno - pouzit Common.Ok, Common.Cancel.
> > > >    Tlacitka jsou stejne siroka (lze nastavit v Matisse: Same
> > > >    width).
> > > >    - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
> > > >    Common.Previous - stejna sirka.
> > > >    - Pozadi v komponentach JTable je bile
> > > >    - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N,
> > > >    popisky tlacitek a dulezitych policek - textfieldu apod. (
> > > >    tooltipy)
> > > >
> > > >
> > > > Oprava vyjimek
> > > >
> > > > V database layer opravit hazeni vyjimek. JDBCException osetrovat
> > > > readeji
> > > >   throw new DBLayerException(L10n.getString("Error.MyDescription"),
> > > > ex);
> > > >
> > > > Doporucene testy
> > > >
> > > >    - chovani pri odpojeni databaze
> > > >    - chovani pri odpojeni serveru
> > > >    - chovani vubec pres vzdalene pripojeni ( bude-li to fungovat
> > > >    remote, pak lokalne uz to asi chodit bude taky. naopak to neplati
> > > >    .)
> > > >    - vice klientu zaraz?
> > > >
> > > >
> > > >
> > > >
> > > >
> > > >
> > >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/8a7765b9/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 00:56:04 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 00:56:04 +0200
Subject: [Plantlore-dev] Meeting - 40 hrs before the Hour H (ZULU BRAVO
	TANGA CHARLIE)
In-Reply-To: <f4dc39b90609051514n2c1451d0s51b877e0d53f6a72@mail.gmail.com>
References: <f4dc39b90609051436k56475628kb6cb1357f47e7dff@mail.gmail.com>
	<f4dc39b90609051438x8742d65kcdc6d2be5df358c6@mail.gmail.com>
	<f4dc39b90609051507u655cc474k71ece3b0289e31b7@mail.gmail.com>
	<f4dc39b90609051508j6be98c8fh1bb7349699fa6f7a@mail.gmail.com>
	<f4dc39b90609051514n2c1451d0s51b877e0d53f6a72@mail.gmail.com>
Message-ID: <f4dc39b90609051556m43083588he5e81dd9f635900c@mail.gmail.com>

V AppCoreCtrl si kazdy zkontroluje "svoje" akce, zda spravne hendluji
vyjimky.

On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> V taskach pouzivat mnohem vic setStatusMessage() - n?m? tasky pusobi
> dojmem, ze tam sice neco lita, ale nic se nedeje.
>
>
> On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
> >
> > Dopsat vsem oknum (dialogum) nadpisy. Spouste oken ted chybi.
> >
> >
> > On 9/6/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > >
> > > Zkusit si praci s uzivatelem s omezenymi pravy.
> > >
> > >
> > > On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > > >
> > > > Jo a jeste sjednotit chovani manageru pri chybejicim db spojeni -
> > > > nezobrazit dialog, jenom hlasku, jak to ma treba Habitat tree.
> > > >
> > > >
> > > > On 9/5/06, Erik Kratochv?l < discontinuum at gmail.com> wrote:
> > > > >
> > > > > Sjednoceni vzhledu
> > > > >
> > > > >    - Levy dolni roh: Napoveda - pouzit Common.Help
> > > > >    - Pravy dolni roh: OK a Cancel (OK a Storno) - v tomto
> > > > >    poradi. Tj. OK nalevo od Storno - pouzit Common.Ok,
> > > > >    Common.Cancel. Tlacitka jsou stejne siroka (lze nastavit v
> > > > >    Matisse: Same width).
> > > > >    - Tlacitka Next a Previous (Dalsi a Predchozi) - Common.Next,
> > > > >    Common.Previous - stejna sirka.
> > > > >    - Pozadi v komponentach JTable je bile
> > > > >    - Doplneni ESC, defaultniho tlactika (OK), doplnit L10N,
> > > > >    popisky tlacitek a dulezitych policek - textfieldu apod. (
> > > > >    tooltipy)
> > > > >
> > > > >
> > > > > Oprava vyjimek
> > > > >
> > > > > V database layer opravit hazeni vyjimek. JDBCException osetrovat
> > > > > readeji
> > > > >   throw new DBLayerException(L10n.getString("Error.MyDescription"),
> > > > > ex);
> > > > >
> > > > > Doporucene testy
> > > > >
> > > > >    - chovani pri odpojeni databaze
> > > > >    - chovani pri odpojeni serveru
> > > > >    - chovani vubec pres vzdalene pripojeni ( bude-li to
> > > > >    fungovat remote, pak lokalne uz to asi chodit bude taky. naopak to neplati
> > > > >    .)
> > > > >    - vice klientu zaraz?
> > > > >
> > > > >
> > > > >
> > > > >
> > > > >
> > > > >
> > > >
> > >
> >
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/8ec0476d/attachment.html>

From krater at mail.berlios.de  Wed Sep  6 01:12:12 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 01:12:12 +0200
Subject: [Plantlore-dev] r699 - in trunk/src/net/sf/plantlore: client
	client/checklist client/createdb client/export client/login
	common server/manager
Message-ID: <200609052312.k85NCCci011282@sheep.berlios.de>

Author: krater
Date: 2006-09-06 01:11:49 +0200 (Wed, 06 Sep 2006)
New Revision: 699

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form
   trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form
   trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
   trunk/src/net/sf/plantlore/client/login/AuthView.form
   trunk/src/net/sf/plantlore/client/login/AuthView.java
   trunk/src/net/sf/plantlore/client/login/ItemView2.form
   trunk/src/net/sf/plantlore/client/login/ItemView2.java
   trunk/src/net/sf/plantlore/client/login/LoginView.form
   trunk/src/net/sf/plantlore/client/login/LoginView.java
   trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
   trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
Log:
GUI Updates (OK button is on the left side of Cancel. Ugly. But convention.)

SimpleProgressBar2 still refuses to work in indeterminate mode. The Dark God of Swing knows why. Sacrifice will be held tomorrow.





Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -667,14 +667,9 @@
 				
 				exportModel.setSelectQuery(query);
 				exportModel.setSelection(model.getTableModel().getSelection());
-			} catch (DBLayerException e) {
-				// TODO: Some errors may lead to ReconnectDialog.show()!
-				JOptionPane.showMessageDialog(view, "DBLayer Exception: "
-						+ e.getMessage());
+			} catch (Exception e) {
+				DefaultExceptionHandler.handle(view, e, L10n.getString("Export.Failed"));				
 				return;
-			} catch (RemoteException e) {
-				DefaultReconnectDialog.show(view, e);
-				return;
 			}
 
 			exportCtrl.setVisible(true);

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -25,10 +25,10 @@
               <EmptySpace max="-2" attributes="0"/>
               <Component id="help" min="-2" max="-2" attributes="0"/>
               <EmptySpace pref="171" max="32767" attributes="0"/>
+              <Component id="submit" linkSize="1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
               <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="submit" linkSize="1" min="-2" max="-2" attributes="0"/>
-              <EmptySpace max="-2" attributes="0"/>
           </Group>
           <Group type="102" alignment="0" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
@@ -45,9 +45,9 @@
               <Component id="scrollpane" pref="229" max="32767" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="submit" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/checklist/ChecklistView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -86,9 +86,9 @@
                 .addContainerGap()
                 .add(help)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
+                .add(submit)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(submit)
                 .addContainerGap())
             .add(layout.createSequentialGroup()
                 .addContainerGap()
@@ -106,9 +106,9 @@
                 .add(scrollpane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 229, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(submit)
+                    .add(help)
                     .add(cancel)
-                    .add(help))
+                    .add(submit))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -29,9 +29,9 @@
                       </Group>
                   </Group>
                   <Group type="102" alignment="1" attributes="0">
+                      <Component id="create" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="3" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="create" linkSize="3" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
@@ -53,8 +53,8 @@
               </Group>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="create" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -78,9 +78,9 @@
                             .add(user, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 208, Short.MAX_VALUE)
                             .add(password, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 208, Short.MAX_VALUE)))
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(cancel)
+                        .add(create)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(create)))
+                        .add(cancel)))
                 .addContainerGap())
         );
 
@@ -99,8 +99,8 @@
                     .add(password, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(create)
-                    .add(cancel))
+                    .add(cancel)
+                    .add(create))
                 .addContainerGap())
         );
 

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -26,10 +26,10 @@
                   <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="128" max="32767" attributes="0"/>
+                      <EmptySpace pref="138" max="32767" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
@@ -45,9 +45,9 @@
               <Component id="jPanel2" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -83,11 +83,11 @@
                 .addContainerGap()
                 .add(jLabel1)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(databaseEngine, 0, 144, Short.MAX_VALUE)
+                .add(databaseEngine, 0, 149, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jLabel2)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 71, Short.MAX_VALUE)
+                .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 76, Short.MAX_VALUE)
                 .addContainerGap())
         );
         jPanel1Layout.setVerticalGroup(
@@ -128,8 +128,8 @@
                             .add(jLabel4))
                         .add(11, 11, 11)
                         .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(databaseAlias, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 268, Short.MAX_VALUE)
-                            .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 268, Short.MAX_VALUE)))
+                            .add(databaseAlias, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 278, Short.MAX_VALUE)
+                            .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 278, Short.MAX_VALUE)))
                     .add(jPanel2Layout.createSequentialGroup()
                         .add(10, 10, 10)
                         .add(leaveEmpty)))
@@ -167,10 +167,10 @@
                     .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
                         .add(help)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 128, Short.MAX_VALUE)
-                        .add(cancel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 138, Short.MAX_VALUE)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next)))
+                        .add(cancel)))
                 .addContainerGap())
         );
 
@@ -185,9 +185,9 @@
                 .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
+                    .add(help)
                     .add(cancel)
-                    .add(help))
+                    .add(next))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -26,9 +26,9 @@
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
                       <EmptySpace pref="171" max="32767" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
@@ -42,9 +42,9 @@
               <Component id="jScrollPane1" pref="229" max="32767" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/export/ExportMngViewB.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -73,9 +73,9 @@
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(help)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
-                        .add(cancel)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next)))
+                        .add(cancel)))
                 .addContainerGap())
         );
 
@@ -88,9 +88,9 @@
                 .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 229, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
+                    .add(help)
                     .add(cancel)
-                    .add(help))
+                    .add(next))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/login/AuthView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/AuthView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -36,9 +36,9 @@
                       </Group>
                   </Group>
                   <Group type="102" alignment="1" attributes="0">
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="discard" linkSize="1" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
@@ -60,8 +60,8 @@
               </Group>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/login/AuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/AuthView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -81,9 +81,9 @@
                             .add(password, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 223, Short.MAX_VALUE)
                             .add(user, 0, 223, Short.MAX_VALUE)))
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(discard)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next)))
+                        .add(discard)))
                 .addContainerGap())
         );
 
@@ -102,8 +102,8 @@
                     .add(password, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
-                    .add(discard))
+                    .add(discard)
+                    .add(next))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/login/ItemView2.form
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemView2.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/ItemView2.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -24,9 +24,9 @@
                   <Group type="102" alignment="0" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
                       <EmptySpace pref="171" max="32767" attributes="0"/>
+                      <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="discard" linkSize="3" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -40,9 +40,9 @@
               <Component id="jTabbedPane1" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/login/ItemView2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/ItemView2.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -226,9 +226,9 @@
                     .add(layout.createSequentialGroup()
                         .add(help)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 171, Short.MAX_VALUE)
-                        .add(discard)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next)))
+                        .add(discard)))
                 .addContainerGap())
         );
 
@@ -241,9 +241,9 @@
                 .add(jTabbedPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
+                    .add(help)
                     .add(discard)
-                    .add(help))
+                    .add(next))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -66,9 +66,9 @@
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
                       <EmptySpace pref="126" max="32767" attributes="0"/>
+                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="discard" linkSize="1" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -82,9 +82,9 @@
               <Component id="jScrollPane1" pref="214" max="32767" attributes="0"/>
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="discard" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -99,9 +99,9 @@
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(help)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 126, Short.MAX_VALUE)
-                        .add(discard)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next)))
+                        .add(discard)))
                 .addContainerGap())
         );
 
@@ -114,9 +114,9 @@
                 .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 214, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
+                    .add(help)
                     .add(discard)
-                    .add(help))
+                    .add(next))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/common/DefaultExceptionHandler.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -79,7 +79,7 @@
 			Exception e, 
 			String title, 
 			boolean doNotOfferReconnect) {
-//		e.printStackTrace();//FIXME - print to log perhaps!
+		e.printStackTrace();//FIXME - print to log perhaps!
 		boolean isReconnectReasonable = false;
 		String problemDescription = e.getMessage();
 		

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -76,6 +76,7 @@
             <Property name="foreground" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
               <Color blue="0" green="0" red="0" type="rgb"/>
             </Property>
+            <Property name="indeterminate" type="boolean" value="true"/>
           </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>

Modified: trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java
===================================================================
--- trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/common/SimpleProgressBar2.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -76,6 +76,7 @@
         setUndecorated(true);
         jPanel1.setBorder(javax.swing.BorderFactory.createLineBorder(new java.awt.Color(0, 0, 0)));
         progress.setForeground(new java.awt.Color(0, 0, 0));
+        progress.setIndeterminate(true);
 
         cancel.setText(L10n.getString("Common.Cancel"));
 
@@ -140,7 +141,7 @@
                 		public void run() {
                 			setCursor(Cursor.getPredefinedCursor(Cursor.WAIT_CURSOR));
                 			cancel.setCursor(Cursor.getPredefinedCursor(Cursor.DEFAULT_CURSOR));
-                			progress.setIndeterminate(true);
+                			//progress.setIndeterminate(true);
                 	        setVisible(true);
                 		}
                 	});
@@ -148,8 +149,10 @@
                 case LENGTH_CHANGED:
                     SwingUtilities.invokeLater(new Runnable() {
                         public void run() {
-                            if(progress.isIndeterminate())
+                            if(progress.isIndeterminate()) {
                                 progress.setIndeterminate(false);
+                                progress.setMinimum(0);
+                            }
                             progress.setMaximum(monitoredTask.getLength());
                         }
                     });

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-05 23:11:49 UTC (rev 699)
@@ -28,9 +28,9 @@
                   <Group type="102" alignment="1" attributes="1">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
                       <EmptySpace pref="191" max="32767" attributes="0"/>
+                      <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="3" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
                   </Group>
                   <Component id="plantloreLogo" alignment="0" pref="408" max="32767" attributes="2"/>
               </Group>
@@ -47,9 +47,9 @@
               <Component id="choicePane" min="-2" pref="174" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
-                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-05 20:38:04 UTC (rev 698)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-05 23:11:49 UTC (rev 699)
@@ -313,9 +313,9 @@
                     .add(layout.createSequentialGroup()
                         .add(help)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 191, Short.MAX_VALUE)
-                        .add(cancel)
+                        .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(next))
+                        .add(cancel))
                     .add(org.jdesktop.layout.GroupLayout.LEADING, plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE))
                 .addContainerGap())
         );
@@ -331,9 +331,9 @@
                 .add(choicePane, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 174, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(next)
                     .add(help)
-                    .add(cancel))
+                    .add(cancel)
+                    .add(next))
                 .addContainerGap())
         );
         pack();



From fraktalek at mail.berlios.de  Wed Sep  6 01:44:09 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 01:44:09 +0200
Subject: [Plantlore-dev] r700 - in trunk/src/net/sf/plantlore/client: .
	overview
Message-ID: <200609052344.k85Ni9OW021299@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 01:44:01 +0200 (Wed, 06 Sep 2006)
New Revision: 700

Modified:
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
   trunk/src/net/sf/plantlore/client/overview/AddEditView.form
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
Log:
Removed load gps from file stuff from AddEdit.
Fixed the altitude, latitude, longitude value entering.

Overview table now has white background.
Fixed exception handling in AddAction.



Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-05 23:44:01 UTC (rev 700)
@@ -228,8 +228,6 @@
         if (tableSorter != null)
         {
             logger.info("Setting records per page NN to "+recordsPerPage);
-            if (recordsPerPage == -1)
-                throw new IllegalArgumentException("KURVA");
             tableSorter.setPageSize(recordsPerPage);
         }
     }

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-05 23:44:01 UTC (rev 700)
@@ -7,6 +7,7 @@
 
 package net.sf.plantlore.client;
 
+import java.awt.Color;
 import java.awt.Component;
 import java.awt.Cursor;
 import java.awt.Dimension;
@@ -409,8 +410,14 @@
 	}
 
 	private void setDatabaseDependentCommandsEnabled(boolean enabled) {
-		if( enabled )
+		if( enabled ) {
 			view.overviewScrollPane.setViewportView( view.overview );
+                        view.overviewScrollPane.getViewport().setBackground(Color.WHITE);        
+                } else {
+                    view.overviewScrollPane.getViewport().setBackground(Color.LIGHT_GRAY);    
+                    //javax.swing.UIManager.getDefaults().getColor("Button.background")
+                }
+
 		settingsAction.setEnabled(enabled);
 		printAction.setEnabled(enabled);
 		exportAction.setEnabled(enabled);
@@ -698,12 +705,8 @@
 					return;
 				}
 			} catch (RemoteException ex) {
-				JOptionPane.showMessageDialog(view, L10n
-						.getString("Error.RemoteException")
-						+ "\n" + ex.getMessage(), L10n
-						.getString("Error.RemoteExceptionTitle"),
-						JOptionPane.WARNING_MESSAGE);
-				logger.error(ex);
+                            DefaultExceptionHandler.handle(view, ex);
+                            return;
 			}
 			addModel.clear();
 			addView.setVisible(true);
@@ -1464,7 +1467,7 @@
 				if (i > MAX_RECORDS_PER_PAGE) {
 					JOptionPane.showMessageDialog(view, L10n
 							.getString("Overview.Warning.MaxRecordsPerPage")
-							+ " " + MAX_RECORDS_PER_PAGE);
+							+ " " + MAX_RECORDS_PER_PAGE, L10n.getString("Overview.Warning.MaxRecordsPerPageTitle"),JOptionPane.INFORMATION_MESSAGE);
 					Object obj = e.getOldValue();                                        
 					if (obj != null) 
 						tf.setValue(obj);
@@ -1680,7 +1683,7 @@
 			 * Do some more work here (switch the enabled/disabled menu items,
 			 * etc.)
 			 */
-
+                        
                         setDatabaseDependentCommandsEnabled(false);
 		}
 

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-05 23:44:01 UTC (rev 700)
@@ -537,7 +537,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="367" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="295" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-05 23:44:01 UTC (rev 700)
@@ -6,21 +6,30 @@
 
 package net.sf.plantlore.client;
 
+import java.awt.Color;
 import java.awt.Dimension;
 import java.awt.event.ActionListener;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
+import java.text.ParseException;
 import java.util.Observable;
 import java.util.Observer;
 import java.util.prefs.Preferences;
 import javax.swing.AbstractAction;
 import javax.swing.Action;
+import javax.swing.JFormattedTextField;
 import javax.swing.ListSelectionModel;
 import javax.swing.SwingUtilities;
 import javax.swing.event.ListSelectionListener;
 import javax.swing.table.TableColumn;
+import javax.swing.text.AttributeSet;
+import javax.swing.text.BadLocationException;
+import javax.swing.text.DefaultFormatterFactory;
+import javax.swing.text.MaskFormatter;
+import javax.swing.text.PlainDocument;
 import net.sf.plantlore.client.overview.*;
 import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.common.StatusBarManager;
 import net.sf.plantlore.l10n.L10n;
@@ -60,7 +69,7 @@
         progressBar.setVisible(false);
         progressBar.setBorderPainted(false);
     }
-    
+
     /** This method is called from within the constructor to
      * initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is
@@ -255,7 +264,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 439, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");
@@ -517,6 +526,7 @@
         recordsPerPage.setValue(new Integer(model.getRecordsPerPage()));  
         overview.getSelectionModel().setSelectionInterval(0,0);
         overview.setAutoCreateColumnsFromModel(true);
+        overviewScrollPane.getViewport().setBackground(Color.WHITE);        
     }
 
     /** Returns the main window <code>StatusBarManager</code>.

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-09-05 23:44:01 UTC (rev 700)
@@ -286,6 +286,7 @@
             oldColor = view.altitudeTextField.getForeground();
             nf.setMaximumFractionDigits(MAXIMUM_FRACTION_DIGITS);
             nf.setMaximumIntegerDigits(MAXIMUM_INTEGER_DIGITS);
+            nf.setGroupingUsed(false);
         }
 
         public void processEvent(DocumentEvent e) {
@@ -340,10 +341,10 @@
             oldColor = view.latitudeTextField.getForeground();
             nf.setMaximumFractionDigits(MAXIMUM_FRACTION_DIGITS);
             nf.setMaximumIntegerDigits(MAXIMUM_INTEGER_DIGITS);
+            nf.setGroupingUsed(false);
         }
 
         public void processEvent(DocumentEvent e) {
-            System.out.println("LATITUDE old COLOR = "+oldColor);
             if (e.getDocument().getLength() == 0) {
                 model.setLatitude(null);
                 return;
@@ -395,6 +396,7 @@
             oldColor = view.longitudeTextField.getForeground();
             nf.setMaximumFractionDigits(MAXIMUM_FRACTION_DIGITS);
             nf.setMaximumIntegerDigits(MAXIMUM_INTEGER_DIGITS);
+            nf.setGroupingUsed(false);
         }
 
         public void processEvent(DocumentEvent e) {

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-05 23:44:01 UTC (rev 700)
@@ -4,6 +4,43 @@
   <NonVisualComponents>
     <Component class="javax.swing.ButtonGroup" name="convertCoordinatesGroup">
     </Component>
+    <Component class="javax.swing.JButton" name="gpsLoadButton">
+      <Properties>
+        <Property name="text" type="java.lang.String" value="Load"/>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JButton" name="gpsShowButton">
+      <Properties>
+        <Property name="text" type="java.lang.String" value="Show"/>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JTextField" name="gpsSymbolTextField">
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JLabel" name="gpsSymbolLabel">
+      <Properties>
+        <Property name="text" type="java.lang.String" value="Symbol:"/>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Component class="javax.swing.JLabel" name="gpsTableLabel">
+      <Properties>
+        <Property name="text" type="java.lang.String" value="GPS table:"/>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
   </NonVisualComponents>
   <Properties>
     <Property name="defaultCloseOperation" type="int" value="2"/>
@@ -86,7 +123,7 @@
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Component id="jPanel7" alignment="0" min="-2" max="-2" attributes="3"/>
-                              <Component id="jPanel5" alignment="0" min="-2" pref="914" max="-2" attributes="1"/>
+                              <Component id="jPanel5" alignment="0" min="-2" max="-2" attributes="1"/>
                           </Group>
                           <EmptySpace max="32767" attributes="0"/>
                       </Group>
@@ -169,7 +206,7 @@
                                                       <EmptySpace min="-2" pref="434" max="-2" attributes="0"/>
                                                   </Group>
                                                   <Group type="102" attributes="0">
-                                                      <Component id="jScrollPane2" pref="561" max="32767" attributes="1"/>
+                                                      <Component id="jScrollPane2" pref="572" max="32767" attributes="1"/>
                                                       <EmptySpace max="-2" attributes="0"/>
                                                   </Group>
                                               </Group>
@@ -378,43 +415,27 @@
                               <Group type="102" attributes="0">
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Group type="103" groupAlignment="0" attributes="0">
-                                      <Component id="gpsLoadButton" linkSize="16" min="-2" max="-2" attributes="0"/>
-                                      <Component id="gpsShowButton" linkSize="16" alignment="0" min="-2" max="-2" attributes="0"/>
-                                  </Group>
-                                  <EmptySpace max="-2" attributes="0"/>
-                                  <Group type="103" groupAlignment="0" attributes="0">
-                                      <Group type="102" alignment="0" attributes="0">
-                                          <Component id="gpsSymbolLabel" min="-2" max="-2" attributes="0"/>
-                                          <EmptySpace max="-2" attributes="0"/>
-                                          <Component id="gpsSymbolTextField" linkSize="18" pref="80" max="32767" attributes="1"/>
-                                          <EmptySpace min="-2" pref="39" max="-2" attributes="0"/>
+                                      <Group type="102" attributes="0">
                                           <Component id="latitudeLabel" min="-2" max="-2" attributes="0"/>
                                           <EmptySpace min="-2" pref="4" max="-2" attributes="0"/>
+                                          <Component id="latitudeTextField" linkSize="22" min="-2" pref="153" max="-2" attributes="1"/>
                                       </Group>
-                                      <Group type="102" alignment="0" attributes="0">
-                                          <Component id="gpsTableLabel" min="-2" max="-2" attributes="0"/>
-                                          <EmptySpace min="-2" pref="155" max="-2" attributes="0"/>
-                                      </Group>
+                                      <Component id="coordinateSystemLabel" alignment="0" min="-2" max="-2" attributes="0"/>
                                   </Group>
-                                  <Group type="103" groupAlignment="0" max="-2" attributes="0">
-                                      <Group type="102" alignment="0" attributes="0">
-                                          <Component id="latitudeTextField" linkSize="18" min="-2" pref="80" max="-2" attributes="1"/>
-                                          <EmptySpace max="-2" attributes="0"/>
+                                  <EmptySpace min="-2" pref="21" max="-2" attributes="0"/>
+                                  <Group type="103" groupAlignment="1" attributes="0">
+                                      <Group type="102" attributes="0">
                                           <Component id="longitudeLabel" min="-2" max="-2" attributes="0"/>
                                           <EmptySpace max="-2" attributes="0"/>
-                                          <Component id="longitudeTextField" linkSize="18" min="-2" pref="80" max="-2" attributes="1"/>
-                                          <EmptySpace max="-2" attributes="0"/>
-                                          <Component id="altitudeLabel" min="-2" max="-2" attributes="0"/>
-                                          <EmptySpace max="-2" attributes="0"/>
-                                          <Component id="altitudeTextField" linkSize="18" min="-2" pref="80" max="-2" attributes="1"/>
+                                          <Component id="longitudeTextField" linkSize="22" min="-2" pref="144" max="-2" attributes="1"/>
                                       </Group>
-                                      <Group type="102" alignment="0" attributes="1">
-                                          <Component id="coordinateSystemLabel" min="-2" max="-2" attributes="0"/>
-                                          <EmptySpace max="32767" attributes="0"/>
-                                          <Component id="gpsChangeButton" linkSize="16" min="-2" max="-2" attributes="1"/>
-                                      </Group>
+                                      <Component id="gpsChangeButton" min="-2" max="-2" attributes="1"/>
                                   </Group>
-                                  <EmptySpace min="-2" max="-2" attributes="0"/>
+                                  <EmptySpace min="-2" pref="32" max="-2" attributes="0"/>
+                                  <Component id="altitudeLabel" min="-2" max="-2" attributes="0"/>
+                                  <EmptySpace max="-2" attributes="0"/>
+                                  <Component id="altitudeTextField" linkSize="22" pref="165" max="32767" attributes="1"/>
+                                  <EmptySpace max="-2" attributes="0"/>
                               </Group>
                           </Group>
                         </DimensionLayout>
@@ -422,22 +443,17 @@
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Group type="102" attributes="0">
                                   <Group type="103" groupAlignment="3" attributes="0">
-                                      <Component id="gpsLoadButton" linkSize="17" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="gpsSymbolLabel" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="gpsSymbolTextField" alignment="3" min="-2" max="-2" attributes="0"/>
+                                      <Component id="altitudeLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                                      <Component id="latitudeLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                                       <Component id="latitudeTextField" alignment="3" min="-2" max="-2" attributes="0"/>
                                       <Component id="longitudeLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                                       <Component id="longitudeTextField" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="altitudeLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                                       <Component id="altitudeTextField" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="latitudeLabel" alignment="3" min="-2" max="-2" attributes="0"/>
                                   </Group>
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Group type="103" groupAlignment="3" attributes="0">
-                                      <Component id="gpsShowButton" linkSize="17" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="gpsTableLabel" alignment="3" min="-2" max="-2" attributes="0"/>
-                                      <Component id="gpsChangeButton" alignment="3" min="-2" max="-2" attributes="0"/>
                                       <Component id="coordinateSystemLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                                      <Component id="gpsChangeButton" alignment="3" min="-2" max="-2" attributes="0"/>
                                   </Group>
                               </Group>
                           </Group>
@@ -493,43 +509,6 @@
                             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
                           </AuxValues>
                         </Component>
-                        <Component class="javax.swing.JButton" name="gpsLoadButton">
-                          <Properties>
-                            <Property name="text" type="java.lang.String" value="Load"/>
-                          </Properties>
-                          <AuxValues>
-                            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                          </AuxValues>
-                        </Component>
-                        <Component class="javax.swing.JButton" name="gpsShowButton">
-                          <Properties>
-                            <Property name="text" type="java.lang.String" value="Show"/>
-                          </Properties>
-                          <AuxValues>
-                            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                          </AuxValues>
-                        </Component>
-                        <Component class="javax.swing.JTextField" name="gpsSymbolTextField">
-                          <AuxValues>
-                            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                          </AuxValues>
-                        </Component>
-                        <Component class="javax.swing.JLabel" name="gpsSymbolLabel">
-                          <Properties>
-                            <Property name="text" type="java.lang.String" value="Symbol:"/>
-                          </Properties>
-                          <AuxValues>
-                            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                          </AuxValues>
-                        </Component>
-                        <Component class="javax.swing.JLabel" name="gpsTableLabel">
-                          <Properties>
-                            <Property name="text" type="java.lang.String" value="GPS table:"/>
-                          </Properties>
-                          <AuxValues>
-                            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-                          </AuxValues>
-                        </Component>
                         <Component class="javax.swing.JLabel" name="coordinateSystemLabel">
                           <Properties>
                             <Property name="text" type="java.lang.String" value="Coordinate system:"/>

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-05 23:11:49 UTC (rev 699)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-05 23:44:01 UTC (rev 700)
@@ -75,6 +75,7 @@
         
         numberFormat.setMaximumFractionDigits(AddEditCtrl.MAXIMUM_FRACTION_DIGITS);
         numberFormat.setMaximumIntegerDigits(AddEditCtrl.MAXIMUM_INTEGER_DIGITS);
+        numberFormat.setGroupingUsed(false);
         this.model = model;
         model.addObserver(this);
         this.inEditMode = edit;
@@ -108,6 +109,11 @@
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
         convertCoordinatesGroup = new javax.swing.ButtonGroup();
+        gpsLoadButton = new javax.swing.JButton();
+        gpsShowButton = new javax.swing.JButton();
+        gpsSymbolTextField = new javax.swing.JTextField();
+        gpsSymbolLabel = new javax.swing.JLabel();
+        gpsTableLabel = new javax.swing.JLabel();
         jScrollPane8 = new javax.swing.JScrollPane();
         topPanel = new javax.swing.JPanel();
         basicPanel = new javax.swing.JPanel();
@@ -133,11 +139,6 @@
         altitudeTextField = new javax.swing.JTextField();
         latitudeTextField = new javax.swing.JTextField();
         longitudeTextField = new javax.swing.JTextField();
-        gpsLoadButton = new javax.swing.JButton();
-        gpsShowButton = new javax.swing.JButton();
-        gpsSymbolTextField = new javax.swing.JTextField();
-        gpsSymbolLabel = new javax.swing.JLabel();
-        gpsTableLabel = new javax.swing.JLabel();
         coordinateSystemLabel = new javax.swing.JLabel();
         gpsChangeButton = new javax.swing.JButton();
         locationNoteLabel = new javax.swing.JLabel();
@@ -184,6 +185,11 @@
         jScrollPane6 = new javax.swing.JScrollPane();
         occurrenceTable = new javax.swing.JTable();
 
+        gpsLoadButton.setText("Load");
+        gpsShowButton.setText("Show");
+        gpsSymbolLabel.setText("Symbol:");
+        gpsTableLabel.setText("GPS table:");
+
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         jScrollPane8.setPreferredSize(new java.awt.Dimension(920, 685));
         topPanel.setLayout(new java.awt.BorderLayout());
@@ -236,14 +242,6 @@
 
         latitudeTextField.setNextFocusableComponent(longitudeTextField);
 
-        gpsLoadButton.setText("Load");
-
-        gpsShowButton.setText("Show");
-
-        gpsSymbolLabel.setText("Symbol:");
-
-        gpsTableLabel.setText("GPS table:");
-
         coordinateSystemLabel.setText("Coordinate system:");
 
         gpsChangeButton.setText("Change");
@@ -255,65 +253,43 @@
             .add(gpsPanelLayout.createSequentialGroup()
                 .addContainerGap()
                 .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(gpsLoadButton)
-                    .add(gpsShowButton))
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(gpsPanelLayout.createSequentialGroup()
-                        .add(gpsSymbolLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(gpsSymbolTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 80, Short.MAX_VALUE)
-                        .add(39, 39, 39)
                         .add(latitudeLabel)
-                        .add(4, 4, 4))
+                        .add(4, 4, 4)
+                        .add(latitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 153, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(coordinateSystemLabel))
+                .add(21, 21, 21)
+                .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                     .add(gpsPanelLayout.createSequentialGroup()
-                        .add(gpsTableLabel)
-                        .add(155, 155, 155)))
-                .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
-                    .add(gpsPanelLayout.createSequentialGroup()
-                        .add(latitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(longitudeLabel)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(longitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(altitudeLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(altitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                    .add(gpsPanelLayout.createSequentialGroup()
-                        .add(coordinateSystemLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                        .add(gpsChangeButton)))
+                        .add(longitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 144, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(gpsChangeButton))
+                .add(32, 32, 32)
+                .add(altitudeLabel)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(altitudeTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 165, Short.MAX_VALUE)
                 .addContainerGap())
         );
 
-        gpsPanelLayout.linkSize(new java.awt.Component[] {gpsChangeButton, gpsLoadButton, gpsShowButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+        gpsPanelLayout.linkSize(new java.awt.Component[] {altitudeTextField, latitudeTextField, longitudeTextField}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
 
-        gpsPanelLayout.linkSize(new java.awt.Component[] {altitudeTextField, gpsSymbolTextField, latitudeTextField, longitudeTextField}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
-
         gpsPanelLayout.setVerticalGroup(
             gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(gpsPanelLayout.createSequentialGroup()
                 .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(gpsLoadButton)
-                    .add(gpsSymbolLabel)
-                    .add(gpsSymbolTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                    .add(altitudeLabel)
+                    .add(latitudeLabel)
                     .add(latitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                     .add(longitudeLabel)
                     .add(longitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(altitudeLabel)
-                    .add(altitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(latitudeLabel))
+                    .add(altitudeTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(gpsPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(gpsShowButton)
-                    .add(gpsTableLabel)
-                    .add(gpsChangeButton)
-                    .add(coordinateSystemLabel)))
+                    .add(coordinateSystemLabel)
+                    .add(gpsChangeButton)))
         );
 
-        gpsPanelLayout.linkSize(new java.awt.Component[] {gpsLoadButton, gpsShowButton}, org.jdesktop.layout.GroupLayout.VERTICAL);
-
         locationNoteLabel.setText("Location note:");
 
         locationNoteArea.setColumns(20);
@@ -366,7 +342,7 @@
                                         .add(placeDescriptionLabel)
                                         .add(434, 434, 434))
                                     .add(jPanel5Layout.createSequentialGroup()
-                                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 541, Short.MAX_VALUE)
+                                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 572, Short.MAX_VALUE)
                                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                                 .add(jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                                     .add(locationNoteLabel)
@@ -558,10 +534,10 @@
                         .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jPanel7Layout.createSequentialGroup()
                                 .add(checklistButton)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 340, Short.MAX_VALUE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 232, Short.MAX_VALUE)
                                 .add(clearOccurrenceButton))
                             .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 658, Short.MAX_VALUE))
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 645, Short.MAX_VALUE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7Layout.createSequentialGroup()
@@ -572,11 +548,11 @@
                             .add(herbariumLabel))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(herbariumTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 146, Short.MAX_VALUE)
-                            .add(publicationCombo, 0, 146, Short.MAX_VALUE)
-                            .add(projectCombo, 0, 146, Short.MAX_VALUE)
+                            .add(herbariumTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 132, Short.MAX_VALUE)
+                            .add(publicationCombo, 0, 132, Short.MAX_VALUE)
+                            .add(projectCombo, 0, 132, Short.MAX_VALUE)
                             .add(jPanel7Layout.createSequentialGroup()
-                                .add(sourceCombo, 0, 146, Short.MAX_VALUE)
+                                .add(sourceCombo, 0, 132, Short.MAX_VALUE)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                         .add(19, 19, 19))
                     .add(jPanel7Layout.createSequentialGroup()
@@ -680,7 +656,7 @@
                 .add(settingsButton)
                 .add(64, 64, 64)
                 .add(requiredInfoLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 436, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 350, Short.MAX_VALUE)
                 .add(okButton)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancelButton)
@@ -699,7 +675,7 @@
                     .add(cancelButton)
                     .add(okButton)
                     .add(requiredInfoLabel))
-                .addContainerGap(16, Short.MAX_VALUE))
+                .addContainerGap(13, Short.MAX_VALUE))
         );
 
         buttonPanelLayout.linkSize(new java.awt.Component[] {cancelButton, helpButton, okButton}, org.jdesktop.layout.GroupLayout.VERTICAL);
@@ -742,7 +718,7 @@
             extendedPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(extendedPanelLayout.createSequentialGroup()
                 .addContainerGap()
-                .add(jScrollPane6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 905, Short.MAX_VALUE)
+                .add(jScrollPane6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 906, Short.MAX_VALUE)
                 .addContainerGap())
         );
         extendedPanelLayout.setVerticalGroup(



From fraktalek at mail.berlios.de  Wed Sep  6 02:02:00 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 02:02:00 +0200
Subject: [Plantlore-dev] r701 -
	trunk/src/net/sf/plantlore/client/overview/detail
Message-ID: <200609060002.k86020w0023625@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 02:00:08 +0200 (Wed, 06 Sep 2006)
New Revision: 701

Modified:
   trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form
   trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
Log:
"Nicer" detail.



Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form	2006-09-05 23:44:01 UTC (rev 700)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form	2006-09-06 00:00:08 UTC (rev 701)
@@ -3,6 +3,9 @@
 <Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
   <Properties>
     <Property name="defaultCloseOperation" type="int" value="2"/>
+    <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+      <Color blue="ee" green="ee" id="Button.background" palette="3" red="ee" type="palette"/>
+    </Property>
   </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
@@ -18,21 +21,10 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" attributes="0">
+          <Group type="102" alignment="1" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="103" groupAlignment="1" attributes="0">
                   <Component id="jScrollPane1" alignment="1" pref="667" max="32767" attributes="0"/>
-                  <Component id="jPanel1" alignment="0" min="-2" max="-2" attributes="0"/>
-                  <Group type="102" alignment="0" attributes="0">
-                      <Component id="taxonLabel" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="577" max="32767" attributes="0"/>
-                      <Component id="projectLabel" min="-2" max="-2" attributes="0"/>
-                  </Group>
-                  <Group type="102" alignment="1" attributes="0">
-                      <Component id="sourceLabel" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="577" max="32767" attributes="0"/>
-                      <Component id="herbariumLabel" min="-2" max="-2" attributes="0"/>
-                  </Group>
                   <Component id="jPanel4" alignment="1" max="32767" attributes="0"/>
                   <Group type="102" alignment="0" attributes="0">
                       <Component id="prevButton" min="-2" max="-2" attributes="0"/>
@@ -40,6 +32,7 @@
                       <Component id="jPanel3" max="32767" attributes="0"/>
                   </Group>
                   <Component id="jPanel2" alignment="0" max="32767" attributes="0"/>
+                  <Component id="jPanel1" alignment="1" max="32767" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -49,19 +42,8 @@
       <Group type="103" groupAlignment="0" attributes="0">
           <Group type="102" alignment="0" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jPanel1" min="-2" max="-2" attributes="0"/>
-                  <Group type="103" groupAlignment="3" attributes="0">
-                      <Component id="taxonLabel" alignment="3" min="-2" max="-2" attributes="0"/>
-                      <Component id="projectLabel" alignment="3" min="-2" max="-2" attributes="0"/>
-                  </Group>
-              </Group>
+              <Component id="jPanel1" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="herbariumLabel" min="-2" max="-2" attributes="0"/>
-                  <Component id="sourceLabel" min="-2" max="-2" attributes="0"/>
-              </Group>
-              <EmptySpace min="-2" pref="14" max="-2" attributes="0"/>
               <Component id="jScrollPane1" min="-2" pref="85" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Component id="jPanel2" min="-2" max="-2" attributes="0"/>
@@ -79,19 +61,78 @@
   </Layout>
   <SubComponents>
     <Container class="javax.swing.JPanel" name="jPanel1">
+      <Properties>
+        <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+          <Color blue="ff" green="ff" red="ff" type="rgb"/>
+        </Property>
+        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+          <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
+            <TitledBorder/>
+          </Border>
+        </Property>
+      </Properties>
 
       <Layout>
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
-              <EmptySpace min="0" pref="0" max="32767" attributes="0"/>
+              <Group type="102" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="0" attributes="0">
+                      <Group type="102" alignment="0" attributes="0">
+                          <Component id="taxonLabel" min="-2" max="-2" attributes="0"/>
+                          <EmptySpace pref="543" max="32767" attributes="0"/>
+                          <Component id="projectLabel" min="-2" max="-2" attributes="0"/>
+                      </Group>
+                      <Group type="102" alignment="0" attributes="0">
+                          <Component id="sourceLabel" min="-2" max="-2" attributes="0"/>
+                          <EmptySpace pref="543" max="32767" attributes="0"/>
+                          <Component id="herbariumLabel" min="-2" max="-2" attributes="0"/>
+                      </Group>
+                  </Group>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <EmptySpace min="0" pref="0" max="32767" attributes="0"/>
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="3" attributes="0">
+                      <Component id="taxonLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                      <Component id="projectLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  </Group>
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="3" attributes="0">
+                      <Component id="sourceLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                      <Component id="herbariumLabel" alignment="3" min="-2" max="-2" attributes="0"/>
+                  </Group>
+                  <EmptySpace max="32767" attributes="0"/>
+              </Group>
           </Group>
         </DimensionLayout>
       </Layout>
+      <SubComponents>
+        <Component class="javax.swing.JLabel" name="sourceLabel">
+          <Properties>
+            <Property name="text" type="java.lang.String" value="jLabel1"/>
+          </Properties>
+        </Component>
+        <Component class="javax.swing.JLabel" name="taxonLabel">
+          <Properties>
+            <Property name="text" type="java.lang.String" value="jLabel1"/>
+          </Properties>
+        </Component>
+        <Component class="javax.swing.JLabel" name="projectLabel">
+          <Properties>
+            <Property name="text" type="java.lang.String" value="jLabel1"/>
+          </Properties>
+        </Component>
+        <Component class="javax.swing.JLabel" name="herbariumLabel">
+          <Properties>
+            <Property name="text" type="java.lang.String" value="jLabel1"/>
+          </Properties>
+        </Component>
+      </SubComponents>
     </Container>
     <Container class="javax.swing.JScrollPane" name="jScrollPane1">
       <AuxValues>
@@ -113,16 +154,6 @@
         </Component>
       </SubComponents>
     </Container>
-    <Component class="javax.swing.JLabel" name="taxonLabel">
-      <Properties>
-        <Property name="text" type="java.lang.String" value="jLabel1"/>
-      </Properties>
-    </Component>
-    <Component class="javax.swing.JLabel" name="projectLabel">
-      <Properties>
-        <Property name="text" type="java.lang.String" value="jLabel1"/>
-      </Properties>
-    </Component>
     <Container class="javax.swing.JPanel" name="jPanel2">
       <Properties>
         <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
@@ -159,6 +190,16 @@
       </Layout>
       <SubComponents>
         <Container class="javax.swing.JPanel" name="jPanel5">
+          <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ff" green="ff" red="ff" type="rgb"/>
+            </Property>
+            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+              <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
+                <TitledBorder/>
+              </Border>
+            </Property>
+          </Properties>
 
           <Layout>
             <DimensionLayout dim="0">
@@ -176,7 +217,7 @@
                           <Component id="phytLabel" alignment="0" min="-2" max="-2" attributes="0"/>
                           <Component id="villageLabel" alignment="0" min="-2" max="-2" attributes="0"/>
                       </Group>
-                      <EmptySpace pref="323" max="32767" attributes="0"/>
+                      <EmptySpace pref="313" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -282,7 +323,7 @@
             <DimensionLayout dim="1">
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" alignment="1" attributes="0">
-                      <EmptySpace max="32767" attributes="0"/>
+                      <EmptySpace pref="22" max="32767" attributes="0"/>
                       <Component id="descAreaLabel" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jScrollPane2" min="-2" max="-2" attributes="0"/>
@@ -378,16 +419,6 @@
         </Container>
       </SubComponents>
     </Container>
-    <Component class="javax.swing.JLabel" name="herbariumLabel">
-      <Properties>
-        <Property name="text" type="java.lang.String" value="jLabel1"/>
-      </Properties>
-    </Component>
-    <Component class="javax.swing.JLabel" name="sourceLabel">
-      <Properties>
-        <Property name="text" type="java.lang.String" value="jLabel1"/>
-      </Properties>
-    </Component>
     <Container class="javax.swing.JPanel" name="jPanel3">
 
       <Layout>
@@ -418,6 +449,9 @@
     </Container>
     <Container class="javax.swing.JPanel" name="jPanel4">
       <Properties>
+        <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+          <Color blue="ff" green="ff" red="ff" type="rgb"/>
+        </Property>
         <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
           <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
             <TitledBorder/>

Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-05 23:44:01 UTC (rev 700)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-06 00:00:08 UTC (rev 701)
@@ -6,6 +6,7 @@
 
 package net.sf.plantlore.client.overview.detail;
 
+import java.awt.Color;
 import java.text.DateFormat;
 import java.util.Calendar;
 import java.util.Date;
@@ -34,6 +35,8 @@
         
         new DefaultEscapeKeyPressed(this);
         setLocationRelativeTo(parent);
+        setTitle(L10n.getString("Overview.DetailTitle"));
+        jScrollPane1.getViewport().setBackground(Color.WHITE);
     }
     
     /** This method is called from within the constructor to
@@ -44,10 +47,12 @@
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
         jPanel1 = new javax.swing.JPanel();
+        sourceLabel = new javax.swing.JLabel();
+        taxonLabel = new javax.swing.JLabel();
+        projectLabel = new javax.swing.JLabel();
+        herbariumLabel = new javax.swing.JLabel();
         jScrollPane1 = new javax.swing.JScrollPane();
         authorTable = new javax.swing.JTable();
-        taxonLabel = new javax.swing.JLabel();
-        projectLabel = new javax.swing.JLabel();
         jPanel2 = new javax.swing.JPanel();
         jPanel5 = new javax.swing.JPanel();
         territoryLabel = new javax.swing.JLabel();
@@ -69,8 +74,6 @@
         occAreaLabel = new javax.swing.JLabel();
         jScrollPane3 = new javax.swing.JScrollPane();
         occNoteArea = new javax.swing.JTextArea();
-        herbariumLabel = new javax.swing.JLabel();
-        sourceLabel = new javax.swing.JLabel();
         jPanel3 = new javax.swing.JPanel();
         nextButton = new javax.swing.JButton();
         jPanel4 = new javax.swing.JPanel();
@@ -81,15 +84,46 @@
         prevButton = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        setBackground(javax.swing.UIManager.getDefaults().getColor("Button.background"));
+        jPanel1.setBackground(new java.awt.Color(255, 255, 255));
+        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
+        sourceLabel.setText("jLabel1");
+
+        taxonLabel.setText("jLabel1");
+
+        projectLabel.setText("jLabel1");
+
+        herbariumLabel.setText("jLabel1");
+
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
         jPanel1.setLayout(jPanel1Layout);
         jPanel1Layout.setHorizontalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 0, Short.MAX_VALUE)
+            .add(jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jPanel1Layout.createSequentialGroup()
+                        .add(taxonLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 543, Short.MAX_VALUE)
+                        .add(projectLabel))
+                    .add(jPanel1Layout.createSequentialGroup()
+                        .add(sourceLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 543, Short.MAX_VALUE)
+                        .add(herbariumLabel)))
+                .addContainerGap())
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 0, Short.MAX_VALUE)
+            .add(jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(taxonLabel)
+                    .add(projectLabel))
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(sourceLabel)
+                    .add(herbariumLabel))
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
         authorTable.setModel(new javax.swing.table.DefaultTableModel(
@@ -102,11 +136,9 @@
         ));
         jScrollPane1.setViewportView(authorTable);
 
-        taxonLabel.setText("jLabel1");
-
-        projectLabel.setText("jLabel1");
-
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
+        jPanel5.setBackground(new java.awt.Color(255, 255, 255));
+        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
         territoryLabel.setText("jLabel1");
 
         quadrantLabel.setText("jLabel1");
@@ -141,7 +173,7 @@
                     .add(quadrantLabel)
                     .add(phytLabel)
                     .add(villageLabel))
-                .addContainerGap(323, Short.MAX_VALUE))
+                .addContainerGap(313, Short.MAX_VALUE))
         );
         jPanel5Layout.setVerticalGroup(
             jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -215,7 +247,7 @@
         jPanel6Layout.setVerticalGroup(
             jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel6Layout.createSequentialGroup()
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .addContainerGap(22, Short.MAX_VALUE)
                 .add(descAreaLabel)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jScrollPane2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
@@ -250,10 +282,6 @@
                 .addContainerGap())
         );
 
-        herbariumLabel.setText("jLabel1");
-
-        sourceLabel.setText("jLabel1");
-
         nextButton.setText("jButton2");
 
         org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
@@ -269,6 +297,7 @@
             .add(nextButton)
         );
 
+        jPanel4.setBackground(new java.awt.Color(255, 255, 255));
         jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
         createdWhoLabel.setText("jLabel1");
 
@@ -315,41 +344,25 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 667, Short.MAX_VALUE)
-                    .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(layout.createSequentialGroup()
-                        .add(taxonLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 577, Short.MAX_VALUE)
-                        .add(projectLabel))
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(sourceLabel)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 577, Short.MAX_VALUE)
-                        .add(herbariumLabel))
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(layout.createSequentialGroup()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 667, Short.MAX_VALUE)
+                    .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, layout.createSequentialGroup()
                         .add(prevButton)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-                    .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                        .add(taxonLabel)
-                        .add(projectLabel)))
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(herbariumLabel)
-                    .add(sourceLabel))
-                .add(14, 14, 14)
                 .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 85, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)



From lada at mail.berlios.de  Wed Sep  6 03:04:36 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 03:04:36 +0200
Subject: [Plantlore-dev] r702 - trunk/src/net/sf/plantlore/client/user
Message-ID: <200609060104.k8614arm004178@sheep.berlios.de>

Author: lada
Date: 2006-09-06 03:03:35 +0200 (Wed, 06 Sep 2006)
New Revision: 702

Modified:
   trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
   trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
Log:
Creating user with connection to server is working now.
Repair saving user into GroupingUserList in add/edit dialog.

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java	2006-09-06 00:00:08 UTC (rev 701)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java	2006-09-06 01:03:35 UTC (rev 702)
@@ -123,8 +123,8 @@
                    model.getUserRecord().setAddress(view.addressText.getText());                  
                    model.getUserRecord().setNote(view.noteText.getText());
                    //Right
-                   Right right = model.getUserRecord().getRight();                   
-                   right.setEditGroup(model.getEditGroupID());                   
+                   Right right = model.getUserRecord().getRight();                      
+                   right.setEditGroup(model.getEditGroupID());                     
                    if (view.administratorCheckBox.isSelected()) {
                        right.setAdministrator(1);
                    } else {
@@ -134,8 +134,7 @@
                        right.setEditAll(1);
                    } else {
                        right.setEditAll(0);
-                   }
-                   //FIXME: rozmyslet nejake chytre oznacovani aneb pokud mohu editovat vse, tak je jasne, ze mohu editovat i svoje, atd.
+                   }                  
                                 
                    if (view.addRightCheckBox.isSelected()) {
                        right.setAdd(1);
@@ -162,14 +161,15 @@
         }
 
         public void focusLost(FocusEvent e) {
-            ArrayList<String> userList = new ArrayList<String>();
+            ArrayList<String> userGroupList = new ArrayList<String>();
             AutoTextArea ta = (AutoTextArea) e.getSource();
             int lineCount = ta.getLineCount();
             for (int i=0; i < lineCount; i++) {
-                String tmp = ta.getLine(i);
+                String tmp = ta.getLine(i);                
                 if (tmp.length() > 1) 
-                    userList.add(tmp);
-            }            
+                    userGroupList.add(tmp);                   
+            }       
+            model.setUserGroupList(userGroupList);
         }
     }
     

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-06 00:00:08 UTC (rev 701)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-06 01:03:35 UTC (rev 702)
@@ -126,7 +126,7 @@
          Pair<String, Integer>[] users = model.getUsers();
          String[] choices = new String[users.length];
          for (int i = 0; i < users.length; i++) {
-             choices[i] = users[i].getFirst();
+             choices[i] = users[i].getFirst();             
          }
          ((AutoTextArea)editGroupTextArea).setChoices(choices);
      }

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-06 00:00:08 UTC (rev 701)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-06 01:03:35 UTC (rev 702)
@@ -93,6 +93,8 @@
     private Pair<String, Integer>[] users = null;
     /** List of all used login */
     private ArrayList<String> userLogin = new ArrayList<String>(); 
+    /** */
+    private ArrayList<String> userGroupList = new ArrayList<String>();
     
     /** Constants used for identification of fields for sorting */
     public static final int SORT_LOGIN = 0;
@@ -343,10 +345,12 @@
     			try {
     				boolean isAdmin = false;
     				if (right.getAdministrator() == 1) isAdmin = true;
+                                logger.debug("Create user: "+ userRecord.getLogin());
     				//Create database user
     				database.createUser(userRecord.getLogin(), getPassword(), isAdmin); 
     				//Insert information about user into tRight, tUser
-    				right = (Right)database.executeInsert(right);                               
+    				right = (Right)database.executeInsertInTransaction(right);  
+                                userRecord.setRight(right);
                                 database.executeInsertInTransaction(userRecord);		                                
                                 //Add new name (login) of user to user list    	            
                                 int count = users.length;
@@ -355,9 +359,9 @@
                                     usersNew[i] = users[i];                                    
                                 }
                                 usersNew[count] = new Pair(userRecord.getWholeName()+ " (" + userRecord.getLogin() + " )", userRecord.getId());
-                                logger.debug(userRecord.getId());
-                                //TODO overit, zda znam cID nebo je zjistit jinak ... pravdepodobne se rovna count+1    	            
+                                logger.debug(userRecord.getId());                                    	            
                                 users = usersNew;
+                                userLogin.add(userRecord.getLogin());
                         }catch (Exception e) {
                                 logger.error("Process add User failed. Exception caught in UserManager. Details: "+e.getMessage());
                                 database.rollbackTransaction();	                               
@@ -380,7 +384,7 @@
     public Task editUserRecord() {       
            	
     	final Task task = new Task() {    		    		
-    		public Object task() throws DBLayerException, RemoteException {
+    		public Object task() throws Exception {
     			
     			boolean ok = false;
     			ok = database.beginTransaction();
@@ -400,15 +404,8 @@
     				//Edit information about user in database                                
     				database.executeUpdateInTransaction(userRecord.getRight());                                
                                 database.executeUpdateInTransaction(userRecord);                                 
-                                userList.set(idRecord, userRecord);                                  
-                                // Update list of names (logins) of users                                
-                                //logger.debug("Edit user - before update user list");
-                                //Pair<String, Integer> userTmp = users[userRecord.getId()];
-                                //userTmp.setFirst(userRecord.getWholeName()+ " (" + userRecord.getLogin() + " )");
-                                //logger.debug(userTmp.getFirst());
-                                //users[userRecord.getId()] = userTmp; 
-                                //logger.debug("Edit user - after update user list");
-		        }catch (RemoteException e) {
+                                userList.set(idRecord, userRecord);                                                                    
+		        }catch (Exception e) {
 		        	logger.error("Process update User failed. Remote exception caught in UserManager. Details: "+e.getMessage());
 		        	database.rollbackTransaction();		        	                       
                                 throw e; 		            
@@ -578,9 +575,9 @@
      */
     public String getEditGroupID() {
         ArrayList<Integer> tmpUserId = new ArrayList<Integer>();
-        for (int i=0 ; i < userList.size() ; i++) {
+        for (int i=0 ; i < userGroupList.size() ; i++) {
             for (int j=0; j < users.length; j++) {
-                if (users[j].getFirst().equals(userList.get(i))) {
+                if (users[j].getFirst().equals(userGroupList.get(i))) {
                     Integer userId = users[j].getSecond();
                     //Check duplicity
                     if (!tmpUserId.contains(userId)) {
@@ -598,6 +595,10 @@
     }
  
     
+    public void setUserGroupList(ArrayList<String> userGroupList) {
+        this.userGroupList = userGroupList;
+    }
+    
     /**
      * Set new list of pair (name of user(login), index of user).
      * @param usersNew ist of pair (name of user(login), index of user)

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-06 00:00:08 UTC (rev 701)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-06 01:03:35 UTC (rev 702)
@@ -85,7 +85,7 @@
     public void reloadData(int fromRow, int countRow) {
     	try {
             model.processResult(fromRow, countRow);     
-            view.tableUserList.setModel(new UserManagerTableModel(model));
+            view.tableUserList.setModel(new UserManagerTableModel(model));            
             int from = model.getCurrentFirstRow();
             int to = from + view.tableUserList.getRowCount() - 1;
             if (to <= 0 ) {
@@ -334,11 +334,16 @@
                        if (! model.isFinishedTask()) return;
                        model.setInfoFinishedTask(false);
                        //load User
-                       if (model.isError()) return;
-                       view.tableUserList.setModel(new UserManagerTableModel(model));
-                   }
-                   
-               });
+                       model.searchUser(false);                       
+                       if (model.isError()) {
+                           DefaultExceptionHandler.handle(view, model.getException());
+                           model.setError(null);
+                           model.setException(null);
+                           return;
+                       }                        
+                       reloadData(1, model.getDisplayRows());                       
+                   }                                   
+               });                               
                Dispatcher.getDispatcher().dispatch(task, view, false);
 
                



From lada at mail.berlios.de  Wed Sep  6 04:52:38 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 04:52:38 +0200
Subject: [Plantlore-dev] r703 - in trunk/src/net/sf/plantlore:
	client/history client/metadata client/user l10n
Message-ID: <200609060252.k862qcjZ010160@sheep.berlios.de>

Author: lada
Date: 2006-09-06 04:52:16 +0200 (Wed, 06 Sep 2006)
New Revision: 703

Modified:
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
   trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.form
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
   trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.form
   trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.form
   trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
   trunk/src/net/sf/plantlore/client/user/UserManagerView.form
   trunk/src/net/sf/plantlore/client/user/UserManagerView.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
GUI, L10n.

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -96,7 +96,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -106,7 +106,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -36,6 +36,7 @@
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);        
         this.detailsTextArea.setEditable(false);
+        setTitle(L10n.getString("WholeHistory.DetailTitle"));
         setLocationRelativeTo(null);
     }
         
@@ -81,9 +82,9 @@
             .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
         );
 
-        closeButton.setText(L10n.getString("History.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
-        helpButton.setText(L10n.getString("History.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);

Modified: trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -261,11 +261,12 @@
                } else {            	  
             	   logger.debug("Button Cancle was press."); 
                }  
-           } else {                
+           } else {     
+                model.setError(null);
         	Exception ex = model.getException();  
                 ex.printStackTrace();
                 DefaultExceptionHandler.handle(view, ex);                                   
-        	model.setError(null);        	           	  
+        	model.setException(null);
            }
        }
    }

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -332,7 +332,7 @@
         <Component class="javax.swing.JButton" name="previousButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;History.ButtonPrev&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Prev&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -342,7 +342,7 @@
         <Component class="javax.swing.JButton" name="nextButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;History.ButtonNext&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Next&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -423,7 +423,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -433,7 +433,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -46,6 +46,7 @@
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.OCCURRENCE_HISTORY, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.OCCURRENCE_HISTORY, this.helpButton);  
+        setTitle(L10n.getString("RecordHistory.Title"));
         setLocationRelativeTo(null);
     }
     
@@ -240,9 +241,9 @@
         TransferFocus.patch(tableEditList);
         jScrollPane1.setViewportView(tableEditList);
 
-        previousButton.setText(L10n.getString("History.ButtonPrev"));
+        previousButton.setText(L10n.getString("Common.Prev"));
 
-        nextButton.setText(L10n.getString("History.ButtonNext"));
+        nextButton.setText(L10n.getString("Common.Next"));
 
         unselectAllButton.setText(L10n.getString("History.ButtonUnselectAll"));
 
@@ -316,9 +317,9 @@
                 .addContainerGap())
         );
 
-        helpButton.setText(L10n.getString("History.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
-        closeButton.setText(L10n.getString("History.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -154,7 +154,7 @@
         <Component class="javax.swing.JButton" name="previousButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;History.ButtonPrev&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Prev&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -164,7 +164,7 @@
         <Component class="javax.swing.JButton" name="nextButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;History.ButtonNext&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Next&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -257,7 +257,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -267,7 +267,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;History.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -44,6 +44,7 @@
         // Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_DATA, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_DATA, this.helpButton);    
+        setTitle(L10n.getString("WholeHistory.Title"));
         setLocationRelativeTo(null);
     }
     
@@ -130,9 +131,9 @@
         TransferFocus.patch(tableHistoryList);
         jScrollPane1.setViewportView(tableHistoryList);
 
-        previousButton.setText(L10n.getString("History.ButtonPrev"));
+        previousButton.setText(L10n.getString("Common.Prev"));
 
-        nextButton.setText(L10n.getString("History.ButtonNext"));
+        nextButton.setText(L10n.getString("Common.Next"));
 
         clearHistoryButton.setText(L10n.getString("History.Whole.ButtonClearHistory"));
 
@@ -206,9 +207,9 @@
                 .addContainerGap())
         );
 
-        helpButton.setText(L10n.getString("History.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
-        closeButton.setText(L10n.getString("History.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -677,7 +677,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;MetadataManager.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -697,7 +697,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;MetadataManager.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/metadata/AddEditMetadataView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -99,6 +99,7 @@
       * Set add form. 
       */
      public void setAddForm() {
+         setTitle(L10n.getString("MetadataManager.AddTitle"));
          operationButton.setText(L10n.getString("MetadataManager.ButtonAdd"));         
          dateCreateText.setVisible(false);
          dateModifiedText.setVisible(false);  
@@ -124,6 +125,7 @@
       * Set edit form.      
       */
       public void setEditForm() {
+          setTitle(L10n.getString("MetadataManager.EditTitle"));
          operationButton.setText(L10n.getString("MetadataManager.ButtonEdit"));
          dateCreateText.setEditable(false);
          dateModifiedText.setEditable(false);
@@ -135,6 +137,7 @@
       * Set details form.      
       */ 
      public void setDetailsForm() {
+         setTitle(L10n.getString("MetadataManager.DetailTitle"));
        operationButton.setText(L10n.getString("MetadataManager.ButtonOk"));
        operationButton.setVisible(false);
        technicalContactNameText.setEditable(false);
@@ -582,11 +585,11 @@
                 .add(52, 52, 52))
         );
 
-        closeButton.setText(L10n.getString("MetadataManager.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
         operationButton.setText("");
 
-        helpButton.setText(L10n.getString("MetadataManager.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerCtrl.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -109,9 +109,22 @@
            ex.printStackTrace();
            DefaultExceptionHandler.handle(view, ex);         
            return;
-        } 
-       
-    }       
+        }        
+    }     
+    
+     /**
+     * Search and reload new data for displaying in view dialog.   
+     */
+    public void searchReloadData() {
+        model.searchMetadata(false);  
+       if (model.isError()) {
+           DefaultExceptionHandler.handle(view, model.getException());
+            model.setError(null);
+            model.setException(null);            
+           return;
+       }
+       reloadData(1, model.getDisplayRows());
+    }
      
    /**
     *  ActionListener class controlling the <b>PREV</b> button on the form.
@@ -254,14 +267,7 @@
                    if (! model.isFinishedTask()) return;
                    model.setInfoFinishedTask(false);
                      // load metadata
-                   model.searchMetadata(false);  
-                   if (model.isError()) {
-                       DefaultExceptionHandler.handle(view, model.getException());
-                        model.setError(null);
-                        model.setException(null);
-                       return;
-                   }
-                   reloadData(1, model.getDisplayRows());
+                    searchReloadData(); 
                    model.callNotifyObserver();
                 }//afterStopped 		               
            });
@@ -327,14 +333,7 @@
                          if (! model.isFinishedTask()) return;
                          model.setInfoFinishedTask(false);
                           // load metadata
-                           model.searchMetadata(false);  
-                           if (model.isError()) {
-                               DefaultExceptionHandler.handle(view, model.getException());
-                                model.setError(null);
-                                model.setException(null);
-                               return;
-                           }
-                           reloadData(1, model.getDisplayRows());
+                           searchReloadData();
                            model.callNotifyObserver();
                         }//afterStopped 		
                });
@@ -431,15 +430,8 @@
                                             if (! model.isFinishedTask()) return;
                                             model.setInfoFinishedTask(false);
                                             // load metadata
-                                           model.searchMetadata(false);  
-                                           if (model.isError()) {
-                                               DefaultExceptionHandler.handle(view, model.getException());
-                                                model.setError(null);
-                                                model.setException(null);
-                                               return;
-                                           }
-                                           reloadData(1, model.getDisplayRows());
-                                           model.callNotifyObserver();
+                                          searchReloadData();
+                                          model.callNotifyObserver();
         		                }//afterStopped 		   					                                   
                                });
                                Dispatcher.getDispatcher().dispatch(task, view, false);

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -167,7 +167,7 @@
         <Component class="javax.swing.JButton" name="previousButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;MetadataManager.ButtonPrev&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Prev&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -177,7 +177,7 @@
         <Component class="javax.swing.JButton" name="nextButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;MetadataManager.ButtonNext&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Next&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -280,7 +280,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;MetadataManager.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -290,7 +290,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;MetadataManager.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManagerView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -47,6 +47,7 @@
         //Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.METDATA_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.METDATA_MANAGER, this.helpButton);    
+        setTitle(L10n.getString("MetadataManager.Title"));
         setSizeRestrictions();
         setLocationRelativeTo(null);
     }
@@ -269,9 +270,9 @@
         TransferFocus.patch(tableMetadataList);
         jScrollPane1.setViewportView(tableMetadataList);
 
-        previousButton.setText(L10n.getString("MetadataManager.ButtonPrev"));
+        previousButton.setText(L10n.getString("Common.Prev"));
 
-        nextButton.setText(L10n.getString("MetadataManager.ButtonNext"));
+        nextButton.setText(L10n.getString("Common.Next"));
 
         deleteButton.setText(L10n.getString("MetadataManager.ButtonDelete"));
 
@@ -355,9 +356,9 @@
                 .addContainerGap())
         );
 
-        closeButton.setText(L10n.getString("MetadataManager.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
-        helpButton.setText(L10n.getString("MetadataManager.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("MetadataManager.SearchPanel")));
         sourceInstitutionIdLabel.setText(L10n.getString("MetadataManager.SourceInstitutionId") + ": "

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -3,6 +3,9 @@
 <Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
   <Properties>
     <Property name="defaultCloseOperation" type="int" value="2"/>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
+      <Connection code="L10n.getString(&quot;UserManager.AddTitle&quot;)" type="code"/>
+    </Property>
   </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
@@ -509,7 +512,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;UserManager.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
         <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
           <ComponentRef name="helpButton"/>
@@ -522,7 +525,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;UserManager.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
         <Property name="nextFocusableComponent" type="java.awt.Component" editor="org.netbeans.modules.form.ComponentChooserEditor">
           <ComponentRef name="loginText"/>

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -93,7 +93,8 @@
      /**
       * Set add form
       */
-     public void setAddForm() {    	 
+     public void setAddForm() {    
+         setTitle(L10n.getString("UserManager.AddTitle"));
          operationButton.setText(L10n.getString("UserManager.ButtonAdd"));         
          createWhenuser.setText("");        
          dropWhenLabel.setText("");        
@@ -119,6 +120,7 @@
      }
      
       public void setEditForm() {
+          setTitle(L10n.getString("UserManager.EditTitle"));
          operationButton.setText(L10n.getString("UserManager.ButtonEdit"));
          loginText.setEditable(false);
          passwordLabel.setText(L10n.getString("UserManager.Password")+ ": (**) ");
@@ -135,6 +137,7 @@
        * Set Details form       
        */
      public void setDetailsForm() {
+         setTitle(L10n.getString("UserManager.DetailTitle"));
        operationButton.setText(L10n.getString("UserManager.ButtonOk"));
        this.loginText.setEditable(false);
        this.passwordtext.setEditable(false);
@@ -275,6 +278,7 @@
         helpButton = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        setTitle(L10n.getString("UserManager.AddTitle"));
         jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("UserManager.UserDataPanel")));
         loginLabel.setText(L10n.getString("UserManager.Login") + ": (*) ");
 
@@ -466,10 +470,10 @@
         operationButton.setText("");
         operationButton.setNextFocusableComponent(closeButton);
 
-        closeButton.setText(L10n.getString("UserManager.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
         closeButton.setNextFocusableComponent(helpButton);
 
-        helpButton.setText(L10n.getString("UserManager.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
         helpButton.setNextFocusableComponent(loginText);
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerView.form	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerView.form	2006-09-06 02:52:16 UTC (rev 703)
@@ -15,6 +15,9 @@
   </NonVisualComponents>
   <Properties>
     <Property name="defaultCloseOperation" type="int" value="2"/>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
+      <Connection code="L10n.getString(&quot;UserManager.Title&quot;)" type="code"/>
+    </Property>
   </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
@@ -176,7 +179,7 @@
         <Component class="javax.swing.JButton" name="previousButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;UserManager.ButtonPrev&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Prev&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -186,7 +189,7 @@
         <Component class="javax.swing.JButton" name="nextButton">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-              <Connection code="L10n.getString(&quot;UserManager.ButtonNext&quot;)" type="code"/>
+              <Connection code="L10n.getString(&quot;Common.Next&quot;)" type="code"/>
             </Property>
           </Properties>
           <AuxValues>
@@ -289,7 +292,7 @@
     <Component class="javax.swing.JButton" name="closeButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;UserManager.ButtonClose&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Cancel&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>
@@ -299,7 +302,7 @@
     <Component class="javax.swing.JButton" name="helpButton">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
-          <Connection code="L10n.getString(&quot;UserManager.ButtonHelp&quot;)" type="code"/>
+          <Connection code="L10n.getString(&quot;Common.Help&quot;)" type="code"/>
         </Property>
       </Properties>
       <AuxValues>

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerView.java	2006-09-06 02:52:16 UTC (rev 703)
@@ -276,6 +276,7 @@
         showCurrentUserRadioButton = new javax.swing.JRadioButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        setTitle(L10n.getString("UserManager.Title"));
         jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("UserManager.UserList")));
         jScrollPane1.getViewport().setBackground(Color.WHITE);
         tableUserList.setModel(new javax.swing.table.DefaultTableModel(
@@ -292,9 +293,9 @@
         TransferFocus.patch(tableUserList);
         jScrollPane1.setViewportView(tableUserList);
 
-        previousButton.setText(L10n.getString("UserManager.ButtonPrev"));
+        previousButton.setText(L10n.getString("Common.Prev"));
 
-        nextButton.setText(L10n.getString("UserManager.ButtonNext"));
+        nextButton.setText(L10n.getString("Common.Next"));
 
         deleteButton.setText(L10n.getString("UserManager.ButtonDrop"));
 
@@ -378,9 +379,9 @@
                 .addContainerGap())
         );
 
-        closeButton.setText(L10n.getString("UserManager.ButtonClose"));
+        closeButton.setText(L10n.getString("Common.Cancel"));
 
-        helpButton.setText(L10n.getString("UserManager.ButtonHelp"));
+        helpButton.setText(L10n.getString("Common.Help"));
 
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("UserMnager.SearchPanel")));
         wholeNameLabel.setText(L10n.getString("UserManager.Name")+ ": ");

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 02:52:16 UTC (rev 703)
@@ -614,7 +614,7 @@
 Occurrence.publication = Publication
 Occurrence.herbarium = Herbarium
 Occurrence.createdWhen = Created on
-Occurrence.createdWho = Created by
+Occurrence.createdWho = Created byAC
 Occurrence.updatedWhen = Updated on
 Occurrence.updatedWho = Updated by
 Occurrence.metadata = Metadata
@@ -675,11 +675,11 @@
 Information.SearchUserTitle = Search user
 Information.NoUserInResult = No users with the given attributes were found. Please modify search criteria.
 Information.NoUserInResultTitle = No search results 
-Information.UserCannotEditTitle 
-Information.UserCannotEdit
-Information.UserDeleteHimself
-Information.UserDelete
-Information.UserDeleteTitle
+Information.UserCannotEditTitle=Edit user
+Information.UserCannotEdit=You cannot editing user, who has been drop.
+Information.UserDeleteHimself=You are trying drop actual user.\nThis operation is not possible.
+Information.UserDelete=You are trying drop user, who has been drop.\nThis operation is not possible.
+Information.UserDeleteTitle=Drop user
 
 Information.SearchMetadata = No search field has been filled in. All metadata will display.
 Information.SearchMetadataTitle = Search metadata
@@ -1516,3 +1516,137 @@
 AddEdit.LocationNoteLabel=Location note\:
 
 Common.Progress=Operation in progress
+
+UserManager.DetailTitle=User details
+
+UserManager.AddTitle=Add user
+
+UserManager.EditTitle=Edit user
+
+UserManager.Title=User Manager
+
+MetadataManager.Title=Metadata Manager
+
+MetadataManager.AddTitle=Add metadata
+
+MetadataManager.EditTitle=Edit metadata
+
+MetadataManager.DetailTitle=Detail metadata
+
+WholeHistory.Title=History
+
+WholeHistory.DetailTitle=Detail record
+
+RecordHistory.Title=History
+
+MetadataManager.biotopeText=Biotope
+
+wholeHistoryPanel=Whole historz
+
+warningEmptySelection=No record has been selected.\n Please select some record and try again.
+
+VILLAGE.null=Nearest bigger seat
+
+Village=Village
+
+versionPlantsFile=Last version of plants list
+
+Username=Name of user
+
+userManager=User manager
+
+TERRITORY.null=Territory
+
+referenceDetailTitle=Reference detail
+
+referenceDetailLbl=Reference detail
+
+referenceDetail=Reference detail
+
+referenceCitationTitle=Reference citation
+
+referenceCitationLbl=Reference citation
+
+recordCreatedPanel=Record created
+
+PHYTOCHORION.null=Phytochorion
+
+Overview.TransformationInfo=Transformation to the actual setting coordinate system is neadless.
+
+Overview.MenutFileExit=Exit
+
+Overview.MenuDataHistory=History
+
+Overview.MenuAuthorManager=Author manager
+
+OCCURRENCE.null=Occurrence
+
+OCCURRENCE.isoDateTimeBegin=Date and Time of collected
+
+netadata.project=PROJECT
+
+MetadataManager=Metadata manager
+
+metadata.technicalContact=TECHNICAL CONTACT
+
+METADATA.recordBasis=Recordbasis
+
+METADATA.null=Metadata
+
+metadata.institution=INSTITUTION
+
+metadata.contentContact=CONTENT CONTACT
+
+METADATA.biotopeText=Biotope
+
+Login.Database=Database
+
+journalNameTitle=Journal name
+
+journalAuthorTitle=Journal Author
+
+History.DetailsMetadata=Metadata Details
+
+History.DetailsHabitat=Habitat Details
+
+History=History
+
+HABITAT.village=Village
+
+HABITAT.null=Occurrence/Habitat
+
+detailsVillage=Details of Village
+
+detailsTerritory=Details of Territory
+
+detailsRecordPanel=Details of the record
+
+detailsPublication=Details of Publication
+
+detailsPhytochorion=Details of Phytochorion
+
+detailsOccurrence=Details of Occurrence
+
+detailsAuthor=Details of Author
+
+editPublicationBtn=Edit publication
+
+deletePublicationBtn=Delete publication
+
+clearHistoryMessage=All history will be delete.
+
+changesRecordPanel=List of changes
+
+Change=Change
+
+AUTHOROCCURRENCE.null=Occurrence/Author
+
+AUTHOR.role.collect=Collector
+
+AUTHOR.null=Author
+
+Error.HistoryRecordSearchFailed=
+
+Error.HistoryDataSearchFailed=
+
+Error.HistoryObjectSearchFailed=

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 02:52:16 UTC (rev 703)
@@ -78,7 +78,7 @@
 History.Operation3 = Smazat
 
 History.TotalResult = V\u00fdsledk:
-History.RowsToDisplay = Zobrazit ??dk?:
+History.RowsToDisplay = Zobrazit \u0159\u00E1dk\u016F\:
 History.Displayed = Zobrazeno:
 
 History.ColumnX = x
@@ -263,7 +263,7 @@
 MetadataManager.ButtonPrev = P\u0159\u00edchoz\u00ed
 MetadataManager.ButtonNext = N\u00e1sleduj\u00edc\u00ed
 MetadataManager.ButtonSearch = Hledej
-MetadataManager.ButtonHelp = Pomoc
+MetadataManager.ButtonHelp = N\u00E1pov\u011Bda
 MetadataManager.ButtonClose = Zav\u0159i
 MetadataManager.ButtonOk = Ok
 
@@ -280,7 +280,7 @@
 #=============================================================
 
 # Seznam varov\u75a3\ufffd syst\u99d1u
-warningEmptySelection = Nen\ufffd vybr\u75a3 ?\u7586n\ufffd z\u75d9nam.\n Zvolte nejprve n?jak\ufffd z\u75d9nam a zkuste to znovu. 
+warningEmptySelection = Nen\u00ED vybr\u00E1n \u017E\u00E1dn\u00FD z\u00E1znam.\nZvolte nejprve n\u011Bjak\u00FD z\u00E1znam a zkuste to znovu.
 
 warningNoUsername = Nen\u00ED vybr\u00E1no \u017E\u00E1dn\u00E9 jm\u00E9no ze seznamu.
 warningNoUsernameTitle = Nen\u00ED vybr\u00E1no u\u017E. jm\u00E9no.
@@ -359,15 +359,15 @@
 
 publicationUrlTitle=URL
 
-referenceDetail=
+referenceDetail=Reference detail
 
 referenceDetailTitle=Reference detail
 
 referenceCitationTitle=Reference citation
 
-journalAuthorTitle=Journal Author
+journalAuthorTitle=Jm\u00E9no autora
 
-journalNameTitle=Journal name
+journalNameTitle=Jm\u00E9no publikace
 
 publicationYearTitle=Rok publikace
 
@@ -1100,13 +1100,13 @@
 
 Occurrence.timeCollected=\u010Cas
 
-Occurrence.isoDateTimeBegin=Datum v ISO form\u00E1tu
+Occurrence.isoDateTimeBegin=Datum
 
 Occurrence.dataSource=Zdroj
 
 Occurrence.publication=Publikace
 
-Occurrence.herbarium=Herbarium
+Occurrence.herbarium=Herb\u00E1\u0159
 
 Occurrence.createdWhen=Vytvo\u0159eno
 
@@ -1859,3 +1859,115 @@
 Overview.MenuFileCreateDB=Vytvo\u0159it novou datab\u00E1zi
 
 Common.Progress=Dlouhotrvaj\u00EDc\u00ED operace
+
+UserManager.DetailTitle=Detail u\u017Eivatela
+
+UserManager.AddTitle=P\u0159idej u\u017Eivatela
+
+UserManager.EditTitle=Edituj u\u017Eivatela
+
+UserManager.Title=Spr\u00E1va u\u017Eivatel\u016F
+
+MetadataManager.Title=Spr\u00E1va metadat
+
+MetadataManager.AddTitle=P\u0159idej metadata
+
+MetadataManager.EditTitle=Edituj metadata
+
+MetadataManager.DetailTitle=Detail metadat
+
+WholeHistory.Title=Historie
+
+WholeHistory.DetailTitle=Historie - detail z\u00E1znamu
+
+RecordHistory.Title=Historie n\u00E1lezu
+
+MetadataManager.biotopeText=Biotope
+
+Author.TotalResults=V\u00FDsledk\:
+
+Author.DisplayedRowsLabel=Zobrazit \u0159\u00E1dk\u016F\:
+
+wholeHistoryPanel=Historie
+
+VILLAGE.null=Nejbli\u017Es\u00ED v\u011Bt\u0161\u00ED s\u00EDdlo
+
+versionPlantsFile=Pou\u017Eiv\u00E1 verze seznamu kytek
+
+Username=U\u017Eivatelsk\u00E9 jm\u00E9no
+
+TERRITORY.null=Oblast
+
+sortDescending=Sestupn\u011B
+
+sortAscending=Vzestupn\u011B
+
+selectAll=V\u0161e
+
+Question.ClearHistoryMessageTitle=Sma\u017E historii
+
+Question.ClearHistoryMessage=Cel\u00E1 historie bude smaz\u00E1na.\nSmaz\u00E1n\u00EDm historie ztrat\u00EDte mo\u017Enost vr\u00E1tit \nzm\u011Bny proveden\u00E9 na n\u00E1lezov\u00FDch datech.
+
+PHYTOCHORION.null=Fytochoria
+
+Overview.MenuDataHistory=Historie
+
+OCCURRENCE.isoDateTimeBegin=Datum/\u010Das n\u00E1lezu
+
+netadata.project=PROJEKT
+
+metadata.technicalContact=TECHNICK\u00C1 PODPORA
+
+METADATA.recordBasis=Recordbasis
+
+metadata.institution=INSTITUCE
+
+metadata.contentContact=OBSAHOV\u00C1 PODPORA
+
+METADATA.biotopeText=Biotop
+
+Information.SearchUserTitle=Hledej
+
+Information.SearchUser=Nevyplnili jste, \u017E\u00E1dn\u00E9 parametry pro vyhled\u00E1van\u00ED.\nBudou vyhled\u00E1ni v\u0161idhni u\u017Eivatel\u00E9.\n
+
+Information.SearchMetadataTitle=Hledej
+
+Information.SearchMetadata=Nevyplnili jste, \u017E\u00E1dn\u00E9 parametry pro vyhled\u00E1van\u00ED.\nBudou vyhled\u00E1ny v\u0161echny z\u00E1znamy.\n
+
+Information.NoUserInResultTitle=Nebyly nalezeny \u017E\u00E1dn\u00E9 z\u00E1znamy.
+
+Information.NoUserInResult=Nebyl nalezen \u017E\u00E1dn\u00FD u\u017Eivatel.
+
+Information.NoMetadataInResult=Nebyly nalezeny \u017E\u00E1dn\u00E9 z\u00E1znamy.
+
+History=History
+
+HABITAT.null=N\u00E1lez/Lokalita
+
+detailsVillage=Obec-detail
+
+detailsTerritory=Oblast-detail
+
+detailsRecordPanel=Z\u00E1znam-detail
+
+detailsPublication=Publikace-detail
+
+detailsPhytochorion=Fytochorion-detail
+
+detailsOccurrence=N\u00E1lez-detail
+
+detailsAuthor=Autor-detail
+
+clearHistoryMessage=Cel\u00E1 historie bude smaz\u00E1na. \nT\u00EDm ztrat\u00EDte mo\u017Enost se v budoucnu \n\nvr\u00E1tit k proveden\u00FDm zm\u011Bnam v n\u00E1lezov\u00FDch datech.
+
+changesRecordPanel=Seznam zm\u011Bn
+
+Change=Zm\u011Bna
+
+AUTHOR.role.collect=
+
+Error.HistoryRecordSearchFailed=
+
+Error.HistoryDataSearchFailed=
+
+Error.HistoryObjectSearchFailed=

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 01:03:35 UTC (rev 702)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 02:52:16 UTC (rev 703)
@@ -196,7 +196,7 @@
 METADATA.dateCreate = Date creating of project
 METADATA.dateModified = Last modified data in project
 METADATA.recordBasis = Recordbasis
-METADATA.biotopeText = Biotopetest
+METADATA.biotopeText = Biotope
 
 #author - title of column (used in history)
 AUTHOR.null = Author
@@ -208,7 +208,7 @@
 AUTHOR.email = Email of author
 AUTHOR.ulr = Url of author
 AUTHOR.note = Note of autho
-AUTHOR.role.collect = collector
+AUTHOR.role.collect = Collector
 
 #village - title of column (used in history)
 VILLAGE.null = Nearest bigger seat
@@ -278,7 +278,7 @@
 # History - message
 clearHistoryMessage = All history will be delete.
 # LOGIN - AUTHORIZE
-Username = Username
+Username = Name of user
 Change = Change
 
 
@@ -1170,3 +1170,333 @@
 AddEdit.OccurrenceNoteLabel=Occurrence note\:
 
 AddEdit.LocationNoteLabel=Location note\:
+
+UserManager.DetailTitle=User details
+
+UserManager.AddTitle=Add user
+
+UserManager.EditTitle=Edit user
+
+UserManager.Title=User Manager
+
+MetadataManager.Title=Metadata Manager
+
+MetadataManager.AddTitle=Add metadata
+
+MetadataManager.EditTitle=Edit metadata
+
+MetadataManager.DetailTitle=Detail metadata
+
+WholeHistory.Title=History
+
+WholeHistory.DetailTitle=Detail record
+
+RecordHistory.Title=History
+
+MetadataManager.biotopeText=Biotope
+
+History.WhenInsert=Date record creation\:
+
+History.WhoInsert=User who record created\:
+
+History.DetailsOccurrence=Details of Occurrence
+
+History.DetailsPublication=Details of Publication
+
+History.DetailsAuthor=Details of Author
+
+History.DetailsTerritory=Details of Territory
+
+History.DetailsVillage=Details of Village
+
+History.DetailsPhytochorion=Details of Phytochorion
+
+History.DetailsMetadata.Project=PROJECT
+
+History.DetailsMetadata.Institution=INSTITUTION
+
+History.DetailsMetadata.TechnicalContact=TECHNICAL CONTACT
+
+History.DetailsMetadata.ContentContact=CONTENT CONTACT
+
+MetadataManager.TechnicalContactAddress=Technical contact - address
+
+MetadataManager.TechnicalContactEmail=Technical contact - email
+
+MetadataManager.ContentContactName=Content contact
+
+MetadataManager.ContentContactAddress=Content contact address
+
+MetadataManager.ContentContactEmail=Content contact email
+
+MetadataManager.DataSetTitle=Data set
+
+MetadataManager.DataSetDetails=Details
+
+MetadataManager.SourceInstitutionId=Institution
+
+MetadataManager.SourceId=Source
+
+MetadataManager.OwnerOrganizationAbbrev=Organization
+
+MetadataManager.DateCreate=Created on
+
+MetadataManager.DateModified=Modified on
+
+MetadataManager.Recordbasis=Basis
+
+MetadataManager.Note=Note
+
+MetadataManager.ButtonDelete=Delete Metadata
+
+MetadataManager.ButtonAdd=Add Metadata
+
+MetadataManager.ButtonEdit=Edit Metadata
+
+MetadataManager.ButtonDetails=Details of Metadata
+
+MetadataManager.ButtonPrev=Previous
+
+MetadataManager.ButtonNext=Next
+
+MetadataManager.ButtonSearch=Search/Sort
+
+Warning.EmptySelectionTitle=Empty selection...
+
+Warning.EmptySelection=No record has been selected.\n Please select some record and try again.
+
+Village=Village
+
+userManager=User manager
+
+Territory.name=Name
+
+referenceDetail=Reference detail
+
+Plant.taxon=Taxon
+
+Plant.synonyms=Synonyms
+
+Plant.surveyTaxId=Identifier
+
+Plant.species=Species
+
+Plant.scientificNameAuthor=Named by
+
+Plant.note=Note
+
+Plant.genus=Genus
+
+Plant.czechName=Czech name
+
+Plant=Plant
+
+Overview.TableImportTT=Alters records in an immutable table.
+
+Overview.TableImport=Table import
+
+Overview.MenutFileExit=Exit
+
+Overview.MenuFileExit=Exit
+
+Overview.MenuFileCreateDB=Create a new database
+
+Overview.MenuAuthorManager=Author manager
+
+Occurrence.yearCollected=Year
+
+Occurrence.updatedWho=Updated by
+
+Occurrence.updatedWhen=Updated on
+
+Occurrence.unitValue=Unique ID
+
+Occurrence.unitIdDb=Database ID
+
+Occurrence.timeCollected=Time
+
+Occurrence.publication=Publication
+
+Occurrence.plant=Plant
+
+Occurrence.note=Note
+
+Occurrence.monthCollected=Month
+
+Occurrence.metadata=Metadata
+
+Occurrence.isoDateTimeBegin=ISO Date
+
+OCCURRENCE.isoDateTime=Date and Time of collected
+
+Occurrence.herbarium=Herbarium
+
+Occurrence.habitat=Habitat
+
+Occurrence.deleted=Deleted
+
+Occurrence.dayCollected=Day
+
+Occurrence.dataSource=Source
+
+Occurrence.createdWho=Created byAC
+
+Occurrence.createdWhen=Created on
+
+Occurrence=Occurrence
+
+NearestVillage.name=Name
+
+NearestVillage=The nearest bigger seat
+
+MetadataManager.TotalResult=Total results\:
+
+MetadataManager.SortDescending=Descending
+
+MetadataManager.SortAscending=Ascending
+
+MetadataManager.RowToDisplay=Rows to display\:
+
+MetadataManager.DisplayRows=Rows to display
+
+MetadataManager.Displayed=Displayed rows\:
+
+MetadataManager.DataSort=Sort by
+
+MetadataManager.ButtonOk=Ok
+
+MetadataManager.ButtonHelp=Help
+
+MetadataManager.ButtonClose=Close
+
+MetadataManager=Metadata manager
+
+Metadata.technicalContactName=Technical contact
+
+Metadata.technicalContactEmail=Technical contact email
+
+Metadata.technicalContactAddress=Technical contact address
+
+Metadata.sourceInstitutionId=Institution
+
+Metadata.sourceId=Source
+
+Metadata.recordBasis=Basis
+
+Metadata.ownerOrganizationAbbrev=Organization
+
+Metadata.deleted=Deleted
+
+Metadata.dateModified=Modified on
+
+Metadata.dateCreate=Created on
+
+Metadata.dataSetTitle=Data set
+
+Metadata.dataSetDetails=Details
+
+Metadata.contentContactName=Content contact
+
+Metadata.contentContactEmail=Content contact email
+
+Metadata.contentContactAddress=Content contact address
+
+Metadata.biotopeText=Biotop
+
+Metadata=Metadata
+
+Login.UserNameTT=The name of the account in the database.
+
+Login.UserName=User name
+
+Login.SelectAutomatically=Select automatically.
+
+Login.RemoveRecordTT=Remove the selected record (the database won't be deleted\!).
+
+Login.RemoveRecord=Remove
+
+Information.UserDeleteTitle=Drop user
+
+Information.UserDeleteHimself=You are trying dropu actual user.\nThis operation is not possible.
+
+Information.UserDelete=You are trying drop user, who has been drop.\nThis operation is not possible.
+
+Information.UserCannotEditTitle=Edit user
+
+Information.UserCannotEdit=You cannot editing user, who has been drop.
+
+Information.SearchUserTitle=Search user
+
+Information.SearchUser=No search field has been filled in. All user will display.
+
+Information.SearchMetadataTitle=Search metadata
+
+Information.SearchMetadata=Nevyplnili jste, \u017E\u00E1dn\u00E9 parametry pro vyhled\u00E1van\u00ED.\nBudou vyhled\u00E1ny v\u0161echny z\u00E1znamy.\n
+
+Information.NoUserInResultTitle=No search results 
+
+Information.NoUserInResult=No users with the given attributes were found. Please modify search criteria.
+
+Information.NoMetadataInResult=No metadata with the given attributes were found. Please modify search criteria.
+
+Information.NoConnectionAvailable=The database connection is not available. 
+
+History.DetailsMetadata=Metadata Details
+
+History.DetailsHabitat=Habitat Details
+
+HABITAT.village=Village
+
+Habitat.territory=Territory
+
+Habitat.quadrant=Quadrant
+
+Habitat.phytochorion=Phytochorion
+
+Habitat.note=Note
+
+Habitat.nearestVillage=Nearest bigger seat
+
+Habitat.longitude=Longitude
+
+Habitat.latitude=Latitude
+
+Habitat.description=Description
+
+Habitat.deleted=Deleted
+
+Habitat.country=Country
+
+Habitat.altitude=Altitude
+
+Habitat=Habitat
+
+AuthorOccurrence.role=Role
+
+AuthorOccurrence.occurrence=Occurrence
+
+AuthorOccurrence.note=Note
+
+AuthorOccurrence.deleted=Deleted
+
+AuthorOccurrence.author=Author
+
+AuthorOccurrence=Author-Occurrence
+
+Author.wholeName=Name
+
+Author.url=URL
+
+Author.role=Role
+
+Author.phoneNumber=Phone number
+
+Author.organization=Organization
+
+Author.note=Note
+
+Error.HistoryRecordSearchFailed=
+
+Error.HistoryDataSearchFailed=
+
+Error.HistoryObjectSearchFailed=



From lada at mail.berlios.de  Wed Sep  6 09:54:49 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 09:54:49 +0200
Subject: [Plantlore-dev] r704 - trunk/src/net/sf/plantlore/client/user
Message-ID: <200609060754.k867snUI019863@sheep.berlios.de>

Author: lada
Date: 2006-09-06 09:54:40 +0200 (Wed, 06 Sep 2006)
New Revision: 704

Modified:
   trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
Log:
Check whether login is correctly = containing only char (a-z,A-Z) or digit (0-9)

Modified: trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java	2006-09-06 02:52:16 UTC (rev 703)
+++ trunk/src/net/sf/plantlore/client/user/AddEditUserCtrl.java	2006-09-06 07:54:40 UTC (rev 704)
@@ -69,11 +69,16 @@
                 logger.debug("Add of User.");
                 //check wether all obligatory fields were filled 
                  if (view.checkNotNull()) {
-                     //Check if new name of project (dataSetTitle) already exist
+                    //Check if new name login containing correctly char
+                    if(! model.correctlyLogin(view.loginText.getText())) {
+                        view.showErrorMessage(UserManager.ERROR_TITLE, UserManager.ERROR_CHAR_LOGIN);
+                 		return;
+                    }
+                     //Check if new name of lodin already exist
                  	if (model.uniqueLogin(view.loginText.getText())){                		
                  		view.showErrorMessage(UserManager.ERROR_TITLE, UserManager.ERROR_LOGIN);
                  		return;
-                 	}
+                 	}                                                
                     //create new instance of User and save filed values    
                    User user = new User();                                                                            
                    user.setLogin(view.loginText.getText());

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-06 02:52:16 UTC (rev 703)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-06 07:54:40 UTC (rev 704)
@@ -125,6 +125,7 @@
     public static final String ERROR_CREATE_PAIRS = L10n.getString("Error.UserManagerCreatePairs"); 
     public static final String ERROR_LOGIN = L10n.getString("Error.UserManagerDuplicityLogin");
     public static final String ERROR_REMOTE_EXCEPTION = "REMOTE_EXCEPTION";
+    public static final String ERROR_CHAR_LOGIN = L10n.getString("Error.UserManagerIncorrectlyLogin");
     
     public static final String QUESTION_DELETE_TITLE = L10n.getString("Question.DeleteUserTitle");
     public static final String QUESTION_DELETE = L10n.getString("Question.DeleteUser");
@@ -464,7 +465,7 @@
      */
     public Pair<String, Integer>[] loadLoginUsers() throws Exception{
         if (users == null)
-        {  
+        {              
             SelectQuery sq;
             int resultLoginid;
             int resultsCount;
@@ -501,7 +502,7 @@
      }       
    
     /** 
-     *  Check whther exists login of usr adding by add dialog.
+     *  Check whether exists login of usr adding by add dialog.
      *  @param login login of user adding by add dialog 
      *  @return true if login doesn`t exist yet, false in other way
      */
@@ -510,6 +511,21 @@
     }
     
     /**
+     *  Check whether login containing permissible char (a-z,A-Z,0-9).
+     * @param login login of user additing by add dialog
+     * @return true if login is correctly
+     */
+    public boolean correctlyLogin(String login) {
+       int countChars = login.length();
+       String charTest = "";          
+       for(int i = 0; i < countChars; i++) {
+           char ch = login.charAt( i );
+           if( ! Character.isLetterOrDigit(ch) ) return false;
+        }
+        return true;  
+    }
+    
+    /**
      * Close query.    
      */    
     public void closeQuery() {



From discontinuum at gmail.com  Wed Sep  6 10:03:05 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 10:03:05 +0200
Subject: [Plantlore-dev] Dokumentace
Message-ID: <f4dc39b90609060103y5a593d7v8dda91c2e71b71a5@mail.gmail.com>

Svazujici pravidla pro psani Uzivatelske dokumentace.

Struktura dokumentu je stejna u kazde cast uzivatelske napovedy. Strucna
kostra:


   1. <h1>Vystizny nazev sekce</h1>
   2. <p>K cemu je tato ficura dobra, proc tam je, kdo ji muze pouzit
   (kdo k ni ma pristup), proc k ni nema pristup. Pripadne ustavit
   terminologii.</p>
   3. <h2>Kratky obsah, pokud je soucasti dokumentu vice podsekci<2>
   4. <h2>Podsekce 1</h2>
   5. <h2>Podsekce 2</h2>

Kuprikladu:

<h1>Skrtak</h1>

<p>Skrtak, tez skrtaci seznam, usnadnuje vyber rostlin nalezenych na
zpracovavane lokalite. K dispozici je pouze behem pridavani novych zaznamu.
Blablabla...</p>

<h2>V teto sekci se dozvite, jak</h2>
<p>
<ol>
<li>Pouzivat skrtak
<li>Vytvorit a nahrat vlastni skrtaci seznam
<li>..
</ol>
</p>

<h2>1. Prace se skrtakem</h2

<p>..</p>

<h2>2. Vytvareni a nahravani skrtaciho seznamu</h2>

Cisla u nazvu kapitol by se mela shodovat s tim, co je v obsahu.

Jazyk: Uzivatelska dokumentace se pise v cestine i anglictine. Je-li nekdo
mene zdatny v jednom z obou jazyku (treba proto, ze je Slovak), necha si
nekym dalsim dokument po sobe precist (proof-reading). Bude-li cas, kazdy by
si mohl nechat od nekoho dalsiho overit, zda to, co napsal, je smyslupnle,
bez gramatickych a stylistickych chyb, relevantni a jednoznacne.
V cestine uzivateli vykame: vyberte, oznacte, prubeh procesu muzete
sledovat, ... plantlore v?m umoznuje (nepiseme zdvorilostni dopis, vsechna `
vam` i `vase` jsou s malym pocatecnim pismenem).
V anglictine uzivateli vykame: You can cancel the process, If You are not
sure which file format is most suitable, we recommend....

Ceho se vyvarovat:

   - Opakovani slov a pouzivani "vycpavek", napr. tedy, tak, takze, jen,
   jiz, uz. "upravujete u? existuj?c? publikaci" -> "upravujete
   existuj?c? publikaci" V podstate vsude, kde muzete tato slova smazat,
   aniz by doslo ke zmene vyznamu, to udelejte!
   - Vyhnout se formulacim: "Ur?it? nebude na?kodu zm?nit, kdy m?te pr?vo
   pracovat s histori? n?lezu." -> "S historii nalezu smite pracovat
   pouze v techto pripadech: a) b)..." Jsme neutralni.
   - Uzivatel je rod muzsky, vzor muz. 3. pad uzivateli.
   - Odkazujeme-li se na systemove role, pouzivame velka pismena:
   Administrator (ale: administratorska prava)

Cilem je samosebou minimalizovat pocet vyse zminenych veci, pochybuju, ze se
jich nadobro vsude zbavime.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/3c622aa1/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 10:48:30 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 10:48:30 +0200
Subject: [Plantlore-dev] Programatorska dokumentace
Message-ID: <f4dc39b90609060148l707e0096r3a2186b361b68502@mail.gmail.com>

Svazujici pravidla pro psani programatorske dokumentace

Programatorska dokumentace splnuje nasledujici pravidla:

   - je maximalne popisna, neutralni, neobsahuje zadne osloveni ctenare
   (spatne: You cannot, spravne: The User cannot), pouzivame (je-li to
   nutne) nanejvys oznaceni roli the User, the Administrator.
   - popisuje stavajici techniku nebo algoritmus pouzity pro dosazeni
   dane funkcnosti, jeho celky (vyznamne entity) a jejich interakci, pripadne
   ukazkovy pseudokod pro snazsi pochopeni, jak ho pouzit (nebo jak je to
   pouzivano) - treba schematicky popisu export task, aby bylo videt, kdy se
   volaji metody builderu, nebo popisu proces loginu, jak presne jsou do neho
   zahrnuti ucastnici (jakysi diagram interakce)
   - naopak nepopisuje se GUI! k tomu je uzivatelska dokumentace. v teto
   dokumentaci popisujeme modely. (mozna by se i hodil nejaky uvod do rozdeleni
   trid v plantlore pomoci MVC - co se kde da najit)
   - obsahuje odkazy na dalsi casti programatorske dokumentace, zejmena
   pak na ty, ktere svou cinnosti ovlivnuje, nebo jejichz cinnosti je
   ovlivnena. snaha je maximalne omezit duplicity (tj. napr. ja nebudu u vyberu
   sloupecku v exportu vysvetlovat, na co tam ktery je, k tomu je popis db.
   modelu - ja pouze specifikuji, ktere casti zaznamu lze exportovat)
   - ? obsahuje detailni popis rozhrani (interface), protoze zrovna to je
   to, co by nekdo mohl chtit rozsirovat - treba ja detailne popisu rozhrani
   Builderu, kdyby si nekdo chtel napsat vlastni, aby vedel, jak; tyhle
   informace jsou uz vetsinou kvalitne zapracovany jako javadoc, muzete pouzit.
   - neni ucebnici technologii. popisuje zpusob nasazeni dane technologie
   v nasem projektu (v soucasne dobe je treba v RMI hezka ucebnice, do
   dokumentace nepouzitelne). tj. nevysvetluju, co je codebase, jen poznamenam,
   jak a kdy se nastavuje.
   - 1 dobry obrazek obcas lepsi nez 1 stranka dokumentace
   - rozhodne se nesmi zvrhnout v popis "tahle metoda dela tohle", k tomu
   mame javadoc!

Co bude popsano separatne (JETEL):

   1. celkova architektura aplikace: gui-kontroler-model-komunikacni
   vrstva-databazova vrstva, role serveru  ?
   2. rozdeleni trid, pouziti MVC - "co kde najit a proc" ?
   3. tasky, dispatcher J
   4. exception handling (propagation, translation, presentation) E/J
   5. database model L
   6. database layer T
   7. biocase L
   8. export E
   9. server E
   10. import (table, occurrence) E
   11. checklist E
   12. author, metadata, publication, user - dost podobne TL
   13. settings (kam se co uklada) J
   14. login, reconnect a logout E
   15. print, scheda J
   16. overview J
   17. add, edit J
   18. history L
   19. search J
   20. database creation T

Je tam nak moc E a J (byla svinarna bod 12.)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/0e35eea4/attachment.html>

From discontinuum at gmail.com  Wed Sep  6 11:25:39 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 11:25:39 +0200
Subject: [Plantlore-dev] Dokumentace
In-Reply-To: <f4dc39b90609060103y5a593d7v8dda91c2e71b71a5@mail.gmail.com>
References: <f4dc39b90609060103y5a593d7v8dda91c2e71b71a5@mail.gmail.com>
Message-ID: <f4dc39b90609060225v5c12c1e2l80b1897b5abc3678@mail.gmail.com>

Nazvy obrazku jsou ve formatu SekceXxxxYyyy.png (napr.
ExportColumnSelection.png, LoginAuthorization.png)

On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Svazujici pravidla pro psani Uzivatelske dokumentace.
>
> Struktura dokumentu je stejna u kazde cast uzivatelske napovedy. Strucna
> kostra:
>
>
>    1. <h1>Vystizny nazev sekce</h1>
>    2. <p>K cemu je tato ficura dobra, proc tam je, kdo ji muze pouzit
>    (kdo k ni ma pristup), proc k ni nema pristup. Pripadne ustavit
>    terminologii.</p>
>    3. <h2>Kratky obsah, pokud je soucasti dokumentu vice podsekci<2>
>    4. <h2>Podsekce 1</h2>
>    5. <h2>Podsekce 2</h2>
>
> Kuprikladu:
>
> <h1>Skrtak</h1>
>
> <p>Skrtak, tez skrtaci seznam, usnadnuje vyber rostlin nalezenych na
> zpracovavane lokalite. K dispozici je pouze behem pridavani novych zaznamu.
> Blablabla...</p>
>
> <h2>V teto sekci se dozvite, jak</h2>
> <p>
> <ol>
> <li>Pouzivat skrtak
> <li>Vytvorit a nahrat vlastni skrtaci seznam
> <li>..
> </ol>
> </p>
>
> <h2>1. Prace se skrtakem</h2
>
> <p>..</p>
>
> <h2>2. Vytvareni a nahravani skrtaciho seznamu</h2>
>
> Cisla u nazvu kapitol by se mela shodovat s tim, co je v obsahu.
>
> Jazyk: Uzivatelska dokumentace se pise v cestine i anglictine. Je-li nekdo
> mene zdatny v jednom z obou jazyku (treba proto, ze je Slovak), necha si
> nekym dalsim dokument po sobe precist (proof-reading). Bude-li cas, kazdy
> by si mohl nechat od nekoho dalsiho overit, zda to, co napsal, je
> smyslupnle, bez gramatickych a stylistickych chyb, relevantni a jednoznacne.
>
> V cestine uzivateli vykame: vyberte, oznacte, prubeh procesu muzete
> sledovat, ... plantlore v?m umoznuje (nepiseme zdvorilostni dopis, vsechna
> `vam` i `vase` jsou s malym pocatecnim pismenem).
> V anglictine uzivateli vykame: You can cancel the process, If You are not
> sure which file format is most suitable, we recommend....
>
> Ceho se vyvarovat:
>
>    - Opakovani slov a pouzivani "vycpavek", napr. tedy , tak, takze,
>    jen, jiz, uz. "upravujete u? existuj?c? publikaci " -> "upravujete
>    existuj?c? publikaci" V podstate vsude, kde muzete tato slova
>    smazat, aniz by doslo ke zmene vyznamu, to udelejte!
>    - Vyhnout se formulacim: " Ur?it? nebude na?kodu zm?nit, kdy m?te
>    pr?vo pracovat s histori? n?lezu." -> "S historii nalezu smite
>    pracovat pouze v techto pripadech: a) b)... " Jsme neutralni.
>    - Uzivatel je rod muzsky, vzor muz. 3. pad uzivateli.
>    - Odkazujeme-li se na systemove role, pouzivame velka pismena:
>    Administrator (ale: administratorska prava)
>
> Cilem je samosebou minimalizovat pocet vyse zminenych veci, pochybuju, ze
> se jich nadobro vsude zbavime.
>
>
>
>
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/2e7de6d4/attachment.html>

From fraktalek at mail.berlios.de  Wed Sep  6 11:47:56 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 11:47:56 +0200
Subject: [Plantlore-dev] r705 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609060947.k869luqg000604@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 11:47:55 +0200 (Wed, 06 Sep 2006)
New Revision: 705

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
Log:
Updated author occurrence adding to what history expects.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-06 07:54:40 UTC (rev 704)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-06 09:47:55 UTC (rev 705)
@@ -1121,7 +1121,7 @@
                                     aoTmp.setNote(resultRevision.get(k));
                                     aoTmp.setOccurrence(occTmp);
                                     aoTmp.setDeleted(0);
-                                    database.executeInsertInTransaction(aoTmp);
+                                    database.executeInsertInTransactionHistory(aoTmp);
                                     logger.debug("AuthorOccurrence for "+pTmp.getFirst().getFirst()+" inserted. Id="+aoTmp.getId());
                                     newOccurrenceInserted = true;
                                 }
@@ -1209,7 +1209,7 @@
                                     aoTmp.setNote(resultRevision.get(k));
                                     aoTmp.setOccurrence(occ);
                                     aoTmp.setDeleted(0);
-                                    aoTmp = (AuthorOccurrence)database.executeInsertInTransaction(aoTmp);
+                                    aoTmp = (AuthorOccurrence)database.executeInsertInTransactionHistory(aoTmp);
                                 }//for authorList
                             }// for taxonList                            
                             database.commitTransaction();



From krater at mail.berlios.de  Wed Sep  6 12:01:08 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 12:01:08 +0200
Subject: [Plantlore-dev] r706 - trunk/src/net/sf/plantlore/help/cs/html
Message-ID: <200609061001.k86A189G001463@sheep.berlios.de>

Author: krater
Date: 2006-09-06 12:01:07 +0200 (Wed, 06 Sep 2006)
New Revision: 706

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/export.html
Log:
"The first sparrow". 

Modified: trunk/src/net/sf/plantlore/help/cs/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-06 09:47:55 UTC (rev 705)
+++ trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-06 10:01:07 UTC (rev 706)
@@ -8,35 +8,49 @@
   <body>
   <h1>Export dat</h1>
 	<p>
-	Va?e n?lezov? data jsou p?i pr?ci s Plantlore ukl?d?na do datab?ze. 
-	K datab?zi nelze p?istupovat p??mo a pokud byste cht?li svoje data p?en??et i na jin?
-	po??ta?e, je pot?eba pou??t Export. Export dat slou?? k "vyta?en?" n?lezov?ch dat z datab?ze
-	a ulo?en? do souboru na disku Va?eho po??ta?e.
+	Va?e n?lezov? data jsou p?i pr?ci s Plantlore uchov?v?na v datab?zi. 
+	K dat?m nelze p?istupovat p??mo; pro p?enos sv?ch dat na jin?
+	po??ta?e vy?aduje pou?it? Exportu. 
+	Export dat slou?? k "vyta?en?" n?lezov?ch dat z datab?ze
+	a ulo?en? do souboru na disku va?eho po??ta?e.
 	</p>
 
 	<p>
-	Export lze prov?d?t po p?ipojen? k jak?koli datab?zi - tedy i k datab?zi vzd?len?.
+	Export lze prov?d?t po p?ipojen? k jak?koli datab?zi - i k datab?zi vzd?len?.
 	Tehdy se vyplat? zv??it p?enosovou kapacitu linky, kterou pou??v?te pro p?ipojen?,
-	nebo? se m??e p?en??et velk? mno?stv? dat a doba nutn? k vyexportov?n? n?lezov?ch dat
+	nebo? se m??e p?en??et velk? mno?stv? dat a doba nutn? k proveden? cel? operace
 	by byla ne?nosn?.
 	</p>
 
+	<p>
+	Sou?asn? m??e prob?hat pouze jeden export n?lezov?ch dat.
+	</p>
+	
 
-	<h2>1. D??ve, ne? za?nete exportovat</h2>
+	<h2>Obsah</h2>
 
 	<p>
-	P?ed vlastn?m exportem je nejprve nutn? vybrat (ozna?it) n?lezov? z?znamy, 
+	<ol>
+		<li>1. Co je nutn? prov?st p?ed t?m, ne? za?nete exportovat</li>
+		<li>2. Vlastn? export z?znam?</li>
+	</ol>
+	</p>
+
+
+
+	<h2>1. Co je nutn? prov?st p?ed t?m, ne? za?nete exportovat</h2>
+
+	<p>
+	V <a href="./overview.html">P?ehledu z?znam?</a> je nutn? vybrat (ozna?it) n?lezov? z?znamy, 
 	kter? chcete exportovat. 
-	Pro z??en? okruhu, z n?ho? budete z?znamy vyb?rat, slou?? <a href="./search.html">Vyhled?v?n?</a>.
-	Ve vyhled?vac?m formul??i zad?te po?adovan? kriteria a v 
-	<a href="./overview.html">P?ehledu</a> se zobraz? v?echny relevantn?
-	z?znamy ulo?en? v datab?zi. Z t?chto z?znam? m??ete je?t? explicitn? ozna?it ty, kter? jsou
-	pro v?s d?le?it?. Neozna??te-li ??dn? z?znamy, Plantlore se bude chovat, jako byste ozna?ili
-	v?echny; t?m V?m usnadn? pr?ci s jejich ozna?ov?n?m.
+	Pro z??en? okruhu, z n?ho? budete z?znamy vyb?rat, pou?ijte <a href="./search.html">Vyhled?v?n?</a>.
+	Z t?chto z?znam? m??ete je?t? explicitn? ozna?it ty, kter? jsou d?le?it?. 
+	Neozna??te-li ??dn? z?znamy, Plantlore se bude chovat, jako byste ozna?ili
+	v?echny; t?m v?m usnadn? pr?ci s jejich ozna?ov?n?m.
 	</p>
 
 	<p>
-	Na n?sleduj?c?m obr?zku je ozna?eno 11 z?znam? z devaten?cti.
+	Na n?sleduj?c?m obr?zku je ozna?eno 11 z?znam? z 19. Vyexportov?no bude ozna?en?ch 11 z?znam?.
 	</p>
 
 	<p>
@@ -45,10 +59,10 @@
 
 
 
-	<h2>2. Vlastn? export dat</h2>
+	<h2>2. Vlastn? export z?znam?</h2>
 
 	<p>
-	Export prob?h? ve dvou kroc?ch.
+	Exportov?n? n?lezov?ch dat prob?h? ve dvou kroc?ch.
 	</p>
 
 	<h3>2.1. Volba jm?na souboru a form?tu dat</h3>
@@ -57,33 +71,39 @@
 	Zvolte jm?no souboru, do kter?ho se maj? data ulo?it, a jeho form?t.
 	K dispozici je n?kolik z?kladn?ch form?t?:
 	<ul>
-		<li>PlantloreNative je form?t, kter? je navr?en p??mo pro pohodln? p?enos dat mezi
+		<li>
+		PlantloreNative je form?t, kter? je p??mo navr?en pro pohodln? p?enos dat mezi
 		dv?ma programy Plantlore. Nev?te-li, kter? form?t pro p?enos dat zvolit,
 		doporu?ujeme vybrat tento.
 		</li>
-		<li>XML je form?t vyu??vaj?c? tzv. Extensible Markup Language (XML). Data jsou ukl?d?na v p?ehledn?
+		<li>
+		XML je form?t vyu??vaj?c? tzv. Extensible Markup Language (XML). Data jsou ukl?d?na v p?ehledn?
 		stromov? struktu?e uvozen? tzv. tagy. Form?t nav?c umo??uje v?b?r konkr?tn?ch ??st? z?znamu,
 		kter? chcete exportovat. Tento form?t je vhodn? jak pro p?en??en? dat, tak pro jejich vizualizaci
 		nap?. v programu Internet Explorer.
 		</li>
-		<li>ABCD Schema je form?t zalo?en? na XML, ale struktura se li?? - odpov?d? po?adavk?m kladen?m
+		<li>
+		ABCD Schema je form?t zalo?en? na XML, ale struktura se li?? - odpov?d? po?adavk?m kladen?m
 		na ABCD Schema.
 		</li>
-		<li>DarwinCore je form?t zalo?en? na XML, ale struktura se li?? - odpov?d? po?adavk?m kladen?m
+		<li>
+		DarwinCore je form?t zalo?en? na XML, ale struktura se li?? - odpov?d? po?adavk?m kladen?m
 		na DarwinCore.
 		</li>
-		<li>CSV neboli Comma Separated Values (hodnoty odd?len? ??rkami) je form?t obsahuj?c?
+		<li>
+		CSV neboli Comma Separated Values (hodnoty odd?len? ??rkami) je form?t obsahuj?c?
 		ka?d? z?znam na jednom ??dku, p?i?em? hodnoty sloupe?k? jsou odd?leny ??rkami.
 		Prvn? ??dek obsahuje n?zvy atribut? z?znamu. Struktura souboru p?ipom?n? tabulku.
 		Form?t se hod? pro pohodln? na??t?n? v n?kter?ch jin?ch programech, nap?. tabulkov?ch procesorech
 		jako Microsoft Excel.
 		</li>
-		<li>StdOut neukl?d? z?znamy do souboru, ale na tzv. standardn? v?stup. Data jsou odes?l?na 
+		<li>
+		StdOut neukl?d? z?znamy do souboru, ale na tzv. standardn? v?stup. Data jsou odes?l?na 
 		ve velmi ?iteln? podob?. Tento druh form?tu je ur?en pro testov?n? nebo proudov? zpracov?n?
-		v p??kazov? ??dce nebo shellu. 
+		v p??kazov? ??dce. 
 		</li>
 	</ul>
-	Nejste-li si jisti, kter? form?t je pro V?s ten spr?vn?, doporu?ujeme volit PlantloreNative,
+	Nejste-li si jisti, kter? form?t vybrat, doporu?ujeme volit PlantloreNative,
 	kter? se nejl?pe hod? pro p?enos mezi dv?ma programy Plantlore.
 	</p>
 
@@ -95,13 +115,13 @@
 
 	<p>
 	Tento krok je voliteln? a nab?z? jej pouze form?ty XML, CSV a StdOut. Zbyl? form?ty automaticky exportuj?
-	z?znam se v?emi jeho atributy. Volba atribut? (t?? sloupe?k?) n?lezov?ho z?znamu se prov?d? ozna?ov?n?m
+	z?znam se v?emi jeho atributy. Volba atribut? n?lezov?ho z?znamu se prov?d? ozna?ov?n?m
 	polo?ek v zobrazen?m strom?. ?erven? jsou ozna?eny polo?ky, kter? je nutn? vybrat, pokud budete cht?t
-	data znovu nahr?t do Plantlore (v?ce viz <a href="./import.html">Import</a>).
+	data znovu nahr?t do Plantlore (v?ce viz <a href="./import.html">Import n?lezov?ch dat</a>).
 	</p>
 	
 	<p>
-	Nevyberete-li ??dn? sloupe?ky, p?edpokl?d? se, ?e jste ozna?ili v?echny.
+	Nevyberete-li ??dn? atributy, p?edpokl?d? se, ?e jste ozna?ili v?echny.
 	</p>
 
 	<p>
@@ -109,11 +129,13 @@
 	</p>
 
 
-	<h3>2.3. Export z?znam?</h3>
+	<h3>2.3. Pr?b?h exportu</h3>
 
 	<p>
-	Po dokon?en? v?b?ru atribut? se spust? Export. Pr?b?h procesu m??ete sledovat v otev?en?m okn?.
-	Rozhodnete-li se Export zru?it, stiskn?te tla??tko <i>Storno</i> a export bude p?ed?asn? ukon?en.
+	Po dokon?en? v?b?ru atribut? je zah?jen export dat. Pr?b?h procesu m??ete sledovat v otev?en?m okn?.
+	Rozhodnete-li se export zru?it, stiskn?te tla??tko <i>Storno</i> a export bude p?ed?asn? ukon?en.
+	Soubor bude obsahovat pouze ta data, kter? se stihla zapsat, ne? do?lo ke zru?en? operace.
+	Je zaru?eno, ?e i p?i zru?en? operace bude form?t souboru validn?.
 	</p>
 
 	<p>
@@ -121,15 +143,5 @@
 	<p>
 
 
-
-	<h2>3. Omezen?, kter? je nutno zv??it p?i Exportu</h2>
-
-	<p>
-	Exportovat lze jak?koli n?lezov? data, kter? jste ozna?ili a tedy m?te pr?vo je prohl??et.
-	Pamatujte: <i>nic znamen? v?e</i> - neozna??te-li explicitn? ??dn? z?znamy nebo sloupe?ky, Plantlore
-	se chov?, jako byste vybrali v?echny. 
-	Sou?asn? m??e prob?hat v jedn? instanci programu Plantlore pouze jeden Export n?lezov?ch dat.
-	</p>
-  
   </body>
 </html>



From kovo at mail.berlios.de  Wed Sep  6 16:34:30 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 16:34:30 +0200
Subject: [Plantlore-dev] r707 - trunk/installer
Message-ID: <200609061434.k86EYU8B003458@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 16:34:29 +0200 (Wed, 06 Sep 2006)
New Revision: 707

Modified:
   trunk/installer/userInputLang.xml_cze
Log:
Encoding fixed in the czech language file

Modified: trunk/installer/userInputLang.xml_cze
===================================================================
--- trunk/installer/userInputLang.xml_cze	2006-09-06 10:01:07 UTC (rev 706)
+++ trunk/installer/userInputLang.xml_cze	2006-09-06 14:34:29 UTC (rev 707)
@@ -1,19 +1,19 @@
 <?xml version="1.0" encoding="utf-8" standalone="yes" ?>
 <langpack>
     <str id="title.PostgreSQL" txt="Detaily instalace PostgreSQL"/>
-    <str id="serviceaccount.description" txt="Datab?zov? syst?m PostgreSQL mus? b??et v opera?n?m syst?mu pod u?ivatelsk?m ??tem s omezen?mi pr?vy. Zadejte jm?no a heslo pro tohoto u?ivatele a instal?tor ho pro V?s vytvo??. Ujist?te se, ?e zadan? jm?no u?ivatele je v syst?mu unik?tn?"/>
-    <str id="serviceaccount.text" txt="Jm?no: "/>
+    <str id="serviceaccount.description" txt="Datab??zov?? syst??m PostgreSQL mus?? b????et v opera??n??m syst??mu pod u??ivatelsk??m ????tem s omezen??mi pr??vy. Zadejte jm??no a heslo pro tohoto u??ivatele a instal??tor ho pro V??s vytvo????. Ujist??te se, ??e zadan?? jm??no u??ivatele je v syst??mu unik??tn??"/>
+    <str id="serviceaccount.text" txt="Jm??no: "/>
     <str id="servicepassword.text" txt="Heslo: "/>
 
-    <str id="superuser.description" txt="Pro pou??v?n? syst?mu PostgreSQL mus?te vytvo?it prvn?ho datab?zov?ho u?ivatele pomoc? kter?ho se po prv? p?ihl?s?te do Plantlore. Potom bude mo?n? pomoc? klienta Plantlore spravovat dal?? datab?zov? u?ivatele."/>
-    <str id="superuser.text" txt="Jm?no: "/>
+    <str id="superuser.description" txt="Pro pou????v??n?? syst??mu PostgreSQL mus??te vytvo??it prvn??ho datab??zov??ho u??ivatele pomoc?? kter??ho se po prv?? p??ihl??s??te do Plantlore. Potom bude mo??n?? pomoc?? klienta Plantlore spravovat dal???? datab??zov?? u??ivatele."/>
+    <str id="superuser.text" txt="Jm??no: "/>
     <str id="superpassword.text" txt="Heslo: "/>
 
-    <str id="portnumber.text" txt="??slo portu: "/>
+    <str id="portnumber.text" txt="????slo portu: "/>
 
-    <str id="postgreshortcuts.description" txt="Vyberte jestli maj? b?t vytvo?eny odkazy na syst?m PostgreSQL v Start menu"/>
-    <str id="postgreshortcuts.create" txt="Vytvo?it odkazy"/>
+    <str id="postgreshortcuts.description" txt="Vyberte jestli maj?? b??t vytvo??eny odkazy na syst??m PostgreSQL v Start menu"/>
+    <str id="postgreshortcuts.create" txt="Vytvo??it odkazy"/>
 
-    <str id="postgrehome.description" txt="Czech:Pros?m vyberte adres?? do kter?ho bude syst?m PostgreSQL nainstalov?n. Tento adres?? mus? b?t na diskov?m odd?lu form?tu NTFS. Podrobn? informace najdete v instala?n? p??ru?ce p?ilo?en? k tomuto instal?toru."/>
-    <str id="postgrehome.text" txt="PostgreSQL adres??: "/>
+    <str id="postgrehome.description" txt="Pros??m vyberte adres???? do kter??ho bude syst??m PostgreSQL nainstalov??n. Tento adres???? mus?? b??t na diskov??m odd??lu form??tu NTFS. Podrobn?? informace najdete v instala??n?? p????ru??ce p??ilo??en?? k tomuto instal??toru."/>
+    <str id="postgrehome.text" txt="PostgreSQL adres????: "/>
 </langpack>
\ No newline at end of file



From kovo at mail.berlios.de  Wed Sep  6 16:38:14 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 16:38:14 +0200
Subject: [Plantlore-dev] r708 - in trunk/src/net/sf/plantlore:
	client/createdb common/exception l10n server
Message-ID: <200609061438.k86EcEL3003968@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 16:38:13 +0200 (Wed, 06 Sep 2006)
New Revision: 708

Modified:
   trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Create database updated. It is possible to create more databases now. Create DB GUI modified a little (only postgresql database system can be used)

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-06 14:38:13 UTC (rev 708)
@@ -15,6 +15,7 @@
 import net.sf.plantlore.client.login.Login;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
+import org.hibernate.JDBCException;
 
 /**
  * CreateDB is a CreationTask factory. 
@@ -47,7 +48,6 @@
 	
 	private MainConfig config;
 	private DBInfo info;
-	private boolean leaveEmpty = false;
 	private DBLayerFactory factory = null;
 	private DBLayer currentDBLayer; 
 		        
@@ -69,9 +69,8 @@
 	 * @param identifier	The name of the database that will be created.
 	 * @param leaveEmpty		True if the immutable tables shall remain empty. 
 	 */
-	public void setDBInfo(String alias, String engine, int port, String identifier, boolean leaveEmpty) {
+	public void setDBInfo(String alias, String engine, int port, String identifier) {
 		info = new DBInfo(alias, null, 0, engine, port, identifier, "", new String[Login.MAX_NAMES]);
-		this.leaveEmpty = leaveEmpty; 
 	}
 	
 	/**
@@ -104,7 +103,7 @@
 	public synchronized Task createCreationTask(String username, String password) {
 		// Set the first user name to the Administrator of the database.
 		info.getUsers()[0] = username;
-		return new CreationTask(info, username, password, leaveEmpty);
+		return new CreationTask(info, username, password);
 	}
 	
 	
@@ -131,106 +130,96 @@
 		 * @param password	The password protecting that account.
 		 * @param leaveEmpty		Leave the immutable tables empty (do not fill them).
 		 */
-		public CreationTask(DBInfo dbinfo, String name, String password, boolean leaveEmpty) {
+		public CreationTask(DBInfo dbinfo, String name, String password) {
 			this.dbinfo = dbinfo;
 			this.name = name;
 			this.password = password;
-			this.leaveEmpty = leaveEmpty;
 		}
 		
-		@Override
-		public Object task() throws Exception {
-			
-			try {
-				if(isCanceled()) {
-					throw new Exception(L10n.getString("Common.Canceled"));
-                                }				
-                                                               
-				// Create a new database layer ~ ask the DBLayerFactory to create it for us..
-				logger.debug("Asking the DBLayerFactory for a new DBLayer @ " + dbinfo.getHost() + ":" + dbinfo.getPort());
-				setStatusMessage(L10n.getString("Login.Connecting") );
-                                factory = RMIDBLayerFactory.getDBLayerFactory();
-				currentDBLayer = factory.create(dbinfo);
-				if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }		
-                                logger.debug("Connection successful.");
-				
-				// Initialize the database layer.
-				setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
-				logger.debug("Initializing that DBLayer.");				
-                                // Connect to template1 database. TODO: this should not be hardcoded
-				currentDBLayer.initializeNewDB("template1", name, password);
-				if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
-				logger.debug("Initialization successful. Connected to template1 database");
-                                
-                                // Create users in the database
-                                setStatusMessage(L10n.getString("CreateDB.CreatingUsers") );                                
-                                currentDBLayer.executeSQLScript(DBLayer.CREATE_USERS, dbinfo.getDatabaseIdentifier(), name, password);
-                                logger.debug("Database "+dbinfo.getDatabaseIdentifier()+" users created successfuly");
-                                
-                                // Create new database
-                                setStatusMessage(L10n.getString("CreateDB.CreatingDatabase") );                                
-                                currentDBLayer.createDatabase(dbinfo.getDatabaseIdentifier());
-                                logger.debug("New database created succesfully");
-
-                                // Disconnect - destroy DBLayer
-                                factory.destroy(currentDBLayer);
-                                logger.debug("Disconnected from the database template1");
-                                
-                                // Connect to the newly created database
-				currentDBLayer = factory.create(dbinfo);
-				if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }
-				logger.debug("Connection successful.");
-				setStatusMessage( L10n.getString("Login.Connected") );
-				
-				// Initialize the database layer.
-				setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
-				logger.debug("Initializing that DBLayer.");
-				
-				currentDBLayer.initializeNewDB(dbinfo.getDatabaseIdentifier(), name, password);
-				if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
-				logger.debug("Initialization successful. Connected to database "+dbinfo.getDatabaseIdentifier());
-                                
-                                // Create tables in the new database
-				setStatusMessage(L10n.getString("CreateDB.CreatingTables"));                                
-                                currentDBLayer.executeSQLScript(DBLayer.CREATE_TABLES, dbinfo.getDatabaseIdentifier(), name, password);
-                                logger.debug("New database tables created");
-                                // Disconnect - destroy DBLayer
-                                factory.destroy(currentDBLayer);
-                                logger.debug("Disconnected from the database "+dbinfo.getDatabaseIdentifier());
-                                
-				/*
-				 * TODO:
-				 * 
-				 * HERE GOES YOUR CODE THAT PERFORMS 
-				 * 1. THE CONNECTION TO THE DATABASE ENGINE
-				 *    You should use inormation stored in dbinfo and the stored name and password.
-				 *    See HibernateDBLayer.initialize().
-				 * 2. THE CREATION OF THE NEW DATABASE
-				 *    Here it is up to you, I have no idea what should be done here.
-				 *    Creation of all tables and roles + user admin with some default password +
-				 *    neccessary columns (history).
-				 * 3. PRE-FILLING THE DATABASE WITH SOME VALUES
-				 *    Polluting the database with all villages, plants, territories, and phytochoria.
-				 *    This may be optional - only if leaveEmpty is true.
-				 * 
-				 * Everything you want do, do it here in the CreationTask!
-				 *  
-				 */
-
-			} 
-			catch (Exception e) {
-				logger.error("The creation of the database failed! " + e.getMessage());			
-				// Re-throw the exception so that the view is updated as well.
-				throw e;
-			}
-			
-			// Everything went fine.
-			addDBInfoPermanently( dbinfo );
-			logger.info("The creation of a new database was successful.");
-			
-			fireStopped(null);
-			return null;
-		}
+                @Override
+                        public Object task() throws Exception {
+                    if(isCanceled()) {
+                        throw new Exception(L10n.getString("Common.Canceled"));
+                    }
+                    
+                    // Create a new database layer ~ ask the DBLayerFactory to create it for us..
+                    logger.debug("Asking the DBLayerFactory for a new DBLayer @ " + dbinfo.getHost() + ":" + dbinfo.getPort());
+                    setStatusMessage(L10n.getString("Login.Connecting") );
+                    factory = RMIDBLayerFactory.getDBLayerFactory();
+                    currentDBLayer = factory.create(dbinfo);
+                    if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }
+                    logger.debug("Connection successful.");
+                    
+                    // Initialize the database layer.
+                    setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
+                    logger.debug("Initializing that DBLayer.");
+                    // Connect to template1 database. TODO: this should not be hardcoded
+                    currentDBLayer.initializeNewDB("template1", name, password);
+                    if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
+                    logger.debug("Initialization successful. Connected to template1 database");
+                    
+                    // Create users in the database
+                    setStatusMessage(L10n.getString("CreateDB.CreatingUsers") );
+                    currentDBLayer.executeSQLScript(DBLayer.CREATE_USERS, dbinfo.getDatabaseIdentifier(), name, password);
+                    logger.debug("Database "+dbinfo.getDatabaseIdentifier()+" users created successfuly");
+                    
+                    // Create new database
+                    setStatusMessage(L10n.getString("CreateDB.CreatingDatabase") );
+                    currentDBLayer.createDatabase(dbinfo.getDatabaseIdentifier());
+                    logger.debug("New database created succesfully");
+                    
+                    // Disconnect - destroy DBLayer
+                    factory.destroy(currentDBLayer);
+                    logger.debug("Disconnected from the database template1");
+                    
+                    // Connect to the newly created database
+                    currentDBLayer = factory.create(dbinfo);
+                    if(isCanceled()) { throw new Exception(L10n.getString("Common.Canceled")); }
+                    logger.debug("Connection successful.");
+                    setStatusMessage( L10n.getString("Login.Connected") );
+                    
+                    // Initialize the database layer.
+                    setStatusMessage(L10n.getString("Login.InitializingDBLayer"));
+                    logger.debug("Initializing that DBLayer.");
+                    
+                    currentDBLayer.initializeNewDB(dbinfo.getDatabaseIdentifier(), name, password);
+                    if(isCanceled()) { throw new DBLayerException(L10n.getString("Common.Canceled")); }
+                    logger.debug("Initialization successful. Connected to database "+dbinfo.getDatabaseIdentifier());
+                    
+                    // Create tables in the new database
+                    setStatusMessage(L10n.getString("CreateDB.CreatingTables"));
+                    currentDBLayer.executeSQLScript(DBLayer.CREATE_TABLES, dbinfo.getDatabaseIdentifier(), name, password);
+                    logger.debug("New database tables created");
+                    // Disconnect - destroy DBLayer
+                    factory.destroy(currentDBLayer);
+                    logger.debug("Disconnected from the database "+dbinfo.getDatabaseIdentifier());
+                    
+                            /*
+                             * TODO:
+                             *
+                             * HERE GOES YOUR CODE THAT PERFORMS
+                             * 1. THE CONNECTION TO THE DATABASE ENGINE
+                             *    You should use inormation stored in dbinfo and the stored name and password.
+                             *    See HibernateDBLayer.initialize().
+                             * 2. THE CREATION OF THE NEW DATABASE
+                             *    Here it is up to you, I have no idea what should be done here.
+                             *    Creation of all tables and roles + user admin with some default password +
+                             *    neccessary columns (history).
+                             * 3. PRE-FILLING THE DATABASE WITH SOME VALUES
+                             *    Polluting the database with all villages, plants, territories, and phytochoria.
+                             *    This may be optional - only if leaveEmpty is true.
+                             *
+                             * Everything you want do, do it here in the CreationTask!
+                             *
+                             */
+                    
+                    // Everything went fine.
+                    addDBInfoPermanently( dbinfo );
+                    logger.info("The creation of a new database was successful.");
+                    
+                    fireStopped(null);
+                    return null;
+                }
 	}
 	
 	

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-06 14:38:13 UTC (rev 708)
@@ -43,7 +43,6 @@
 					engine = ((javax.swing.JTextField)view.databaseEngine.getEditor().getEditorComponent()).getText(),
 					identifier = view.databaseIdentifier.getText(),
 					alias = view.databaseAlias.getText();
-				boolean leaveEmpty = view.leaveEmpty.isSelected();
 				int port = -1;
 				try { 
 					port = Integer.parseInt(view.databasePort.getText());
@@ -59,7 +58,7 @@
 					return;
 				}
 				
-				model.setDBInfo(alias, engine, port, identifier, leaveEmpty); 
+				model.setDBInfo(alias, engine, port, identifier); 
 				authView.setVisible(true);
 			}
 		});

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-06 14:38:13 UTC (rev 708)
@@ -73,11 +73,11 @@
                   <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Component id="jLabel1" min="-2" max="-2" attributes="0"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
-                  <Component id="databaseEngine" pref="149" max="32767" attributes="2"/>
+                  <Component id="databaseEngine" pref="154" max="32767" attributes="2"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Component id="jLabel2" min="-2" max="-2" attributes="0"/>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
-                  <Component id="databasePort" pref="76" max="32767" attributes="0"/>
+                  <Component id="databasePort" pref="81" max="32767" attributes="0"/>
                   <EmptySpace max="-2" attributes="0"/>
               </Group>
           </Group>
@@ -113,6 +113,7 @@
         </Component>
         <Component class="javax.swing.JTextField" name="databasePort">
           <Properties>
+            <Property name="text" type="java.lang.String" value="5432"/>
             <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
               <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.DatabasePortTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
             </Property>
@@ -135,6 +136,7 @@
             <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
               <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Login.DatabaseTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
             </Property>
+            <Property name="enabled" type="boolean" value="false"/>
           </Properties>
           <AuxValues>
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
@@ -157,24 +159,16 @@
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" attributes="0">
+                  <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Group type="103" groupAlignment="0" attributes="0">
-                      <Group type="102" attributes="0">
-                          <EmptySpace min="-2" max="-2" attributes="0"/>
-                          <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="jLabel5" alignment="0" min="-2" max="-2" attributes="0"/>
-                              <Component id="jLabel4" alignment="0" min="-2" max="-2" attributes="0"/>
-                          </Group>
-                          <EmptySpace min="-2" pref="11" max="-2" attributes="0"/>
-                          <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="databaseAlias" alignment="0" pref="278" max="32767" attributes="0"/>
-                              <Component id="databaseIdentifier" alignment="0" pref="278" max="32767" attributes="0"/>
-                          </Group>
-                      </Group>
-                      <Group type="102" alignment="0" attributes="0">
-                          <EmptySpace min="10" pref="10" max="10" attributes="0"/>
-                          <Component id="leaveEmpty" min="-2" max="-2" attributes="0"/>
-                      </Group>
+                      <Component id="jLabel5" alignment="0" min="-2" max="-2" attributes="0"/>
+                      <Component id="jLabel4" alignment="0" min="-2" max="-2" attributes="0"/>
                   </Group>
+                  <EmptySpace min="-2" pref="11" max="-2" attributes="0"/>
+                  <Group type="103" groupAlignment="0" attributes="0">
+                      <Component id="databaseAlias" alignment="0" pref="288" max="32767" attributes="0"/>
+                      <Component id="databaseIdentifier" alignment="0" pref="288" max="32767" attributes="0"/>
+                  </Group>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
               </Group>
           </Group>
@@ -191,8 +185,6 @@
                       <Component id="jLabel4" alignment="3" min="-2" max="-2" attributes="0"/>
                       <Component id="databaseIdentifier" alignment="3" min="-2" max="-2" attributes="0"/>
                   </Group>
-                  <EmptySpace max="-2" attributes="0"/>
-                  <Component id="leaveEmpty" min="-2" max="-2" attributes="0"/>
                   <EmptySpace max="32767" attributes="0"/>
               </Group>
           </Group>
@@ -216,27 +208,6 @@
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
         </Component>
-        <Component class="javax.swing.JCheckBox" name="leaveEmpty">
-          <Properties>
-            <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="CreateDB.LeaveEmpty" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
-            </Property>
-            <Property name="toolTipText" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
-              <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="CreateDB.LeaveEmptyTT" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
-            </Property>
-            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
-              <Border info="org.netbeans.modules.form.compat2.border.EmptyBorderInfo">
-                <EmptyBorder bottom="0" left="0" right="0" top="0"/>
-              </Border>
-            </Property>
-            <Property name="margin" type="java.awt.Insets" editor="org.netbeans.beaninfo.editors.InsetsEditor">
-              <Insets value="[0, 0, 0, 0]"/>
-            </Property>
-          </Properties>
-          <AuxValues>
-            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-          </AuxValues>
-        </Component>
         <Component class="javax.swing.JLabel" name="jLabel5">
           <Properties>
             <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-06 14:38:13 UTC (rev 708)
@@ -56,7 +56,6 @@
         jPanel2 = new javax.swing.JPanel();
         jLabel4 = new javax.swing.JLabel();
         databaseIdentifier = new javax.swing.JTextField();
-        leaveEmpty = new javax.swing.JCheckBox();
         jLabel5 = new javax.swing.JLabel();
         databaseAlias = new javax.swing.JTextField();
         next = new javax.swing.JButton();
@@ -69,11 +68,13 @@
 
         jLabel2.setText(L10n.getString("Login.DatabasePort"));
 
+        databasePort.setText("5432");
         databasePort.setToolTipText(L10n.getString("Login.DatabasePortTT"));
 
         databaseEngine.setEditable(true);
         databaseEngine.setModel(new javax.swing.DefaultComboBoxModel(new String[] { "postgresql", "firebirdsql", "mysql", "oraclesql" }));
         databaseEngine.setToolTipText(L10n.getString("Login.DatabaseTT"));
+        databaseEngine.setEnabled(false);
 
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
         jPanel1.setLayout(jPanel1Layout);
@@ -83,11 +84,11 @@
                 .addContainerGap()
                 .add(jLabel1)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(databaseEngine, 0, 149, Short.MAX_VALUE)
+                .add(databaseEngine, 0, 154, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jLabel2)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 76, Short.MAX_VALUE)
+                .add(databasePort, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 81, Short.MAX_VALUE)
                 .addContainerGap())
         );
         jPanel1Layout.setVerticalGroup(
@@ -106,11 +107,6 @@
 
         databaseIdentifier.setToolTipText(L10n.getString("Login.DatabaseIdentifierTT"));
 
-        leaveEmpty.setText(L10n.getString("CreateDB.LeaveEmpty"));
-        leaveEmpty.setToolTipText(L10n.getString("CreateDB.LeaveEmptyTT"));
-        leaveEmpty.setBorder(javax.swing.BorderFactory.createEmptyBorder(0, 0, 0, 0));
-        leaveEmpty.setMargin(new java.awt.Insets(0, 0, 0, 0));
-
         jLabel5.setText(L10n.getString("Login.Alias"));
 
         databaseAlias.setToolTipText(L10n.getString("Login.AliasTT"));
@@ -120,19 +116,14 @@
         jPanel2Layout.setHorizontalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel2Layout.createSequentialGroup()
+                .addContainerGap()
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jPanel2Layout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(jLabel5)
-                            .add(jLabel4))
-                        .add(11, 11, 11)
-                        .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(databaseAlias, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 278, Short.MAX_VALUE)
-                            .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 278, Short.MAX_VALUE)))
-                    .add(jPanel2Layout.createSequentialGroup()
-                        .add(10, 10, 10)
-                        .add(leaveEmpty)))
+                    .add(jLabel5)
+                    .add(jLabel4))
+                .add(11, 11, 11)
+                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(databaseAlias, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 288, Short.MAX_VALUE)
+                    .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 288, Short.MAX_VALUE))
                 .addContainerGap())
         );
         jPanel2Layout.setVerticalGroup(
@@ -145,8 +136,6 @@
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(jLabel4)
                     .add(databaseIdentifier, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(leaveEmpty)
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
@@ -208,7 +197,6 @@
     private javax.swing.JLabel jLabel5;
     private javax.swing.JPanel jPanel1;
     private javax.swing.JPanel jPanel2;
-    protected javax.swing.JCheckBox leaveEmpty;
     protected javax.swing.JButton next;
     // End of variables declaration//GEN-END:variables
     

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-06 14:38:13 UTC (rev 708)
@@ -169,6 +169,9 @@
             	case ERROR_OTHER:
             		this.errorInfo = L10n.getString("DBLayer.Error.Other");
             		break;
+                case ERROR_CREATEDB:
+                        this.errorInfo = L10n.getString("DBLayer.Error.CreateDB");
+                        break;
             	default:
             		throw new IllegalArgumentException(L10n.getString("Error.ImproperUse"));
             	}

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 14:38:13 UTC (rev 708)
@@ -785,6 +785,7 @@
 DBLayer.Error.DiskFull=The hard drive is full.
 DBLayer.Error.OutOfMemory=There is not enough memory to complete the request.
 DBLayer.Error.MaxConnections=Too many users are connected to the database.
+DBLayer.Error.CreateDB=Creation of new database was not successful. Please make sure that database system is properly installed and that the database doesn't exist yet.
 DBLayer.Error.Other=The reason is unknown.
 
 Error.IncorrectXMLFile=The file format is corrupted.

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 14:34:29 UTC (rev 707)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 14:38:13 UTC (rev 708)
@@ -13,6 +13,7 @@
 import java.rmi.server.Unreferenced;
 import java.sql.Connection;
 import java.sql.PreparedStatement;
+import java.sql.ResultSet;
 import java.sql.SQLException;
 import java.sql.Statement;
 import java.util.Date;
@@ -369,10 +370,8 @@
         } else {
         	touchRecord(data);
         }
-        
         // Check whether we have sufficient rights.
         checkRights(data, operation);
-
         // Perform the Operation.
         Transaction tx = null;
 
@@ -383,7 +382,6 @@
         try {            
             // Begin transaction, if it is required. If not, the `tx` stays null.
             if(useOwnTransaction) tx = session.beginTransaction();
-            
             // Make changes in the database.
             switch(operation) {
                 case INSERT:
@@ -909,7 +907,7 @@
             ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
             throw ex;
         } catch (HibernateException e) {
-            this.rollbackTransaction();            
+            this.rollbackTransaction();    
             logger.fatal("Cannot commit database transaction");
             DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
             ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
@@ -2053,7 +2051,7 @@
         }        
         try {
             Connection conn = txSession.connection();                    
-            PreparedStatement pstmt = conn.prepareStatement("CREATE USER " + this.userPrefix + name+ " WITH PASSWORD '" +password+ "' "+admin);            
+            PreparedStatement pstmt = conn.prepareStatement("CREATE USER " + this.userPrefix + name+ " WITH PASSWORD '" +password+ "' "+admin);
             pstmt.execute();
             PreparedStatement pstmtGrant = conn.prepareStatement("GRANT "+role+" TO  " + this.userPrefix + name);   
             pstmtGrant.execute();
@@ -2205,27 +2203,51 @@
                     break;
         }
         // Check whether we are connected and obtain a session
-        checkConnection();     
-        // Read the script file from resources
-        StringBuffer sql = new StringBuffer();
+        checkConnection();  
+        // Open new session
+        Session session = sessionFactory.openSession();
+        // Obtain JDBC connection from session
+        Connection con = session.connection();                
+        // Read the script file from resources - check the existing roles first. If the roles exist, 
+        // skip this step completely
+        boolean skipRoles = false;
         try {
-            ClassLoader cl = HibernateDBLayer.class.getClassLoader();
-            URL sqlfile = cl.getResource(file);
-            BufferedReader in = new BufferedReader(new InputStreamReader(sqlfile.openStream()));
-            String str;
-            while ((str = in.readLine()) != null) {
-                sql.append(str);
-            }
-            in.close();
-        } catch (IOException e) {
-            // Deal with I/O Exception
-            logger.error("I/O Exception caught. Cannot read sql script from file. Details: "+e.getMessage());
+            if (scriptid == DBLayer.CREATE_USERS) {        
+                Statement st = con.createStatement();
+                st.execute("SELECT count(*) AS rolecount FROM pg_roles WHERE rolname = 'plantlore_role_admin'");
+                ResultSet rs = st.getResultSet();
+                rs.next();
+                int rolecount = rs.getInt("rolecount");
+                if (rolecount > 0) {
+                    skipRoles = true;
+                }
+            }        
+        } catch (SQLException e) {
+            // Close session
+            session.close();
+            // Deal with the exception
+            logger.error("SQLException caught while executing SQL script. Details: "+e.getMessage()+"; SQL State: "+e.getSQLState());
             throw new DBLayerException(L10n.getString("Error.CreateDatabase"), DBLayerException.ERROR_CREATEDB, e);
         }
-        // Open new session
-        Session session = sessionFactory.openSession();
-        // Obtain JDBC connection from session
-        Connection con = session.connection();        
+        StringBuffer sql = new StringBuffer();
+        if (!skipRoles) {
+            try {
+                ClassLoader cl = HibernateDBLayer.class.getClassLoader();
+                URL sqlfile = cl.getResource(file);
+                BufferedReader in = new BufferedReader(new InputStreamReader(sqlfile.openStream()));
+                String str;
+                while ((str = in.readLine()) != null) {
+                    sql.append(str);
+                }
+                in.close();
+            } catch (IOException e) {
+                // Close session
+                session.close();
+                // Deal with I/O Exception
+                logger.error("I/O Exception caught. Cannot read sql script from file. Details: "+e.getMessage());
+                throw new DBLayerException(L10n.getString("Error.CreateDatabase"), DBLayerException.ERROR_CREATEDB, e);
+            }
+        }
         // In case we are creating users, add statement to create first user for accesing plantlore
         if (scriptid == DBLayer.CREATE_USERS) {
             sql.append("CREATE USER "+dbname+"_"+username+" PASSWORD '"+password+"';");



From fraktalek at mail.berlios.de  Wed Sep  6 19:40:22 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 19:40:22 +0200
Subject: [Plantlore-dev] r709 - in trunk/src/net/sf/plantlore: client
	client/overview client/overview/tree client/resources common
Message-ID: <200609061740.k86HeMen009318@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 19:40:21 +0200 (Wed, 06 Sep 2006)
New Revision: 709

Added:
   trunk/src/net/sf/plantlore/client/resources/icon32.gif
Modified:
   trunk/src/net/sf/plantlore/client/AboutView.form
   trunk/src/net/sf/plantlore/client/AboutView.java
   trunk/src/net/sf/plantlore/client/AppCore.java
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/Plantlore.java
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.form
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
Fixed habitat deletion so that it works now as expected. Closing queries on exception in deleteHabitat in DBLayerUtils.
Habitat tree fixed a little.
The main application frame now has a not very nice icon...
..



Modified: trunk/src/net/sf/plantlore/client/AboutView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AboutView.form	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AboutView.form	2006-09-06 17:40:21 UTC (rev 709)
@@ -43,7 +43,7 @@
           </Properties>
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="">
+              <JTabbedPaneConstraints tabName="About">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
                   <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.About" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
@@ -54,25 +54,43 @@
           <Layout>
             <DimensionLayout dim="0">
               <Group type="103" groupAlignment="0" attributes="0">
-                  <EmptySpace min="0" pref="377" max="32767" attributes="0"/>
+                  <Component id="aboutLabel" alignment="0" pref="377" max="32767" attributes="0"/>
               </Group>
             </DimensionLayout>
             <DimensionLayout dim="1">
               <Group type="103" groupAlignment="0" attributes="0">
-                  <EmptySpace min="0" pref="250" max="32767" attributes="0"/>
+                  <Component id="aboutLabel" alignment="0" pref="250" max="32767" attributes="0"/>
               </Group>
             </DimensionLayout>
           </Layout>
+          <SubComponents>
+            <Component class="javax.swing.JLabel" name="aboutLabel">
+              <AccessibilityProperties>
+                <Property name="AccessibleContext.accessibleName" type="java.lang.String" value="Plantlore 1.0"/>
+              </AccessibilityProperties>
+              <AuxValues>
+                <AuxValue name="JavaCodeGenerator_CreateCodeCustom" type="java.lang.String" value="new JLabel(new ImageIcon(java.awt.Toolkit.getDefaultToolkit().getImage(AppCoreView.class.getResource(&quot;resources/splash_new.jpg&quot;))));"/>
+              </AuxValues>
+            </Component>
+          </SubComponents>
         </Container>
         <Container class="javax.swing.JPanel" name="detailTab">
           <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ff" green="ff" red="ff" type="rgb"/>
+            </Property>
+            <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+              <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
+                <TitledBorder/>
+              </Border>
+            </Property>
             <Property name="name" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
               <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Detail" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
             </Property>
           </Properties>
           <Constraints>
             <Constraint layoutClass="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout" value="org.netbeans.modules.form.compat2.layouts.support.JTabbedPaneSupportLayout$JTabbedPaneConstraintsDescription">
-              <JTabbedPaneConstraints tabName="Detail: ">
+              <JTabbedPaneConstraints tabName="Detail">
                 <Property name="tabTitle" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
                   <ResourceString bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Overview.About.Detail" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
                 </Property>
@@ -84,44 +102,30 @@
             <DimensionLayout dim="0">
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" attributes="0">
+                      <EmptySpace max="-2" attributes="0"/>
                       <Group type="103" groupAlignment="0" attributes="0">
-                          <Group type="102" alignment="0" attributes="0">
+                          <Group type="102" attributes="0">
+                              <Group type="103" groupAlignment="0" attributes="0">
+                                  <Component id="versionLabel" alignment="0" pref="343" max="32767" attributes="0"/>
+                                  <Component id="osLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="javaLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="userDirLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="configDirLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="authorsLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                              </Group>
                               <EmptySpace max="-2" attributes="0"/>
-                              <Component id="versionLabel" pref="353" max="32767" attributes="0"/>
                           </Group>
-                          <Group type="102" alignment="0" attributes="0">
-                              <EmptySpace max="-2" attributes="0"/>
-                              <Component id="osLabel" min="-2" max="-2" attributes="0"/>
+                          <Group type="102" alignment="1" attributes="0">
+                              <Group type="103" groupAlignment="0" attributes="0">
+                                  <Component id="erikLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="ladaLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="kovoLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                                  <Component id="jakubLabel" alignment="0" min="-2" max="-2" attributes="0"/>
+                              </Group>
+                              <EmptySpace min="-2" pref="29" max="-2" attributes="0"/>
                           </Group>
-                          <Group type="102" alignment="0" attributes="0">
-                              <EmptySpace max="-2" attributes="0"/>
-                              <Component id="javaLabel" min="-2" max="-2" attributes="0"/>
-                          </Group>
-                          <Group type="102" alignment="0" attributes="0">
-                              <EmptySpace max="-2" attributes="0"/>
-                              <Component id="userDirLabel" min="-2" max="-2" attributes="0"/>
-                          </Group>
-                          <Group type="102" alignment="0" attributes="0">
-                              <EmptySpace max="-2" attributes="0"/>
-                              <Component id="configDirLabel" min="-2" max="-2" attributes="0"/>
-                          </Group>
-                          <Group type="102" alignment="0" attributes="0">
-                              <EmptySpace max="-2" attributes="0"/>
-                              <Component id="authorsLabel" min="-2" max="-2" attributes="0"/>
-                          </Group>
                       </Group>
-                      <EmptySpace max="-2" attributes="0"/>
                   </Group>
-                  <Group type="102" alignment="1" attributes="0">
-                      <EmptySpace pref="75" max="32767" attributes="0"/>
-                      <Group type="103" groupAlignment="0" attributes="0">
-                          <Component id="erikLabel" alignment="0" min="-2" max="-2" attributes="0"/>
-                          <Component id="ladaLabel" alignment="0" min="-2" max="-2" attributes="0"/>
-                          <Component id="kovoLabel" alignment="0" min="-2" max="-2" attributes="0"/>
-                          <Component id="jakubLabel" alignment="0" min="-2" max="-2" attributes="0"/>
-                      </Group>
-                      <EmptySpace min="-2" pref="29" max="-2" attributes="0"/>
-                  </Group>
               </Group>
             </DimensionLayout>
             <DimensionLayout dim="1">
@@ -147,7 +151,7 @@
                       <Component id="kovoLabel" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jakubLabel" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="34" max="32767" attributes="0"/>
+                      <EmptySpace pref="24" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>

Modified: trunk/src/net/sf/plantlore/client/AboutView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AboutView.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AboutView.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -7,6 +7,8 @@
 package net.sf.plantlore.client;
 
 import java.io.File;
+import javax.swing.ImageIcon;
+import javax.swing.JLabel;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -25,7 +27,7 @@
     
     private void loadData() {
         String os = System.getProperty("os.name");
-        String plantloreDir = (os.equals("linux") ? "." : "") + Plantlore.PLANTLORE;
+        String plantloreDir = (os.equals("Linux") ? "." : "") + Plantlore.PLANTLORE;
         configDirLabel.setText(configDirLabel.getText()+System.getProperty("user.home")+File.separator+plantloreDir);
         osLabel.setText(osLabel.getText()+System.getProperty("os.name"));
         userDirLabel.setText(userDirLabel.getText()+System.getProperty("user.home"));
@@ -42,6 +44,7 @@
     private void initComponents() {
         aboutTabbedPane = new javax.swing.JTabbedPane();
         aboutTab = new javax.swing.JPanel();
+        aboutLabel = new JLabel(new ImageIcon(java.awt.Toolkit.getDefaultToolkit().getImage(AppCoreView.class.getResource("resources/splash_new.jpg"))));
         detailTab = new javax.swing.JPanel();
         versionLabel = new javax.swing.JLabel();
         osLabel = new javax.swing.JLabel();
@@ -57,18 +60,22 @@
         setTitle(L10n.getString("Overview.About.About"));
         setResizable(false);
         aboutTab.setName(L10n.getString("Overview.About.About"));
+        aboutLabel.getAccessibleContext().setAccessibleName("Plantlore 1.0");
+
         org.jdesktop.layout.GroupLayout aboutTabLayout = new org.jdesktop.layout.GroupLayout(aboutTab);
         aboutTab.setLayout(aboutTabLayout);
         aboutTabLayout.setHorizontalGroup(
             aboutTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 377, Short.MAX_VALUE)
+            .add(aboutLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 377, Short.MAX_VALUE)
         );
         aboutTabLayout.setVerticalGroup(
             aboutTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 250, Short.MAX_VALUE)
+            .add(aboutLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 250, Short.MAX_VALUE)
         );
         aboutTabbedPane.addTab(L10n.getString("Overview.About.About"), aboutTab);
 
+        detailTab.setBackground(new java.awt.Color(255, 255, 255));
+        detailTab.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
         detailTab.setName(L10n.getString("Overview.About.Detail"));
         versionLabel.setText(L10n.getString("Overview.About.Version"));
 
@@ -95,34 +102,24 @@
         detailTabLayout.setHorizontalGroup(
             detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(detailTabLayout.createSequentialGroup()
+                .addContainerGap()
                 .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(versionLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 353, Short.MAX_VALUE))
-                    .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(osLabel))
-                    .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(javaLabel))
-                    .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(userDirLabel))
-                    .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(configDirLabel))
-                    .add(detailTabLayout.createSequentialGroup()
-                        .addContainerGap()
-                        .add(authorsLabel)))
-                .addContainerGap())
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, detailTabLayout.createSequentialGroup()
-                .addContainerGap(75, Short.MAX_VALUE)
-                .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(erikLabel)
-                    .add(ladaLabel)
-                    .add(kovoLabel)
-                    .add(jakubLabel))
-                .add(29, 29, 29))
+                        .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                            .add(versionLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 343, Short.MAX_VALUE)
+                            .add(osLabel)
+                            .add(javaLabel)
+                            .add(userDirLabel)
+                            .add(configDirLabel)
+                            .add(authorsLabel))
+                        .addContainerGap())
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, detailTabLayout.createSequentialGroup()
+                        .add(detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                            .add(erikLabel)
+                            .add(ladaLabel)
+                            .add(kovoLabel)
+                            .add(jakubLabel))
+                        .add(29, 29, 29))))
         );
         detailTabLayout.setVerticalGroup(
             detailTabLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -147,7 +144,7 @@
                 .add(kovoLabel)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jakubLabel)
-                .addContainerGap(34, Short.MAX_VALUE))
+                .addContainerGap(24, Short.MAX_VALUE))
         );
         aboutTabbedPane.addTab(L10n.getString("Overview.About.Detail"), detailTab);
 
@@ -176,6 +173,7 @@
     }
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
+    private javax.swing.JLabel aboutLabel;
     private javax.swing.JPanel aboutTab;
     private javax.swing.JTabbedPane aboutTabbedPane;
     private javax.swing.JLabel authorsLabel;

Modified: trunk/src/net/sf/plantlore/client/AppCore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AppCore.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -11,7 +11,9 @@
 import java.rmi.RemoteException;
 import java.util.ArrayList;
 import java.util.Collection;
+import java.util.HashSet;
 import java.util.Hashtable;
+import java.util.Iterator;
 import java.util.Observable;
 import java.util.prefs.Preferences;
 import javax.swing.table.TableModel;
@@ -879,6 +881,7 @@
                     throw new DBLayerException("Can't create transaction. Another already running.");
                 }
                 
+                HashSet<Habitat> habitatsToCheck = new HashSet<Habitat>();
                 try {
                     Collection<Integer> toBeDeleted = getTableModel().getSelection().values();
                     setLength(toBeDeleted.size()*2); //inform about approx. length of this task
@@ -890,7 +893,8 @@
                         logger.debug("Deleting occurrence id "+i);
                         occ.setDeleted(1);
                         database.executeUpdateInTransaction(occ);
-                        dlu.deleteHabitatInTransaction(occ.getHabitat());
+                        //dlu.deleteHabitatInTransaction(occ.getHabitat());
+                        habitatsToCheck.add(occ.getHabitat());
                         logger.debug("Occurrence id "+occ.getId()+" "+occ.getPlant().getTaxon()+" deleted.");
                         setPosition(getPosition()+1);
 
@@ -911,6 +915,13 @@
                 }
                 
                 database.commitTransaction();
+                
+                Iterator<Habitat> it = habitatsToCheck.iterator();
+                while (it.hasNext()) {
+                    Habitat h = it.next();
+                    dlu.deleteHabitat(h);
+                }
+                
                 getTableModel().clearSelection();
                 fireStopped(null);
                 return null;

Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -1050,6 +1050,21 @@
                         addView.loadComponentData();
                         addView.setVisible(true);   
                     }//if ADD
+                    if (message.equals("DELETE")) {
+                        switch (nodeInfo.getType()) {
+                            case HABITAT:
+                                System.out.println("=== DELETE "+nodeInfo.getChildCount());
+                                if (nodeInfo.getChildCount() > 0) {
+                                    JOptionPane.showMessageDialog(view,
+                                            L10n.getString("Overview.Tree.ContainsOccurrencesCantDelete"),
+                                            L10n.getString("Overview.Tree.ContainsOccurrencesCantDelete"),
+                                            JOptionPane.INFORMATION_MESSAGE);
+                                    return;
+                                }
+                                break;
+                        }//switch
+                        
+                    }//if DELETE
                 }//if
             }//update
         }//class HabitatTreeBridge

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-06 17:40:21 UTC (rev 709)
@@ -537,7 +537,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="295" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="223" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -68,6 +68,7 @@
         model.addObserver(sbm);
         progressBar.setVisible(false);
         progressBar.setBorderPainted(false);
+        setIconImage(java.awt.Toolkit.getDefaultToolkit().getImage(AppCoreView.class.getResource("resources/icon.gif")));
     }
 
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/client/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -144,7 +144,7 @@
             }
             
             logger.info("Constructing AppCore MVC");
-            splashScreen = new SplashScreen("resources/splashscreen.gif");
+            splashScreen = new SplashScreen("resources/splash_new.jpg");
             splashScreen.splash();
             model = new AppCore(mainConfig);
             view = new AppCoreView(model);

Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -1018,7 +1018,8 @@
                                 logger.debug("AppCore.deleteSelected(): Can't create transaction. Another is probably already running.");
                                 throw new DBLayerException("Can't create transaction. Another already running.");
                             }
-
+                            Habitat habitatToCheck = null;
+                            
                             prepareOccurrenceUpdate(updateAllPlants);
                             if (originalTaxonSurvived) {
                                 // update original occurrence
@@ -1030,7 +1031,7 @@
                                 logger.info("Deleting original occurrence and associated author occurrences");
                                 o.setDeleted(1);
                                 database.executeUpdateInTransaction(o);
-                                dlu.deleteHabitatInTransaction(o.getHabitat());
+                                habitatToCheck = o.getHabitat(); //we'll maybe have to delete this habitat
                                 logger.debug("Occurrence id "+o.getId()+" "+o.getPlant().getTaxon()+" deleted.");
                                 Set<Map.Entry<Integer,AuthorOccurrence>> aoSet = authorOccurrences.entrySet();
                                 Iterator it = aoSet.iterator();
@@ -1153,6 +1154,8 @@
                                 }
 
                             database.commitTransaction();
+                            if (habitatToCheck != null)
+                                dlu.deleteHabitat(habitatToCheck);
                             occurrenceTableModel.reload();
                             newOccurrenceInserted = false;
 

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -105,6 +105,7 @@
     public int getPhythochoriaCount(Territory t) throws RemoteException, DBLayerException {
         SelectQuery query = dblayer.createQuery(Habitat.class);
         query.addRestriction(PlantloreConstants.RESTR_EQ,Habitat.TERRITORY,null,t,null);
+        query.addRestriction(PlantloreConstants.RESTR_EQ, Habitat.DELETED, null, 0, null);        
         query.addProjection(PlantloreConstants.PROJ_COUNT_DISTINCT,Habitat.PHYTOCHORION);
         int resultid = dblayer.executeQuery(query);
         int rowCount = dblayer.getNumRows(resultid);
@@ -135,6 +136,7 @@
     protected void addPhythochoria(DefaultMutableTreeNode territoryNode, Territory t) throws DBLayerException, RemoteException {
         SelectQuery query = dblayer.createQuery(Habitat.class);
         query.addRestriction(PlantloreConstants.RESTR_EQ,Habitat.TERRITORY,null,t,null);
+        query.addRestriction(PlantloreConstants.RESTR_EQ, Habitat.DELETED, null, 0, null);
         query.addProjection(PlantloreConstants.PROJ_DISTINCT,Habitat.PHYTOCHORION);
         int resultid = dblayer.executeQuery(query);
         int rowCount = dblayer.getNumRows(resultid);
@@ -168,6 +170,7 @@
         
         SelectQuery query = dblayer.createQuery(Habitat.class);
         query.addRestriction(PlantloreConstants.RESTR_EQ, Habitat.PHYTOCHORION, null, dlu.getObjectFor(phytochorionId, Phytochorion.class),null);
+        query.addRestriction(PlantloreConstants.RESTR_EQ, Habitat.DELETED, null, 0, null);
         query.addProjection(PlantloreConstants.PROJ_PROPERTY, Habitat.ID);
         query.addProjection(PlantloreConstants.PROJ_PROPERTY, Habitat.DESCRIPTION);
         query.addProjection(PlantloreConstants.PROJ_PROPERTY, Habitat.NEARESTVILLAGE);
@@ -175,14 +178,17 @@
 
         int resultid = dblayer.executeQuery(query);
         int rowCount = dblayer.getNumRows(resultid);
-                
+        if (rowCount == 0)
+            return;
+        
         Object[] records = dblayer.more(resultid, 0, rowCount - 1);
         dblayer.closeQuery(query);
         DefaultMutableTreeNode node;
         for (Object record : records) {
             Object[] obj = (Object[])record;
             String name = ((NearestVillage)obj[2]).getName() + " - " + obj[1] + " (quadrant " + obj[3] + ")";
-            name = "("+getOccurrenceCount((Integer)obj[0])+") "+name;
+            Integer count = getOccurrenceCount((Integer)obj[0]);
+            name = "("+count+") "+name;
             node = new DefaultMutableTreeNode(new NodeInfo(NodeInfo.NodeType.HABITAT,name,(Integer)obj[0],-1));
             treeModel.insertNodeInto(node, phytNode,0);
             //phytNode.add(node);
@@ -206,6 +212,17 @@
         }
     }
     
+    /** Notifies observers about a requirement to delete a node.
+     *
+     * Sends the <code>NodeInfo</code> object of the selected node to the observer.
+     */
+    public void delete() {
+        if (selectedNode != null) {
+            setChanged();
+            notifyObservers(new Pair<String,NodeInfo>("DELETE",(NodeInfo)selectedNode.getUserObject()));
+        }        
+    }
+    
     /** Reloads the whole tree.
      *
      * Removes all children of the <code>rootNode</code> and then calls <code>loadData()</code>
@@ -213,6 +230,7 @@
      */
     public Task reload() {
         rootNode.removeAllChildren();
+        treeModel.nodeStructureChanged(rootNode);
         return loadData();
     }
     

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeCtrl.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -56,6 +56,7 @@
         view.refreshButton.setAction(new RefreshAction());
         view.refreshMenuItem.setAction(new RefreshItemAction());
         view.addMenuItem.setAction(new AddItemAction());
+        //view.deleteMenuItem.setAction(new DeleteItemAction()); ... it would cause problems to history
     }
 
     /** Expansion event handler.
@@ -188,6 +189,18 @@
             }
     }//SearchAction
    
+    class DeleteItemAction extends AbstractAction {
+            public DeleteItemAction() {
+                    putValue(NAME, L10n.getString("Overview.Tree.Delete"));
+//                    putValue(SMALL_ICON, Resource.createIcon("/toolbarButtonGraphics/general/Search24.gif"));
+                    putValue(SHORT_DESCRIPTION, L10n.getString("Overview.Tree.DeleteTT"));
+            }
+
+            public void actionPerformed(ActionEvent actionEvent) {
+                model.delete();
+            }
+    }//SearchAction
+   
     class RefreshItemAction extends AbstractAction {
             public RefreshItemAction() {
                     putValue(NAME, L10n.getString("Overview.Tree.Refresh"));
@@ -196,11 +209,8 @@
             }
 
             public void actionPerformed(ActionEvent actionEvent) {
-                try {
-                    model.reload();
-                } catch (Exception ex) {
-                    DefaultExceptionHandler.handle(view,ex);
-                }
+                    Task task = model.reload();
+                    Dispatcher.getDispatcher().dispatch(task, view, false);
             }
     }//RefreshAction
     

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.form	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.form	2006-09-06 17:40:21 UTC (rev 709)
@@ -33,6 +33,14 @@
         </MenuItem>
       </SubComponents>
     </Menu>
+    <MenuItem class="javax.swing.JMenuItem" name="deleteMenuItem">
+      <Properties>
+        <Property name="text" type="java.lang.String" value="Item"/>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </MenuItem>
   </NonVisualComponents>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -27,6 +27,7 @@
         setLocationRelativeTo(parent);
         searchMenuItem.setText(L10n.getString("Overview.Tree.SearchMenuItem"));
         refreshMenuItem.setText(L10n.getString("Overview.Tree.RefreschMenuItem"));
+        deleteMenuItem.setText(L10n.getString("Overview.Tree.DeleteMenuItem"));
     }
     
     /** This method is called from within the constructor to
@@ -40,6 +41,7 @@
         searchMenuItem = new javax.swing.JMenuItem();
         refreshMenuItem = new javax.swing.JMenuItem();
         addMenuItem = new javax.swing.JMenuItem();
+        deleteMenuItem = new javax.swing.JMenuItem();
         jScrollPane1 = new javax.swing.JScrollPane();
         habitatTree = new JTree(model.getTreeModel());
         jPanel1 = new javax.swing.JPanel();
@@ -55,6 +57,8 @@
         addMenuItem.setText("Item");
         popupMenu.add(addMenuItem);
 
+        deleteMenuItem.setText("Item");
+
         jScrollPane1.setViewportView(habitatTree);
 
         searchButton.setText("jButton1");
@@ -115,6 +119,7 @@
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JMenuItem addMenuItem;
+    protected javax.swing.JMenuItem deleteMenuItem;
     protected javax.swing.JTree habitatTree;
     private javax.swing.JPanel jPanel1;
     private javax.swing.JScrollPane jScrollPane1;

Added: trunk/src/net/sf/plantlore/client/resources/icon32.gif
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/icon32.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-06 14:38:13 UTC (rev 708)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-06 17:40:21 UTC (rev 709)
@@ -208,11 +208,20 @@
      *
      */
     public void deleteHabitat(Habitat h) throws DBLayerException, RemoteException {
+        if (h == null)
+            return;
         SelectQuery sq = db.createQuery(Occurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.HABITAT,null,h,null);
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Deletable.DELETED, null, 0, null);
-        int resultid = db.executeQuery(sq);
-        int resultCount = db.getNumRows(resultid);
+        int resultid;
+        int resultCount;
+        try {
+            resultid = db.executeQuery(sq);
+            resultCount = db.getNumRows(resultid);
+        } catch (DBLayerException ex) {
+            db.closeQuery(sq);
+            throw ex;
+        }
         if (resultCount == 0) {
             logger.info("Deleting habitat id="+h.getId()+" with nearest village "+h.getNearestVillage().getName());
             h.setDeleted(1);
@@ -229,6 +238,8 @@
      *
      */
     public void deleteHabitatInTransaction(Habitat h) throws DBLayerException, RemoteException {
+        if (h == null)
+            return;
         SelectQuery sq = db.createQuery(Occurrence.class);        
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Occurrence.HABITAT,null,h,null);
         sq.addRestriction(PlantloreConstants.RESTR_EQ,Deletable.DELETED, null, 0, null);



From fraktalek at mail.berlios.de  Wed Sep  6 19:40:58 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 19:40:58 +0200
Subject: [Plantlore-dev] r710 - trunk/src/net/sf/plantlore/client/resources
Message-ID: <200609061740.k86HewcF009403@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 19:40:58 +0200 (Wed, 06 Sep 2006)
New Revision: 710

Added:
   trunk/src/net/sf/plantlore/client/resources/icon.gif
   trunk/src/net/sf/plantlore/client/resources/splash_new.jpg
Log:
Two resources needed for the previous commit. 


Added: trunk/src/net/sf/plantlore/client/resources/icon.gif
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/icon.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/client/resources/splash_new.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/splash_new.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Wed Sep  6 19:44:00 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 19:44:00 +0200
Subject: [Plantlore-dev] r711 - trunk/src/net/sf/plantlore/help/cs/html
Message-ID: <200609061744.k86Hi0qN009709@sheep.berlios.de>

Author: krater
Date: 2006-09-06 19:43:59 +0200 (Wed, 06 Sep 2006)
New Revision: 711

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/checklist.html
   trunk/src/net/sf/plantlore/help/cs/html/export.html
   trunk/src/net/sf/plantlore/help/cs/html/import.html
   trunk/src/net/sf/plantlore/help/cs/html/login.html
   trunk/src/net/sf/plantlore/help/cs/html/server.html
   trunk/src/net/sf/plantlore/help/cs/html/table_import.html
Log:
First part of the Czech user manual

Modified: trunk/src/net/sf/plantlore/help/cs/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -6,74 +6,85 @@
     <title>?krt?k</title>
   </head>
   <body>
-  <h1>?krtac? seznam</h1>
+
+	<h1>?krtac? seznam</h1>
+
 	<p>
-	?krtac? seznam p?edstavuje u?ivatelsky pohodln? zp?sob vkl?d?n? n?zv? rostlin.
-	Hned po spu?t?n? obsahuje n?zvy v?ech rostlin tak, jak jsou ulo?eny v datab?zi.
+	?krtac? seznam, zkr?cen? ?krt?k, usnad?uje vkl?d?n? rostlin nalezen?ch na ur?it? lokalit? -
+	ze seznamu rostlin se za?krtnut?m vyberou ty, kter? byly nalezeny.
+	Je p??stupn? p?i <a href="./addoccurrence.html">vkl?d?n? n?lezov?ch dat</a>.
 	</p>
 
 
-	<div style="position: relative; left: 30; top: 10;"><br>
-	<img src="picture/ChecklistDefault.jpg" alt="?krt?k po otev?en?.">
-	</div>
+	<h2>Obsah</h2>
 
 	<p>
-	Jeliko? se v datab?zi m??e nach?zet n?kolik tis?c rostlin, pr?ce se ?krt?kem by mohla b?t
-	nep??jemn?. Proto je mo?n? se ve ?krt?ku pohybovat pomoc? ?ipek nahoru i dol? a ?ipek
-	doleva a doprava. Pro v?t?? pohodl? je mo?n? zadat i po??te?n? p?smena z?znamu - 
-	?krt?k zobraz? prvn? vyhovuj?c? n?zev. Nap??ete-li kup??kladu rychle po sob? p?smena "ZELK",
-	?krt?k p?ejde na z?znam "Zelkova serrata (Thunb.) Makino". Na velikosti p?smen nez?le??.
+	<ol>
+		<li>Pr?ce se ?krt?kem</li>
+		<li>Vytv??en? a na??t?n? vlastn?ho ?krtac?ho seznamu</li>
+	</ol>
 	</p>
 
 
+	<h2>1. Pr?ce se ?krtac?m seznamem</h2>
+
 	<p>
-	V?b?r z?znamu lze prov?d?t klinut?m lev?ho tla??ka my?i nebo mezern?kem. 
-	Odzna?en? z?znamu se prov?d? stejn?.
+	Po otev?en? ?krt?k obsahuje seznam v?ech rostlin, kter? jsou v datab?zi dostupn?.
+	T?ch m??e b?t i n?kolik tis?c.
+	Ve ?krt?ku se pohybujete pomoc? ?ipek nahoru a dol? a ?ipek doleva a doprava.
+	Nap??ete-li dostate?n? rychle po sob? po??te?n? p?smena n?zvu rostliny,
+	?krt?k se p?esune na prvn? vyhovuj?c? z?znam.
+	Nap??klad rychle po sob? stisknut? p?smena Z, E, L, K povedou na
+	"Zelkova serrata (Thunb.) Makino". 
+	Na velikosti p?smen nez?le??.
+	Nejdel?? prodleva mezi jednotliv?mi znaky je 1 sekunda;
+	pot? je dal?? znak ch?p?n jako vyhled?v?n? jin? rostliny.
 	</p>
 
+	<p>
+	Ozna?en? a zru?en? ozna?en? z?znamu provedete klinut?m lev?ho tla??ka my?i nebo mezern?kem.
+	Zru?en? ozna?en? v?ech z?znam? provedete stiskem tla??tka "Odzna?it v?e".
+	</p>
 
-	<h2>Vlastn? ?krtac? seznam</h2>
+	<p>
+	<img src="picture/ChecklistDefault.jpg" alt="?krt?k po otev?en?.">
+	</p>
 
 	<p>
-	Pro je?t? v?t?? pohodl? je mo?n? vytvo?it si ze seznamu rostlin vlastn? ?krt?k.
-	Vyberte ze z?kladn?ho seznamu v?echny z?znamy, ze kter?ch se m? vytvo?it nov? ?krt?k
-	a klikn?te na "Vytvo?it". 
+	Stiskem tla??tka "Vlo?it" vlo??te ozna?en? rostliny do dialogu pro p?id?v?n? n?lezov?ch dat.
 	</p>
 
-	<div style="position: relative; left: 30; top: 10"><br>
-	<img src="picture/ChecklistCreate.jpg" alt="Vytv??en? ?krt?ku.">
-	</div>
 
+
+	<h2>2. Vytv??en? a na??t?n? vlastn?ho ?krtac?ho seznamu</h2>
+
 	<p>
-	Vytvo?en? ?krt?k si m??ete ulo?it pod zvolen?m jm?nem a p???t? jej pomoc? tla??tka
-	"Nahr?t" m??ete rovnou vyu??t.
+	Pokud v?m seznam v?ech dostupn?ch rostlin p?ijde p??li? obs?hl?, nebo? na v?mi
+	mapovan? lokalit? roste ??dov? jen n?kolik stovek druh?, vytvo?te si vlastn? ?krtac? seznam,
+	kter? bude obsahovat jm?na t?ch rostlin, kter? pova?ujete za nutn?.
 	</p>
 
 	<p>
-	?krtac? seznam m??e vypadat n?jak takto:
+	Ozna?te n?zvy v?ech rostlin, kter? chcete ve v?sledn?m ?krt?ku m?t, a stiskn?te tla??tko
+	"Vytvo?it". Ulo?te ?krt?k do souboru, ze kter?ho jej budete moci p???t? nahr?t tla??tkem "Nahr?t".
 	</p>
-
-
-	<div style="position: relative; left: 30; top: 10"><br>
-	<img src="picture/ChecklistUsage.jpg" alt="Nov? ?krt?k.">
-	</div>
-
 	
 	<p>
-	Pro odzna?en? v?ech z?znam? nar?z pou?ijte tla??tko "Odzna?it v?echny".
-	Pro zobrazen? v?ech jmen rostlin (jako na za??tku), stiskn?te tla??tko "Obnovit".
+	Vlastn? ?krtac? seznam m??e vypadat t?eba takto:
 	</p>
 
 	<p>
-	Pozn?mka: Tla??tka "Obnovit" a "Nahr?t" nezru?? v?mi vybran? polo?ky. Pokud se stane, ?e ve va?em
-	vlastn?m ?krt?ku nen? n?jak? rostlina, m??ete bez obav stisknout tla??tko "Obnovit", kter? na?te seznam
-	v?ech rostlin, ani? by po?kodilo seznam v?mi ji? ozna?en?ch rostlin.
+	<img src="picture/ChecklistUsage.jpg" alt="Nov? ?krt?k.">
 	</p>
 
+	
+	<p>
+	Tla??tko "Obnovit" vrac? seznam rostlin do p?vodn?ho stavu obsahuj?c?ho v?echny rostliny
+	v datab?zi. Obnoven? ?krt?ku neru?? v?mi ozna?en? polo?ky - pokud se stane, ?e ve va?em
+	vlastn?m ?krt?ku nen? n?jak? rostlina, stiskn?te tla??tko "Obnovit" a dopl?te chyb?j?c?
+	rostlinu z ?pln?ho seznamu.
+	</p>
 
-	<p>
-	Po dokon?en? v?b?ru rostlin stiskn?te "Vlo?it" a v?echny vybran? rostliny budou vlo?eny do
-	seznamu v <a href="./addoccurrence.html">P?id?v?n? z?znam?</a>.
-	</p>  
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -9,8 +9,8 @@
   <h1>Export dat</h1>
 	<p>
 	Va?e n?lezov? data jsou p?i pr?ci s Plantlore uchov?v?na v datab?zi. 
-	K dat?m nelze p?istupovat p??mo; pro p?enos sv?ch dat na jin?
-	po??ta?e vy?aduje pou?it? Exportu. 
+	K dat?m nelze p?istupovat p??mo; p?enos dat na jin?
+	po??ta?e vy?aduje pou?it? Exportu a <a href="./import.html">Importu</a>. 
 	Export dat slou?? k "vyta?en?" n?lezov?ch dat z datab?ze
 	a ulo?en? do souboru na disku va?eho po??ta?e.
 	</p>
@@ -31,8 +31,8 @@
 
 	<p>
 	<ol>
-		<li>1. Co je nutn? prov?st p?ed t?m, ne? za?nete exportovat</li>
-		<li>2. Vlastn? export z?znam?</li>
+		<li>Co je nutn? prov?st p?ed t?m, ne? za?nete exportovat</li>
+		<li>Vlastn? export z?znam?</li>
 	</ol>
 	</p>
 

Modified: trunk/src/net/sf/plantlore/help/cs/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -7,63 +7,68 @@
   </head>
   <body>
   <h1>Import n?lezov?ch dat</h1>
+
 	<p>
+	Va?e n?lezov? data jsou p?i pr?ci s Plantlore uchov?v?na v datab?zi. 
+	K dat?m nelze p?istupovat p??mo; p?enos  dat na jin?
+	po??ta?e vy?aduje pou?it? <a href="./export.html">Exportu</a> a Importu. 
 	Import slou?? k znovuna?ten? n?lezov?ch dat ze souboru na disku do datab?ze programu.
-	Jde o komplement <a href="./export.html">Exportu</a>.
 	</p>
 
 	<p>
-	Import lze prov?d?t po p?ihl??en? k jak?koli datab?zi - tedy i k datab?zi vzd?len?.
+	Import lze prov?d?t po p?ihl??en? k jak?koli datab?zi - i datab?zi vzd?len?.
 	U vzd?len?ho p?ipojen? je nutn? uv??it p?enosovou kapacitu linky, 
-	kterou pou??v?te pro p?ipojen?, 
-	nebo? p?en??en? mno?stv? dat m??e b?t velk? a doba nutn? 
-	k naimportov?n? n?lezov?ch dat by byla ne?nosn?.
+	kterou pou??v?te pro p?ipojen?, nebo? se m??e p?en??et zna?n? mno?stv? dat 
+	a doba nutn? k proveden? cel? operace by byla ne?nosn?.
 	</p>
 
+	<p>
+	P?i importu n?lezov?ch dat doch?z? k modifikaci obsahu datab?ze.
+	Aby se p?ede?lo neopr?vn?n? manipulaci s daty, je pot?eba m?t k importu
+	dostate?n? u?ivatelsk? pr?va. Nem?te-li pr?vo p?id?vat z?znamy, import neusp?je nikdy.
+	O pr?vech se pojedn?v? v sekci <a href="./user.html">Spr?va u?ivatel?</a>.
+	</p>
 
-	<h2>1. Vlastn? import n?lezov?ch dat</h2>
 
+	<h2>Obsah</h2>
+
 	<p>
+	<ol>
+		<li>Importov?n? n?lezov?ch dat</li>
+		<li>Detailn? popis pr?b?hu importu</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Importov?n? n?lezov?ch dat</h2>
+
+	<p>
 	Import za??n? v?b?rem souboru, v n?m? jsou ulo?ena n?lezov? data.
 	V sou?asn? dob? je podporov?n pouze import z XML soubor?, kter?
 	odpov?daj? PlantloreNative form?tu.
 	</p>
 
 	<p>
-	Po v?b?ru souboru je zobrazeno okno zobrazuj?c? pr?b?h procesu importov?n? dat. 
-	Import lze p?eru?it stiskem tla??tka <i>Storno</i>. 
-	P?eru??te-li Import, n?lezov? data, kter? se stihla naimportovat, v datab?zi z?stanou.
+	Po v?b?ru souboru je zah?jen import dat. Pr?b?h procesu m??ete sledovat v otev?en?m okn?.
+	Import lze zru?it stiskem tla??tka "Storno". 
+	Zru??te-li Import, n?lezov? data, kter? se stihla naimportovat, v datab?zi z?stanou.
+	Pokud chcete naimportovan? z?znamy odstranit, pou?ijte <a href="./history.html">historii</a>,
+	kter? umo??uje vracen? operac? s datab?z? (undo).
 	</p>
 
 
-	<h2>2. Co je dobr? v?d?t p?i importu n?lezov?ch dat</h2>
+	<h2>2. Detailn? popis pr?b?hu importu</h2>
 
 	<p>
 	Import dat je <b>dlouhotrvaj?c?</b> operace, p?i n?? doch?z? k modifikaci datab?ze. 
-	Plantlore mus? zajistit,
-	aby nebyla po?kozena integrita st?vaj?c?ch n?lezov?ch dat. 
-	</p>
-
-	<p>
-	P?i importu m??e doj?t k situaci, kdy jsou n?kter? ??sti n?lezov?ho z?znamu sd?leny v?ce z?znamy
-	(nap?. Habitat). Pokud se do datab?ze importuj? n?lezov? data, kter? se ji? v datab?zi
-	nach?z? a p?itom se li??, budou sd?len? ??sti, kter? jsou odli?n?, nahrazeny nov?mi
-	(aktualizovan?mi), p?i?em? p?vodn? ??st z?stane nedot?ena.
-	<br/>
-	Pokud nap??klad n?lezov? z?znamy A a B v datab?zi sd?l? habitat H a p?i importu naraz?me
-	na modifikaci z?znamu A s habitatem I, bude z?znamu A p?i?azen nov? habitat I, ale
-	nedojde k oprav? habitatu H. V datab?zi se pak budou nach?zet z?znamy A-I a B-H, oba
-	dva s r?zn?mi habitaty.
-	</p>
-
-	<p>
-	Zam?tnut? z?znamu, tj. neproveden? po?adovan? operace s n?lezov?m z?znamem, 
-	m??e nastat z n?sleduj?c?ch d?vod?:
+	Plantlore zaji??uje, aby nebyla po?kozena integrita nebo bezpe?nost st?vaj?c?ch n?lezov?ch dat. 
+	Vkl?d?n? z?znamu se proto nemus? zda?it. Zam?tnut? z?znamu, 
+	tj. neproveden? po?adovan? operace, m??e nastat z n?sleduj?c?ch d?vod?:
 	<ol>
 		<li>
-		Nedostate?n? opr?vn?n? - nem?te-li pr?vo n?lezov? data modifikovat -
-		typicky nesm?te modifikovat z?znamy, kter? jste v datab?zi sami nevytvo?ili. 
-		V?ce o pr?vech lze nal?zt v sekci <a href="./user.html">Pr?va u?ivatel?</a>.
+		Nedostate?n? opr?vn?n? - nap?. nem?te pr?vo p?id?vat nov? n?lezov? data
+		nebo pr?vo modifikovat z?znamy jin?ch u?ivatel?.
+		V?ce o pr?vech lze nal?zt v sekci <a href="./user.html">Spr?va u?ivatel?</a>.
 		</li>
 
 		<li>
@@ -71,13 +76,35 @@
 		</li>
 
 		<li>
-		Nekorektn? z?znam, tj. z?znam, kter? obsahuje data, kter? nelze dohledat
-		v datab?zi - plat? pro tabulky Plants, Villages, Phytochoria, Territories
-		a Metadata. Do datab?ze nap?. nelze vlo?it n?lez, kter? obsahuje rostlinu,
-		kter? se nenach?z? v datab?zi. V?ce v 
+		Nekorektn? z?znam, tj. z?znam, kter? obsahuje ??sti, kter? nelze dohledat
+		v datab?zi. Do datab?ze nelze vlo?it n?lez, kter? obsahuje rostlinu,
+		nejbli??? v?t?? s?dlo, fytochorion nebo teritorium,
+		kter? se nenach?z? v datab?zi.
+		D?vody pro toto opat?en? jsou uvedeny v sekci
 		<a href="./table_import.html">Import dat do tabulek</a>.
 		</li>
 	</ol>
+	P?edchoz? seznam ud?v? d?vody zam?tnut? z?znamu, kter? nevedou ke zru?en? importu.
+	Pokud soubor, z n?ho? maj? b?t z?znamy na?teny, 
+	m? neplatn? nebo nezn?m? form?t, dojde k automatick?mu zru?en? importu, jako kdybyste
+	stiskli tla??tko "Storno".
 	</p>  
+
+
+	<p>
+	Export a Import byl navr?en i pro snadn? p?en??en? zm?n v n?lezov?ch datech mezi dv?ma
+	datab?zemi. Pou??v?te-li Plantlore nap??klad doma i v pr?ci, m??ete ??st zm?n prov?st
+	doma a pot? dan? zm?ny prom?tnout do datab?ze v pr?ci. Uka?me si to na p??kladu.
+	Doma vytvo??te novou lokalitu, ?ekn?me "50 metr? od prav?ho b?ehu ?eky Jihlavy".
+	V t?to lokalit? jste identifikovali dv? rostliny, Rubus saxatilis L. a Caltha palustris.
+	Po p?id?n? t?chto dvou rostlin provedete export t?chto dvou z?znam? a p?enesete je 
+	na sv? pracovi?t?, kde z?znamy importujete. V pr?ci zjist?te, ?e se nejednalo
+	o Rubus saxatilis L, n?br? o Rubus albocarpaticus, a 
+	<a href="./addoccurrence.html">editac?</a>
+	provedete zm?nu. P?enesete-li
+	potom data dom? a importujete-li je, zm?na se projev? i ve va?? dom?c? datab?zi.
+	</p>
+
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -6,25 +6,32 @@
     <title>P?ipojov?n? k datab?zi</title>
   </head>
   <body>
-  <h1>P?ipojov?n? k datab?zi</h1>
+  <h1>P?ipojov?n? k datab?zi a Odhla?ov?n? od datab?ze</h1>
+
+
+  	<p>
+	P?ed zapo?et?m pr?ce s Plantlore je zapot?eb? se p?ihl?sit k datab?zi, se kterou chcete pracovat.
+	</p>
+
+
+	<h2>Obsah</h2>
+
 	<p>
-	V t?to sekci se dozv?te:
 	<ol>
-		<li><a href="#NewConnection">Jak se p?ipojit k datab?zi.</a></li>
-		<li><a href="#AddDBInfo">Jak vytvo?it nov? z?znam pro p?ipojen? k datab?zi.</a></li>
-		<li><a href="#EditDeleteDBInfo">Jak upravit nebo vymazat z?znam pro p?ipojen? k datab?zi.</a></li>
-		<li><a href="#LoginErrorMessages">Jak? probl?my p?i p?ipojov?n? mohou nastat a jak je ?e?it.</a></li>
+		<li>Proces p?ipojen? k datab?zi</li>
+		<li>Vytv??en? z?znam? o datab?zi</li>
+		<li>?prava a maz?n? z?znam? o datab?zi</li>
+		<li>Nej?ast?j?? probl?my p?i p?ipojov?n?</li>
+		<li>Odhl??en? od datab?ze</li>
+		<li>Obnova ztracen?ho p?ipojen?</li>
 	</ol>
 	</p>
 
 
-	<hr/>
+	<h2>1. Proces p?ipojen? k datab?zi</h2>
 
-
-	<h2 id="NewConnection">1. Jak se p?ipojit k datab?zi</h2>
-
 	<p>
-	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, je prvn? krok p?i pr?ci s Plantlore. 
+	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, prob?h? ve dvou kroc?ch.
 	</p>
 
 	<h3>1.1. V?b?r datab?ze</h3>
@@ -34,16 +41,16 @@
 	</p>
 
 	<p>
-	Po instalaci Plantlore je k disposici pouze jedna datab?ze pojmenovan? <i>Uk?zkov? datab?ze</i>.
-	Tato datab?ze neobsahuje ??dn? z?znamy, ??dn? n?lezov? data, a je p?ipravena pro zapo?et? pr?ce.
+	Po instalaci Plantlore je k disposici jedna datab?ze pojmenovan? "Uk?zkov? datab?ze".
+	Tato datab?ze neobsahuje ??dn? n?lezov? data a je p?ipravena pro zapo?et? pr?ce.
+	Neobsahuje-li seznam datab?z? ??dn? z?znam, budete jej muset vytvo?it - o tom pojedn?v?
+	druh? ??st t?to n?pov?dy.
 	</p>
 
 	<p>
-	Neobsahuje-li seznam datab?z? ??dn? z?znam, budete jej muset nejprve <a href="#AddDBInfo">vytvo?it</a>. 
-	Po jist? dob? pou??v?n? Plantlore m??e V?? seznam datab?z? vypadat podobn? jako ten na obr?zku.
-	Plantlore automaticky zv?razn? jako vybranou tu datab?zi, kterou jste zvolili p?i posledn?m
-	p?ihla?ov?n?.
-	Vyberte jednu z datab?z? v seznamu a stiskn?te tla??tko <i>Pokra?uj</i>.
+	Po jist? dob? pou??v?n? Plantlore m??e v?? seznam datab?z? vypadat podobn? jako ten na obr?zku.
+	Plantlore automaticky p?edvol? tu datab?zi, kterou jste zvolili p?i posledn?m p?ihla?ov?n?.
+	Vyberte jednu z datab?z? v seznamu a stiskn?te tla??tko "Pokra?uj".
 	</p>
 
 
@@ -56,7 +63,9 @@
 	Pokud se p?ihla?ujete poprv?, zadejte p?ihla?ovac? ?daje, 
 	kter? jste pou?ili p?i instalaci Plantlore.
 
-	Nov? u?ivatelsk? jm?no a heslo sm? p?id?lit pouze spr?vce datab?ze.
+	Nov? u?ivatelsk? jm?no a heslo sm? z bezpe?nostn?ch d?vod? p?id?lit pouze administr?tor datab?ze.
+	?asto i zku?en? u?ivatel? pou??vaj? velmi slab? hesla, proto je jejich p?id?lov?n?
+	p?enech?no jemu.
 	</p>
 	
 	<p>
@@ -66,29 +75,24 @@
 	<p>
 	Plantlore si pamatuje n?kolik posledn?ch u?ivatelsk?ch jmen vkl?dan?ch p?i p?ihl??ov?n?;
 	m??ete vybrat jedno z p?ipraven?ho seznamu, nebo zadat jin? u?ivatelsk? jm?no.
-	Hesla si Plantlore nikdy neukl?d? - automaticky je tedy nenab?z?.
-	Po zad?n? ?daj? stiskn?te tla??tko <i>P?ihl?sit</i>. 
+	Hesla Plantlore neukl?d? a automaticky je nikdy nenab?z?.
+	Po zad?n? ?daj? stiskn?te tla??tko "P?ihl?sit". 
 	</p>
 
 	<p>
-	Stiskem tla??tka p?ihl?sit se Plantlore pokus? p?ipojit k vybran? datab?zi se zadan?mi
+	Stiskem tla??tka "P?ihl?sit" se Plantlore pokus? p?ipojit k vybran? datab?zi se zadan?mi
 	p?ihla?ovac?mi ?daji. P?ipojen? m??e (zejm?na pokud se p?ipojujete ke vzd?len? datab?zi)
-	trvat del?? dobu - o pr?b?hu p?ipojov?n? informuje jednoduch? dialog.
+	trvat del?? dobu.
 	</p>
 
-	<p>
-	<img src="picture/LoginInitialization.png" alt="Pr?b?h p?ipojov?n? k datab?zi.">
-	</p>
 
 	<p>
-	Pokud se p?ihl??en? z n?jak?ho d?vodu nezda??, budete o tom informov?ni kr?tkou 
-	<a href=#LoginErrorMessages">zpr?vou</a>.
-	 
+	Pokud se p?ihl??en? z n?jak?ho d?vodu nezda??, budete o tom informov?ni kr?tkou zpr?vou.
 	V opa?n?m p??pad? Plantlore zobraz? z?kladn? <a href="./overview.html">P?ehled</a>.
 	</p>
 
 
-	<h2 id="AddDBInfo">2. Jak vytvo?it a p?idat nov? z?znam</h2>
+	<h2 id="AddDBInfo">2. Vytv??en? z?znam? o datab?z?ch</h2>
 
 	<p>
 	Chcete-li se p?ipojit k jin? datab?zi, 
@@ -98,7 +102,7 @@
 
 	<p>
 	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho
-	tla??tka my?i. Vyberte polo?ku <i>P?idat</i> a klikn?te na ni.
+	tla??tka my?i. Vyberte polo?ku "P?idat" a klikn?te na ni.
 	</p>
 
 	<p>
@@ -106,11 +110,11 @@
 	</p>
 
 	<p>
-	P?id?n? nov?ho z?znamu pro p?ipojen? k jin? datab?zi je rozd?leno na dv? ??sti, 
+	P?id?n? nov?ho z?znamu pro p?ipojen? k datab?zi je rozd?leno na dv? ??sti, 
 	jim? odpov?daj? dv? z?lo?ky na dialogu. 
 	<ul>
 		<li>
-		Prvn? z nich je <b>p??m? p?ipojen?</b>, neboli lok?ln? p?ipojen?. 
+		Prvn? z nich je <b>p??m? p?ipojen?</b>, t?? lok?ln? p?ipojen?. 
 		P??m? p?ipojen? k datab?zi lze pou??t pouze v p??pad?,
 		?e vytvo?en? datab?ze se nach?z? v datab?zov?m stroji (database engine), kter? b??? na
 		tomto po??ta?i, tzv. lok?ln?. P??m? p?ipojen? vy?aduje pon?kud odli?n? parametry ne? 
@@ -118,14 +122,13 @@
 		s datab?z? se nemus? nijak upravovat pro p?enos po s?ti.
 		</li>
 		<li>
-		Druh? mo?nost je tzv. <b>vzd?len? p?ipojen?</b>, neboli p?ipojen? ke vzd?len? datab?zi.
+		Druh? mo?nost je tzv. <b>vzd?len? p?ipojen?</b>, p?ipojen? ke vzd?len? datab?zi.
 		Vzd?len? datab?ze se typicky nach?z? v datab?zov?m stroji (database engine), kter? je
 		spu?t?n na jin?m po??ta?i v s?ti. Pomoc? tohoto p?ipojen? je mo?n? pracovat s datab?z?
 		"na d?lku". Nev?hodou je zpomalen? dan? jednak propustnost? datov? linky a jednak 
 		nutnost? speci?ln? upravovat p?en??en? data kv?li p?enosu po s?ti. 
 		</li>
 	</ul>
-	Popi?me si parametry nutn? pro p??m? a vzd?len? p?ihla?ov?n?.
 	</p>
 
 
@@ -143,20 +146,20 @@
 			<td>
 				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
 				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
-				kup??kladu: <i>Dom?c? datab?ze</i>, <i>Projekt mapov?n? ?esk?ho st?edoho??</i>.
+				nap??klad: "Dom?c? datab?ze", "Projekt mapov?n? ?esk?ho st?edoho??".
 			</td>
 		</tr>
 		<tr>
-			<td>Datab?zov? stoj (engine)</td>
+			<td>Datab?zov? stroj (engine)</td>
 			<td>
 				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
 				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
 				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
 				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
-				bezesporu pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
 				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
 				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
-				aby s n?m mohl bezchybn? komunikovat. Plantlore je standardn? dod?v?n
+				aby s n?m bylo mo?n? bezchybn? komunikovat. Plantlore je standardn? dod?v?na
 				s Postgre. Aktu?ln? podporovan? DB stroje jsou seps?ny v rozbalovac?
 				nab?dce, ale je mo?n? specifikovat i jin?.
 			</td>
@@ -166,7 +169,7 @@
 			<td>
 				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
 				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
-				Pro spr?vn? p?ipojen? je nutn?, aby u?ivatel vyplnil i identifik?tor (jm?no)
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor (jm?no)
 				datab?ze, se kterou chce pracovat.
 			</td>
 		</tr>
@@ -177,7 +180,7 @@
 				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore v?d?l,
 				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
 				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
-				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Kup??kladu standardn? port datab?zov?ho
+				vyu??vaj? porty v rozsahu 1.024 a v??e. Nap??klad standardn? port datab?zov?ho
 				stroje Postgre je 5432.
 			</td>
 		</tr>
@@ -185,21 +188,20 @@
 			<td>Parametr</td>
 			<td>
 				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
-				zp?sobem. N?kter? stroje kup??kladu vy?aduj? explicitn? nastaven? k?dov?n?
-				znak? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou??
-				pro spr?vn? nastaven? dodate?n?ch paremetr? p?ipojen? k datab?zov?mu stroji.
-				P?ipojen? k Postgre ??dn? parametr nevy?aduje, ale nap?. pro spr?vn? zobrazen?
-				diakritiky od Firebird je pot?eba k?dov?n? nastavit.
+				zp?sobem. N?kter? stroje nap??klad vy?aduj? explicitn? nastaven? k?dov?n?
+				znak?. Parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
+				P?ipojen? k Postgre ??dn? parametr nevy?aduje.
 				<br/>
-				Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za ?
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za "?".</i>
 			</td>
 		</tr>
 	</table>
 	</p>
 
 	<p>
-	Na uk?zku uve?me, jak by vypadalo lok?ln? p?ipojen? k datab?zi nazvan? <i>plantlore</i>,
-	kter? je ulo?ena v datab?zov?m stroji <i>Postgre</i>, kter? naslouch? na portu <i>5432</i>.
+	Na uk?zku uve?me, jak by vypadalo lok?ln? p?ipojen? k datab?zi nazvan? "plantlore",
+	kter? je ulo?ena v datab?zov?m stroji "Postgre", kter? naslouch? na portu "5432".
 	</p>
 
 	<p>
@@ -221,7 +223,7 @@
 			<td>
 				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
 				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
-				kup??kladu: <i>Ofici?ln? datab?ze Jiho?esk? pobo?ky ?BS</i>.
+				nap??klad: "Ofici?ln? datab?ze Jiho?esk? pobo?ky ?BS".
 			</td>
 		</tr>
 		<tr>
@@ -229,11 +231,11 @@
 			<td>
 				Datab?zov? stroj obsahuj?c? datab?zi, k n?? se chceme p?ipojit, b??? na jin?m
 				po??ta?i v s?ti. Tento parametr identifikuje tento po??ta? a to bu? podle
-				jeho tzv. hostname nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
 				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
-				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, kup?. <i>192.168.0.247</i>.
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
 				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
-				<i>data.domacisit.info</i>. C?lov? po??ta? lze tedy identifikovat 
+				"data.domacisit.cz". C?lov? po??ta? lze identifikovat 
 				ob?ma zp?soby.
 			</td>
 		</tr>
@@ -244,7 +246,7 @@
 				na uveden?m vzd?len?m po??ta?i kontaktovat 
 				<a href="./server.html">Plantlore Server</a>, co? je speci?ln?
 				aplikace, kter? m? za ?kol zprost?edkov?vat p?ipojen? vzd?len?m klient?m a
-				dohl??et na po?et p?ipojen?ch u?ivatel?. Tato slu?ba (aplikace) mus? b?t p??stupn?
+				dohl??et na po?et p?ipojen?ch u?ivatel?. Tato slu?ba mus? b?t p??stupn?
 				na vzd?len?m po??ta?i, kde se nach?z? i vzd?len? datab?zov? stroj, 
 				a naslouch? na n?jak?m portu. Standardn? port, na kter?m je tato slu?ba
 				dostupn?, je 1099.
@@ -255,7 +257,7 @@
 			<td>
 				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
 				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
-				Pro spr?vn? p?ipojen? je nutn?, aby u?ivatel vyplnil i identifik?tor (jm?no)
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor
 				datab?ze, se kterou chce pracovat.
 			</td>
 		</tr>
@@ -263,10 +265,10 @@
 	</p>
 	
 	<p>
-	Na uk?zku uve?me, jak by vypadalo nastaven? pro vzd?len? p?ipojen? k datab?zi nazvan? <i>plantlore</i>,
+	Na uk?zku uve?me, jak by vypadalo nastaven? pro vzd?len? p?ipojen? k datab?zi nazvan? "plantlore",
 	kter? je ulo?ena v datab?zov?m stroji, 
-	kter? se nach?z? na po??ta?i s adresou <i>192.168.0.247</i>, 
-	a Plantlore Server naslouch? na portu <i>1099</i>.
+	kter? se nach?z? na po??ta?i s adresou "192.168.0.247", 
+	a Plantlore Server naslouch? na portu "1099".
 	</p>
 
 	<p>
@@ -283,12 +285,12 @@
 
 
 
-	<h2 id="EditDeleteDBInfo">3. Jak upravit nebo vymazat z?znam pro p?ipojen? k datab?zi</h2>
+	<h2>3. ?prava a maz?n? z?znam? o datab?zi</h2>
 
 	<p>
 	V seznamu datab?z? ozna?te z?znam, kter? chcete upravit nebo smazat.
 	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho tla??tka my?i. 
-	Vyberte polo?ku Editovat nebo Odstranit a klikn?te na ni.
+	Vyberte polo?ku "Editovat" nebo "Odstranit" a klikn?te na ni.
 	</p>
 
 	<p>
@@ -297,11 +299,11 @@
 
 	<p>
 	?prava z?znam? je shodn? s dialogem pro p?id?n? z?znamu, ale obsahuje p?edvypln?n? hodnoty.
-	Detailn? popis lze naj?t v ??sti <a href="#AddDBInfo">Jak vytvo?it nov? z?znam pro p?ipojen? k datab?zi</a>.
+	Detailn? popis lze naj?t v p?edch?zej?c? ??sti.
 	</p>
 
 	<p>
-	Odstran?n? z?znamu se prov?d? ?pln? stejn?.
+	Odstran?n? z?znamu dal?? nastaven? nem?.
 	</p>
 
 	<p>
@@ -318,14 +320,14 @@
 
 
 
-	<h2 id="LoginErrorMessages">Jak? probl?my p?i p?ipojov?n? mohou nastat a jak je ?e?it</h2>
+	<h2>4. Nej?ast?j?? probl?my p?i p?ipojov?n?</h2>
 
 	<p>
 	Nej?ast?j?? probl?my p?i p?ipojov?n? jsou tyto:
-	<ul>
+	<ol>
 		<li>
 		Nespr?vn? vypln?n? p?ihla?ovac? ?daje - u?ivatelsk? jm?no nebo ?patn? zadan? heslo.
-		Ov??te, zda jste spr?vn? vlo?ili ob? hodnoty, p??padn? zda m?te vytvo?en?
+		Ov??te, zda jste spr?vn? zadali oba ?daje, p??padn? zda m?te vytvo?en?
 		odpov?daj?c? u?ivatelsk? ??et v datab?zi, k n?? se p?ipojujete.
 		</li>
 		<li>
@@ -339,7 +341,31 @@
 		Ov??te, ?e datab?zov? stroj je zapnut?, resp. se ujist?te, ?e na vzd?len?m po??ta?i
 		je spu?t?n Plantlore Server.
 		</li>
-	</ul>
-	</p>  
+	</ol>
+	</p>
+
+
+
+	<h2>5. Odhl??en? od datab?ze</h2>
+
+	<p>
+	Po skon?en? pr?ce s datab?z? je doporu?eno se odhl?sit, aby t?et? osoba nez?skala mo?nost
+	pracovat s va?imi daty. Odhl??en? provedete bu? v menu polo?kou "Odhl?sit" nebo
+	vypnut?m Plantlore. Oba zp?soby jsou ekvivalentn?.
+	</p>
+
+
+	<h2>6. Obnova ztracen?ho p?ipojen?</h2>
+
+	<p>
+	P?i pr?ci s Plantlore m??e doj?t k n?hl? ztr?t? p?ipojen? k datab?zi nebo vzd?len?mu serveru.
+	D?vodem m??e b?t neo?ek?van? vypnut? nebo p?d datab?zov?ho stroje nebo Serveru ?i v?padek s??ov?ho spojen?.
+	O tomto stavu jste informov?ni kr?tkou zpr?vou, kter? popisuje probl?m, ke kter?mu do?lo.
+	V p??pad? ztracen?ho spojen? s datab?z? nebo Serverem vy?kejte n?jakou dobu a zkuste 
+	v menu vybrat "Znovu p?ipojit". Plantlore se pokus? nav?zat nov? spojen?. 
+	"Znovu p?ipojit" m??ete volat opakovan?.
+	</p>
+
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -6,10 +6,10 @@
     <title>Plantlore Server</title>
   </head>
   <body>
-	<h1 id="PurposeOfTheServer">Smysl serveru</h1>
+	<h1>Plantlore Server</h1>
 
 	<p>
-	Aby se mohli k Va?? datab?zi p?ipojovat i jin? u?ivatel? z po??ta?? v s?ti, 
+	Aby se mohli k va?? datab?zi p?ipojovat i jin? u?ivatel? z po??ta?? v s?ti, 
 	mus? b?t spu?t?n Plantlore Server. 
 	Server zprost?edkov?v? p?ipojen? vzd?len?m klient?m a dohl??? na dodr?ov?n?
 	p?edepsan?ho po?tu klient?. Standardn? se z jednoho po??ta?e (z jedn? IP adresy)
@@ -17,13 +17,26 @@
 	u?ivatel? je omezen na 32.
 	</p>
 
-	<h2 id="HowToRunTheServer">1. Spu?t?n? (vytvo?en?) serveru</h2>
 
+	<h2>Obsah</h2>
+
 	<p>
-	Nastaven? serveru lze prov?st na z?lo?ce <i>Spustit nov? server</i>.
+	<ol>
+		<li>Vytvo?en? a spu?t?n? nov?ho serveru</li>
+		<li>P?ipojen? k existuj?c?mu serveru za ??elem administrace</li>
+	</ol>
 	</p>
 
+
+
+
+	<h2>1. Vytvo?en? a spu?t?n? nov?ho serveru</h2>
+
 	<p>
+	Nastaven? serveru lze prov?st na z?lo?ce "Spustit nov? server".
+	</p>
+
+	<p>
 	<img src="picture/ServerCreate.png" alt="Spu?t?n? serveru.">
 	</p>
 
@@ -54,7 +67,7 @@
 				Heslo
 			</td>
 			<td>
-				Po spu?t?n? je mo?n? server <a href="#ManagingTheServer">administrovat</a> 
+				Po spu?t?n? je mo?n? server administrovat 
 				i ze vzd?len?ho po??ta?e.
 				Aby k n?mu nem?ly p??stup nepovolan? osoby, 
 				je mo?n? nastavit heslo, kter?m bude server chr?n?n.
@@ -75,7 +88,7 @@
 				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
 				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
 
-				Porty nelze sd?let - mus?te se ujistit, ?e na zvolen? port ji?
+				Porty nelze sd?let - ujist?te se, ?e na zvolen? port ji?
 				n?kter? jin? aplikace nepou??v?.
 
 				Standardn? port je 1099.
@@ -106,11 +119,11 @@
 				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
 				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
 				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
-				bezesporu pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
 				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
 				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
 				aby s n?m mohl bezchybn? komunikovat. Plantlore je standardn? dod?v?n
-				s Postgre. Aktu?ln? podporovan? DB stroje jsou seps?ny v rozbalovac?
+				s Postgre. Aktu?ln? podporovan? DB stroje jsou vyps?ny v rozbalovac?
 				nab?dce, ale je mo?n? specifikovat i jin?.
 			</td>
 		</tr>
@@ -124,7 +137,7 @@
 				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore Server v?d?l,
 				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
 				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
-				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Kup??kladu standardn? port datab?zov?ho
+				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Nap??klad standardn? port datab?zov?ho
 				stroje Postgre je 5432.
 			</td>
 		</tr>
@@ -136,12 +149,12 @@
 			<td>
 				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
 				zp?sobem. N?kter? stroje kup??kladu vy?aduj? explicitn? nastaven? k?dov?n?
-				znak? (UTF-8, ISO-8859-2, Windows CodePage 1250, apod.) Tenot parametr slou??
-				pro spr?vn? nastaven? dodate?n?ch paremetr? p?ipojen? k datab?zov?mu stroji.
+				znak?. Tenot parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
 				P?ipojen? k Postgre ??dn? parametr nevy?aduje, ale nap?. pro spr?vn? zobrazen?
 				diakritiky od Firebird je pot?eba k?dov?n? nastavit.
 				<br/>
-				Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za ?
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za :?:</i>
 			</td>
 		</tr>
 
@@ -150,13 +163,13 @@
 
 
 
-	<h2 id="HowToConnectToTheServer">2. P?ipojen? k b???c?mu serveru</h2>
+	<h2>2. P?ipojen? k b???c?mu serveru</h2>
 
 
 	<p>
 	V?te-li, ?e n?kde b??? server, kter? jste spustili, m??ete jej vzd?len?  
-	<a href="#ManagingTheServer">administrovat</a>. Nejprve se k tomuto serveru
-	mus?te p?ipojit pomoc? z?lo?ky <i>P?ipojen? k b???c?mu serveru</i>.
+	administrovat. Nejprve se k tomuto serveru
+	mus?te p?ipojit pomoc? z?lo?ky "P?ipojen? k b???c?mu serveru".
 	</p>
 
 	<p>
@@ -185,11 +198,11 @@
 			</td>
 			<td>
 				Tento parametr identifikuje po??ta?, kde server b???, a to bu? podle
-				jeho tzv. hostname nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
 				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
-				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, kup?. <i>192.168.0.247</i>.
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
 				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
-				<i>data.domacisit.info</i>. 
+				"data.domacisit.cz". 
 			</td>
 		</tr>
 
@@ -222,13 +235,13 @@
 
 
 
-	<h2 id="ManagingTheServer">3. Administrace (spr?va) serveru</h2>
+	<h2>3. Administrace serveru</h2>
 
 	<p>
 	Administrace slou?? p?edev??m k z?sk?n? informac? o aktu?ln? p?ipojen?ch u?ivatel?ch
-	a vyp?n?n? serveru. Slu?n? administr?tor by m?l vy?kat, a? se v?ichni u?ivatel?
+	a vyp?n?n? serveru. Administr?tor by m?l vy?kat, a? se v?ichni u?ivatel?
 	odpoj?, ne? vypne server. Plantlore Server neimplementuje ??dn? zp?sob 
-	notifikace klient?, m?-li b?t server vypnut.
+	upozor?ov?n? klient?, m?-li b?t server vypnut.
 	</p>
 
 	<p>
@@ -236,23 +249,32 @@
 	</p>
 
 	<p>
-	Po p?ipojen?/vytvo?en? k serveru je k disposici seznam aktu?ln? p?ipojen?ch u?ivatel?.
+	Po p?ipojen?/vytvo?en? k serveru je k dispozici seznam aktu?ln? p?ipojen?ch u?ivatel?.
 	D?le je mo?n? prov?st n?sleduj?c? operace:
 	<ul>
 		<li><b>Obnovit</b>.
 		Aktualizuje seznam s u?ivateli p?ihl??en?mi k tomuto serveru.
 		</li>
 		<li><b>Vyhodit</b>.
-		Odpoj? v?echny vybran? (ozna?en?) klienty od serveru (tzv. kick).
+		Odpoj? ozna?en?ho klienta od serveru (tzv. kick).
 		Odpojen? je n?siln? a p?eru?? v?echny operace, kter? klient prov?d?.
-		Neslou?? k zabr?n?n? op?tovn?ho p?ipojen? k serveru.
+		Neslou?? k zabr?n?n? op?tovn?ho p?ipojen? k serveru, proto?e blokov?n? IP
+		adresy m??e odstavit i jin? klienty. 
+		<br/>
+		V?znam spo??v? v tom, ?e poskytuje prost?edek, jak odpojit neuk?zn?n?
+		klienty, kte?? d?ky sv? nedbalosti pou??vaj? v?ce p?ipojen?, ne? je t?eba,
+		a mohou t?m blokovat jin? u?ivatele, kte?? maj? navenek stejnou IP adresu.
+		<br/>
+		Pokud chcete klientovi zabr?nit v op?tovn?m p?ipojen?, zaka?te jeho u?ivatelsk?
+		??et ve <a href="./import.html">Spr?v? u?ivatel?</a>.
 		</li>
 		<li><b>Zastavit</b>.
 		Ukon?? ?innost serveru, v?ichni u?ivatel? p?ihl??en? k tomuto serveru budou odpojeni
 		bez ohledu na to, zda maj? spu?t?ny n?jak? operace.
 		</li>
 		<li><b>Skr?t</b>.
-		Skryje okno, ale server nech? b??et.
+		Skryje okno, ale server nech? spu?t?n?. Pro pozd?j?? administraci se k Serveru mus?te
+		znovu p?ihl?sit, jak je pops?no v ??sti 2.
 		</li>
 	</ul>
 	</p>  

Modified: trunk/src/net/sf/plantlore/help/cs/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-06 17:40:58 UTC (rev 710)
+++ trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-06 17:43:59 UTC (rev 711)
@@ -3,43 +3,72 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Import dat</title>
+    <title>?prava dat</title>
   </head>
   <body>
-  <h1>Import dat do tabulek</h1>
+  <h1>?prava dat v tabulk?ch</h1>
+
+
+
 	<p>
-	Import dat do tabulek je ur?en pouze pro administr?tory datab?ze a slou?? k aktualizaci (p?edev??m k oprav?)
+	?prava dat v tabulk?ch je ur?ena v?hradn? pro administr?tory datab?ze a slou?? k aktualizaci 
 	dat v n?sleduj?c?ch tabulk?ch: 
 	Rostliny (Plants), Metadata, Fytochoriony, Teritoria a Nejbli??? v?t?? s?dla (Villages).
 	</p>
 
 	<p>
-	P?edpokl?d? se, ?e Plantlore bude dod?v?n se seznamem rostlin, Fytochorion?, Teritori? a
-	Nejbli???ch v?t??ch s?del; z?znamy obsa?en? v t?chto tabulk?ch mohou vznikat, zanikat, 
-	nebo obsahovat chyby. Jejich ?pravu lze zajistit naimportov?n?m speci?ln?ho souboru.
+	Jedn? se o tabulky, kter? obsahuj? data, 
+	je? mus? b?t udr?ov?na jednotn? nap??? v?emi datab?zemi, a tedy o jejich aktualizaci
+	by m?la pe?ovat zodpov?dn? osoba. N?lezov? data, kter? obsahuj? z?znamy s neplatn?mi ?daji 
+	v t?chto tabulk?ch, nen? mo?n? importovat z d?vodu ochrany kvality n?lezov?ch dat.
+	Nen? nap?. mo?n? p?i <a href="./import.html">Importu n?lezov?ch dat</a> vlo?it z?znam
+	obsahuj?c? neplatn? (tj. v tabulce Plants neexistuj?c?) rostliny.
 	</p>
 
+	<p>
+	Plantlore je dod?v?na se seznamem rostlin, fytochorion?, teritori? a
+	nejbli???ch v?t??ch s?del, kter? se nach?z? na ?zem? ?esk? republiky; 
+	z?znamy obsa?en? v t?chto tabulk?ch mohou vznikat, zanikat, 
+	nebo obsahovat chyby. Jejich ?pravu lze zajistit importov?n?m speci?ln?ho souboru.
+	</p>
 
-	<h2>1. Vlastn? import dat do tabulek</h2>
 
+
+	<h2>Obsah</h2>
+
 	<p>
-	Import za??n? v?b?rem souboru, v n?m? jsou ulo?ena data.
-	Form?t souboru je speci?ln? a je pops?n n??e.
+	<ol>
+		<li>?prava dat v tabulk?ch</li>
+		<li>Detailn? popis form?tu aktualiza?n?ho souboru</li>
+		<li>Uk?zky rozd?lov?ch soubor?</li>
+		<li>Omezen? p?i ?prav? tabulek</li>
+	</ol>
 	</p>
 
+
+	<h2>1. ?prava dat v tabulk?ch</h2>
+
 	<p>
-	Po v?b?ru souboru je zobrazeno okno zobrazuj?c? pr?b?h procesu importov?n? dat. 
-	Import lze p?eru?it stiskem tla??tka <i>Storno</i>. 
-	P?eru??te-li Import, n?lezov? data, kter? se stihla naimportovat, v datab?zi z?stanou.
+	Operace za??n? v?b?rem souboru, v n?m? jsou ulo?ena data s opravami.
 	</p>
 
+	<p>
+	Po v?b?ru souboru je zah?jena ?prava dat v tabulce. 
+	Pr?b?h procesu m??ete sledovat v otev?en?m okn?.
+	?pravu dat lze zru?it stiskem tla??tka "Storno". 
+	P?eru??te-li ?pravu, proveden? zm?ny v datab?zi z?stanou.
+	Opakovan? proveden? t?cht?? ?prav nem? ??dn? efekt.
+	</p>
 
-	<h2>2. Form?t souboru pro import dat do tabulek - pro Administr?tory datab?ze</h2>
 
+
+
+	<h2>2. Form?t souboru pro ?pravu tabulek</h2>
+
 	<p>
 	Form?t souboru dovoluje p?id?v?n? nov?ch z?znam?, odmaz?v?n? p?vodn?ch z?znam? v tabulk?ch
 	a aktualizaci st?vaj?c?ch z?znam?. Z?kladem je XML strom obsahuj?c? na t?i v?tve - ADD, DELETE
-	a UPDATE. Ko?en stromu ur?uje tabulku, do kter? budou data n?le?et.
+	a UPDATE. Ko?en stromu ur?uje tabulku, do kter? budou data n?le?et.
 	</p>
 
 
@@ -52,7 +81,7 @@
  			<td>plants</td><td>plant (rostliny)</td>
 		</tr>
 		<tr>
-			<td>villages</td><td>village (nejbli??? v?t?? s?dla)</td>
+			<td>villages</td><td>nearestvillage (nejbli??? v?t?? s?dla)</td>
 		</tr>
 		<tr>
 			<td>phytochoria</td><td>phytochorion (fytochoriony)</td>
@@ -75,23 +104,23 @@
 	<pre>
 	&lt;plants&gt;
 
-	  &lt;add&gt;
+	  &lt;<b>add</b>&gt;
 		&lt;plant&gt;&lt;/plant&gt;
 		&lt;plant&gt;&lt;/plant&gt;
 		...
-	  &lt;/add&gt;
+	  &lt;<b>/add</b>&gt;
 
-	  &lt;delete&gt;
+	  &lt;<b>delete</b>&gt;
 		&lt;plant&gt;&lt;/plant&gt;
 		&lt;plant&gt;&lt;/plant&gt;
 		...
-	  &lt;/delete&gt;
+	  &lt;<b>/delete</b>&gt;
 
-	  &lt;update&gt;	  
+	  &lt;<b>update</b>&gt;	  
 		&lt;plant&gt;&lt;/plant&gt;
 		&lt;plant&gt;&lt;/plant&gt;
 		...
-	  &lt;/update&gt;
+	  &lt;<b>/update</b>&gt;
 
 	&lt;/plants&gt;
 	</pre>
@@ -159,8 +188,13 @@
 
 	<p>
 	V?tev UPDATE obsahuje dvojice po sob? jdouc?ch z?znam? - <i>origin?l</i> a <i>n?hradu</i>. 
+
+	Pokud <i>origin?l</i> v tabulce je, ale <i>n?hrada</i> nikoli, je <i>origin?l</i> upraven tak,
+	aby odpov?dal <i>n?hrad?</i>.
+
 	Pokud se origin?l v tabulce nenach?z?,
 	provede se s <i>n?hradou</i> operace vlo?en? (jako kdyby byla ve v?tvi ADD).
+
 	Pokud u? se <i>n?hrada</i> v datab?zi nal?z?, 
 	provede se s <i>origin?lem</i> operace smaz?n? (jako kdyby byl um?st?n ve v?tvi DELETE).
 	</p>
@@ -176,7 +210,7 @@
 		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
 		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
 		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
-		  &lt;surveytaxid&gt;<font color=RED>ARVACoacg</font>&lt;/surveytaxid&gt;
+		  &lt;surveytaxid&gt;<font color=RED>Aoacg</font>&lt;/surveytaxid&gt;
 		&lt;/plant&gt;
 		&lt;plant&gt;
 		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
@@ -194,23 +228,59 @@
 
 
 
+	<h2>3. Uk?zky rozd?lov?ch soubor? pro r?zn? tabulky</h2>
 
+	<p>
+	P?id?n? nov?ho nejbli???ho v?t??ho s?dla.
+	<pre>
+	&lt;villages&gt;
+	  &lt;add&gt;
+	    &lt;nearestvillage&gt;
+	      &lt;name&gt;Newcastle&lt;/name&gt;
+	    &lt;/nearestvillage&gt;
+	  &lt;add&gt;
+	&lt;villages&gt;
+	</pre>
+	</p>
 
-	<h2>3. Omezen?, kter? je nutno zv??it p?i Importu do tabulek</h2>
+	<p>
+	P?id?n? nov?ho teritoria.
+	<pre>
+	&lt;territories&gt;
+	  &lt;add&gt;
+	    &lt;territory&gt;
+	      &lt;name&gt;Nieder?sterreich&lt;/name&gt;
+	    &lt;/territory&gt;
+	   &lt;/add&gt;
+	  &lt;/add&gt;
+	&lt;territories&gt;
+	</pre>
+	</p>
 
+
 	<p>
-	Import do zmi?ovan?ch tabulek je v?sadou administr?tora datab?ze. Jedn? se o data, 
-	kter? mus? b?t udr?ov?na jednotn? nap??? v?emi datab?zemi, a tedy o jejich aktualizaci
-	by m?la pe?ovat zodpov?dn? osoba. N?lezov? data, kter? obsahuj? z?znamy s neplatn?mi ?daji 
-	v t?chto tabulk?ch, nen? mo?n? naimportovat z d?vodu ochrany kvality n?lezov?ch dat.
-	Nen? nap?. mo?n? p?i <a href="./import.html">Importu n?lezov?ch dat</a> vlo?it z?znam
-	obsahuj?c? neplatn? (tj. v tabulce Plants neexistuj?c?) jm?no rostliny.
+	P?id?n? nov?ho fytochorionu.
+	<pre>
+	&lt;phytochoria&gt;
+	  &lt;add&gt;
+	    &lt;phytochorion&gt;
+	      &lt;code&gt;25b&lt;/code&gt;
+	      &lt;name&gt;Liboucheck? plo?ina&lt;/name&gt;
+	    &lt;/phytochorion&gt;
+	   &lt;/add&gt;
+	&lt;/phytochoria&gt;
+	</pre>
 	</p>
 
+
+
+	<h2>4. Omezen? p?i ?prav? tabulek</h2>
+
 	<p>
-	Import do tabulek je prim?rn? navr?en pro pr?ci s mal?mi rozd?lov?mi seznamy
-	(obsahuj?c? ??dov? tis?ce z?znam?). V?t?? soubory mohou m?t ne?nosn? pam??ov?
+	?prava dat v tabulk?ch je prim?rn? navr?ena pro pr?ci s mal?mi rozd?lov?mi seznamy
+	obsahuj?c? ??dov? stovky a? tis?ce z?znam?. V?t?? soubory mohou m?t ne?nosn? pam??ov?
 	n?roky.
 	</p>  
+
   </body>
 </html>



From krater at mail.berlios.de  Wed Sep  6 19:44:59 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 19:44:59 +0200
Subject: [Plantlore-dev] r712 - trunk/src/net/sf/plantlore/client/export
Message-ID: <200609061744.k86HixaH009804@sheep.berlios.de>

Author: krater
Date: 2006-09-06 19:44:59 +0200 (Wed, 06 Sep 2006)
New Revision: 712

Modified:
   trunk/src/net/sf/plantlore/client/export/ExportTask2.java
Log:
Fixed export task

Modified: trunk/src/net/sf/plantlore/client/export/ExportTask2.java
===================================================================
--- trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-06 17:43:59 UTC (rev 711)
+++ trunk/src/net/sf/plantlore/client/export/ExportTask2.java	2006-09-06 17:44:59 UTC (rev 712)
@@ -196,6 +196,7 @@
 
 			build.footer();
 			logger.info("Export completed. " + count + " records sent to output. ");
+			setStatusMessage(count + " " + L10n.getString("Export.RecordsExported"));
 			cleanup();
 		}
 		catch(Exception e) {



From kovo at mail.berlios.de  Wed Sep  6 19:52:05 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 19:52:05 +0200
Subject: [Plantlore-dev] r713 - trunk/installer
Message-ID: <200609061752.k86Hq5pG010785@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 19:52:04 +0200 (Wed, 06 Sep 2006)
New Revision: 713

Added:
   trunk/installer/packsLang.xml_cze.java
   trunk/installer/packsLang.xml_eng
   trunk/installer/shortcutSpec.xml
Modified:
   trunk/installer/install.xml
   trunk/installer/intro_cze.html
Log:
Update of installer. It now creates shorcuts in the Start menu and on the desktop. Should be completely localized  to czech and english. Requires testing, especially on Linux.

IMPORTANT: To build the installer, you have to update your standalone-compiler.jar from this package. Rename it to zip, open in windows commander and copy file ShellLink.dll to directory (inside the jar) bin/native/izpack
The ShellLink.dll is a part of IzPack installation and can be found in $IZPACK_HOME/bin/native/izpack

Modified: trunk/installer/install.xml
===================================================================
--- trunk/installer/install.xml	2006-09-06 17:44:59 UTC (rev 712)
+++ trunk/installer/install.xml	2006-09-06 17:52:04 UTC (rev 713)
@@ -1 +1 @@
-<?xml version="1.0" encoding="utf-8" standalone="yes" ?><installation version="1.0">    <info>        <appname>Plantlore</appname>        <appversion>1.0</appversion>        <authors>            <author name="Lada Oberreiterova" email="lada at mail@berlios.de"/>            <author name="Erik Kratochvil" email="krater at mail.berlios.de"/>	    <author name="Tomas Kovarik" email="kovo at mail.berlios.de"/>	    <author name="Jakub Kotowski" email="fraktalek at mail.berlios.de"/>        </authors>        <url>http://plantlore.berlios.de</url>                <uninstaller write="yes"/>    </info>        <guiprefs width="640" height="480" resizable="no"/>        <locale>        <langpack iso3="cze"/>        <langpack iso3="eng"/>    </locale>        <resources>        <res id="LicencePanel.licence" src="resources/gpl.txt"/>        <res id="HTMLInfoPanel.info_cze" src="installer/intro_cze.html"/>        <res id="HTMLInfoPanel.info_eng" src="installer/intro!
 _eng.html"/>        <res id="userInputSpec.xml" src="installer/userInputSpec.xml"/>                <res id="userInputLang.xml_eng" src="installer/userInputLang.xml_eng" />        <res id="userInputLang.xml_cze" src="installer/userInputLang.xml_cze" />    </resources>        <panels>        <panel classname="HelloPanel"/>        <panel classname="HTMLInfoPanel"/>        <panel classname="LicencePanel"/>        <panel classname="TargetPanel"/>         <panel classname="PacksPanel"/>        <panel classname="UserInputPanel"/>                <panel classname="InstallPanel"/>        <panel classname="FinishPanel"/>    </panels>        <packs>                <pack name="Core" required="yes">            <description>Files that Plantlore needs always</description>            <file src="dist/lib" targetdir="$INSTALL_PATH"/>        </pack>        	<pack name="Client" required="no">            <description>Plantlore Java Client</description>            <!
 file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"!
 />     
   </pack>	<pack name="Server" required="no" preselected="no">            <description>Plantlore Server</description>            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>	</pack>		<pack name="PostgreSQL" required="no">            <description>The PostgreSQL database machine</description>                        <file src="installer/postgresql/postgresql-int.msi" targetdir="$INSTALL_PATH" os="windows"/>            <file src="installer/postgresql/postgres_install.bat" targetdir="$INSTALL_PATH" os="windows"/>                        <parsable targetfile="$INSTALL_PATH/postgres_install.bat" os="windows" />            <executable targetfile="$INSTALL_PATH/postgres_install.bat"                         stage="postinstall"                         os="windows"                         failure="warn" />                        	</pack>	        <pack name="Docs" required="no">   !
          <description>The documentation</description>            <file src="documentation" targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->        </pack>        <pack name="Sources" required="no" preselected="no">            <description>The sources</description>            <file src="src" targetdir="$INSTALL_PATH"/>        </pack>    </packs>    </installation>
\ No newline at end of file
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?><installation version="1.0">    <info>        <appname>Plantlore</appname>        <appversion>1.0</appversion>        <authors>            <author name="Lada Oberreiterov??" email="joselada at users.berlios.de"/>            <author name="Erik Kratochv??l" email="krater at users.berlios.de"/>	    <author name="Tom???? Kova????k" email="tkovarik at users.berlios.de"/>	    <author name="Jakub Kotowski" email="fraktalek at users.berlios.de"/>        </authors>        <url>http://plantlore.berlios.de</url>                <uninstaller write="yes"/>    </info>        <guiprefs width="640" height="480" resizable="no"/>        <locale>        <langpack iso3="cze"/>        <langpack iso3="eng"/>    </locale>        <resources>        <res id="LicencePanel.licence" src="resources/gpl.txt"/>        <res id="HTMLInfoPanel.info_cze" src="installer/intro_cze.html"/>        <res id="HTMLInfoPanel.info_eng" sr!
 c="installer/intro_eng.html"/>        <res id="userInputSpec.xml" src="installer/userInputSpec.xml"/>                <res id="userInputLang.xml_eng" src="installer/userInputLang.xml_eng" />        <res id="userInputLang.xml_cze" src="installer/userInputLang.xml_cze" />        <res id="shortcutSpec.xml" src="installer/shortcutSpec.xml" />                <res id="packsLang.xml_eng" src="installer/packsLang.xml_eng" />                                <res id="packsLang.xml_cze" src="installer/packsLang.xml_cze" />     </resources>        <panels>        <panel classname="HelloPanel"/>        <panel classname="HTMLInfoPanel"/>        <panel classname="LicencePanel"/>        <panel classname="TargetPanel"/>         <panel classname="PacksPanel"/>        <panel classname="UserInputPanel"/>                <panel classname="InstallPanel"/>        <panel classname="ShortcutPanel"/>                <panel classname="FinishPanel"/>    </panels>    <native type="i!
 zpack" name="ShellLink.dll"/>     <packs>                <!
 pack nam
e="Core" id="pack.core" required="yes">            <description id="pack.core.description">Files that Plantlore needs always</description>            <file src="dist/lib" targetdir="$INSTALL_PATH"/>        </pack>        	<pack name="Client" required="no" id="pack.client">            <description id="pack.client.description">Plantlore Java Client</description>            <file src="dist/plantlore-client.jar" targetdir="$INSTALL_PATH"/>        </pack>	<pack name="Server" required="no" preselected="no" id="pack.server">            <description id="pack.server.description">Plantlore Server</description>            <file src="dist/plantlore-server.jar" targetdir="$INSTALL_PATH"/>            <file src="dist/java.policy" targetdir="$INSTALL_PATH"/>	</pack>		<pack name="PostgreSQL" required="no" os="windows" id="pack.postgresql">            <description id="pack.postgresql.description">The PostgreSQL database machine</description>                        <file src=!
 "installer/postgresql/postgresql-int.msi" targetdir="$INSTALL_PATH" os="windows"/>            <file src="installer/postgresql/postgres_install.bat" targetdir="$INSTALL_PATH" os="windows"/>                        <parsable targetfile="$INSTALL_PATH/postgres_install.bat" os="windows" />            <executable targetfile="$INSTALL_PATH/postgres_install.bat"                         stage="postinstall"                         os="windows"                         failure="warn" />                        	</pack>	        <pack name="Docs" required="no" id="pack.docs">            <description id="pack.docs.description">The documentation</description>            <file src="documentation" targetdir="$INSTALL_PATH"/> <!-- Reccursive adding -->        </pack>        <pack name="Sources" required="no" preselected="no" id="pack.sources">            <description id="pack.sources.description">The sources</description>            <file src="src" targetdir="$INSTALL_PATH"/> !
        </pack>                </packs>    </installation>
\ No newline at end of file

Modified: trunk/installer/intro_cze.html
===================================================================
--- trunk/installer/intro_cze.html	2006-09-06 17:44:59 UTC (rev 712)
+++ trunk/installer/intro_cze.html	2006-09-06 17:52:04 UTC (rev 713)
@@ -6,21 +6,21 @@
   </head>
   <body>
       <h1>Plantlore</h1>
-      <h2>??vod</h2>
-      <p>Plantlore je datab??zov?? syst??m pro zad??v??n?? a vyhled??v??n?? dat o v??skytu rostlin ??????en?? pod licenc?? GPL.
-      Je navr??en jako aplikace s architekturou klient server. Umo????uje jak pr??ci lok??ln??
-      tak i vzd??lenou po s??ti. Tento instal??tor instaluje Plantlore klienta a server
-      napsan?? v programovac??m jazyce Java. Sou????st?? projektu Plantlore je i webov?? klient,
-      kter?? se instaluje zvl??????.</p>
-      <h2>Vybran?? funkce</h2>
+      <h2>?vod</h2>
+      <p>Plantlore je datab?zov? syst?m pro zad?v?n? a vyhled?v?n? dat o v?skytu rostlin ???en? pod licenc? GPL.
+      Je navr?en jako aplikace s architekturou klient server. Umo??uje jak pr?ci lok?ln?
+      tak i vzd?lenou po s?ti. Tento instal?tor instaluje Plantlore klienta a server
+      napsan? v programovac?m jazyce Java. Sou??st? projektu Plantlore je i webov? klient,
+      kter? se instaluje zvl???.</p>
+      <h2>Vybran? funkce</h2>
       <ul>
-          <li>Rychl?? zad??v??n?? a editace n??lez?? ("??krt??k", automatick?? dopl??ov??n??, ...)</li>
-          <li>Spr??va dat o u??ivatel??ch, autorech a projektech</li>
-          <li>Import a export do XML kompatibiln??ho s ABCD schema a DarwinCore</li>
-          <li>Lokalizace - zat??m ??e??tina a angli??tina</li>
+          <li>Rychl? zad?v?ni a editace n?lez? ("?krt?k", automatick? dopl?ov?n?, ...)</li>
+          <li>Spr?va dat o u?ivatel?ch, autorech a projektech</li>
+          <li>Import a export do XML kompatibiln?ho se standardy ABCD schema a DarwinCore</li>
+          <li>Lokalizace - zat?m ?e?tina a angli?tina</li>
           <li>Tisk sched</li>
-          <li>Voln?? dostupn?? zdrojov?? k??dy pod licenc?? GPL</li>
-          <li>... a dal????</li>
+          <li>Voln? dostupn? zdrojov? k?dy pod licenc? GPL</li>
+          <li>... a dal??</li>
       </ul>
   </body>
 </html>

Added: trunk/installer/packsLang.xml_cze.java
===================================================================
--- trunk/installer/packsLang.xml_cze.java	2006-09-06 17:44:59 UTC (rev 712)
+++ trunk/installer/packsLang.xml_cze.java	2006-09-06 17:52:04 UTC (rev 713)
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<langpack>
+    <str id="pack.core" txt="Spole??n?? soubory"/>
+    <str id="pack.core.description" txt="Spole??n?? soubory kter?? jsou nutn?? pro b??h Klienta i Serveru"/>        
+    <str id="pack.client" txt="Plantlore klient"/>
+    <str id="pack.client.description" txt="Klientsk?? aplikace pro p??ipojen?? k serveru a pr??ci s daty"/>        
+    <str id="pack.server" txt="Plantlore Server"/>
+    <str id="pack.server.description" txt="Serverov?? aplikace pro obsluhu klientsk??ch p??ipojen?? a po??adavk??"/>
+    <str id="pack.postgresql" txt="PostgreSQL"/>
+    <str id="pack.postgresql.description" txt="Datab??zov?? syst??m PostgreSQL"/>        
+    <str id="pack.docs" txt="Dokumentace"/>
+    <str id="pack.docs.description" txt="Dokumentace syst??mu v??etn?? u??ivatelsk??ho manu??lu"/>        
+    <str id="pack.sources" txt="Zdrojov?? k??dy"/>
+    <str id="pack.sources.description" txt="Zdrojov?? k??dy v jazyku Java pro klienta i server"/>        
+</langpack>        

Added: trunk/installer/packsLang.xml_eng
===================================================================
--- trunk/installer/packsLang.xml_eng	2006-09-06 17:44:59 UTC (rev 712)
+++ trunk/installer/packsLang.xml_eng	2006-09-06 17:52:04 UTC (rev 713)
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<langpack>
+    <str id="pack.core" txt="Core files"/>
+    <str id="pack.core.description" txt="Files that Plantlore needs always. These files include libraries and other resources"/>
+    <str id="pack.client" txt="Plantlore Client"/>
+    <str id="pack.client.description" txt="Client application used for connecting to Plantlore server and data management"/>
+    <str id="pack.server" txt="Plantlore Server"/>
+    <str id="pack.server.description" txt="Server application for managing client connections and requests"/>
+    <str id="pack.postgresql" txt="PostgreSQL"/>
+    <str id="pack.postgresql.description" txt="The PostgreSQL database system"/>
+    <str id="pack.docs" txt="Documents"/>
+    <str id="pack.docs.description" txt="The documentation including user manual"/>        
+    <str id="pack.sources" txt="Sources"/>
+    <str id="pack.sources.description" txt="Java source files for both Client and Server applications"/>
+</langpack>        

Added: trunk/installer/shortcutSpec.xml
===================================================================
--- trunk/installer/shortcutSpec.xml	2006-09-06 17:44:59 UTC (rev 712)
+++ trunk/installer/shortcutSpec.xml	2006-09-06 17:52:04 UTC (rev 713)
@@ -0,0 +1,39 @@
+<?xml version="1.0" encoding="UTF-8"?>
+
+<shortcuts>
+    <skipIfNotSupported/>
+    <programGroup defaultName="Plantlore" location="applications"/>
+    <shortcut name="Plantlore Client" 
+              target="$INSTALL_PATH\plantlore-client.jar" 
+              workingDirectory="$INSTALL_PATH" description="Start Plantlore Client"
+              initialState="normal"
+              programGroup="yes"
+              desktop="yes"
+              applications="no"
+              startMenu="no"
+              startup="no">
+        <createForPack name="Client"/>
+    </shortcut>
+    <shortcut name="Plantlore Server" 
+              target="$INSTALL_PATH\plantlore-server.jar" 
+              workingDirectory="$INSTALL_PATH" description="Start Plantlore Server"
+              initialState="normal"
+              programGroup="yes"
+              desktop="yes"
+              applications="no"
+              startMenu="no"
+              startup="no">
+        <createForPack name="Server"/>
+    </shortcut>
+    <shortcut name="Uninstall Plantlore" 
+              target="$INSTALL_PATH\uninstaller\uninstaller.jar" 
+              workingDirectory="$INSTALL_PATH" description="This removes Plantlore from the system"              
+              initialState="normal"
+              programGroup="yes"
+              desktop="no"
+              applications="no"
+              startMenu="no"
+              startup="no">
+        <createForPack name="Server"/>
+    </shortcut>    
+</shortcuts>
\ No newline at end of file



From kovo at mail.berlios.de  Wed Sep  6 20:08:14 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 20:08:14 +0200
Subject: [Plantlore-dev] r714 - trunk/src/net/sf/plantlore/server
Message-ID: <200609061808.k86I8E8h012750@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 20:08:14 +0200 (Wed, 06 Sep 2006)
New Revision: 714

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
When creating new database create www user as well (dbprefix_www)

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 17:52:04 UTC (rev 713)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 18:08:14 UTC (rev 714)
@@ -2251,7 +2251,9 @@
         // In case we are creating users, add statement to create first user for accesing plantlore
         if (scriptid == DBLayer.CREATE_USERS) {
             sql.append("CREATE USER "+dbname+"_"+username+" PASSWORD '"+password+"';");
+            sql.append("CREATE USER "+dbname+"_www PASSWORD 'plantlore';");
             sql.append("GRANT Plantlore_Role_Admin TO "+dbname+"_"+username+";");
+            sql.append("GRANT Plantlore_Role_www TO "+dbname+"_www;");            
         }
         // In case we are creating tables, insert data into TUSER table so that the user can login
         if (scriptid == DBLayer.CREATE_TABLES) {



From krater at mail.berlios.de  Wed Sep  6 20:12:37 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 20:12:37 +0200
Subject: [Plantlore-dev] r715 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609061812.k86ICalT013428@sheep.berlios.de>

Author: krater
Date: 2006-09-06 20:12:36 +0200 (Wed, 06 Sep 2006)
New Revision: 715

Modified:
   trunk/src/net/sf/plantlore/help/en/html/checklist.html
   trunk/src/net/sf/plantlore/help/en/html/export.html
   trunk/src/net/sf/plantlore/help/en/html/table_import.html
Log:
English help

Modified: trunk/src/net/sf/plantlore/help/en/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-06 18:08:14 UTC (rev 714)
+++ trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-06 18:12:36 UTC (rev 715)
@@ -6,6 +6,90 @@
     <title>Checklist</title>
   </head>
   <body>
-  <h1>Checklist</h1>
+
+	<h1>The Checklist</h1>
+
+	<p>
+	The Checklist simplifies adding of plants that were found at the same place.
+	You just select the plants from the list of all available plants.
+	The Checklist can be accessed when 
+	<a href="./addoccurrence.html">adding the Occurrence data</a>.
+	</p>
+
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>Working with the Checklist</li>
+		<li>Creation and reuse of you own Checklist</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Working with the Checklist</h2>
+
+	<p>
+	When first opened the Checklist contains the list of all plants that are available in the database.
+	There can be several thousands of plants. In order to navigate in the list easily, you can
+	use the arrow keys.
+	In order to move to the desired record even more quickly 
+	you can type the first letters of the plant's name 
+	and the Checklist will display the first suitable choice. 
+	For instance: if you type the letters Z, E, L, K quickly enough, 
+	the Checklist will move to the "Zelkova serrata (Thunb.) Makino". The search is case insensitive. 
+	The longest delay between two consecutive characters is one second;
+	after that the characters start another search.
+	</p>
+
+	<p>
+	You can both select and deselect a record by either left-clicking on it or pressing the spacebar.
+	In order to cancel the selection of all plants click on the "Deselect all" button.
+	</p>
+
+	<p>
+	<img src="picture/ChecklistDefault.jpg" alt="The Checklist opened for the first time.">
+	</p>
+
+	<p>
+	After the selection of plants is finished, 
+	click on the "Insert" button and the selected plants will be inserted 
+	into the list of plants in the Overview.
+	</p>
+
+
+
+	<h2>2. Creation and reuse of your own Checklist</h2>
+
+	<p>
+	If you feel that the list of all plants is too long and working with it is unpleasant, 
+	because there are only a few hundreds of plants in the processed locality,
+	you can create your own Checklist.
+	</p>
+
+	<p>
+	You must select all plants you want to have in the final Checklist.
+	Then press the "Create" button and save the list into a file so that you can easily reuse
+	the Checklist in the future by pressing "Load".
+	</p>
+	
+	<p>
+	You own Checklist may look like this:
+	</p>
+
+	<p>
+	<img src="picture/ChecklistUsage.jpg" alt="Nov? ?krt?k.">
+	</p>
+
+	
+	<p>
+	If you press the "Restore" button the Checklist will return to its initial state
+	(containing all the plants available), but it will not cancel the list of currently
+	selected plants. This is very useful if a plant or two are not in your own Checklist;
+	just click on the "Restore" and select the missing plant from the complete list of
+	plants.
+	</p>
+
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/export.html	2006-09-06 18:08:14 UTC (rev 714)
+++ trunk/src/net/sf/plantlore/help/en/html/export.html	2006-09-06 18:12:36 UTC (rev 715)
@@ -1,154 +1,154 @@
-<html>
-	
-	<head>
-		<meta http-equiv="Content-Language" content="cs-CZ" />
-		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8" />
-		<title>Export of the Occurrence Data</title>
-	</head>
-
-<body>
-
-	<h1>Export of the Occurrence Data</h1>
-
-	<p>
-	Your Occurrence data are stored in the Plantlore's database.
-	This database cannot be accessed directly. 
-	If you want to transfer your data to other computers, you will have to use the Export.
-	Export allows you to "take" the occurrence data from the database 
-	and store them in a file on your hard drive.
-	</p>
-
-	<p>
-	The Export can be conducted with any database after logging in - even with a remote database.
-	If you are connected to a remote database and want to export some occurrence data,
-	bear in mind that the total amount of data may flood the transfer capacity and the whole
-	process may become painfully slow.
-	</p>
-
-	<p>
-	You have to take several steps to Export your data.
-	These steps are described in detail below.
-	</p>
-
-
-	<h2>Before you will start exporting the data</h2>
-
-	<p>
-	It is necessary to search/select some Occurrence data before you start exporting them.
-	You can do it in the <a href="./search.html">Search</a> dialog.
-	You must fill in the desired criteria - let's say, you want to search all occurrence data
-	related to a certain project in a certain year.
-	All relevant occurrence data in the database will be displayed 
-	in the <a href="./overview.html">Overview</a> 
-	
-	You can explicitly select some of these records. If you leave the selection empty
-	(ie. if you select no record at all) Plantlore will act as if you selected them all.
-	This feature should greatly simplify the Export of all records.
-	</p>
-
-
-	<h2>The Export</h2>
-
-	<p>
-	Exporting the occurrence data involves three steps:
-	</p>
-
-	<h3>1. Specifying the name of the file and its format</h3>
-
-	<p>
-	Type in the name of the file and choose its format
-	from the list of several basic formats:
-	<ul>
-		<li>PlantloreNative is a format designed for a convenient transfer of occurrence
-		data among many Plantlore programs. If you don't know, which format you should choose,
-		we recommend this one.
-		</li>
-		<li>XML is a format relying on the Extensible Markup Language (XML).
-		The occurrence data is stored in a well-arranged tree structure.
-		This format allows you to specify which attributes of the records you are
-		interested in. This format is suitable for data transfer as well as their visualization
-		in the Internet Explorer, for instance.
-		</li>
-		<li>ABCD Schema is a XML based format. However, the structure is different and conforms
-		to the ABCD Schema requirements.
-		</li>
-		<li>DarwinCore is a XML based format. Its structure is different and conforms
-		to the DarwinCore requirements.
-		</li>
-		<li>CSV - known as Comma Separated Values - is a simple format that contains 
-		one occurrence per line. Values of attributes of the record are separated by commas.
-		The first line contains the names of those attribues.
-		The structure of the file therefore resembles a table, and this format is particularly
-		suitable for table processors, such as Microsoft Excel.
-		</li>
-		<li>StdOut doesn't store the records in a file but sends them into the standard output.
-		The records are parsed and sent in a very legible form: table.column = value.
-		
-		This "format" is intented for stream processing in a command line or a shell, such
-		as bash on Linux or PowerShell on Windows.
-		</li>
-	</ul>
-	If you are unsure which format to choose, we recommend you use the PlantloreNative
-	which is most suitable for both data transfer and visualization.
-	</p>
-
-	<div style="position: relative; left: 300; top: 10"><br>
-	<img src="images/ExportFileFormat.jpg" alt="Selecting the name of the file and its format.">
-	</div>
-
-
-	<h3>2. Selecting records' attributes</h3>
-
-	<p>
-	This step is optional. Only the XML, CSV and StdOut support this option.
-	The other formats export the record with all its attributes.
-	<br/>
-	You can specify the desired attributes by selecting them in the tree.
-	The attributes marked red are compulsory if you are planning to
-	<a href="./import.html">Import</a> the exported data back into Plantlore.
-	</p>
-	
-	<p>
-	If you do not select any column, Plantlore acts as if you selected them all.
-	</p>
-
-	<div style="position: relative; left: 300; top: 10"><br>
-	<img src="images/ExportColumns.jpg" alt="Selecting attributes.">
-	</div>
-
-
-	<h3>3. The Export</h3>
-
-	<p>
-	After the selection of attributes if completed, the Export starts.
-	You can follow the progress in the window.
-	Closing the window won't abort the procedure, it will just hide the window.
-	The window can be re-opened if you click on the Export in the main menu -
-	that is, if the Export wasn't completed yet.
-	</p>
-
-	<p>
-	You can cancel the Export by clicking the "Abort" button.
-	</p>
-
-	<div style="position: relative; left: 300; top: 10"><br>
-	<img src="images/ExportProgress.jpg" alt="Export in progress.">
-	</div>
-
-
-
-
-	<h2>Restrictions and limits</h2>
-
-	<p>
-	You can export any selected occurrence data.
-	Remember: "nothing means everyting" - if you do not explicitly select some records or attributes,
-	Plantlore automatically assumes, that you wanted to select them all.
-	</p>
-
-	<p>
-	There can run only one Export at a time.
-	</p>
-
-</body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Export dat</title>
+  </head>
+  <body>
+  <h1>Export dat</h1>
+  	<p>
+	Your Occurrence data are stored in a database and
+	cannot be accessed directly. In order to transfer your
+	data from one computer to another, you must use Export and
+	<a href="./import.html">Import</a>. 
+	Export allows you to "take" the Occurrence data from the database
+	and store them into a file on your hard drive.
+	</p>
+
+	<p>
+	Export can be performed in every database after logging in - even in a remote database.
+	However, if you are connected to a remote database and want to export the Occurrence data,
+	you should take the capacity of the network connection you are using into account, because
+	the amount of data transfered via the network may be huge and the whole process
+	may be painfully slow.
+	</p>
+
+	<p>
+	There can run only one Export at a time.
+	</p>
+	
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>What has to be done before Export is started</li>
+		<li>Exporting the Occurrence data</li>
+	</ol>
+	</p>
+
+
+
+	<h2>1. What has to be done before Export is started</h2>
+
+	<p>
+	First, you have to select some Occurrences in the <a href="./overview.html">Overview</a>.
+	In order to reduce the amount of records from which you choose, use <a href="./search.html">Search</a>.
+	If you don't select any record, Plantlore acts as if all records were selected saving you
+	the time to select them all by yourself.
+	</p>
+
+	<p>
+	You can see 11 records that are about to be exported in the picture below.
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingRecords.png" alt="Selecting records for export.">
+	</p>
+
+
+
+	<h2>2. Exporting the Occurrence data</h2>
+
+	<p>
+	Export of the Occurrence data takes two steps.
+	</p>
+
+	<h3>2.1. File name and file format specification</h3>
+
+	<p>
+	Type in the name of the file and choose its format from the list of basic formats: 
+	<ul>
+		<li>
+		PlantloreNative is a format designed for the transfer of Occurrence data
+		between two Plantlore programs. 
+		If you are unsure which format you should choose we recommend this one.
+		</li>
+		<li>
+		XML is a format based on the Extensible Markup Language (XML). 
+		The Occurrences are stored in a well-defined tree structure. 
+		This format allows you to specify what attributes of the records you are interested in. 
+		This format is less suitable for the data transfer 
+		but very good for their visualization in the Internet Explorer, for instance.  
+		</li>
+		<li>
+		ABCD Schema is another XML based format. 
+		However, the structure is different and conforms to the ABCD Schema requirements.
+		</li>
+		<li>
+		DarwinCore is another XML based format. 
+		Its structure conforms to the DarwinCore requirements.
+		</li>
+		<li>
+		CSV - known as Comma Separated Values - is a simple format 
+		that contains one Occurrence per line. 
+		Values of attributes of the record are separated by commas. 
+		The first line contains the names of those attribues. 
+		The structure of the file therefore resembles a table, 
+		which is particularly suitable for table processors, such as Microsoft Excel.  
+		</li>
+		<li>
+		StdOut doesn't store the records in a file 
+		but sends them into the standard output. 
+		The records are parsed and sent in a very legible form: 
+		table.column = value. 
+		This "format" is intented for stream processing in a command line.  
+		</li>
+	</ul>
+	If you are unsure which format to choose, 
+	we recommend to use the PlantloreNative which is most suitable for the data transfer.
+	</p>
+
+	<p>
+	<img src="picture/ExportSupplyingName.png" alt="Choosing the file name and its format.">
+	</p>
+
+	<h3>2.2. Records' Attributes Selection (optional)</h3>
+
+	<p>
+	This step is optional. Only XML, CSV and StdOut support this option. 
+	The other formats export the records with all their attributes.  
+	You can select the desired attributes by clicking on them in the tree. 
+	The attributes displayed in red are compulsory if you are planning to 
+	<a href="./import.html">Import</a> the data back into Plantlore. 
+	</p>
+	
+	<p>
+	If you do not select any column, Plantlore acts as if all were selected. 
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingColumns.png" alt="Selecting important attributes of the record.">
+	</p>
+
+
+	<h3>2.3. The export</h3>
+
+	<p>
+	After the selection of attributes if completed, export is started. 
+	You can follow the progress in a small window. 
+	If you decide to cancel the export, click on the "Cancel" button and
+	export will be ended immediately. The file will contain the Occurrence data
+	that were written before the operation was canceled. It is guaranteed that the
+	format of the file is valid even if export is terminated prematurely either by
+	the User or by an error.
+	</p>
+
+	<p>
+	<img src="picture/ExportProgress.png" alt="Export in progress.">
+	<p>
+
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-06 18:08:14 UTC (rev 714)
+++ trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-06 18:12:36 UTC (rev 715)
@@ -3,9 +3,292 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Import</title>
+    <title>Updating the tables</title>
   </head>
   <body>
-  <h1>Table import</h1>
+  <h1>Updating the tables</h1>
+
+
+
+  	<p>
+	Only an Administrator can update the content of the following tables:
+	Plants, Metadata, Phytochoria, Territories and Nearest bigger seats.
+	</p>
+
+	<p>
+	These tables contain data, that must be kept in tact and in the same version
+	in all databases. Therefore only a responsible person can perform an
+	update of these tables. It is not possible to import 
+	the Occurrence data containing invalid values in the tables mentioned above,
+	in order to secure the quality of the Occurrence data.
+	For instance, it is not possible to <a href="./import.html">Import</a> 
+	an Occurrence refering to a plant that does not exist in the list of available
+	plants.
+	</p>
+
+	<p>
+	The Plantlore Application is supplied with a list of plants, 
+	phytochoria, territories and nearest bigger seats of the Czech republic.
+	However, records in those tables may cease to exist or come into existence.
+	In order to keep those tables up-to-date, you can use the table update.
+	</p>
+
+
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>The table update</li>
+		<li>The format of the file in detail</li>
+		<li>Examples of the difference files</li>
+		<li>Restrictions and limits</li>
+	</ol>
+	</p>
+
+
+	<h2>1. The table update</h2>
+
+	<p>
+	The operation starts with selection of the file that contains the data
+	with udpates.
+	</p>
+
+	<p>
+	After selecting the file the update of the table starts.
+	You can monitor the progress of the update in a small window
+	and cancel it by pressing the "Cancel" button.
+
+	If you cancel the update, the changes that were already made 
+	will remain in the database.
+
+	Repeated update does not have any effect.
+	</p>
+
+
+
+
+	<h2>2. The format of the file in detail</h2>
+
+	<p>
+	The format of the file allows you to insert new records, remove old records and 
+	update the current records. The format is based on XML and the tree contains three
+	branches - ADD, DELETE, and UPDATE.
+	The root of the tree determines the table that will be updated.
+	</p>
+
+
+	<p>
+	<table>
+		<tr>
+			<th>Root tag</th><th>Table</th>
+		</tr>
+		<tr>
+ 			<td>plants</td><td>plants</td>
+		</tr>
+		<tr>
+			<td>villages</td><td>nearest bigger seats</td>
+		</tr>
+		<tr>
+			<td>phytochoria</td><td>phytochoria</td>
+		</tr>
+		<tr>
+			<td>territories</td><td>territories</td>
+		</tr>
+		<tr>
+			<td>metadata</td><td>metadata</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	An example of the tree to make changes to the table of Plants:
+	</p>
+
+
+	<p>
+	<pre>
+	&lt;plants&gt;
+
+	  &lt;<b>add</b>&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/add</b>&gt;
+
+	  &lt;<b>delete</b>&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/delete</b>&gt;
+
+	  &lt;<b>update</b>&gt;	  
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/update</b>&gt;
+
+	&lt;/plants&gt;
+	</pre>
+	</p>
+	
+		  
+
+	<p>
+	</p>
+
+
+	<h3>2.1. Inserting a new record - ADD</h3>
+
+	<p>
+	In the ADD branch there are records that should be inserted into the table.
+	If the record is already in the table it is not inserted again to prevent the
+	table from being polluted with duplicities.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;add&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/add&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.2. Deleting an existing record - DELETE </h3>
+
+	<p>
+	The DELETE branch contains records that are meant to be removed from the table.
+	However, if the record, that should be deleted, is refered to by another record
+	in the database, it cannot be deleted in order to preserve the reference integrity.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;delete&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/delete&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.3. Updating an existing record - UPDATE </h3>
+
+	<p>
+	In the UPDATE branch there are pairs of records: the <i>original</i> and its <i>replacement</i>. 
+
+	If the <i>original</i> is already in the table, and the <i>replacement</i> is not, 
+	the <i>original</i> is modified so that it becomes the <i>replacement</i>.
+
+	If the <i>original</i> is not in the table, 
+	the <i>replacement</i> is inserted as if it were in the ADD branch.
+
+	If the <i>replacement</i> is alrady in the table,
+	the <i>original</i> is deleted as if it were in the DELETE branch.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;update&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>Aoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>ACIARVACoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/update&gt;
+	</pre>
+	</p>
+
+
+
+	<h2>3. Examples of the difference files</h2>
+
+	<p>
+	Adding a new nearest bigger seat.
+	<pre>
+	&lt;villages&gt;
+	  &lt;add&gt;
+	    &lt;nearestvillage&gt;
+	      &lt;name&gt;Newcastle&lt;/name&gt;
+	    &lt;/nearestvillage&gt;
+	  &lt;add&gt;
+	&lt;villages&gt;
+	</pre>
+	</p>
+
+	<p>
+	Adding a new territory.
+	<pre>
+	&lt;territories&gt;
+	  &lt;add&gt;
+	    &lt;territory&gt;
+	      &lt;name&gt;Nieder?sterreich&lt;/name&gt;
+	    &lt;/territory&gt;
+	   &lt;/add&gt;
+	  &lt;/add&gt;
+	&lt;territories&gt;
+	</pre>
+	</p>
+
+
+	<p>
+	Adding a new phytochorion.
+	<pre>
+	&lt;phytochoria&gt;
+	  &lt;add&gt;
+	    &lt;phytochorion&gt;
+	      &lt;code&gt;25b&lt;/code&gt;
+	      &lt;name&gt;Liboucheck? plo?ina&lt;/name&gt;
+	    &lt;/phytochorion&gt;
+	   &lt;/add&gt;
+	&lt;/phytochoria&gt;
+	</pre>
+	</p>
+
+
+
+	<h2>4. Restrictions and limits</h2>
+
+	<p>
+	The table update is primarily designed for small changes and for work with small files
+	containg several hundreds or thousands records. Bigger files may not be processed due
+	to memory issues.
+	</p>  
+
   </body>
 </html>



From kovo at mail.berlios.de  Wed Sep  6 20:14:59 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 20:14:59 +0200
Subject: [Plantlore-dev] r716 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609061814.k86IExgA013621@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 20:14:59 +0200 (Wed, 06 Sep 2006)
New Revision: 716

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Some L10n for Create database

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 18:12:36 UTC (rev 715)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 18:14:59 UTC (rev 716)
@@ -1651,3 +1651,7 @@
 Error.HistoryDataSearchFailed=
 
 Error.HistoryObjectSearchFailed=
+
+Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
+
+Error.BadDatabaseIdentifierTitle=Invalid Database Identifier

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 18:12:36 UTC (rev 715)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 18:14:59 UTC (rev 716)
@@ -1971,3 +1971,7 @@
 Error.HistoryDataSearchFailed=
 
 Error.HistoryObjectSearchFailed=
+
+Error.BadDatabaseIdentifier=Identifik\u00E1tor DB m\u016F\u017Ee obsahovat jenom p\u00EDsmena a \u010D\u00EDslice. Pros\u00EDm zadejte korektn\u00ED hodnotu t\u00E9to polo\u017Eky
+
+Error.BadDatabaseIdentifierTitle=Chybn\u00FD identifik\u00E1tor DB

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 18:12:36 UTC (rev 715)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 18:14:59 UTC (rev 716)
@@ -1500,3 +1500,7 @@
 Error.HistoryDataSearchFailed=
 
 Error.HistoryObjectSearchFailed=
+
+Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
+
+Error.BadDatabaseIdentifierTitle=Invalid Database identifier



From lada at mail.berlios.de  Wed Sep  6 21:32:06 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 21:32:06 +0200
Subject: [Plantlore-dev] r717 - trunk/documentation
Message-ID: <200609061932.k86JW6sm022084@sheep.berlios.de>

Author: lada
Date: 2006-09-06 21:31:56 +0200 (Wed, 06 Sep 2006)
New Revision: 717

Added:
   trunk/documentation/DBmodel.odt
Log:
Add description of database model.

Added: trunk/documentation/DBmodel.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/DBmodel.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Wed Sep  6 21:50:42 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 21:50:42 +0200
Subject: [Plantlore-dev] r718 - trunk
Message-ID: <200609061950.k86Jog6D023926@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 21:50:36 +0200 (Wed, 06 Sep 2006)
New Revision: 718

Modified:
   trunk/build.xml
Log:
Fixed build script for the server to generate missing stub...



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-06 19:31:56 UTC (rev 717)
+++ trunk/build.xml	2006-09-06 19:50:36 UTC (rev 718)
@@ -62,6 +62,7 @@
 		<rmic classname="net.sf.plantlore.server.SubQueryImplementation" base="${build.dir}" classpathref="classpath.server.rmic" debug="${DEBUG}"/>
 		<rmic classname="net.sf.plantlore.server.RMIServerControl" base="${build.dir}" classpathref="classpath.server.rmic" debug="${DEBUG}"/>
 		<rmic classname="net.sf.plantlore.server.RMIServer" base="${build.dir}" classpathref="classpath.server.rmic" debug="${DEBUG}"/>
+		<rmic classname="net.sf.plantlore.server.RMIRemoteDBLayerFactory" base="${build.dir}" classpathref="classpath.server.rmic" debug="${DEBUG}"/> 
 	</target>
 	
 	<!-- clean the build directory -->
@@ -85,7 +86,6 @@
                       fork="true"
                       dir="${dist.dir}">
                         <jvmarg value="-Djava.security.policy=${dist.dir}/java.policy"/>
-                        <jvmarg value="-Djava.rmi.server.codebase=file://${dist.dir}/"/>
 		</java>
 	</target>
         



From lada at mail.berlios.de  Wed Sep  6 22:01:46 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:01:46 +0200
Subject: [Plantlore-dev] r719 - trunk/documentation
Message-ID: <200609062001.k86K1ksW025145@sheep.berlios.de>

Author: lada
Date: 2006-09-06 22:01:43 +0200 (Wed, 06 Sep 2006)
New Revision: 719

Modified:
   trunk/documentation/DBmodel.odt
Log:
Update dbmodel doc - add info about not null column.

Modified: trunk/documentation/DBmodel.odt
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Wed Sep  6 22:34:17 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:34:17 +0200
Subject: [Plantlore-dev] r720 - in trunk/src/net/sf/plantlore:
	client/checklist common server server/tools
Message-ID: <200609062034.k86KYHkN028657@sheep.berlios.de>

Author: krater
Date: 2006-09-06 22:34:17 +0200 (Wed, 06 Sep 2006)
New Revision: 720

Modified:
   trunk/src/net/sf/plantlore/client/checklist/Checklist.java
   trunk/src/net/sf/plantlore/common/Utils.java
   trunk/src/net/sf/plantlore/server/Plantlore.java
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Codebase in linux should contain three slashes: file:///home/fraktalek/.... Utils return now one more.

Hostname is set automatically in order to allow remote connections (the host would not be resolved properly otherwise)!

Cheklist's behaviour little bit modified (do not restore the selected records after Load is called).

Modified: trunk/src/net/sf/plantlore/client/checklist/Checklist.java
===================================================================
--- trunk/src/net/sf/plantlore/client/checklist/Checklist.java	2006-09-06 20:01:43 UTC (rev 719)
+++ trunk/src/net/sf/plantlore/client/checklist/Checklist.java	2006-09-06 20:34:17 UTC (rev 720)
@@ -276,11 +276,11 @@
 		ObjectInputStream ois = new ObjectInputStream(fis);
 		Vector<String> listData = (Vector<String>) ois.readObject();
 		ois.close();
-		Object[] selected = getSelectedValues();
+//		Object[] selected = getSelectedValues();
 		clearSelection();
 		setListData(listData);
-		for(Object r : selected)
-			setSelectedValue(r, false);
+//		for(Object r : selected)
+//			setSelectedValue(r, false);
 	}
 	
 	

Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:01:43 UTC (rev 719)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:34:17 UTC (rev 720)
@@ -82,7 +82,7 @@
         	if (System.getProperty("os.name").toLowerCase().startsWith("win"))
         		dir = dir.substring(1, dir.indexOf(Utils.class.getName().replaceAll("\\.", "/")));
         	else
-        		dir = dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/")));            
+        		dir = "/" + dir.substring(0, dir.indexOf(Utils.class.getName().replaceAll("\\.","/")));            
         }
         
         return dir;

Modified: trunk/src/net/sf/plantlore/server/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-06 20:01:43 UTC (rev 719)
+++ trunk/src/net/sf/plantlore/server/Plantlore.java	2006-09-06 20:34:17 UTC (rev 720)
@@ -17,6 +17,7 @@
 import net.sf.plantlore.common.exception.PlantloreException;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.manager.*;
+import net.sf.plantlore.server.tools.RMI;
 
 
 /**
@@ -57,6 +58,9 @@
         
         // Disable reconnect
         DefaultExceptionHandler.disableReconnect();
+        
+        // Set the hostname to make remote connections possible
+        RMI.setHostName();
 
 
         java.awt.EventQueue.invokeLater(new Runnable(){

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:01:43 UTC (rev 719)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:34:17 UTC (rev 720)
@@ -1,17 +1,23 @@
 package net.sf.plantlore.server.tools;
 
+import java.net.InetAddress;
+import java.net.UnknownHostException;
 import java.rmi.*;
 import java.rmi.registry.*;
 import java.rmi.server.UnicastRemoteObject;
 
+import org.apache.log4j.Logger;
 
 
 
+
 public class RMI {
 	
+	private static Logger logger = Logger.getLogger(RMI.class.getPackage().getName());
 	
 	public static final String PROPERTY_CODEBASE = "java.rmi.server.codebase";
 	public static final String PROPERTY_LEASEVALUE = "java.rmi.dgc.leaseValue";
+	public static final String PROPERTY_HOSTNAME = "java.rmi.server.hostname";
 	
 
 	public static void bind(Remote object, String name) 
@@ -77,12 +83,24 @@
 			codebase = directory;
 		
 		System.setProperty(PROPERTY_CODEBASE, codebase);
-		System.out.println("java.rmi.server.codebase = " + codebase);
+		logger.info("java.rmi.server.codebase = " + codebase);
 	}
 	
 	
 	public static void setLeaseValue(int value) {
 		System.setProperty( PROPERTY_LEASEVALUE, Integer.toString(value) ); 
 	}
+	
+	
+	public static void setHostName() {
+		try {
+			InetAddress address = InetAddress.getLocalHost();
+			String ip = address.getHostAddress();
+			System.setProperty(PROPERTY_HOSTNAME, ip);
+			logger.info("Hostname set to " + ip);
+		} catch (UnknownHostException e) {
+			logger.fatal("Unable to obtain the host ip! Remote connections may not be possible! " + e.getMessage());
+		}
+	}
 
 }



From krater at mail.berlios.de  Wed Sep  6 22:39:01 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:39:01 +0200
Subject: [Plantlore-dev] r721 - trunk/src/net/sf/plantlore/common
Message-ID: <200609062039.k86Kd17A029075@sheep.berlios.de>

Author: krater
Date: 2006-09-06 22:39:01 +0200 (Wed, 06 Sep 2006)
New Revision: 721

Modified:
   trunk/src/net/sf/plantlore/common/Utils.java
Log:
Three slashes again

Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:34:17 UTC (rev 720)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:39:01 UTC (rev 721)
@@ -76,7 +76,7 @@
         	dir = dir.substring(0, dir.lastIndexOf("/"));
             //remove path to the package and the trailing "!/"
             dir = dir.substring(0, dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
-            dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+            dir = "/" + dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
         } else {
             // Just remove the path to the package
         	if (System.getProperty("os.name").toLowerCase().startsWith("win"))



From krater at mail.berlios.de  Wed Sep  6 22:41:59 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:41:59 +0200
Subject: [Plantlore-dev] r722 - trunk/src/net/sf/plantlore/common
Message-ID: <200609062041.k86Kfxcg029639@sheep.berlios.de>

Author: krater
Date: 2006-09-06 22:41:59 +0200 (Wed, 06 Sep 2006)
New Revision: 722

Modified:
   trunk/src/net/sf/plantlore/common/Utils.java
Log:
COdebase should be set properly on both windows and linux now.

Modified: trunk/src/net/sf/plantlore/common/Utils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:39:01 UTC (rev 721)
+++ trunk/src/net/sf/plantlore/common/Utils.java	2006-09-06 20:41:59 UTC (rev 722)
@@ -76,7 +76,10 @@
         	dir = dir.substring(0, dir.lastIndexOf("/"));
             //remove path to the package and the trailing "!/"
             dir = dir.substring(0, dir.indexOf(Utils.class.getPackage().getName().replaceAll("\\.","/"))-2);
-            dir = "/" + dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
+            if (System.getProperty("os.name").toLowerCase().startsWith("win"))
+            	dir = dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"
+            else
+            	dir = "/" + dir.substring(dir.indexOf("file:")+5);//if the url contains path to a jar it begins with "jar:file:/" and getPath() then begins with "file:/"            
         } else {
             // Just remove the path to the package
         	if (System.getProperty("os.name").toLowerCase().startsWith("win"))



From krater at mail.berlios.de  Wed Sep  6 22:49:34 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:49:34 +0200
Subject: [Plantlore-dev] r723 - trunk/src/net/sf/plantlore/server/tools
Message-ID: <200609062049.k86KnYAK031212@sheep.berlios.de>

Author: krater
Date: 2006-09-06 22:49:34 +0200 (Wed, 06 Sep 2006)
New Revision: 723

Modified:
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Better host ip retrieval on linux...

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:41:59 UTC (rev 722)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:49:34 UTC (rev 723)
@@ -96,6 +96,12 @@
 		try {
 			InetAddress address = InetAddress.getLocalHost();
 			String ip = address.getHostAddress();
+			if( "127.0.0.1".equals(ip) ) {
+				logger.warn("Java on Linux!");
+				String name = address.getHostName();
+				address = InetAddress.getByName(name);
+				ip = address.getHostAddress();				
+			}
 			System.setProperty(PROPERTY_HOSTNAME, ip);
 			logger.info("Hostname set to " + ip);
 		} catch (UnknownHostException e) {



From krater at mail.berlios.de  Wed Sep  6 22:59:22 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 22:59:22 +0200
Subject: [Plantlore-dev] r724 - trunk/src/net/sf/plantlore/server/tools
Message-ID: <200609062059.k86KxM0u032467@sheep.berlios.de>

Author: krater
Date: 2006-09-06 22:59:22 +0200 (Wed, 06 Sep 2006)
New Revision: 724

Modified:
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Host IP resolver another shot.

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:49:34 UTC (rev 723)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:59:22 UTC (rev 724)
@@ -97,10 +97,22 @@
 			InetAddress address = InetAddress.getLocalHost();
 			String ip = address.getHostAddress();
 			if( "127.0.0.1".equals(ip) ) {
-				logger.warn("Java on Linux!");
 				String name = address.getHostName();
+				logger.warn("Java on Linux! The name of this damn machine is " + name);
 				address = InetAddress.getByName(name);
-				ip = address.getHostAddress();				
+				ip = address.getHostAddress();
+				if( "127.0.0.1".equals(ip) ) {
+					logger.warn("I'm getting a little desperate here!");
+					InetAddress[] addresses = InetAddress.getAllByName(name);
+					for(InetAddress inetAddress : addresses) {
+						ip = inetAddress.getHostAddress();
+						if( !"127.0.0.1".equals(ip) )
+							break;
+					}
+					if(  "127.0.0.1".equals(ip) )
+						logger.fatal("Unable to obtain the host ip! Remote connections may not be possible! Please specify it yourself by adding java -Djava.rmi.server.hostname=YourIP");
+
+				}
 			}
 			System.setProperty(PROPERTY_HOSTNAME, ip);
 			logger.info("Hostname set to " + ip);



From krater at mail.berlios.de  Wed Sep  6 23:04:10 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Wed, 6 Sep 2006 23:04:10 +0200
Subject: [Plantlore-dev] r725 - trunk/src/net/sf/plantlore/server/tools
Message-ID: <200609062104.k86L4AxN000486@sheep.berlios.de>

Author: krater
Date: 2006-09-06 23:04:10 +0200 (Wed, 06 Sep 2006)
New Revision: 725

Modified:
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Final version of the host ip resolver.

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 20:59:22 UTC (rev 724)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-06 21:04:10 UTC (rev 725)
@@ -98,7 +98,7 @@
 			String ip = address.getHostAddress();
 			if( "127.0.0.1".equals(ip) ) {
 				String name = address.getHostName();
-				logger.warn("Java on Linux! The name of this damn machine is " + name);
+				logger.info("The name of this machine is " + name);
 				address = InetAddress.getByName(name);
 				ip = address.getHostAddress();
 				if( "127.0.0.1".equals(ip) ) {
@@ -109,8 +109,10 @@
 						if( !"127.0.0.1".equals(ip) )
 							break;
 					}
-					if(  "127.0.0.1".equals(ip) )
-						logger.fatal("Unable to obtain the host ip! Remote connections may not be possible! Please specify it yourself by adding java -Djava.rmi.server.hostname=YourIP");
+					if(  "127.0.0.1".equals(ip) ) {
+						logger.fatal("Unable to obtain the " + name + "'s ip! Remote connections may not be possible! Please specify it yourself by adding java -Djava.rmi.server.hostname=YourIP");
+						return;
+					}
 
 				}
 			}



From kovo at mail.berlios.de  Wed Sep  6 23:18:12 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Wed, 6 Sep 2006 23:18:12 +0200
Subject: [Plantlore-dev] r726 - trunk/src/net/sf/plantlore/server
Message-ID: <200609062118.k86LICUn008498@sheep.berlios.de>

Author: kovo
Date: 2006-09-06 23:18:11 +0200 (Wed, 06 Sep 2006)
New Revision: 726

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
   trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
Log:
Fix bug in getUniqueRecordId() (NPE in case database is empty)
Cleanup of SelectQueryImplementation

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 21:04:10 UTC (rev 725)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 21:18:11 UTC (rev 726)
@@ -308,9 +308,13 @@
         if (!sr.next()) {
             // No records in the database, set the first unitvalue to 1
             return 1;
+        }        
+        Object[] result = sr.get();
+        sess.close();        
+        // There is no occurrence in the database so far. Why the hell is result[0] null?
+        if ((result != null) && (result[0] == null)) {
+            return 1;
         }
-        Object[] result = sr.get();
-        sess.close();
         int maxUnitValue = (Integer)result[0];
         maxUnitValue++;
         return maxUnitValue;

Modified: trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-06 21:04:10 UTC (rev 725)
+++ trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-09-06 21:18:11 UTC (rev 726)
@@ -1,9 +1,3 @@
-/*
- * Selectcriteria.java
- *
- * Created on 24. b?ezen 2006, 20:53
- *
- */
 
 package net.sf.plantlore.server;
 
@@ -323,7 +317,6 @@
         }
         for (Iterator projIter = projections.iterator(); projIter.hasNext(); ) {
             ArrayList proj = (ArrayList)projIter.next();
-            System.out.println("Processing projection for: "+proj.get(1));
             switch ((Integer)proj.get(0)) {
                 case PlantloreConstants.PROJ_AVG:
                     pList.add(Projections.avg((String)proj.get(1)));



From discontinuum at gmail.com  Wed Sep  6 23:28:33 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 6 Sep 2006 23:28:33 +0200
Subject: [Plantlore-dev] Programatorska dokumentace
In-Reply-To: <f4dc39b90609060148l707e0096r3a2186b361b68502@mail.gmail.com>
References: <f4dc39b90609060148l707e0096r3a2186b361b68502@mail.gmail.com>
Message-ID: <f4dc39b90609061428gc070a5pded24010fb536325@mail.gmail.com>

Pravidla pro pouziti OOo.

Pouzivaji se zasadne zakladni styly, ktere OO nabizi. V nich se nedelaji
zadne zmeny. Ty se provedou pripadne az globalne.

   - hlavni nadpis sekce je Heading 1
   - za nim nasleduje kratky popis sekce, jakousi anotaci - cim se
   zabyva, kam patri (popisuje komunikacni vrstvu plantlore....)
   - subsekce jsou pak Heading 2, Heading 3
   - nemeli byste klesnout hloubeji nez na Heading 3
   - normalni text odstavcu je stylem Text Body
   - formatovany text pro pseudokod je stylem Preformated text.

Pseudokod vypada nasledovne (trochu jako pascal)


Builder build
DBLayer db
Selection selection
Integer result

run()
build.header()
rows = db.getNumRows( result )
for i = 0 to rows - 1 do
Record record = db.more( result, i, i ) // fetch the i-th record

if !selection.contains( record )
continue

build.startRecord()
build.part( record )

if record instanceof Occurrence then
for each AuthorOccurrence AO associated with record do
build.part( AO )

build.finishRecord()
done
build.footer()

Dulezita je indentace, klicova slova jou bold, podminky mohou by textove,
ostatne i prikazy. Na zacatku je seznam veci, ktere do procesu vstupuji, at
je videt, co je co.

Pro grafy nejakych interakci pouzijte VisualParadigm, vzdy v defaultnim
nastaveni. Jenom pozadi entit a swimline apod dejte na BILOU, aby se to pak
dobre tisklo a nebyly s tim potize.









On 9/6/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Svazujici pravidla pro psani programatorske dokumentace
>
> Programatorska dokumentace splnuje nasledujici pravidla:
>
>    - je maximalne popisna, neutralni, neobsahuje zadne osloveni ctenare
>    (spatne: You cannot, spravne: The User cannot), pouzivame (je-li to
>    nutne) nanejvys oznaceni roli the User, the Administrator.
>    - popisuje stavajici techniku nebo algoritmus pouzity pro dosazeni
>    dane funkcnosti, jeho celky (vyznamne entity) a jejich interakci, pripadne
>    ukazkovy pseudokod pro snazsi pochopeni, jak ho pouzit (nebo jak je
>    to pouzivano) - treba schematicky popisu export task, aby bylo videt, kdy se
>    volaji metody builderu, nebo popisu proces loginu, jak presne jsou do neho
>    zahrnuti ucastnici (jakysi diagram interakce)
>    - naopak nepopisuje se GUI! k tomu je uzivatelska dokumentace. v
>    teto dokumentaci popisujeme modely. (mozna by se i hodil nejaky uvod do
>    rozdeleni trid v plantlore pomoci MVC - co se kde da najit)
>    - obsahuje odkazy na dalsi casti programatorske dokumentace, zejmena
>    pak na ty, ktere svou cinnosti ovlivnuje, nebo jejichz cinnosti je
>    ovlivnena. snaha je maximalne omezit duplicity (tj. napr. ja nebudu u vyberu
>    sloupecku v exportu vysvetlovat, na co tam ktery je, k tomu je popis db.
>    modelu - ja pouze specifikuji, ktere casti zaznamu lze exportovat)
>    - ? obsahuje detailni popis rozhrani (interface), protoze zrovna to
>    je to, co by nekdo mohl chtit rozsirovat - treba ja detailne popisu rozhrani
>    Builderu, kdyby si nekdo chtel napsat vlastni, aby vedel, jak; tyhle
>    informace jsou uz vetsinou kvalitne zapracovany jako javadoc, muzete pouzit.
>
>    - neni ucebnici technologii. popisuje zpusob nasazeni dane
>    technologie v nasem projektu (v soucasne dobe je treba v RMI hezka ucebnice,
>    do dokumentace nepouzitelne). tj. nevysvetluju, co je codebase, jen
>    poznamenam, jak a kdy se nastavuje.
>    - 1 dobry obrazek obcas lepsi nez 1 stranka dokumentace
>    - rozhodne se nesmi zvrhnout v popis "tahle metoda dela tohle", k
>    tomu mame javadoc!
>
> Co bude popsano separatne ( JETEL):
>
>    1. celkova architektura aplikace: gui-kontroler-model-komunikacni
>    vrstva-databazova vrstva, role serveru  ?
>    2. rozdeleni trid, pouziti MVC - "co kde najit a proc" ?
>    3. tasky, dispatcher J
>    4. exception handling (propagation, translation, presentation) E/J
>    5. database model L
>    6. database layer T
>    7. biocase L
>    8. export E
>    9. server E
>    10. import (table, occurrence) E
>    11. checklist E
>    12. author, metadata, publication, user - dost podobne TL
>    13. settings (kam se co uklada) J
>    14. login, reconnect a logout E
>    15. print, scheda J
>    16. overview J
>    17. add, edit J
>    18. history L
>    19. search J
>    20. database creation T
>
> Je tam nak moc E a J (byla svinarna bod 12.)
>
>
>
>
>
>
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060906/596d023d/attachment.html>

From fraktalek at mail.berlios.de  Wed Sep  6 23:48:30 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 23:48:30 +0200
Subject: [Plantlore-dev] r727 - in trunk: .
	src/net/sf/plantlore/client/overview
	src/net/sf/plantlore/client/overview/detail
	src/net/sf/plantlore/client/overview/tree
	src/net/sf/plantlore/client/settings src/net/sf/plantlore/l10n
Message-ID: <200609062148.k86LmU5B031505@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 23:48:29 +0200 (Wed, 06 Sep 2006)
New Revision: 727

Modified:
   trunk/build.xml
   trunk/src/net/sf/plantlore/client/overview/AddEditView.form
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
   trunk/src/net/sf/plantlore/client/overview/SchedaView.java
   trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form
   trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java
   trunk/src/net/sf/plantlore/client/settings/SettingsView.form
   trunk/src/net/sf/plantlore/client/settings/SettingsView.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Properties added, translated, some reviewed.
A few other fine tunings..



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/build.xml	2006-09-06 21:48:29 UTC (rev 727)
@@ -77,6 +77,7 @@
                       fork="true"
                       dir="${dist.dir}">
                         <jvmarg value="-Djava.rmi.server.codebase=file://${dist.dir}/"/>
+                        <!--<jvmarg value="-Djava.rmi.server.hostname=my.ip.add.ress"/> -->
 		</java>
 	</target>
 	

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-06 21:48:29 UTC (rev 727)
@@ -147,7 +147,6 @@
                       <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
                         <TitledBorder title="Location">
                           <ResourceString PropertyName="titleX" bundle="net/sf/plantlore/l10n/Plantlore.properties" key="AddEdit.LocationPanel" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
-                          <Font PropertyName="font" name="Dialog" size="12" style="0"/>
                         </TitledBorder>
                       </Border>
                     </Property>
@@ -568,7 +567,9 @@
                   <Properties>
                     <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
                       <Border info="org.netbeans.modules.form.compat2.border.TitledBorderInfo">
-                        <TitledBorder title="Occurrence"/>
+                        <TitledBorder title="Occurrence">
+                          <ResourceString PropertyName="titleX" bundle="net/sf/plantlore/l10n/Plantlore.properties" key="Occurrence" replaceFormat="L10n.getString(&quot;{key}&quot;)"/>
+                        </TitledBorder>
                       </Border>
                     </Property>
                     <Property name="preferredSize" type="java.awt.Dimension" editor="org.netbeans.beaninfo.editors.DimensionEditor">

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-06 21:48:29 UTC (rev 727)
@@ -199,7 +199,7 @@
         basicPanel.setBorder(javax.swing.BorderFactory.createTitledBorder(null, L10n.getString("AddEdit.BasicData"), javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12)));
         basicPanel.setMinimumSize(new java.awt.Dimension(600, 0));
         basicPanel.setPreferredSize(new java.awt.Dimension(900, 520));
-        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(null, L10n.getString("AddEdit.LocationPanel"), javax.swing.border.TitledBorder.DEFAULT_JUSTIFICATION, javax.swing.border.TitledBorder.DEFAULT_POSITION, new java.awt.Font("Dialog", 0, 12)));
+        jPanel5.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("AddEdit.LocationPanel")));
         jPanel5.setPreferredSize(new java.awt.Dimension(914, 500));
         quadrantLabel.setText("Quadrant:");
 
@@ -390,7 +390,7 @@
                 .addContainerGap())
         );
 
-        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder("Occurrence"));
+        jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Occurrence")));
         jPanel7.setPreferredSize(new java.awt.Dimension(914, 300));
         taxonTextArea.setColumns(20);
         taxonTextArea.setRows(5);

Modified: trunk/src/net/sf/plantlore/client/overview/SchedaView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/SchedaView.java	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/SchedaView.java	2006-09-06 21:48:29 UTC (rev 727)
@@ -10,6 +10,7 @@
 import java.awt.Dimension;
 import net.sf.jasperreports.engine.JasperPrint;
 import net.sf.jasperreports.view.JRViewer;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 
 /**
  *
@@ -25,6 +26,8 @@
         jrv.setPreferredSize(new Dimension(670,550));
         add(jrv, BorderLayout.CENTER);        
         pack();
+        setLocationRelativeTo(parent);
+        new DefaultEscapeKeyPressed(this);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailView.form	2006-09-06 21:48:29 UTC (rev 727)
@@ -26,13 +26,9 @@
               <Group type="103" groupAlignment="1" attributes="0">
                   <Component id="jScrollPane1" alignment="1" pref="667" max="32767" attributes="0"/>
                   <Component id="jPanel4" alignment="1" max="32767" attributes="0"/>
-                  <Group type="102" alignment="0" attributes="0">
-                      <Component id="prevButton" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="jPanel3" max="32767" attributes="0"/>
-                  </Group>
                   <Component id="jPanel2" alignment="0" max="32767" attributes="0"/>
                   <Component id="jPanel1" alignment="1" max="32767" attributes="0"/>
+                  <Component id="jPanel3" alignment="1" max="32767" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -50,10 +46,7 @@
               <EmptySpace max="-2" attributes="0"/>
               <Component id="jPanel4" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jPanel3" min="-2" max="-2" attributes="0"/>
-                  <Component id="prevButton" min="-2" max="-2" attributes="0"/>
-              </Group>
+              <Component id="jPanel3" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
           </Group>
       </Group>
@@ -425,14 +418,18 @@
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="1" attributes="0">
-                  <EmptySpace pref="485" max="32767" attributes="0"/>
+                  <Component id="prevButton" linkSize="1" min="-2" max="-2" attributes="0"/>
+                  <EmptySpace pref="491" max="32767" attributes="0"/>
                   <Component id="nextButton" linkSize="1" min="-2" max="-2" attributes="0"/>
               </Group>
           </Group>
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="nextButton" alignment="0" min="-2" max="-2" attributes="0"/>
+              <Group type="103" alignment="0" groupAlignment="3" attributes="0">
+                  <Component id="nextButton" linkSize="2" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="prevButton" linkSize="2" alignment="3" min="-2" max="-2" attributes="0"/>
+              </Group>
           </Group>
         </DimensionLayout>
       </Layout>
@@ -445,6 +442,14 @@
             <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
           </AuxValues>
         </Component>
+        <Component class="javax.swing.JButton" name="prevButton">
+          <Properties>
+            <Property name="text" type="java.lang.String" value="jButton1"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
       </SubComponents>
     </Container>
     <Container class="javax.swing.JPanel" name="jPanel4">
@@ -521,13 +526,5 @@
         </Component>
       </SubComponents>
     </Container>
-    <Component class="javax.swing.JButton" name="prevButton">
-      <Properties>
-        <Property name="text" type="java.lang.String" value="jButton1"/>
-      </Properties>
-      <AuxValues>
-        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-      </AuxValues>
-    </Component>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/detail/DetailView.java	2006-09-06 21:48:29 UTC (rev 727)
@@ -76,12 +76,12 @@
         occNoteArea = new javax.swing.JTextArea();
         jPanel3 = new javax.swing.JPanel();
         nextButton = new javax.swing.JButton();
+        prevButton = new javax.swing.JButton();
         jPanel4 = new javax.swing.JPanel();
         createdWhoLabel = new javax.swing.JLabel();
         createdWhenLabel = new javax.swing.JLabel();
         updatedWhoLabel = new javax.swing.JLabel();
         updatedWhenLabel = new javax.swing.JLabel();
-        prevButton = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         setBackground(javax.swing.UIManager.getDefaults().getColor("Button.background"));
@@ -284,19 +284,29 @@
 
         nextButton.setText("jButton2");
 
+        prevButton.setText("jButton1");
+
         org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
         jPanel3.setLayout(jPanel3Layout);
         jPanel3Layout.setHorizontalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()
-                .addContainerGap(485, Short.MAX_VALUE)
+                .add(prevButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 491, Short.MAX_VALUE)
                 .add(nextButton))
         );
+
+        jPanel3Layout.linkSize(new java.awt.Component[] {nextButton, prevButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(nextButton)
+            .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                .add(nextButton)
+                .add(prevButton))
         );
 
+        jPanel3Layout.linkSize(new java.awt.Component[] {nextButton, prevButton}, org.jdesktop.layout.GroupLayout.VERTICAL);
+
         jPanel4.setBackground(new java.awt.Color(255, 255, 255));
         jPanel4.setBorder(javax.swing.BorderFactory.createTitledBorder(""));
         createdWhoLabel.setText("jLabel1");
@@ -338,8 +348,6 @@
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
-        prevButton.setText("jButton1");
-
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -349,12 +357,9 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                     .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 667, Short.MAX_VALUE)
                     .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, layout.createSequentialGroup()
-                        .add(prevButton)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                     .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                    .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
@@ -369,9 +374,7 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jPanel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(prevButton))
+                .add(jPanel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTreeView.java	2006-09-06 21:48:29 UTC (rev 727)
@@ -9,6 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 import javax.swing.JTree;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -28,6 +29,8 @@
         searchMenuItem.setText(L10n.getString("Overview.Tree.SearchMenuItem"));
         refreshMenuItem.setText(L10n.getString("Overview.Tree.RefreschMenuItem"));
         deleteMenuItem.setText(L10n.getString("Overview.Tree.DeleteMenuItem"));
+        setTitle(L10n.getString("Overview.HabitatTree"));
+        new DefaultEscapeKeyPressed(this);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-06 21:48:29 UTC (rev 727)
@@ -102,10 +102,10 @@
               <EmptySpace max="-2" attributes="0"/>
               <Component id="helpButton" linkSize="1" min="-2" max="-2" attributes="0"/>
               <EmptySpace pref="367" max="32767" attributes="0"/>
+              <Component id="okButton" linkSize="1" min="-2" max="-2" attributes="0"/>
+              <EmptySpace max="-2" attributes="0"/>
               <Component id="cancelButton" linkSize="1" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="okButton" linkSize="1" min="-2" max="-2" attributes="0"/>
-              <EmptySpace max="-2" attributes="0"/>
           </Group>
           <Component id="jTabbedPane1" alignment="0" pref="622" max="32767" attributes="0"/>
       </Group>
@@ -117,8 +117,8 @@
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
                   <Component id="helpButton" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="cancelButton" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="okButton" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="cancelButton" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>
@@ -319,8 +319,8 @@
                                   <Component id="jScrollPane1" linkSize="5" min="-2" pref="156" max="-2" attributes="0"/>
                                   <EmptySpace min="-2" pref="21" max="-2" attributes="0"/>
                                   <Group type="103" groupAlignment="0" attributes="0">
-                                      <Component id="addButton" linkSize="2" min="-2" pref="80" max="-2" attributes="0"/>
-                                      <Component id="removeButton" linkSize="2" alignment="0" min="-2" max="-2" attributes="0"/>
+                                      <Component id="addButton" linkSize="8" min="-2" pref="80" max="-2" attributes="0"/>
+                                      <Component id="removeButton" linkSize="8" alignment="0" min="-2" max="-2" attributes="0"/>
                                   </Group>
                               </Group>
                               <Component id="availableLabel" alignment="0" min="-2" max="-2" attributes="0"/>
@@ -335,8 +335,8 @@
                                   <Component id="jScrollPane2" linkSize="5" min="-2" pref="136" max="-2" attributes="0"/>
                                   <EmptySpace min="-2" pref="19" max="-2" attributes="0"/>
                                   <Group type="103" groupAlignment="1" attributes="0">
-                                      <Component id="upButton" linkSize="6" min="-2" max="-2" attributes="0"/>
-                                      <Component id="downButton" linkSize="6" min="-2" max="-2" attributes="0"/>
+                                      <Component id="upButton" linkSize="8" min="-2" max="-2" attributes="0"/>
+                                      <Component id="downButton" linkSize="8" min="-2" max="-2" attributes="0"/>
                                   </Group>
                                   <EmptySpace min="-2" pref="45" max="-2" attributes="0"/>
                               </Group>
@@ -361,13 +361,13 @@
                                   </Group>
                               </Group>
                               <Group type="102" alignment="1" attributes="1">
-                                  <Component id="upButton" min="-2" max="-2" attributes="0"/>
+                                  <Component id="upButton" linkSize="7" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
-                                  <Component id="downButton" min="-2" max="-2" attributes="0"/>
+                                  <Component id="downButton" linkSize="7" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace min="-2" pref="17" max="-2" attributes="0"/>
-                                  <Component id="addButton" min="-2" max="-2" attributes="0"/>
+                                  <Component id="addButton" linkSize="7" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
-                                  <Component id="removeButton" min="-2" max="-2" attributes="0"/>
+                                  <Component id="removeButton" linkSize="7" min="-2" max="-2" attributes="0"/>
                               </Group>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-06 21:48:29 UTC (rev 727)
@@ -305,10 +305,8 @@
                         .add(45, 45, 45))))
         );
 
-        jPanel4Layout.linkSize(new java.awt.Component[] {addButton, removeButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
+        jPanel4Layout.linkSize(new java.awt.Component[] {addButton, downButton, removeButton, upButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
 
-        jPanel4Layout.linkSize(new java.awt.Component[] {downButton, upButton}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
-
         jPanel4Layout.linkSize(new java.awt.Component[] {jScrollPane1, jScrollPane2}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
 
         jPanel4Layout.setVerticalGroup(
@@ -335,6 +333,8 @@
                 .addContainerGap())
         );
 
+        jPanel4Layout.linkSize(new java.awt.Component[] {addButton, downButton, removeButton, upButton}, org.jdesktop.layout.GroupLayout.VERTICAL);
+
         org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
         jPanel3.setLayout(jPanel3Layout);
         jPanel3Layout.setHorizontalGroup(
@@ -426,9 +426,9 @@
                 .addContainerGap()
                 .add(helpButton)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 367, Short.MAX_VALUE)
+                .add(okButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancelButton)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(okButton)
                 .addContainerGap())
             .add(jTabbedPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 622, Short.MAX_VALUE)
         );
@@ -442,8 +442,8 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(helpButton)
-                    .add(okButton)
-                    .add(cancelButton))
+                    .add(cancelButton)
+                    .add(okButton))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-06 21:48:29 UTC (rev 727)
@@ -1655,3 +1655,81 @@
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
 Error.BadDatabaseIdentifierTitle=Invalid Database Identifier
+
+Settings=&Settings
+
+SettingsTooltip=Opens dialog with Plantlore settings
+
+Print=&Print
+
+PrintTooltip=Opens the printing dialog
+
+Overview.MenuDataAuthorsTT=Author manager
+
+Overview.DataPublicationsTT=Publication manager
+
+Overview.MenuFileLoginTT=Connect to a database / plantlore server
+
+Overview.MenuFileCreateDBTT=Create a new database
+
+AddEdit.All=&All
+
+AddEdit.JustThis=Just this
+
+Checklist.Description=Checklist
+
+Server.Create=Plantlore server
+
+AddEdit.SettingsEnableTT=Enable selected fields
+
+AddEdit.SettingsDisableTT=Disable selected fields
+
+Overview.DetailTitle=Details
+
+Detail.PrevTT=Previous occurrence
+
+Detail.NextTT=Next occurrence
+
+Overview.Tree.Habitats=Habitats
+
+Overview.Tree.SearchMenuItem=Search
+
+Overview.Tree.RefreschMenuItem=Refresh
+
+Overview.Tree.DeleteMenuItem=Delete
+
+Overview.Tree.SearchTT=Find occurrences in selected habitat
+
+Overview.Tree.Search=Search
+
+Overview.Tree.RefreshTT=Reload the whole habitat tree
+
+Overview.Tree.Refresh=Reload
+
+Overview.Tree.Add=Add
+
+Overview.Tree.AddTT=Add an occurrence to the selected habitat
+
+Overview.MenuDataPublicationsTT=Publication manager
+
+Overview.Detail.Loading=Loading detail...
+
+Overview.Tree.LoadingHabitats=Loading habitats...
+
+Overview.Message.LoadingOccurrences=Loading occurrences...
+
+Overview.LoadingOccurrenceRecord=Loading an occurrence...
+
+Print.PrintTT=Print selected occurrences
+
+Print.PreviewTT=Preview before printing
+
+Common.HelpTT=Displays help for current section
+
+AddEdit.AddConfirmation=Occurrence has been added successfuly
+
+AddEdit.AddConfirmationTitle=Success
+
+Overview.Scheda.Generating=Creating schedas...
+
+Common.Done=Done

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-06 21:48:29 UTC (rev 727)
@@ -6,7 +6,7 @@
 Overview.MenuPrintTT = Vytiskne ozna\u010den\u00e9 z\u00e1znamy
 Overview.MenuExit = &Konec
 Overview.MenuLogin = Logi&n
-Overview.MenuHelp = &Pomoc
+Overview.MenuHelp = &N\u00E1pov\u011Bda
 Overview.MenuHelpContents = &Obsah
 Overview.MenuHelpAbout = O &aplikaci
 Overview.MenuData=&Data
@@ -446,11 +446,11 @@
 
 AddEdit.YearLabel=Rok\: 
 
-AddEdit.TerritoryNameLabel=Territorium\: 
+AddEdit.TerritoryNameLabel=\u00DAzem\u00ED\: 
 
 AddEdit.PhytCodeLabel=K\u00f3d fytochorionu\: 
 
-AddEdit.PhytNameLabel=Jm\u00e9no fytochorionu\: 
+AddEdit.PhytNameLabel=Fytochorion\:
 
 AddEdit.QuadrantLabel=Kvadrant\: 
 
@@ -568,7 +568,7 @@
 
 AddEdit.AuthorRemove=&Odeber
 
-AddEdit.OkQuestion=Habitat tohoto n\u00e1lezu je sd\u00edlen {0} dal\u0161\u00edmi n\u00e1lezy. \\nChcete upravit v\u0161echny n\u00e1lezy nebo jenom tento?
+AddEdit.OkQuestion=Habitat tohoto n\u00E1lezu je sd\u00EDlen {0} dal\u0161\u00EDmi n\u00E1lezy. Chcete upravit v\u0161echny n\u00E1lezy nebo jenom tento?
 
 AddEdit.QuestionDialogTitle=Habitat tohoto n\u00e1lezu je sd\u00edlen
 
@@ -744,65 +744,63 @@
 
 Overview.MenuOccurrences=&N\u00E1lezy
 
-AddEdit.PreloadAuthors=zapamatuj si zadan\u00E9 autory
-
 AddEdit.InfoPanel=Info
 
-Detail.Source=Source\: {0}
+Detail.Source=Zdroj\: {0}
 
-Detail.Herbarium=Herbarium\: {0}
+Detail.Herbarium=Herb\u00E1\u0159\: {0}
 
-Detail.Date=Date\: {0}
+Detail.Date=Datum\: {0}
 
-Detail.OccNote=Occurrence note\: {0}
+Detail.OccNote=Pozn\u00E1mka k n\u00E1lezu\: {0}
 
-Detail.HabNote=Habitat note
+Detail.HabNote=Pozn\u00E1mka k lokalit\u011B
 
-Detail.PlaceDescription=Place description
+Detail.PlaceDescription=Popis m\u00EDsta
 
-Detail.CreatedWho=Created by user {0}
+Detail.CreatedWho=Vytvo\u0159eno u\u017Eivatelem {0}
 
-Detail.CreatedWhen=on {0}
+Detail.CreatedWhen=dne {0}
 
-Detail.UpdatedWho=Updated by user {0}
+Detail.UpdatedWho=Upraveno u\u017Eivatelem {0}
 
-Detail.UpdatedWhen=on {0}
+Detail.UpdatedWhen=dne {0}
 
-Detail.Altitude=Altitude\: {0}
+Detail.Altitude=V\u00FD\u0161ka\: {0}
 
-Detail.Latitude=Latitude\: {0}
+Detail.Latitude=\u0160\u00ED\u0159ka\: {0}
 
-Detail.Longitude=Longitude\: {0}
+Detail.Longitude=D\u00E9lka\: {0}
 
-Detail.Country=Country\: {0}
+Detail.Country=Zem\u011B\: {0}
 
-Detail.Quadrant=Quadrant\: {0}
+Detail.Quadrant=Kvadrant\: {0}
 
-Detail.Village=Village\: {0}
+Detail.Village=Vesnice\: {0}
 
-Detail.Project=Project\: {0}
+Detail.Project=Projekt\: {0}
 
-Detail.PhytCode=Phytochoria code\: {0}
+Detail.PhytCode=K\u00F3d fytochorionu\: {0}
 
-Detail.PhytName=Phytochoria name\: {0}
+Detail.PhytName=Fytochorion\: {0}
 
 Detail.Taxon=Taxon\: {0}
 
-Detail.Publication=Publication\: {0}
+Detail.Publication=Publikace\: {0}
 
-Common.Next=Next
+Common.Next=Dal\u0161\u00ED
 
-Common.Prev=Prev
+Common.Prev=P\u0159edchoz\u00ED
 
-Detail.Territory=Territory\: {0}
+Detail.Territory=\u00DAzem\u00ED\: {0}
 
-Detail.Phytochorion=Phytochorion\: {0} ({1})
+Detail.Phytochorion=Fytochorion\: {0} ({1})
 
-Detail.OccNoteTitle=Occurrence note
+Detail.OccNoteTitle=Pozn\u00E1mka k n\u00E1lezu
 
-Detail.HabNoteTitle=Habitat note
+Detail.HabNoteTitle=Pozn\u00E1mka k lokalit\u011B
 
-Detail.PlaceDescriptionTitle=Place description
+Detail.PlaceDescriptionTitle=Popis m\u00EDsta
 
 AddEdit.InsufficientEditRights=Pro editaci z\u00E1znamu nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED.
 
@@ -1824,7 +1822,7 @@
 
 DBLayer.Error.Other=Operaci nelze prov\u00E9st.
 
-Overview.HabitatTree=Strom habitat\u016F
+Overview.HabitatTree=Strom lokalit
 
 Overview.HabitatTreeTT=Otev\u0159e strom zobrazuj\u00EDc\u00ED hierarchii lokalit
 
@@ -1975,3 +1973,81 @@
 Error.BadDatabaseIdentifier=Identifik\u00E1tor DB m\u016F\u017Ee obsahovat jenom p\u00EDsmena a \u010D\u00EDslice. Pros\u00EDm zadejte korektn\u00ED hodnotu t\u00E9to polo\u017Eky
 
 Error.BadDatabaseIdentifierTitle=Chybn\u00FD identifik\u00E1tor DB
+
+Settings=Nastaven\u00ED
+
+SettingsTooltip=Otev\u0159e dialog s nastaven\u00EDmi Plantlore
+
+Print=&Tisk
+
+PrintTooltip=Otev\u0159e dialog umo\u017E\u0148uj\u00EDc\u00ED tisk z\u00E1znam\u016F
+
+Overview.MenuDataAuthorsTT=Spr\u00E1vce autor\u016F
+
+Overview.DataPublicationsTT=Spr\u00E1vce publikac\u00ED
+
+Overview.MenuFileLoginTT=P\u0159ihl\u00E1\u0161en\u00ED k datab\u00E1zi / Plantlore serveru
+
+Overview.MenuFileCreateDBTT=Vytvo\u0159en\u00ED nov\u00E9 datab\u00E1ze
+
+AddEdit.All=&V\u0161e
+
+AddEdit.JustThis=Pouze tento
+
+Checklist.Description=\u0160krt\u00E1k
+
+Server.Create=Plantlore server
+
+AddEdit.SettingsEnableTT=Povol ozna\u010Den\u00E9 polo\u017Eky
+
+AddEdit.SettingsDisableTT=Zaka\u017E ozna\u010Den\u00E9 polo\u017Eky
+
+Overview.DetailTitle=Podrobnosti
+
+Detail.PrevTT=P\u0159edchoz\u00ED n\u00E1lez
+
+Detail.NextTT=Dal\u0161\u00ED n\u00E1lez
+
+Overview.Tree.Habitats=Lokality
+
+Overview.Tree.SearchMenuItem=Hledej
+
+Overview.Tree.RefreschMenuItem=Obnov
+
+Overview.Tree.DeleteMenuItem=Sma\u017E
+
+Overview.Tree.SearchTT=Najdi n\u00E1lezy v dan\u00E9 lokalit\u011B
+
+Overview.Tree.Search=Hledej
+
+Overview.Tree.RefreshTT=Obnov cel\u00FD strom lokalit
+
+Overview.Tree.Refresh=Obnov
+
+Overview.Tree.Add=P\u0159idej
+
+Overview.Tree.AddTT=P\u0159idej n\u00E1lez do ozna\u010Den\u00E9 lokality
+
+Overview.MenuDataPublicationsTT=Spr\u00E1vce publikac\u00ED
+
+Overview.Detail.Loading=Nahr\u00E1v\u00E1m podrobnosti...
+
+Overview.Tree.LoadingHabitats=Nahr\u00E1v\u00E1m lokality...
+
+Overview.Message.LoadingOccurrences=Nahr\u00E1v\u00E1m n\u00E1lezy...
+
+Overview.LoadingOccurrenceRecord=Nahr\u00E1v\u00E1m n\u00E1lez...
+
+Print.PrintTT=Vytiskni vybran\u00E9 z\u00E1znamy
+
+Print.PreviewTT=N\u00E1hled p\u0159ed tiskem
+
+Common.HelpTT=Zobraz\u00ED n\u00E1pov\u011Bdu pro aktu\u00E1ln\u00ED \u010D\u00E1st programu
+
+AddEdit.AddConfirmation=N\u00E1lez \u00FAsp\u011B\u0161n\u011B p\u0159id\u00E1n
+
+AddEdit.AddConfirmationTitle=\u00DAsp\u011Bch
+
+Overview.Scheda.Generating=Vytv\u00E1\u0159\u00EDm schedy...
+
+Common.Done=Hotovo

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 21:18:11 UTC (rev 726)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-06 21:48:29 UTC (rev 727)
@@ -695,8 +695,6 @@
 
 Overview.MenuOccurrences=Occurrences
 
-AddEdit.PreloadAuthors=remember entered authors
-
 AddEdit.InfoPanel=Info
 
 Detail.Source=Source\: {0}
@@ -1504,3 +1502,81 @@
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
 Error.BadDatabaseIdentifierTitle=Invalid Database identifier
+
+Settings=Settings
+
+SettingsTooltip=Opens dialog with Plantlore settings
+
+Print=&Print
+
+PrintTooltip=Opens the printing dialog
+
+Overview.MenuDataAuthorsTT=Author manager
+
+Overview.DataPublicationsTT=Publication manager
+
+Overview.MenuFileLoginTT=Connect to a database / plantlore server
+
+Overview.MenuFileCreateDBTT=Create a new database
+
+AddEdit.All=&All
+
+AddEdit.JustThis=Just this
+
+Checklist.Description=Checklist
+
+Server.Create=Plantlore server
+
+AddEdit.SettingsEnableTT=Enable selected fields
+
+AddEdit.SettingsDisableTT=Disable selected fields
+
+Overview.DetailTitle=Details
+
+Detail.PrevTT=Previous occurrence
+
+Detail.NextTT=Next occurrence
+
+Overview.Tree.Habitats=Habitats
+
+Overview.Tree.SearchMenuItem=Search
+
+Overview.Tree.RefreschMenuItem=Refresh
+
+Overview.Tree.DeleteMenuItem=Delete
+
+Overview.Tree.SearchTT=Find occurrences in selected habitat
+
+Overview.Tree.Search=Search
+
+Overview.Tree.RefreshTT=Reload the whole habitat tree
+
+Overview.Tree.Refresh=Reload
+
+Overview.Tree.Add=Add
+
+Overview.Tree.AddTT=Add an occurrence to the selected habitat
+
+Overview.MenuDataPublicationsTT=Publication manager
+
+Overview.Detail.Loading=Loading detail...
+
+Overview.Tree.LoadingHabitats=Loading habitats...
+
+Overview.Message.LoadingOccurrences=Loading occurrences...
+
+Overview.LoadingOccurrenceRecord=Loading an occurrence...
+
+Print.PrintTT=Print selected occurrences
+
+Print.PreviewTT=Preview before printing
+
+Common.HelpTT=Displays help for current section
+
+AddEdit.AddConfirmation=Occurrence has been added successfuly
+
+AddEdit.AddConfirmationTitle=Success
+
+Overview.Scheda.Generating=Creating schedas...
+
+Common.Done=Done



From lada at mail.berlios.de  Wed Sep  6 23:50:11 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Wed, 6 Sep 2006 23:50:11 +0200
Subject: [Plantlore-dev] r728 - trunk/src/net/sf/plantlore/help/cs/html
Message-ID: <200609062150.k86LoBec031778@sheep.berlios.de>

Author: lada
Date: 2006-09-06 23:50:10 +0200 (Wed, 06 Sep 2006)
New Revision: 728

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/history.html
   trunk/src/net/sf/plantlore/help/cs/html/metadata.html
   trunk/src/net/sf/plantlore/help/cs/html/user.html
Log:
Update help for history, metadata and user manager.

Modified: trunk/src/net/sf/plantlore/help/cs/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-06 21:48:29 UTC (rev 727)
+++ trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-06 21:50:10 UTC (rev 728)
@@ -7,7 +7,7 @@
   </head>
   <body>
   <h1>Historie ?prav</h1>
-Plantlore v?m nab?z? mo?nost sledovat historii zm?n va?ich n?lezov?ch dat. Diky t?to funkci m?te mo?nost zjistit kdo, kdy a jak zm?nil informace o 
+Plantlore v?m nab?z? mo?nost sledovat historii zm?n va?ich n?lezov?ch dat. D?ky t?to funkci m?te mo?nost zjistit kdo, kdy a jak zm?nil informace o 
 konkr?tn?m n?lezu, autorovi, publikaci ?i metadatech.<br> 
 Mezi z?kladn? zaznamen?v?n? informace o zm?n? pat??:
 <ul> 
@@ -19,7 +19,7 @@
  <li>nov? hodnota editovan? polo?ky
 </ul>
   
-Plantlore krom? mo?nosti sledovat zm?n?n? zm?ny v n?lezov?ch datech v?m umo?n? zru?it n?kter? zm?ny a vr?tit se tak k d??v?j??m hodnot?m. Historie
+Plantlore krom? mo?nosti sledovat zm?n?n? zm?ny v n?lezov?ch datech v?m umo?n? zru?it tyto zm?ny a vr?tit se tak k d??v?j??m hodnot?m. Historie
 je siln?m n?strojem umo??uj?c? z?sah do va?ich n?lezov?ch dat a proto je nutne, aby pr?ce s histori? byla z bezpe?nostn?ch d?vod? omezena jen na u?ivatele, kte?? maj? dostate?n? opr?vn?n? (viz. <a href="./user.html">Pr?va u?ivatel?</a>).  
 
 <p>
@@ -36,15 +36,15 @@
 
 <p><br>
 Pro p??stup k historii vybran?ho n?lezu sta?? jen ozna?it tento n?lez a kliknout na tla??tko <i><b>History</b></i>. Pokud je tla??tko <i><b>History</b></i>
-neaktivn? a p??stup k hsitorii ?prav v?m byl t?mto znemo?n?n, tak nem?te pr?vo na pr?ci s vybran?m n?lezem. Ur?it? nebude na?kodu  
-zm?nit, kdy m?te pr?vo pracovat s histori? n?lezu.
+neaktivn?, tak p??stup k historii ?prav v?m byl znemo?n?n a nem?te pr?vo na pr?ci s vybran?m n?lezem. Ur?it? nebude na ?kodu  
+zm?nit, v jak?m p??pad? m?te pr?vo pracovat s histori? n?lezu.
 </p>
-Historie n?lezu je p??stupn?:
+Historie n?lezu je p??stupn? u?ivateli, kter?:
 <ul>
-   <li>u?ivatelovi, kter? dan? n?lez vlo?il do datab?ze</li>
-   <li>u?ivatelovi, kter? m? pr?vo editovat z?znamy u?ivatele, kter? tento n?lez vlo?il do datab?ze</li>
-   <li>u?ivatelovi, kter? m? pr?vo editovat v?echny n?lezy ulo?en? v datab?zi</li>
-   <li>u?ivatelovi, kter? m? pr?vo administr?tor</li>   
+   <li>dan? n?lez vlo?il do datab?ze</li>
+   <li>m? pr?vo editovat z?znamy u?ivatele, kter? tento n?lez vlo?il do datab?ze</li>
+   <li>m? pr?vo editovat v?echny n?lezy ulo?en? v datab?zi</li>
+   <li>m? pr?vo administr?tor</li>   
 </ul>    
 
 Pokud nem?te p??stup k historii n?lezu a cht?li byste ho z?skat, tak kontaktujte administr?tora Plantlore.<br>
@@ -57,7 +57,7 @@
 
 Dialog historie n?lezu je rozd?len do t?? ??st?. 
 <ul>
-  <li><b>Detaily n?lezu</b> - zde jsou zobrazeny z?kladn? informace o n?lezu (taxon, auto?i n?lezu a lokalita)
+  <li><b>Detaily n?lezu</b> - zde jsou zobrazeny aktu?ln? informace o n?lezu (taxon, auto?i n?lezu a lokalita)
   <li><b>Vytvo?en? n?lezu</b> - zde jsou zobrazeny informace o vlo?en? n?lezu do datab?ze (datum/?as vlo?en? a u?ivatel, kter? z?znam vlo?il do datab?ze)
   <li><b>Seznam zm?n</b> - zde jsou zobrazeny z?kladn? informace o jednotliv?ch zm?n?ch n?lezu 
 </ul>
@@ -69,36 +69,36 @@
 <ul>
 <li><b>X</b> - slou?? pro v?b?r jednotliv?ch zm?n</li>
 <li><b>Datum/?as</b> - informuje o dob?, kdy ke zm?n? do?lo</li>
-<li><b>U?ivatel</b> - odpov?d? u?ivatelovi, kter? zm?nu provedl</li>
+<li><b>U?ivatel</b> - odpov?d? u?ivateli, kter? zm?nu provedl</li>
 <li><b>Polo?ka</b> - informuje o polo?ce, kter? byla zm?n?na</li>
 <li><b>Star? hodnota</b> - obsahuje hodnotu polo?ky p?ed zm?nou </li>
-<li><b>Nov? hodnota</b> - obseahuje novou hodnotu polo?ky </li>
+<li><b>Nov? hodnota</b> - obsahuje novou hodnotu polo?ky </li>
 </ul>
 
 
 <h3>Operace UNDO na vybran? polo?ky</h3>
 
 V historii n?lezu si m??ete vybrat zm?nu <b>jen konkr?tn? polo?ky</b> v z?znamu a vr?tit se k jej? star? hodnot?. Li?? se tedy od klasick? UNDO operace, 
-kde se proved?n? zm?ny v z?znamu vrac? od nejmlad?? po nejstar?? v ?asov?m sledu v jak?m k nim do?lo. Uve?m? si p??klad, kdy vyu?ijeme zm?n?n?ho 
+kde se proveden? zm?ny v z?znamu vrac? od nejmlad?? po nejstar?? v ?asov?m sledu v jak?m k nim do?lo. Uve?m? si p??klad, kdy vyu?ijeme zm?n?n?ho 
 vylep?en? operace UNDO: 
 <div style="text-align:justify; padding: 20 20 30 20">
-<i> Ud?l?te opravy polo?ek "Herb??", "Rok n?lezu", "Pozn?mku k n?lezu" a po t?chto oprav?ch ud?l?te je?t? dal??ch dvacet zm?n?m. 
+<i> Ud?l?te opravy polo?ek "Herb??", "Rok n?lezu", "Pozn?mku k n?lezu" a po t?chto oprav?ch ud?l?te je?t? dal??ch dvacet zm?n. 
 U? si nepamatujete p?esn? prvn? ulo?en? zn?n? pozn?mky k n?lezu, ale chcete se k n?mu vr?tit. U klasick?ho operace UNDO byste museli zru?it postupn? v?echny 
-posledn? zm?n, abyste nastavili zp?t prvn? zn?n? pozn?ky k n?lezu. V dialogu historie je spln?n? va?eho po?adavku jednoduch?. Pokud budete cht?t jen
+posledn? zm?ny, abyste nastavili zp?t prvn? zn?n? pozn?ky k n?lezu. V dialogu historie je spln?n? va?eho po?adavku jednoduch?. Pokud budete cht?t jen
 zjistit prvn? zn?n? pozn?mky k n?lezu, sta?? si v seznamu zm?n naj?t nejstar?? zn?mu pozn?mky a v sloupku STAR? HODNOTA u? vid?te hledan? text.
 Pokud chcete pozn?mce nastavit jej? prvn? ulo?enou hodnotu, tak sta?? naj?t nejstar?? zm?nu v?sledku revize, vybrat dan? ??dek pomoc?
 sloupku X a kliknout na tla??tko <b>UNDO</b>. Nelekn?te se, ?e v?b?rem dan?ho ??dku se v?m vyberou i ??dky, v kter?ch je zaznamen?na mlad??
 zm?na t?to pozn?mky, toto chov?n? vych?z? z logiky ozna?ov?n? zm?n (pops?no n??e).</i> 
 </div>
 
-Jak ji? bylo zm?n?no, tak pomoc? sloubku X vyb?r?te ?pravy, kter? chcete vr?tit. Ozna?en? ?i odzna?en? lze prov?st my?? kliknut?m v sloubku X po?adovan?ho
+Jak ji? bylo zm?n?no, tak pomoc? sloupku X vyb?r?te ?pravy, kter? chcete vr?tit. Ozna?en? ?i odzna?en? lze prov?st my?? kliknut?m v sloubku X po?adovan?ho
 ??dku. Pro ozna?ov?n? m??ete vyu??t i tla??tka <b><i>Vyber v?e</i></b> a <b><i>Odzna? v?e</i></b>, kter? ozna?? nebo odzna?? v?echny zm?ny n?lezu zobrazen? v tabulce.
 Po?et polo?ek zobrazen?ch v tabulce si m??ete sami nastavit p?eps?n?m hodnoty pro <b><i>Zobrazit ??dk?</i></b> a potvrzen?m nov? hodnoty kl?vesov?m tla??tkem 
 ENTER. V tabulce se p?ep?n?te na dal?? nebo p?edchoz? seznam zm?n pomoc? tla??tek <b><i>P?edchoz?</i></b> a <b><i>N?sleduj?c?</i></b>. Informace o aktu?ln? 
 zobrazen?m seznamu zm?n jsou uvedeny v ??sti pod tabulkou.
 
 <br><br> 
-Po stisknut? tla??tko <b><i>UNDO</i></b> se zobraz? informace se seznamem zm?n, kter? budou provedeny. Volbou tla??tka CANCLE zru??te operaci. 
+Po stisknut? tla??tko <b><i>UNDO</i></b> se zobraz? informace se seznamem zm?n, kter? budou provedeny. Volbou tla??tka STORNO zru??te operaci. 
 Volbou tla??tka OK naopak potvrd?te operaci a provede se n?vrat vybran?ch zm?n n?lezu. Z historie budou smaz?ny v?echny ozna?en? ??dky v dob? zavol?n?
 operace <b><i>UNDO</i></b> (na ozna?en? ??dky byla provedena operace UNDO). 
 
@@ -108,7 +108,7 @@
 
 <h3><i>Logika ozna?ov?n? zm?n</i></h3>
 
-Polo?ky v z?znamu m??ou b?t upravov?ny v?cekr?t, proto je p?i ozna?ov?n? zm?n v dialogu historie nutn? o?et?it n?kolik situac? (viz. n??e).<br>
+Polo?ky v z?znamu m??ou b?t upravov?ny v?cekr?t, proto je p?i ozna?ov?n? zm?n v dialogu historie nutn? o?et?it n?kolik situac?.<br>
 Pro lep?? n?zorn?j?? vysv?tlen? si to uve?me na p??kladu:<br><br> 
 
 <img src="picture/historyOccMark_cs.png">
@@ -137,8 +137,8 @@
 <img src="picture/wholeHistoryEnter_cs.png">
 <br><br>
 
-Dialog celkov? historie sledovan?ch zm?n je p??stupn? pouze u?ivatelovi s pr?vem administr?tora. Pokud m?te administr?torsk? pr?va m??ete tento 
-dialog otev?? z menu <b>Data/Celkov? historie</b>. Pokud administr?torsk? pr?va nem?te je polo?ka v menu pro v?s neaktivn?.
+Dialog celkov? historie sledovan?ch zm?n je p??stupn? pouze u?ivateli s pr?vem administr?tora. Pokud m?te administr?torsk? pr?va m??ete tento 
+dialog otev?? z menu <b>Data/Celkov? historie</b>. Pokud administr?torsk? pr?va nem?te, je polo?ka v menu pro v?s neaktivn?.
 
 <h5>Dialog celkov? historie</h5>
 
@@ -154,7 +154,7 @@
 <li><b>U?ivatel</b> - odpov?d? u?ivatelovi, kter? zm?nu provedl</li>
 <li><b>Polo?ka</b> - informuje o polo?ce, kter? byla zm?n?na</li>
 <li><b>Star? hodnota</b> - obsahuje hodnotu polo?ky p?ed zm?nou (vypln?na jen pro operaci edit)</li>
-<li><b>Nov? hodnota</b> - obseahuje novou hodnotu polo?ky (vypln?na jen pro operaci edit)</li>
+<li><b>Nov? hodnota</b> - obsahuje novou hodnotu polo?ky (vypln?na jen pro operaci edit)</li>
 </ul>
 
 
@@ -173,9 +173,10 @@
 
 <h3>Pro?i?t?n? datab?ze a smaz?n? historie</h3>
 
-V datab?zi jsou ulo?eny i neaktivn? z?znamy, aby bylo mo?n? p?? operaci UNDO je op?t aktivovat. M?te v?ak mo?nost vyu?? operace <b><i>Sma?</i></b>, 
+V datab?zi jsou ulo?eny i z?znamy, kter? u?ivatel smaza a informace o tomto smaz?n? je zaznamen?na v tabulk?ch historie. 
+Existence t?chto neaktivn?ch z?znam? je nutn? pro operaci UNDO. M?te v?ak mo?nost vyu??t operace <b><i>Sma?</i></b>, 
 kter? pro?ist? datab?zi od neaktivn?ch z?znam? a z?rove? sma?e v?echny data z historie. P?ed proveden? t?to operace by bylo dobr? prov?st z?lohu 
-datab?ze. Po stisku tla??tka <b><i>Sma?</i></b> se objevi dilog s informaci o operaci, kterou se chyst?te prov?st, a teprve po potvrzen? tohoto
-dialogu bude operace provedena.  
+datab?ze. Z?lohu datab?ze je nutn? prov?st pomoc? n?stroje t?et? strany. Po stisku tla??tka <b><i>Sma?</i></b> se objev? dialog s informac? o operaci, 
+kterou se chyst?te prov?st, a teprve po potvrzen? tohoto dialogu bude operace provedena.  
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/metadata.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/metadata.html	2006-09-06 21:48:29 UTC (rev 727)
+++ trunk/src/net/sf/plantlore/help/cs/html/metadata.html	2006-09-06 21:50:10 UTC (rev 728)
@@ -9,8 +9,8 @@
 <img src="picture/metadataEnter_cs.png">
 <br><br>
 
-Spr?vce metadat umo??uje administr?torovi p?id?vat, editovat a mazat metadata jednotliv?ch projekt?.  
-Spr?vce metadat otev?ete z menu <b>Data/Spr?va metadat</b> nebo kl?vesovou zkratkou CTRL + M.
+Spr?vce metadat umo??uje <b><i>administr?torovi</i></b> p?id?vat, editovat a mazat metadata jednotliv?ch projekt?.  
+Spr?vce metadat otev?ete z menu <b>Data/Spr?va metadat</b> nebo kl?vesovou zkratkou CTRL + M. 
 
 <h5>Dialog spr?vce metadat</h5>
 
@@ -43,7 +43,7 @@
 podle n?zvu instituce, n?zvu projektu, zdroji dat, jm?no osoby pro technickou podporu, jm?no osoby pro obsahovou podporu, datumu vytvo?en? projektu a 
 datumu posledn? modifikace projektu. Pokud nejsou zad?ny, ?adn? parametry a omezen? budou vyhled?ny v?echny metadata projekt?. 
 <br><br>
-<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli??v?na velk? a mal? p?smena (case insensitive).
+<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli?ov?na velk? a mal? p?smena (case sensitive).
 
 <a name="add"></a><h2>P?id?n? metadat projektu</h2>
   
@@ -66,7 +66,7 @@
     <li><b>Detail k projektu</b> - podrobn?j?? popis projektu.</li>
     <li><b>Zdroj</b> - jm?no nebo k?d datov?ho zdroje. Tato polo?ka je povinn?.</li>
     <li><b>Basis</b> -  informace o tom, co dan? z?znamy popisuj? (preservedSpecimen, ...).</li>
-    <li><b>Pozn?mka</b> - pozn?mka k projektu.</li>
+    <li><b>Biotope</b> - inforace o biotopu</li>
     <li><b>Datum vytvo?en? projektu</b> - datum a ?as, kdy byl projekt vytvo?en. Tato polo?ka je povinn?.</li>
     <li><b>Datum posledn? modifikace projektu</b> - datum a ?as, kdy v projektu byly z?znamy naposled modifikov?ny, vlo?eny nebo smaz?ny.</li>        
  </ul>

Modified: trunk/src/net/sf/plantlore/help/cs/html/user.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/user.html	2006-09-06 21:48:29 UTC (rev 727)
+++ trunk/src/net/sf/plantlore/help/cs/html/user.html	2006-09-06 21:50:10 UTC (rev 728)
@@ -10,6 +10,9 @@
 <img src="picture/userEnter_cs.png">
 <br><br>
 
+Aplikace Plantlore umo?n? p??stup a pr?ci s n?lezov?mi daty jen u?ivatel?m, kte?? maj? v aplikaci vytvo?en? u?ivatelsk? ??et. Data jsou t?mto v?ce
+chr?n?n? p?ed po?kozen?m a zneu?it?. Administr?tor m? p?ehled, kdo m? k n?lezov?m dat?m p??stup a kdo je editoval.
+
 Spr?vce u?ivatel? umo??uje administr?torovi p?id?vat a editovat u?ivatele, nastavovat pr?va u?ivatel? a tak? ukon?ovat jejich p??stup do aplikace. 
 Spr?vce u?ivatel? otev?ete z menu <b>Data/Spr?va u?ivatel?</b>.
 
@@ -40,12 +43,13 @@
   
 <h2>Vyhled?v?n?</h2>
 
-Spr?vce u?ivatel? n?b?z? administr?torovi mo?nost vyhled?vat podle ?ty? parametr?: login, jm?no, email a adresa. V?sledek m??e b?t set??zen podle loginu,
+Spr?vce u?ivatel? n?b?z? administr?torovi mo?nost vyhled?vat podle ?ty? parametr?: p?ihla?ovac? jm?no (login), jm?no, email a adresa. V?sledek m??e 
+b?t set??zen podle p?ihla?ovac?ho jm?na,
 k?esn?ho jm?na, p??jmen? a datumu vytvo?en? u?ivatele a to sestupn?, nebo vzestupn?. Dal??m krit?riem pro vyhled?v?n? je po?adavek zobrazen? v?ech 
 u?ivatel?, nebo jen u?ivatel? s platn?m p??stupem do aplikace (hodnota polo?ky <i>Datum zru?en? u?ivatele</i> je u t?chto u?ivatel? nevypln?na). 
-Pokud nejsou zad?ny, ?adn? parametry a omezen? budou vyhled?ni v?ichni u?ivatel?. 
+Pokud nejsou zad?ny ?adn? parametry a omezen? budou vyhled?ni v?ichni u?ivatel?. 
 <br><br>
-<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli??v?na velk? a mal? p?smena (case insensitive).
+<b>Pozor:</b>  p?i vyhled?v?n? jsou rozli?ov?na velk? a mal? p?smena (case sensitive).
 
 <a name="add"></a><h2>P?id?n? u?ivatele</h2>
   
@@ -53,18 +57,24 @@
   
   <img src="picture/userAdd_cs.png">
   <br><br>
-  Dialog pro p?id?n? nov?ho u?ivatele m??ete otev??t ze Spr?vce U?ivatel?. V zobrazen?m okn? jsou k vypln?n? n?sleduj?c? polo?ky:
+  Dialog pro p?id?n? nov?ho u?ivatele m??ete otev??t ze Spr?vce u?ivatel?. V zobrazen?m okn? jsou k vypln?n? n?sleduj?c? polo?ky:
+  
+  <h4>U?ivatelsk? data</h4>
   <ul>
-    <li><b>Login</b> - login u?ivatele, kter? bude pou??vat k p?ihla?ov?n? do aplikace. Tato polo?ka je povinn? a bez jej?ho vypln?n? v?m aplikace nedovol?
-    ?ivatele p?idat. Login musi b?t v r?mci datab?ze jednozna?n? a nen? po ulo?en? u?ivatele editovateln?.</li>
+    <li><b>Login</b> - login u?ivatele, kter? bude pou??v?n k p?ihla?ov?n? do aplikace. Tato polo?ka je povinn? a bez jej?ho vypln?n? v?m aplikace nedovol?
+    ?ivatele p?idat. Login mus? b?t v r?mci datab?ze jednozna?n? a nen? po ulo?en? u?ivatele editovateln?.</li>
     <li><b>Heslo</b> - p?ihla?ovac? heslo u?ivatele. Tato polo?ka je povinn?.</li>
     <li><b>Jm?no</b> - k?esn? jm?no u?ivatele. Tato polo?ka je povinn?.</li>
     <li><b>P??jmen?</b> - p??jmen? u?ivatele. Tato polo?ka je povinn?.</li>
-    <li><b>Email</b> - email u?ivatele. Tato polo?ka je povinn?.</li>
+    <li><b>Email</b> - email u?ivatele. </li>
     <li><b>Adresa</b> - adresa u?ivatele.</li>    
-    <li><b>Pozn?mka</b> - pozn?mka administr?tora o u?ivateli</li>    
-    <li><b>Administr?torsk? pr?vo</b> - jeho ozna?en?m z?sk? u?ivatel stejn? pr?va jako administr?tor</li>
-    <li><b>Pr?vo editovat v?e</b> - jeho ozna?en?m z?sk? u?ivatel pr?vo editovat v?echny n?lezy v datab?zy</li>
+    <li><b>Pozn?mka</b> - pozn?mka administr?tora o u?ivateli</li>   
+  </ul>
+  <h4>U?ivatelsk? pr?va</h4>  
+  <ul>   
+    <li><b>Administr?torsk? pr?vo</b> - jeho ozna?en?m z?sk? u?ivatel stejn? pr?va jako administr?tor. P?id?len? administr?torsk?ch pr?v d?kladn? 
+    promyslete. <i><b>Doporu?en?:</b> administr?torsk? pr?va by m?l m?t jen jeden u?ivatel, abyste doc?lili v?t?? bezpe?nosti.</li>
+    <li><b>Pr?vo editovat v?e</b> - jeho ozna?en?m z?sk? u?ivatel pr?vo editovat v?echny n?lezy v datab?zi</li>
     <li><b>Pr?vo p?id?vat z?znamy</b> - jeho ozna?en?m z?sk? u?ivatel pr?vo pro p?id?v?n? nov?ch n?lez?</li>
     <li><b>Pravo editace n?lez? u?ivatel?</b> - tato polo?ka obsahuje seznam u?ivatel?, jejich? n?lezy bude moci dan? u?ivatel editovat</li>    
  </ul>
@@ -74,7 +84,7 @@
 <img src="picture/userEdit_cs.png">
 <br><br>
   Dialog pro editaci existuj?c?ho u?ivatele otev?ete ze Spr?vce u?ivatel?. Nezapome?te, ?e pro otev?en? dialogu mus?te m?t ozna?en?ho u?ivatele.
-  Vzhled edit dialogu je t?m?? toto?n? s add dialogem. Povinn? polo?ky jsou: heslo, jm?no, p??jmen?, email.<br> 
+  Vzhled edita?n?ho dialogu je t?m?? toto?n? s dialogem pro p?id?v?n? u?ivatele. Povinn? polo?ky jsou: heslo, jm?no, p??jmen?, email.<br> 
   Needitovatelen? polo?ky jsou: 
   <ul>
     <li><b>Login</b></li>
@@ -85,18 +95,19 @@
 <a name="detail"></a><h2>Detailn? data a pr?va u?ivatele</h2>
 
   Dialog zobrazuj?c? detailn? informaci o u?ivatelovi a jeho pr?vech otev?ete ze Spr?vce u?ivatel?. Pro otev?en? tohoto dialogu je nutn? 
-  ozna?it po?adovan?ho u?ivatele v seznamu u?ivatel?. Dialog je t?m?? toto?n? s edit dialogem. V?echny polo?ky jsou needitovateln?, maj? jen 
+  ozna?it po?adovan?ho u?ivatele v seznamu u?ivatel?. Dialog je t?m?? toto?n? s edita?n?m dialogem. V?echny polo?ky jsou needitovateln?, maj? jen 
   informa?n? charakter.
   
 <a name="drop"></a><h2>Zru?en? p??stupu u?ivatele</h2>
 
   Pro zru?en? p??stupu u?ivatele do aplikace se pou?ije tla??tko <i><b>Zru? u?ivatele</b></i> ve spr?vci u?ivatel?. P?ed stisknut?m tohoto tla??tka je nutn?
   ozna?i po?adovan?ho u?ivatele v seznamu u?ivatel?. Po stisku tohoto tla??tka bude u?ivatel informov?n o operaci, kterou se chyst? prov?st. Potvrzen?m
-  t?to operace bude u?ivatelovi nastaven aktualn? ?as do polo?ky <i>Datum zru?en? u?ivatele.</i>.   
+  t?to operace bude u?ivateli nastaven aktu?ln? ?as do polo?ky <i>Datum zru?en? u?ivatele.</i>.   
   <br><br>
   <img src="picture/userDrop_cs.png">
   <br><br>
-  Obnoven? p??stupu pro zru?en?ho u?ivate znamen? p?id?n? nov?ho u?ivatele. V datab?zi tak z?st?v? p?ehled o obdob?ch, kdy m?l kter? u?ivatel 
+  Obnoven? p??stupu pro zru?en?ho u?ivate znamen? p?id?n? nov?ho u?ivatele. Login p?id?van?ho u?ivatele mus? b?t v r?mci datab?ze jednozna?n? (tzn. 
+  nelze pou??t login u?ivatele, kter? m? nebo d??ve m?l ??et v dan? datab?zi). V datab?zi tak z?st?v? p?ehled o obdob?ch, kdy m?l kter? u?ivatel 
   p??stup do aplikace.  
 
 <a name="rights"></a><h2>Pr?va u?ivatele</h2>
@@ -110,7 +121,7 @@
   <ul>
     <li><b>pr?vo prohl??en? dat</b> - toto pr?vo se nikde nenastavuje a u?ivatel je z?sk?v? automaticky s vytvo?en?m p??stupu do aplikace</li>
     <li><b>pr?vo p?id?vat data</b> - nastaven?m tohoto pr?va m? u?ivatel mo?nost p??d?vat n?lezy, autory a publikace. Z?rove? m? automaticky pr?vo
-    editovat z?znamy, kter? p?idal. D?le m? pr?vo na zobrazen? historie n?lezu, kter? p?idal.</li>
+    editovat z?znamy, kter? p?idal a  prohl??et v?echny n?lezy. D?le m? pr?vo na zobrazen? historie n?lezu, kter? p?idal.</li>
     <li><b>pr?vo editace data jin?ch u?ivatel?</b> - u?ivatel (Pepa) m??e po?adat administr?tora o p?id?n? konkr?tn?ho  
     u?ivatele (Franty) do senamu u?ivatel?, jejich? z?znamy m? pr?vo editovat (s pr?vem editovat z?znam je i spojeno pr?vo p?istupovat k historii 
     tohoto z?znamu). P?id?n? u?ivatel? do tohoto seznamu z?le?? na administr?torovi a na vz?jemn? domluv? u?ivatel?.</li>



From fraktalek at mail.berlios.de  Wed Sep  6 23:54:23 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Wed, 6 Sep 2006 23:54:23 +0200
Subject: [Plantlore-dev] r729 -
	trunk/src/net/sf/plantlore/client/overview/tree
Message-ID: <200609062154.k86LsNWB032285@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-06 23:54:23 +0200 (Wed, 06 Sep 2006)
New Revision: 729

Modified:
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
Log:
A minor l10n tweak.



Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-06 21:50:10 UTC (rev 728)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-06 21:54:23 UTC (rev 729)
@@ -186,7 +186,7 @@
         DefaultMutableTreeNode node;
         for (Object record : records) {
             Object[] obj = (Object[])record;
-            String name = ((NearestVillage)obj[2]).getName() + " - " + obj[1] + " (quadrant " + obj[3] + ")";
+            String name = ((NearestVillage)obj[2]).getName() + " - " + obj[1] + " ("+L10n.getString("HABITAT.quadrant")+" "+ obj[3] + ")";
             Integer count = getOccurrenceCount((Integer)obj[0]);
             name = "("+count+") "+name;
             node = new DefaultMutableTreeNode(new NodeInfo(NodeInfo.NodeType.HABITAT,name,(Integer)obj[0],-1));



From kovo at mail.berlios.de  Thu Sep  7 00:52:49 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 00:52:49 +0200
Subject: [Plantlore-dev] r730 - trunk/src/net/sf/plantlore/server
Message-ID: <200609062252.k86MqnfT006252@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 00:52:45 +0200 (Thu, 07 Sep 2006)
New Revision: 730

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Fix JDBCException handling in DBLayer

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 21:54:23 UTC (rev 729)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-06 22:52:45 UTC (rev 730)
@@ -556,7 +556,7 @@
             }
         } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while retrieving the data from the database. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Exception.RetrieveData"), DBLayerException.ERROR_LOAD_DATA, e);
+            throw new DBLayerException(L10n.getString("Exception.RetrieveData"), e);
         } catch (HibernateException e) {
             logger.error("Cannot move to the given row of results: "+from+"; Details: "+e.getMessage());
             throw new DBLayerException(L10n.getString("Exception.RetrieveData"), DBLayerException.ERROR_LOAD_DATA, e);
@@ -727,7 +727,7 @@
                 tx.rollback();
             }            
             logger.fatal("JDBC Exception caught while executing Select query. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Error.DatabaseQuery"), /*DBLayerException.ERROR_SELECT, */e);            
+            throw new DBLayerException(L10n.getString("Error.DatabaseQuery"), e);            
         } catch (HibernateException e) {
             if (tx != null) {
                 tx.rollback();
@@ -791,7 +791,7 @@
                 tx.rollback();
             }            
             logger.fatal("Cannot execute conditional delete on table "+tableClass.getName());
-            throw new DBLayerException(L10n.getString("Exception.DeleteRecord"), DBLayerException.ERROR_DELETE, e);            
+            throw new DBLayerException(L10n.getString("Exception.DeleteRecord"), e);            
         } finally {
             if (session != null) session.close();
         }
@@ -869,7 +869,7 @@
             this.longTx = this.txSession.beginTransaction();
        } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while starting database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Exception.StartTransaction"), DBLayerException.ERROR_TRANSACTION, e);
+            throw new DBLayerException(L10n.getString("Exception.StartTransaction"), e);
         } catch (HibernateException e) {
             logger.fatal("Cannot start database transaction");
             throw new DBLayerException(L10n.getString("Exception.StartTransaction"), DBLayerException.ERROR_TRANSACTION, e);
@@ -907,14 +907,12 @@
         }   catch (JDBCException e) {
             this.rollbackTransaction();
             logger.fatal("JDBC Exception caught while commiting database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
-            ex.setError(ex.translateSQLState(e.getSQLState()), e.getMessage());                        
+            DBLayerException ex = new DBLayerException("Exception.CommitTransaction", e);
             throw ex;
         } catch (HibernateException e) {
             this.rollbackTransaction();    
             logger.fatal("Cannot commit database transaction");
-            DBLayerException ex = new DBLayerException("Exception.CommitTransaction");
-            ex.setError(ex.ERROR_TRANSACTION, e.getMessage());
+            DBLayerException ex = new DBLayerException("Exception.CommitTransaction", DBLayerException.ERROR_TRANSACTION, e);
             throw ex;            
         }
 
@@ -947,7 +945,7 @@
             this.txSession.close();
        } catch (JDBCException e) {
             logger.fatal("JDBC Exception caught while rollbacking database transaction. SQL State: "+e.getSQLState()+"; Details: "+e.getMessage());
-            throw new DBLayerException(L10n.getString("Exception.RollbackTransaction"), DBLayerException.ERROR_TRANSACTION, e);
+            throw new DBLayerException(L10n.getString("Exception.RollbackTransaction"), e);
         } catch (HibernateException e) {
             logger.fatal("Cannot rollback database transaction");
             throw new DBLayerException(L10n.getString("Exception.RollbackTransaction"), DBLayerException.ERROR_TRANSACTION, e);            



From fraktalek at mail.berlios.de  Thu Sep  7 01:43:16 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 01:43:16 +0200
Subject: [Plantlore-dev] r731 - trunk
Message-ID: <200609062343.k86NhG7v013505@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 01:43:14 +0200 (Thu, 07 Sep 2006)
New Revision: 731

Modified:
   trunk/build.xml
Log:
Removed codebase setting in run-client target.



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-06 22:52:45 UTC (rev 730)
+++ trunk/build.xml	2006-09-06 23:43:14 UTC (rev 731)
@@ -76,8 +76,7 @@
 		<java jar="${dist.dir}/plantlore-client.jar"
                       fork="true"
                       dir="${dist.dir}">
-                        <jvmarg value="-Djava.rmi.server.codebase=file://${dist.dir}/"/>
-                        <!--<jvmarg value="-Djava.rmi.server.hostname=my.ip.add.ress"/> -->
+                        <!--<jvmarg value="-Djava.rmi.server.hostname=ip"/> -->
 		</java>
 	</target>
 	



From fraktalek at mail.berlios.de  Thu Sep  7 02:50:56 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 02:50:56 +0200
Subject: [Plantlore-dev] r732 - in trunk/src/net/sf/plantlore/help/cs: . html
Message-ID: <200609070050.k870ouW1020951@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 02:50:55 +0200 (Thu, 07 Sep 2006)
New Revision: 732

Added:
   trunk/src/net/sf/plantlore/help/cs/html/habitattree.html
Modified:
   trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
   trunk/src/net/sf/plantlore/help/cs/html/overview.html
   trunk/src/net/sf/plantlore/help/cs/html/search.html
   trunk/src/net/sf/plantlore/help/cs/html/settings.html
   trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm
   trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml
Log:
Updated user documentation, changed the help structure a little.



Modified: trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-07 00:50:55 UTC (rev 732)
@@ -5,36 +5,90 @@
 <title>Plantlore - P?id?v?n? a editace n?lez?</title>
 </head>
 <body>
-<h1>P?id?v?n? a editace n?lez?</h1>
-<p>Dialogy pro p?id?v?n? a editaci n?lezu jsou v z?sad? stejn?, li?? se jen v u?elu a detailech chov?n?.
-Editaci i p?id?v?n? je mo?n? vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze stromu n?lez?. 
-Pak se v p?id?vac?m dialogu p?edvypln? ?daje dan? lokality.</p>
+<h1>P?id?v?n? a ?prava n?lez?</h1>
+<p>Z?kladn? manipulaci s n?lezy lze prov?d?t v dialoz?ch pro p?id?v?n? a ?pravu n?lezu. Ka?d? u?ivatel
+m??e upravovat jen ty z?znamy, ke kter?m m? pr?vo editace. Pro p?id?n? nov?ho n?lezu u?ivatel tak?
+mus? m?t pr?va.</p>
 
+<h2>Obsah</h2>
+<ol>
+    <li>Dialogy</li>
+    <li>?prava n?lezu</li>
+    <li>Vypnut? nepovinn?ch polo?ek</li>
+    <li>Kontrola zadan?ch hodnot</li>
+    <li>Sd?len? lokalit</li>
+    <li>Na z?v?r</li>
+</ol>
+
+<h2>1. Dialogy</h2>
+<p>Dialogy pro p?id?v?n? a ?pravu n?lezu jsou velmi podobn? vzhledem i chov?n?m.
+?pravu i p?id?v?n? m??ete vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze <a href="habitattree.html">stromu lokalit</a>. 
+</p>
+<br>
+
 <img src="picture/addedit_place_cz.png" alt="Horn? ??st dialogu s polo?kami o m?st? n?lezu">
 
-<p>Dialog se v obou p??padech skl?d? ze t?? ??st?: zad?v?n? m?sta, zad?v?n? n?lezu a tabulky
+<p>Dialog se v obou p??padech skl?d? ze t?? ??st?: zad?v?n? lokality, zad?v?n? n?lezu a tabulky
  seznamu n?lez?. Tabulka se seznamem n?lez? obsahuje v?echny n?lezy obsa?en? v dan? lokalit?. Je zobrazena
  pro snaz?? orientaci v ji? zadan?ch n?lezech. V?dy je nutn? vyplnit v?echny povinn? polo?ky (jsou 
- ozna?eny hv?zdi?kou). Po zad?n? polo?ek se kliknut?m na tla??tko Ok p?id? nov? n?lez. Dialog z?stane 
- otev?en? i se v?emi vypln?n?mi hodnotami pro snaz?? zad?v?n? v?ce n?lez? na stejn?m m?st? (p??padn? 
- stejn?ho n?lezu na r?zn?ch m?stech). Vymaz?n? vypln?n?ch hodnot je mo?n? tla??tkem Vyma?, kter? vyma?e
- hodnoty v p??slu?n? sekci.</p>
+ ozna?eny hv?zdi?kou). Po kliknut? na tla??tko Ok se p?id? nov? n?lez. Zobraz? se okno informuj?c? o ?sp??n?m 
+ p?id?n? a dialog z?stane  otev?en? i se v?emi vypln?n?mi hodnotami. To umo??uje snaz?? a rychlej?? zad?v?n? v?ce n?lez?,
+ kter? maj? n?kter? ?daje spole?n?. <b>POZOR:</b> p?i op?tovn?m kliknut? na Ok
+ se stejn? n?lez p?id? znovu! Tla??tko Vyma? vyma?e hodnoty ve sloupc?ch p??slu?n? ??sti dialogu, aby bylo mo?n?
+ rychleji zadat nov? data.</p>
+<br>
 
 <img src="picture/addedit_occurrence_cz.png" alt="Prost?edn? ??st dialogu s polo?kami o n?lezu.">
 
-<p>Pokud byl dialog pro p?id?v?n? vyvol?n pro ur?itou lokalitu ze stromu lokalit, pak 
-u? je prvn? ??st dialogu, zad?v?n? m?sta, p?edvypln?na. </p>
+<p>M?sto je mo?n? up?esnit zad?n?m sou?adnic GPS. Sou?adnice je mo?n? zadat v jednom 
+ze t?? sou?adn?ch syst?m?: S-JTSK, S42 a WGS84. Plantlore pou??v? jako z?kladn? sou?adn? syst?m syst?m 
+WGS84, do kter?ho se zadan? sou?adnice v?dy p?evedou.</p>
 
-<p>M?sto je mo?n? up?esnit zad?n?m sou?adnic GPS. A to bu? prost?m veps?n?m sou?adnic anebo nahr?n?m 
-tabulky GPS sou?adnic a zad?n?m pouze symbolu konkr?tn? sou?adnice. Sou?adnice je mo?n? zadat v jednom 
-ze t?? sou?adn?ch syst?m?: SJTSK, S42 a WGS84. Plantlore pou??v? jako z?kladn? sou?adn? syst?m syst?m 
-WGS84, do kter?ho se zadan? sou?adnice v?dy p?evedou. Nahranou tabulku s GPS sou?adnicemi je mo?n? 
-zobrazit kliknut?m na tla??tko Zobrazit.</p>
-
 <p>Tabulka n?lez? v dan? lokalit?. Zobrazuje se pouze informace o autorech, taxonu a datu n?lezu.</p>
+<br>
+<img src="picture/addedit_occurrence_table_cz.png" alt="Tabulka n?lez? v dan? lokalit?">
 
-<img src="picture/addedit_occurrence_table_cz.png" alt="Tabulka n?lez? v dan? lokalit?">
-<p></p>
-<p></p>
+<h2>2. ?prava n?lezu</h2>
+<p>
+    B?hem upravov?n? n?lezu m??ete upravovan? n?lez smazat nebo naopak p?idat n?lezy nov?. Upravovac? dialog
+    je v tomto ohledu velmi pru?n? a pozn?, jak? akce m? prov?st. Pokud b?hem editace n?lezu sma?ete p?vodn?
+    taxon, projev? se to v datab?zi jako byste dan? n?lez smazali vyvol?n?m funkce maz?n? v <a href="overview.html">P?ehledu n?lez?</a>.
+    P?id?n? nov?ch taxon? se projev? stejn? jako by byly p?id?ny p?id?vac?m dialogem.
+</p>
+
+<h2>3. Vypnut? nepovinn?ch polo?ek</h2>
+<p>?asto se stane, ?e nebudete ch?t vypl?ovat v?echny nepovinn? informace o n?lezu. V tomto p??pad?
+m??ete v dialogu "vypnout" ty nepovinn? polo?ky, kter? zad?vat nechcete. Pohyb po dialogu nap??klad
+tabul?torem pak bude rychlej??. Vyp?nan? a zap?n?n? nepovinn?ch polo?ek se prov?d? v dialogu nastaven?, kter?
+ vyvol?te kliknut?m na tla??tko Nastaven? v lev? doln? ??sti p?id?vac?ho nebo upravovac?ho dialogu.</p>
+
+
+<h2>4. Kontrola zadan?ch hodnot</h2>
+<p>Plantlore automaticky kontroluje spr?vnost zadan?ch dat. Kontroluje se:
+    <ul>
+        <li>zad?n? v?ech povinn?ch polo?ek</li>
+        <li>spr?vnost zadan?ho data n?lezu (kontroluje se, zda zadan? den existuje)</li>
+        <li>d?lka zadan?ch dat - nap??klad pozn?mky mohou m?t 4096 znak?</li>
+        <li>korektnost hodnoty - je-li ??slo, tam kde se o?ek?v? ??slo, ... P?i zad?v?n? ??seln? hodnoty je pot?eba pou??t odd?lova? desetinn?ch m?st pro dan? jazykov? prost?ed?, v ?esk?m prost?ed? to je desetinn? ??rka.</li>
+    </ul>        
+</p>
+
+<h2>5. Sd?len? lokalit</h2>
+<p>Zad?te-li pro danou lokalitu v?ce n?lez?, budou v?echny tyto n?lezy na ?rovni datab?zov?ho modelu
+m?t tuto lokalitu sd?let. To v praxi znamen?, ?e Plantlore pozn?, jak? n?lezy do dan? lokality pat??. To
+se projev? nap??klad, pokud budete upravovat lokalitu n?lezu se sd?lenou lokalitou. V tom p??pad? se v?s
+Plantlore po kliknut? na Ok zept?, zda chcete lokalitu upravit v?em n?lez?m anebo jenom tomuto. Pokud vyberete
+jen tento, tak Plantlore vytvo?? novou lokalitu, kter? se od p?vodn? bude li?it t?m, co jste zm?nili. Lokalita
+je z datab?ze smaz?na ve chv?li, kdy je smaz?n posledn? n?lez, kter? se na n? odkazuje.</p>
+
+<h2>6. Na z?v?r</h2>
+      <p>Pr?ce s n?lezy vy?aduje rozvahu - nap??klad co se t??e sd?len? lokalit jednotliv?mi n?lezy. P?i zad?n?
+      nov?ho n?lezu od za??tku Plantlore zkou??, jestli u? dan? lokalita v datab?zi existuje a pokud ano, tak ji 
+      nov? n?lez bude sd?let s ostatn?mi. Sta?? ale jen mal? odchylka v zadan?ch ?daj?ch o lokalit? a vytvo?? se 
+      lokalita nov?, ve kter? bude n?lez s?m. Za poctiv? zad?v?n? povinn?ch polo?ek povinn?mi hodnotami zase 
+      budete odm?n?ni snadn?j?? orientac? v datech nap??klad pomoc? <a href="habitattree.html">stromu lokalit</a>.</p>
   </body>
 </html>
+
+
+

Added: trunk/src/net/sf/plantlore/help/cs/html/habitattree.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/habitattree.html	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/html/habitattree.html	2006-09-07 00:50:55 UTC (rev 732)
@@ -0,0 +1,30 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Vytv??en? nov? datab?ze</title>
+  </head>
+  <body>
+  <h1>Strom lokalit</h1>
+ <p>Strom lokalit slou?? k rychl?mu hled?n? v n?lezech podle geografick?ho ?len?n?. Je mo?n? ho vyvolat z panelu n?stroj?
+ v hlavn?m okn? aplikace.</p>
+ <br>
+ <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
+ <br>
+ 
+ <p>Prvn? vrstva stromu obsahuje ?zem? (teritoria), ka?d? ?zem? pak obsahuje fytochoriony a kone?n? ka?d?
+ fytochorion obsahuje seznam lokalit. Strom obsahuje pouze ty fytochoriony a ?zem?, kter? u? n?jak? n?lez obsahuj?.
+  Fytochoriony neobsahuj?c? ??dn? n?lez zobrazeny nejsou. Stejn? tak ?zem?, kter? neobsahuj? alespo? jeden fytochorion
+  obsahuj?c? n?lez nejsou zobrazena.</p>
+  
+  <p>N?lezy v dan? lokalit? m??ete zobrazit bu? dvojklikem na uzel lokality anebo je mo?n? jednoduch?m kliknut?m lokalitu ozna?it
+   a pak bu? kliknout na lev? doln? tla??tko hledat anebo prav?m kliknut?m my?i vyvolat kontextov? menu a v n?m vybrat polo?ku "Hledat".</p>
+   
+   <p>Informace ve stromu se automaticky neaktualizuj? spolu s ?pravami n?lezov?ch dat v datab?zi, aby se p?ede?lo neo?ek?van?mu zpomalen? 
+   aplikace p?i pomal?m p?ipojen? k serveru Plantlore p?i komunikaci p?es s??. Seznam lokalit ve fytochorionu se z datab?ze znovu na??t?
+   p?i ka?d?m rozbalen? uzlu fytochorionu. Pro nov? na?ten? cel? struktury stromu slou?? prav?
+   doln? tla??tko Obnovit. Funkci Obnovit je mo?n? vyvolat i z kontextov?ho menu.
+   </p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/overview.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-07 00:50:55 UTC (rev 732)
@@ -7,52 +7,68 @@
   </head>
   <body>
   <h1>P?ehled n?lez?</h1>
+  <p>Centrem Plantlore je p?ehled n?lez?, do kter?ho se dostanete po ?sp??n?m p??hl??en? k serveru. Z p?ehledu
+  n?lez? je pak mo?n? vyvol?vat v?t?inu ostatn?ch funkc? Plantlore.</p> 
+  <br>
    <img src="picture/overview.png" alt="P?ehled n?lez?"><br>
-    <p>Centrem Plantlore je p?ehled n?lez?. Je to tabulka zobrazuj?c? seznam n?lez?. Implicitn? jsou zobrazeny
+    <h2>Obsah</h2>
+    <ol>
+        <li>?vod</li>
+        <li>Ovl?dac? prvky p?ehledu n?lez?</li>
+        <li>T??d?n?</li>
+        <li>Po?ad? sloupk?</li>
+        <li>Podrobnosti o n?lezu</li>
+    </ol>
+    <h2>1. ?vod</h2>
+    <p> P?ehled n?lez? je tabulka zobrazuj?c? seznam n?lez?. Implicitn? jsou zobrazeny
     v?echny z?znamy. Jejich seznam je ale mo?n? z??it <a href="search.html">vyhled?v?n?m</a>. </p>
     
     <p>V?sledek vyhled?v?n? se v?dy zobrazuje v P?ehledu n?lez?. Pro n?vrat k seznamu v?ech n?lez? sta??
-    vyvolat <a href="search.html">dialog hled?n?</a>, nic nevyplnit a pouze kliknout na Ok.</p>
+    vyvolat <a href="search.html">dialog hled?n?</a>, nic nevyplnit a pouze kliknout na tla??tko Ok.</p>
     
+    <h2>2. Ovl?dac? prvky p?ehledu n?lez?</h2>
     <p>Pokud s n?lezy pracujete, p?ehled n?lez? se automaticky neaktualizuje, z?st?vaj? v n?m zobrazeny
-    star? hodnoty. To je kv?li efektivn?j?? pr?ci s aplikac? p?i pomalej??m p?ipojen? na s??. Obnoven?
+    star? hodnoty. Tak je to z d?vodu efektivn?j?? pr?ce s aplikac? p?i pomalej??m p?ipojen? na s??. Obnoven?
     p?ehledu se prov?d? bu? op?tovn?m hled?n?m anebo kliknut?m na tla??tko Obnovit v prav? doln? ??sti okna.</p>
-    
+    <br>
     <img src="picture/overview_second_toolbar.png" alt="N?stroje pro pr?ci s p?ehledem n?lez?"><br>
     
-    <p>Po?et z?znam? na str?nku je mo?n? p?eps?n?m ??sla mezi tla??tky P?edchoz? a N?sleduj?c?. Po potvrzen?
-    stiskem kl?vesy Enter se velikost str?nky zm?n?. Po?et z?znam? na str?nku se tak? m??e ur?ovat dynamicky
-    podle aktu?ln? velikosti okna. Toto chov?n? lze zapnout v <a href="settings.html">Nastaven?ch</a>. P?i 
-    pr?ci po s?ti a pomalej??m p?ipojen? ale doporu?ujeme m?t tuto funkci vypnutou.</p>
+    <p>Po?et z?znam? na str?nku je mo?n? m?nit p?eps?n?m ??sla mezi tla??tky P?edchoz? a N?sleduj?c?. Po potvrzen?
+    stiskem kl?vesy Enter se velikost str?nky zm?n?. Po?et z?znam? na str?nku z technick?ch d?vod? NEN? moment?ln? mo?n? 
+    ur?ovat dynamicky
+    podle aktu?ln? velikosti okna. Z bezpe?nostn?ch d?vod? je po?et z?znam? na stranu omezen na 1 000.</p>
     
     <p>Chceteli z?znamy mazat, tisknout nebo exportovat je pot?eba je nejprve vybrat ozna?en?m ve sloupku
-        s n?zvem X. Ozna?en? z?znamu je mo?n? za?krtnut?m p??slu?n?ho pol??ka ve sloupku X. K hromadn?mu ozna?en?, 
+        s n?zvem X. Ozna?ov?n? z?znamu se prov?d? za?krtnut?m p??slu?n?ho pol??ka ve sloupku X. K hromadn?mu ozna?en?, 
         odzna?en? a invertov?n? ozna?en?ch z?znam? slou?? tla??tka V?e, Nic a Invertuj v lev? doln? ??sti okna.
-        <i>Akce se pak v?dy t?k? pouze z?znam? na aktu?ln? str?nce!</i> Po ozna?en? z?znam?, se kter?mi chcete pracovat,
-    u? pouze sta?? vyvolat p??slu?n? p??kaz bu? z menu, z n?strojov? li?ty anebo kl?vesovou zkratkou.</p>
-    
+        <b>POZOR:</b><i> Vyvolan? ozna?ovac? akce se v?dy t?k? pouze z?znam? na aktu?ln? str?nce!</i> Po ozna?en? z?znam?, se kter?mi chcete pracovat,
+    sta?? vyvolat p??slu?n? p??kaz z menu, n?strojov? li?ty anebo kl?vesovou zkratkou.</p>
+    <br>
     <img src="picture/overview_selecting.png" alt="V?b?r z?znam?"><br>
     
+    <h2>3. T??d?n?</h2>
     <p>P?ehled n?lez? tak? poskytuje omezen? mo?nosti t??d?n? z?znam?. T??d? se v?dy pouze z?znamy aktu?ln?
     zobrazen? na str?nce. Net??d? se v?echny z?znamy v datab?zi, proto?e by to p?i velk?m mno?stv? z?znam? 
-    vy?adovalo mnoho ?asu v p??pad? pomalej??ho spojen? k serveru. Chcete-li set??dit z?znamy na str?nce 
-    nap??klad podle roku n?lezu, sta?? kliknout na z?hlav? sloupku Rok. V z?hlav? se objev? ?ipka indikuj?c? sm?r t??d?n?.
+    vy?adovalo mnoho ?asu v p??pad? pomalej??ho spojen? k serveru. Chcete-li set??dit z?znamy  
+    nap??klad podle roku n?lezu, klikn?te na z?hlav? sloupku Rok. V z?hlav? se objev? ?ipka indikuj?c? sm?r t??d?n?.
     Z?znamy se po prvn?m kliknut? set??d? vzestupn? podle roku.
     Chcete-li je set??dit setupn? sta?? znova kliknout na z?hlav? sloupku Rok. T?et? kliknut? t??d?n? zru??. 
     P?ehled umo??uje i druhotn? t??d?n?, tj. nap??klad nejd??ve podle roku a pak podle nejbli???ho s?dla. 
-    To lze prov?st jednodu?e kliknut?m nejd??ve na z?hlav? sloupku Rok a pak stisknout a dr?et kl?vesu Ctrl
-    a kliknout na z?hlav? sloupku Nejbli?s? s?dlo. Druhotn? t??d?n? indikuje o n?co men?? ?ipka v z?hlav?.</p>
-    
+    To lze prov?st kliknut?m nejd??ve na z?hlav? sloupku Rok a pak stisknout a dr?et kl?vesu Ctrl
+    a kliknout na z?hlav? sloupku Nejbli?s? s?dlo. Druhotn? t??d?n? indikuje o n?co men?? ?ipka v z?hlav? sloupku.</p>
+    <br>
     <img src="picture/overview_sorting.png" alt="T??d?n? z?znam?"><br>
     
-    <p>Po?ad? zobrazen?ch sloupk? je mo?n? tak? m?nit. A to bu? do?asn? prost?m p?esunut?m sloupku za jeho
-    z?hlav? anebo trvale v <a href="settings.html">Nastaven?ch</a>. V nastaven?ch je mo?n? si vybrat
+    <h2>4. Po?ad? sloupk?</h2>
+    <p>Po?ad? zobrazen?ch sloupk? je mo?n? m?nit. A to bu? do?asn? prost?m p?esunut?m sloupku, chycen?m a posouv?n?m my?? za jeho
+    z?hlav?, anebo trvale v <a href="settings.html">Nastaven?ch</a>. V nastaven?ch je mo?n? si vybrat
     i jin? sloupky, kter? se maj? zobrazit, p??padn? n?jak? vynechat.</p>
     
+    <h2>5. Podrobnosti o n?lezu</h2>
     <p>V tabulce n?lez? nejsou vid?t v?echny informace o n?lezu. Ty je mo?n? zobrazit bu? vyvol?n?m
     dialogu pro editaci n?lezu nebo vyvol?n?m detailu n?lezu. Detail n?lezu se vyvol?v? bu? dvojklikem na 
-    p??slu?n? n?lez anebo ozna?en?m n?lezu a stiskem Enteru.</p>
-    
+    p??slu?n? n?lez anebo ozna?en?m n?lezu my?? a stiskem kl?vesy Enter.</p>
+    <br>
     <img src="picture/overview_detail.png" alt="Detail n?lezu"><br>
     
     <p>Detail n?lezu umo??uje p?echod na dal?? nebo p?edchoz? n?lez kliknut?m na tla??tko P?edch?zej?c? nebo

Modified: trunk/src/net/sf/plantlore/help/cs/html/search.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/search.html	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/html/search.html	2006-09-07 00:50:55 UTC (rev 732)
@@ -7,73 +7,59 @@
   </head>
   <body>
   <h1>Vyhled?v?n? v n?lezov?ch datech</h1>
-<p>V Plantlore existuj? dva zp?soby jak vyhled?vat data - pomoc? vyhled?vac?ho dialgu 
-a pomoc? tzv. stromu lokalit.</p>
+<p>V Plantlore existuj? dva zp?soby jak vyhled?vat data - pomoc? vyhled?vac?ho dialogu, o kter?m se v?ce
+dozv?te zde, a pomoc? takzvan?ho <a href="habitattree.html">stromu lokalit</a>.</p>
 
-<h2>Vyhled?vac? dialog</h2>
-<p>Vyhled?vac? dialog obsahuje t?m?? stejn? pole jako dialog pro p?id?v?n? a editaci n?lez?. Vyhled?vat
-je tedy mo?n? podle jak?chkoli zadan?ch ?daj?.</p>
+<h2>Obsah</h2>
+<ol>
+    <li>Vyhled?vac? dialog</li>
+    <li>P?id?v?n? autor?</li>
+    <li>Logika vyhled?v?n?</li>
+</ol>
 
+<h2>1. Vyhled?vac? dialog</h2>
+<p>Vyhled?vac? dialog obsahuje t?m?? stejn? polo?ky jako dialog pro p?id?v?n? a ?pravu n?lez?, pouze jinak uspo??dan?. 
+Vyhled?vat je tedy mo?n? podle jak?chkoli zadan?ch ?daj?.</p>
+<br>
 <img src="picture/search_dialog_simple_cz.png" alt="Z?kladn? vyhled?vac? dialog">
 <br>
 
-<p>V?echna pole se zobraz? a? v roz???en?m dialogu po kliknut? na tla??tko Extended.</p>
+<p>V?echny polo?ky dialogu se zobraz? v roz???en?m dialogu po kliknut? na tla??tko Roz???en?.</p>
+<br>
 <img src="picture/search_dialog_extended_cz.png" alt="Roz???en? ??st vyhled?vac?ho dialogu">
+<br>
+<p>Dialog se otev?r? pr?zdn?. Pokud jej pr?zdn? nech?te a rovnou stisknete tla??tko Ok, tak
+se v <a href="overview.html">P?ehledu n?lez?</a> objev? seznam v?ech n?lez?.</p>
 
-<p>Dialog se otev?r? pr?zdn?. Pokud jej pr?zdn? nech?te a rovnou stisknete Ok, tak
-se v <a href="overview.html">P?ehledu n?lez?</a> objev? seznam v?ech n?lez?. Co? je tedy
-zp?sob, jak se vr?tit ke zobrazen? v?ech n?lez?.</p>
-
-<p>Je mo?n? zadat jakoukoliv kombinaci zobrazen?ch vyplniteln?ch polo?ek, kterou
+<p>Je mo?n? zadat jakoukoliv kombinaci zobrazen?ch polo?ek, kterou
 dialog povol?. Nepovol? nap??klad sou?asn? zad?n? ?asov?ho intervalu a m?s?ce. Stejn?
-jako dialogy pro p?id?v?n? a editaci kontroluje spr?vnost zadan?ch hodnot. Tj. nap??klad, ?e 
-nadmo?sk? v??ka obsahuje ??seln? ?daj.</p>
+jako dialogy pro p?id?v?n? a ?pravu kontroluje spr?vnost zadan?ch hodnot. Nap??klad se kontroluje, zda 
+nadmo?sk? v??ka obsahuje ??seln? ?daj (rozli?uje se i spr?vnost desetinn?ho odd?lova?e podle jazykov?ho prost?ed?).</p>
 
-<h3>P?id?v?n? autor?</h3>
-<p>Zad?n? autora, role ?i pozn?mky u autora se prov?d? stejn? jako u P?id?vac?ho a editovac?ho dialogu.
-Pro p?id?n? autora klikn?te na tla??tko P?idej/Add v lev? horn? ??sti z?kladn?ho formul??e.
+<h2>2. P?id?v?n? autor?</h2>
+<p>Zad?n? autora, role ?i pozn?mky u autora se prov?d? stejn? jako u <a href="addoccurrence.html">P?id?vac?ho a editovac?ho dialogu</a>.
+Pro p?id?n? autora klikn?te na tla??tko P?idej v lev? horn? ??sti z?kladn?ho formul??e.
 Objev? se nov? ??dek. Zde je mo?n? vyplnit jm?no autora nebo roli autora nebo pozn?mku
 autora k n?lezu. Pokud zad?te jak autora, roli i pozn?mku autora, tak se nebude hledat tato trojice,
-ale budou hled?ny n?lezy bu? se zadan?m autorem nebo se zadanou rol? nebo se zadanou pozn?mkou. Tj.
-?daje se p?i vyhled?v?n? spojuj? logickou spojkou NEBO. P?id?te-li dal?? ??dek, op?t se bude vyhled?vat
-pomoc? spojky NEBO. Pro n?zornost mal? p??klad. U?ivatel v prvn?m ??dku zad? jako autora "Nov?ka" a jako
-roli "collect". V druh?m ??dku zad? autora "?irok?" a roli "revised". Pokud pot? klikne na Ok, tak
+ale budou hled?ny n?lezy bu? se zadan?m autorem nebo se zadanou rol? nebo se zadanou pozn?mkou. To znamen?, ?e se
+tyto ?daje p?i vyhled?v?n? spojuj? logickou spojkou NEBO. P?id?te-li dal?? ??dek, op?t se bude vyhled?vat
+pomoc? spojky NEBO. Pro n?zornost uvedeme mal? p??klad. U?ivatel v prvn?m ??dku zad? jako autora "Nov?k" a jako
+roli "collected". V druh?m ??dku zad? autora "?irok?" a roli "revised". Pokud pot? klikne na Ok, tak
 se v p?ehledu n?lez? objev? v?echny n?lezy u nich? je jako jeden z autor? uveden bu? Nov?k nebo ?irok?
 a tak? se zobraz? v?echny n?lezy, u kter?ch existuje autor v roli "collect" nebo autor v roli "revised".</p>
 
-<h3>Logika vyhled?v?n?</h3>
-<p>Jak funguje dotaz v p??pad? autor?, rol? a pozn?mek autor? k n?lez?m jsme si ji? popsali. 
-Zbytek u? je p??mo?ar?. Pokud zad?te dva nebo v?ce taxon?, nap??klad Pampeli?ku a He?m?nek, tak se vyhled?vaj? n?lezy
+<h2>3. Logika vyhled?v?n?</h2>
+<p>Zad?te-li dva nebo v?ce taxon?, nap??klad Pampeli?ku a He?m?nek, tak se vyhled?vaj? n?lezy
 zadan?ch taxon? spojen?ch spojkou NEBO, tedy v na?em p??kladu  se hledaj? n?lezy bu? Pampeli?ek 
 nebo He?m?nk?.</p>
-<p>Ostatn? vypln?n? polo?ky se do dotazu p?id?vaj? logickou spojkou A Z?rove?. Nap??klad tedy po zad?n?
-He?m?nku a Pampeli?ky jako taxon? a po vybr?n? Bohemia centralis se po stisku Ok v P?ehledu zobraz? n?lezy He?m?nk? v 
-teritoriu Bohemia centralis a n?lezy Pampeli?ek v teritoriu Bohemia centralis.</p>
-<p>Za zm?nku je?t? stoj? vyhled?v?n? v pozn?mk?ch. Nehled? se p?esn? shoda se 
+<p>Ostatn? vypln?n? polo?ky se do dotazu p?id?vaj? logickou spojkou a z?rove?. Nap??klad tedy po zad?n?
+He?m?nku a Pampeli?ky jako taxon? a po vybr?n? Bohemia centralis se po stisku Ok v P?ehledu zobraz? n?lezy He?m?nk? na 
+?zem? Bohemia centralis a n?lezy Pampeli?ek na ?zem? Bohemia centralis.</p>
+<p>Za zm?nku stoj? vyhled?v?n? v pozn?mk?ch. Nehled? se p?esn? shoda se 
 zadan?m textem, ale hled? se zadan? text jako pod?et?zec pozn?mky nebo popisu 
 m?sta. Zad?te-li tedy do popisu m?sta slovo louka a stisknete Ok, zobraz? se v
  p?ehledu v?echny n?lezy, kter? v popisu m?sta n?lezu obsahuj? ?et?zec "louka".
- Stejn? je tomu u hled?n? v pozn?mce k n?lezu a v pozn?mce k m?stu.</p>
- 
- <h2>Strom lokalit</h2>
- <p>Strom lokalit slou?? k rychl?mu hled?n? v n?lezech podle geografick?ho ?len?n?. Je mo?n? ho vyvolat z panelu n?stroj?
- v hlavn?m okn? aplikace.</p>
- 
- <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
- 
- <p>Prvn? vrstva stromu obsahuje teritoria, ka?d? uzel teritoria pak obsahuje fytochoriony a kone?n? uzel ka?d?ho
- fytochorionu obsahuje seznam lokalit. Strom obsahuje pouze ty fytochoriony a teritoria, kter? u? n?jak? n?lez obsahuj?.
-  Fytochoriony neobsahuj?c? ??dn? n?lez zobrazeny nejsou. Stejn? tak teritoria, kter? neobsahuj? alespo? jeden fytochorion
-  obsahuj?c? n?lez nejsou zobrazena.</p>
-  
-  <p>Zobrazit n?lezy v dan? lokalit? lze bu? dvojklikem na uzel lokality anebo je mo?n? jednoduch?m kliknut?m uzel ozna?it
-   a pak bu? kliknout na lev? doln? tla??tko hledat anebo prav?m kliknut?m my?i vyvolat kontextov? menu a v n?m kliknout
-   na "Hledat".</p>
-   
-   <p>Informace ve stromu se automaticky neaktualizuj? spolu s editac? datab?ze, aby se p?ede?lo neo?ek?van?mu zpomalen? 
-   aplikace p?i pomal?m p?ipojen? k serveru Plantlore p?i komunikaci p?es s??. Seznam lokalit ve fytochorionu lze 
-   jednodu?e zav?en?m a op?tovn?m rozbalen?m uzlu dan?ho fytochorionu. Pro nov? na?ten? cel? struktury stromu slou?? prav?
-   doln? tla??tko Obnovit. Funkci Obnovit lze vyvolat i z kontextov?ho menu.
-   </p>  
+ Stejn? je tomu u hled?n? v pozn?mce k n?lezu a v pozn?mce k m?stu. V obou p??padech nez?le?? na velikosti p?smen - najdou 
+ se i n?lezy obsahuj?c? nap??klad slova "Louka" nebo "lOuKA".</p>
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/settings.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/settings.html	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/html/settings.html	2006-09-07 00:50:55 UTC (rev 732)
@@ -12,23 +12,18 @@
 
 <p>Dialog Nastaven? obsahuje ?ty?i z?lo?ky. Z toho pouze nastaven? jazyku se projev? a? po restartu
 aplikace. Ostatn? zm?ny se projev? hned po potvrzen? kliknut?m na Ok.</p>
-
+<br>
 <img src="picture/settings_languages_cz.png" alt="V?b?r jazyku aplikace">
-
+<br>
 <p>V z?lo?ce Sloupky je mo?n? si vybrat sloupky a po?ad?, ve kter?m se maj? zobrazovat v p?ehledu n?lez?. 
 Nastaven? se projev? ihned po potvrzen? kliknt?m na Ok.</p>
 
 <img src="picture/settings_columns_cz.png">
 
-<p>Plantlore dovoluje jednouduchou ?pravu nadpis?, kter? se generuj? ve sched?. Slou?? k tomu
+<p>Plantlore dovoluje jednoduchou ?pravu nadpis?, kter? se generuj? ve sched?. Slou?? k tomu
 z?lo?ka Scheda.</p>
 
 <img src="picture/settings_scheda_cz.png">
 
-<p>Posledn? z?lo?ka, Obecn?, umo??uje zapnut? a vypnut? automatick?ho nastavov?n? velikosti
-str?nky v p?ehledu n?lez?. Automatick? nastavov?n? doporu?ujeme pou??vat pouze p?i pr?ci po
-lok?ln? s?ti. P?i pomalej??m p?ipojen? by tato funkce mohla zdr?ovat.</p>
-
-<img src="picture/settings_general_cz.png">  
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/jhelpmap.jhm	2006-09-07 00:50:55 UTC (rev 732)
@@ -10,9 +10,8 @@
     <mapID target="settings" url="html/settings.html"/>
     <mapID target="overview" url="html/overview.html"/>
     <mapID target="overview.addoccurrence" url="html/addoccurrence.html"/>
-    <mapID target="overview.addoccurrence.basic" url="html/addoccurrence.html#basic"/>
-    <mapID target="overview.addoccurrence.extended" url="html/addoccurrence.html#extended"/>
-    <mapID target="overview.addoccurrence.checklist" url="html/addoccurrence.html#checklist"/>
+    <mapID target="overview.addoccurrence.checklist" url="html/checklist.html"/>
+    <mapID target="overview.habitattree" url="html/habitattree.html"/>
     <mapID target="overview.search" url="html/search.html"/>
     <mapID target="overview.history" url="html/history.html#historyRecord"/>
     <mapID target="author" url="html/author.html"/>

Modified: trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml	2006-09-06 23:43:14 UTC (rev 731)
+++ trunk/src/net/sf/plantlore/help/cs/jhelptoc.xml	2006-09-07 00:50:55 UTC (rev 732)
@@ -13,10 +13,9 @@
     <tocitem target="settings" text="Nastaven?"/>
     <tocitem target="overview" text="P?ehled n?lez?">
         <tocitem target="overview.addoccurrence" text="P?idej/Edituj n?lez">        
-            <tocitem target="overview.addoccurrence.basic" text="Z?kladn? data"/>
-            <tocitem target="overview.addoccurrence.extended" text="Roz???en? data"/>            
             <tocitem target="overview.addoccurrence.checklist" text="?krt?k"/>                        
         </tocitem>
+        <tocitem target="overview.habitattree" text="Strom lokalit"/>
         <tocitem target="overview.search" text="Vyhled?v?n?"/>
         <tocitem target="overview.history" text="Historie ?prav n?lez?"/>        
     </tocitem>



From lada at mail.berlios.de  Thu Sep  7 03:51:04 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 03:51:04 +0200
Subject: [Plantlore-dev] r733 - trunk/documentation
Message-ID: <200609070151.k871p4Qj025419@sheep.berlios.de>

Author: lada
Date: 2006-09-07 03:51:02 +0200 (Thu, 07 Sep 2006)
New Revision: 733

Added:
   trunk/documentation/DBmodel ENG.odt
Log:
Add description of database model in eng.

Added: trunk/documentation/DBmodel ENG.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/DBmodel ENG.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 03:54:06 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 03:54:06 +0200
Subject: [Plantlore-dev] r734 - trunk/documentation
Message-ID: <200609070154.k871s66B025682@sheep.berlios.de>

Author: krater
Date: 2006-09-07 03:54:06 +0200 (Thu, 07 Sep 2006)
New Revision: 734

Added:
   trunk/documentation/CommunicationLayerAndServer.odt
Log:
Communication LAyer

Added: trunk/documentation/CommunicationLayerAndServer.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/CommunicationLayerAndServer.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Thu Sep  7 04:26:07 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 04:26:07 +0200
Subject: [Plantlore-dev] r735 - trunk/documentation
Message-ID: <200609070226.k872Q7DJ028447@sheep.berlios.de>

Author: lada
Date: 2006-09-07 04:26:03 +0200 (Thu, 07 Sep 2006)
New Revision: 735

Added:
   trunk/documentation/BioCASE.odt
Log:
Add bioCase doc - installation, configuration, mapping.

Added: trunk/documentation/BioCASE.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/BioCASE.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 05:17:22 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 05:17:22 +0200
Subject: [Plantlore-dev] r736 - trunk/documentation
Message-ID: <200609070317.k873HMDu032698@sheep.berlios.de>

Author: krater
Date: 2006-09-07 05:17:21 +0200 (Thu, 07 Sep 2006)
New Revision: 736

Modified:
   trunk/documentation/CommunicationLayerAndServer.odt
Log:
Communication Layer.

Modified: trunk/documentation/CommunicationLayerAndServer.odt
===================================================================
(Binary files differ)



From fraktalek at mail.berlios.de  Thu Sep  7 05:26:45 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 05:26:45 +0200
Subject: [Plantlore-dev] r737 - trunk/documentation
Message-ID: <200609070326.k873QjKl000627@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 05:26:45 +0200 (Thu, 07 Sep 2006)
New Revision: 737

Added:
   trunk/documentation/TaskAndDispatcher.odt
Log:
Task, Dispatcher, progress monitor documentation.



Added: trunk/documentation/TaskAndDispatcher.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/TaskAndDispatcher.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Thu Sep  7 05:47:01 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 05:47:01 +0200
Subject: [Plantlore-dev] r738 - trunk/documentation
Message-ID: <200609070347.k873l1cN002569@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 05:47:01 +0200 (Thu, 07 Sep 2006)
New Revision: 738

Modified:
   trunk/documentation/TaskAndDispatcher.odt
Log:
Added a sequence diagram.



Modified: trunk/documentation/TaskAndDispatcher.odt
===================================================================
(Binary files differ)



From lada at mail.berlios.de  Thu Sep  7 05:52:22 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 05:52:22 +0200
Subject: [Plantlore-dev] r739 - in trunk/src/net/sf/plantlore:
	client/history client/metadata client/user l10n
Message-ID: <200609070352.k873qM90003035@sheep.berlios.de>

Author: lada
Date: 2006-09-07 05:52:19 +0200 (Thu, 07 Sep 2006)
New Revision: 739

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
   trunk/src/net/sf/plantlore/client/user/UserManager.java
   trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
L10n

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-07 03:52:19 UTC (rev 739)
@@ -139,22 +139,15 @@
     public static final int HISTORY_RECORD = 1;
     public static final int HISTORY_WHOLE = 2;
     
-    /** Constants used for description of errors */
-    public static final String ERROR_SEARCH_RECORD = "Error.HistoryRecordSearchFailed";
-    public static final String ERROR_SEARCH_DATA = "Error.HistoryDataSearchFailed";
+    /** Constants used for description of errors */    
     public static final String ERROR_SEARCH_OBJECT = "Error.HistoryObjectSearchFailed";
     public static final String ERROR_SEARCH_AUTHOR = "Error.HistoryAuthorSearchFailed";
-    public static final String ERROR_PROCESS = "Error.HistoryProcessResultsFailed";
-    public static final String ERROR_UPDATE = "Error.HistoryUpdateResultsFailed";
-    public static final String ERROR_DELETE = "Error.HistoryDeleteResultsFailed";  
-    public static final String ERROR_CLEAR_DATABASE = "Error.HistoryClearDatabase";
-    public static final String ERROR_CLEAR_HISTORY = "Error.HistoryClearHistory";
-    public static final String ERROR_PARSE_DATE = "Error.HistoryParseData";
-    public static final String ERROR_NUMBER_ROWS = "Error.HistoryGetNumberRows";
-    public static final String ERROR_NO_RIGHTS = "Error.HistoryNoRights"; 
-    public static final String ERROR_TRANSACTION = "Error.TransactionRaceConditions";    
-    public static final String ERROR_REMOTE_EXCEPTION = "REMOTE_EXCEPTION";
+    public static final String ERROR_PROCESS = "Error.HistoryProcessResultsFailed"; 
+    public static final String ERROR_PARSE_DATE = "Error.HistoryParseData"; // 
+    public static final String ERROR_NO_RIGHTS = "Error.HistoryNoRights"; //
+    public static final String ERROR_TRANSACTION = "Error.TransactionRaceConditions";    //
     
+    
     /**
      * Creates a new instance of History - history of Occurrences, Habitats, Authors, 
      * Publications, Metadata, Territories, Phytochorions, Villages
@@ -254,7 +247,7 @@
         
         if (object == null) {
      	   logger.error("tOccurrence doesn't contain required data");  
-     	   throw  new DBLayerException(ERROR_SEARCH_RECORD + "tOccurrence doesn't contain required data");                           	   		            
+     	   throw  new DBLayerException(ERROR_SEARCH_OBJECT + "tOccurrence doesn't contain required data");                           	   		            
         } else {
      	   
      	   Occurrence occurrence = (Occurrence)object[0];    	   

Modified: trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/client/metadata/MetadataManager.java	2006-09-07 03:52:19 UTC (rev 739)
@@ -95,17 +95,11 @@
     public static final String ERROR_UNKNOWEN = L10n.getString("Error.UnknownException");
     public static final String ERROR_TITLE = L10n.getString("Error.MetadataMessageTitle");
     public static final String ERROR_CHECK_DELETE = L10n.getString("Error.MetadataCheckDelete");
-    public static final String ERROR_DATASETTITLE = L10n.getString("Error.MetadataUniqueDatasetTitle"); 
-    public static final String ERROR_REMOTE_EXCEPTION = "REMOTE_EXCEPTION";
+    public static final String ERROR_DATASETTITLE = L10n.getString("Error.MetadataUniqueDatasetTitle");     
     
     public static final String QUESTION_DELETE_TITLE = L10n.getString("Question.DeleteMetadataTitle");
     public static final String QUESTION_DELETE = L10n.getString("Question.DeleteMetadata");
     
-    public static final String PROGRESS_SEARCH = L10n.getString("Metadata.Search.ProgressTitle");
-    public static final String PROGRESS_ADD = L10n.getString("Metadata.Add.ProgressTitle");
-    public static final String PROGRESS_EDIT = L10n.getString("Metadata.Edit.ProgressTitle");
-    public static final String PROGRESS_DELETE = L10n.getString("Metadata.Delete.ProgressTitle");
-    
     public static final String WARNING_SELECTION_TITLE = L10n.getString("Warning.EmptySelectionTitle");
     public static final String WARNING_SELECTION = L10n.getString("Warning.EmptySelection");
     

Modified: trunk/src/net/sf/plantlore/client/user/UserManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/client/user/UserManager.java	2006-09-07 03:52:19 UTC (rev 739)
@@ -123,20 +123,12 @@
     public static final String ERROR_TITLE = L10n.getString("Error.MessageTitle");
     public static final String ERROR_TRANSACTION = L10n.getString("Error.TransactionRaceConditions");
     public static final String ERROR_CREATE_PAIRS = L10n.getString("Error.UserManagerCreatePairs"); 
-    public static final String ERROR_LOGIN = L10n.getString("Error.UserManagerDuplicityLogin");
-    public static final String ERROR_REMOTE_EXCEPTION = "REMOTE_EXCEPTION";
+    public static final String ERROR_LOGIN = L10n.getString("Error.UserManagerDuplicityLogin");   
     public static final String ERROR_CHAR_LOGIN = L10n.getString("Error.UserManagerIncorrectlyLogin");
     
     public static final String QUESTION_DELETE_TITLE = L10n.getString("Question.DeleteUserTitle");
     public static final String QUESTION_DELETE = L10n.getString("Question.DeleteUser");
-    public static final String QUESTION_DROP = L10n.getString("Question.DropUser");
-    public static final String QUESTION_DROP_TITLE = L10n.getString("Question.DropUserTitle");
-    
-    public static final String PROGRESS_SEARCH = L10n.getString("User.Search.ProgressTitle");
-    public static final String PROGRESS_ADD = L10n.getString("User.Add.ProgressTitle");
-    public static final String PROGRESS_EDIT = L10n.getString("User.Edit.ProgressTitle");
-    public static final String PROGRESS_DELETE = L10n.getString("User.Delete.ProgressTitle");
-    
+   
     public static final String WARNING_SELECTION_TITLE = L10n.getString("Warning.EmptySelectionTitle");
     public static final String WARNING_SELECTION = L10n.getString("Warning.EmptySelection");
     
@@ -149,6 +141,8 @@
     public static final String INFORMATION_DELETE_HIMSELF = L10n.getString("Information.UserDeleteHimself");    
     public static final String INFORMATION_EDIT_TITLE = L10n.getString("Information.UserCannotEditTitle");
     public static final String INFORMATION_EDIT = L10n.getString("Information.UserCannotEdit");    
+    public static final String INFORMATION_REVOKE_TITLE = L10n.getString("Information.UserRevokeAdmin");    
+    public static final String INFORMATION_REVOKE_HIMSELF = L10n.getString("Information.UserRevokeAdminHimself");    
    
     /**
      * Creates a new instance of UserManager
@@ -552,6 +546,22 @@
         return false;
     }
     
+    /**
+     * Check if administrator can revoke own right
+     * @return true if admin can revoke own right
+     */
+    public boolean revokeAdminHimself() {
+        try {            
+            if ((database.getUser().getLogin()).equals(userRecord.getLogin())) {
+                if (userRecord.getRight().getAdministrator() == 0)
+                return true;
+            }
+        } catch (Exception e) {
+           // Never mind.           
+        }
+        return false;
+    }
+    
     //****************************//
     //****Get and set metods*****//
     //**************************//

Modified: trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/client/user/UserManagerCtrl.java	2006-09-07 03:52:19 UTC (rev 739)
@@ -310,12 +310,12 @@
                model.setOperation(UserManager.EDIT);
                //Set information about selected row
                int resultNumber = view.tableUserList.getSelectedRow() + model.getCurrentFirstRow()-1;  
-               model.setUserRecord(resultNumber);    
-           if (model.getUserRecord().getDropWhen() != null)    {
-               //Display information message - user cannot be edited. User was droped
-               view.showInfoMessage(UserManager.INFORMATION_EDIT_TITLE, UserManager.INFORMATION_EDIT);
-               return;
-           }
+               model.setUserRecord(resultNumber);                   
+               if (model.getUserRecord().getDropWhen() != null)    {
+                   //Display information message - user cannot be edited. User was droped
+                   view.showInfoMessage(UserManager.INFORMATION_EDIT_TITLE, UserManager.INFORMATION_EDIT);
+                   return;
+               }               
                if (editView == null) {
             	   	editView = new AddEditUserView(model,view,true);
         	   	new AddEditUserCtrl(editView, model);
@@ -327,6 +327,11 @@
                // User press button close
                if (model.usedClose()) return;
                model.setUsedClose(true);
+               //Test if user can delete administrator right to himself 
+               if (model.revokeAdminHimself()) {
+                   view.showInfoMessage(UserManager.INFORMATION_REVOKE_TITLE, UserManager.INFORMATION_REVOKE_HIMSELF);
+            	   return;
+               }
                //Update User               
                Task task = model.editUserRecord();
                task.setPostTaskAction(new PostTaskAction() {

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 03:52:19 UTC (rev 739)
@@ -1650,7 +1650,7 @@
 
 Error.HistoryDataSearchFailed=
 
-Error.HistoryObjectSearchFailed=
+Error.HistoryObjectSearchFailed=Search data failed
 
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
@@ -1733,3 +1733,55 @@
 Overview.Scheda.Generating=Creating schedas...
 
 Common.Done=Done
+
+Error.HistoryNoRights=You don't have sufficient rights to access to history
+
+Error.HistoryParseData=Parse date failed
+
+Error.HistoryProcessResultsFailed=Processing search results failed
+
+Error.HistoryAuthorSearchFailed=Search authors of occurrence failed
+
+Information.UserRevokeAdminHimself=You cannot revoke own admin right
+
+Information.UserRevokeAdmin=Revoke own right
+
+Error.MessageTitle=Error
+
+Error.UserManagerDuplicityLogin=Duplicit login. You have to change value of  login.
+
+Error.UserManagerIncorrectlyLogin=Login containing allowable char
+
+Error.UserDeleteFailed=Drop user failed
+
+Error.UserEditFailed=Edit user failed
+
+Error.UserAddFailed=Add user failed
+
+Error.UserSearchFailed=Search user failed
+
+Error.UserProcessResultsFailed=Processing search results failed
+
+Error.MetadataUniqueDatasetTitle=Datasettitle has to be unique
+
+Error.MetadataCheckDelete=Metadata cannot be deleted. There are othre relationShip with occurrence.
+
+Error.MetadataMessageTitle=Error
+
+Error.MetadataDeleteFailed=Delete metadata failed
+
+Error.MetadataEditFailed=Edit metadata failed
+
+Error.MetadataAddFailed=Add metadata failed
+
+Error.MetadataProcessResultsFailed=Processing search results failed
+
+Error.MetadataSearchFailed=Search metadata failed
+
+Error.Transformation.NullValue=You have to fill data before transformation
+
+Error.Transformation.WGS84=Sam value is incorrect
+
+Error.Transformation.SJTSK=Some value is incorrect
+
+Error.Transformation.S42=Some value is incorrect

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 03:52:19 UTC (rev 739)
@@ -1374,7 +1374,7 @@
 
 Question.DeleteUserTitle=Zru\u0161en\u00ED u\u017Eivatele
 
-Question.DeleteUser=Vybran\u00E9mu u\u017Eivatelovi bude zru\u0161en p\u0159\u00EDstup do aplikace Plantlore.
+Question.DeleteUser=Vybran\u00E9mu u\u017Eivateli bude zru\u0161en p\u0159\u00EDstup do aplikace Plantlore.
 
 Question.DeleteMetadata=Vybran\u00E1 metadata budou smaz\u00E1na
 
@@ -1968,7 +1968,7 @@
 
 Error.HistoryDataSearchFailed=
 
-Error.HistoryObjectSearchFailed=
+Error.HistoryObjectSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
 
 Error.BadDatabaseIdentifier=Identifik\u00E1tor DB m\u016F\u017Ee obsahovat jenom p\u00EDsmena a \u010D\u00EDslice. Pros\u00EDm zadejte korektn\u00ED hodnotu t\u00E9to polo\u017Eky
 
@@ -2051,3 +2051,55 @@
 Overview.Scheda.Generating=Vytv\u00E1\u0159\u00EDm schedy...
 
 Common.Done=Hotovo
+
+Error.HistoryNoRights=Nem\u00E1te dostate\u010Dn\u00E1 opr\u00E1vn\u011Bn\u00ED pro p\u0159\u00EDstup k historii\n
+
+Error.HistoryParseData=Parsov\u00E1n\u00ED zadan\u00E9ho datumu se nepoda\u0159ilo
+
+Error.HistoryProcessResultsFailed=Processing search results failed
+
+Error.HistoryAuthorSearchFailed=Hled\u00E1n\u00ED autor\u016F pro specifikovan\u00FD n\u00E1lez se nezda\u0159ilo
+
+Information.UserRevokeAdminHimself=Sna\u017E\u00EDte si zru\u0161it administr\u00E1torsk\u00E9 pr\u00E1vo.\nTato operace nen\u00ED povolena.
+
+Information.UserRevokeAdmin=Revoke own right
+
+Error.MessageTitle=Error
+
+Error.UserManagerDuplicityLogin=Tento login ji\u017E existuje.\nProsim zvolte jin\u00FD login.
+
+Error.UserManagerIncorrectlyLogin=Login obsahuje nepovolen\u00FD znak.\n Pros\u00EDm zvolte jin\u00FD login.
+
+Error.UserDeleteFailed=Nepoda\u0159ilo se zru\u0161it u\u017Eivatele
+
+Error.UserEditFailed=Nepoda\u0159ilo se zaeditovat u\u017Eivatele
+
+Error.UserAddFailed=Nepoda\u0159ilo se p\u0159idat u\u017Eivatele
+
+Error.UserSearchFailed=Nepoda\u0159ilo se dohledat u\u017Eivatele
+
+Error.UserProcessResultsFailed=Processing search results failed
+
+Error.MetadataUniqueDatasetTitle=N\u00E1zev projektu mus\u00ED b\u00FDt v r\u00E1mci datab\u00E1ze unik\u00E1tn\u00ED
+
+Error.MetadataCheckDelete=Metadata nemohou b\u00FDt smaz\u00E1ny.\nExistuje n\u00E1lez, kter\u00FD na n\u011B odkazuje.
+
+Error.MetadataMessageTitle=Error
+
+Error.MetadataDeleteFailed=Nepoda\u0159ilo se smazat metadata
+
+Error.MetadataEditFailed=Nepoda\u0159ilo se editovat metadata
+
+Error.MetadataAddFailed=Nepoda\u0159ilo se vlo\u017Eit metadata
+
+Error.MetadataProcessResultsFailed=Processing search results failed
+
+Error.MetadataSearchFailed=Nepod\u0159ilo se dohledat metadata
+
+Error.Transformation.NullValue=Nejsou zad\u00E1na v\u0161echny pot\u0159ebn\u00E9 hodnoty pro transformaci.
+#N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
+Error.Transformation.WGS84=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
+
+Error.Transformation.SJTSK=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
+
+Error.Transformation.S42=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 03:47:01 UTC (rev 738)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 03:52:19 UTC (rev 739)
@@ -1497,7 +1497,7 @@
 
 Error.HistoryDataSearchFailed=
 
-Error.HistoryObjectSearchFailed=
+Error.HistoryObjectSearchFailed=Search data failed
 
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
@@ -1580,3 +1580,59 @@
 Overview.Scheda.Generating=Creating schedas...
 
 Common.Done=Done
+
+Error.HistoryNoRights=You don't have sufficient rights to access to history
+
+Error.HistoryParseData=Parse date failed
+
+Error.HistoryProcessResultsFailed=Processing search results failed
+
+Error.HistoryAuthorSearchFailed=Search authors of occurrence failed
+
+Information.UserRevokeAdminHimself=You cannot revoke own admin right
+
+Information.UserRevokeAdmin=Revoke own right
+
+Error.MessageTitle=Error
+
+Error.UserManagerDuplicityLogin=Duplicit login. You have to change value of  login.
+
+Error.UserManagerIncorrectlyLogin=Login containing allowable char
+
+Error.UserDeleteFailed=Drop user failed
+
+Error.UserEditFailed=Edit user failed
+
+Error.UserAddFailed=Add user failed
+
+Error.UserSearchFailed=Search user failed
+
+Error.UserProcessResultsFailed=Processing search results failed
+
+Question.DeleteMetadata=Selected metadata will be delete.
+
+Question.DeleteMetadataTitle=Delete metadata
+
+Error.MetadataUniqueDatasetTitle=Datasettitle has to be unique
+
+Error.MetadataCheckDelete=Metadata cannot be deleted. There are othre relationShip with occurrence.
+
+Error.MetadataMessageTitle=Error
+
+Error.MetadataDeleteFailed=Delete metadata failed
+
+Error.MetadataEditFailed=Edit metadata failed
+
+Error.MetadataAddFailed=Add metadata failed
+
+Error.MetadataProcessResultsFailed=Processing search results failed
+
+Error.MetadataSearchFailed=Search metadata failed
+
+Error.Transformation.NullValue=You have to fill data before transformation
+
+Error.Transformation.WGS84=Sam value is incorrect.
+
+Error.Transformation.SJTSK=Some value is incorrect
+
+Error.Transformation.S42=Some value is incorrect



From kovo at mail.berlios.de  Thu Sep  7 06:04:35 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 06:04:35 +0200
Subject: [Plantlore-dev] r740 - trunk/documentation
Message-ID: <200609070404.k8744Zrr004219@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 06:04:34 +0200 (Thu, 07 Sep 2006)
New Revision: 740

Modified:
   trunk/documentation/DBLayer.odt
Log:
DBLayer documentation

Modified: trunk/documentation/DBLayer.odt
===================================================================
(Binary files differ)



From fraktalek at mail.berlios.de  Thu Sep  7 06:43:45 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 06:43:45 +0200
Subject: [Plantlore-dev] r741 - trunk/documentation
Message-ID: <200609070443.k874hjeh007664@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 06:43:44 +0200 (Thu, 07 Sep 2006)
New Revision: 741

Added:
   trunk/documentation/Settings.odt
Log:
Settings documentation.



Added: trunk/documentation/Settings.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/Settings.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 07:17:48 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 07:17:48 +0200
Subject: [Plantlore-dev] r742 - trunk/documentation
Message-ID: <200609070517.k875HmL6010140@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 07:17:48 +0200 (Thu, 07 Sep 2006)
New Revision: 742

Added:
   trunk/documentation/Installation.odt
Log:
Installation manual in english added. The document is NOT formatted and needs review. Also it should be merged with document on how to install BioCASE

Added: trunk/documentation/Installation.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/Installation.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 07:18:34 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 07:18:34 +0200
Subject: [Plantlore-dev] r743 - trunk/documentation
Message-ID: <200609070518.k875IY8Y010170@sheep.berlios.de>

Author: krater
Date: 2006-09-07 07:18:34 +0200 (Thu, 07 Sep 2006)
New Revision: 743

Added:
   trunk/documentation/Export.odt
Log:
Export

Added: trunk/documentation/Export.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/Export.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Thu Sep  7 07:49:13 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 07:49:13 +0200
Subject: [Plantlore-dev] r744 - trunk/documentation
Message-ID: <200609070549.k875nDom013039@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 07:49:12 +0200 (Thu, 07 Sep 2006)
New Revision: 744

Added:
   trunk/documentation/PrintingAndScheda.odt
Log:
Printing and scheda doc.		



Added: trunk/documentation/PrintingAndScheda.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/PrintingAndScheda.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From tkovarik at gmail.com  Thu Sep  7 07:53:58 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 7 Sep 2006 07:53:58 +0200
Subject: [Plantlore-dev] T - 8 (ZULU BRAVO TANGA CHARLIE ;)
Message-ID: <ea88f1620609062253g2638cdd7s7ed7ef93659b64f7@mail.gmail.com>

Zoznam veci co spravit:

Uzivatelska dokumentacia
- Napisat uvod o plantlore, preco naco, zaco. Moze obsahovat info o inych
systemoch, vztahu k taxonomickym databazam, standardoch, botanikoch co to
pouzivaju, ako to pouzivaju atp. [LADA]
- Prelozit zvysne neprelozene casti [KUBO ak sa objavi]

Programatorska dokumentacia
- Dopisat: Import, mozno nieco dalsie [ERIK]
- Dopisat: Add/Edit, Overview, Search; MVC a celkove spojenie jednotlivych
casti [JAKUB]
- Dopisat: Instalator (mozno preklad), doplnit do MVC info o manageroch
[KOVO]
- Dopisat: ??? [LADA]

Vyvojova dokumentacia
- Spisat osnovu a co bude vediet [KOVO]
- Poslat na upravu, ostatni dopisu [LADA, JAKUB, ERIK]
- Doplnit do toho veci zo spravy [LADA]

Finalizacia dokumentacie
- Programatorska dokumentacia [?ERIK?]
- Uzivatelska dokumentacia [?KOVO?]
- Vyvojova dokumentacia [?LADA?]

Finalizacia programu
- Zabezpecit aby tam bolo vsetko co tam ma byt, testnut [JAKUB]
- Preklikat, Spraviit screenshoty, skontorlovat ocividne chyby GUI [LADA]
- Doplnit Ln a nejake dalsie veci v manageroch [KOVO]

Huh, that's all folks

DEADLINE: 12:00 (o jednej by sme mali vyrazat tlacit nech je rezerva)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060907/ba78d745/attachment.html>

From tkovarik at gmail.com  Thu Sep  7 08:09:37 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 7 Sep 2006 08:09:37 +0200
Subject: [Plantlore-dev] Osnova vyvojovej dokumentacie - Navrh
Message-ID: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>

Prosim doplnit ak vas nieco napadne, idem sa putit do toho co dam, potom
poslem
Je to len tak nahadzane in no particular order zatial

Kovo

Pouzitie RMI

BioCASE ? Pouzitie, vyhody, preco

Architektura klient-server

GUI developement ? Matisse, Swing ? problemy, skusenosti [do not use f-word
too often]

Hibernate ? Pouzitie, preco, vyhody, nevyhody

Databaze ? Skusenosti, preco postgre, preco nie ine, ako sa to vyvijalo

Nejaky uvod podobny uvodu user manualu ? existujuce programy atp.

Rozdelnie uloh

Installer
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060907/2641ab71/attachment.html>

From tkovarik at gmail.com  Thu Sep  7 08:11:50 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 7 Sep 2006 08:11:50 +0200
Subject: [Plantlore-dev] Osnova vyvojovej dokumentacie - Navrh
In-Reply-To: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>
References: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>
Message-ID: <ea88f1620609062311p6846d9fcpae4ba7c2d85f8cc1@mail.gmail.com>

Doplnenie: Pouzite kniznice, aspon zoznam s kratkym popisom ... alebo sa to
zaradi do programatorskej

On 9/7/06, Tomas Kovarik <tkovarik at gmail.com> wrote:
>
> Prosim doplnit ak vas nieco napadne, idem sa putit do toho co dam, potom
> poslem
> Je to len tak nahadzane in no particular order zatial
>
> Kovo
>
> Pouzitie RMI
>
> BioCASE ? Pouzitie, vyhody, preco
>
> Architektura klient-server
>
> GUI developement ? Matisse, Swing ? problemy, skusenosti [do not use
> f-word too often]
>
> Hibernate ? Pouzitie, preco, vyhody, nevyhody
>
> Databaze ? Skusenosti, preco postgre, preco nie ine, ako sa to vyvijalo
>
> Nejaky uvod podobny uvodu user manualu ? existujuce programy atp.
>
> Rozdelnie uloh
>
> Installer
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060907/cc16a7c0/attachment.html>

From fraktalek at gmx.net  Thu Sep  7 08:18:59 2006
From: fraktalek at gmx.net (fraktalek)
Date: Thu, 07 Sep 2006 08:18:59 +0200
Subject: [Plantlore-dev] Osnova vyvojovej dokumentacie - Navrh
In-Reply-To: <ea88f1620609062311p6846d9fcpae4ba7c2d85f8cc1@mail.gmail.com>
References: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>
	<ea88f1620609062311p6846d9fcpae4ba7c2d85f8cc1@mail.gmail.com>
Message-ID: <1157609939.2657.12.camel@kryton>

Musi to taky (asi nejlip na zacatku) obsahovat seznam veci, na kterych
kdo z nas pracoval. Myslim, ze se to tyka nejen programovani a psani
dokumentace, ale celkove prace na projektu - zjistovani infa, sprava
nastroju, cokoliv.

Tomas Kovarik p??e v ?t 07. 09. 2006 v 08:11 +0200:
> Doplnenie: Pouzite kniznice, aspon zoznam s kratkym popisom ... alebo
> sa to zaradi do programatorskej
> 
> On 9/7/06, Tomas Kovarik <tkovarik at gmail.com> wrote:
>         Prosim doplnit ak vas nieco napadne, idem sa putit do toho co
>         dam, potom poslem 
>         Je to len tak nahadzane in no particular order zatial
>         
>         Kovo
>         
>         
>         
>         Pouzitie RMI
>         
>         BioCASE ? Pouzitie, vyhody, preco
>         
>         Architektura klient-server
>         
>         GUI developement ? Matisse, Swing ? problemy, skusenosti [do
>         not use f-word too often]
>         
>         Hibernate ? Pouzitie, preco, vyhody, nevyhody
>         
>         Databaze ? Skusenosti, preco postgre, preco nie ine, ako sa to
>         vyvijalo
>         
>         Nejaky uvod podobny uvodu user manualu ? existujuce programy
>         atp.
>         
>         Rozdelnie uloh
>         
>         Installer
>         
>         
>         
> 
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev



From fraktalek at gmx.net  Thu Sep  7 08:23:01 2006
From: fraktalek at gmx.net (fraktalek)
Date: Thu, 07 Sep 2006 08:23:01 +0200
Subject: [Plantlore-dev] T - 8 (ZULU BRAVO TANGA CHARLIE ;)
In-Reply-To: <ea88f1620609062253g2638cdd7s7ed7ef93659b64f7@mail.gmail.com>
References: <ea88f1620609062253g2638cdd7s7ed7ef93659b64f7@mail.gmail.com>
Message-ID: <1157610182.2657.17.camel@kryton>

Asi pro Ladu, jestli teda bude psat uvod o plantlore:

rikal nam o tom oponent, ze by v tom uziv. manualu rad videl napsany, co
plantlore umi (je to chytrejsi kartoteka, urcite by se hodilo tam
napsat, ze se predpoklada centralni autorita, ktera praci se systemem
bude koordinovat, .... proste zpusob pouziti), co to naopak neumi (neni
to nastroj na analyzu dat, neumi generovat statistiky, nepracuje s
mapami, neni to herbar - neukladaji se obrazky, ... ).

Plus by to melo obsahovat "Jemny uvod do Plantlore", takovy to Quick
start pro netrpelive. Vysvetlit nazorne prvnich par kroku, ktere typicky
uzivatel bude pri praci s Plantlore delat, proc je dela, atp.



Tomas Kovarik p??e v ?t 07. 09. 2006 v 07:53 +0200:
> Zoznam veci co spravit:
> 
> Uzivatelska dokumentacia
> - Napisat uvod o plantlore, preco naco, zaco. Moze obsahovat info o
> inych systemoch, vztahu k taxonomickym databazam, standardoch,
> botanikoch co to pouzivaju, ako to pouzivaju atp. [LADA] 
> - Prelozit zvysne neprelozene casti [KUBO ak sa objavi]
> 
> Programatorska dokumentacia
> - Dopisat: Import, mozno nieco dalsie [ERIK]
> - Dopisat: Add/Edit, Overview, Search; MVC a celkove spojenie
> jednotlivych casti [JAKUB] 
> - Dopisat: Instalator (mozno preklad), doplnit do MVC info o
> manageroch [KOVO]
> - Dopisat: ??? [LADA]
> 
> Vyvojova dokumentacia
> - Spisat osnovu a co bude vediet [KOVO]
> - Poslat na upravu, ostatni dopisu [LADA, JAKUB, ERIK] 
> - Doplnit do toho veci zo spravy [LADA]
> 
> Finalizacia dokumentacie
> - Programatorska dokumentacia [?ERIK?]
> - Uzivatelska dokumentacia [?KOVO?]
> - Vyvojova dokumentacia [?LADA?]
> 
> Finalizacia programu
> - Zabezpecit aby tam bolo vsetko co tam ma byt, testnut [JAKUB]
> - Preklikat, Spraviit screenshoty, skontorlovat ocividne chyby GUI
> [LADA]
> - Doplnit Ln a nejake dalsie veci v manageroch [KOVO]
> 
> Huh, that's all folks 
> 
> DEADLINE: 12:00 (o jednej by sme mali vyrazat tlacit nech je rezerva)
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev



From fraktalek at gmx.net  Thu Sep  7 08:25:29 2006
From: fraktalek at gmx.net (fraktalek)
Date: Thu, 07 Sep 2006 08:25:29 +0200
Subject: [Plantlore-dev] Osnova vyvojovej dokumentacie - Navrh
In-Reply-To: <1157609939.2657.12.camel@kryton>
References: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>
	<ea88f1620609062311p6846d9fcpae4ba7c2d85f8cc1@mail.gmail.com>
	<1157609939.2657.12.camel@kryton>
Message-ID: <1157610330.2657.21.camel@kryton>

Jeste aby se na to nezapoomnelo - to co mas na konci "Nejaky uvod
podobny uvodu user manualu ? existujuce programy
> >         atp."

by imho melo byt na zacatku a klidne delsi. Napr. jak jsem rikal na
Skype, ze jsme se bavili s botanikem, odbornikem na taxonomii, ze nam
radil to oddeleni datovych modelu a dodrzovani standardu. Ze jsme
zvazovali, jestli se nam to povede udelat kompatibilni treba i s
Berlinskym modelem - modelem taxonomickych dat (nas model je
nalezovy...), ...

fraktalek p??e v ?t 07. 09. 2006 v 08:18 +0200:
> Musi to taky (asi nejlip na zacatku) obsahovat seznam veci, na kterych
> kdo z nas pracoval. Myslim, ze se to tyka nejen programovani a psani
> dokumentace, ale celkove prace na projektu - zjistovani infa, sprava
> nastroju, cokoliv.
> 
> Tomas Kovarik p??e v ?t 07. 09. 2006 v 08:11 +0200:
> > Doplnenie: Pouzite kniznice, aspon zoznam s kratkym popisom ... alebo
> > sa to zaradi do programatorskej
> > 
> > On 9/7/06, Tomas Kovarik <tkovarik at gmail.com> wrote:
> >         Prosim doplnit ak vas nieco napadne, idem sa putit do toho co
> >         dam, potom poslem 
> >         Je to len tak nahadzane in no particular order zatial
> >         
> >         Kovo
> >         
> >         
> >         
> >         Pouzitie RMI
> >         
> >         BioCASE ? Pouzitie, vyhody, preco
> >         
> >         Architektura klient-server
> >         
> >         GUI developement ? Matisse, Swing ? problemy, skusenosti [do
> >         not use f-word too often]
> >         
> >         Hibernate ? Pouzitie, preco, vyhody, nevyhody
> >         
> >         Databaze ? Skusenosti, preco postgre, preco nie ine, ako sa to
> >         vyvijalo
> >         
> >         Nejaky uvod podobny uvodu user manualu ? existujuce programy
> >         atp.
> >         
> >         Rozdelnie uloh
> >         
> >         Installer
> >         
> >         
> >         
> > 
> > _______________________________________________
> > Plantlore-dev mailing list
> > Plantlore-dev at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/plantlore-dev
> 
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev



From fraktalek at mail.berlios.de  Thu Sep  7 08:37:02 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 08:37:02 +0200
Subject: [Plantlore-dev] r745 - trunk/documentation
Message-ID: <200609070637.k876b2kF022459@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 08:37:02 +0200 (Thu, 07 Sep 2006)
New Revision: 745

Added:
   trunk/documentation/AddEditSearch.odt
Log:
A few lines to the AddEdit and Search dialogs.



Added: trunk/documentation/AddEditSearch.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/AddEditSearch.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From tkovarik at gmail.com  Thu Sep  7 08:47:08 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 7 Sep 2006 08:47:08 +0200
Subject: [Plantlore-dev] Osnova vyvojovej dokumentacie - Navrh
In-Reply-To: <1157610330.2657.21.camel@kryton>
References: <ea88f1620609062309o5364ac8du1fc3ee2de6f79ab1@mail.gmail.com>
	<ea88f1620609062311p6846d9fcpae4ba7c2d85f8cc1@mail.gmail.com>
	<1157609939.2657.12.camel@kryton> <1157610330.2657.21.camel@kryton>
Message-ID: <ea88f1620609062347r1696c80fm7f728556bcca2d9c@mail.gmail.com>

dovod oneskorenia projektu - preco sme museli podavat spravu a nestihli to
do roka do dna...

On 9/7/06, fraktalek <fraktalek at gmx.net> wrote:
>
> Jeste aby se na to nezapoomnelo - to co mas na konci "Nejaky uvod
> podobny uvodu user manualu ? existujuce programy
> > >         atp."
>
> by imho melo byt na zacatku a klidne delsi. Napr. jak jsem rikal na
> Skype, ze jsme se bavili s botanikem, odbornikem na taxonomii, ze nam
> radil to oddeleni datovych modelu a dodrzovani standardu. Ze jsme
> zvazovali, jestli se nam to povede udelat kompatibilni treba i s
> Berlinskym modelem - modelem taxonomickych dat (nas model je
> nalezovy...), ...
>
> fraktalek p??e v ?t 07. 09. 2006 v 08:18 +0200:
> > Musi to taky (asi nejlip na zacatku) obsahovat seznam veci, na kterych
> > kdo z nas pracoval. Myslim, ze se to tyka nejen programovani a psani
> > dokumentace, ale celkove prace na projektu - zjistovani infa, sprava
> > nastroju, cokoliv.
> >
> > Tomas Kovarik p??e v ?t 07. 09. 2006 v 08:11 +0200:
> > > Doplnenie: Pouzite kniznice, aspon zoznam s kratkym popisom ... alebo
> > > sa to zaradi do programatorskej
> > >
> > > On 9/7/06, Tomas Kovarik <tkovarik at gmail.com> wrote:
> > >         Prosim doplnit ak vas nieco napadne, idem sa putit do toho co
> > >         dam, potom poslem
> > >         Je to len tak nahadzane in no particular order zatial
> > >
> > >         Kovo
> > >
> > >
> > >
> > >         Pouzitie RMI
> > >
> > >         BioCASE ? Pouzitie, vyhody, preco
> > >
> > >         Architektura klient-server
> > >
> > >         GUI developement ? Matisse, Swing ? problemy, skusenosti [do
> > >         not use f-word too often]
> > >
> > >         Hibernate ? Pouzitie, preco, vyhody, nevyhody
> > >
> > >         Databaze ? Skusenosti, preco postgre, preco nie ine, ako sa to
> > >         vyvijalo
> > >
> > >         Nejaky uvod podobny uvodu user manualu ? existujuce programy
> > >         atp.
> > >
> > >         Rozdelnie uloh
> > >
> > >         Installer
> > >
> > >
> > >
> > >
> > > _______________________________________________
> > > Plantlore-dev mailing list
> > > Plantlore-dev at lists.berlios.de
> > > https://lists.berlios.de/mailman/listinfo/plantlore-dev
> >
> > _______________________________________________
> > Plantlore-dev mailing list
> > Plantlore-dev at lists.berlios.de
> > https://lists.berlios.de/mailman/listinfo/plantlore-dev
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060907/f889959c/attachment.html>

From lada at mail.berlios.de  Thu Sep  7 08:51:05 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 08:51:05 +0200
Subject: [Plantlore-dev] r746 - trunk/documentation
Message-ID: <200609070651.k876p5OR023178@sheep.berlios.de>

Author: lada
Date: 2006-09-07 08:50:49 +0200 (Thu, 07 Sep 2006)
New Revision: 746

Added:
   trunk/documentation/webClient.odt
Log:
Add user doc for web client.

Added: trunk/documentation/webClient.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/webClient.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Thu Sep  7 09:19:32 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 09:19:32 +0200
Subject: [Plantlore-dev] r747 - trunk/documentation
Message-ID: <200609070719.k877JW8a024924@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 09:19:31 +0200 (Thu, 07 Sep 2006)
New Revision: 747

Modified:
   trunk/documentation/AddEditSearch.odt
Log:
Added an activity diagram.



Modified: trunk/documentation/AddEditSearch.odt
===================================================================
(Binary files differ)



From lada at mail.berlios.de  Thu Sep  7 09:19:49 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 09:19:49 +0200
Subject: [Plantlore-dev] r748 - trunk/documentation
Message-ID: <200609070719.k877JnPD024949@sheep.berlios.de>

Author: lada
Date: 2006-09-07 09:19:47 +0200 (Thu, 07 Sep 2006)
New Revision: 748

Modified:
   trunk/documentation/BioCASE.odt
Log:
Update doc about web client - add info about authentification

Modified: trunk/documentation/BioCASE.odt
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Thu Sep  7 09:24:47 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 09:24:47 +0200
Subject: [Plantlore-dev] r749 - trunk/documentation
Message-ID: <200609070724.k877Ol4I025337@sheep.berlios.de>

Author: krater
Date: 2006-09-07 09:24:46 +0200 (Thu, 07 Sep 2006)
New Revision: 749

Added:
   trunk/documentation/OccurrenceImport.odt
Modified:
   trunk/documentation/CommunicationLayerAndServer.odt
   trunk/documentation/Export.odt
Log:
Export, Occurrence Import, Communication

Modified: trunk/documentation/CommunicationLayerAndServer.odt
===================================================================
(Binary files differ)

Modified: trunk/documentation/Export.odt
===================================================================
(Binary files differ)

Added: trunk/documentation/OccurrenceImport.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/OccurrenceImport.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 10:00:55 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:00:55 +0200
Subject: [Plantlore-dev] r750 - trunk/documentation
Message-ID: <200609070800.k8780tHu028880@sheep.berlios.de>

Author: krater
Date: 2006-09-07 10:00:55 +0200 (Thu, 07 Sep 2006)
New Revision: 750

Added:
   trunk/documentation/TableImport.odt
Removed:
   trunk/documentation/Export and Import.odt
   trunk/documentation/Export and Import.pdf
Log:
Table Import.

Deleted: trunk/documentation/Export and Import.odt
===================================================================
(Binary files differ)

Deleted: trunk/documentation/Export and Import.pdf
===================================================================
(Binary files differ)

Added: trunk/documentation/TableImport.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/TableImport.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 10:04:25 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:04:25 +0200
Subject: [Plantlore-dev] r751 - trunk/documentation
Message-ID: <200609070804.k8784Pu2029190@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 10:04:25 +0200 (Thu, 07 Sep 2006)
New Revision: 751

Added:
   trunk/documentation/VyvojovaDokum.odt
Log:
Part of the developement documentation

Added: trunk/documentation/VyvojovaDokum.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/VyvojovaDokum.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 10:14:33 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:14:33 +0200
Subject: [Plantlore-dev] r752 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609070814.k878EXpc029989@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 10:14:32 +0200 (Thu, 07 Sep 2006)
New Revision: 752

Modified:
   trunk/src/net/sf/plantlore/help/en/html/user.html
Log:
Translated user documentation

Modified: trunk/src/net/sf/plantlore/help/en/html/user.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/user.html	2006-09-07 08:04:25 UTC (rev 751)
+++ trunk/src/net/sf/plantlore/help/en/html/user.html	2006-09-07 08:14:32 UTC (rev 752)
@@ -1,10 +1,121 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>User manager</title>
-</head>
-<body>
-<h1>User manager</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>User Management</title>
+  </head>
+  <body>
+  <h1>User Management</h1>
+<img src="picture/userEnter_cs.png">
+<br><br>
+
+Application Plantlore allows access to and work with the occurrence data only to the users with a user account created in the application. This way, the data are better protected from damage and misuse. The administrator knows who has access to the occurrence data and who performed any edits to the data. The user manager allows the administrator to add and edit users, set user rights, and also terminate their access to the application. You can open the user manager from menu
+	<b>Data/User management</b>.
+
+<h5>User manager dialog</h5>
+
+<img src="picture/userDialog_cs.png">
+<br><br>
+The dialog for user account management is divided into two parts:
+<ul>
+  <li><b>User list </b>? displays the list of users based on criteria entered for searching and sorting
+  <li><b>Search </b>? requirements for searching and sorting of users
+</ul>
+
+<h2>User list</h2>
+
+This part displays the list of users found after a successful search. You can set the number of users displayed in the table 
+yourselves by changing the value for <i><b>Lines displayed</b></i> and confirming the new value by the ENTER key. Use <i><b>Previous </b></i>and <i><b>Next </b></i>buttons 
+to switch over to the previous or next list of users. Information about the currently displayed list of users is stated in the 
+part below the table.<br>
+The following buttons enable the work with a record:
+<ul>    
+   <li><i><b>Add user  </i></b> - <a href=#add>adds a user</a></li>
+   <li><i><b>Edit user </i></b> - <a href=#edit>edits a user</a></li>
+   <li><i><b>User detail </i></b> - <a href=#detail>detailed data and user rights</a></li>
+   <li><i><b>Remove user </i></b> - <a href=#drop>abolishes user access</a></li> 
+</ul>   
+  
+<h2>Search</h2>
+
+User manager offers the administrator the option to search using the following four parameters: login, name, e-mail, 
+and address. The results may be sorted by login, first name, surname, and date of creation of the user; all of 
+that either in an ascending or descending sequence. Another search criterion is the requirement to display all users, 
+or only users with valid access to the application (the value of item <i>Date of user removal </i>is empty for these users). 
+If no parameters and limitations are entered, all users will be found. 
+<br><br>
+<b>Note:</b> the search is case sensitive.
+
+<a name="add"></a><h2>Adding a user</h2>
+  
+  <h5>Add user dialog</h5>
+  
+  <img src="picture/userAdd_cs.png">
+  <br><br>
+  Open the Add user dialog from User manager. The window displayed offers the following items:
+  
+  <h4>User data</h4>
+  <ul>
+    <li><b>Login</b> - user login that will be used for access to the application. This item is obligatory and you will not be able to add a user without filling it in. 
+    The login must be unequivocal in the database and it will not be editable after you save the user.</li>
+    <li><b>Password</b> - Plantlore user password. This item is obligatory.</li>
+    <li><b>Name</b> - first name of the user. This item is obligatory.</li>
+    <li><b>Surname</b> - surname of the user. This item is obligatory.</li>
+    <li><b>E-mail</b> - user?s e-mail address. This item is obligatory. </li>
+    <li><b>Address</b> - user?s address. This item is obligatory.</li>    
+    <li><b>Note</b> - administrator?s note about the user.</li>   
+  </ul>
+  <h4>User rights</h4>  
+  <ul>   
+    <li><b>Administrator right</b> ? by selecting it, the user will be granted same rights as the administrator. You should 
+    carefully consider whom to assign administrator rights. <i><b>Recommendation: </b>in order to provide for higher security, 
+    there should only be one user with administrator rights.</i> </li>
+    <li><b>Right to edit all </b>? by selecting it, the user is granted the right to edit all occurrences in the database.</li>
+    <li><b>Right to add records</b> ? by selecting it, the user is granted the right to add new occurrences.</li>
+    <li><b>Right to edit other users? occurrences</b> ? this item contains the list of users whose occurrences the user will be permitted to edit.
+
+</li>    
+ </ul>
+ 
+<a name="edit"></a><h2>Editing a user</h2>
+<h5>Edit user dialog</h5>
+<img src="picture/userEdit_cs.png">
+<br><br>
+  Open the Edit user dialog from User manager. Don?t forget that you must select a user to open this dialog. The layout of the Edit user dialog is almost identical with the Add user dialog. The obligatory items are: password, name, surname, e-mail.<br> 
+  Non-editable items:: 
+  <ul>
+    <li><b>Login</b></li>
+    <li><b>Date of creation: </b>date and time of user creation. Non-editable item. </li>
+    <li><b>Date of removal:</b> date and time of abolishment of user access to the application. Non-editable item.</li>
+  </ul>
+
+<a name="detail"></a><h2>Detailed user data and rights</h2>
+
+  You can open the dialog displaying detailed information about the user and his rights from User manager. You have to select a user in the list of users to be able to open this dialog. The dialog is almost identical with the Edit user dialog. All items are non-editable, their nature is informative.
+  
+<a name="drop"></a><h2>Removing user from the system</h2>
+
+  In order to abolish the user access to the application, use button <b><i>Remove user </i></b>in the User manager. Before pressing this 
+  button, it is necessary to select a user in the list of users. After the button is pressed, the user will be informed about the 
+  operation about to be performed. By confirming the operation, the current time will be stored in the item <i>Date of user removal</i>. 
+  <br><br>
+  <img src="picture/userDrop_cs.png">
+  <br><br>
+  Renewal of access for a user that has been removed means adding a new user. Login of a new user must be unequivocal in the database (i.e. it is not possible to use a login of user who has or had an account in a given database). This way, the database stores the information about the periods during which a user had access to the application.
+<a name="rights"></a><h2>User rights</h2>
+  
+  The administrator sets rights for work with the occurrence data while adding or editing a user.<br> 
+  
+  <h5>Setting the rights</h5>
+  <img src="picture/userRight_cs.png">
+  <br><br>
+ User can have the following rights:  <ul>
+    <li>Right to browse the data ? this right does not have to be set anywhere as it is granted automatically with the creation of access to the application</li>
+    <li>Right to add data ? this right permits the user to add occurrences, authors, and publications. He is also automatically granted the right to edit the records that he added himself and to browse all the occurrences. Moreover, he has the right to display the history of the occurrence that he added himself.</li>
+    <li>Right to edit other users? data ? a user (Joe) may ask the administrator to add a specific user (Frank) to the list of users whose records he may edit (this right to edit implies the right to access the record history). Whether a user is added into this list depends on the administrator and/or mutual agreement of the users.</li>
+    <li>Administrator right ? a user with administrator right has, of course, the largest collection of rights ? he may edit the occurrences, metadata, publications, authors, plants, and users. He has the access to the <a href="./history.html#historyRecord">history of individual occurrences</a>, but also to the  <a href="./history.html#historyData">whole history</a>.
+    </li>
+  </ul>  
+  </body>
+</html>



From krater at mail.berlios.de  Thu Sep  7 10:35:40 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:35:40 +0200
Subject: [Plantlore-dev] r753 - trunk/documentation
Message-ID: <200609070835.k878ZeZZ031350@sheep.berlios.de>

Author: krater
Date: 2006-09-07 10:35:40 +0200 (Thu, 07 Sep 2006)
New Revision: 753

Modified:
   trunk/documentation/VyvojovaDokum.odt
Log:
Vyvoj


Modified: trunk/documentation/VyvojovaDokum.odt
===================================================================
(Binary files differ)



From kovo at mail.berlios.de  Thu Sep  7 10:44:05 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:44:05 +0200
Subject: [Plantlore-dev] r754 - in trunk/src/net/sf/plantlore/help: cs/html
	en/html
Message-ID: <200609070844.k878i5F3031961@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 10:44:03 +0200 (Thu, 07 Sep 2006)
New Revision: 754

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/author.html
   trunk/src/net/sf/plantlore/help/cs/html/createdb.html
   trunk/src/net/sf/plantlore/help/cs/html/publication.html
   trunk/src/net/sf/plantlore/help/en/html/author.html
   trunk/src/net/sf/plantlore/help/en/html/createdb.html
   trunk/src/net/sf/plantlore/help/en/html/licence.html
   trunk/src/net/sf/plantlore/help/en/html/publication.html
Log:
help files updated, some transaltions addded

Modified: trunk/src/net/sf/plantlore/help/cs/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -12,48 +12,56 @@
 
 Dialog pro spr?vu autor? se skl?d? ze dvou z?kladn?ch ??st?:
 <ul>
-<li>Seznam autor? - auto?i, kte?? jsou v?sledkem posledn?ho hled?n?</li>
-<li>Vyhled?v?n? autor?- zde m??ete zadat krit?ria pro vyhled?v?n? auutor?</li>
+<li><i>Seznam autor?</i> - auto?i, kte?? jsou v?sledkem posledn?ho hled?n?</li>
+<li><i>Vyhled?v?n? autor?</i>- zde m??ete zadat krit?ria pro vyhled?v?n? auutor?</li>
 </ul>
 
+<img src="picture/AuthorsMain.png">
+
 <h2>Seznam autor?</h2>
 Po ?sp??n?m vyhled?n? jsou v?sledky zobrazeny v t?to ??sti formul??e. V?sledky jsou zobrazeny po str?nk?ch, proto nejsou bezprost?edn? po vyhled?n? 
-zobrazeni v?ichni auto?i. Pro p?ech?zen? mezi jednotliv?mi str?nkami v?sledk? pou?ijte tla??tek P?edchoz? a N?sleduj?c? kter? najdete pod tabulkou 
+zobrazeni v?ichni auto?i. Pro p?ech?zen? mezi jednotliv?mi str?nkami v?sledk? pou?ijte tla??tek <i>P?edchoz?</i> a <i>N?sleduj?c?</i> kter? najdete pod tabulkou 
 se seznamem autor?. V p??pad?, ?e chcete zobrazit v?ce z?znam? na jedn? str?nce, zadejte po?et zobrazovan?ch z?znam? do pole pod tabulkou se seznamem 
-autor? a stiskn?te kl?vesu enter. Vedle tohoto pole se takt?? nach?z? informace celkov?m po?tu nalezn?ch z?znam? a rozsah kter? je pr?v? zobrazen.
+autor? a stiskn?te kl?vesu <code>enter</code>. Vedle tohoto pole se takt?? nach?z? informace celkov?m po?tu nalezn?ch z?znam? a rozsah kter? je pr?v? zobrazen.
 <p>
-Tato ??st formul??e obsahuje taky tla??tka pro p?id?v?n?, ?pravu a maz?n? autor?. Tla?itka P?idej autora a Uprav autora otev?ou dialogov? okno pro 
-p?id?v?n?/?pravu autor? (viz n??e). Tla??tko Odeber autora sma?e (po potvrzen? u?ivatelem) vybran?ho autora. Pro ?pravu nebo smaz?n? autora mus? b?t 
+Tato ??st formul??e obsahuje taky tla??tka pro p?id?v?n?, ?pravu a maz?n? autor?. Tla?itka <i>P?idej autora</i> a <i>Uprav autora</i> otev?ou dialogov? okno pro 
+p?id?v?n?/?pravu autor? (viz n??e). Tla??tko <i>Odeber autora</i> sma?e (po potvrzen? u?ivatelem) vybran?ho autora. Pro ?pravu nebo smaz?n? autora mus? b?t 
 dan? autor vybran? v tabulce se seznamem autor? (v opa?n?m p??pad? syst?m u?ivatele upozorn? ?e nen? vybran? ??dn? autor). ?pravy a maz?n? autor? 
-podl?h? syst?mu opr?vn?n? v Plantlore. Pro podrobn?j?? informace o syst?mu opr?vn?n? nav?tivte sekci Pr?va.
+podl?h? syst?mu opr?vn?n? v Plantlore. Pro podrobn?j?? informace o syst?mu opr?vn?n? nav?tivte sekci pojedn?vaj?c? o syst?mu opr?vn?n? v Plantlore.
 
 <h2>Vyhled?v?n? autor?</h2>
 Dialog pro spr?vu autor? umo??uje vyhled?v?n? podle 4 parametr?: Jm?no autora, organizace, role a email. V?sledky m??ou b?t uspo??dan? podle jm?na, 
 organizace, role, emailu, telefonn?ho ??sla nebo URL vzestupn? nebo sestupn?. ?et?zec pro vyhled?v?n? nemus? p?esn? odpov?dat polo?ce v datab?zi, 
 nalezeny budou v?echny z?znamy, u kter?ch je zadan? polo?ka pod?et?zcem odpov?daj?ci polo?ky v datab?zi. Po zadan? parametr? pro hled?n? se vyhled?van? 
-spou?t? tla??tkem Vyhledej autory.
+spou?t? tla??tkem <i>Vyhledej autory</i>.
 <p>
 Vyhled?v?n? nerozli?uje mal? a velk? p?smena.
 <p>
-Po otev?en? dialogov?ho okna pro spr?vu autor? se zobraz? v?ichni dostupn? auto?i. Pro pozd?j?? zobrazen? v?ech autor?  stiskn?te tla??tko Vyhledej autory bez vypln?n? vyhled?vac?ch parametr?.
+Po otev?en? dialogov?ho okna pro spr?vu autor? se zobraz? v?ichni dostupn? auto?i. Pro pozd?j?? zobrazen? v?ech autor?  stiskn?te tla??tko <i>Vyhledej autory</i> bez 
+vypln?n? vyhled?vac?ch parametr?.
 
 <h1>P?id?v?n? a editace autor?</h1>
-Dialogov? okno pro p?id?van? nebo editaci autora se otev?r? z hlavn?ho okna spr?vy autor? tla??tkem P?idej autora resp. Uprav autora. Toto okno 
+Dialogov? okno pro p?id?van? nebo editaci autora se otev?r? z hlavn?ho okna spr?vy autor? tla??tkem <i>P?idej autora</i> resp. <i>Uprav autora</i>. Toto okno 
 obsahuje n?sleduj?c? polo?ky:
 <ul>
 <li><b>Jm?no autora</b> - Cel? jm?no autora. Tato polo?ka je povinn? a nem??e z?stat nevypl?en?. Maxim?ln? d?lka t?to polo?ky je 50 znak?.</li>
 <li><b>Organizace</b> - Organizace nebo instituce, do kter? autor pat??. Maxim?ln? d?lka t?to polo?ky je 50 znak?.</li>
 <li><b>Role</b> - Role autora v dan? instituci. Maxim?ln? d?lka t?tom polo?ky je 30 znak?.</li>
-<li><b>Adresa</b> - Adresa autora. Maxim?ln? d?lka t?to polo?ky je ??? znak?.</li>
+<li><b>Adresa</b> - Adresa autora. Maxim?ln? d?lka t?to polo?ky je 255 znak?.</li>
 <li><b>Telefon</b> - Telefonn? ??slo autora. Maxim?ln? d?lka t?to polo?ky je 20 znak?.</li>
 <li><b>Email</b> - Emailov? adresa autora. Maxim?ln? d?lka t?to polo?ky je 100 znak?.</li>
 <li><b>URL</b> - URL adresa (webstr?nka) autora. Maxim?ln? d?lka t?to polo?ky je 255 znak?.</li>
 <li><b>Pozn?mka</b> - Jak?koli dal?? informace o autorovi. Tato polo?ka m??ze b?t dlouh? a? 4096 znak?.</li>
 </ul>
+
+<img src="picture/AuthorsAdd.png">
+<p>
 Pokud p?id?v?te nov?ho autora, vypl?te jednotliv? polo?ky a stiskn?te tla??tko Ulo? autora. Jedin? povinn? polo?ka, kter? nem??e z?stat pr?zdn?, je 
 Jm?no autora.
+</p>
 <p>
-V p??pad?, ?e upravujete u? existuj?c?ho autora, vypln? se parametry vybran?ho autora do formul??e a m??ete je upravit. Pomoc? tla??tka Ulo? autora  
+V p??pad?, ?e upravujete u? existuj?c?ho autora, vypln? se parametry vybran?ho autora do formul??e a m??ete je upravit. Pomoc? tla??tka <i>Ulo? autora</i>
 se zm?ny ulo?? do datab?ze. Jedin? polo?ka, kter? nesm? z?stat pr?zdn? je tak jako u p?id?v?n? Jm?no autora.  
+</p>
 </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/createdb.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/cs/html/createdb.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -7,6 +7,38 @@
   </head>
   <body>
   <h1>Vytv??en? nov? datab?ze</h1>
-  
+  Aby jste mohli po instalaci za?at pracovat s n?lezov?mi z?znamy je pot?eba nejprve vytvo?it datab?zi do kter? se data budou ukl?dat (v p??pad?, ?e
+  se p?ipojujete k lok?ln? datab?zi). V p??pad? p?ipojen? ke vzd?len?mu serveru nen? pot?eba datab?zi vytv??et. Plantlore umo??uje taky pr?ci s v?ce 
+  datab?zemi na jednom serveru proto je nutn? m?t mo?nost vytvo?it novou datab?zi. D?vodem pro v?ce datab?z? m??e b?t nap??klad odd?len? dat r?zn?ch 
+  projekt? ?i instituc?. Po?et datab?z? a jejich vyu?it? je na v?s.
+  <p>
+  Plantlore poskytuje jednoduch? rozhran? pro vytv??en? nov? datab?ze, kter? je p??stupn? z hlavn?ho menu aplikace <b>Data|Vytvo?it novou datab?zi</b>.
+  <p>
+  <img src="picture/CreateDBMain.png" />
+  <p>
+  <b>D?le?it? upozorn?n?: Z bezpe?nostn?ch d?vod? je mo?n? vytv??et novou datab?zi jenom p?es lok?ln? p?ipojen? k datab?zi.</b> Taky se ujist?te, ?e
+     nen? ??dn? jin? program pr?v? nepou??v? datab?zov? syst?m PostgreSQL.
+  <p>
+  V tomto dialogu mus?te zadat z?kladn? informace o datab?zov?m syst?mu ve kter?m chcete datab?zi vytvo?it a o nov? datab?zi.
+  <ul>
+    <li><i>Datab?ze</i> - Typ datab?zov?ho syst?mu. V sou?asn? verzi je podporov?n pouze syst?m PostgreSQL</li>
+    <li><i>Port DB</i> - Port na kter?m datab?zov? syst?m b???. V tomto poli je p?edvypln?n? v?choz? port pro vybran? datab?zov? syst?m</li>
+    <li><i>Alias</i> - Popis nov? datab?ze kter? se pou?ije p?i p?ihla?ov?n? (tato informace se po vytvo?en? datab?ze automaticky p?id? do p?ihla?ovac?ho dialogu kde si vol?te datab?zi ke kter? se chcete p?ipojit)</li>
+    <li><i>Identifik?tor DB</i> - jm?no samotn? datab?ze. Ujist?te se, ?e datab?ze s t?mto jm?nem je?t? neexistuje. V n?zvu datab?ze je mo?n? pou??t pouze alfanumerick? znaky (A-Z, a-z, 0-9)</li>
+  </ul>
+  Po stisku tla??tka Pokra?uj se zobraz? dialog pro zad?n? p?ihla?ovac?ho jm?na a hesla kter? jsou pot?eba pro p?ihl??en? do datab?zov?ho syst?mu. 
+  <p>
+  <img src="picture/CreateDBAuth.png">
+  <p>
+  <b>Vytv??en? nov? datab?ze po instalaci Plantlore</b>
+  <p>
+    V p??pad?, ?e vytv???te datab?zi po nov? instalaci Plantlore, zadejte jm?no a heslo datab?zov?ho u?ivatele kter? jste si zvolili v instal?toru. Plantlore automaticky umo?n? tomuto u?ivateli administr?torsk? p??stup k nov? datab?zi a n?sledn?
+    vytv??en? nov?ch u?ivatel?.
+  </p>
+  <b>Vytv??en? nov? datab?ze v u? funguj?c?m syst?mu</b> 
+  <p>
+    Pokud vytv???te novou datab?zi v syst?mu kde u? existuj? jin? datab?ze mus?te po??d pou??vat p?vodn?ho datab?zov?ho, kter?ho jste pou?ili pro vytvo?en? origin?ln? datab?ze.
+  </p>
+    Po ?sp??n?m vytvo?en? datab?ze se zobraz? spr?va o ?sp??n?m dokon?en? operace a m??ete se p?ihl?sit k nov? vytvo?en? datab?zi.
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -8,25 +8,25 @@
   <body>
   <h1>Spr?va publikac?</h1>
 Spr?va publikac? umo??uje u?ivateli p?id?vat, upravovat a vyhled?vat publikace, ve kter?ch byly n?lezy 
-publikovan?. Dialogov? okno se spr?vou publikac? je mo?n? otev??t pomoc? menu Data|Spr?va publikac?.
+publikovan?. Dialogov? okno se spr?vou publikac? je mo?n? otev??t pomoc? menu <b>Data|Spr?va publikac?</b>.
 <p>
 Dialog pro spr?vu publikac? se skl?d? ze dvou z?kladn?ch ??st?:
 <ul>
 <li><b>Seznam publikac?</b> - publikace, kter? jsou v?sledkem posledn?ho hled?n?</li>
 <li><b>Vyhled?v?n? publikac?</b> - zde m??ete zadat krit?ria pro vyhled?v?n? publikac?</li>
 </ul>
-
+<img src="picture/PublicationsMain.png">
 <h2>Seznam publikac?</h2>
 Po ?sp??n?m vyhled?n? jsou v?sledky zobrazeny v t?to ??sti formul??e. V?sledky jsou zobrazeny po str?nk?ch, 
 proto nejsou bezprost?edn? po vyhled?n? zobrazen? v?echny publikace. Pro p?ech?zen? mezi jednotliv?mi 
-str?nkami v?sledk? pou?ijte tla??tek P?edchoz? a N?sleduj?c? kter? najdete pod tabulkou se seznamem 
+str?nkami v?sledk? pou?ijte tla??tek <i>P?edchoz?</i> a <i>N?sleduj?c?</i> kter? najdete pod tabulkou se seznamem 
 publikac?. V p??pad?, ?e chcete zobrazit v?ce z?znam? na jedn? str?nce, zadejte po?et zobrazovan?ch z?znam? 
-do pole pod tabulkou se seznamem publikac? a stiskn?te kl?vesu enter. Vedle tohoto pole se takt?? nach?z? 
-informace celkov?m po?tu nalezn?ch z?znam? a rozsah kter? je pr?v? zobrazen.
+do pole pod tabulkou se seznamem publikac? a stiskn?te kl?vesu <code>enter</code>. Vedle tohoto pole se takt?? 
+nach?z? informace celkov?m po?tu nalezn?ch z?znam? a rozsah kter? je pr?v? zobrazen.
 <p>
-Tato ??st formul??e obsahuje taky tla??tka pro p?id?v?n?, ?pravu a maz?n? publikac?. Tla?itka P?idej 
-publikaci a Uprav publikaci otev?ou dialogov? okno pro p?id?v?n?/?pravu publikac? (viz n??e). Tla??tko 
-Odeber publikaci sma?e (po potvrzen? u?ivatelem) vybranou publikaci. Pro ?pravu nebo smaz?n? publikace 
+Tato ??st formul??e obsahuje taky tla??tka pro p?id?v?n?, ?pravu a maz?n? publikac?. Tla?itka <i>P?idej 
+publikaci</i> a <i>Uprav publikaci</i> otev?ou dialogov? okno pro p?id?v?n?/?pravu publikac? (viz n??e). Tla??tko 
+<i>Odeber publikaci</i> sma?e (po potvrzen? u?ivatelem) vybranou publikaci. Pro ?pravu nebo smaz?n? publikace 
 mus? b?t dan? publikace vybran? v tabulce se seznamem publikac? (v opa?n?m p??pad? syst?m u?ivatele 
 upozorn? ?e nen? vybran? ??dn? publikace). ?pravy a maz?n? publikac? podl?h? syst?mu opr?vn?n? v Plantlore. 
 Pro podrobn?j?? informace o syst?mu opr?vn?n? nav?tivte sekci Pr?va.
@@ -36,31 +36,36 @@
 podrobn? informace. V?sledky m??ou b?t uspo??dan? podle jm?na kolekce, roku publikace, jm?na ?l?nku, autora 
 ?l?nku, citace a podrobn?ch informac? vzestupn? nebo sestupn?. ?et?zec pro vyhled?v?n? nemus? p?esn? 
 odpov?dat polo?ce v datab?zi, nalezeny budou v?echny z?znamy, u kter?ch je zadan? polo?ka pod?et?zcem 
-odpov?daj?ci polo?ky v datab?zi. Po zadan? parametr? pro hled?n? se vyhled?van? spou?t? tla??tkem Vyhledej 
-publikace.
+odpov?daj?ci polo?ky v datab?zi. Po zadan? parametr? pro hled?n? se vyhled?van? spou?t? tla??tkem <i>Vyhledej 
+publikace</i>.
 <p>
 Vyhled?v?n? nerozli?uje mal? a velk? p?smena.
 <p>
 Po otev?en? dialogov?ho okna pro spr?vu publikac? se zobraz? v?echny dostupn? publikace. Pro pozd?j?? 
-zobrazen? v?ech publikac? stiskn?te tla??tko Vyhledej publikace bez vypln?n? vyhled?vac?ch parametr?.
+zobrazen? v?ech publikac? stiskn?te tla??tko <i>Vyhledej publikace</i> bez vypln?n? vyhled?vac?ch parametr?.
 
 <h1>P?id?v?n? a editace publikac?</h1>
 Dialogov? okno pro p?id?van? nebo editaci publikac? se otev?r? z hlavn?ho okna spr?vy publikac? tla??tkem 
-P?idej publikaci resp. Uprav publikaci. Toto okno obsahuje n?sleduj?c? polo?ky:
+<i>P?idej publikaci</i> resp. <i>Uprav publikaci</i>. Toto okno obsahuje n?sleduj?c? polo?ky:
 <ul>
-<li><b>Jm?no kolekce</b> - Jm?no kolekce do kter? dan? publikace pat??.</li>
+<li><b>Jm?no kolekce</b> - Jm?no kolekce do kter? dan? publikace pat??. Maxim?ln? d?lka t?to polo?ky je 255 znak?.</li>
 <li><b>Rok publikace</b> - Rok, ve kter?m do?lo k publikaci n?lezu.</li>
-<li><b>N?zev ?l?nku</b> - N?zev ?l?nku, ve kter?m byl n?lez publikov?n.</li>
-<li><b>Jm?no autora ?l?nku</b> - Autor ?l?nku ve kter?m byl n?lez publikov?n.</li>
-<li><b>Detail</b> - Detail odkazu na ?l?nek.</li>
-<li><b>Pozn?mka</b> - Jak?koli dal?? informace o publikaci.</li>
+<li><b>N?zev ?l?nku</b> - N?zev ?l?nku, ve kter?m byl n?lez publikov?n. Maxim?ln? d?lka t?to polo?ky je 255 znak?.</li>
+<li><b>Jm?no autora ?l?nku</b> - Autor ?l?nku ve kter?m byl n?lez publikov?n. Maxim?ln? d?lka t?to polo?ky je 255 znak?.</li>
+<li><b>Detail</b> - Detail odkazu na ?l?nek. Maxim?ln? d?lka t?to polo?ky je 100 znak?.</li>
+<li><b>URL</b> - URL odkazuj?c? na publikaci. Maxim?ln? d?lka t?to polo?ky je 100 znak?.</li>
+<li><b>Pozn?mka</b> - Jak?koli dal?? informace o publikaci. Maxim?ln? d?lka t?to polo?ky je 4096 znak?.</li>
 </ul>
+<img src="resources/PublicationsAdd.png">
+<p>
 Pokud p?id?v?te novou publikaci, vypl?te jednotliv? polo?ky a stiskn?te tla??tko Ulo? publikaci. Alespo? 
 jedna z n?sleduj?c?ch polo?ek mus? b?t vypl?ena: Autor ?l?nku, rok publikace, jm?no ?l?nku, jm?no kolekce.
+</p>
 <p>
 V p??pad?, ?e upravujete u? existuj?c? publikaci, vypln? se parametry vybran? publikace do formul??e a 
 m??ete je upravit. Pomoc? tla??tka Ulo? publikaci  se zm?ny ulo?? do datab?ze. Tak jako u p?id?v?n? 
 publikac?, alespo? jedna z t?chto polo?ek mus? b?t vypln?n?: Autor ?l?nku, rok publikace, jm?no ?l?nku, 
 jm?no kolekce
+</p>
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/author.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/en/html/author.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -7,53 +7,60 @@
 <body>
 <h1>Author manager</h1>
 Author manager allows users to add, search, modify and delete authors of the occurrence records.
-It can be invoked by <strong>Data|Author Manager</strong>.
+It can be invoked from menu <strong>Data|Author Manager</strong>.
 <p/>
 The Author Manager window consists of two main parts:
 <ul>
     <li><strong>The list of authors</strong> - where the results of the search are displayed</li>
     <li><strong>The search criteria</strong> - where you can specify search parameters</li>    
 </ul>
+<img src="picture/AuthorsMain.png">
 <h3>The list of authors</h3>
 After a succcessful search results are displayed in the list of authors, although not all of them can
 be seen immediately. Initially, only the first page of the results is displayed. To see the rest
-of the pages use <strong>Next</strong> and <strong>Previous</strong> buttons which can be found 
-directly under the list.
+of the pages use <i>Next</i> and <i>Previous</i> buttons which can be found directly under the list.
+In case you would like to display more authors per page, input the requested number of authors to the 
+field below the list of authors.
 <p/>
-This part also includes buttons for adding, editing and deleting authors. The <strong>Add</strong> and
-<strong>Edit</strong> buttons open the Add/Edit Author Dialog (see below), the <strong>Delete</strong>
-button removes the author after the confirmation. When <strong>Edit</strong> or </strong>Delete</strong>
-button is pressed, an author must be selected in the list in order to proceed with the operation.
+This part also includes buttons for adding, editing and deleting authors. The <i>Add author</i> and
+<i>Edit author</i> buttons open the Add/Edit Author Dialog (see below), the <i>Delete author</strong>
+button removes the author after the confirmation. When <i>Edit</i> or </i>Delete</i>
+button is pressed, an author must be selected in the list in order to proceed with the operation 
+(otherwise the system will warn you that there is no author selected). Adding and editing authors
+is subject to the system of rights in plantlore. For more information on this topic, see the
+appropriate help section.
+
 <h3>The search criteria</h3>
 Author manager allows users to search the data using 4 parameters: name, organization, role and
 email. Results can be ordered by name, organization, role, email, phone number and URL in either 
 ascending or descending direction. Search string for any of the parameters doesn't have to match 
 the item in the database exactly and any substring will be sufficient (although it might yield more 
-results).
+results). To start searching use <i>Search authors</i> button.
 <p/>
 The search is by default case insensitive.
 <p/>
 After the manager window is opened, all available authors are displayed. If you've executed a search
-but you want to display and browse all available authors again, press the <strong>Search</strong>
+but you want to display and browse all available authors again, press the <i>Search authors</i>
 button while all of the search fields are left blank.
 <p/>
-<h2>Adding new author</h2>
-Window for adding new authors can be opened from the main Author Manager window using <string>Add 
-author</strong> button. This window contains the following fields:
+<h2>Adding and editing authors</h2>
+Window for adding new authors can be opened from the main Author Manager window using <i>Add 
+author</i> button. This window contains the following fields:
 <ul>
-    <li><strong>Name</strong> - Whole name of the author. This field is compulsory and cannot be left blank.</li>
-    <li><strong>Organization</strong> - Organization or institution to which the author belongs.</li>
-    <li><strong>Role</strong> - Role of the author in the given institution.</li>
-    <li><strong>Address</strong> - Address of the author</li>
-    <li><strong>Phone</strong> - Phone number of the author.</li>
-    <li><strong>Email</strong> - Email address of the author.</li>
-    <li><strong>URL</strong> - URL address (webpage) of the author</li>
+    <li><strong>Name</strong> - Whole name of the author. This field is compulsory and cannot be left blank. Maximum length of an item in this field is 50 characters</li>
+    <li><strong>Organization</strong> - Organization or institution to which the author belongs. Maximum length of an item in this field is 50 characters</li>
+    <li><strong>Role</strong> - Role of the author in the given institution. Maximum length of an item in this field is 30 characters</li>
+    <li><strong>Address</strong> - Address of the author. Maximum length of an item in this field is 255 characters</li>
+    <li><strong>Phone</strong> - Phone number of the author. Maximum length of an item in this field is 20 characters</li>
+    <li><strong>Email</strong> - Email address of the author. Maximum length of an item in this field is 100 characters</li>
+    <li><strong>URL</strong> - URL address (webpage) of the author. Maximum length of an item in this field is 255 characters</li>
     <li><strong>Note</strong> - Any other information can be stored here. This field can hold up to 4096 characters.</li>
 </ul>
-New author can be saved using the <strong>Save</strong> button in the bottom of the window.
-<p/>
-<h2>Editing an existing author</h2>
-When author is selected in the list of authors user can edit parameters of the selected author by
-pressing <strong>Edit author</strong> button. All of the fields can be modified.
+<img src="picture/AuthorsAdd.png">
+<p>
+New author can be saved using the <i>Save author</i> button in the bottom of the window. The only compulsory item is the name of the author.
+</p>
+In case you edit already existing author, all of the items are preloaded with the current parameters of the author and you can modify them. You can save the modifications by 
+pressing <strong>Save author</strong> button. All of the fields can be modified and the only compulsory item is the name of the author.
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/en/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/createdb.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/en/html/createdb.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -7,5 +7,43 @@
   </head>
   <body>
   <h1>Creating new database</h1>
+    In order to work with the occurrence data after Plantlore is installed, it is neccessary to create database where the data will be 
+    stored (in case you are using local connections to the database). For remote connections (over a computer network) you do not have
+    to create new database after installation is finished. Plantlore allows you to work with multiple databases on one server and 
+    therefore it is neccessary to have the option to create new databases. The reason for having more than one database can be for 
+    example separation of data from different projects or institutions. The number of databases and their usage is up to you.
+    <p>
+    Plantlore offers simple user interface for creating new databases which is accessible from the main application menu <b>Data|Create 
+    new database</b>
+    <p>
+    <img src="picture/CreateDBMain.png" />
+    <p>
+    <b>Important warning: Because of security reasons it is only possible to create new database using local connection to the database.</b>
+       Also make sure that there's no other program using the PostgreSQL database system while you create new database.
+    <p>
+    In this dialog you have to input basic information about the database system you are using and the new database.
+    <ul>
+        <li><b>Database</b> - Type of the database system you are using. In current version only PostgreSQL database is supported</li>
+        <li><b>DB Port</b> - Port where the database system is running. This field contains the default port for the selected database system</li>
+        <li><b>Alias</b> - Description of the new database which will be used when logging in (this will be automatically 
+                          added to the Login dialog where you choose the database once the database is created)</li>
+        <li><b>Database identifier</b> - Name of the database itself. Make sure there is no other database with this name. The 
+                             name can only consist of alfanumeric characters (A-Z, a-z, 0-9)</li>
+    </ul>
+    After the <b>Next</b> button is pressed the authentication dialog will show up and you have to input login and password for 
+    connecting to the database system.
+    <p>
+    <img src="picture/CreateDBAuth.png">
+    <p>
+    <b>Creating new databaze right after Plantlore installation</b>
+    <p>
+        In case you create new database right after the Plantlore installation finished, use authentication data you entered during the installation (the one for database user). Plantlore will grant this user to administrative priviliges for the new database and
+        you can create other users of this database.
+    </p>
+    <b>Creating new database in already running system</b> 
+    <p>
+        In case you create new database in a system where there are other databases, you should still use the original database user used for creating new database.
+    </p>
+    Once the database is successfuly created you are informed by a messege window and you can login to your new database right away.
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/licence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/licence.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/en/html/licence.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -2,9 +2,89 @@
 <head>
 <meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Licence</title>
+<title>GNU GPL Licence</title>
 </head>
 <body>
-<h1>Licence</h1>
+<center>
+<h1>GNU General Public License</h1>
+<p>Version 2, June 1991</p>
+<br>
+Copyright (C) 1989, 1991 Free Software Foundation, Inc.  <br>
+59 Temple Place - Suite 330, Boston, MA  02111-1307, USA<br>
+<br>
+Everyone is permitted to copy and distribute verbatim copies<br>
+of this license document, but changing it is not allowed.<br>
+</center>
+
+<h2>Preamble</h2>
+
+<P>The licenses for most software are designed to take away your freedom to share and change it.  By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.  This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it.  (Some other Free Software Foundation software is covered by the GNU Library General Public License instead.)  You can apply it to your programs, too.</p>
+<P>When we speak of free software, we are referring to freedom, not price.  Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.</p>
+<P>To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.</p>
+
+<P>For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have.  You must make sure that they, too, receive or can get the source code.  And you must show them these terms so they know their rights.</p>
+<P>We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.</p>
+<P>Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software.  If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.</p>
+<P>Finally, any free program is threatened constantly by software patents.  We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary.  To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.</p>
+<P>The precise terms and conditions for copying, distribution and modification follow.</p>
+<H2>TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</h2>
+
+<P><STRONG>0.</strong> This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License.  The "Program", below, refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language.  (Hereinafter, translation is included without limitation in the term "modification".)  Each licensee is addressed as "you".
+<P>Activities other than copying, distribution and modification are not covered by this License; they are outside its scope.  The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.
+
+<P><STRONG>1.</strong> You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.
+<P>You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.
+<P><STRONG>2.</strong> You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:
+<P>
+<UL>
+<LI><STRONG>a)</strong>
+     You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.
+
+<P>
+<LI><STRONG>b)</strong>
+     You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.
+
+<P>
+<LI><STRONG>c)</strong>
+     If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License.  (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)
+</ul>
+These requirements apply to the modified work as a whole.  If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works.  But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.
+<P>Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.
+<P>In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.
+<P><STRONG>3.</strong> You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:
+
+<UL>
+<LI><STRONG>a)</strong>
+     Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
+
+<P>
+<LI><STRONG>b)</strong>
+     Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete  machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
+<P>
+<LI><STRONG>c)</strong>
+     Accompany it with the information you received as to the offer to distribute corresponding source code.  (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)
+</ul>
+The source code for a work means the preferred form of the work for making modifications to it.  For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable.  However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.
+
+<P>
+If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.
+<P><STRONG>4.</strong> You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License.  Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.
+
+<P><STRONG>5.</strong> You are not required to accept this License, since you have not signed it.  However, nothing else grants you permission to modify or distribute the Program or its derivative works.  These actions are prohibited by law if you do not accept this License.  Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.
+<P><STRONG>6.</strong> Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions.  You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.
+<P><STRONG>7.</strong> If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License.  If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all.  For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.
+<P>If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.
+<P>It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices.  Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.
+<P>This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.
+
+<P><STRONG>8.</strong> If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded.  In such case, this License incorporates the limitation as if written in the body of this License.
+<P><STRONG>9.</strong> The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time.  Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
+
+<P>Each version is given a distinguishing version number.  If the Program specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation.  If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.
+<P><STRONG>10.</strong> If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission.  For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this.  Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.
+<P><STRONG>NO WARRANTY</strong></p>
+<P><STRONG>11.</strong> BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
+<P><STRONG>12.</strong> IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
+<P>
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/en/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/publication.html	2006-09-07 08:35:40 UTC (rev 753)
+++ trunk/src/net/sf/plantlore/help/en/html/publication.html	2006-09-07 08:44:03 UTC (rev 754)
@@ -6,5 +6,63 @@
 </head>
 <body>
 <h1>Publication manager</h1>
+Publication manager allows users to add, search, modify and delete publications where the occurrence records were published.
+It can be invoked from menu <strong>Data|Publication Manager</strong>.
+<p/>
+The Publication Manager window consists of two main parts:
+<ul>
+    <li><strong>The list of publications</strong> - where the results of the search are displayed</li>
+    <li><strong>The search criteria</strong> - where you can specify search parameters for publications</li>    
+</ul>
+<img src="picture/PublicationsMain.png">
+<h3>The list of publications</h3>
+After a succcessful search results are displayed in the list of publications, although not all of them can
+be seen immediately. Initially, only the first page of the results is displayed. To see the rest
+of the pages use <i>Next</i> and <i>Previous</i> buttons which can be found directly under the list.
+In case you would like to display more publications per page, input the requested number of publications to the 
+field below the list of publications.
+<p/>
+This part also includes buttons for adding, editing and deleting publications. The <i>Add publication</i> and
+<i>Edit publication</i> buttons open the Add/Edit Publication Dialog (see below), the <i>Delete publication</strong>
+button removes the publication after the confirmation. When <i>Edit</i> or </i>Delete</i>
+button is pressed, publication must be selected in the list in order to proceed with the operation 
+(otherwise the system will warn you that there is no publication selected). Adding and editing publications
+is subject to the system of rights in plantlore. For more information on this topic, see the
+appropriate help section.
+
+<h3>The search criteria</h3>
+Publication manager allows users to search the data using 4 parameters: Collection name, Journal name, 
+Reference citation and Reference detail. Results can be ordered by Collction name, Publication year, 
+Journal name, Journal author, Reference citation and Reference Detail in either 
+ascending or descending direction. Search string for any of the parameters doesn't have to match 
+the item in the database exactly and any substring will be sufficient (although it might yield more 
+results). To start searching use <i>Search publications</i> button.
+<p/>
+The search is by default case insensitive.
+<p/>
+After the manager window is opened, all available publications are displayed. If you've executed a search
+but you want to display and browse all available publications again, press the <i>Search publications</i>
+button while all of the search fields are left blank.
+<p/>
+<h2>Adding and editing publications</h2>
+Window for adding new publications can be opened from the main Publication Manager window using <i>Add 
+publication</i> button. This window contains the following fields:
+<ul>
+    <li><b>Collection name</b> - Name of the collection this publication belongs to. Maximum size of this item is 255 characters.</li>
+    <li><b>Publication year</b> - Year when the occurrence was published.</li>
+    <li><b>Journal name</b> - Journal name where the occurrence was published. Maximum length of this item is 255 characters.</li>
+    <li><b>Journal author name</b> - Author of the journal where the occurrence was published. Maximum length of this item is 255 characters.</li>
+    <li><b>Refernce detail</b> - Reference detail for the publication. Maximum length of this item is 100 characters.</li>
+    <li><b>URL</b> - URL pointing to the publication. Maximu length of this item is 100 characters.</li>
+    <li><b>Note</b> - Any other information about the publication. Maximum length of this item is 4096 characters.</li>    
+</ul>
+<img src="picture/PublicationsAdd.png">
+<p>
+New publication can be saved using the <i>Save publication</i> button in the bottom of the window. At least one of the following items has to be present: Journal author, Publication year, 
+Journal author name, Collection name.
+</p>
+In case you edit already existing publication, all of the items are preloaded with the current parameters of the publication and you can modify them. You can save the modifications by 
+pressing <strong>Save publication</strong> button. Same as when creating new publication, at least one of the following items has to be present: Journal author, Publication year, Journal 
+author name, Collection name.
 </body>
 </html>
\ No newline at end of file



From fraktalek at mail.berlios.de  Thu Sep  7 10:51:03 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 10:51:03 +0200
Subject: [Plantlore-dev] r755 - trunk/documentation
Message-ID: <200609070851.k878p3Fg032420@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 10:51:02 +0200 (Thu, 07 Sep 2006)
New Revision: 755

Added:
   trunk/documentation/MVCandGUIcommunicationLayer.odt
Log:
MVC and GUI communication layer documented.



Added: trunk/documentation/MVCandGUIcommunicationLayer.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/MVCandGUIcommunicationLayer.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Thu Sep  7 11:21:44 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 11:21:44 +0200
Subject: [Plantlore-dev] r756 - trunk/documentation
Message-ID: <200609070921.k879Li6m003653@sheep.berlios.de>

Author: lada
Date: 2006-09-07 11:21:42 +0200 (Thu, 07 Sep 2006)
New Revision: 756

Added:
   trunk/documentation/history.odt
Log:
Add doc for history.

Added: trunk/documentation/history.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/history.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 11:44:26 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 11:44:26 +0200
Subject: [Plantlore-dev] r757 - in trunk/src/net/sf/plantlore/help: cs/html
	en/html
Message-ID: <200609070944.k879iQUt005705@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 11:44:25 +0200 (Thu, 07 Sep 2006)
New Revision: 757

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/resources.html
   trunk/src/net/sf/plantlore/help/en/html/history.html
   trunk/src/net/sf/plantlore/help/en/html/metadata.html
   trunk/src/net/sf/plantlore/help/en/html/resources.html
Log:
Additional help files

Modified: trunk/src/net/sf/plantlore/help/cs/html/resources.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-07 09:21:42 UTC (rev 756)
+++ trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-07 09:44:25 UTC (rev 757)
@@ -7,5 +7,16 @@
   </head>
   <body>
   <h1>Zdroje</h1>
+Mnoho informac? v?etn? nejaktu?lnej?? verze Plantlore najdete na na?? dom?ci str?nce uveden? n??e.
+V p??pad? jak?chkoliv probl?m? se obra?te na n?kter?ho z v?voj??? Plantlore
+<p>
+Dom?c? str?nka Plantlore: <a href="http://plantlore.berlios.de">http://plantlore.berlios.de</a>
+<p>
+Ulo?i?te zdrojov?ch k?d? (SVN): svn://svn.berlios.de/plantlore/trunk/
+<p>
+Zaznamen?v?n? chyb: <a href="https://developer.berlios.de/bugs/?group_id=5975">https://developer.berlios.de/bugs/?group_id=5975</a>
+<p>
+Po?adavky na nov? funkce: <a href="https://developer.berlios.de/feature/?group_id=5975">https://developer.berlios.de/feature/?group_id=5975</a>
+  
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-07 09:21:42 UTC (rev 756)
+++ trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-07 09:44:25 UTC (rev 757)
@@ -1,10 +1,190 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>History</title>
-</head>
-<body>
-<h1>History</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Editing history</title>
+  </head>
+  <body>
+  <h1>Editing history</h1>
+Plantlore enables you to trace the history of your occurrence data. Thanks to this function, you can find out who, when, and how changed the information
+about a specific occurrence, author, publication, or metadata.<br> 
+The basic information recorded about a modification includes:
+<ul> 
+ <li>date and time of the modification
+ <li>operation type (insert, edit, remove)
+ <li>name of the user carrying out the modification
+ <li>name of the edited item, or identification of inserted/removed record
+ <li>old value of the edited item
+ <li>new value of the edited item
+</ul>
+  
+Plantlore, apart from enabling you to follow the abovementioned changes in the occurrence data also allows you to easily cancel these modifications
+and return to the previous values. History is a powerful tool enabling interference with your occurrence data and it is thus necessary to limit the access
+to the history to users possessing sufficient privileges (see  <a href="./user.html">User rights</a>).  
+
+<p>
+<i><b>There are two different types of work with the editing history:</b></i> 
+</p>
+
+<a href="#historyRecord">Occurrence history</a> - a user's tool to trace the history of modifications to a selected occurrence and use the UNDO operation for selected modifications<br> 
+<a href="#historyData">Whole history</a> - an administrator's tool to check the modifications performed in the data and use the operation "UNDO to the selected data and time"
+
+
+
+<br><br>
+<a name="historyRecord"><h2>Occurrence history</h2></a>
+
+<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
+
+<p><br>
+To access the history of a selected occurrence just select this occurrence and click on the <i><b>History</b></i> button. If the <i><b>History</b></i> button is inactive,
+your access to the editing history has been disabled and you do not have the right to work with the selected occurrence. It will certainly do no harm to mention
+in what cases you have the right to work with the history of an occurrence.
+
+</p>
+The occurrence history is accessible to a user who:
+<ul>
+   <li>entered the occurrence into the database</li>
+   <li>has the right to edit the records of the user that entered this occurrence into the database</li>
+   <li>has the right to edit all the occurrences in a database</li>
+   <li>has administrator rights</li>   
+</ul>    
+
+If you do not have access to the occurrence history and you would like to, please contact the administrator of Plantlore.<br>
+You will find more detailed information about user rights in section <a href="./user.html">User rights</a>.
+
+<h5>Occurrence history dialog</h5>
+
+<img src="picture/historyOcc_cs.png">
+<br><br>
+
+The occurrence history dialog is divided into three parts.
+<ul>
+  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)
+  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)
+  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence
+</ul>
+  
+<h3>List of modifications</h3>
+
+The list of modifications of an occurrence is sorted from the most recent to the oldest change and it is displayed in a table containing the following data:
+  
+<ul>
+<li><b>X</b> - selection of individual modifications</li>
+<li><b>Date/Time</b> - date/time of the modification</li>
+<li><b>User</b> - user who carried out the modification</li>
+<li><b>Item</b> - item that was changed</li>
+<li><b>Old value</b> - value of the item prior to the modification</li>
+<li><b>New value</b> - value of the item after the modification</li>
+</ul>
+
+
+<h3>UNDO operation on selected items</h3>
+
+In occurrence history you may choose to amend <b>only a specific item </b>in the record and return to its previous value. This operation is thus different from a classic UNDO
+operation which reverts changes in a chronological order, from the most recent to the oldest. Let's mention an example utilizing this improvement of the UNDO operation:
+
+<div style="text-align:justify; padding: 20 20 30 20">
+<i> 
+You have modified the items "Herbarium", "Occurrence year", "Occurrence note" and then perform about twenty other modifications. You don't remember the original wording of the 
+occurrence note, but you would like to return to it. With a classic UNDO operation, you would have to cancel one-by-one all of the changes until you would get to the
+original wording of the occurrence note. In the history dialog, however, it is simple to meet your demand. If you only want to find out the original wording of the occurrence
+note, it is sufficient to select the oldest modification of the note in the list of modifications and the desired text will be displayed in the column OLD VALUE. If you 
+wanted to revert the change to the original wording, you only need to find the oldest change, select the given line in column X and click on the <b>UNDO </b>button.
+Don't be worried about the fact that by selecting that line, more recent changes of the note will also be selected -- this behavior is implied by the logic of modifications 
+selection (see below).</i> 
+</div>
+
+As stated above, you can use column X to select the modifications you want to revert. Select or deselect a modification by a mouse-click in column X of a given line. 
+You can also use the buttons <i><b>Select all</b></i> and <i><b>Deselect all</b></i> which select or deselect all occurrence modifications displayed int he table. The number 
+of items displayed in the table may be changed by modifying the value of <i><b>Lines displayed </b></i>and confirming the new value by the ENTER key. You can switch
+over to the previous or next list of modifications using the <b><i>Previous </i></b>and <i><b>Next </b></i>buttons. The information about the currently displayed
+list of changes are stated in the part below the table.
+
+<br><br> 
+After pressing the <i><b>UNDO </b></i>button, information will be displayed about the list of changes about to be performed. Use the CANCEL button to
+cancel the operation. Use the OK button to confirm the operation and reversion of the selected occurrence modifications. All of the selected lines will
+be deleted from the history.
+
+<br><br>
+<img src="picture/historyUndo_cs.png">
+<br><br>
+
+<h3><i>Logic of modification selection</i></h3>
+
+Items in the record might be modified more than once. Thus, it is necessary to provide for several possible situations while selecting changes in the history dialog.<br>
+Here's an illustrative example:<br><br> 
+
+<img src="picture/historyOccMark_cs.png">
+<br><br>
+
+<i>
+Let's suppose that item HERBARIUM was modified n-times. In the history dialog, there are n lines informing about the change to item HERBARIUM. The figure above 
+shows a modification HERBARIUM 15.8.2006 11:39 from value CB/910 to value CB/913, a more recent modification HERBARIUM 15.8.2006 11:40 from value CB/913 to value CB/918,
+and the most recent modification HERBARIUM 15.8.2006 12:36 from value CB/918 to value CB/968. While selecting and deselecting these modifications, following situations
+may come about:
+
+<ul> 
+<li> The user wants to revert to the situation when item HERBARIUM had a value of CB/910. He must therefore select the relevant line with the modification from 
+15.8.2006 11:39. Because there are also more recent changes to item HERBARIUM, lines for changes HERBARIUM 15.8.2006 11:40 and HERBARIUM 15.8.2006 12:36  will also
+be selected. After the <b>UNDO</b> operation is performed, item HERBARIUM of the given record will have the value of CB/910 and all of the selected lines will be
+removed from the history.
+<li> The user has selected the modifications of item HERBARIUM from 15.8.2006 11:39, 15.8.2006 11:40 and 15.8.2006 12:36 and he decides to revert only the change 
+from 15.8.2006 11:39, i.e. to value CB/918. In this situation, the user must deselect the modification of 15.8.2006 11:40. If older modifications (e.g. 15.8.2006 11:39)
+were also deselected, this will lead to the automatic deselection of the modification of 15.8.2006 11:40.
+<li> The user has selected the modifications of item HERBARIUM from 15.8.2006 11:39, 15.8.2006 11:40 and 15.8.2006 12:36 and he decides not to revert any of these
+changes. To deselect all modifications of item HERBARIUM, he only needs to deselect the most recent modification and the older modifications will be deselected 
+automatically. By deselecting a more recent modification the user expresses that he wants to keep this modification of item HERBARIUM.
+</ul>
+</i><br>
+
+<a name="historyData"><h2>Whole history</h2></a> 
+
+<br>
+<img src="picture/wholeHistoryEnter_cs.png">
+<br><br>
+
+Dialog of the whole history of modifications is only accessible to the user with administrator rights. If you have administrator rights, you may open
+this dialog from menu <b>Data/Whole history</b>. If you do not have administrator rights, this menu item is disabled.
+
+<h5>Whole history dialog</h5>
+
+<img src="picture/wholeHistoryDialog_cs.png">
+<br><br>
+
+This dialog displays a list of all modifications relating to metadata, occurrences, authors, and publications. This list is sorted from the most recent
+to the oldest modification and it is displayed in a table containing the following data:
+  
+<ul>
+<li><b>Date/time</b> - date and time of the modification</li>
+<li><b>Operation</b> - operation type (insert, edit, remove)</li>
+<li><b>User</b> - name of the user carrying out the modification</li>
+<li><b>Item</b> - name of the modified item</li>
+<li><b>Old value</b> - old value of the edited item (filled in only for edit operation)</li>
+<li><b>New value</b> - new value of the edited item (filled in only for edit operation)</li>
+</ul>
+
+
+<img src="picture/wholeHistoryDetail_cs.png">
+<br><br>
+
+If you want to find out more detailed information about an occurrence, metadata, author, or publication, please select the
+line with the relevant modification in the table and press the <b><i>Detail</i></b> button. 
+
+<h3>Operation "UNDO to the selected date and time"</h3>
+
+The <b><i>Undo</i></b> operation reverts the changes performed in a database, starting from the most recent to the oldest change. Prior to pressing the UNDO
+button, you must select the line into which (including this line) the modification reversal is supposed to be performed. After pressing the <i><b>Undo</b></i> button,
+you will see the information about the selected date/time for this operation. Confirm the operation by pressing OK; this way, the UNDO operation will be performed
+and the reversed changes will be deleted from the history.
+
+<h3>Database cleanup and deletion of history</h3>
+
+The database also contains records which the user has erased and the information about this deletion is recorded in the history tables. The existence of these
+inactive records is necessary for the UNDO operation. However, you have the option to use the <b><i>Delete</i></b> operation, by means of which you can clean the database
+of inactive records and also delete all data from the history. It is advisable to backup the database before performing this operation. You have to use a third-party tool 
+for database backup. After pressing the <i><b>Delete</b></i> button, a dialog with information about the operation about to be performed will appear. Only after confirming 
+this dialog will the operation be carried out.
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/metadata.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/metadata.html	2006-09-07 09:21:42 UTC (rev 756)
+++ trunk/src/net/sf/plantlore/help/en/html/metadata.html	2006-09-07 09:44:25 UTC (rev 757)
@@ -1,10 +1,117 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html>
 <head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Metadata manager</title>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - Metadata management</title>
 </head>
 <body>
-<h1>Metadata manager</h1>
-</body>
-</html>
\ No newline at end of file
+<h1>Metadata management</h1>
+<img src="picture/metadataEnter_cs.png">
+<br><br>
+
+Metadata manager allows the <b><i>administrator </i></b>to add, edit, and delete the metadata of individual projects.
+You can open the metadata manager from menu <b>Data/Metadata management</b> or by keyboard shortcut CTRL + M.
+
+<h5>Metadata manager dialog</h5>
+
+<img src="picture/metadataDialog_cs.png">
+<br><br>
+The metadata management dialog is divided into two parts:
+<ul>
+  <li><b>List of project metadata</b> - displays the list of metadata of existing projects based on criteria entered for searching and sorting 
+  <li><b>Search</b> - requirements for searching and sorting of metadata
+</ul>
+
+<h2>List of metadata</h2>
+
+This part displays the list of metadata found after a successful search. You can set the number of projects displayed in the table 
+yourselves by changing the value of <i><b>Lines displayed</b></i> and confirming the new value by the ENTER key. Use <i><b>Previous </b></i>and <i><b>Next </b></i>buttons 
+to switch over to the previous or next list of metadata. Information about the currently displayed list of project metadata is stated in the 
+part below the table.<br>
+The following buttons enable the work with a record:
+<ul>    
+   <li><i><b>Add metadata</i></b> - <a href=#add>adds project metadata</a></li>
+   <li><i><b>Edit metadata</i></b> - <a href=#edit>edits project metadata</a></li>
+   <li><i><b>Metadata detail </i></b> - <a href=#detail>detailed project metadata</a></li>
+   <li><i><b>Remove metadata</i></b> - <a href=#drop>removes project metadata</a></li> 
+</ul>   
+
+  
+<h2>Search</h2>
+
+Metadata manager 
+
+User manager offers the administrator the option to search using the following three parameters: institution, project name, and data source.
+The results may be sorted by the institution name, project name, data source, name of the person responsible for technical assistance, name of the person
+responsible for content assistance, date of the project creation and date of the most recent project modification.
+If no parameters and limitations are entered, all project metadata will be found. 
+<br><br>
+<b>Note:</b> the search is case sensitive.
+
+a (case sensitive).
+
+<a name="add"></a><h2>Adding project metadata</h2>
+  
+  <h5>Add metadata dialog</h5>
+  
+  <img src="picture/metadataAdd_cs.png">
+  <br><br>
+Open the Add metadata dialog from Metadata manager. The window displayed offers the following items:
+
+  
+  <ul>
+    <li><b>Institution</b> - unequivocal identifier of the institution that owns the original data source.
+    This item is obligatory and you will not be able to add metadata without filling it in.</li>
+    <li><b>Organization</b> - abbreviation of the organization.</li>
+    <li><b>Technical assistance</b> - name of the person responsible for the technical part of the project. This item is obligatory.</li>
+    <li><b>Technical assistance - e-mail</b> - contact e-mail of the person responsible for the technical part of the project.</li>
+    <li><b>Technical assistance - address</b> - contact address of the person responsible for the technical part of the project.</li>
+    <li><b>Content assistance</b> - name of the person responsible for the content part of the project. This item is obligatory.</li>
+    <li><b>Content assistance - e-mail</b> - contact e-mail of the person responsible for the content part of the project.</li>
+    <li><b>Content assistance - address</b> - contact address of the person responsible for the content part of the project.</li>
+    <li><b>Project name</b> - short name of the project. Project name is an obligatory item and must be unequivocal in the database.</li>
+    <li><b>Project details</b> - detailed description of the project.</li>
+    <li><b>Source</b> - name or code of the data source. This item is obligatory.</li>
+    <li><b>Basis</b> -  information about what the given records describe (preserved specimen, ...).</li>
+    <li><b>Biotope</b> - information about the biotope</li>
+    <li><b>Date of project creation</b> - date and time of project creation. This item is obligatory.</li>
+    <li><b>Date of most recent project modification</b> - date and time of the most recent modification, entering, or deletion of records in the project.</li>        
+ </ul>
+ 
+<a name="edit"></a><h2>Editing metadata</h2>
+
+Open the Edit metadata dialog from Metadata manager. Don?t forget that you must select a project the metadata of which you aim to edit in order to open this dialog. 
+The layout of the Edit metadata dialog is almost identical with the Add metadata dialog. The obligatory items are: institution, name of the person responsible for 
+technical assistance, name of the person responsible for content assistance, name of the project, and data source.<br> 
+  Non-editable items:
+
+  
+  <ul>    
+    <li><b>Date of project creation</b> - date and time of project creation. 
+	Non-editable item.</li>
+    <li><b>Date of most recent project modification</b> - date and time of the 
+	most recent modification, entering, or deletion of records in the project. 
+	Non-editable item.</li>
+  </ul>
+
+The administrator may find the information about the changes performed in individual pieces of metadata in the <a href="./history.html#historyData">whole history</a>
+dialog, where he may also utilize the option of reverting into previous values.
+
+<a name="detail"></a><h2>Detailed project metadata</h2>
+
+This dialog displays detailed information about the project metadata. You have to select a project in order to be able to open this dialog. 
+The dialog is almost identical with the Edit metadata dialog. All items are non-editable, their nature is purely informative.
+
+  
+<a name="drop"></a><h2>Removing project metadata</h2>
+
+Use button <b><i>Delete metadata </i></b>in the Metadata manager to delete the metadata of a particular project. Before pressing this 
+  button, it is necessary to select the metadata. After the button is pressed, the user will be informed about the 
+  operation about to be performed. By confirming the operation, the metadata will be deleted. 
+
+  <br><br>
+  <img src="picture/metadataDelete_cs.png">
+  <br><br>
+  The administrator may recover the deleted metadata by means of the <a href="./history.html#historyData">whole history</a> dialog.
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/resources.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/resources.html	2006-09-07 09:21:42 UTC (rev 756)
+++ trunk/src/net/sf/plantlore/help/en/html/resources.html	2006-09-07 09:44:25 UTC (rev 757)
@@ -6,5 +6,15 @@
 </head>
 <body>
 <h1>Plantlore resources</h1>
+Many resources including the most up to date release can be found at the project homepage listed below.
+If you experience any problems running plantlore please contact any of the developers.
+<p>
+Plantlore home page: <a href="http://plantlore.berlios.de">http://plantlore.berlios.de</a>
+<p>
+Plantlore SVN repository: svn://svn.berlios.de/plantlore/trunk/
+<p>
+Plantlore Bugtrack: <a href="https://developer.berlios.de/bugs/?group_id=5975">https://developer.berlios.de/bugs/?group_id=5975</a>
+<p>
+Plantlore Feature requests: <a href="https://developer.berlios.de/feature/?group_id=5975">https://developer.berlios.de/feature/?group_id=5975</a>
 </body>
 </html>
\ No newline at end of file



From fraktalek at mail.berlios.de  Thu Sep  7 11:45:17 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 11:45:17 +0200
Subject: [Plantlore-dev] r758 - trunk/documentation
Message-ID: <200609070945.k879jHD2005858@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 11:45:17 +0200 (Thu, 07 Sep 2006)
New Revision: 758

Added:
   trunk/documentation/Overview.odt
Log:
Overview, L10n and I18n.



Added: trunk/documentation/Overview.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/Overview.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 11:58:49 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 11:58:49 +0200
Subject: [Plantlore-dev] r759 - trunk/documentation
Message-ID: <200609070958.k879wnBf006841@sheep.berlios.de>

Author: krater
Date: 2006-09-07 11:58:48 +0200 (Thu, 07 Sep 2006)
New Revision: 759

Added:
   trunk/documentation/POKUS O PROGRAMATORSKOU.odt
Log:
Programmer's documentation

Added: trunk/documentation/POKUS O PROGRAMATORSKOU.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/POKUS O PROGRAMATORSKOU.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 12:31:19 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 12:31:19 +0200
Subject: [Plantlore-dev] r760 - in trunk/src/net/sf/plantlore: client
	client/authors client/createdb client/publications
	common/exception l10n middleware server
Message-ID: <200609071031.k87AVJmL014454@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 12:31:12 +0200 (Thu, 07 Sep 2006)
New Revision: 760

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form
   trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Updates of PublicationManager, AuthorManager, CreateDb - L10n fixed, leaking connections fixed.
DBLayer - just added javadoc

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -238,6 +238,9 @@
   </NonVisualComponents>
   <Properties>
     <Property name="defaultCloseOperation" type="int" value="3"/>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
+      <Connection code="L10n.getString(&quot;Plantlore.Title&quot;)" type="code"/>
+    </Property>
   </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="menuBar" type="java.lang.String" value="jMenuBar1"/>
@@ -378,7 +381,7 @@
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="0" attributes="0">
                   <Component id="statusLabel" min="-2" max="-2" attributes="0"/>
-                  <EmptySpace pref="404" max="32767" attributes="0"/>
+                  <EmptySpace pref="424" max="32767" attributes="0"/>
                   <Component id="progressBar" min="-2" pref="314" max="-2" attributes="0"/>
               </Group>
           </Group>
@@ -453,7 +456,7 @@
                       <Component id="recordsPerPage" min="-2" pref="45" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="nextPage" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="352" max="32767" attributes="0"/>
+                      <EmptySpace pref="371" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -537,7 +540,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="223" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="188" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>
@@ -575,7 +578,7 @@
         <DimensionLayout dim="0">
           <Group type="103" groupAlignment="0" attributes="0">
               <Group type="102" alignment="1" attributes="0">
-                  <EmptySpace pref="673" max="32767" attributes="0"/>
+                  <EmptySpace pref="704" max="32767" attributes="0"/>
                   <Component id="recordsCountLabel" min="-2" max="-2" attributes="0"/>
                   <EmptySpace max="-2" attributes="0"/>
                   <Component id="recordsCount" min="-2" max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -142,6 +142,7 @@
         helpAbout = new javax.swing.JMenuItem();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
+        setTitle(L10n.getString("Plantlore.Title"));
         mainToolBar.setFloatable(false);
         mainToolBar.setRollover(true);
         addButton.setIcon(new javax.swing.ImageIcon(getClass().getResource("/toolbarButtonGraphics/general/Add24.gif")));
@@ -178,7 +179,7 @@
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
                 .add(statusLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 404, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 424, Short.MAX_VALUE)
                 .add(progressBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 314, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         jPanel1Layout.setVerticalGroup(
@@ -224,7 +225,7 @@
                 .add(recordsPerPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(nextPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(352, Short.MAX_VALUE))
+                .addContainerGap(371, Short.MAX_VALUE))
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -265,7 +266,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 188, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");
@@ -281,7 +282,7 @@
         jPanel4Layout.setHorizontalGroup(
             jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel4Layout.createSequentialGroup()
-                .addContainerGap(673, Short.MAX_VALUE)
+                .addContainerGap(704, Short.MAX_VALUE)
                 .add(recordsCountLabel)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(recordsCount)

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -8,6 +8,7 @@
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.PlantloreHelp;
@@ -43,10 +44,12 @@
      *  @param addView View for adding authors in Author manager
      */
     public AddAuthorCtrl(AuthorManager addModel, AddAuthorView addView) {
-        logger = Logger.getLogger(this.getClass().getPackage().getName());        
+        logger = Logger.getLogger(this.getClass().getPackage().getName());                
         // Save instance of view and model
         this.model = addModel;
         this.view = addView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);        
         // Add listeners for buttons and fields
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.saveBtnAddActionListener(new SaveAuthorButtonListener());        

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -22,13 +22,12 @@
           <Group type="102" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="0" attributes="0">
-                  <Group type="102" alignment="1" attributes="0">
-                      <Component id="helpBtn" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="37" max="32767" attributes="0"/>
-                      <Component id="closeBtn" min="-2" pref="101" max="-2" attributes="0"/>
-                      <EmptySpace max="-2" attributes="0"/>
-                      <Component id="saveBtn" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace min="-2" pref="13" max="-2" attributes="0"/>
+                  <Group type="102" alignment="0" attributes="0">
+                      <Component id="helpBtn" min="-2" pref="100" max="-2" attributes="0"/>
+                      <EmptySpace min="-2" pref="40" max="-2" attributes="0"/>
+                      <Component id="saveBtn" min="-2" pref="100" max="-2" attributes="0"/>
+                      <EmptySpace pref="9" max="32767" attributes="0"/>
+                      <Component id="closeBtn" min="-2" pref="100" max="-2" attributes="0"/>
                   </Group>
                   <Group type="102" attributes="0">
                       <Group type="103" groupAlignment="0" attributes="0">
@@ -54,13 +53,10 @@
                           <Component id="emailField" alignment="0" pref="279" max="32767" attributes="0"/>
                           <Component id="urlField" alignment="0" pref="279" max="32767" attributes="0"/>
                       </Group>
-                      <EmptySpace max="-2" attributes="0"/>
                   </Group>
-                  <Group type="102" alignment="0" attributes="0">
-                      <Component id="jLabel9" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="293" max="32767" attributes="0"/>
-                  </Group>
+                  <Component id="jLabel9" alignment="0" min="-2" max="-2" attributes="0"/>
               </Group>
+              <EmptySpace max="-2" attributes="0"/>
           </Group>
       </Group>
     </DimensionLayout>
@@ -112,8 +108,8 @@
               <EmptySpace max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
                   <Component id="helpBtn" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="closeBtn" alignment="3" min="-2" pref="23" max="-2" attributes="0"/>
                   <Component id="saveBtn" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="closeBtn" alignment="3" min="-2" pref="23" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -132,14 +132,13 @@
             .add(layout.createSequentialGroup()
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 37, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 101, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(saveBtn)
-                        .add(13, 13, 13))
                     .add(layout.createSequentialGroup()
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(40, 40, 40)
+                        .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 9, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(layout.createSequentialGroup()
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
                                 .add(jLabel5, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
@@ -159,11 +158,9 @@
                             .add(org.jdesktop.layout.GroupLayout.TRAILING, organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
                             .add(phoneField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
                             .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
-                            .add(urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE))
-                        .addContainerGap())
-                    .add(layout.createSequentialGroup()
-                        .add(jLabel9)
-                        .addContainerGap(293, Short.MAX_VALUE))))
+                            .add(urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)))
+                    .add(jLabel9))
+                .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -205,8 +202,8 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(helpBtn)
-                    .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(saveBtn))
+                    .add(saveBtn)
+                    .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -81,8 +81,9 @@
     private Author editAuthor;
     /** Enum used for notifying AppCore to reload cached publications */
     private PlantloreConstants.Table[] editTypeArray = new PlantloreConstants.Table[]{PlantloreConstants.Table.AUTHOR};
+    /** Currently running query */
+    private SelectQuery activeSelectQuery = null;    
     
-    
     /** Constants used for identification of fields for sorting */
     public static final int SORT_NAME = 1;
     public static final int SORT_ORGANIZATION = 2;
@@ -139,7 +140,7 @@
                 clearDataHolders();                
                 // Execute query
                 author = (Author)database.executeInsert(author);
-                logger.info("Author "+name+" saved successfuly.");                
+                logger.info("Author "+author.getWholeName()+" saved successfuly.");                
                 // Set operation state to finished
                 done = true;
                 // Stop the Task
@@ -308,10 +309,36 @@
         int resultId = 0;
         // Execute query
         resultId = database.executeQuery(query);
+        if (this.activeSelectQuery != null) {
+            database.closeQuery(this.activeSelectQuery);
+        }
+        // Save the query as the active search query        
+        this.activeSelectQuery = query;        
         return resultId;
     }
      
     /**
+     *  Close active SelectQuery (if there is one)
+     */
+    public void closeActiveQuery()  {
+        if (this.activeSelectQuery != null) {
+            try {
+                database.closeQuery(this.activeSelectQuery);
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            }            
+            this.activeSelectQuery = null;
+        }
+    }
+    
+    
+    /**
      *  Clear the variables with author properties
      */
     private void clearDataHolders() {

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -38,6 +38,8 @@
         // Save model and view
         this.model = authModel;
         this.view = authView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);                
         // Add action listeners to buttons
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.addBtnAddActionListener(new AddAuthorButtonListener());
@@ -112,7 +114,7 @@
             AddAuthorCtrl addAuthCtrl = new AddAuthorCtrl(model, addAuthView);            
             // We are going to add author, no editing
             model.setEditAuthor(null);
-            addAuthView.setSize(400,450);        
+//            addAuthView.setSize(400,450);        
             addAuthView.setLocationRelativeTo(null);
             logger.info("Add Author dialog opened for adding new author");            
             addAuthView.setVisible(true);
@@ -147,7 +149,7 @@
             model.setEditAuthor(model.getSelectedAuthor(index));            
             model.setAuthorIndex(index);
             model.loadAuthor();
-            addAuthView.setSize(400,450);        
+//            addAuthView.setSize(400,450);        
             addAuthView.setLocationRelativeTo(null);
             logger.info("Add Author dialog opened for editing author");
             addAuthView.setVisible(true);            

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,9 +31,9 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Component id="jPanel7" alignment="0" max="32767" attributes="2"/>
                   <Group type="102" alignment="0" attributes="0">
-                      <Component id="helpBtn" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="542" max="32767" attributes="0"/>
-                      <Component id="closeBtn" min="-2" pref="113" max="-2" attributes="0"/>
+                      <Component id="helpBtn" min="-2" pref="120" max="-2" attributes="0"/>
+                      <EmptySpace pref="617" max="32767" attributes="0"/>
+                      <Component id="closeBtn" min="-2" pref="120" max="-2" attributes="0"/>
                   </Group>
                   <Component id="jPanel8" alignment="0" max="32767" attributes="1"/>
               </Group>
@@ -75,9 +75,9 @@
               <Group type="102" alignment="0" attributes="0">
                   <EmptySpace max="-2" attributes="0"/>
                   <Group type="103" groupAlignment="0" attributes="0">
-                      <Component id="jScrollPane3" alignment="0" pref="724" max="32767" attributes="0"/>
+                      <Component id="jScrollPane3" alignment="0" pref="825" max="32767" attributes="0"/>
                       <Group type="102" alignment="0" attributes="0">
-                          <Component id="previousBtn" min="-2" pref="107" max="-2" attributes="0"/>
+                          <Component id="previousBtn" min="-2" pref="120" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="totalResultLabel2" min="-2" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
@@ -91,19 +91,19 @@
                                   <EmptySpace min="-2" pref="89" max="-2" attributes="0"/>
                                   <Component id="displayedLabel2" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
-                                  <Component id="displayedLabel" pref="62" max="32767" attributes="0"/>
+                                  <Component id="displayedLabel" pref="139" max="32767" attributes="0"/>
                               </Group>
                               <Group type="102" alignment="1" attributes="0">
-                                  <Component id="addBtn" min="-2" pref="107" max="-2" attributes="1"/>
+                                  <Component id="addBtn" min="-2" pref="120" max="-2" attributes="1"/>
                                   <EmptySpace max="-2" attributes="0"/>
-                                  <Component id="editBtn" min="-2" pref="110" max="-2" attributes="0"/>
+                                  <Component id="editBtn" min="-2" pref="120" max="-2" attributes="0"/>
                                   <EmptySpace min="-2" pref="2" max="-2" attributes="0"/>
                               </Group>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Group type="103" groupAlignment="1" attributes="0">
-                              <Component id="nextBtn" min="-2" max="-2" attributes="1"/>
-                              <Component id="deleteBtn" min="-2" pref="109" max="-2" attributes="1"/>
+                          <Group type="103" groupAlignment="1" max="-2" attributes="0">
+                              <Component id="deleteBtn" max="32767" attributes="1"/>
+                              <Component id="nextBtn" alignment="1" min="-2" pref="120" max="-2" attributes="1"/>
                           </Group>
                       </Group>
                   </Group>
@@ -140,18 +140,18 @@
       </Layout>
       <SubComponents>
         <Container class="javax.swing.JScrollPane" name="jScrollPane3">
+          <Properties>
+            <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+              <Color blue="ff" green="ff" id="white" palette="1" red="ff" type="palette"/>
+            </Property>
+          </Properties>
 
           <Layout class="org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout"/>
           <SubComponents>
             <Component class="javax.swing.JTable" name="listTable">
               <Properties>
                 <Property name="model" type="javax.swing.table.TableModel" editor="org.netbeans.modules.form.editors2.TableModelEditor">
-                  <Table columnCount="4" rowCount="4">
-                    <Column editable="true" title="Title 1" type="java.lang.Object"/>
-                    <Column editable="true" title="Title 2" type="java.lang.Object"/>
-                    <Column editable="true" title="Title 3" type="java.lang.Object"/>
-                    <Column editable="true" title="Title 4" type="java.lang.Object"/>
-                  </Table>
+                  <Table columnCount="0" rowCount="0"/>
                 </Property>
               </Properties>
               <AuxValues>
@@ -277,8 +277,8 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="organizationField" pref="160" max="32767" attributes="2"/>
-                              <Component id="nameField" alignment="0" pref="160" max="32767" attributes="2"/>
+                              <Component id="organizationField" pref="211" max="32767" attributes="2"/>
+                              <Component id="nameField" alignment="0" pref="211" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
@@ -287,11 +287,11 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="emailField" pref="161" max="32767" attributes="2"/>
-                              <Component id="roleField" alignment="0" pref="161" max="32767" attributes="2"/>
+                              <Component id="emailField" pref="211" max="32767" attributes="2"/>
+                              <Component id="roleField" alignment="0" pref="211" max="32767" attributes="2"/>
                           </Group>
                       </Group>
-                      <Component id="searchBtn" min="-2" pref="144" max="-2" attributes="1"/>
+                      <Component id="searchBtn" min="-2" pref="120" max="-2" attributes="1"/>
                   </Group>
                   <EmptySpace max="-2" attributes="0"/>
                   <Component id="jPanel9" min="-2" max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -45,6 +45,7 @@
         this.model = model;
         this.model.addObserver(this);         
         initComponents();
+        jScrollPane3.getViewport().setBackground(java.awt.Color.white);
         PlantloreHelp.addKeyHelp(PlantloreHelp.AUTHOR_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.AUTHOR_MANAGER, this.helpBtn);
         // Center the dialog on the screen
@@ -97,15 +98,13 @@
 
         setTitle(L10n.getString("authorManager"));
         jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Author.list")));
+        jScrollPane3.setBackground(java.awt.Color.white);
         listTable.setModel(new javax.swing.table.DefaultTableModel(
             new Object [][] {
-                {null, null, null, null},
-                {null, null, null, null},
-                {null, null, null, null},
-                {null, null, null, null}
+
             },
             new String [] {
-                "Title 1", "Title 2", "Title 3", "Title 4"
+
             }
         ));
         jScrollPane3.setViewportView(listTable);
@@ -139,9 +138,9 @@
             .add(jPanel7Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 724, Short.MAX_VALUE)
+                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 825, Short.MAX_VALUE)
                     .add(jPanel7Layout.createSequentialGroup()
-                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(totalResultLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -155,16 +154,16 @@
                                 .add(89, 89, 89)
                                 .add(displayedLabel2)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 62, Short.MAX_VALUE))
+                                .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 139, Short.MAX_VALUE))
                             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel7Layout.createSequentialGroup()
-                                .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                 .add(2, 2, 2)))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(nextBtn)
-                            .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 109, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
+                        .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
+                            .add(deleteBtn, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                            .add(nextBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
                 .addContainerGap())
         );
         jPanel7Layout.setVerticalGroup(
@@ -263,17 +262,17 @@
                             .add(jLabel12))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 160, Short.MAX_VALUE)
-                            .add(nameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 160, Short.MAX_VALUE))
+                            .add(organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)
+                            .add(nameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jLabel14)
                             .add(jLabel15))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)
-                            .add(roleField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)))
-                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 144, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                            .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)
+                            .add(roleField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)))
+                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel9, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap())
@@ -314,9 +313,9 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 542, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 113, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 617, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
@@ -498,6 +497,7 @@
      *  Close this dialog.
      */    
     public void close() {
+        model.closeActiveQuery();        
         this.dispose();
     }
 

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -193,26 +193,7 @@
                     // Disconnect - destroy DBLayer
                     factory.destroy(currentDBLayer);
                     logger.debug("Disconnected from the database "+dbinfo.getDatabaseIdentifier());
-                    
-                            /*
-                             * TODO:
-                             *
-                             * HERE GOES YOUR CODE THAT PERFORMS
-                             * 1. THE CONNECTION TO THE DATABASE ENGINE
-                             *    You should use inormation stored in dbinfo and the stored name and password.
-                             *    See HibernateDBLayer.initialize().
-                             * 2. THE CREATION OF THE NEW DATABASE
-                             *    Here it is up to you, I have no idea what should be done here.
-                             *    Creation of all tables and roles + user admin with some default password +
-                             *    neccessary columns (history).
-                             * 3. PRE-FILLING THE DATABASE WITH SOME VALUES
-                             *    Polluting the database with all villages, plants, territories, and phytochoria.
-                             *    This may be optional - only if leaveEmpty is true.
-                             *
-                             * Everything you want do, do it here in the CreationTask!
-                             *
-                             */
-                    
+                                                
                     // Everything went fine.
                     addDBInfoPermanently( dbinfo );
                     logger.info("The creation of a new database was successful.");

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -32,13 +32,17 @@
 
 				Task creation = model.createCreationTask(user, new String(view.password.getPassword()));
                                 Dispatcher.getDispatcher().dispatch(creation, view, false);
-                                /*
-				new DefaultProgressBar(creation, view, true);
-				creation.start(); */
 				
 				view.password.setText("");
 			}
 		});
+                /*
+		JOptionPane.showMessageDialog(
+                    view, 
+                    L10n.getString("Error.BadDatabaseIdentifier"), 
+                    L10n.getString("Error.BadDatabaseIdentifierTitle"), 
+                    JOptionPane.ERROR_MESSAGE);                   
+                 */
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -1,6 +1,11 @@
 <?xml version="1.0" encoding="UTF-8" ?>
 
 <Form version="1.3" type="org.netbeans.modules.form.forminfo.JDialogFormInfo">
+  <Properties>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
+      <Connection code="L10n.getString(&quot;Login.Authentication&quot;)" type="code"/>
+    </Property>
+  </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
   </SyntheticProperties>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,7 +31,7 @@
         PlantloreHelp.addButtonHelp(PlantloreHelp.CREATE_DB, this.help);
         */
         new DefaultEscapeKeyPressed( this );
-        
+
         DocumentSizeFilter.patch(password, 20);
     }
 
@@ -50,6 +50,7 @@
         user = new javax.swing.JTextField();
         cancel = new javax.swing.JButton();
 
+        setTitle(L10n.getString("Login.Authentication"));
         jLabel1.setText(L10n.getString("Login.UserName"));
 
         jLabel2.setText(L10n.getString("Login.Password"));

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -43,6 +43,14 @@
 					engine = ((javax.swing.JTextField)view.databaseEngine.getEditor().getEditorComponent()).getText(),
 					identifier = view.databaseIdentifier.getText(),
 					alias = view.databaseAlias.getText();
+                                if (!identifier.matches("[A-Za-z0-9][A-Za-z0-9]*")) {
+					JOptionPane.showMessageDialog(
+    						view, 
+    						L10n.getString("Error.BadDatabaseIdentifier"), 
+    						L10n.getString("Error.BadDatabaseIdentifierTitle"), 
+    						JOptionPane.ERROR_MESSAGE);   
+                                        return;
+                                }
 				int port = -1;
 				try { 
 					port = Integer.parseInt(view.databasePort.getText());
@@ -63,8 +71,8 @@
 			}
 		});
 	}
-        
-    /**
+       
+   /**
      *  Focus listener for the <strong>DatabaseEngine combobox</strong>. After losing focus
      *  automaticaly loads default port for the given database.
      */

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -8,6 +8,7 @@
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.Dispatcher;
@@ -42,6 +43,8 @@
         // Save instance of view and model
         this.model = addModel;
         this.view = addView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);                
         // Add listeners for buttons and fields
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.saveBtnAddActionListener(new SavePublicationButtonListener());        

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -43,22 +43,27 @@
                       </Group>
                       <EmptySpace min="-2" max="-2" attributes="0"/>
                       <Group type="103" groupAlignment="1" attributes="0">
-                          <Component id="jScrollPane2" pref="290" max="32767" attributes="0"/>
-                          <Component id="journalAuthorField" alignment="0" pref="290" max="32767" attributes="0"/>
-                          <Component id="collectionNameField" alignment="1" pref="290" max="32767" attributes="0"/>
-                          <Component id="publicationYearField" alignment="1" pref="290" max="32767" attributes="0"/>
-                          <Component id="journalNameField" alignment="1" pref="290" max="32767" attributes="0"/>
-                          <Component id="urlField" alignment="0" pref="290" max="32767" attributes="0"/>
-                          <Component id="referenceDetailField" alignment="0" pref="290" max="32767" attributes="0"/>
+                          <Component id="jScrollPane2" pref="264" max="32767" attributes="0"/>
+                          <Component id="journalAuthorField" alignment="0" pref="264" max="32767" attributes="0"/>
+                          <Component id="collectionNameField" alignment="1" pref="264" max="32767" attributes="0"/>
+                          <Component id="publicationYearField" alignment="1" pref="264" max="32767" attributes="0"/>
+                          <Component id="journalNameField" alignment="1" pref="264" max="32767" attributes="0"/>
+                          <Component id="urlField" alignment="0" pref="264" max="32767" attributes="0"/>
+                          <Component id="referenceDetailField" alignment="0" pref="264" max="32767" attributes="0"/>
                       </Group>
                   </Group>
-                  <Component id="jLabel9" alignment="0" min="-2" max="-2" attributes="0"/>
-                  <Group type="102" alignment="1" attributes="0">
-                      <Component id="helpBtn" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="58" max="32767" attributes="0"/>
-                      <Component id="closeBtn" min="-2" pref="101" max="-2" attributes="0"/>
+                  <Group type="102" attributes="0">
+                      <Group type="103" groupAlignment="0" attributes="0">
+                          <Component id="jLabel9" alignment="0" min="-2" max="-2" attributes="0"/>
+                          <Group type="102" alignment="0" attributes="0">
+                              <Component id="helpBtn" min="-2" pref="100" max="-2" attributes="0"/>
+                              <EmptySpace pref="38" max="32767" attributes="0"/>
+                              <Component id="saveBtn" min="-2" pref="100" max="-2" attributes="0"/>
+                              <EmptySpace max="-2" attributes="0"/>
+                              <Component id="closeBtn" min="-2" pref="100" max="-2" attributes="0"/>
+                          </Group>
+                      </Group>
                       <EmptySpace max="-2" attributes="0"/>
-                      <Component id="saveBtn" min="-2" pref="104" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -106,15 +111,15 @@
                       <Component id="jLabel9" min="-2" max="-2" attributes="0"/>
                   </Group>
                   <Group type="102" alignment="0" attributes="0">
-                      <Component id="jScrollPane2" pref="72" max="32767" attributes="0"/>
-                      <EmptySpace min="16" pref="16" max="16" attributes="0"/>
+                      <Component id="jScrollPane2" pref="59" max="32767" attributes="0"/>
+                      <EmptySpace min="-2" pref="29" max="-2" attributes="0"/>
                   </Group>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
+                  <Component id="helpBtn" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="closeBtn" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="saveBtn" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="helpBtn" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -152,20 +152,23 @@
                             .add(jLabel8))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, journalAuthorField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(publicationYearField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)))
-                    .add(jLabel9)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 58, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 101, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 104, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, journalAuthorField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(publicationYearField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)))
+                    .add(layout.createSequentialGroup()
+                        .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                            .add(jLabel9)
+                            .add(layout.createSequentialGroup()
+                                .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 38, Short.MAX_VALUE)
+                                .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                                .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
@@ -202,13 +205,13 @@
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 60, Short.MAX_VALUE)
                         .add(jLabel9))
                     .add(layout.createSequentialGroup()
-                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 72, Short.MAX_VALUE)
-                        .add(16, 16, 16)))
+                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE)
+                        .add(29, 29, 29)))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                     .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -556,13 +556,20 @@
     
     /**
      *  Close active SelectQuery (if there is one)
-     *
-     *  @throws DBLayerException    In case database operation failed
-     *  @throws RemoteException     In case network operation failed
      */
-    public void closeActiveQuery() throws DBLayerException, RemoteException {
+    public void closeActiveQuery()  {
         if (this.activeSelectQuery != null) {
-            database.closeQuery(this.activeSelectQuery);
+            try {
+                database.closeQuery(this.activeSelectQuery);
+            } catch (RemoteException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            }            
             this.activeSelectQuery = null;
         }
     }

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -40,6 +40,8 @@
         // Save model and view
         this.model = publModel;
         this.view = publView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);        
         // Add action listeners to buttons
         view.addPublicationWindowListener(new PublicationWindowListener());        
         view.closeBtnAddActionListener(new CloseButtonListener());
@@ -112,19 +114,8 @@
     class PublicationWindowListener extends WindowAdapter {
         public void windowClosed(WindowEvent e) {
             // Close database connection
-            try {
-                model.closeActiveQuery();
-            } catch (RemoteException ex) {
-                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
-                ex.printStackTrace();
-                DefaultExceptionHandler.handle(view, ex);
-                return;                    
-            } catch (DBLayerException ex) {
-                logger.error("RemoteException caught while closing select query. Details: "+ex.getMessage());
-                ex.printStackTrace();
-                DefaultExceptionHandler.handle(view, ex);
-                return;                    
-            }
+            System.out.println("closing window and query");
+            model.closeActiveQuery();
         }
     }
 

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,9 +31,9 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Component id="jPanel7" alignment="0" max="32767" attributes="2"/>
                   <Group type="102" alignment="0" attributes="1">
-                      <Component id="helpBtn" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="585" max="32767" attributes="0"/>
-                      <Component id="closeBtn" min="-2" max="-2" attributes="0"/>
+                      <Component id="helpBtn" min="-2" pref="120" max="-2" attributes="0"/>
+                      <EmptySpace pref="548" max="32767" attributes="0"/>
+                      <Component id="closeBtn" min="-2" pref="120" max="-2" attributes="0"/>
                   </Group>
                   <Component id="jPanel8" alignment="0" max="32767" attributes="1"/>
               </Group>
@@ -75,9 +75,9 @@
               <Group type="102" attributes="0">
                   <EmptySpace min="-2" max="-2" attributes="0"/>
                   <Group type="103" groupAlignment="0" attributes="0">
-                      <Component id="jScrollPane3" alignment="0" pref="755" max="32767" attributes="0"/>
+                      <Component id="jScrollPane3" alignment="0" pref="756" max="32767" attributes="0"/>
                       <Group type="102" alignment="0" attributes="0">
-                          <Component id="previousBtn" min="-2" pref="107" max="-2" attributes="0"/>
+                          <Component id="previousBtn" min="-2" pref="120" max="-2" attributes="0"/>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Component id="totalResultLabel2" min="-2" max="-2" attributes="0"/>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -89,17 +89,17 @@
                           <EmptySpace min="-2" pref="89" max="-2" attributes="0"/>
                           <Component id="displayedLabel2" min="-2" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="displayedLabel" pref="97" max="32767" attributes="0"/>
+                          <Component id="displayedLabel" max="32767" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="nextBtn" min="-2" max="-2" attributes="1"/>
+                          <Component id="nextBtn" min="-2" pref="120" max="-2" attributes="1"/>
                       </Group>
                       <Group type="102" alignment="1" attributes="0">
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="addBtn" min="-2" pref="111" max="-2" attributes="3"/>
+                          <Component id="addBtn" min="-2" pref="120" max="-2" attributes="3"/>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="editBtn" min="-2" pref="113" max="-2" attributes="1"/>
+                          <Component id="editBtn" min="-2" pref="120" max="-2" attributes="1"/>
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="deleteBtn" min="-2" pref="136" max="-2" attributes="1"/>
+                          <Component id="deleteBtn" min="-2" pref="120" max="-2" attributes="1"/>
                       </Group>
                   </Group>
                   <EmptySpace min="-2" max="-2" attributes="0"/>
@@ -284,11 +284,11 @@
                           </Group>
                           <EmptySpace min="-2" max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="referenceDetailField" pref="183" max="32767" attributes="2"/>
-                              <Component id="referenceCitationField" alignment="0" pref="183" max="32767" attributes="2"/>
+                              <Component id="referenceDetailField" pref="184" max="32767" attributes="2"/>
+                              <Component id="referenceCitationField" alignment="0" pref="184" max="32767" attributes="2"/>
                           </Group>
                       </Group>
-                      <Component id="searchBtn" min="-2" pref="149" max="-2" attributes="1"/>
+                      <Component id="searchBtn" min="-2" pref="120" max="-2" attributes="1"/>
                   </Group>
                   <EmptySpace max="-2" attributes="0"/>
                   <Component id="jPanel9" min="-2" max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -55,6 +55,7 @@
         this.model = model;
         this.model.addObserver(this);
         initComponents();
+        jScrollPane3.getViewport().setBackground(java.awt.Color.white);        
         // Initialize help
         PlantloreHelp.addKeyHelp(PlantloreHelp.PUBLICATION_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.PUBLICATION_MANAGER, this.helpBtn);        
@@ -151,9 +152,9 @@
             .add(jPanel7Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 755, Short.MAX_VALUE)
+                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 756, Short.MAX_VALUE)
                     .add(jPanel7Layout.createSequentialGroup()
-                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(totalResultLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -165,16 +166,16 @@
                         .add(89, 89, 89)
                         .add(displayedLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 97, Short.MAX_VALUE)
+                        .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(nextBtn))
+                        .add(nextBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel7Layout.createSequentialGroup()
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 111, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 113, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 136, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                        .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         jPanel7Layout.setVerticalGroup(
@@ -284,9 +285,9 @@
                             .add(jLabel15))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)
-                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)))
-                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 149, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 184, Short.MAX_VALUE)
+                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 184, Short.MAX_VALUE)))
+                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel9, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap())
@@ -327,9 +328,9 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 585, Short.MAX_VALUE)
-                        .add(closeBtn))
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 548, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
@@ -520,6 +521,7 @@
      *  Close this dialog.
      */    
     public void close() {
+        model.closeActiveQuery();
         this.dispose();
     }
 

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -205,8 +205,6 @@
             String errorClass = sqlstate.substring(0,2);
             String errorDetail = sqlstate.substring(2);
             
-            System.out.println("---------------------------------------Translating sqlstate = " + sqlstate);
-            
             // Connection exception - Connection does not exist, was interrupted or cannot be established
             if (errorClass.equals("08")) {
             	/* POINTLESS :(

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -1785,3 +1785,11 @@
 Error.Transformation.SJTSK=Some value is incorrect
 
 Error.Transformation.S42=Some value is incorrect
+
+Plantlore.Title=Plantlore
+
+Common.Previous=Previous
+
+Publications.SelectPublication=Please select publication
+
+Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -2103,3 +2103,59 @@
 Error.Transformation.SJTSK=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
 
 Error.Transformation.S42=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
+
+Plantlore.Title=Plantlore
+
+statusOkButton=Potvrd\u00ED zm\u011Bny
+
+statusCancelButton=Zru\u0161\u00ED ud\u011Blan\u00E9 zm\u011Bny
+
+statusHelpButton=Zobraz\u00ED n\u00E1pov\u011Bdu pro dan\u00FD dialog
+
+statusLangSettings=P\u0159epne se na jazykov\u00E9 nastaven\u00ED
+
+statusOtherSettings=P\u0159epne se na dal\u0161\u00ED nastaven\u00ED
+
+Data=Data
+
+dataImport=&Import
+
+dataImportTooltip=Importuje n\u00E1lezov\u00E9 z\u00E1znamy do datab\u00E1ze
+
+dataExport=&Export
+
+dataExportTooltip=Exportuje vybran\u00E9 z\u00E1znamy
+
+dataSearch=&Search/Sort
+
+dataSearchTooltip=Otev\u0159e dialog pro vyhled\u00E1v\u00E1n\u00ED
+
+dataSort=Uspo\u0159\u00E1dat podle\:
+
+recordAdd=&Add
+
+recordAddTT=P\u0159id\u00E1 nov\u00FD n\u00E1lez
+
+recordEdit=&Edit
+
+recordEditTT=Upravit vybrabn\u00FD n\u00E1lez
+
+recordDelete=&Delete
+
+recordDeleteTT=Sma\u017E vybran\u00FD n\u00E1lez
+
+recordDetails=Detaily
+
+Information.NoMetadataInResultTitle=\u017D\u00E1dn\u00E9 v\u00FDsledky vyhled\u00E1v\u00E1n\u00ED
+
+DBLayer.Error.CreateDB=Vytvo\u0159en\u00ED nov\u00E9 datab\u00E1ze nebylo \u00FAsp\u011B\u0161n\u00E9. P\u0159esv\u011Bd\u010Dte se, \u017Ee datab\u00E1zov\u00FD syst\u00E9m je spr\u00E1vn\u011B nainstalov\u00E1n a \u017Ee datab\u00E1ze s t\u00EDmto jm\u00E9nem je\u0161te neexistuje.\n
+
+Question.UndoRecordDetail=\u00DApravy neovplyvn\u00ED \u017E\u00E1dn\u00E9 dal\u0161\u00ED n\u00E1lezy
+
+recordCreatedPanel=Z\u00E1znam vytvo\u0159en
+
+Common.Previous=P\u0159edchoz\u00ED
+
+Publications.SelectPublication=Vyberte pros\u00EDm publikaci
+
+Error.CreateDatabase=Nebylo mo\u017En\u00E9 vytvo\u0159it datab\u00E1zi. Skontrolujte zadan\u00E9 autentifika\u0107n\u00ED \u00FAdaje a to, jestli tato datab\u00E1ze u\u017E neexistuje

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -1636,3 +1636,15 @@
 Error.Transformation.SJTSK=Some value is incorrect
 
 Error.Transformation.S42=Some value is incorrect
+
+Plantlore.Title=Plantlore
+
+Login.AddRecord=Add
+
+Login.AddRecordTT=Add a new record.
+
+Common.Previous=Previous
+
+Publications.SelectPublication=Please select publication
+
+Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -364,13 +364,22 @@
     public int getConnectionCount() throws RemoteException;
     
     /**
-     *  TODO: JavaDoc pending     
+     *  Method used to create new database in the PostgreSQL system.
+     *  @param dbname name of the database to create
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
      */
     public void createDatabase(String dbname) throws DBLayerException, RemoteException;
 
     /**
-     *  TODO: JavaDoc pending     
-     */    
+     *  Executes given SQL script. This method is used for creating new users in the new database nad createing tables.
+     *  @param scriptid id of the script to execute
+     *  @param dbname name of the database to execute the script in
+     *  @param username username used to connect to the database
+     *  @password password used to connect to the database
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException;
     
     /**

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -261,7 +261,13 @@
         return plantloreUser;
     }
     
-    // TODO: JavaDoc, cleanup
+    /**
+     *  Initialization of DBLayer when creating new DB (login without database prefix)
+     *
+     *  @param dbID database identifier - database we want to use
+     *  @param user loginname of the user
+     *  @param password password of the user
+     */
     public void initializeNewDB(String dbID, String user, String password) throws DBLayerException, RemoteException {
         Configuration cfg;
         // Load Hibernate configuration
@@ -1066,7 +1072,12 @@
     public void executeDeleteInTransactionHistory(Object data) throws DBLayerException, RemoteException {
         lowLevelOperation(DELETE, data, false, false);
     }
-    
+
+    /**
+     *  Method to check the rights of the user, whether he is allowed to execute given operation
+     *  @data data we inserted/updated
+     *  @type type of the operation (INSERT/UPDATE/DELETE)
+     */
     private void checkRights(Object data, int type) throws DBLayerException {
         DBLayerException ex;
         Session sess;
@@ -1404,6 +1415,15 @@
         }        
     }
     
+    /**
+     *  Method for saving history of database modifications
+     *
+     *  @param sess session to use for databas queries
+     *  @param data data we inserted/updated
+     *  @param type type of operation (SAVE, UPDATE)
+     *  @param recordId id of the newly created record
+     *  @throws DBLayerException in case database error occurred
+     */
     private void saveHistory(Session sess, Object data, int type, Integer recordId) throws DBLayerException {
         String table;
         Integer id, result = 0;
@@ -2174,6 +2194,12 @@
         return sessions.size();
     }
     
+    /**
+     *  Method used to create new database in the PostgreSQL system.
+     *  @param dbname name of the database to create
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void createDatabase(String dbname) throws DBLayerException, RemoteException {
         // Check whether we are connected and obtain a session
         checkConnection();     
@@ -2194,6 +2220,15 @@
         }
     }
     
+    /**
+     *  Executes given SQL script. This method is used for creating new users in the new database nad createing tables.
+     *  @param scriptid id of the script to execute
+     *  @param dbname name of the database to execute the script in
+     *  @param username username used to connect to the database
+     *  @password password used to connect to the database
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException {
         String file;
         switch (scriptid) {



From fraktalek at mail.berlios.de  Thu Sep  7 12:40:17 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Thu, 7 Sep 2006 12:40:17 +0200
Subject: [Plantlore-dev] r761 - trunk/documentation
Message-ID: <200609071040.k87AeHmH007433@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-07 12:40:15 +0200 (Thu, 07 Sep 2006)
New Revision: 761

Added:
   trunk/documentation/UserManualIntro.odt
Log:
Uvod k uzivatelskemu manualu.



Added: trunk/documentation/UserManualIntro.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/UserManualIntro.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Thu Sep  7 13:11:48 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:11:48 +0200
Subject: [Plantlore-dev] r762 - trunk/documentation
Message-ID: <200609071111.k87BBmsg017881@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 13:11:46 +0200 (Thu, 07 Sep 2006)
New Revision: 762

Added:
   trunk/documentation/InstallationCZ.odt
Modified:
   trunk/documentation/Installation.odt
Log:
Installation manuals without the first page.

Modified: trunk/documentation/Installation.odt
===================================================================
(Binary files differ)

Added: trunk/documentation/InstallationCZ.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/InstallationCZ.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 13:18:07 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:18:07 +0200
Subject: [Plantlore-dev] r763 - trunk/documentation
Message-ID: <200609071118.k87BI7xc018441@sheep.berlios.de>

Author: krater
Date: 2006-09-07 13:18:05 +0200 (Thu, 07 Sep 2006)
New Revision: 763

Added:
   trunk/documentation/POKUS O PROGRAMATORSKOU.pdf
Modified:
   trunk/documentation/POKUS O PROGRAMATORSKOU.odt
Log:
Developer's manual

Modified: trunk/documentation/POKUS O PROGRAMATORSKOU.odt
===================================================================
(Binary files differ)

Added: trunk/documentation/POKUS O PROGRAMATORSKOU.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/POKUS O PROGRAMATORSKOU.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Thu Sep  7 13:22:35 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:22:35 +0200
Subject: [Plantlore-dev] r764 - trunk/documentation
Message-ID: <200609071122.k87BMZHk019056@sheep.berlios.de>

Author: krater
Date: 2006-09-07 13:22:35 +0200 (Thu, 07 Sep 2006)
New Revision: 764

Modified:
   trunk/documentation/VyvojovaDokum.odt
Log:
Minor update


Modified: trunk/documentation/VyvojovaDokum.odt
===================================================================
(Binary files differ)



From lada at mail.berlios.de  Thu Sep  7 13:29:06 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:29:06 +0200
Subject: [Plantlore-dev] r765 - trunk/documentation
Message-ID: <200609071129.k87BT61h019525@sheep.berlios.de>

Author: lada
Date: 2006-09-07 13:29:03 +0200 (Thu, 07 Sep 2006)
New Revision: 765

Modified:
   trunk/documentation/Installation.odt
   trunk/documentation/InstallationCZ.odt
Log:
Add first page.

Modified: trunk/documentation/Installation.odt
===================================================================
(Binary files differ)

Modified: trunk/documentation/InstallationCZ.odt
===================================================================
(Binary files differ)



From kovo at mail.berlios.de  Thu Sep  7 13:32:10 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:32:10 +0200
Subject: [Plantlore-dev] r766 - trunk/installer
Message-ID: <200609071132.k87BWAtO020001@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 13:32:09 +0200 (Thu, 07 Sep 2006)
New Revision: 766

Added:
   trunk/installer/packsLang.xml_cze
Log:
This file is somehow missing in the installer directory

Added: trunk/installer/packsLang.xml_cze
===================================================================
--- trunk/installer/packsLang.xml_cze	2006-09-07 11:29:03 UTC (rev 765)
+++ trunk/installer/packsLang.xml_cze	2006-09-07 11:32:09 UTC (rev 766)
@@ -0,0 +1,15 @@
+<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
+<langpack>
+    <str id="pack.core" txt="Spole?n? soubory"/>
+    <str id="pack.core.description" txt="Spole?n? soubory kter? jsou nutn? pro b?h Klienta i Serveru"/>        
+    <str id="pack.client" txt="Plantlore klient"/>
+    <str id="pack.client.description" txt="Klientsk? aplikace pro p?ipojen? k serveru a pr?ci s daty"/>        
+    <str id="pack.server" txt="Plantlore Server"/>
+    <str id="pack.server.description" txt="Serverov? aplikace pro obsluhu klientsk?ch p?ipojen? a po?adavk?"/>
+    <str id="pack.postgresql" txt="PostgreSQL"/>
+    <str id="pack.postgresql.description" txt="Datab?zov? syst?m PostgreSQL"/>        
+    <str id="pack.docs" txt="Dokumentace"/>
+    <str id="pack.docs.description" txt="Dokumentace syst?mu v?etn? u?ivatelsk?ho manu?lu"/>        
+    <str id="pack.sources" txt="Zdrojov? k?dy"/>
+    <str id="pack.sources.description" txt="Zdrojov? k?dy v jazyku Java pro klienta i server"/>        
+</langpack>        



From kovo at mail.berlios.de  Thu Sep  7 13:34:23 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:34:23 +0200
Subject: [Plantlore-dev] r767 - trunk/installer
Message-ID: <200609071134.k87BYNBF020247@sheep.berlios.de>

Author: kovo
Date: 2006-09-07 13:34:23 +0200 (Thu, 07 Sep 2006)
New Revision: 767

Removed:
   trunk/installer/packsLang.xml_cze.java
Log:
And this file has to be deleted

Deleted: trunk/installer/packsLang.xml_cze.java
===================================================================
--- trunk/installer/packsLang.xml_cze.java	2006-09-07 11:32:09 UTC (rev 766)
+++ trunk/installer/packsLang.xml_cze.java	2006-09-07 11:34:23 UTC (rev 767)
@@ -1,15 +0,0 @@
-<?xml version="1.0" encoding="utf-8" standalone="yes" ?>
-<langpack>
-    <str id="pack.core" txt="Spole?n? soubory"/>
-    <str id="pack.core.description" txt="Spole?n? soubory kter? jsou nutn? pro b?h Klienta i Serveru"/>        
-    <str id="pack.client" txt="Plantlore klient"/>
-    <str id="pack.client.description" txt="Klientsk? aplikace pro p?ipojen? k serveru a pr?ci s daty"/>        
-    <str id="pack.server" txt="Plantlore Server"/>
-    <str id="pack.server.description" txt="Serverov? aplikace pro obsluhu klientsk?ch p?ipojen? a po?adavk?"/>
-    <str id="pack.postgresql" txt="PostgreSQL"/>
-    <str id="pack.postgresql.description" txt="Datab?zov? syst?m PostgreSQL"/>        
-    <str id="pack.docs" txt="Dokumentace"/>
-    <str id="pack.docs.description" txt="Dokumentace syst?mu v?etn? u?ivatelsk?ho manu?lu"/>        
-    <str id="pack.sources" txt="Zdrojov? k?dy"/>
-    <str id="pack.sources.description" txt="Zdrojov? k?dy v jazyku Java pro klienta i server"/>        
-</langpack>        



From krater at mail.berlios.de  Thu Sep  7 13:40:27 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Thu, 7 Sep 2006 13:40:27 +0200
Subject: [Plantlore-dev] r768 - trunk/documentation
Message-ID: <200609071140.k87BeRlj021122@sheep.berlios.de>

Author: krater
Date: 2006-09-07 13:40:26 +0200 (Thu, 07 Sep 2006)
New Revision: 768

Added:
   trunk/documentation/VyvojovaDokum.pdf
Modified:
   trunk/documentation/VyvojovaDokum.odt
Log:
Vyvoj

Modified: trunk/documentation/VyvojovaDokum.odt
===================================================================
(Binary files differ)

Added: trunk/documentation/VyvojovaDokum.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/VyvojovaDokum.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Thu Sep  7 14:44:34 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 14:44:34 +0200
Subject: [Plantlore-dev] r769 - trunk/documentation
Message-ID: <200609071244.k87CiYIT032066@sheep.berlios.de>

Author: lada
Date: 2006-09-07 14:43:08 +0200 (Thu, 07 Sep 2006)
New Revision: 769

Added:
   trunk/documentation/uzivatelska_dokumentace3.odt
   trunk/documentation/uzivatelska_dokumentace3.pdf
Log:


Added: trunk/documentation/uzivatelska_dokumentace3.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/uzivatelska_dokumentace3.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/uzivatelska_dokumentace3.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/uzivatelska_dokumentace3.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Thu Sep  7 14:58:56 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 14:58:56 +0200
Subject: [Plantlore-dev] r770 - trunk/documentation
Message-ID: <200609071258.k87CwuXh000512@sheep.berlios.de>

Author: lada
Date: 2006-09-07 14:58:21 +0200 (Thu, 07 Sep 2006)
New Revision: 770

Added:
   trunk/documentation/uzivatelska_dokumentace4.odt
Log:


Added: trunk/documentation/uzivatelska_dokumentace4.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/uzivatelska_dokumentace4.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Thu Sep  7 15:10:29 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 15:10:29 +0200
Subject: [Plantlore-dev] r771 - trunk/documentation
Message-ID: <200609071310.k87DATA5001772@sheep.berlios.de>

Author: lada
Date: 2006-09-07 15:10:12 +0200 (Thu, 07 Sep 2006)
New Revision: 771

Modified:
   trunk/documentation/uzivatelska_dokumentace4.odt
Log:


Modified: trunk/documentation/uzivatelska_dokumentace4.odt
===================================================================
(Binary files differ)



From lada at mail.berlios.de  Thu Sep  7 15:17:45 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Thu, 7 Sep 2006 15:17:45 +0200
Subject: [Plantlore-dev] r772 - trunk/documentation
Message-ID: <200609071317.k87DHjRf002422@sheep.berlios.de>

Author: lada
Date: 2006-09-07 15:16:49 +0200 (Thu, 07 Sep 2006)
New Revision: 772

Added:
   trunk/documentation/uzivatelska_dokumentace4.pdf
Removed:
   trunk/documentation/uzivatelska_dokumentace3.odt
   trunk/documentation/uzivatelska_dokumentace3.pdf
Log:


Deleted: trunk/documentation/uzivatelska_dokumentace3.odt
===================================================================
(Binary files differ)

Deleted: trunk/documentation/uzivatelska_dokumentace3.pdf
===================================================================
(Binary files differ)

Added: trunk/documentation/uzivatelska_dokumentace4.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/uzivatelska_dokumentace4.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From tkovarik at gmail.com  Fri Sep  8 21:50:33 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Fri, 8 Sep 2006 21:50:33 +0200
Subject: [Plantlore-dev] Poznamky zo schodzky
Message-ID: <ea88f1620609081250j17be35d2ifd4326f36250ccec@mail.gmail.com>

Caute, tu su kratke poznamky z dnesnej schodzky o doladeni dokumentacie. Ak
som na nieco zabudol prosim doplnte. U kazdej casti je osoba ktora ma na
starosti finalnu verziu danej casti (samozrejme obsah moze vytvarat niekto
iny)

Uzivatelska dokumentacia [LADA]
- Nove screenshoty (aj do htmliek)
- precitat a doladit chybky, doladit layout a formatovanie (cislovanie atp.)
- upravit a zjednotit HTML (spravi Kovo)

Vyvojova dokumentacia [KOVO]
- RMI
- Mattisse
- BioCASE - komunikacia s vyvojarmi
- Tasky
- MVC
- Graficky navrh
- Pridat poziadavky a bussines procesy

Programatorska dokumentacia [JAKUB, ERIK]
- Erik posle navod ako by mala vyzerat a ako by mala byt strukturovana
programatorska dokumentacia
- Potreba vyrazne zlepsit kvalitu obsahu. Skusit si citat a pripomienkovat
aj to co napisali ostatni.
- Celkovej prehled architektury systemu Plantlore, hodil by se i deployment
diagram, kde by byl zakreslenej normalni klient, plantlore server, databaze,
biocase klient, centralni biocase server [Poznamky od Jakuba]

Dolezite: Ak pisete nieco v OO.org pouzivajte vyhradne Heading 1, Heading 2,
Heading 3 a Text body (styly v OO.org)

Rozne
JavaDoc - Chceme upravovat JavaDocy ktore chybaju (teda ak tam nieco chyba)?
Asi hej ak chyba u niektorych dolezitych metod resp. interfacov
Tlac - Ak pojde budem to tlacit ja u seba v nedelu vecer, pripadne v praci

That's it, majte sa pekne

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060908/fa6a7b65/attachment.html>

From discontinuum at gmail.com  Sat Sep  9 09:30:15 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 9 Sep 2006 09:30:15 +0200
Subject: [Plantlore-dev] Programatorska dokumentace - osnova
Message-ID: <f4dc39b90609090030ic0ae169x2bc88bc79a51902a@mail.gmail.com>

Osnova programatorske dokumentace

<Heading1>Vystizny nazev sekce (1-4/5slov)

Kratky a vystizny popis, co se v dane sekci bude resit, k cemu to mame, jaky
to ma smysl, co to zajistuje.

<Heading2>Introduction
Uvod do problematiky, zavedeni terminologie, pripadne par slov o pouzivane
technologii a jeji terminologii (napr. RMI zajistuje toto, umoznilo nam to
udelat toto, tomuhle rika stub a tomuhle remote object, a kdyz rikam export,
nemyslim tim ted vyndavani zaznamu z databaze, a tamto je naming service).
Nesdelujte, proc zrovna RMI, co jsme pouzitim teto technologie ziskali atp.
To si schovejte do vyvojove dokumentace.

<Heading2>Participants

Popis umisteni ucastniku reseni - kde package jsou a v jakych tridach - a
popis jejich zodpovednosti, tj. co delaji. Zahrnte jenom MODELY.
Pripadne seznam odkazu na nektere soucasti, ktere mohou byt reseny jinde.
(Napr. DBLayer pouzivame skoro kazdy, proto by se hodila poznamka, ze to je
jeden z ucastniku a misto popisu se odkazat na sekci o DBLayer; jiny priklad
je treba Historie - ta bude kompletne popsana v sekci Historie jenom s
poznamkou, ze cast je implementovana v DBLayer). Nepopisujte zde interface
nebo metody daneho objektu - od toho mame Javadoc. Pridam kdyztak na zacatek
programatorske dokumentace tuhle informaci ("Detailni popis rozhrani a vsech
metod lze najit v Javadoc").
Pouzijte vzdy <Heading3>Participant a pak ho popiste, tedy jeho
zodpovednost, ulohu, vyznam. Neni treba vypisovat seznam metod a jejich
popis, na to je Javadoc, krom toho seznam dulezitych metod (pri interface
apod) bude v sekci Class Diagrams; obcas se muze hodit zminka na tu kterou
metodu, zvlast, kdyz pujde o interface, nebo o poradi volani nejakych metod
(treba v builderech: Director vola meotdy takto buildHeader(),
startRecord(), ...., buildFooter(). Muze se hodit i kratky pseudokod, jak
presne to pracuje.

<Heading2>Class Diagrams
Ukazka souvislosti jednotlivych trid, class diagram. Co dedi od ceho a jaky
interface to implementuje; tady muzete defacto vyuzit moznost popsat seznam
metod. Urcite musite popsat alespon ty, ktere se budou zminovat v dalsi
sekci Interaction.

<Heading2>Interaction
Vyzaduje-li to situace - napr. je-li interakce mezi objekty, tj. kdo koho
vytvari, kdo koho kdy vola, apod., netrivialni - je na miste udelat Sequence
diagramy a ty potom do teto sekce pridat v <Heading3> s kratkym popisem, co
zobrazuji. (Napr. proces vytvareni nove DBLayer a jeji inicializace). Pokud
to ma smysl, mohou byt pod diagramem dalsi vysvetlujici poznamky. V
diagramech by se mela objevovat volani metod tak, jak jsou v kodu, aby bylo
mozne snadno dohledat tuto metodu v Javadoc.

<Heading2>Implementation
Popis konkretnich implementaci, kde to ma smysl. (Napr. XMLBuilder
implementuje Builder a je navrzen takto takto a pouziva toto toto,
CSVBuilder implementuje Builder, ale dela to takto a tako). Nebo detaily
nejake implementace, treba konfiguracnich souboru. Popis konkretni
implementace jednotlivych casti uvozen <Heading3>XMLBuilder

<Heading2>GUI
Kratka poznamka o tom, jak se jednotlive dialogy mohou mezi sebou volat (tj.
odkud se da dostat kam), pokud jich je tam nekolik. Rozhodne ne popis GUI, k
tomu uz je uzivatelska dokumentace. Pokud vase GUI tvori jeden dva dialogy,
tak to asi ani nema smysl.

____________________________________________________________________
Jedna se o zakladni kostru, je samozrejme, ze obcas pro nektere sekce se
muze neco vynechat, nebo naopak neco jineho pridat. Nemelo by to vyrazne
narusit stavbu celeho dokumentu; nadto: ten, kdo neco takoveho pouzije
prvni, o tom da vedet ostatnim mejlem, aby to pripadne udelali stejne. Je
jedno, jak to bude, ale aspon at je to stejne.

Na zacatku dokumentace bude zminka o MVC + popis toho, co vsechno vyuziva
GUI (Escape Key, Default Button, AutoText Area, DocumentSizeFilter). Dale na
zacatku bude zminka o celkove architekture Plantlore (vlastne by mela byt
jeste pred MVC).

Dohodneme se jeste, ze teda budeme pouzivat diagramy CERNOBILE, aby se to
lip (~levneji) tisklo.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060909/c32bbf9c/attachment.html>

From discontinuum at gmail.com  Sat Sep  9 09:47:02 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 9 Sep 2006 09:47:02 +0200
Subject: [Plantlore-dev] Programatorska dokumentace - osnova
In-Reply-To: <f4dc39b90609090030ic0ae169x2bc88bc79a51902a@mail.gmail.com>
References: <f4dc39b90609090030ic0ae169x2bc88bc79a51902a@mail.gmail.com>
Message-ID: <f4dc39b90609090047n77ee560fr9d87211f9be88dc4@mail.gmail.com>

A jeste jedna poznamka, tentokrat ke stylum a formatovani: dohodneme se, ze
pokud se bude popisovat neco, co ma nejake casti a ke kazde casti bude
potreba vysvetlivka, pouzijeme TABULKU misto BULLETS.

Priklad jasne volajici po tabulce:

......The following database views have been created:

   - vOccurrences ? the view contains only the current occurrences from
   table tOccurrences
   - vHabitat ? the view contains only the current occurrences from table
   tHabitat
   - vMetadata ? the view contains only the current occurrences from
   table tMetadata
   - vPublications ? the view contains only the current occurrences from
   table tPublications


V tabulkach opet pouzivejte zakladni styl, ktery OOo pouzije automaticky.
Nikde nic necislujte nebo nepodtrhavejte. To se udela az uplne na konci
pripadne a navic tak, aby se shodovaly vsechny dokumenty (tj. ne ze
programatorska dokumentace bude mit Heading2 Arialem a Uzivatelska Timesem,
jak je tomu ted).

V nadpisech pouzivejte styl "pojmenovani pisnicek", tj. Installation of
Plantlore Client and Server, nebo After the Installation is Finished,
Exception Handling, apod.

S velkym pocatecnim pismenem necht jsou nadale: Plantlore, User, Client,
Administrator, Application (reference na Plantlore).

Je-li treba v textu neco zvyraznit, pouziva se k tomu ucelu pouze BOLD.
Tedy: "The Builder does not close the input file abiding by the rules posed
by the Builder Design Pattern." Zvyraznujte jen veci opravdu zajimave.
Kdykoliv se odkazujete na nejaky zavedeny termin, neni nutne pouzivat
zvyraznovani (jinak to bude vypadat jako nejaka hra na tlusta-tenka). V
matematice mame taky termin zobrazeny maximalne jednou (...rekneme, ze je
spojita. .... Charakteristika spojitych funkci pomoci otevrenych mnozin....)



On 9/9/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Osnova programatorske dokumentace
>
> <Heading1>Vystizny nazev sekce (1-4/5slov)
>
> Kratky a vystizny popis, co se v dane sekci bude resit, k cemu to mame,
> jaky to ma smysl, co to zajistuje.
>
> <Heading2>Introduction
> Uvod do problematiky, zavedeni terminologie, pripadne par slov o pouzivane
> technologii a jeji terminologii (napr. RMI zajistuje toto, umoznilo nam to
> udelat toto, tomuhle rika stub a tomuhle remote object, a kdyz rikam export,
> nemyslim tim ted vyndavani zaznamu z databaze, a tamto je naming service).
> Nesdelujte, proc zrovna RMI, co jsme pouzitim teto technologie ziskali
> atp. To si schovejte do vyvojove dokumentace.
>
> <Heading2>Participants
>
> Popis umisteni ucastniku reseni - kde package jsou a v jakych tridach - a
> popis jejich zodpovednosti, tj. co delaji. Zahrnte jenom MODELY.
> Pripadne seznam odkazu na nektere soucasti, ktere mohou byt reseny jinde.
> (Napr. DBLayer pouzivame skoro kazdy, proto by se hodila poznamka, ze to je
> jeden z ucastniku a misto popisu se odkazat na sekci o DBLayer; jiny priklad
> je treba Historie - ta bude kompletne popsana v sekci Historie jenom s
> poznamkou, ze cast je implementovana v DBLayer). Nepopisujte zde interface
> nebo metody daneho objektu - od toho mame Javadoc. Pridam kdyztak na zacatek
> programatorske dokumentace tuhle informaci ("Detailni popis rozhrani a vsech
> metod lze najit v Javadoc").
> Pouzijte vzdy <Heading3>Participant a pak ho popiste, tedy jeho
> zodpovednost, ulohu, vyznam. Neni treba vypisovat seznam metod a jejich
> popis, na to je Javadoc, krom toho seznam dulezitych metod (pri interface
> apod) bude v sekci Class Diagrams; obcas se muze hodit zminka na tu kterou
> metodu, zvlast, kdyz pujde o interface, nebo o poradi volani nejakych metod
> (treba v builderech: Director vola meotdy takto buildHeader(),
> startRecord(), ...., buildFooter(). Muze se hodit i kratky pseudokod, jak
> presne to pracuje.
>
> <Heading2>Class Diagrams
> Ukazka souvislosti jednotlivych trid, class diagram. Co dedi od ceho a
> jaky interface to implementuje; tady muzete defacto vyuzit moznost popsat
> seznam metod. Urcite musite popsat alespon ty, ktere se budou zminovat v
> dalsi sekci Interaction.
>
> <Heading2>Interaction
> Vyzaduje-li to situace - napr. je-li interakce mezi objekty, tj. kdo koho
> vytvari, kdo koho kdy vola, apod., netrivialni - je na miste udelat Sequence
> diagramy a ty potom do teto sekce pridat v <Heading3> s kratkym popisem, co
> zobrazuji. (Napr. proces vytvareni nove DBLayer a jeji inicializace). Pokud
> to ma smysl, mohou byt pod diagramem dalsi vysvetlujici poznamky. V
> diagramech by se mela objevovat volani metod tak, jak jsou v kodu, aby bylo
> mozne snadno dohledat tuto metodu v Javadoc.
>
> <Heading2>Implementation
> Popis konkretnich implementaci, kde to ma smysl. (Napr. XMLBuilder
> implementuje Builder a je navrzen takto takto a pouziva toto toto,
> CSVBuilder implementuje Builder, ale dela to takto a tako). Nebo detaily
> nejake implementace, treba konfiguracnich souboru. Popis konkretni
> implementace jednotlivych casti uvozen <Heading3> XMLBuilder
>
> <Heading2>GUI
> Kratka poznamka o tom, jak se jednotlive dialogy mohou mezi sebou volat
> (tj. odkud se da dostat kam), pokud jich je tam nekolik. Rozhodne ne popis
> GUI, k tomu uz je uzivatelska dokumentace. Pokud vase GUI tvori jeden dva
> dialogy, tak to asi ani nema smysl.
>
> ____________________________________________________________________
> Jedna se o zakladni kostru, je samozrejme, ze obcas pro nektere sekce se
> muze neco vynechat, nebo naopak neco jineho pridat. Nemelo by to vyrazne
> narusit stavbu celeho dokumentu; nadto: ten, kdo neco takoveho pouzije
> prvni, o tom da vedet ostatnim mejlem, aby to pripadne udelali stejne. Je
> jedno, jak to bude, ale aspon at je to stejne.
>
> Na zacatku dokumentace bude zminka o MVC + popis toho, co vsechno vyuziva
> GUI (Escape Key, Default Button, AutoText Area, DocumentSizeFilter). Dale
> na zacatku bude zminka o celkove architekture Plantlore (vlastne by mela byt
> jeste pred MVC).
>
> Dohodneme se jeste, ze teda budeme pouzivat diagramy CERNOBILE, aby se to
> lip (~levneji) tisklo.
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060909/96ad1641/attachment.html>

From krater at mail.berlios.de  Sat Sep  9 09:53:37 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 09:53:37 +0200
Subject: [Plantlore-dev] r773 - in trunk/documentation: . release
	release/developer release/uzivatelska release/vyvojova
Message-ID: <200609090753.k897rbOU009098@sheep.berlios.de>

Author: krater
Date: 2006-09-09 09:53:36 +0200 (Sat, 09 Sep 2006)
New Revision: 773

Added:
   trunk/documentation/release/
   trunk/documentation/release/description.txt
   trunk/documentation/release/developer/
   trunk/documentation/release/developer/complete/
   trunk/documentation/release/uzivatelska/
   trunk/documentation/release/uzivatelska/complete/
   trunk/documentation/release/vyvojova/
   trunk/documentation/release/vyvojova/complete/
Log:
New directory structure in the Documentation folder.

The subfolder `complete` should contain one file only - the whole completed documentation. 

Added: trunk/documentation/release/description.txt
===================================================================
--- trunk/documentation/release/description.txt	2006-09-07 13:16:49 UTC (rev 772)
+++ trunk/documentation/release/description.txt	2006-09-09 07:53:36 UTC (rev 773)
@@ -0,0 +1,14 @@
+The following directories contain:
+
+* Developer
+
+  The Developer's (Programmer's) manual.
+
+
+* Uzivatelska
+
+  The User's manual, in Czech. That's why the name of the directory is in Czech.
+
+* Vyvojova
+
+  The "Decision" manual, in Czech. That's why the name of the directory is in Czech.  
\ No newline at end of file



From krater at mail.berlios.de  Sat Sep  9 11:35:26 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 11:35:26 +0200
Subject: [Plantlore-dev] r774 - trunk/documentation/release/vyvojova
Message-ID: <200609090935.k899ZQ2C018346@sheep.berlios.de>

Author: krater
Date: 2006-09-09 11:35:24 +0200 (Sat, 09 Sep 2006)
New Revision: 774

Added:
   trunk/documentation/release/vyvojova/DOM4J a SAX.odt
   trunk/documentation/release/vyvojova/DOM4J a SAX.pdf
   trunk/documentation/release/vyvojova/Knihovny.odt
   trunk/documentation/release/vyvojova/Knihovny.pdf
   trunk/documentation/release/vyvojova/RMI.odt
   trunk/documentation/release/vyvojova/RMI.pdf
   trunk/documentation/release/vyvojova/todo.txt
Log:
My parts of the new (refined) documentation describing our decisions regarding the RMI, DOM4J, and SAX.

Added: trunk/documentation/release/vyvojova/DOM4J a SAX.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/DOM4J a SAX.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/DOM4J a SAX.pdf
===================================================================
--- trunk/documentation/release/vyvojova/DOM4J a SAX.pdf	2006-09-09 07:53:36 UTC (rev 773)
+++ trunk/documentation/release/vyvojova/DOM4J a SAX.pdf	2006-09-09 09:35:24 UTC (rev 774)
@@ -0,0 +1,564 @@
+%PDF-1.4
+%????????
+2 0 obj
+<< /Length 3 0 R
+   /Filter /FlateDecode
+>>
+stream
+x??]???8?_????Y?X?ih?*?}????y@/?7??#??r??Yu?i?4Yi[??uN<?????????[?fn????????????o?????????????????x?{???????????????????????	_???????#???????{??#????}lm?xL????????????}4???z	7?E???7c?W???5????????-~?^(??\<u???????}?}?s???n????5?????o?4??O/??ZVe?K??<????Z??p0???????&3???A#;O?_9?W?????O??p?7??R???0|-{??m?v1??-?>???
+???%o??????????p??????yO???rR>?~LBI??,?^IF&???;Y?????g?[{???5I7[*??X?&?fZ?=\?a????<???x=;^G?7]JrI[E?????y???c>?rE.??1 at DHzv?g?<????k??t?sF-|?q?.??}?G???????????T??????.??????5?z/???`?K
+???7??#?rc{?^?L.?x?????2???`;D%?[?#i????n
+?K}]?w?$?^'??'??????*d
+X?Z@u?!HR??????????????L??j?]?i?`?.[?J??){?????*?Q??0u)b-b?8????vL?i????+k?mc<?l-?+s@w?'A?(??GC?C??????9?$?H????(C?u??????3?A?9?L?R?<bzi?Q???S?[?G???F????ju????????'
+Fk+??7??%Qb??tC?|\?b????^????$@]7????U????,??H?*A??|??r\??h??N??&+L??I??N?Foh'q??(I??o?????????w????o?????E??R@?v?7??	 j??????i?Uk?M??$?O"???????$???_??'?9??????t??F3?h????1dI?U???6??n&(?????
+uA_?L'???)x??bc?y??Y????3?^?????A????TwO??????7Sr
+"0????oa????
+????????)?????8>_K?????]Yb?i8@?O?? ?s?QA?'?t??!?@T?6???Q?
+s?@r??Yl?	?@?On?????
+?
+?l???I}M46fF6wUc?e4?k??"J??????YCJ?R?;?Y?Jj??????????D
+F????^)?X!?ds 
+?*q?z???D???????6??M?#???aez/???2\$?V?????}??????B?{??v??$D9u?u? ?=?0?Lg?(?H?[^?~_P	?*??p?
+?k]A??d3(??f?^????
+??I??pb?2(??I??Y?????4??8w????T?Ni"??m_???V???}!?)??8X[?????????F?\??1u
+??????1???z??T$??`?aH?/*?Z>nMa??j?A?1??^v?l??Z?if&??'	`U y?????(T?U?qm???KMghT,zV?_???2?l]?z????+?Zo???,a??(?9??$i?*???&?3R??H????y?h*W .??,?(???????Ct:H?R?!??^n??\??????	lX??Z?s^????8??'$q?d?j??j???'?I q(
+!xE1?????|??m?:??????5?pT??5P???	/?!tT???2?l?q??s?^?=q?{'??p???Uv??Ec??0?U??G!<7?}????h?m#?s? ??l??l ?Z/%{)?????yO*?y>?????5/??R?Gk|?O???i??????????i4?%?6C?bY????*y?????^PP
+nI,}f?H?!>?G:?/I)*A?i??????9??E???4eD@??$;W?|s???6]Y?k?&???((A?0E8?????B?vX??+D??v???@??$YE?q???|????:??A?u??`?0]??
+??R????+?(O???X4Z?&>??@m!?0?]$?v???:~S?????????'K????T???]???]??]x?b?!B*?2????g?Kq@??uh????a???????c???NB6j???*m>??$???D???w??? uW??????*gI?9??z?f????7??U????W????f??P[??PT????I[Y?	????U^\5???????Kg?HlU?@?}??d???7? ???2??
+I??Y???W?D???????R?
+?q?'?/B?S(??$A]???#Qg+,ph?%??<,????>?6*j?m5|??"~?T.8?5P?(zWL.
+???`0_^$?NjU??0??Z??J?S>?r>????????=?@?xm3?q?l8?%?]?,md
+???"wx9mr?ri?C?-=?? ?ONM?9???O??X@??Y?XQLp??G??7ZZ6^?#????%'??-??$
+?$;?4??l?'??k?N?H?Z{V??D?@7?F????m+8.?3?W??C6???j???r?3??
+x??B"?????u?w???F??*????Y=? ??9<??yB??x?*?1???????/?2???
+??$???*3?uku20|ro??F????x????r???Y?i\??*M??<NB?!aa?c??I5_????g??*&<@?T4+?C?#???????3?m1"????????o"Eendstream
+endobj
+
+3 0 obj
+  4694
+endobj
+
+5 0 obj
+<< /Length 6 0 R
+   /Filter /FlateDecode
+   /Length1 25732
+>>
+stream
+x??|y`T??????yo??d?$??!!2?H$?Y?&L?1???$?dfFm?.?m?u???j?:$.?Z??????V????-?V!??{??????????9??????{??g?w&I$??+\?m]???g
+O?=?????Y?)?
+'h(?
+?`%? I?M????` ?"V6?y$??<O.6?{??C????????=?6E??im?u?????$T???n8!|'?3?D???n|~??. ???v????@3t??K??p-?B6t"?O??K??pD??h??6???5?C	???Z`??j?F?s?U?FC??o?L?0q.?K?J??8O??Zr?=D??2?;?X??	y?~?????D"??\J???QB??'?????g?*86??a??? J??t?P-l???????????<]C?$??zK Sh6?@pW??>??$??!?a?E????q?a??V?~??>???<??W?-???l$???q?	u?????h???o)?YB??+\/?$<.</???z??>?e)_:"?Fo?kly?1????b??=?L`C2!(?^??????a|?????e?3??V?J2?l???&kH'	?k?vr???????i<M?+?J??~????ra?0,???b?x??Q???1?{??j???]?????R????gN??|u?ct??_b?X\lZ?(?}????????(???:~?1????????_?Ux9?? I$?8??A??????????????g?>2L$??g?s?w???%?:y??G>$G?@???fR/m?t??C?Oo?7???N????:"8??B?P??
+?JX(????d1??B?/D??!-?N??C?!??g?7\e8`x??9NrJ?R?t?t?t?4,?r?<G?T?R?Y????1??i???
+????w?up/!0.'`3?j?q????7	??QZG0,??HaLz?UJf?3a	=(?????[i=??I<O2?????b?8[$(?~???k`|(??7?+?????????@r??
+??i?z?in???N??b???Db?b?I??>?K3<J??=?cD??1Zs'XI?z@???????!?c???~z??}/^??q????wo?W(??????????b??P?9#}???q??(?{?J???r??@?<d?//P6????????l????%???
+????3s<?3?2?????S2????)?I?	?{??j1???d\8?6??U?f?F???E??Y;???I?Q??N??*?M9SE????T5Lu?8?
+???Sj3???5??09??F????lR?#^?a1?7l?p?q?R???Q??U???m??m?Az{,???j?9???-Z??f??!?hj??=?6?*??YSM??a,D???????kk2?????(?n?\???Q???@5_&*UGe??`????=y?v??V??=??wncT?5?5???nM4??7?M$?P??u?h?0P?(?90?U?8?q???=?????3?Z?p??????c?mE?????????DM?3;?oE??DaU?{0=]?????Ze??1????l??L??????T%?????=?xM?{??:`?M??c???_5.N?8?\?fU???17R??2h+C4|5?mG5?????<???G3?????j??????#?p|d?1n`8>G??hn.???<.????y????????V6???y?(s??i??a?a#z?Y?Z[?u??z?????I^?F.?????{?_'G????vGJbm??(I??a?6^?:???s???V]????????1"?
+<*?@I-?D?[uN#???????@?"?0?1?X?(d?&?'?f{?8e?h?2Z???}{T@??D??:Zi?&????s?e??I???l?&??[??????J????+f???s????a???T?Z|??K?e*????x???m??pl?U????pdZ6??{2?????d??s??5M???8??????M{?p?q???^:??Z
+kA=A??F>??W?????????	?>?X??a??9x??(?<????K?=??/???c?	?~??x??4?d??
+Q??W?^??????*????J?'?1??????"?P?'T|
+?x
+?'Q1sz?????c???C????O?1m???<;?^??_??????/????Kw??L?}?W??]??>???>?r?????h;????e??????huC?} b,???Cf?
+X???,??A1?J){????T?)??Ze? ?BD#?U??Z??zI|Byya?????KJfe?o?I&?d??Z???m?$]?r???Z??='?e??C??K?:?y???jJ3?[]q??k??*q?`?o?{?#??q?b?F?I???Y?2>a~?r?j???f?=???^??Vi??j?-?Ny??F?t??b?v?y??J??am???-??"???x????hJ??Tn*????????7???h?V??<?bM?X?Q?.?$A??Vv?%S?!z9:??^
+&ZsO\jj???0?????n??,?n!?z??l??-?K???,+P??? *fPM?$-?5"????u??-FD???????T?????(???R?[???$??,?B??&Z?6?%?#1????^?d/???z1 4?.y?yZh?x3???N.????????c???Q????{??'?D??n*L+$?Q?Y?Cq&????H???I??? ??'|a????=J?????124???q?O~:???????I???
+/?hL0L?????EV?6b??m?Q4? ?lX?D?'?????jKB??&?0iQ?fk??lE?3ItXp???j{?Fm??.?/?d?Z??????hu?"Q??H\xY????+?;???~?Gf?-??f??YH??d(?[?]i?"?a?5gN&7?????G??;?^??k?=??????Vej???ds??Li???f???/?~R??4cb???a??(??Anb??????D????????_,?????%?????~?x?
+;O????H]????,????#??????)1?v$]
+k?????????-??9???Z??1v?????%F?*??$??D?4]6%??I????D)?4(??t_"?d?NF	?@?(????_?4?
+?[????j|Z?)?d-]a"&??}m???f?j??s
+Qp8\v1?n?6{?{?6?U???
+??<|???8?????&????r???p]????L7???(&*q(}??&U<???wa???x??fTB/????K??rt??X?O?q??Y?w?	*???????d{$?,??n????.C?/\?????F??v????m?????As?Z?????K?r???{1.??o4?&mHQ??RX?ei~Z+?!7?(?8
+??:?B?PT?Z??l?l???I[??????4??(???????l{????)%l&$???ZGT+Ud?D%???2?(?
+??e?~???8?JBW??3J	S=???#3rJY?&?M+]i$+???b|?x?h0?3???c?/6=3?y??Nug?8R?!???J?eH2K???v???{?Z??L?H?{?z?1O??S?b???O?j5??X=???=?i}?r?yu?T???8k*?NSYt???#cT????9?B???7-u;b?4???n.7j?????Ik????8-jL???{??????7?$3??!???,"?goG	????????????'????k???x???^???fb??]o??O?&?7m??e????_
+?/???#q?RF?tq?H	??A
+???t?+C!??&???]?ZC?????-??wkc????;???Cn??????w!-??J??E#?r??)CXj?Mr????k?7y?K???(???%B1F?9?/?XVk0??j??
+R??_:?????ar???4??"!?????'9{tX?y9?e??m:??pj?????u??9?a?o?F????0?I??a?o?<F????0?7?F????????QF?f???~3??0?wJH?Q??RF????a?????~s?63Y???0?jf.?-??5?A?E(?y??l?3??a??L??8?D????r????sstX??\M??L&??0?!?Z'a?????????????t??:9????.?a?????il]??u???`|z?0?????S??):?6???????k?a??:9????????g?/8???_?a????Y$?w??8???a?????|_??:??71????????as???a?W?????z?A?
+???:8??#?X":???5!???????`O'?/@?????/)?s??j???q?0?-?Z[o????u???V??N?W???C??Z???XB?	????qb.?k?s??@???z??????i?p??1??
+? E???0??8o?W???(N???y*??p~????????oM?`#?1>???R???2 ?????8????+?|?{?l?e?\?k???!>??G?LG??LF??4<i??uO=????X~n?o3?j???????ma???r>??%?Cn??y??
+m|?&}???S?S?	)?GLFM???k@?nP?I??????V??J;9w?????????&h?H?Q???????JE??1????7?^m>??????w=????<z?.m??D??q]i??p???p?ur??{?5v???N&[w`????_?k??s?ls,?jq?s??.?????g?X?3?k??X?)?qI??b?~???1?2?n??zn?
+???l???"??D?:?]???54o
+?V6=??.?\??k\3?m|t???????z?????bl?n3???K"???|H?b???x?z??.7?x+?3?c?0"]?.?X?#l?N]???}??.???????n???1??+l????'??#}??:,?hy^??,??s)??????d??~????xo??w?X?5?Ock?x??'?D{t?O??W?b???cz^?G??o|???????D>?-??1G5??13???N????6??1?????u??H[3?%???????_?8??M?x?????^????k??????Lx???k?3 ??u<2j\??5??S>??<|W?JJ???????<?X???W????c?????{&?l??t??O??\Z??q?z?d?I???\?m?{Rl[?E?v.???,?t???M???????b?uq?cv<??f???\????c?q3???	??K???????d???#?&??zt?????????h?>??^scg/?s??	M??v?k?Z???B????0????w??&~6??OW?Y?c?B??/???Nw???5iM?X?8??????|??????R??
+???S9??????1
+?~R?M ???0of
+>?_t??]?K??T?@?????j????\(??f???x`?Q?????}f+?????aC???????4t??e??`???`?'?E?n????@??E|???SV;?XOXY???f??????@???TV6tD??*???o?
+|????????3?6FzP&??????B??EJ??@[(??????I?|0???x??JC??????6*??_?)%??G?!??V"??f???Q???e????_w????7w Z?8%GpC??????????|????
+?|?j__w;n?XV\????o?~%?C???v8??;O???X?
+?t5?CS????H?	m}ha?S???YX???? ???
+?"????p?o5???O?3?0[??
+ts?Pp#??!?m}??????oC??o?@?+???HP?????#|J'?C?????m???????????&?
+v9???H?g^a?????t?-hvvD?:?"????->????'l?wb??OY??aq??????+?++?????k???U??\U[??vy??l37t?X???D?t???"\??q1?f?l?????`???????H3K4n??_t?nD?m????&???C3?cn?3#?0??s33'?*??$??EP??Q?|17?9
+W??<TZ????F6??Q?6?	?1??<.??????M??>?:?0_-d??eM7????]???????S?=??
+?d???]??????0E??@?/V?s?2Q???rP?t?Q?*?+?L?+`7????_?y?c??9?n????Y,???q;?x??/????	?l??G|<^wF?_???s@
+????????N,?axogj????Z]8K?=??>?"z%?-X??|?)????-,??%??v|??r?kX>?b@??@!?XZ???}??R?%C3?????^2dq??r???"???B?=	NY?d?i??L????????jU??Wp??????????8???T,+??by?a,G??
+?s????????7<?N?\?{???gX$??{????\??]?z/w?H?s????z1g???z??Y??????)t=@L??:x??0????n?Eic???e????1`7?7??M??]=H
+??8v?{????]??????v?z?}??%7?uv?0?1?Z?? ?Rl???U??/?>3??????????NQE
+D?p??~?5y?[??kv?|???7]?????$t?k??d3??1L2?9????;B??5??RyG???+???w??wL?wL???	F?1?h5??F?d???$?/S???]&IVI"{?vP?Q?????Ha	$D?zZ?za??[?,?VE?z?????h?C??M?7z???)???3????s????$?P??Q?m?@C#Z9?pE???{???+????????}?S??? eS??2aA|y]?i???;?rN???+???y?9$????\?????5?S????n????-f at ljS}??????{?????????jj?+Qg?*?/?45???9f7'?A?/?
+?%????n?ES^??y;?8??y;?	??Pjk?(
+??p?@&L??KZ ???4?[I?"-??2????x???Q??pB2????@q?(-?(-??	?\E?5?"?B???_XX????l?c??M??ju??g?[???3???????m??3F-???+?^G)d??mp!?M??A?5*!???Q??v~+c??NN???6}(?*??????8?O??!????3??;?!v?????B8??'w?????Y??~?zA?}?D??
+???O??????eg???G?k?jkM???	??c2a??i
+?/o?/???0K?S??G?*T<)?xLP1????UL?*?m?????*3?????s;9??g	Q?T???B???b6W???bvV?|?bZW????N?????%??36??^?1?`??yIx?{LZ?
+endstream
+endobj
+
+6 0 obj
+12749
+endobj
+
+7 0 obj
+<< /Type /FontDescriptor
+   /FontName /DAAAAA+Arial-BoldItalicMT
+   /Flags 68
+   /FontBBox [ -559 -376 1156 1001 ]
+   /ItalicAngle -30
+   /Ascent 905
+   /Descent 211
+   /CapHeight 1000
+   /StemV 80
+   /FontFile2 5 0 R
+>>
+endobj
+
+8 0 obj
+<< /Length 297
+   /Filter /FlateDecode >>
+stream
+x?]??n?0E?H??,?E&?Q	!?H,?PI???Cj??8??0?DU7???{-?LTV??h???e?Zm????9?p??6a PZ?;?%???A4??q??U??!??
+?_???oN???
+????R}??;4?0?sP??o?4???"?/+59??S???<Z????&{??m$??\1?8?!;??0@???"????_???br?q??3$'??? %X?m?JA?!X????+;?g?G??	??r!?V?#Asc??i-?	??s??h{4?y\??c?????=~
+endstream
+endobj
+
+9 0 obj
+<< /Type /Font
+   /Subtype /TrueType
+   /BaseFont /DAAAAA+Arial-BoldItalicMT
+   /FirstChar 0
+   /LastChar 14
+   /Widths [ 750 722 777 833 556 556 666 722
+     666 610 556 556 556 389 277 ]
+   /FontDescriptor 7 0 R
+   /ToUnicode 8 0 R
+>>
+endobj
+
+10 0 obj
+<< /Length 11 0 R
+   /Filter /FlateDecode
+   /Length1 23884
+>>
+stream
+x??|y|[?????W?%[^?%F???X?#?vbb9?M?I??N?.?e9?-??bL!	K?
+I????&P?d9$v??????(i??J?c????k?;3??H??}????E??9?????3g?J?|?~'?``s??=???8
+)?U ??1[?3?H????A$?XED???m?????p!|?"????;?Y?Z??@?A????w?-?}P??Ka=I;??????;?.??&???
+?-?&?9$C*\W?v???`?????)?	? RIz?}$@??GTC3?Z??w???
+k?=??b??\?"? ?Nq??V?]:??tg???_??????s?=zf???8???_???M??()?D??Z??r?)y???|?????Kiju?A????Nzj?'???????sA!d
+???>! ?'?wE??#???Zq????).R4+R<????e??K?Q???^u???????CB=?@hsW??t5z??p????????_??S?F!?d?\???4?F??\J.'Nr=??|??C?%???p8?B?-??6S;u????[?
+/	?	??0jF??/^-~O|P< ?Zq????+?+&?V?V?VRe?r??Xy??!??*?j??I?K???OjY@??rin??)?/???q;9??t"B???qh?U?'?B?h6??%?1?q*mb
+X??)???)?)z!??t??A?_?<??G???G???j???@
+?"[?%??r-? ??e?$4??:|????"?
+~?~(??k?>???????a?+Q????&`5?c???}'?????l;??? ???
+???V????K??c?????l????L?(?z??p=???	????gp?Pb?9P??4???@????b??j??q?????P?%??Ukm?=???s?
+?.???(??p)t????DF1?
++k??o??,b??$?<?|?B?!?o
+?5?J???F?>????B2?V??<?@"Y???h?K
+taD\?????g?E??,?|??S???e?2??90???L???4?X??,ET+0?h?2~_^X?u?.6{v?>hB??????32X?o?A'?v?k??K??[??-@;????H?6?czd?????|??$?93?bI??=K$?k?????fs??M?R?H?????yw????1
+??h???4??bR^>C?nZu1?)yRwLJ? RC???2rm?fd|%??J=?i<?	???,?le`?e???y?????h??C[6??h??5`i0K##????N?d0?L???#?????????h??'?C?`?RX>j&????[?7?N?????? %tE????,k?????c???I?	&z???P??`9??;?	p?zG?1N#8????),?
+|?????(	)U???
+1$?V%?????????a7?-?/??T?1|V??L5? l8????????l?<@?????6?$qu?(???e
+Sl6?cP??>?"?????&??&?f???A????'?d(1P?8?uL*mN??i???????/,?Oq#k???>@??3??IIq?	x??9??.*?XF??99?9??h?????;
++?W??????H???T??????y???r~z?WO?????o~?<:n?3?<r?;.???-???=?K???????U|W}???hQMT??Urn?U??8?P?U?7????t7E????pK?-?[?oJ????	?????????TU|?^?R??r????V?2H%????tO???}?J)??t?n??$]\?AE?????8??????q??Ti	io??xk????Ik?	HB?????
+s??mE?O7??????????Dh)}wt?????/O??	Z???C??K?M? =?
+?????7??<?`?u4?%??s?Q .?f??VZ???O?????E???R?????H+??6?.??LDIS??L{D??J??J|@???	?a???j????5{??j???JO??h^??G???|??i???@oo????MU?QNz??Y???J?EUm?4??K??jZ??dmq??.?????h?@u?R??&?T??Q?*???V????V???Te?h]."?@?Mj?5?]?,???V?-:??.??????(5>?????PUS??g???W;)>ex?C?????
+Q?$?5?2AL?Fi?eE??A'R??j5??M???~????JP?z?????uc36?Xe*?j????m?(???tt?V?????lHe&?11?R?.??NY,???4T?????NM6??Xax{
+ho??-??r?(vQ?9?????C???}z??~!???7?z?^@>E?j3??^???lY.??z??????.?+?j?.?J?2???B??*?IC?-??@JHB??&?[J??X?Z10??\?k?|?6???c?5Si????N2&?:A??\????kbTH%???????;????m??AT?*??X$.3??[?*U?@???zq???????F?fqJC??9?)?sn??v????S'?~???4?R?OLR?$?*&?????~??g?????4=??4?@?e?Y?l?yxII???Ng???t??%?1??	?????.???E`C,??6d???d??xIN?f?S??J????x???G?????.(?Q/????L??:??&?K??d????kF??B???W?F??x??m?)?\?rU\}
+?X?C?????????,???}?ny;???}?I?`q:h;????????tkKVWm???#??m???????/w??EeII?BB?1??\?r++??RO??&&`L???8????xt?QH?}eP	+h???{???%M?????fU??]R??E?,??]m???o?y???uCC??M?j\?--XW?4?????????r*??????????Y at N?.??O???l???W%????????S^?????{??k?n????f??u?m?p?m.J?)??]???????9SR??2????|?,d????????aVZ?????,s??jn?6??2W???;????3w?G2?k?????j??L?9E??O?Te??z?7&?R$?;????&????	i?V??*SI+L`%ay?*U??i????d??&????hK?2?D,??$6?-?h56?rsR?L??<?4??c%??)??F>?46?????3?????[q?>3?3"?bj?"?????HK_??8!?o??2?=???s?8vw?W???????0???h??U?d????H~???*q?v??<???J?"???_?p??W???*;))r|??o?c?$????$c	fL1??Y???????;?\x?u??;n????$?U????^{????Jx?[??>?B^_????u?UiqEK7??y????????*kvqw??[??~!???????@Kj'@>i?TTY?yxa?H?&??????N??2rq/!_???i??*5?+?J??=??????????hn??(?@?
+?ZkKM_?e*?R???l*JQ3N????*?Ej????g3?-?D?G?;?@?i?Mc?????Y "?FREJ?7rY>???7??g??;??eg?????BUq5V?????
+???O????U????3G57.???	???Z???S?G?b%{?a???>#C?7??????v?98z?.%U???KV?????P??D?uR4????R?}?b?v??I+>???zT?@????U??Q?????+??????????&?$??H???lT?F#??,U??$k??K??ioo???j??/???+?J?????_??iO?*-?(?T?Z%
+j?Q??G?$P?QFEI??h)?
+?@1??(P`\)m??Ve#???:U/&G??'?@,m?b???????!??!?-?S~??8?????&???\???U???&??]???K^?0X??????/!?Hf???J??7t$t????B??g*?D?????]?????????????\????z??V???Y~??/!?F???????????????i?Q?_?]?*hS>{D/?`3?*<?ya?b#\???={-?GI1m??
+?B?X??U.T???F???????a>#?1??a?a???4????W?[??w?????J2,B??a$?kdX??]2????OdX9?#??w??V?? ?pt???at??dX?<?~D?????o??k{?aFw?d??hX&?????s?2?
+U?.?B*??Z???~=?lF|?k=??b??x?B?A?#?r???,;????f???F.?;c?"?Z?o	?P?m?/?n????R?J?,m??Z????e~?B}???1m???%?:?[.???mc>?????d?04q~	r???x]??????H???(?y{?s2iE??)g7?e6y?v?+??<???j??^????<?n???^?Gz??hM????|??3??~nu$"????\Z?-?q/O?mm???.?b$?\??]<?X??s]s???e??m???Kdv???>.1?}?[m??r4"#?j?;?c?ox&?.9?=r??7^????MG?.????$?a?U??g?a?C\v??l`?n.+?{??O??C?T?Yt>???^qa???1~?i?Q?9??+w?{???3KY<?d?i??U???gY?L?????I?`g??????g???~~7U/??^n??sb??zg??????Y?^l?????w??'??t?g]\?f??????c????G?7^???*{;"a???y?"?!q:???x?z9????H6?s??L?f?k&????J?L????VymE?N??}?n6{}_???_??C???%?????????Y????v???x\?}??y???'??3?#??'W??j??Y6[=#?}<"v???G?fr|t6?"????<|???bZw???l??=1(?`k(?E???xZ???P????????cKpO-F??]???V?"^???????^????r?;/\?s ??????x?Dh?s???J???~??y^?X?4????GL3^Yn^?;A=?Wsl??g?Z^K\?????gY'?zd????????Ff?"O????#?F?c??E?yv??[-#?c??F??K??^yMo?R?35???6Y[?[?Z?9?Et???3??sh?:9?????A^?|?z????\??^??c?9RfW??????e`'???;???????\>????T????l????U1;???Qk??m?\C?J7????????b?!
 ?Os?\??m?y?g]?I????$?b???6??U?.?i??]dp?Y?`?zpN????_?)f]???W?y??x???h?=?N??YJ7?FN?~?q&?gf>??fw?\Q#???*????w~}??f?c?????>{?=?)??"????<??_?????=+??O?~~???C[??h??????O???.???\??????????e????#f?????!kg?|?????|???)??{???|R?'?<<?[???$???]!>_Y?S?td4??%8Z?#V????
+????Y?5&??????qz??K???[?=?n??)=,??8???~?Q?
+???=h???????Q$??}?????	????~??J????????/eERmo?????????;???????A??w???kZ???j?F????^TTR"??v9?^w?o?,?\
+?-??Z8???2h?r???H????\tnvy}?Ag????|H??Yj????e?????H??wI?^?s???f$?????????(?T7hr?of?.to????????=?^???It9\v?????????*?V??}?>f???????Q?n???um?/?"sw ????}?A???????????>hw?4?????<?????????????z???M??????%?b???;?!????????b?F?}h?????????>?????$?i?V????t?}}8?~???)cqtr????r[Q}??????^???7????	??^??9??????-(???;??(?.?}???????g?=??6??:9O{?????????~???????p????]?Y??*?L??wX??y1wz??>W/w?O^H^Y?9:????)????3c?????SF?8)???	N}??q?aj`???2??x?g?l??????>GA?i????zz??L??wy=v??$]h???e??g??????z|>????????>9a????__oq????Tq??
+;?xC??C?^?:9???-?V??mY?v???A?d???5??R?E???W??i?k???t?????YL?P???{?K?O?%2?s??4??3N?6?3_G?????9??????????N'??"??z???N????7???C,??8'??????8w?g?b!tovr?>fo?????L7??9??N??<??f?m?V{????f?b???.?6??????I?\??v??q:\Xt????^????x?]].?????*0? ?-_?_2????bB%?n?=??IR????????uy{??qw&*????K???=4_????????5?wz??{?`?<?A?nN??q?{?pmu9?"????3:??+@?l???#????7c61?lu???r?g?u/B=v?F???7??Jk?B??????ZR??lhDdIi?????ER?????*??+V??.FvW,???!>?:?C;????e???D?G????b?a?????i????;"??[?c???q????????????mp?k??_????????68??????mp?k??_???????m0?????????%?G???1?y?g?^???w?4?>??-??????:????>_??)qvt#???D0+??V?y????#M?????~n?*?R?k|???_?C?h??K??b?R????b?\?s?????Yl?Y??`?)E??c??F?l??K???XxS0c??????y?w?????uy%?y???p????E?>????p??!??6.|o,&??Vk?M?(??0???[???Q$o??M0`L]f@?[A???
+f?m,?P??? y???e?$?
+IP?}??
+i?????????j??
+!???z?G&A-??e&?????&?2??b??4$?v
+*H@?He4??P????eL?/?]?Zp?-??????^~?	?A??????c[?tH??A? ?h?<"????????eA?"?????&k5?{??p;z?v?m?XNe??yP???S?#???gqa???fC3?V??#?Gv!M?p5x?!??m/?"?L?'8??W6!???	??Al??&?Y????d?c????c??b?h?o??\?>"????%?1OP?C?#?@?$?c????t??@?	?	?& ?yz?y??D???~????*?/???"}x??C-?q??O?.????+???!J???p?1???qf}?N@?'???	?a8??K?8?m?7?Ob??O-?2`??c??%??f???'a?x?,???????q?????>?%?O?rX????e9M???g??X0???X?xP?????k*6???G!I?IE?Cc9Y??#(??S_0?W????V??????8z??	?<*?&?n???\a????%?%?%?)[*?*??R???
+t.Xz+^q??=?l?v?]A?"P{???Ea^?q??^3??p??????(???m;????Wc?&?k?]?1>l~lCX><??Arx8?9<??A??p?~l??9:??9:8Grt Grtpfortp?&?hB?&?h?M???M???9???	9?8?9l?aC??!?9l?a?6??!??s? G	r? G	?(A??(A??Q?%?Q?9$???CB?sH?!!?????CB?s????0pr????a???ccS?1?S?1?9??c
+9??c?sL!?rL??Q?D?3?rYN ?	?rYN ?	d9?YN ?	d9!O???A1m?a??m6?;????;????w???? G
+?A?Q?}`R???"?6	K?ZlW`sc???ql???8?"?7??i?-S?Q?U?U=?:?R<??R??Z?^????J???)%?j????Q,-p?n????p?k?j??Z?????J???S?????|r<?<?O??'?zy???>E?I?M???t[EN?2?L???h
+?,6????n????G?F???v=?
+le?
+?ec3q\>???2e?G??b??&1??????X?m?????g????3???|G??%??s?bw(??i???????A?	?????4?????t?	??`?P?d??=?[??e??L?z?L"cm??f?7??M?l]??;K07?Q???l]HZ?m??e???&s???????Q?!??(??????za?x????e:e?????????4.b?b?8?h?????kM?Z-???aT?????{??^?E???g*2?^8?F????]\E?t?4N???v?JL???M^??&?i??=?A?????Lh#?????&?
+g?4]?=?Ml0?l?\S?t??*#r+
+?2@YD{?7?{?????qk?W}????L?\?TeVe?.P???qj?:Z?Sk?j?R-???	???-??+??)Ev9l??J#?J?????ic?r??t at c????<N??6??$??-????qUx}???P5]?:J??m??[?	????0C?Lc??6J`???&?????jk????5?5q?b???q???s??>y.?????5?Hz[???????u?g?&h???M?h???N?S???EO]????0???rY?d?? 12?'??(B???H??:???!???h??N$?n??T_7*I?&?$?9?sh0c??n4'?S?%???H?Y??-??L&$)4q|r3qA&???gI?e???r?K ?4?MB?4MB?X??/?r+?o{???]?????#p??????NI????.?????z?3?7;???u?h?S?~????F???????l??`????l?k??n???k?????s?f?Z????s????????e?jl5\W???}S??????<???(-?pGZF??$?gK???????@?(K[@g^?ccC????l??f?W(%o[??v?<$k^??F?(_??h???R%`??;f^????P???x???s)?{???\/???e???????????
+Uu??!?h'7?????'q??FS? a??a??S???S?SQ???KM/s?|;6|??C?b??L??2????o??<???)???e?wd*??????[???????+?e?+?W?D????4?g[i?x?
+endstream
+endobj
+
+11 0 obj
+11563
+endobj
+
+12 0 obj
+<< /Type /FontDescriptor
+   /FontName /BAAAAA+Arial-BoldMT
+   /Flags 4
+   /FontBBox [ -627 -376 2000 1011 ]
+   /ItalicAngle 0
+   /Ascent 905
+   /Descent 211
+   /CapHeight 1010
+   /StemV 80
+   /FontFile2 10 0 R
+>>
+endobj
+
+13 0 obj
+<< /Length 278
+   /Filter /FlateDecode >>
+stream
+x?]??j?0????0??a1??v"?.???????h5	1|??Iw)?$?f?/|?I.??Q?A?f5o?? ??8??r?G??(?@H?nH?:G?????pj???(? y????v??=>P??
+?R???????.?|??????????sg^?	!!??^!???????? d???l\?M??vj?8*+???2?P????W????n???;??
+endstream
+endobj
+
+14 0 obj
+<< /Type /Font
+   /Subtype /TrueType
+   /BaseFont /BAAAAA+Arial-BoldMT
+   /FirstChar 0
+   /LastChar 10
+   /Widths [ 750 722 777 833 556 556 277 556
+     666 722 666 ]
+   /FontDescriptor 12 0 R
+   /ToUnicode 13 0 R
+>>
+endobj
+
+15 0 obj
+<< /Length 16 0 R
+   /Filter /FlateDecode
+   /Length1 53888
+>>
+stream
+x???y|???Z???3={????5???4??????,,?&????%?6?E1.V????-?dc?!?!?D?I?@???!P??~I?4?T???y??s?}??]??????:?{N???F????(b?????C7]????	B???????_?Z ~!?K?]z?U?7? ?y!???+?_r?E|!?o??K[.??Y??R#Bw}????????s???[??????f?*?b??m?6?^7?C?n??r?uC?????A8????????????~???C?>?f.#?_????????????+?V?P??OQ??3,?*?F??M???pJ.?????`M(????d*??????M?-??m?,,*??:???????;a_??{??????`???s?????Qh???1???Vw?"?4????C/?)?=??Q?-F????m??F
+?N???
+????????T??Ou???k??:???P?'?byY?U?y??]???Bb??]x5????b?`?d?_?O?2???ne//?;???????0??6?????;P????9?????U?8?}??lc;???_pv?f?}??_?V?F<??????\~???w???!?;?X?;0?w1??M?e?2??~???m?v???{!s+?e_?@??!???	|p?i??32?p?Y?G3x??!??????G???rF?5?p3??i6?_c?h??G;?cN0???G?<??%~?v`??v?s?s0?fb???????#	??????	????o:??B??*1?F?06???}????oE9?????(?|??'?&?e(?u?-?P?? /L???????p??'t-?adM?8G???ug?{;l?Q	???????V`'B?<?
+2j9??W??????????????????K???#??)@Mh?????\#??W??G????^?~?(?%?G???_???vs??Y,?Q~??=j??.)z]??????Bs?2????H?w?y????E[?W
+????r*?????X??P[:%w??????<???????34?K?c4n?x07?]??Ny?]??l??5?	????v?:.??Sh?VQ?&?????????j?? ?
+5?uvM?B??l?k???????:=??@:5?;6?.?@?E?$??:?k&??	}?????.?OM??cRD&??C?7^???n ?0'???????N?????]g^??????29??{?<????3??q`
+?0!o??$?!?S9\??voj?l??p??f???????b+????	>"???#????Gg?l???cD??JN\??O$????@T??P???<?N]3?L??Dh>?m?q?5????}RA????y??s]?9??lr`?$W????W?+??WN?>:>Hu??:z?o??-????q????????????]??m???????????1\?
+????O&'?z?,."P??<?R?,wO??K*?m0???i?|??E??n??i?5y??????*?~7??L??u?wk????j??????{p?????E!Y?>????????????????;?[p+?6???[????[W???,??y???f:?????2?g???T?HNdr?F?FM?{+???M???&1?i??4?6M2?4q>??4????4?#??cU??4@?@?Hv{?xA?fC??g?3?
+_we?S?W[?????U???7??2_???KO??????k????+&f??B?[?e?????2??K??	o????_{?G??G????
+?{3?aX?*!_\mx?????!S?c??ON??????
+???q????Ujr???[q?y???$?ka1?2X?Ld???T?h????`?2???d"G??5&?^??F?ht?D???$?????MR2y??d2	?D?bix$?I????0???<4??,??3fK![??
+?d??ulW????+E???3???^8?\?8?	5?dC??M7????+??&-?j??Ba?MlK??Mx???G?*?R?mNGC?=?o??`n?EC?|???&?j?1????D4?Q??x?????4???<????C????u#???}[?]??U}??sW?R?HK?*?
+?9??????Z??F??????Dg??Dv???????Y?D???????j??m[A?'-<Y??A????A???$? ??A??????=?,?{??]???????h?????-????gfp??Wr?#????\??_ ?QbV?(
+?m6r??m?H'?1C?H?Z??9DN$I$?)?O?w:HV_
+?%??<?+25?6!???????m:?????	[?@a???????$-7???n???|G?X-r?r~??%w?,oU????Z?JF5Kq?v?ni????u?9ku??n?|I?%?i??f(n(2?????I????G???!MA?*???}zF?????ip????I??7????B? m????Sb?/DLj?kS???Pz4????n?l?b?t??4NFP?A?ol???E	??|)
+?y???"??hd,?)?f4?#"?y????e/O???R????T?? ?">?bE>??}*??X??9)	?hq$?;sr&)?&	a??&????I	H?????83\??-'?J??le?`???$?E????o??6?4?0?F?U3B?F?a??? #???E?)`??????E-?F?u????8?
+m^D?3?J???????7?t?z????P???
+???QSi??hQ;???I5Ir8???Gs?h??^??????????_?"9?|cU.???%??P???+??	???Wj???????????C??<???B??p6?&?G??DB?T???	?i?5)??D?^V?N???B???4??L?.V????uzQ????8
+?LF??V??????C?q??jN=?<?x?pm ??L%???Xb"????`?jl???`?C;??#??`??J??p?[??P???*??H.V?".???? ?n/HB2?a????(	??Ee?A???G?E0??xf?gB??|???+d?QW?hn?Ui?r???^?3???-?u??no??mIf???5m7?m_py??X??_{???|%??/??W=??m
+?8?????q?#?????O?
+"????j?y? ???dD?-???i?H?B?@?P???
+?v?8?
+kj?>K?e"??6"D?&??|?-c?b?
+bV?(c??)#???3?@qp0?e??_1_?\-???0??\??Z???.?
+h-???RZ???B?i?Qa??L?????X7?q@`^?0B??Pf????EVr??.?z?{??"?-?3???*I??N?B#ov??%??#/?K?y???E??m??F?()%]3Gx)????M?3?<E?????<?????i??????z???0????J??jq ??b5?????P,&?G??N????m??9iT?5?
+?2??}H$?K???V?"c?l6C?<?
+?D?"???$?$????9?? ???Mqu:?K?AO,??,?J???`oz?3?????}h??
+b+???QM^??	%?*Y5????h??S??}?;???U*???Q?m???D??@L??$?h???
+=??4???#?R???JJX???l?J?A4h{??]??o??xR*m??F5e????x??&???4z???z?c?s??????FPi?z??T???C???-???w?1?I?k?[?_?'??f??A??zjw??y???*5?U?/1????1$?N??I??,???bVi.bF??????Z????vR??fB?C??1?I?M}T?????&!i?1h?	??9?9???VK?????>B???=??0????G1+	?T?X
+??/?`?#???qO????;{????6??9????????Q??ZQCM??cjA?]??C??bS?%gT?}FE?ldO???QhK?i??E?wv???3???3?G#???# ??F??%1????Ix	?????P@?a??
+L??;#?M*??t?
+N?7?D0?F??`4F??+?y??u???}???r???fw?Gx???i?????\u???l????>????????T???w?&fOut?Z??(j?Z*?U	%?J?HV"?5???R?h??6?ci????g??	{&??y??*?H1????yi,s?v-?KEDq?c???)O-??&3?RA;YbY??J?????z????g???Fjk??#?1?%?4??k????<@+?$?&I4I?Z?q?&ir?&???_??N?????9?ni??*?%?:???????):?2??M?L?ma??kl"IJ??R?o?(~?????F????B???ZQ???L{?????X???1?E?K
+k??xB?M?!???U-?%?_$???L ??L????X??Hc??S??i.=?\Q?J?{?????j!??zy???n?o^?#z?05?S??????}??U????g?K{?}???!????)s?J??t??.[f/t????I????Fl????hG?????}?,Q?O<w?sa?q????L ?j[???|sI??Z?4????{?%???????T??X?gB??yM"?(?k??|-I6
+G?Ac26?xP?'??YY&Y??????d??&$?r:MSEE?x??uq?{?'?3#??	B/V???0?98H?032 ??3Y?DI?????M????b???E?
+?Z
+?-CS@??iD&??N~??????=-?MA???R?/?w?.t?B??y???ij?A?l	K?Kv?j
+?VKA??Z???K5??.?????U??^?7??y?kE???|??m?#?
+BMXW H??
+?C?Z]?1???q??Cf5?(C????h????J?$?????.Y?g?+?&?|63???#?????????PcC?L?@?>R,?o???? ?	?gU???S?r?O w??~??B,#?1?h????%kc????f???hx???vk?6wT????dn??=?-[4[?[]??7y???So?nw]???s]?6?m????k?u??|m|W?&???Z-???"$????xT-???\??R?$%?d-?R??pZu
+B?V?V??d??J??
+>S#?$V+?=Z??????g-????Y???a57????%?0!4z??)?MSL????h??`?????????'KD?=??T??=??????@??*??!$|?_Pq???m???T/????D???3?;???g4???????;????$qm$.i\s?7=~?????`!??/??=e
+?Dgl??????H?-?V
+??>w??????i??8?D ??z?^x?,Po??U???Z???????T>m???$??W0????/?g?W,???|?d?????$? )"?d?$?RFP???@???ID[g>??64?z;y&?_??(??Z??u?1q?S+??a5?????
+?<?
+???e9V?p&?7:?-\???A/?L????????,TR,??C?2}?3(?!kpg?E?
+'??gty?`??p~+8}es??'??+?>vw?t\????????|I1ai???#?q?????
+9;
+&?g9
+\?F?o??!???8?N???C?D??M?3??t&i
+xbL??????!?q????R??(p??$?\}??????\%Eh?D\???|????1C??o?4?HE??8L?[\M?U7?1?	=C|??g?????
+?(?Y>c??@s/O?rd:?@]??k????xN?L????????2??_K?.jw??#?????!06A???M??'?/1.??d4O??NE?9Y?Y?r*???L~????????????????W#?SD&?^l_????D?*~???ct?|\}?Psx???q?&??7??G??Q??L???????o???kC?G?????????v?x?:Uw?`<K?t??k??(DL?N?Z??ZWq+???*U????????E???????1?.?i???i?wChP?^#?xw[????????w??CO???U?t}?>???|K????r{?vy4t"?2????cH?=
+???????CGD????V ??b)@%u???x?~QV?v?A4????B???$0???w??f??x????X?XN??DAr?"?BGM?a?+?2?7<2<;\:><2C'@??????:6?+}?|???_?aT
+?"u3?x????6?-e??????
+q?=w??m?
+??>???h?????????+??HmtMd?{???'?+?E?(?s????{????*wJ?^?:???????z ?gZ^?L?=??M
+?!?^??y?????he?<u9;????r?H??!y??{u0,Q?:??h3D???Qxb??2??U??b????'????:?9?F?T&???l3?Sm?Q?????gp?_?nz???/$???????-G?\?
+s????S?v?7>}???9????,`?????}?/?j??[6??????54??;|n???QxA?tkya???![?`3?*??5????7????I?"?4?u?????kv<?v????u?N??????\??ppp?
+V??P?t?[<?M??-U+v?.?A?DL???I-?U??&???X??y
+??]??yC9D????$??sEp[p'???m???*m???:.?V?-?D:]?.U}????/??V2ElAz$?9??S???W"???YX?!?O`?K??5*+??'??????CU[7y
+?H?* O?y?<???p?,?G???S?tq??b[??q???`x(<?>??p_?Q?!L?????*?W?^???H?d
+b??T
+9?{?1?b??p?????3\??k8w??0G3?3?'B????j??hK?!????/?XH#??JjOF??tP??5f??RD8m)
+??#?exJ,??
+?VO????wY$?+ZC??m???kD??m??E?e?yEY(gm??????\Shi??????^?$_???s?<???????	?????S??R?,?r=??W??L2?uHi?'x?n"?J'K????????y????]FPe?7V?v$??Z????	~??????!^???????8Q?]??????????l??"?`?\1]????JC1$
+q???!IW??Z?(Ds?>?rM?A?&?pl??]W?@"1?????R??-??_a*?*???o?$HV????J]U????Z 8`??	#????????T??5cb)?v????b??U???????W??}??k???{o?x???|.?Y8?+s_??M?????????7e????M??g?<w??|$?u????4/???????l$??????n?k|??od??+??)n??v3?$????DG?AH?+??~Ey?$a#R;?.C??0?r9??|Nv@???HWf?K??????~%????	k?B?;?6IM??????h?$>?t?I?????I????b???-h?F???*??&??????=?????????i??7?????3??Jt?????s?%x??;?8?d/s^?zIz1???F?]?????h?5r???d?x??!K?Bb????O,rJR?6$?vIU??-'9sY)??Pv'&'?Q???bqun=?qW6S#?ghnB???c?<? ?d?P?uS??!?	{???D??????"???"?pj
+??)\??D?
+q??a??"????/??A,H???3RK?d?????3g?4??->@???F??1&t????2f?gOz"}??xnM?a3?????#|?f???H_vv*?6???????57j#?Fy??f]??|?k????}???Oo?Z????d4?xD$b?X?Y?\?\????????e=???w*??M????&???h?????<b0$?=???5??7??j??
+??#J??????????g?F??&-M?R'????J/???t???I2?F???K???E`<?????-0?G??SAf??{?W}?^?????m`.?b?,??o???/l?????"-?U??;???Ze???X??2WC?|?|oC/
??6???1	b?????/y?!?CJd?)?#t?
+E?oB?r??%??
+?8h????????a^????????????0?ee??~l<>?e???[????B???H?,?T)?????=x?????G=????{261ZV?????5???^?a?x>W???????_?j??a?%i????V4lh?.q]???GB?7?????'?u~?,??????????$v+?Z??z??w?Xt??r???Y?Xc??Cg??????L??!???/?\?p?9??a??X0??	????$????Lx?4d3????W????X??a?W3c?X.???????{??]zgFNRg?Yb?)qi???y??!J???'???b'0U7??~E????`??A??t?:9S???\4N?":??5?F??|5&???YP??????d??E?8???????j5?T??????8W
+X??=?e'nj??2?????????Q&?"<?
+????P%??n-?$k?Y???Lx?^a)?d???d?f*???c 8?X?????????????@??????3q:??_???????	??t?c???k/?^#6???g?^uE??4??.?Z?q??????7?6?E??}|???^?,?Odo???{?Z7^|????.k-????d?*h???w?f??*K??b??G????????R?????d=6I$%YY$??puy?<A?y???%? ?&3??2?(,3?A??)"M?9?E?Nw$N_D?%???(???4??2M?(???#&?????????????V??&??Ap?????#/?S?C???Q?
+?cD??j??????7?g??r_`???V[p????+?m?m??????
+?2???3???3?B??KI????.U??:????Z4a?l?ZEW??we?X?F?h?Z?R'j?e????N?E:?(???M??0?b36<WFr???c????mF?I??/??????`??Z]N??gN??Q?1=3??"N???%w???p??Y?3??Z|_?f?2Lf??0??|?????H	???s?b$??J?m??)$r?*??_ ?????8o$D?d??B?2P9?"???T??ld?8h????
+?k???????@???y[???M?:/9????,???Q|??W???E5??k?\G????+?;???u&????????yj??N?^o?1??d?5????Y?6?v??_:wt?E???t??y????s????F???Y?s$_?u)z<?a???:???)J? 
+?`?p??????hUW?U????NC????Q?^????v???? ?(??(??pHxR??
+?A>??cnD?l?At?p??2?9???a0?Bu}?i??
+?4?S?q?,?z%????+nn???>%)?N&?c??8?b?,Uu??)?
+,??*???Q3c??0W?	&???d?*?=???!???V?k??I<?N6???b??T\??{w?Q+^?#?YH?e?.???]&??#L??T)??@eP???<??A???y\?/?kH:rL?~???XnvBW??U??d??-9c,?j???4?`{p?d?=7??{??u?E?u???????????
+?P????????H ???1?I???}??????0???W???re??T??9UU]^aa4????t ??j]~?0`??F?V??TV???????I1???d"????2\V?v?4?Y?r*?????Yl??m?FW%??l?mo?d?????=?T?R????p?,V???=?<??P=?aF<??N??Kd???}?R?E?;??=kI:GO??uCz????`??\?/b}??@?D.PB???"]`??O???
+R?'??2/?|?w?<?????N??K??*]?#E??%?ujj????(???yM?k
+????_?y???5u??e6?p???ee???;?????u7??~>???Vp????\W ?ZR_??/g??C~~?/|?d-d?~y?k????k??????4=7*??????`??cU?)u??sa?J??zPfbr??!-?n?G??e2?J?????7X?1Wf??W?}????VA??c1?8?Xe4cC?O?aQ?H?o?*`??gX5???)8"p?6?R????J??VqWJh?R???N
+?$:?QUL?BU??W????=?D?v?3Jz?I?S?0,??\KO??\u?id?~???&?????!?U????lc?)e2???N??VVo?????esgq?????N???>.??o???S?fq?\<?l?Th'){??id`7????9????z????????v?^??????Jw?Dwe?,????n?B?F??*??"??h???a??2[???RL?<?,2??P?<?????~?^?????H??v?????\/7????emF?1?1??G=????A?]???;?BO???qf}L_??r?\??*??0e2??{???b??r?Q?E?QO?{C?Uk?kJ:?[?[?-?[B.?0????Q?a??u?;+n??\ys????k?V[l?:?}Z?~Yq?>eNY?R>y8?d????K?z???????ZJ2??%??	??Y`?VA_u???p%=?????T????B:C?Ng?J???
+?CHQT???r??q,?*1?qp?.b:gb^3a?t????5?2??9?qj?&<???\?7??a6,???/???|8~.,??W?:?
+[?m?S??1?EAs)~?3&K]??,?*?k,????g?G?????TC?Fr?4e>5e???JC?\I?%?/?TE???,???J???^m?~???=???F?
+?i???,??`???uoX?Wy????6;Q????e???7??t?I??m?h?]??C???????l???n?_?????+??8???M??a????????o?lQ?3~??k???n?+y?-??W?
+=`Y?5z??????Fy  {K??????????p\??!/f?N?C???{??'????9?=dy8?;???~???&s???*s???n?H??8??@?q???|??Sd0?[Q^R9???93o???????MO"??I/?>??????????y???Vy??]??V?Xy!$??v?!!??]?^?p?D6????v?1???F?l??e?l??m???@?v?w????????R?-??L"+??-?<???G??~~?_'???+?????t???f???{?????_~??=N?????]??k.?.?j?9?I???'?Oi??d{???
+f?*G?T?Xp?
+y?X?~??Z|X???B?R(Tr?N'{?E,R?~A?VY|?=A?m??V??;"???Y?BPb??p??b???????%rK??C???B?&?v3@??g?Fcy?.??s}&?	??100{????o1c#G????g??????????}-?????	???JX?b?????/4?N?1?s????!??U*????<???Y?\???!??GwY?)[?^?r??RR???ej'?[H*??@?????????J~N?????U??~*?0?TGU}??x???y`?)????2`]???S??????????nA:??^Sbwhtv?s?jZ???5%t~?z?'????+??xr??"?R?)h]?x???6o)+??;"z???r??????yoWC??S????c^??Jz?????I?v?G??|?P??W?jfv~????{??ee???o?N?g?G????%????%OP?:{?{U?$3'?,?:GzM?fU??Y??brs?u9h:u%???P?????"?9????{??q?,n?X?j'?_rNx??/?+????x?/?x/?????~&???8??]??O_?^??6;??b???;???\/????G??`A??r??,?~?????p?5???2?9?/B'?????py4??w?;???G???`????op?@???K?%????}S$?????N\U]s???&?R?a7?3[????1;LE?=????m[6??k]????*X?1???*???{?6????1YH??????<????*?TFi/?OM?#?YY??W?W?e_???WQ??k)<Z?,.?+d??????
+??1?h0?"??q??%TX<??g?Z??%????}????+oH?|@??S?U??N%@???]0?!??????^uOlO??H????*.?G?G?S??QY???????M6f??'-?">?`??,???,???/g[????%?vK????m?V^A???8~?FB%?-??
+?>/?0
+~_?8SPW\R???P?6 at Z4,?W*??W ??E????N!??????hA?????c???/???7?|t?Uv?m????w???1???{?'/???C?w??1??T?Ss'?^L???z?	@7??c~s??|??jb??41???&??`?4?'?
+?????Q???(]E?vr????*??*0???s??=?+???c??u??????????W??#%?o???w???????????P'??e%?5r7??Z?|?????? ??R2?KH	u?u-??JL>:??>~x???z??????s?{4??y<h?5??w????	??&?????C??(??|???zB?.??X1n?;?}?~+??^y
+????2?w???'???xs????{L????{Z????s-u????'*?U?V??JE%??T???NR`?!?}??B?v????????w2;];???????}H????'J??y??X???0z}J?x?Q??e?,jBB???l????	h?f?"??R?????EM??? ??r???H?????#n??,S??.?%???^???g??.:O??E??s??6Un???X	C???A<~F??H?V??:?A?[?5????;?Z?.l??;?}W??#????A??3?q?l??=O?}???r?2??????__????	=??`?/'/(?W?
+?v/l??<????_w?7?(????F??<*???????_??????@???	?=???c??}<?]???7~?l_{f??on????m???7??8?9P?K???-X?????%?R?x???O???t|????u?????s?M?????-?|\????!??|B1????^?????nf7?[?;?{????=?{?_a?T?1????3?-?y??=??d?d??9<+??v??UZer?=<??^?Y?.????b????tj??>E_`????????o??????wOs?/??H5/pG?_g+8??????]d3b?A??H??x?<?p???wt??]??u????=?)?v|;s;?@]??Dq?O?S?4??G??.99??^?L,?%s???-??!f?7?vb?#wn?????????^i?0v??O?z????>]????;O?/??T?q????Q}??!S????1????p??????:o??
+???ft??+?k?O)??v?G??[w?2???Q???k??#?N??X??c?y?]??????%????<[???T?k?ZW?m??`?$???&?n??z???V???"????V?;???&?lL?qr?????1??l????????^A???f??$-?e+?@?????Yr?7???`?BN7?d&?I????F??<K??].4\?H?t}??lF"WT6?????j|N???!7z?.H7?A ?I???????{???
+??S?xbl??o?????/????+/?>?:?[??????????Y????s????g?Q0???M2BpG?H?|P4kC7J?	4?? 9??b?"UD?,?sY??>??Q0???Bp:\??UX?d.?j??1
+????<
+{?1
+??,F???A?????b>m??Y?rC??c??{K???=y_d?g?a?:? c\k?NVQq&??b?)?!???????,?e^;e
+Mq??e?NM???,"dm*????0a??????t????+c??2???4?K'???r????d?|???Ko4^?????<?l??P??{P?(?2??Me??aM?????v?45	CJ???????#<f??\VS]#??????/???=???????????q?????o??,1;r?Z????K?????????????SO??????;?Y?gqD???6??'A*[Qz_(S???5???q?W??r?*?5??|Y??H!g}?"????UX5?W???HA#T?{g?HN??Q??#???`??Q?P?%;J???/?????8??/G-??>???b+^??wm?? ??K??}.?b*?*5gZ?C???
+???P?]N??Q??`@??????????`v??T?-?TK?]?@?\?\?I^4??cX??.??\?>x?W????g????m/~*???a?w??h^?*?v????????/?????SO???g??4^3?m???????<??????+?dOC_??????`?????X?5?????CM????????>Y?r?%#K)G-w?>??oy
+=?9??,N3??1rr?R??
+?\??._EPs*F`K?.?Si?>?	1?)?8G?h8??)?K????ZL<????lf??wg?t?l)?7??????\??4(N??n???????6????!?i,?l1??I?V?NL7??Ko?@???w2??Vy?????????Xn?)_??b??b?????H??x??g???Y?$?"???????o_(`tz?%?S?N[u
+)sf????-X?? .?T;?z?????e??????????d'??B?'??.??6????[Y???????-?>z?f??@os	???u`T|?u??????^?#??????D?W???F??	??z?b?rR5?V?=?? ?q??>=????C|??Kl?^??(J'??"7??:
+?????Y?0?/??9?r??t?T??*??x?rB??g???,????N??>^??E ???8??9X??????#Ul?????Z?JN? ??S?~j??S(??*????8?gJ?V???es??6h??{???6O?zA4?5?7????btn?????DB?L?L??6???V?n?YqY>?K2???@?`0??y??????`tyS??{??FC|?????scE	93??/??/?u?????????????9????	wQ`?_v???H??e??z?_?f?66?^eS[??_????y9I?;%?????pJ?|????????Q?a?,?
+?:t{/Z+CHp?-??Hv???z??r/?~5??????]1Q?????[$.P???b'?{dT?P?????????)???u?>????{
+?I?:%???U????ced??C?/?PF?C9Be?? ?PF??C9[%???}	?2*(?`(???%????C?PXC?Ub??????Aa?q0P?????PC?J
+[
+T???D#?2?/??W
+`???~????f??j??????"??h????i?[??^9???(*??
+j?!???	?
+?(m????|??C?!4 a*5?rdX?:??=C%??|?Q7?[?u?|L-???????)??%?????l?Z??~????!p?????Jb?6?@'????????j???t??fI???&k??D?JT_??Y+?XVCR)????~??_?i??Y?+X*e????i??6,Nk??Y#R?q?E???"?>??R#?s?$?{???Z.1??G?l?l?????4?D.??bM????Z?JJ?"K\!I?u????I?$Ek??????Jfi?ym	|%?????\?????:??????K??v"A????&??,??b?2??????>?(	??QJ?!I??%e?K????K?%???RZl?????d?P??;??o?%N?a*5??????e??4???^AV?-?L?_?=F)N?\????R??%II??b???cQ?^?C??E?XK???????b?.?$7bK?KKu??2H]E???I???/?'?%??!?P?r?/)?l|b?LH????b6???H-1?-?V=??X?*Z????]??S???o=??R?RK???'?5!q?R?jQ%??q$z9|?????????f?*???k9?TJp?!jh?jT#
+?H???????2f?"WQo?=?M??{?S|?`???If??_?L?&S??Pr?????L???!?????c?&???p?uu?2?*?|??0???`&???H'R{}C?i~cb/SrW|?????p<?M??*g^r???H?I??p4?m?M%???L?U??z?N?B?7m?????|G*???O?????O>?Jg?D?4?g???M|{<???|[???????tb? x/?J?????K?|s*?whd????(?7e?#??q?!5?N???[?z3??>??K?d???????4?BP??'?L?,??R?M?%?wb?l??<?O??A?F{????D???????C~o<??%?C#??0?????`??I'v???|O?7?+?'G$>B????p_????c???t?l???????i?? Y??}b???^ ????K???B! 4?J??????&P
5
+?>P2?q7???GAuCit)>JN?????2?????????l?`k[:qi?????Xp??!??&.?
+??
+	??bj??y?}4?.??Q8??"?@j??"?G?TM?>?(????C?3$????8????B?????????<??C?5?y?tN{??{??w?Y?e??\??
+???2???$y
+?2???D???k>?z??P???<???{??????4?.??p?,]?Y?p??*0??Yh?????????u?,^;s?S??%?D!?c?=%?b?GQ?\s??BJ<&?*3?????e???L?+]J?2GeVq*?J???T*?J?bTH?C???s9
+?n
+DO??k?'`?oQOb\~H?j'xc??O??3n??A???42?F?Q?hdN??d 
+^*`????N(????N?~S??7??Z?i?c`???????AiPbr????mM?z?z?e??*j(9?[?
+??F>&rmg?C?'?|d??e0?[rg??J??a(r?U/!?C@
+(0??M?`c?\??
+endstream
+endobj
+
+16 0 obj
+32784
+endobj
+
+17 0 obj
+<< /Type /FontDescriptor
+   /FontName /CAAAAA+TimesNewRomanPSMT
+   /Flags 6
+   /FontBBox [ -568 -306 2000 1007 ]
+   /ItalicAngle 0
+   /Ascent 891
+   /Descent 216
+   /CapHeight 1006
+   /StemV 80
+   /FontFile2 15 0 R
+>>
+endobj
+
+18 0 obj
+<< /Length 521
+   /Filter /FlateDecode >>
+stream
+x?]?M??0??H???U???R??% ??5?@?I?@???????^???3???C?Nj?c??c?????1???Xu
+???##?i??????G?y??q?????{????R?????4>????O?^~?0??E=???|u???p??te?j?y????U??6??|h???x?7????1%|aX[?7?6Tu???h?u??e??Q??????????]??j3????l$9??
+???0RRF???????y?v?|c?
+5?!'0???
+??????h,??(?I?k?O?&
+}R*?I?D???H?>%S??x?
+}>B?????
+}?(?q,?>????2??8?c9?B?am????'?G??>?r,?#P?	???xj???o?>???c??E-?o
+vO at C???1Z?x?8??br??q????^-W_???]??q?????./??????g??[?	?
+endstream
+endobj
+
+19 0 obj
+<< /Type /Font
+   /Subtype /TrueType
+   /BaseFont /CAAAAA+TimesNewRomanPSMT
+   /FirstChar 0
+   /LastChar 65
+   /Widths [ 777 556 277 443 500 277 500 333
+     443 250 500 277 443 500 500 500
+     443 277 443 443 500 277 722 889
+     610 250 722 333 777 389 500 443
+     500 500 500 500 443 500 500 333
+     250 443 556 722 722 722 500 389
+     500 427 722 333 333 333 389 610
+     666 500 500 500 646 666 500 610
+     277 610 ]
+   /FontDescriptor 17 0 R
+   /ToUnicode 18 0 R
+>>
+endobj
+
+20 0 obj
+<<
+   /F1 14 0 R
+   /F2 19 0 R
+   /F3 9 0 R
+>>
+endobj
+
+21 0 obj
+<<
+   /Font 20 0 R
+   /ProcSet [ /PDF /Text ]
+>>
+endobj
+
+1 0 obj
+<< /Type /Page
+   /Parent 4 0 R
+   /Resources 21 0 R
+   /MediaBox [ 0 0 595 842 ]
+   /Group << /S /Transparency /CS /DeviceRGB /I true >>
+   /Contents 2 0 R
+>>
+endobj
+
+22 0 obj
+<<
+   /Count 1
+   /First 23 0 R
+   /Last 23 0 R
+>>
+endobj
+
+23 0 obj
+<<
+   /Count 3
+   /First 24 0 R
+   /Last 26 0 R
+   /Title <FEFF0044004F004D0034004A002000610020005300410058>
+   /Dest [1 0 R /XYZ 56.7 773.3 0]
+   /Parent 22 0 R
+>>
+endobj
+
+24 0 obj
+<<
+   /Title <FEFF0044004F004D0034004A>
+   /Dest [1 0 R /XYZ 56.7 655.7 0]
+   /Parent 23 0 R
+   /Next 25 0 R
+>>
+endobj
+
+25 0 obj
+<<
+   /Title <FEFF005300410058>
+   /Dest [1 0 R /XYZ 56.7 300 0]
+   /Parent 23 0 R
+   /Prev 24 0 R
+   /Next 26 0 R
+>>
+endobj
+
+26 0 obj
+<<
+   /Title <FEFF005A00E10076011B00720020>
+   /Dest [1 0 R /XYZ 56.7 157.3 0]
+   /Parent 23 0 R
+   /Prev 25 0 R
+>>
+endobj
+
+4 0 obj
+<< /Type /Pages
+   /Resources 21 0 R
+   /MediaBox [ 0 0 595 842 ]
+   /Kids [ 1 0 R
+           ]
+   /Count 1
+>>
+endobj
+
+27 0 obj
+<< /Type /Catalog
+   /Pages 4 0 R
+   /Outlines 22 0 R
+>>
+endobj
+
+28 0 obj
+<< /Author <FEFF004500720069006B0020004B007200610074006F00630068007600ED006C>
+/Creator <FEFF005700720069007400650072>
+/Producer <FEFF004F00700065006E004F00660066006900630065002E006F0072006700200032002E0030>
+/CreationDate (D:20060909111904+02'00')
+>>
+endobj
+
+xref
+0 29
+0000000000 65535 f
+0000065591 00000 n
+0000000021 00000 n
+0000004800 00000 n
+0000066471 00000 n
+0000004827 00000 n
+0000017682 00000 n
+0000017708 00000 n
+0000017959 00000 n
+0000018340 00000 n
+0000018606 00000 n
+0000030277 00000 n
+0000030304 00000 n
+0000030548 00000 n
+0000030911 00000 n
+0000031158 00000 n
+0000064050 00000 n
+0000064077 00000 n
+0000064326 00000 n
+0000064932 00000 n
+0000065446 00000 n
+0000065518 00000 n
+0000065777 00000 n
+0000065853 00000 n
+0000066046 00000 n
+0000066184 00000 n
+0000066329 00000 n
+0000066608 00000 n
+0000066689 00000 n
+trailer
+<< /Size 29
+   /Root 27 0 R
+   /Info 28 0 R
+   /ID [ <47B77F09B0A920B2DB99564E324A730C>
+         <47B77F09B0A920B2DB99564E324A730C> ]
+>>
+startxref
+66964
+%%EOF

Added: trunk/documentation/release/vyvojova/Knihovny.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/Knihovny.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/Knihovny.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/Knihovny.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/RMI.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/RMI.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/RMI.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/RMI.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/todo.txt
===================================================================
--- trunk/documentation/release/vyvojova/todo.txt	2006-09-09 07:53:36 UTC (rev 773)
+++ trunk/documentation/release/vyvojova/todo.txt	2006-09-09 09:35:24 UTC (rev 774)
@@ -0,0 +1,4 @@
+Knihovny: 
+ * Poradne zdokumentovat vsechen obsah Plantlore\lib, 
+   tech knihoven je tam o dost vic! Kazdy at popise ty, 
+   ktere pridal.



From discontinuum at gmail.com  Sat Sep  9 12:29:43 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 9 Sep 2006 12:29:43 +0200
Subject: [Plantlore-dev] Developer's documentation - sections
Message-ID: <f4dc39b90609090329w7d41b34m8d2fa5a351923885@mail.gmail.com>

1. Plantlore Architecture Overview [EK]

 Prehled celkove architektury Plantlore - jeji vrstvy, ukoly
 slozeni, kde najit podrobny popis.

2. MVC in Plantlore [JK]

 Struktura MVC, zakomponovani v Plantlore, rozklad na tridy.
 Swing a tasky, dispatcher.

3. Database Layer [TK]

 Popis databazoveho modelu a databazove vrstvy.

4. Communication Layer & Server [EK]

 Komunikace "klient-server", proces prihlasovani.

5. Presentation Layer (Client)

 Prakticky popis casti z platnlore.client:

 5.1. Historie [EK for LO]
 5.2. Sprava autoru, publikaci, metadat, uzivatelu [TK]
       - z programatorskeho hlediska se jedna o uplne to same, cili
         popsat ty spolecne casti, v sekci o konkretni implementaci
         kdyztak zminit odlisnosti
 5.3. Vytvareni nove databaze [TK]
 5.4. Export [EK]
 5.5. Import nalezovych dat [EK]
 5.6. Import dat do tabulek [EK]
 5.7. Zakladni prehled v Plantlore [JK]
 5.8. Pridavani a editace nalezovych dat [JK]
 5.9. Checklist [EK]
 5.10. Generator schedy a tisk [JK]
 5.11. Nastaveni [JK]

6. Additional

 Popis zajimavych casti z plantlore.common, L10N, I18N. [JK, EK]

7. Build notes, installation [JK, TK]


Prace na Programatorske dokumentace se ucastnime predevsim my Kacka,
tedy EK, JK, TK.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060909/b1663784/attachment.html>

From krater at mail.berlios.de  Sat Sep  9 12:30:29 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 12:30:29 +0200
Subject: [Plantlore-dev] r775 - in trunk/documentation/release: developer
	vyvojova
Message-ID: <200609091030.k89AUThw024907@sheep.berlios.de>

Author: krater
Date: 2006-09-09 12:30:24 +0200 (Sat, 09 Sep 2006)
New Revision: 775

Added:
   trunk/documentation/release/developer/sections.txt
Modified:
   trunk/documentation/release/vyvojova/todo.txt
Log:
Updates to the lists of sections.

Added: trunk/documentation/release/developer/sections.txt
===================================================================
--- trunk/documentation/release/developer/sections.txt	2006-09-09 09:35:24 UTC (rev 774)
+++ trunk/documentation/release/developer/sections.txt	2006-09-09 10:30:24 UTC (rev 775)
@@ -0,0 +1,46 @@
+1. Plantlore Architecture Overview [EK]
+
+ Prehled celkove architektury Plantlore - jeji vrstvy, ukoly
+ slozeni, kde najit podrobny popis.
+
+2. MVC in Plantlore [JK]
+
+ Struktura MVC, zakomponovani v Plantlore, rozklad na tridy.
+ Swing a tasky, dispatcher.
+
+3. Database Layer [TK]
+
+ Popis databazoveho modelu a databazove vrstvy.
+
+4. Communication Layer & Server [EK]
+
+ Komunikace "klient-server", proces prihlasovani.
+
+5. Presentation Layer (Client)
+
+ Prakticky popis casti z platnlore.client:
+
+ 5.1. Historie [EK for LO]
+ 5.2. Sprava autoru, publikaci, metadat, uzivatelu [TK]
+       - z programatorskeho hlediska se jedna o uplne to same, cili
+         popsat ty spolecne casti, v sekci o konkretni implementaci
+         kdyztak zminit odlisnosti
+ 5.3. Vytvareni nove databaze [TK]
+ 5.4. Export [EK]
+ 5.5. Import nalezovych dat [EK]
+ 5.6. Import dat do tabulek [EK]
+ 5.7. Zakladni prehled v Plantlore [JK]
+ 5.8. Pridavani a editace nalezovych dat [JK]
+ 5.9. Checklist [EK]
+ 5.10. Generator schedy a tisk [JK]
+ 5.11. Nastaveni [JK]
+
+6. Additional
+
+ Popis zajimavych casti z plantlore.common, L10N, I18N. [JK, EK]
+
+7. Build notes, installation [JK, TK]
+
+
+Prace na Programatorske dokumentace se ucastnime predevsim my Kacka, 
+tedy EK, JK, TK.
\ No newline at end of file

Modified: trunk/documentation/release/vyvojova/todo.txt
===================================================================
--- trunk/documentation/release/vyvojova/todo.txt	2006-09-09 09:35:24 UTC (rev 774)
+++ trunk/documentation/release/vyvojova/todo.txt	2006-09-09 10:30:24 UTC (rev 775)
@@ -2,3 +2,13 @@
  * Poradne zdokumentovat vsechen obsah Plantlore\lib, 
    tech knihoven je tam o dost vic! Kazdy at popise ty, 
    ktere pridal.
+
+Nezapomenout zminku o:
+
+ * L10N
+ * I18N
+ * Help
+ * configuration
+ * swing, matisse
+ * Jasper
+ * instalator
\ No newline at end of file



From lada at mail.berlios.de  Sat Sep  9 13:42:57 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 9 Sep 2006 13:42:57 +0200
Subject: [Plantlore-dev] r776 - trunk/documentation
Message-ID: <200609091142.k89Bgv9X032672@sheep.berlios.de>

Author: lada
Date: 2006-09-09 13:42:14 +0200 (Sat, 09 Sep 2006)
New Revision: 776

Modified:
   trunk/documentation/uzivatelska_dokumentace4.odt
Log:
New screens.

Modified: trunk/documentation/uzivatelska_dokumentace4.odt
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Sat Sep  9 14:37:06 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 14:37:06 +0200
Subject: [Plantlore-dev] r777 - trunk/documentation/release/developer
Message-ID: <200609091237.k89Cb6ga005017@sheep.berlios.de>

Author: krater
Date: 2006-09-09 14:37:05 +0200 (Sat, 09 Sep 2006)
New Revision: 777

Added:
   trunk/documentation/release/developer/Plantlore Architecture Overview.odt
Log:
Plantlore Architecture Overview beta version.

Added: trunk/documentation/release/developer/Plantlore Architecture Overview.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Plantlore Architecture Overview.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Sat Sep  9 15:14:41 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 15:14:41 +0200
Subject: [Plantlore-dev] r778 - trunk/documentation/release/developer
Message-ID: <200609091314.k89DEf6u008287@sheep.berlios.de>

Author: krater
Date: 2006-09-09 15:14:40 +0200 (Sat, 09 Sep 2006)
New Revision: 778

Modified:
   trunk/documentation/release/developer/Plantlore Architecture Overview.odt
Log:
Plantlore Architecture Overview Realease Candidate.

Modified: trunk/documentation/release/developer/Plantlore Architecture Overview.odt
===================================================================
(Binary files differ)



From discontinuum at gmail.com  Sat Sep  9 15:49:37 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 9 Sep 2006 15:49:37 +0200
Subject: [Plantlore-dev] Par poznamek k dotazeni Uzivatelske dokumentace
Message-ID: <f4dc39b90609090649s433cd2e9u9f3f561c78074f30@mail.gmail.com>

   1. Sjednotit odkazy na tlacitka v textu. Napriklad ja pouzivam notaci:
   Stisknete tlacitko "Obnovit pripojeni" ... zatimco Jakub pouziva Stisknete
   tlacitko Obnovit pripojeni... a mozna ze Kovo treba pouziva Stisknete
   tlacitko Obnovit pripojeni... Jeden zpusob si vybrat a aplikovat na
   vsechny casti dokumentace. Je nutne toto sjednotit i v tech HTML castech!
   2. Ve finalnim pdf ani odt by se nemely nachazet hypertextove odkazy,
   protoze tam proste nefunguji. Odkazy je potreba zrusit a nahradit normalnim
   textem.
   3. Potreba pridat cisla stranek.
   4. Screenshot pro Skrtaci seznam na strane 21 obsahuje cary navic
   (bohuzel se mi vejde na obrazovku 140% dokumentu, takze to tam krasne
   vidim). Screenshot pro Skrtaci seznam na strane 22 je naprosto nic
   nerikajici a temer nijak se nelisi od predchoziho. Jeho smysl byl ukazat, ze
   se da udelat jakysi podseznam. Tzn. melo by na nem byt videt cca 10-20
   zaznamu, ze kterych muze uzivatel vybirat. Nevis-li Lado, jak toho docilit,
   tak me kontaktuj a ja ti dam navod.
   5. Screenshot Editace zaznamu na strane 11 ma stejny problem. Nemusis
   ho delat znova, muzes ho smazat, ale pak smaz i screenshot pro mazani
   zaznamu na strane 12.
   6. Screenshot na strane 14 obsahuje cary dole.
   7. Screenshot na strane 16 uprostred by mohl obsahovat inteligentnejsi
   obsah ne AAaapokus jako nejblizsi vetsi sidlo.
   8. Screenshot na strane 18 nahore by mohl taky obsahovat
   inteligentnejsi blizsi sidlo. Tez at ma bud vyplneny vsechny polozky (*)
   nebo zadnou (ne jen dve, jak to ma ted).
   9. Screenshot na strane 25 nahore obsahuje cary dole.
   10. Sprava autoru strana 26 obsahuje jeden bullet (takovou tu tecku)
   navic.
   11. Screenshot na strane 32 ukazujici pripstup ke Sprave metadat z
   menu. Nikde jinde v dokumentu se podobny screenshot nevyskytuje. Smazat nebo
   dodelat u vsech sekci.
   12. Stejne tak text popisujici, jak se da Sprava metadat vyvolat bud
   dopsat taky ke vsem sekcim (byl bych pro) nebo vymazat.
   13. Screenshot na strane 35 je zbytecny. Krom toho je taky spatne
   orezany.
   14. Sprava uzivatelu strana 36 viz poznamka 11. a 12.
   15. Screenshot na strane 39 je zbytecny.
   16. Historie nalezu strana 41 viz poznamka 11.
   17. Screenshot na strane 42 nahore je spatne orezan.
   18. Screenshot na strane 43 je spatne orezan.
   19. Strana 43 text v odstavci pod nadpisem 12.1.3. je potreba
   preformatovat spravne.
   20. Screenshot strana 44 dole viz poznamka 11.
   21. Screenshot strana 45 nahore spatne orezan.
   22. Screenshot strana 46 nahore spatne orezan.
   23. Stranka 52 je cela prazdna
   24. Screenshot na 53 by mel odpovidat popisku, pisu-li, ze je oznaceno
   11 zaznamu z 19ti, melo by tomu tak byt. Upravit screenshot nebo popis!
   25. Screenshot na strane 54 spatne orezan, totez na strane 55, 56, 58,
   59
   26. Strana 57 cela prazdna, stejne tak 62
   27. Vytvareni nove databaze str 63 viz poznamka 11.


Pevne doufam, ze ta komitnuta verze byla jakysi alfa pokus o napravu chyb,
protoze pri letmem 15timinutovem projiti jsem tam nasel pres 25 nedostatku.
Nevim, proc se tvuj commit Lado jmenoval nove screenshoty, kdyz na nich
skoro nic noveho neni, ba primo naopak hyri starymi nedostatky!
Ja se modlim, aby oponent nebyl takovy pedanticky kokot jako sem ja, protoze
jinak mu bude okamzite jasne, jak moc je to odflakly. Aspon na prvni pohled
by to snad mohlo pusobit trochu jednotne a upravene! Nevim, jakej mas Lado
problem s tim nastavit v tom DragIt8, aby snimal jenom aktivni okno, kde bys
zadny orezavani nebyla nucena delat rucne. Opravit tech par screenshotu je
pak otazka pul hodiny :( Chapu, proc prekladat nechces, a beru to, ale mohla
bys aspon teda zkusit rozumne dotahnout tu uzivatelskou dokumentaci, uz jen
proto, ze po ni oponent touzil a bude ji zrejme chtit i pouzivat, a zvlast
proto, ze na tom nic extremne tezkyho neni.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060909/304caa61/attachment.html>

From fraktalek at mail.berlios.de  Sat Sep  9 17:14:49 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 9 Sep 2006 17:14:49 +0200
Subject: [Plantlore-dev] r779 - in trunk: documentation src
	src/net/sf/plantlore/config
Message-ID: <200609091514.k89FEn76021306@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-09 17:14:47 +0200 (Sat, 09 Sep 2006)
New Revision: 779

Modified:
   trunk/documentation/MVCandGUIcommunicationLayer.odt
   trunk/src/hibernate.cfg.xml
   trunk/src/net/sf/plantlore/config/log4j.properties
Log:
Updated the MVC and GUI comm. layer. A little more information added and the diagrams are now white and redrawn.

I also commit the low-logging settings that include the logging to a file and that are hopefully used in the final installation that we burnt on Friday.



Modified: trunk/documentation/MVCandGUIcommunicationLayer.odt
===================================================================
(Binary files differ)

Modified: trunk/src/hibernate.cfg.xml
===================================================================
--- trunk/src/hibernate.cfg.xml	2006-09-09 13:14:40 UTC (rev 778)
+++ trunk/src/hibernate.cfg.xml	2006-09-09 15:14:47 UTC (rev 779)
@@ -6,7 +6,7 @@
    <session-factory>
 
       <!-- Database connection settings -->
-      <property name="show_sql">true</property>
+      <property name="show_sql">false</property>
       <property name="hibernate.dialect">
          org.hibernate.dialect.PostgreSQLDialect
       </property>

Modified: trunk/src/net/sf/plantlore/config/log4j.properties
===================================================================
--- trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-09 13:14:40 UTC (rev 778)
+++ trunk/src/net/sf/plantlore/config/log4j.properties	2006-09-09 15:14:47 UTC (rev 779)
@@ -1,5 +1,5 @@
 ### set log levels - for more verbose logging change 'info' to 'debug' ###
-log4j.rootLogger=debug, stdout
+log4j.rootLogger=warn, file
 
 ### direct log messages to stdout ###
 log4j.appender.stdout=org.apache.log4j.ConsoleAppender
@@ -7,6 +7,12 @@
 log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
 log4j.appender.stdout.layout.ConversionPattern=%d{ABSOLUTE} %5p %t %c{1}:%L - %m%n
 
+log4j.appender.file=org.apache.log4j.FileAppender
+log4j.appender.file.File=plantlore.log
+log4j.appender.file.layout=org.apache.log4j.PatternLayout
+log4j.appender.file.layout.ConversionPattern=%d{ABSOLUTE} %5p %t %c{1}:%L - %m%n
+
+
 ### direct messages to file hibernate.log ###
 #log4j.appender.file=org.apache.log4j.FileAppender
 #log4j.appender.file.File=hibernate.log
@@ -29,19 +35,19 @@
 #log4j.logger.org.hibernate.type=debug
 
 ### log schema export/update ###
-#log4j.logger.org.hibernate.tool.hbm2ddl=debug
+log4j.logger.org.hibernate.tool.hbm2ddl=error
 
 ### log HQL parse trees
-#log4j.logger.org.hibernate.hql=debug
+log4j.logger.org.hibernate.hql=error
 
 ### log cache activity ###
-#log4j.logger.org.hibernate.cache=debug
+log4j.logger.org.hibernate.cache=error
 
 ### log transaction activity
-#log4j.logger.org.hibernate.transaction=debug
+log4j.logger.org.hibernate.transaction=error
 
 ### log JDBC resource acquisition
-#log4j.logger.org.hibernate.jdbc=debug
+log4j.logger.org.hibernate.jdbc=error
 
 ### enable the following line if you want to track down connection ###
 ### leakages when using DriverManagerConnectionProvider ###



From krater at mail.berlios.de  Sat Sep  9 19:11:23 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 19:11:23 +0200
Subject: [Plantlore-dev] r780 - trunk/documentation/release/developer
Message-ID: <200609091711.k89HBNgI019002@sheep.berlios.de>

Author: krater
Date: 2006-09-09 19:11:22 +0200 (Sat, 09 Sep 2006)
New Revision: 780

Added:
   trunk/documentation/release/developer/Communication Layer.odt
   trunk/documentation/release/developer/Communication Layer.pdf
Log:
The Communication layer.

Added: trunk/documentation/release/developer/Communication Layer.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Communication Layer.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Communication Layer.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Communication Layer.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Sat Sep  9 19:28:18 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sat, 9 Sep 2006 19:28:18 +0200
Subject: [Plantlore-dev] r781 -
	trunk/src/net/sf/plantlore/help/cs/html/picture
Message-ID: <200609091728.k89HSI5d005338@sheep.berlios.de>

Author: lada
Date: 2006-09-09 19:27:33 +0200 (Sat, 09 Sep 2006)
New Revision: 781

Added:
   trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsAdd.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsMain.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBAuth.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBMain.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsAdd.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsMain.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userEnter_cs.png
Removed:
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview_sorting.png
Modified:
   trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistDefault.jpg
   trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistUsage.jpg
   trunk/src/net/sf/plantlore/help/cs/html/picture/ExportProgress.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingColumns.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingRecords.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSupplyingName.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginAddMenu.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginAuthentication.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBDirectConnection.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBRemoteConnection.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBSelection.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDeleteMenu.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/LoginEditMenu.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ServerConnect.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ServerCreate.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/ServerManager.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_table_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_place_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/habitat_tree_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/historyEnter_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/historyOccMark_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/historyOcc_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/historyUndo_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/metadataAdd_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/metadataDelete_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/metadataDialog_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/metadataEnter_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview_detail.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview_second_toolbar.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview_selecting.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/search_dialog_extended_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/search_dialog_simple_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/settings_columns_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/settings_languages_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/settings_scheda_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userAdd_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userDialog_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userDrop_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userEdit_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/userRight_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryDetail_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryDialog_cs.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryEnter_cs.png
Log:
Update screens.

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/AuthorsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistDefault.jpg
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistUsage.jpg
===================================================================
(Binary files differ)

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBAuth.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBAuth.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/CreateDBMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ExportProgress.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingColumns.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingRecords.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSupplyingName.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginAddMenu.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginAuthentication.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBDirectConnection.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBRemoteConnection.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDBSelection.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginDeleteMenu.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/LoginEditMenu.png
===================================================================
(Binary files differ)

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/PublicationsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ServerConnect.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ServerCreate.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ServerManager.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_table_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_place_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/habitat_tree_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/historyEnter_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/historyOccMark_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/historyOcc_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/historyUndo_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/metadataAdd_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/metadataDelete_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/metadataDialog_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/metadataEnter_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview_detail.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview_second_toolbar.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview_selecting.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/cs/html/picture/overview_sorting.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/search_dialog_extended_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/search_dialog_simple_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/settings_columns_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/settings_languages_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/settings_scheda_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/userAdd_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/userDialog_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/userDrop_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/userEdit_cs.png
===================================================================
(Binary files differ)

Added: trunk/src/net/sf/plantlore/help/cs/html/picture/userEnter_cs.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/cs/html/picture/userEnter_cs.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/userRight_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryDetail_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryDialog_cs.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/wholeHistoryEnter_cs.png
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Sat Sep  9 23:36:40 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sat, 9 Sep 2006 23:36:40 +0200
Subject: [Plantlore-dev] r782 - trunk/documentation/release/developer
Message-ID: <200609092136.k89Lae8m030507@sheep.berlios.de>

Author: krater
Date: 2006-09-09 23:36:39 +0200 (Sat, 09 Sep 2006)
New Revision: 782

Added:
   trunk/documentation/release/developer/Server.odt
   trunk/documentation/release/developer/Server.pdf
Log:
Server, Server manager, Creating a new database layer from the server side's view.

Added: trunk/documentation/release/developer/Server.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Server.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Server.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Server.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Sun Sep 10 08:52:26 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sun, 10 Sep 2006 08:52:26 +0200
Subject: [Plantlore-dev] r783 - in trunk/documentation: .
	release/uzivatelska/complete
Message-ID: <200609100652.k8A6qQfe020768@sheep.berlios.de>

Author: lada
Date: 2006-09-10 08:50:51 +0200 (Sun, 10 Sep 2006)
New Revision: 783

Added:
   trunk/documentation/release/uzivatelska/complete/userDocumentation.odt
   trunk/documentation/release/uzivatelska/complete/userDocumentation.pdf
Removed:
   trunk/documentation/uzivatelska_dokumentace4.odt
   trunk/documentation/uzivatelska_dokumentace4.pdf
Log:


Added: trunk/documentation/release/uzivatelska/complete/userDocumentation.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/uzivatelska/complete/userDocumentation.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/uzivatelska/complete/userDocumentation.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/uzivatelska/complete/userDocumentation.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Deleted: trunk/documentation/uzivatelska_dokumentace4.odt
===================================================================
(Binary files differ)

Deleted: trunk/documentation/uzivatelska_dokumentace4.pdf
===================================================================
(Binary files differ)



From lada at mail.berlios.de  Sun Sep 10 09:01:51 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sun, 10 Sep 2006 09:01:51 +0200
Subject: [Plantlore-dev] r784 -
	trunk/src/net/sf/plantlore/help/en/html/images
Message-ID: <200609100701.k8A71p3n021572@sheep.berlios.de>

Author: lada
Date: 2006-09-10 09:01:10 +0200 (Sun, 10 Sep 2006)
New Revision: 784

Added:
   trunk/src/net/sf/plantlore/help/en/html/images/AuthorsAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/AuthorsMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ChecklistDefault.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/ChecklistUsage.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/CreateDBAuth.png
   trunk/src/net/sf/plantlore/help/en/html/images/CreateDBMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingColumns.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingRecords.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSupplyingName.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginAddMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginAuthentication.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBDirectConnection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBRemoteConnection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBSelection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDeleteMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginEditMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/PublicationsAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/PublicationsMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerConnect.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerCreate.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerManager.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence_table.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_place.png
   trunk/src/net/sf/plantlore/help/en/html/images/habitat_tree.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyOcc.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyOccMark.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyUndo.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataDelete.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataEdit.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_detail.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_second_toolbar.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_selecting.png
   trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_extended.png
   trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_simple.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_columns.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_languages.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_scheda.png
   trunk/src/net/sf/plantlore/help/en/html/images/userAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/userDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/userDrop.png
   trunk/src/net/sf/plantlore/help/en/html/images/userEdit.png
   trunk/src/net/sf/plantlore/help/en/html/images/userEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/userRight.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDetail.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryEnter.png
Removed:
   trunk/src/net/sf/plantlore/help/en/html/images/ExportColumns.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/ExportFileFormat.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/Server1.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/Server2.jpg
Log:
Add new screens for eng version of help. 
The same images are for default version of help ( You can copy images from en help to default help in locale PC).
The help text has to be modified - the name of images has been modified ( _cs and _cz has been deleted).

Added: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistDefault.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistDefault.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistUsage.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistUsage.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBAuth.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBAuth.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportColumns.jpg
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportFileFormat.jpg
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.jpg
===================================================================
(Binary files differ)

Added: trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingColumns.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingColumns.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingRecords.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingRecords.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ExportSupplyingName.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ExportSupplyingName.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginAddMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginAddMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginAuthentication.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginAuthentication.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBDirectConnection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBDirectConnection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBRemoteConnection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBRemoteConnection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBSelection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBSelection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginDeleteMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginDeleteMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/LoginEditMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/LoginEditMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/Server1.jpg
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/Server2.jpg
===================================================================
(Binary files differ)

Added: trunk/src/net/sf/plantlore/help/en/html/images/ServerConnect.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ServerConnect.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ServerCreate.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ServerCreate.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/ServerManager.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/ServerManager.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence_table.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence_table.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/addedit_place.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/addedit_place.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/habitat_tree.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/habitat_tree.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/historyEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/historyEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/historyOcc.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/historyOcc.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/historyOccMark.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/historyOccMark.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/historyUndo.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/historyUndo.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/metadataAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/metadataAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/metadataDelete.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/metadataDelete.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/metadataDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/metadataDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/metadataEdit.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/metadataEdit.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/metadataEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/metadataEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/overview.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/overview.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/overview_detail.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/overview_detail.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/overview_second_toolbar.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/overview_second_toolbar.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/overview_selecting.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/overview_selecting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_extended.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_extended.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_simple.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_simple.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/settings_columns.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/settings_columns.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/settings_languages.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/settings_languages.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/settings_scheda.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/settings_scheda.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userDrop.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userDrop.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userEdit.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userEdit.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/userRight.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/userRight.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDetail.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDetail.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Sun Sep 10 12:44:12 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 10 Sep 2006 12:44:12 +0200
Subject: [Plantlore-dev] r785 - trunk/documentation/release/developer
Message-ID: <200609101044.k8AAiCrv005543@sheep.berlios.de>

Author: krater
Date: 2006-09-10 12:44:08 +0200 (Sun, 10 Sep 2006)
New Revision: 785

Added:
   trunk/documentation/release/developer/Login.odt
   trunk/documentation/release/developer/Login.pdf
Modified:
   trunk/documentation/release/developer/Server.odt
   trunk/documentation/release/developer/Server.pdf
Log:
Server - removed errors. Login described.

Added: trunk/documentation/release/developer/Login.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Login.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Login.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Login.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/documentation/release/developer/Server.odt
===================================================================
(Binary files differ)

Modified: trunk/documentation/release/developer/Server.pdf
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Sun Sep 10 14:28:09 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 10 Sep 2006 14:28:09 +0200
Subject: [Plantlore-dev] r786 - trunk/documentation/release/developer
Message-ID: <200609101228.k8ACS91J019460@sheep.berlios.de>

Author: krater
Date: 2006-09-10 14:28:06 +0200 (Sun, 10 Sep 2006)
New Revision: 786

Added:
   trunk/documentation/release/developer/Export.odt
   trunk/documentation/release/developer/Export.pdf
Log:
Export

Added: trunk/documentation/release/developer/Export.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Export.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Export.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Export.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Sun Sep 10 16:55:00 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sun, 10 Sep 2006 16:55:00 +0200
Subject: [Plantlore-dev] r787 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609101455.k8AEt0gZ000764@sheep.berlios.de>

Author: lada
Date: 2006-09-10 16:55:00 +0200 (Sun, 10 Sep 2006)
New Revision: 787

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Add missing text.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-10 12:28:06 UTC (rev 786)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-10 14:55:00 UTC (rev 787)
@@ -1793,3 +1793,9 @@
 Publications.SelectPublication=Please select publication
 
 Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet
+
+AUTHOR.role.identified=identified
+
+AUTHOR.role.other=not specified
+
+UserMnager.SearchPanel=Search panel

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-10 12:28:06 UTC (rev 786)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-10 14:55:00 UTC (rev 787)
@@ -2159,3 +2159,9 @@
 Publications.SelectPublication=Vyberte pros\u00EDm publikaci
 
 Error.CreateDatabase=Nebylo mo\u017En\u00E9 vytvo\u0159it datab\u00E1zi. Skontrolujte zadan\u00E9 autentifika\u0107n\u00ED \u00FAdaje a to, jestli tato datab\u00E1ze u\u017E neexistuje
+
+AUTHOR.role.identified=identifikoval
+
+AUTHOR.role.other=neuvedeno
+
+UserMnager.SearchPanel=Vyhled\u00E1vac\u00ED panel

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-10 12:28:06 UTC (rev 786)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-10 14:55:00 UTC (rev 787)
@@ -1648,3 +1648,9 @@
 Publications.SelectPublication=Please select publication
 
 Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet
+
+AUTHOR.role.identified=identified
+
+AUTHOR.role.other=not specified
+
+UserMnager.SearchPanel=Search panel



From fraktalek at mail.berlios.de  Sun Sep 10 19:31:14 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 10 Sep 2006 19:31:14 +0200
Subject: [Plantlore-dev] r788 - trunk/documentation/release/developer
Message-ID: <200609101731.k8AHVEhr018285@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-10 19:31:14 +0200 (Sun, 10 Sep 2006)
New Revision: 788

Added:
   trunk/documentation/release/developer/Deployment.odt
   trunk/documentation/release/developer/MVCandGUIcommunicationLayer.odt
   trunk/documentation/release/developer/Overview.odt
   trunk/documentation/release/developer/TaskAndDispatcher.odt
Log:


Added: trunk/documentation/release/developer/Deployment.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Deployment.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/MVCandGUIcommunicationLayer.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/MVCandGUIcommunicationLayer.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Overview.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Overview.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/TaskAndDispatcher.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/TaskAndDispatcher.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Sun Sep 10 20:45:09 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 10 Sep 2006 20:45:09 +0200
Subject: [Plantlore-dev] r789 - trunk/documentation/release/developer
Message-ID: <200609101845.k8AIj9fU025603@sheep.berlios.de>

Author: krater
Date: 2006-09-10 20:45:06 +0200 (Sun, 10 Sep 2006)
New Revision: 789

Added:
   trunk/documentation/release/developer/Import - Immutable Tables.odt
   trunk/documentation/release/developer/Import - Immutable Tables.pdf
Log:
Immutable tables Import 

Added: trunk/documentation/release/developer/Import - Immutable Tables.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Import - Immutable Tables.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/Import - Immutable Tables.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Import - Immutable Tables.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Sun Sep 10 21:04:52 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 10 Sep 2006 21:04:52 +0200
Subject: [Plantlore-dev] r790 - trunk/documentation/release/developer
Message-ID: <200609101904.k8AJ4qw7027928@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-10 21:04:52 +0200 (Sun, 10 Sep 2006)
New Revision: 790

Added:
   trunk/documentation/release/developer/AddEditSearch.odt
Log:
Revised


Added: trunk/documentation/release/developer/AddEditSearch.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/AddEditSearch.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Sun Sep 10 21:30:00 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Sun, 10 Sep 2006 21:30:00 +0200
Subject: [Plantlore-dev] r791 -
	trunk/documentation/release/uzivatelska/complete
Message-ID: <200609101930.k8AJU0KL030480@sheep.berlios.de>

Author: lada
Date: 2006-09-10 21:27:14 +0200 (Sun, 10 Sep 2006)
New Revision: 791

Modified:
   trunk/documentation/release/uzivatelska/complete/userDocumentation.odt
   trunk/documentation/release/uzivatelska/complete/userDocumentation.pdf
Log:
Add header and footer (add number of pages).
Use only bullets.
Add user and administration doc for web client.

Modified: trunk/documentation/release/uzivatelska/complete/userDocumentation.odt
===================================================================
(Binary files differ)

Modified: trunk/documentation/release/uzivatelska/complete/userDocumentation.pdf
===================================================================
(Binary files differ)



From krater at mail.berlios.de  Sun Sep 10 22:13:32 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 10 Sep 2006 22:13:32 +0200
Subject: [Plantlore-dev] r792 - trunk/documentation/release/developer
Message-ID: <200609102013.k8AKDW9b002250@sheep.berlios.de>

Author: krater
Date: 2006-09-10 22:13:30 +0200 (Sun, 10 Sep 2006)
New Revision: 792

Added:
   trunk/documentation/release/developer/OccurrenceImport.odt
   trunk/documentation/release/developer/OccurrenceImport.pdf
Log:
Occurrence import

Added: trunk/documentation/release/developer/OccurrenceImport.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/OccurrenceImport.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/OccurrenceImport.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/OccurrenceImport.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Sun Sep 10 22:43:51 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 10 Sep 2006 22:43:51 +0200
Subject: [Plantlore-dev] r793 - trunk/documentation/release/vyvojova
Message-ID: <200609102043.k8AKhpWI005388@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-10 22:43:51 +0200 (Sun, 10 Sep 2006)
New Revision: 793

Added:
   trunk/documentation/release/vyvojova/JasperReports_L10nI18n.odt
   trunk/documentation/release/vyvojova/SwingMatisse.odt
Log:
nove


Added: trunk/documentation/release/vyvojova/JasperReports_L10nI18n.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/JasperReports_L10nI18n.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/SwingMatisse.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/SwingMatisse.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Sun Sep 10 23:00:59 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sun, 10 Sep 2006 23:00:59 +0200
Subject: [Plantlore-dev] r794 - trunk/documentation/release/developer
Message-ID: <200609102100.k8AL0xXP006876@sheep.berlios.de>

Author: kovo
Date: 2006-09-10 23:00:54 +0200 (Sun, 10 Sep 2006)
New Revision: 794

Added:
   trunk/documentation/release/developer/DBLayer.odt
Log:
New version of DBLayer documentation

Added: trunk/documentation/release/developer/DBLayer.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/DBLayer.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Sun Sep 10 23:39:19 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Sun, 10 Sep 2006 23:39:19 +0200
Subject: [Plantlore-dev] r795 - trunk/documentation/release/developer
Message-ID: <200609102139.k8ALdJbD010831@sheep.berlios.de>

Author: kovo
Date: 2006-09-10 23:39:18 +0200 (Sun, 10 Sep 2006)
New Revision: 795

Modified:
   trunk/documentation/release/developer/DBLayer.odt
Log:
DBLayer documentation update. Bullet lists transformed to tables

Modified: trunk/documentation/release/developer/DBLayer.odt
===================================================================
(Binary files differ)



From fraktalek at mail.berlios.de  Sun Sep 10 23:41:05 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 10 Sep 2006 23:41:05 +0200
Subject: [Plantlore-dev] r796 - trunk/documentation/release/developer
Message-ID: <200609102141.k8ALf5H8011140@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-10 23:41:05 +0200 (Sun, 10 Sep 2006)
New Revision: 796

Added:
   trunk/documentation/release/developer/Settings.odt
Log:
revised


Added: trunk/documentation/release/developer/Settings.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/Settings.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream



From fraktalek at mail.berlios.de  Mon Sep 11 00:26:25 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 11 Sep 2006 00:26:25 +0200
Subject: [Plantlore-dev] r797 - trunk/documentation/release/developer
Message-ID: <200609102226.k8AMQPGF015926@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-11 00:26:24 +0200 (Mon, 11 Sep 2006)
New Revision: 797

Added:
   trunk/documentation/release/developer/PrintingAndScheda.odt
Log:
Revised


Added: trunk/documentation/release/developer/PrintingAndScheda.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/PrintingAndScheda.odt
___________________________________________________________________
Name: svn:executable
   + *
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Mon Sep 11 00:43:40 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 11 Sep 2006 00:43:40 +0200
Subject: [Plantlore-dev] r798 - trunk/documentation/release/developer
Message-ID: <200609102243.k8AMhem3018503@sheep.berlios.de>

Author: kovo
Date: 2006-09-11 00:43:40 +0200 (Mon, 11 Sep 2006)
New Revision: 798

Added:
   trunk/documentation/release/developer/DataManagers.odt
Log:
Description of data managers (author, publication, metdata, user)

Added: trunk/documentation/release/developer/DataManagers.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/DataManagers.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Mon Sep 11 01:24:45 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 11 Sep 2006 01:24:45 +0200
Subject: [Plantlore-dev] r799 - trunk/documentation/release/developer
Message-ID: <200609102324.k8ANOjlj008221@sheep.berlios.de>

Author: krater
Date: 2006-09-11 01:24:43 +0200 (Mon, 11 Sep 2006)
New Revision: 799

Added:
   trunk/documentation/release/developer/history.odt
   trunk/documentation/release/developer/history.pdf
Log:
history

Added: trunk/documentation/release/developer/history.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/history.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/history.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/history.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Mon Sep 11 02:01:59 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 11 Sep 2006 02:01:59 +0200
Subject: [Plantlore-dev] r800 - trunk/documentation/release/developer
Message-ID: <200609110001.k8B01xSK032201@sheep.berlios.de>

Author: lada
Date: 2006-09-11 02:01:56 +0200 (Mon, 11 Sep 2006)
New Revision: 800

Added:
   trunk/documentation/release/developer/dev_BioCase.odt
Log:
Add developer doc about BioCASE.

Added: trunk/documentation/release/developer/dev_BioCase.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/dev_BioCase.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Mon Sep 11 02:47:28 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 11 Sep 2006 02:47:28 +0200
Subject: [Plantlore-dev] r801 - trunk/src/net/sf/plantlore/client
Message-ID: <200609110047.k8B0lSlM006080@sheep.berlios.de>

Author: kovo
Date: 2006-09-11 02:47:27 +0200 (Mon, 11 Sep 2006)
New Revision: 801

Modified:
   trunk/src/net/sf/plantlore/client/Plantlore.java
Log:
Deactivate Memory monitor and Connections monitor

Modified: trunk/src/net/sf/plantlore/client/Plantlore.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-11 00:01:56 UTC (rev 800)
+++ trunk/src/net/sf/plantlore/client/Plantlore.java	2006-09-11 00:47:27 UTC (rev 801)
@@ -98,7 +98,7 @@
         
         plantlore.run();
                
-        new MemoryMonitor();        
+        // new MemoryMonitor();        
       
     }
     
@@ -162,7 +162,7 @@
             //new ExceptionDialog(view,"Some exception was thrown: "+e);
             e.printStackTrace();
         }
-        new ConnectionMonitor(model);        
+        // new ConnectionMonitor(model);        
     }
     
     /**



From lada at mail.berlios.de  Mon Sep 11 04:30:05 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 11 Sep 2006 04:30:05 +0200
Subject: [Plantlore-dev] r802 - trunk/documentation/release/developer
Message-ID: <200609110230.k8B2U5vE019440@sheep.berlios.de>

Author: lada
Date: 2006-09-11 04:30:05 +0200 (Mon, 11 Sep 2006)
New Revision: 802

Added:
   trunk/documentation/release/developer/coordinateSystem.odt
Log:
Add doc about transformation coordinate System.

Added: trunk/documentation/release/developer/coordinateSystem.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/coordinateSystem.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From kovo at mail.berlios.de  Mon Sep 11 04:37:56 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 11 Sep 2006 04:37:56 +0200
Subject: [Plantlore-dev] r803 - in trunk/src/net/sf/plantlore: client
	client/createdb client/settings common help/cs help/cs/html
	help/en help/en/html l10n
Message-ID: <200609110237.k8B2buvw020072@sheep.berlios.de>

Author: kovo
Date: 2006-09-11 04:37:54 +0200 (Mon, 11 Sep 2006)
New Revision: 803

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
   trunk/src/net/sf/plantlore/client/settings/SettingsCtrl.java
   trunk/src/net/sf/plantlore/client/settings/SettingsView.form
   trunk/src/net/sf/plantlore/client/settings/SettingsView.java
   trunk/src/net/sf/plantlore/common/PlantloreHelp.java
   trunk/src/net/sf/plantlore/help/cs/html/author.html
   trunk/src/net/sf/plantlore/help/cs/html/login.html
   trunk/src/net/sf/plantlore/help/cs/html/publication.html
   trunk/src/net/sf/plantlore/help/cs/html/resources.html
   trunk/src/net/sf/plantlore/help/cs/html/server.html
   trunk/src/net/sf/plantlore/help/cs/jhelpidx.xml
   trunk/src/net/sf/plantlore/help/en/html/author.html
   trunk/src/net/sf/plantlore/help/en/html/publication.html
   trunk/src/net/sf/plantlore/help/en/jhelpidx.xml
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Minor fixes of L10n and help

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-11 02:37:54 UTC (rev 803)
@@ -451,12 +451,12 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace min="-2" pref="123" max="-2" attributes="0"/>
-                      <Component id="prevPage" min="-2" max="-2" attributes="0"/>
+                      <Component id="prevPage" min="-2" pref="100" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="recordsPerPage" min="-2" pref="45" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
-                      <Component id="nextPage" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="371" max="32767" attributes="0"/>
+                      <Component id="nextPage" min="-2" pref="100" max="-2" attributes="0"/>
+                      <EmptySpace pref="317" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -540,7 +540,7 @@
         </DimensionLayout>
         <DimensionLayout dim="1">
           <Group type="103" groupAlignment="0" attributes="0">
-              <Component id="overviewScrollPane" alignment="0" pref="188" max="32767" attributes="0"/>
+              <Component id="overviewScrollPane" alignment="0" pref="157" max="32767" attributes="0"/>
           </Group>
         </DimensionLayout>
       </Layout>

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-11 02:37:54 UTC (rev 803)
@@ -220,12 +220,12 @@
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel3Layout.createSequentialGroup()
                 .add(123, 123, 123)
-                .add(prevPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(prevPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(recordsPerPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(nextPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(371, Short.MAX_VALUE))
+                .add(nextPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addContainerGap(317, Short.MAX_VALUE))
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -266,7 +266,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 188, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 157, Short.MAX_VALUE)
         );
 
         recordsCount.setText("-");

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.form	2006-09-11 02:37:54 UTC (rev 803)
@@ -26,7 +26,7 @@
                   <Component id="jPanel1" alignment="0" max="32767" attributes="0"/>
                   <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="138" max="32767" attributes="0"/>
+                      <EmptySpace pref="156" max="32767" attributes="0"/>
                       <Component id="next" linkSize="1" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="1" min="-2" max="-2" attributes="0"/>

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBView.java	2006-09-11 02:37:54 UTC (rev 803)
@@ -29,10 +29,10 @@
     	
         setLocationRelativeTo(null); // center of the screen
         getRootPane().setDefaultButton(next);
-        /*
+        
         PlantloreHelp.addKeyHelp(PlantloreHelp.CREATE_DB, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.CREATE_DB, this.help);
-        */
+        
         new DefaultEscapeKeyPressed( this );
         
         DocumentSizeFilter.patch(databaseAlias, 50);

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsCtrl.java	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsCtrl.java	2006-09-11 02:37:54 UTC (rev 803)
@@ -105,7 +105,7 @@
                 return;
             }
             if (s.equals("HELP")) {
-                System.out.println("Tady se bude volat Help!");
+
                 return;
             }
             if (s.equals("CANCEL")) {

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.form	2006-09-11 02:37:54 UTC (rev 803)
@@ -84,6 +84,11 @@
       </SubComponents>
     </Container>
   </NonVisualComponents>
+  <Properties>
+    <Property name="title" type="java.lang.String" editor="org.netbeans.modules.form.RADConnectionPropertyEditor">
+      <Connection code="L10n.getString(&quot;Settings.Title&quot;)" type="code"/>
+    </Property>
+  </Properties>
   <SyntheticProperties>
     <SyntheticProperty name="formSizePolicy" type="int" value="1"/>
   </SyntheticProperties>
@@ -101,7 +106,7 @@
           <Group type="102" alignment="1" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
               <Component id="helpButton" linkSize="1" min="-2" max="-2" attributes="0"/>
-              <EmptySpace pref="367" max="32767" attributes="0"/>
+              <EmptySpace pref="401" max="32767" attributes="0"/>
               <Component id="okButton" linkSize="1" min="-2" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Component id="cancelButton" linkSize="1" min="-2" max="-2" attributes="0"/>
@@ -156,7 +161,7 @@
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jPanel2" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="144" max="32767" attributes="0"/>
+                      <EmptySpace pref="129" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -183,7 +188,7 @@
                               <Component id="czechRadioButton" alignment="0" min="-2" max="-2" attributes="0"/>
                               <Component id="defaultRadioButton" alignment="0" min="-2" max="-2" attributes="0"/>
                           </Group>
-                          <EmptySpace pref="508" max="32767" attributes="0"/>
+                          <EmptySpace pref="510" max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -282,7 +287,7 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace max="-2" attributes="0"/>
-                      <Component id="jPanel4" pref="593" max="32767" attributes="0"/>
+                      <Component id="jPanel4" pref="597" max="32767" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                   </Group>
               </Group>
@@ -291,7 +296,7 @@
               <Group type="103" groupAlignment="0" attributes="0">
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace max="-2" attributes="0"/>
-                      <Component id="jPanel4" pref="272" max="32767" attributes="0"/>
+                      <Component id="jPanel4" pref="273" max="32767" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                   </Group>
               </Group>
@@ -496,7 +501,7 @@
                   <Group type="102" alignment="0" attributes="0">
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="jPanel6" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="159" max="32767" attributes="0"/>
+                      <EmptySpace pref="146" max="32767" attributes="0"/>
                   </Group>
               </Group>
             </DimensionLayout>
@@ -527,7 +532,7 @@
                               <Component id="headerOneField" alignment="0" min="-2" pref="472" max="-2" attributes="0"/>
                               <Component id="headerTwoField" alignment="0" min="-2" pref="473" max="-2" attributes="0"/>
                           </Group>
-                          <EmptySpace max="32767" attributes="0"/>
+                          <EmptySpace pref="26" max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>

Modified: trunk/src/net/sf/plantlore/client/settings/SettingsView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/client/settings/SettingsView.java	2006-09-11 02:37:54 UTC (rev 803)
@@ -15,6 +15,7 @@
 import net.sf.plantlore.client.*;
 import net.sf.plantlore.client.overview.Column;
 import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -33,6 +34,8 @@
         setLabels();
         loadValues();
         setLocationRelativeTo(parent);
+        PlantloreHelp.addKeyHelp(PlantloreHelp.SETTINGS, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.SETTINGS, this.helpButton);
         new DefaultEscapeKeyPressed(this);
     }
     
@@ -189,6 +192,7 @@
                 .addContainerGap(160, Short.MAX_VALUE))
         );
 
+        setTitle(L10n.getString("Settings.Title"));
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString("Settings.LanguagePanel")));
         languagesButtonGroup.add(englishRadioButton);
         englishRadioButton.setText("English");
@@ -218,7 +222,7 @@
                     .add(englishRadioButton)
                     .add(czechRadioButton)
                     .add(defaultRadioButton))
-                .addContainerGap(508, Short.MAX_VALUE))
+                .addContainerGap(510, Short.MAX_VALUE))
         );
         jPanel2Layout.setVerticalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -246,7 +250,7 @@
             .add(jPanel1Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(144, Short.MAX_VALUE))
+                .addContainerGap(129, Short.MAX_VALUE))
         );
         jTabbedPane1.addTab(L10n.getString("Settings.LanguagesTab"), jPanel1);
 
@@ -341,14 +345,14 @@
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel3Layout.createSequentialGroup()
                 .addContainerGap()
-                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 593, Short.MAX_VALUE)
+                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 597, Short.MAX_VALUE)
                 .addContainerGap())
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel3Layout.createSequentialGroup()
                 .addContainerGap()
-                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 272, Short.MAX_VALUE)
+                .add(jPanel4, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 273, Short.MAX_VALUE)
                 .addContainerGap())
         );
         jTabbedPane1.addTab(L10n.getString("Settings.ColumnsTab"), jPanel3);
@@ -375,7 +379,7 @@
                 .add(jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
                     .add(headerOneField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 472, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                     .add(headerTwoField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 473, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                .addContainerGap(26, Short.MAX_VALUE))
         );
         jPanel6Layout.setVerticalGroup(
             jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -405,7 +409,7 @@
             .add(jPanel5Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel6, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(159, Short.MAX_VALUE))
+                .addContainerGap(146, Short.MAX_VALUE))
         );
         jTabbedPane1.addTab(L10n.getString("Settings.SchedaTab"), jPanel5);
 
@@ -425,7 +429,7 @@
             .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
                 .add(helpButton)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 367, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 401, Short.MAX_VALUE)
                 .add(okButton)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancelButton)

Modified: trunk/src/net/sf/plantlore/common/PlantloreHelp.java
===================================================================
--- trunk/src/net/sf/plantlore/common/PlantloreHelp.java	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/common/PlantloreHelp.java	2006-09-11 02:37:54 UTC (rev 803)
@@ -91,12 +91,15 @@
     public static final String SERVER_MANAGER           = "server.manager"; 
     //  Desctripton of server info
     public static final String SERVER_INFO              = "server.info"; 
+    // Description for creating new database
+    public static final String CREATE_DB                = "createdb";    
 
     /* Instance of a logger */
     private static Logger logger = Logger.getLogger(PlantloreHelp.class.getPackage().getName());
     /* Instance of HelpSet and HelpBroker. These variables are initiliazed by initialize() method */
     private static HelpBroker hb;
     private static HelpSet hs;
+
     
     /** Creates a new instance of PlantloreHelp */
     public PlantloreHelp() {

Modified: trunk/src/net/sf/plantlore/help/cs/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/html/author.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -40,7 +40,7 @@
 Po otev?en? dialogov?ho okna pro spr?vu autor? se zobraz? v?ichni dostupn? auto?i. Pro pozd?j?? zobrazen? v?ech autor?  stiskn?te tla??tko <i>Vyhledej autory</i> bez 
 vypln?n? vyhled?vac?ch parametr?.
 
-<h1>P?id?v?n? a editace autor?</h1>
+<h1><a name="add">P?id?v?n? a editace autor?</a></h1>
 Dialogov? okno pro p?id?van? nebo editaci autora se otev?r? z hlavn?ho okna spr?vy autor? tla??tkem <i>P?idej autora</i> resp. <i>Uprav autora</i>. Toto okno 
 obsahuje n?sleduj?c? polo?ky:
 <ul>

Modified: trunk/src/net/sf/plantlore/help/cs/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -34,7 +34,7 @@
 	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, prob?h? ve dvou kroc?ch.
 	</p>
 
-	<h3>1.1. V?b?r datab?ze</h3>
+	<h3><a name="selectdb">1.1. V?b?r datab?ze</a></h3>
 	
 	<p>
 	<img src="picture/LoginDBSelection.png" alt="Volba datab?ze.">
@@ -54,7 +54,7 @@
 	</p>
 
 
-	<h3>1.2. Autentifikace - prokazov?n? toto?nosti</h3>
+	<h3><a name="authentication">1.2. Autentifikace - prokazov?n? toto?nosti</a></h3>
 
 	<p>
 	Pro p?ihl??en? k datab?zi je pot?eba se prok?zat p?ihla?ovac?mi ?daji 

Modified: trunk/src/net/sf/plantlore/help/cs/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -44,7 +44,7 @@
 Po otev?en? dialogov?ho okna pro spr?vu publikac? se zobraz? v?echny dostupn? publikace. Pro pozd?j?? 
 zobrazen? v?ech publikac? stiskn?te tla??tko <i>Vyhledej publikace</i> bez vypln?n? vyhled?vac?ch parametr?.
 
-<h1>P?id?v?n? a editace publikac?</h1>
+<h1><a name="add">P?id?v?n? a editace publikac?</a></h1>
 Dialogov? okno pro p?id?van? nebo editaci publikac? se otev?r? z hlavn?ho okna spr?vy publikac? tla??tkem 
 <i>P?idej publikaci</i> resp. <i>Uprav publikaci</i>. Toto okno obsahuje n?sleduj?c? polo?ky:
 <ul>

Modified: trunk/src/net/sf/plantlore/help/cs/html/resources.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/html/resources.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -8,11 +8,11 @@
   <body>
   <h1>Zdroje</h1>
 Mnoho informac? v?etn? nejaktu?lnej?? verze Plantlore najdete na na?? dom?ci str?nce uveden? n??e.
-V p??pad? jak?chkoliv probl?m? se obra?te na n?kter?ho z v?voj??? Plantlore
+V p??pad? jak?chkoliv probl?m? se obra?te na n?kter?ho z v?voj??? Plantlore
 <p>
 Dom?c? str?nka Plantlore: <a href="http://plantlore.berlios.de">http://plantlore.berlios.de</a>
 <p>
-Ulo?i?te zdrojov?ch k?d? (SVN): svn://svn.berlios.de/plantlore/trunk/
+Ulo?i?te zdrojov?ch k?d? (SVN): svn://svn.berlios.de/plantlore/trunk/
 <p>
 Zaznamen?v?n? chyb: <a href="https://developer.berlios.de/bugs/?group_id=5975">https://developer.berlios.de/bugs/?group_id=5975</a>
 <p>

Modified: trunk/src/net/sf/plantlore/help/cs/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -30,7 +30,7 @@
 
 
 
-	<h2>1. Vytvo?en? a spu?t?n? nov?ho serveru</h2>
+	<h2><a name="connection">1. Vytvo?en? a spu?t?n? nov?ho serveru</a></h2>
 
 	<p>
 	Nastaven? serveru lze prov?st na z?lo?ce "Spustit nov? server".
@@ -163,7 +163,7 @@
 
 
 
-	<h2>2. P?ipojen? k b???c?mu serveru</h2>
+	<h2><a name="info">2. P?ipojen? k b???c?mu serveru</a></h2>
 
 
 	<p>
@@ -235,7 +235,7 @@
 
 
 
-	<h2>3. Administrace serveru</h2>
+	<h2><a name="manager">3. Administrace serveru</a></h2>
 
 	<p>
 	Administrace slou?? p?edev??m k z?sk?n? informac? o aktu?ln? p?ipojen?ch u?ivatel?ch

Modified: trunk/src/net/sf/plantlore/help/cs/jhelpidx.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/jhelpidx.xml	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/cs/jhelpidx.xml	2006-09-11 02:37:54 UTC (rev 803)
@@ -1,5 +1,4 @@
   <?xml version="1.0" encoding="UTF-8" standalone="no"?>
   <!DOCTYPE index PUBLIC "-//Sun Microsystems Inc.//DTD JavaHelp Index Version 1.0//EN" "http://java.sun.com/products/javahelp/index_1_0.dtd">
   <index version="1.0">
-    <indexitem text="cheater" target="id328078"/>
   </index>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/en/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/author.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/en/html/author.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -43,7 +43,7 @@
 but you want to display and browse all available authors again, press the <i>Search authors</i>
 button while all of the search fields are left blank.
 <p/>
-<h2>Adding and editing authors</h2>
+<h2><a name="add">Adding and editing authors</a></h2>
 Window for adding new authors can be opened from the main Author Manager window using <i>Add 
 author</i> button. This window contains the following fields:
 <ul>

Modified: trunk/src/net/sf/plantlore/help/en/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/publication.html	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/en/html/publication.html	2006-09-11 02:37:54 UTC (rev 803)
@@ -44,7 +44,7 @@
 but you want to display and browse all available publications again, press the <i>Search publications</i>
 button while all of the search fields are left blank.
 <p/>
-<h2>Adding and editing publications</h2>
+<h2><a name="add">Adding and editing publications</a></h2>
 Window for adding new publications can be opened from the main Publication Manager window using <i>Add 
 publication</i> button. This window contains the following fields:
 <ul>

Modified: trunk/src/net/sf/plantlore/help/en/jhelpidx.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/en/jhelpidx.xml	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/help/en/jhelpidx.xml	2006-09-11 02:37:54 UTC (rev 803)
@@ -1,5 +1,4 @@
   <?xml version="1.0" encoding="UTF-8" standalone="no"?>
   <!DOCTYPE index PUBLIC "-//Sun Microsystems Inc.//DTD JavaHelp Index Version 1.0//EN" "http://java.sun.com/products/javahelp/index_1_0.dtd">
   <index version="1.0">
-    <indexitem text="cheater" target="id328078"/>
   </index>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-11 02:37:54 UTC (rev 803)
@@ -1799,3 +1799,19 @@
 AUTHOR.role.other=not specified
 
 UserMnager.SearchPanel=Search panel
+
+Settings.Title=Settings
+
+CreateDB.CreatingUsers=Creating users...
+
+CreateDB.CreatingDatabase=Creating database...
+
+Overview.NothingToEdit=No occurrence selected. Check at least one record please
+
+Overview.NothingToEditTitle=No occurrence selected
+
+Overview.NoOccurrence=No occurrence selected. Check at least one occurrence please
+
+Overview.NoOccurrenceTitle=No occurrence selected
+
+CreateDB.CreatingTables=Creating tables...

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-11 02:37:54 UTC (rev 803)
@@ -2165,3 +2165,19 @@
 AUTHOR.role.other=neuvedeno
 
 UserMnager.SearchPanel=Vyhled\u00E1vac\u00ED panel
+
+Settings.Title=Nastaven\u00ED
+
+CreateDB.CreatingUsers=Vytv\u00E1\u0159\u00EDm u\u017Eivatele...
+
+CreateDB.CreatingDatabase=Vytv\u00E1\u0159\u00EDm datab\u00E1zi...
+
+Overview.NothingToEdit=Vyberte pros\u00EDm alespo\u0148 jeden n\u00E1lez
+
+Overview.NothingToEditTitle=Nen\u00ED vybr\u00E1n n\u00E1lez
+
+Overview.NoOccurrence=Vyberte pros\u00EDm alespo\u0148 jeden n\u00E1lez
+
+Overview.NoOccurrenceTitle=Nen\u00ED vybr\u00E1n n\u00E1lez
+
+CreateDB.CreatingTables=Vytv\u00E1\u0159\u00EDm tabulky...

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-11 02:30:05 UTC (rev 802)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-11 02:37:54 UTC (rev 803)
@@ -1654,3 +1654,19 @@
 AUTHOR.role.other=not specified
 
 UserMnager.SearchPanel=Search panel
+
+Settings.Title=Settings
+
+CreateDB.CreatingUsers=Creating users...
+
+CreateDB.CreatingDatabase=Creating database...
+
+Overview.NothingToEdit=No record selected. Check at least one record please
+
+Overview.NothingToEditTitle=No occurrence selected
+
+Overview.NoOccurrence=No occurrence selected. Check at least one occurrence
+
+Overview.NoOccurrenceTitle=No occurrence selected
+
+CreateDB.CreatingTables=Creating tables...



From kovo at mail.berlios.de  Mon Sep 11 05:47:12 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 11 Sep 2006 05:47:12 +0200
Subject: [Plantlore-dev] r804 - trunk/documentation/release/vyvojova/complete
Message-ID: <200609110347.k8B3lCjt025455@sheep.berlios.de>

Author: kovo
Date: 2006-09-11 05:46:46 +0200 (Mon, 11 Sep 2006)
New Revision: 804

Added:
   trunk/documentation/release/vyvojova/complete/VyvojovaDokum.odt
   trunk/documentation/release/vyvojova/complete/VyvojovaDokum.pdf
Log:
Documentation of the developement

Added: trunk/documentation/release/vyvojova/complete/VyvojovaDokum.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/complete/VyvojovaDokum.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/vyvojova/complete/VyvojovaDokum.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/vyvojova/complete/VyvojovaDokum.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From lada at mail.berlios.de  Mon Sep 11 05:55:00 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 11 Sep 2006 05:55:00 +0200
Subject: [Plantlore-dev] r805 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609110355.k8B3t0wY025961@sheep.berlios.de>

Author: lada
Date: 2006-09-11 05:55:00 +0200 (Mon, 11 Sep 2006)
New Revision: 805

Modified:
   trunk/src/net/sf/plantlore/client/overview/Transformation.java
Log:
JavaDoc has been changed.

Modified: trunk/src/net/sf/plantlore/client/overview/Transformation.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/Transformation.java	2006-09-11 03:46:46 UTC (rev 804)
+++ trunk/src/net/sf/plantlore/client/overview/Transformation.java	2006-09-11 03:55:00 UTC (rev 805)
@@ -25,14 +25,12 @@
  * @author Lada Oberreiterova
  * @version 1.0
  * 
- * U WGS-84 se bude zadavat a zobrazovat geodeticke souradnice:
+ * WGS-84 will be entered and displayed using geodetic coordinates
  *        latitude: 50.4576?
  * 	  longitude: 14.3986?
  * 	  altitude: 289.15 m
  *
- * U S42 a S-JTSK se budou zadavat a zobrazovat souradnice v ortogon?ln?m syst?mu: 
- * Pro S-JSTK se rozlisuji kvadranty - CR spada do 3.kvadrantu (X-ova souradnice bude vychazet zaporne)
- * Pro S-42 se rozlisuji pasy - CR spada do 3.pasu a ??st Karpat na Morav? do 4.pasu
+ * S42 a S-JTSK will be entered and displayed using ortogonal coordinates
  * 		Y= 1002007 m 
  * 		X= 738791 m.
  * 		Z=  244 m
@@ -65,13 +63,7 @@
     
     /**
      * 
-     * Creates a new instance of Transformation 
-     * 
-     * 
-     * @param latitude
-     * @param longitude
-     * @param altitude
-     * @param coordinateSystem
+     * Creates a new instance of Transformation      
      */
     public Transformation() {
         
@@ -83,9 +75,10 @@
     //**********************************  WGS-84  <---> S-JTSK ************************************//
     //*********************************************************************************************//
     /**
-     * Helmertova transformace (podm?nka "min max") 
-     * 
-     *  WGS-84 pou??v? elipsoid WGS-84, kde?to S-JTSK pou??v? elipsoid Basse?v (Elipsoidy se s r?znou p?esnost? p?ibli?uj? 
+     * Helmert transformation (conditions "min max") 
+     * /
+     
+     /*  WGS-84 pou??v? elipsoid WGS-84, kde?to S-JTSK pou??v? elipsoid Basse?v (Elipsoidy se s r?znou p?esnost? p?ibli?uj? 
      * zobecn?n?mu fyzik?ln?mu tvaru Zem? - geoidu). 
      *
      *  Transformace z WGS84 do S-JTSK m? dv? ??sti:
@@ -215,9 +208,7 @@
     
      public Double[] transform_S42_to_WGS84(Double x, Double y, Double z) {
          
-         //Prepocet z S-42 do WGS-84 ... uz dostanu hodnoty v radianech
-         //!!!!!FIXME - v teto funkci je chyba
-        //Double[] geodeticCoordinate = transformation_S42_xy_BLH(y, x, z);
+         //Prepocet z S-42 do WGS-84 ... uz dostanu hodnoty v radianech                
     	Double[] geodeticCoordinate = S42_xy_BLH(x, y, z);
         logger.debug("S42 - geodeticke souradnice: " + geodeticCoordinate[0]);
         logger.debug("S42 - geodeticke souradnice: " + geodeticCoordinate[1]);
@@ -257,7 +248,7 @@
     //******************************************************************************************//    
     
     /**    
-     *   Prepocet z S-JTSk do WGS-84
+     *    S-JTSk --> WGS-84
      *   (Krovak projection (used in the S-JTSK coordinate system))
      */    
     public Double[] kovak_xy_BLH(Double x, Double y, Double altitude) {
@@ -309,9 +300,10 @@
     }
     
     /**
-     * Transformace souradnic ze systemu WGS-84 do systemu S-JTSK.
-     *
-     * vraci JTSK sou?adnice pro zadanou Severn? ???ku a v?chodn? d?lku  
+     * Transformations coordinate from system WGS-84 to system S-JTSK.
+     */
+    
+    /* vraci JTSK sou?adnice pro zadanou Severn? ???ku a v?chodn? d?lku  
      * Zobrazeni zemepisnych souradnic na pravouhle:
      *  - zobrazeni Besselova elipsoidu  na Gausseovu kouli
      *  - vypocet kartografickych souradnic na Gaussove kouli s posunutym polem Q o souradnicich 48?15`, 42?30`.
@@ -511,10 +503,7 @@
         return value;
     }
     
-    /**
-     *
-     *
-     */
+    
     public Double[] mercator_XY_BLH(double e, double n, double no, double eo, double fo, double phi0, double lambda0, double elipsoid_a, double b){
         
         double phid = (n-no) / (elipsoid_a * fo) + phi0;
@@ -572,7 +561,7 @@
     //******** Convergetion between geological coordinate and cartesian coordinate ***********//
     //***************************************************************************************//
     
-    /**
+    /*
      *  Vypocet geodetickych souradnic z pravouhlych souradnic pro urcity elipsoid
      */
     public Double[] ellipsoid_xyz_BLH(Double x, Double y, Double z, Double elipsoid_a, Double elipsoid_f) {
@@ -596,7 +585,7 @@
           return geodeticCoordinate;       
       }
     
-    /**
+    /*
      * Vypocet pravouhlych souradnic z geodetickych souradnic pro dany elipsoid
      * (phi = B, lambda = L )
      *
@@ -620,7 +609,7 @@
         return cartesianCoordinate;
     }
     
-    /**
+    /*
      * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid WGS84
      *     
      */
@@ -630,7 +619,7 @@
         return cartesianCoordinate;
     }
     
-    /**
+    /*
      * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
      *
      */
@@ -640,7 +629,7 @@
         return geodeticCoordinate;
       }        
     
-    /**
+    /*
      * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
      *     
      */
@@ -650,7 +639,7 @@
         return cartesianCoordinate;
     }
     
-    /**
+    /*
      * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Bessel
      *
      */
@@ -660,7 +649,7 @@
         return geodeticCoordinate;
       }        
     
-    /**
+    /*
      * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Krajovskij
      *     
      */
@@ -670,7 +659,7 @@
         return cartesianCoordinate;
     }
     
-    /**
+    /*
      * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Krajovskij
      *
      */
@@ -688,7 +677,7 @@
     /**
      * Hrdina (1997)
      *
-     * Transformace pravouhlych souradnic z WGS84 do S-JTSK
+     * Transformation ortogonal coordinate from WGS84 to S-JTSK
      */
     public Double[] transformation_WGS84_SJTSK_xyz_xyz(Double xs, Double ys, Double zs) {
         // koeficienty transformace ze systemu WGS-84 do systemu S-JTSK
@@ -720,7 +709,7 @@
     /**
      * Hrdina (2002)
      *
-     * Transformace pravouhlych souradnic z S-JTSK do WGS84 
+     * Transformation coordinate system from S-JTSK to WGS84 
      */
     public Double[] transformation_SJTSK_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
         // koeficienty transformace ze systemu S-JTSK do systemu WGS-84
@@ -751,7 +740,7 @@
     
     /**
      *
-     * Transformace pravouhlych souradnic z WGS84 do S42
+     * Transformation coordinate system from WGS84 to S42
      */
     public Double[] transformation_WGS84_S42_xyz_xyz(Double xs, Double ys, Double zs) {
         // koeficienty transformace ze systemu WGS84 do systemu S42
@@ -782,7 +771,7 @@
     
     /**     
      *
-     * Transformace pravouhlych souradnic z S42 do WGS84 
+     * Transformation coordinate system from S42 to WGS84 
      */
     public Double[] transformation_S42_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
         // koeficienty transformace ze systemu S42 do systemu WGS-84
@@ -815,7 +804,7 @@
     //******************* Radiant vs. Degree *******************************//
     //**********************************************************************//
     
-   /**
+   /*
    * transform latitude and longitude from degree to radiant format
    * 
    * @param latitude
@@ -833,7 +822,7 @@
       return geodeticCoordinateRAD;
   }
 
-  /**
+  /*
    * transform latitude and longitude from radiant to degree format
    * 
    * @param latitude



From lada at mail.berlios.de  Mon Sep 11 06:19:20 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 11 Sep 2006 06:19:20 +0200
Subject: [Plantlore-dev] r806 - in trunk/src/net/sf/plantlore/help: cs/html
	default/html en/html
Message-ID: <200609110419.k8B4JKFf027228@sheep.berlios.de>

Author: lada
Date: 2006-09-11 06:19:20 +0200 (Mon, 11 Sep 2006)
New Revision: 806

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/index.html
   trunk/src/net/sf/plantlore/help/default/html/index.html
   trunk/src/net/sf/plantlore/help/en/html/index.html
Log:
Write some references to main page (ref only to content of help).

Modified: trunk/src/net/sf/plantlore/help/cs/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-11 03:55:00 UTC (rev 805)
+++ trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-11 04:19:20 UTC (rev 806)
@@ -6,5 +6,21 @@
   </head>
   <body>
     <h1>Plantlore - N?pov?da</h1>
+
+    <ul>
+      <li><a href="login.html">P?ihl??en?</a></li>
+      <li><a href="setting.html">Nastaven?</a></li>
+      <li><a href="overview.html">P?ehled n?lez?</a></li>
+      <li><a href="author.html">Auto?i</a></li>
+      <li><a href="publication.html">Publikace</a></li>
+      <li><a href="metadata.html">Metadata</a></li>
+      <li><a href="history.html">Historie</a></li>
+      <li><a href="user.html">U?ivatel?</a></li>
+      <li><a href="import.html">Import dat</a></li>
+      <li><a href="export.html">Export dat</a></li>
+      <li><a href="createdb.html">Nov? datab?ze</a></li>
+      <li><a href="server.html">Server</a></li>    
+    </ul>
+    
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/default/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/index.html	2006-09-11 03:55:00 UTC (rev 805)
+++ trunk/src/net/sf/plantlore/help/default/html/index.html	2006-09-11 04:19:20 UTC (rev 806)
@@ -1,9 +1,28 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>Plantlore</title>
 </head>
 <body>
 <h1>Plantlore</h1>
+
+    
+    <ul>
+      <li><a href="login.html">Login</a></li>
+      <li><a href="setting.html">Settings</a></li>
+      <li><a href="overview.html">Overview</a></li>
+      <li><a href="author.html">Author</a></li>
+      <li><a href="publication.html">Publication</a></li>
+      <li><a href="metadata.html">Metadata</a></li>
+      <li><a href="history.html">History</a></li>
+      <li><a href="user.html">Users</a></li>
+      <li><a href="import.html">Import</a></li>
+      <li><a href="export.html">Export</a></li>
+      <li><a href="createdb.html">New database</a></li>
+      <li><a href="server.html">Server</a></li>    
+    </ul>
+    
+
 </body>
-</html>
\ No newline at end of file
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/index.html	2006-09-11 03:55:00 UTC (rev 805)
+++ trunk/src/net/sf/plantlore/help/en/html/index.html	2006-09-11 04:19:20 UTC (rev 806)
@@ -6,5 +6,22 @@
 </head>
 <body>
 <h1>Plantlore</h1>
+
+<ul>
+      <li><a href="login.html">Login</a></li>
+      <li><a href="setting.html">Settings</a></li>
+      <li><a href="overview.html">Overview</a></li>
+      <li><a href="author.html">Author</a></li>
+      <li><a href="publication.html">Publication</a></li>
+      <li><a href="metadata.html">Metadata</a></li>
+      <li><a href="history.html">History</a></li>
+      <li><a href="user.html">Users</a></li>
+      <li><a href="import.html">Import</a></li>
+      <li><a href="export.html">Export</a></li>
+      <li><a href="createdb.html">New database</a></li>
+      <li><a href="server.html">Server</a></li>    
+    </ul>
+
+
 </body>
-</html>
\ No newline at end of file
+</html>



From krater at mail.berlios.de  Mon Sep 11 08:05:36 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 11 Sep 2006 08:05:36 +0200
Subject: [Plantlore-dev] r807 -
	trunk/documentation/release/developer/complete
Message-ID: <200609110605.k8B65a1I006708@sheep.berlios.de>

Author: krater
Date: 2006-09-11 08:05:32 +0200 (Mon, 11 Sep 2006)
New Revision: 807

Added:
   trunk/documentation/release/developer/complete/Developer's Manual.odt
   trunk/documentation/release/developer/complete/Developer's Manual.pdf
Log:
Developer's Manual.

Added: trunk/documentation/release/developer/complete/Developer's Manual.odt
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/complete/Developer's Manual.odt
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/documentation/release/developer/complete/Developer's Manual.pdf
===================================================================
(Binary files differ)


Property changes on: trunk/documentation/release/developer/complete/Developer's Manual.pdf
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream



From krater at mail.berlios.de  Mon Sep 11 08:22:29 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 11 Sep 2006 08:22:29 +0200
Subject: [Plantlore-dev] r808 -
	trunk/documentation/release/developer/complete
Message-ID: <200609110622.k8B6MTxa007700@sheep.berlios.de>

Author: krater
Date: 2006-09-11 08:22:27 +0200 (Mon, 11 Sep 2006)
New Revision: 808

Modified:
   trunk/documentation/release/developer/complete/Developer's Manual.odt
   trunk/documentation/release/developer/complete/Developer's Manual.pdf
Log:
Final Developer

Modified: trunk/documentation/release/developer/complete/Developer's Manual.odt
===================================================================
(Binary files differ)

Modified: trunk/documentation/release/developer/complete/Developer's Manual.pdf
===================================================================
(Binary files differ)



From tkovarik at gmail.com  Mon Sep 11 17:33:47 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Mon, 11 Sep 2006 17:33:47 +0200
Subject: [Plantlore-dev] Plantlore
Message-ID: <ea88f1620609110833n68ac318bg3b3e61b2d5cfe37b@mail.gmail.com>

Ahoj Vlado,

dali sme na web poslednu verziu Plantlore. Prepac, ze to tolko trvalo,
robili sme este teraz cez vikend nejake upravy. Zatial je to docasne na
nasom skolskom serveri, este sme sa zatial nedostali k tomu aby sme to
spristupnili na webe projektu. Vsetko potrebne najdes na:

http://urtax.ms.mff.cuni.cz/plantlore/release/Plantlore%20Release/

Je tam kopec veci, nebudes potrebovat vsetky. V subore readme.txt je popis
jednotlivych adresarov. Dolezity je PlantloreInstall kde su instalacne
balicky (obsahuju v sebe aj instalaciu PostgreSQL). V adresari documentation
najdes dostupnu dokumentaciu. Ak by si potreboval dalsie info daj vediet.

Dufam, ze sa mi podari co najskor spristupnit vsetko priamo na webe
projektu.

Maj sa pekne


Kovo


PS.: Este jedna dolezita vec - po nainstalovani budes musiet vytvorit a
naplnit databazu zakladnymi datami (vesnice, fytochoriony, territoria,
rostliny). Subory z ktorych to mozes naimportovat pomocou tabulkoveho
importu su v archive data.zip
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060911/6451141d/attachment.html>

From admin at berlios.de  Mon Sep 11 20:52:52 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 20:52:52 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7686] Changes the user made in managers are
	not propagated
Message-ID: <200609111852.k8BIqqEV016204@unicorn.berlios.de>

Bug #7686, was updated on 2006-May-31 10:44
Here is a current snapshot of the bug.

Project: Plantlore
Category: General
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 9
Submitted by: fraktalek
Assigned to : none
Summary: Changes the user made in managers are not propagated

Details: The rest of the application is not informed about changes that the managers made to the database. This for example results into the bug #7668 Deleted authors can be assigned to an occurrence.


Follow-Ups:

Date: 2006-May-31 19:57
By: fraktalek

Comment:
Partially fixed in revision 410. ManangerBridge implemented and added as an observer to metadataManagerModel, historyModel, wholeHistoryModel. The rest of the managers is still to be fixed.

And the whole thing needs to be tested carefully!!!
Many changes were needed to the application core due to this fix.


-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7686&group_id=5975


From admin at berlios.de  Mon Sep 11 20:53:23 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 20:53:23 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8497] Overview cannot deal with empty database
Message-ID: <200609111853.k8BIrNsU016288@unicorn.berlios.de>

Bug #8497, was updated on 2006-Aug-21 14:24
Here is a current snapshot of the bug.

Project: Plantlore
Category: None
Status: Closed
Resolution: Fixed
Bug Group: None
Priority: 5
Submitted by: krater
Assigned to : none
Summary: Overview cannot deal with empty database

Details: Revision 540. 

The Overview cannot deal with a database that doesn't contain any records in the TOCCURRENCES and TAUTHOROCURRENCES.

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8497&group_id=5975


From admin at berlios.de  Mon Sep 11 21:00:06 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:00:06 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8480] The Select Query is wrong!!
Message-ID: <200609111900.k8BJ06vg016843@unicorn.berlios.de>

Bug #8480, was updated on 2006-Aug-20 12:15
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 9
Submitted by: fraktalek
Assigned to : none
Summary: The Select Query is wrong!!

Details: Some occurrences are doubled some are left out...
For example in the habitat tree navigate to Bohemia orientalis and then expand the Blatensko phytochorion one of the Prusy-Boskuvky habitat as one occurrence in it, however if you double-click it the Overview will show nothing.

Other way to reproduce this is to search for Herbarium CB/1003.
Overview will show two times the occurrence with id 587, one time occurrence with id 590 and will ommit occurrence with id 589.

I'll shortly commit code that makes the inspection of this problem a little easier - Plantlore will print the occurrence id when you select a row and by  each habitat in the habitat tree there will be indicated how many occurrences it has in it.

Follow-Ups:

Date: 2006-Aug-26 23:16
By: fraktalek

Comment:
Hopefully fixed in revision # 577 - added a constraint to the select query to select only alive authorOccurrences.
Needs further testing.
-------------------------------------------------------

Date: 2006-Aug-21 14:04
By: krater

Comment:
Sorry, unintentionally changed the title... :(
-------------------------------------------------------

Date: 2006-Aug-21 14:02
By: krater

Comment:
I concur.

I used 
 * the plantlore_full_2006_08_06.backup database 
 * Plantlore revision 540

Then, right after logging in,  I marked first five occurrences in the Overview dialog with following results:

Selected row #0 occurrence id is 590
Selected row #1 occurrence id is 587
Selected row #2 occurrence id is 587
Selected row #3 occurrence id is 207
Selected row #4 occurrence id is 3

The most confusing part of all this was Export: I tried to export those five marked Occurrences and this is what I got:

<occurrence>
  <unitvalue>3</unitvalue>
</occurrence>
<occurrence>
  <unitvalue>207</unitvalue>
</occurrence>
<occurrence>
  <unitvalue>303</unitvalue>
</occurrence>
<occurrence>
  <unitvalue>303</unitvalue>
</occurrence>

Well:
 * Does the database contain occurrences with the same Unique identifier (ie. unitvalue & unitiddb)?
 * Where the heck came the record 303 from and where are records 587 and 590?
 * Why are there only 4 records?

This calls for revision of Search.creaExportQuery as well.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8480&group_id=5975


From admin at berlios.de  Mon Sep 11 21:03:01 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:03:01 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7748] Application freezes (Windows XP)
Message-ID: <200609111903.k8BJ31Dk017027@unicorn.berlios.de>

Bug #7748, was updated on 2006-Jun-04 17:04
Here is a current snapshot of the bug.

Project: Plantlore
Category: General
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 5
Submitted by: krater
Assigned to : none
Summary: Application freezes (Windows XP)

Details: Almost every time a JOptionPane.showMessage() is called and there is an opened modal dialog, the whole application freezes.

The cause of the problem is unknown, although it will probably have something to do with the threading model.

Follow-Ups:

Date: 2006-Sep-11 21:03
By: fraktalek

Comment:
Seems to be fixed using the new Task/Dispatcher system. More care also has been taken to run component handling code in the EDT.
-------------------------------------------------------

Date: 2006-Aug-30 20:05
By: krater

Comment:
No freezing observed for a long time. Appears to be fixed (just stick to Tasks and several advices below).
-------------------------------------------------------

Date: 2006-Jul-26 15:57
By: krater

Comment:
If you modify the VIEW's update() method accordingly, you actually CAN still call JOptionPane.showMessage() from the controller. I've found that recently. The application WILL NOT freeze.
-------------------------------------------------------

Date: 2006-Jun-04 17:41
By: krater

Comment:
In my experience if you convert your view's update() method in the following manner:

    public void update(Observable source, final Object arg) {
    	java.awt.EventQueue.invokeLater(new Runnable() {
    		public void run() {

    			if(arg instanceof Exception) {
    				
    				JOptionPane.showMessageDialog(
    						null, 
    						((Exception)arg).getMessage(), 
    						L10n.getString("Error.LoginFailed"), 
    						JOptionPane.ERROR_MESSAGE);
    			}
    			// The database layer has been created, we are no longer neccessary
    			else if(arg instanceof DBLayer)
    				setVisible(false); 
    			// Some update information - display them in the status bar.
    			else if(arg instanceof String) 
    				status.setText("  " + (String)arg);
    		}
    	});
	}



everything should be fine. However, the code in the controller must not call JOptionPane.showMessage(). Changes I do to the view from the controller doesn't seem to cause any problem. See the net.sf.plantlore.client.login package for the details.
-------------------------------------------------------

Date: 2006-Jun-04 17:19
By: krater

Comment:
Weird thing is that Login doesn't freeze now...
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7748&group_id=5975


From admin at berlios.de  Mon Sep 11 21:04:42 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:04:42 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7681] Someone should check the length of
	strings inserted.
Message-ID: <200609111904.k8BJ4gNC017150@unicorn.berlios.de>

Bug #7681, was updated on 2006-May-30 22:38
Here is a current snapshot of the bug.

Project: Plantlore
Category: General
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 9
Submitted by: krater
Assigned to : none
Summary: Someone should check the length of strings inserted.

Details: Some strings may exceed the length declared in the database. It is a question who should test the length of strings - whether the holder object or the database layer.

(You'll get org.hibernate.exception.DataException otherwise).

Follow-Ups:

Date: 2006-Sep-11 21:04
By: fraktalek

Comment:
Most of the application now limits the length of entered text. Either fully by using the DocumentSizeFilter or backwards in the case of JFormattedTextFields for that DocumentSizeFilter doesn't work.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7681&group_id=5975


From admin at berlios.de  Mon Sep 11 21:05:03 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:05:03 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7666] Help cannot be invoked from modal dialog
Message-ID: <200609111905.k8BJ531a017182@unicorn.berlios.de>

Bug #7666, was updated on 2006-May-30 19:50
Here is a current snapshot of the bug.

Project: Plantlore
Category: Help
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 7
Submitted by: tkovarik
Assigned to : tkovarik
Summary: Help cannot be invoked from modal dialog

Details: When help is invoked from the modal dialog it cannot be used since it cannot receive focus (it is "under" the modal window). Workaround is not to make dialogs modal. 

Encountered in revision: 395

Follow-Ups:

Date: 2006-Jun-02 06:49
By: tkovarik

Comment:
Help framework rewritten. It is no longer required to create actionListeners since JavaHelp creates them automatically. How to use new functionality (new methods in net.sf.plantlore.common.PlantloreHelp):
addButtonHelp(String section, Component button) - Display help when the given button is pressed (automatically creates listener)
addComponentHelp(String section, Component comp) - Add context-sensitive help for a generic component.
addKeyHelp(String section, Component comp) - Display help when default help key is pressed (F1 on Windows). Help is displayed in case
"comp" has focus. To display help for the whole dialog (focus is anywhere in the dialog) use addKeyHelp(section, this.getRootPane())

Help window should be available even from the modal dialog. I have encountered additional problem in Add Author dialog (can be opened from Author manager) - in case main window of the author manager is modal and Add Author window is non-modal and help is invoked from the Add Author window, Help is inaccessible (Don't ask me why and don't tell anyone :)

Please verify and close.
-------------------------------------------------------

Date: 2006-May-30 20:03
By: fraktalek

Comment:
We need to  start the help dialog in a new thread or send the creation and setVisible code to the EventDispatch Thread. Similar problem is already solved already in the Task, ProgressBar couple and in code constructing and displaying Scheda (AppCore.SchedaAction).
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7666&group_id=5975


From admin at berlios.de  Mon Sep 11 21:05:25 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:05:25 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7663] Display dialogs in the center of the
	screen
Message-ID: <200609111905.k8BJ5PJA017224@unicorn.berlios.de>

Bug #7663, was updated on 2006-May-30 19:30
Here is a current snapshot of the bug.

Project: Plantlore
Category: General
Status: Closed
Resolution: Fixed
Bug Group: RFE
Priority: 3
Submitted by: tkovarik
Assigned to : none
Summary: Display dialogs in the center of the screen

Details: Display dialogs in the center of the screen (using JDialog.setLocationRelativeTo(null)). This is already done for author manager, publication manager and login. I believe it is more common to display dialogs in the center of the screen than in the upper left corner.

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7663&group_id=5975


From admin at berlios.de  Mon Sep 11 21:06:24 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:06:24 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8231] Distorted buttons
Message-ID: <200609111906.k8BJ6OP2017291@unicorn.berlios.de>

Bug #8231, was updated on 2006-Jul-28 15:19
Here is a current snapshot of the bug.

Project: Plantlore
Category: None
Status: Closed
Resolution: Fixed
Bug Group: RFE
Priority: 1
Submitted by: krater
Assigned to : none
Summary: Distorted buttons

Details: It sometimes happens that buttons get distorted (the size is incorrect and the text is missing) although everything seems to be set ok. 

The cause of the problem is simple. It seems that the call button.setAction( myAction ) causes that problem IF `myAction` doesn't have a constructor whith the following line: putValue(NAME, L10n.getString("Common.Cancel"));



For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8231&group_id=5975


From admin at berlios.de  Mon Sep 11 21:06:59 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:06:59 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8607] Checklist doesn't reflect a change of
	database
Message-ID: <200609111906.k8BJ6xE8017335@unicorn.berlios.de>

Bug #8607, was updated on 2006-Aug-29 00:58
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview_Edit
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 6
Submitted by: fraktalek
Assigned to : krater
Summary: Checklist doesn't reflect a change of database

Details: ... it then still contains data from the previous database.

Or more correctly... if you first log into an empty database and then to a full database, the checklist loads the new plants. However if you switch back to an empty database it will remember the list of plants.



Follow-Ups:

Date: 2006-Aug-30 20:00
By: krater

Comment:
The changes should be propagated every time the underlying AutoTextArea receives a new set of allowed values.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8607&group_id=5975


From admin at berlios.de  Mon Sep 11 21:26:49 2006
From: admin at berlios.de (admin at berlios.de)
Date: Mon, 11 Sep 2006 21:26:49 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8588] Author table breaks sometimes
Message-ID: <200609111926.k8BJQnrg018932@unicorn.berlios.de>

Bug #8588, was updated on 2006-Aug-26 23:08
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview
Status: Open
Resolution: Fixed
Bug Group: Bug
Priority: 7
Submitted by: fraktalek
Assigned to : fraktalek
Summary: Author table breaks sometimes

Details: In the author table in AddEdit dialog there sometimes appears a combobox in the first column of the Add button row. This seems to break the table... adding and removing of authors is no longer possible and Plantlore throws exceptions...

Idea for steps to reproduce:

1. Run Plantlore and log in
2. Choose an occurrence and invoke the Edit dialog
3. Click on the Add button to add an author in the author table
4. Choose an author from the combobox in the new row
5. Click on Storno of the Edit dialog
6. Invoke the edit dialog again on the same occurrence

Sometimes the above situation occurs...


Follow-Ups:

Date: 2006-Sep-11 21:26
By: fraktalek

Comment:
Unfortunately appeared again.
New steps to reproduce:
1. open add/edit dialog
2. add an author
3. click twice on the author combo box (once to open the popupmenu and then second time on the combobox)
4. close the dialog
5. open it again

The previous fixes seem to prevent problems on Linux. However, checkAndPropagateChanges() method throws a NPE on Mac OS X...
We should check the behaviour on Windows.
-------------------------------------------------------

Date: 2006-Aug-27 19:33
By: fraktalek

Comment:
Real fix in revision 581: the DefaultCellEditor didn't work together with ComboBox as expected - it didn't stop editing after the combo boxe's popupmenu has been canceled. So I made a patch - a popup menu listener that calls fireEditingStopped() (or canceled..) each time the popup menu is canceled.

Right steps to reproduce were:
1. Invoke for example the Edit dialog
2. Add a new row for an author by clicking on the add buton (and do nothing more)
3. Click into the first column of the new row (and do nothing more)
4. Click somewhere else in the dialog - on a panel, not to a widget, so that only the popupmenu disappears but the combobox is still visible
5. Click on Cancel
6. Invoke edit dialog again on the same row

-------------------------------------------------------

Date: 2006-Aug-26 23:14
By: fraktalek

Comment:
Hopefully patched in commit # 577. The AppCore.setAuthor(int) method checks whether the int is in bounds of the array. So further work with plantlore seems to be possible although the cause hasn't been removed.

-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8588&group_id=5975


From admin at berlios.de  Tue Sep 12 22:07:46 2006
From: admin at berlios.de (admin at berlios.de)
Date: Tue, 12 Sep 2006 22:07:46 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7672] Remove ReferenceCitation from add/edit
	dialogue
Message-ID: <200609122007.k8CK7kw6003955@unicorn.berlios.de>

Bug #7672, was updated on 2006-May-30 21:40
Here is a current snapshot of the bug.

Project: Plantlore
Category: PublicationManager
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 2
Submitted by: joselada
Assigned to : tkovarik
Summary: Remove ReferenceCitation from add/edit dialogue

Details: Item Reference citation is join collectionName. collectionYearPublication, journalAuthorName, journalName. This field cannot be filled in by user.

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7672&group_id=5975


From admin at berlios.de  Tue Sep 12 22:08:13 2006
From: admin at berlios.de (admin at berlios.de)
Date: Tue, 12 Sep 2006 22:08:13 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7662] Upgrade ProgressBars to the new version
Message-ID: <200609122008.k8CK8D6R003981@unicorn.berlios.de>

Bug #7662, was updated on 2006-May-30 19:23
Here is a current snapshot of the bug.

Project: Plantlore
Category: AuthorManager
Status: Closed
Resolution: Fixed
Bug Group: RFE
Priority: 5
Submitted by: tkovarik
Assigned to : tkovarik
Summary: Upgrade ProgressBars to the new version

Details: Upgrade ProgressBars to the new version (developed by Fraktalek), consider removing the progress bars in certain cases.
This also applies to Publication manager.

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7662&group_id=5975


From admin at berlios.de  Tue Sep 12 22:11:00 2006
From: admin at berlios.de (admin at berlios.de)
Date: Tue, 12 Sep 2006 22:11:00 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #7678] Unique Occurrence record identifier.
Message-ID: <200609122011.k8CKB0D6004140@unicorn.berlios.de>

Bug #7678, was updated on 2006-May-30 22:14
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview_Add
Status: Closed
Resolution: Fixed
Bug Group: RFE
Priority: 8
Submitted by: krater
Assigned to : none
Summary: Unique Occurrence record identifier.

Details: The unique identifier of Occurrence records should be created as a true unique identifier. 

Import says:
The database is not in a consistent state - there are 5 Occurrence records with the same Unique Identifier (docasna unitIdDb-docasna unit value)! 

Follow-Ups:

Date: 2006-Sep-12 22:11
By: tkovarik

Comment:
DBLayer now assigns unique id to new occurrence records (plain number) and creates unique DB identifier for a new database (using unique id generator by krater)
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=7678&group_id=5975


From admin at berlios.de  Tue Sep 12 22:20:41 2006
From: admin at berlios.de (admin at berlios.de)
Date: Tue, 12 Sep 2006 22:20:41 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8504] HibernateDBLayer bug removal
Message-ID: <200609122020.k8CKKfNP004935@unicorn.berlios.de>

Bug #8504, was updated on 2006-Aug-21 20:49
Here is a current snapshot of the bug.

Project: Plantlore
Category: None
Status: Closed
Resolution: Fixed
Bug Group: RFE
Priority: 9
Submitted by: krater
Assigned to : tkovarik
Summary: HibernateDBLayer bug removal

Details: Several Copy-Pasted methods contain redundant and even incomplete code!

You should revise the code to make sure that

 * everything the database layer must set is actually set - such as record.createdWhen, record.updatedWhen, record.createdWho, ... AND sets it to all records that require it: Occurrence, Metadata, ... AND sets it in all methods (update, updateHistory, ....)

 * database layer sets the Unique Identifier properly (if it is not set already - for instance occurrences comming from import do have the Unique Identifier)

 * database layer throws only DBLayerExceptions that contain REASONABLE description of the problem

 * database layer performs a database validity check (to make sure the database the client is trying to work with is a proper Plantlore database) a.k.a verify the mapping of the database

Follow-Ups:

Date: 2006-Sep-12 22:20
By: tkovarik

Comment:
Done by krater
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8504&group_id=5975


From tkovarik at gmail.com  Wed Sep 13 18:46:43 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Wed, 13 Sep 2006 18:46:43 +0200
Subject: [Plantlore-dev] Fwd: plantlore
In-Reply-To: <4508285C.3000804@nature.cz>
References: <4508285C.3000804@nature.cz>
Message-ID: <ea88f1620609130946v76ef4473odb9cf68da7675e8e@mail.gmail.com>

---------- Forwarded message ----------
From: Vladim?r Hans <vladimir_hans at nature.cz>
Date: Sep 13, 2006 5:48 PM
Subject: plantlore
To: Martin Lep?? <lepsi at seznam.cz>, Milan Stech <stech at bf.jcu.cz>, Tomas
Kovarik <tkovarik at gmail.com>, Lada Oberreiterova <LadaOb at seznam.cz>

Ahoj,
u? jsem se dostal na instalaci plantlore a pos?l?m zat?m nesouvisl?
p?ipom?nky.
Je?t? mi tam mo?n? chyb?, ?e to chce vyjysnit postaven? plantlore
server, kdy ho pou??t, zda b??? jako d?mon ?i slu?ba OS. Tohle mi nen?
jasn?. Te%d mi to jede v?echno na lok?le, ale plantlore server je
zastaven?. Jestli je to popsan? v dokumentaci, tak se omlouv?m, ale
je?t? jsem ji nep?e?et a v instala?n?m n?vodu tohle nebylo. Po?lete mi
pros?m zdrojov? texty pro u?iv. dokumentaci (narazil jsem tam na
form?ln? nep?esnosti a faktick? chyby) a pak instala?n? howto - to chce
asi ?pln? p?epsat.
D?ky

--
Vladim?r Hans
Agentura ochrany p??rody a krajiny ?R,
st?edisko ?esk? Bud?jovice
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060913/a5a63410/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: pripominky.doc
Type: application/msword
Size: 68608 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060913/a5a63410/attachment.doc>

From fraktalek at gmx.net  Wed Sep 13 23:11:13 2006
From: fraktalek at gmx.net (fraktalek)
Date: Wed, 13 Sep 2006 23:11:13 +0200
Subject: [Plantlore-dev] navrh osnovy prezentace na obhajobu
Message-ID: <1158181873.2640.33.camel@kryton>

Kratke predstaveni projektu
	- jmeno projektu, jednou vetou co je a ceho se tyka (nalezova db.,
inteligentni kartoteka)
	- web
	- programatori, vedouci



Uvod do problematiky
	- priklad prace botanika (jde,pozoruje,zapisuje,tridi a uchovava
informace)
	- problemy spravy nalezovych dat
		- tradicni problemy kartotek
		- sdileni dat
		- specificke problemy nalezovych dat
			- vymezeni lokalit
			- hledani lokalit
	- existujici software pro spravu nalezovych dat
		- zminka, co nyni pouzivaji nasi botanici
	- zminka o existujicich standardech (ABCD schema, DarwinCore,
taxonomicka schemata - Berlinsky model)



Plantlore
	- obecne co resi (sprava a sdileni nal. dat)
	- vycet funkci (nezapomenout na specialni fungovani importu/exportu -
uniqueids..., transformace souradnic)
	- nastin reseni (model postaveny na ABCD schematu)



Uvod do standardu + BioCASE
	- ABCD schema
	- DarwinCore
	- taxonomicka schemata
	- BioCASE



Plantlore - architektura - nadhled
	- server, klient
	- webovy klient
	- predpoklad centralni autority
	- "komunikacni vrstva" - RMI, BioCASE protocol, HTTP



Plantlore - databazovy model
	- postaveny na DarwinCore
	- mapovani pro BioCASE
	- pomocne tabulky



Plantlore - zajimavosti a problemy implementace
	- Hibernate + RMI
	- DBLayer
	- unique ids - obrana proti duplikatum
	- MVC, bridge?
	- historie


? ( Plantlore - ukazka )


Zaver
	- v soucasnosti pouzitelne
	- neexistuje mnoho podobneho softwaru (jedinecnost diky standardum,
konverzi souradnic, automaticke moznosti zapojeni do BioCASE
projektu, ...)
	- splnili jsme jak pozadavky specifikace, tak sve interni cile
		- ???  pouzitelne urcite v cele CR
		- ???  s nevelkymi modifikacemi i po svete, bez GPS po svete uz ted
		- ...







From tkovarik at gmail.com  Thu Sep 14 10:51:45 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 14 Sep 2006 10:51:45 +0200
Subject: [Plantlore-dev] Fwd: Data pro softwarovy projekt Plantlore
In-Reply-To: <20060914064648.bf4ac8f8@ksint.ms.mff.cuni.cz>
References: <20060914064648.bf4ac8f8@ksint.ms.mff.cuni.cz>
Message-ID: <ea88f1620609140151r7b3bf6f7rcd420be1a6b547d2@mail.gmail.com>

---------- Forwarded message ----------
From: Antonin Riha <riha at ksi.ms.mff.cuni.cz>
Date: Sep 14, 2006 8:46 AM
Subject: Re: Data pro softwarovy projekt Plantlore
To: Tomas Kovarik <tkovarik at gmail.com>

Mili projektanti,
diky za data. Na strance projektove komise jsem videl
seznam projektu a vyzvu k posilani pozadavku na cas.
Me je celkem jedno, kdy budeme, pokud mate pozadavky
tak je prosim sdelte - snad je komise prijme rovnou
od vas, nebo mi mailnete.
Zdravi A.Riha
P.S. Dr. Skopal se mi "pochlubil", ze se mu pri schuzce
s vami povedlo system shodit - doufam, ze to nebylo nic
zasadniho, nemel jsem cas si to od nej nechat podrobne
vysvetlit.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060914/6f90d842/attachment.html>

From tkovarik at gmail.com  Fri Sep 15 09:45:02 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Fri, 15 Sep 2006 09:45:02 +0200
Subject: [Plantlore-dev] Pridani uzivatele :(
In-Reply-To: <003601c6d895$7db6da60$2c28a20a@Jose>
References: <003601c6d895$7db6da60$2c28a20a@Jose>
Message-ID: <ea88f1620609150045i13379d28w35b161789bd26cf4@mail.gmail.com>

No je divne ze to nefunguje. Toho uzivatela nevytvaram ako databazoveho
superusera ale nastavim mu rolu "Plantlore_Role_Admin". Takze ak sa uzivatel
vola postgres a databaza tester, tak sa vytvori ako:

CREATE ROLE tester_postgres LOGIN
  ENCRYPTED PASSWORD '...md5hash...'
  NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE;
GRANT plantlore_role_admin TO tester_postgres;

a Plantlore_Role_Admin je:

CREATE ROLE plantlore_role_admin LOGIN
  SUPERUSER INHERIT CREATEDB CREATEROLE;
UPDATE pg_authid SET rolcatupdate=true WHERE OID=16405::oid;

Ocividne ale to GRANT plantlore_role_admin TO tester_postgres; nefunguje tak
ako chceme.

Kovo


On 9/15/06, Lada Oberreiterov? <ladaOb at seznam.cz> wrote:
>
>  To vypada, ze uzivatel u nove vytvorene databaze nema dostatecna prava
> pro pridani dalsiho uzivatele.
>
>
>
> net.sf.plantlore.common.exception.DBLayerException: Exception.CreateUser
>
> at net.sf.plantlore.server.HibernateDBLayer.createUser(
> HibernateDBLayer.java:2085)
>
> at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>
> at sun.reflect.NativeMethodAccessorImpl.invoke(
> NativeMethodAccessorImpl.java:39)
>
> at sun.reflect.DelegatingMethodAccessorImpl.invoke(
> DelegatingMethodAccessorImpl.java:25)
>
> at java.lang.reflect.Method.invoke(Method.java:585)
>
> at spin.Invocation.evaluate(Invocation.java:175)
>
> at spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
>
> at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
>
> at spin.JDKProxyFactory$SpinInvocationHandler.invoke(JDKProxyFactory.java
> :102)
>
> at $Proxy0.createUser(Unknown Source)
>
> at net.sf.plantlore.client.login.Login$DBLayerProxy.createUser(Login.java
> :598)
>
> at net.sf.plantlore.client.user.UserManager$2.task(UserManager.java:345)
>
> at net.sf.plantlore.common.Task$1.construct(Task.java:190)
>
> at net.sf.plantlore.common.SwingWorker$2.run(SwingWorker.java:108)
>
> at java.lang.Thread.run(Thread.java:595)
>
> Caused by: java.sql.SQLException: ERROR: permission denied to create role
>
> at org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(
> QueryExecutorImpl.java:1471)
>
> at org.postgresql.core.v3.QueryExecutorImpl.processResults(
> QueryExecutorImpl.java:1256)
>
> at org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java
> :175)
>
> at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(
> AbstractJdbc2Statement.java:389)
>
> at org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(
> AbstractJdbc2Statement.java:330)
>
> at org.postgresql.jdbc2.AbstractJdbc2Statement.execute(
> AbstractJdbc2Statement.java:321)
>
> at net.sf.plantlore.server.HibernateDBLayer.createUser(
> HibernateDBLayer.java:2077)
>
> ... 14 more
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060915/4f6e99a6/attachment.html>

From fraktalek at gmx.net  Fri Sep 15 10:32:54 2006
From: fraktalek at gmx.net (fraktalek)
Date: Fri, 15 Sep 2006 10:32:54 +0200
Subject: [Plantlore-dev] Pridani uzivatele :(
In-Reply-To: <ea88f1620609150045i13379d28w35b161789bd26cf4@mail.gmail.com>
References: <003601c6d895$7db6da60$2c28a20a@Jose>
	<ea88f1620609150045i13379d28w35b161789bd26cf4@mail.gmail.com>
Message-ID: <1158309174.2644.3.camel@kryton>

Tohle se pise v manualu k PostgreSQL:

If WITH ADMIN OPTION is specified, the member may in turn grant
membership in the role to others, and revoke membership in the role as
well. Without the admin option, ordinary users cannot do that. However,
database superusers can grant or revoke membership in any role to
anyone. Roles having CREATEROLE privilege can grant or revoke membership
in any role that is not a superuser.


Podle toho to vypada, ze CREATEROLE a SUPERUSER jdou proti sobe. A navic
by se mozna spis hodilo, aby plantlore_role_admin byl vytvorejen s WITH
ADMIN OPTION.

http://www.postgresql.at/pg/pg810/doc/postgresql/html/sql-grant.html

Tomas Kovarik p??e v P? 15. 09. 2006 v 09:45 +0200:
> No je divne ze to nefunguje. Toho uzivatela nevytvaram ako
> databazoveho superusera ale nastavim mu rolu "Plantlore_Role_Admin".
> Takze ak sa uzivatel vola postgres a databaza tester, tak sa vytvori
> ako:
> 
> CREATE ROLE tester_postgres LOGIN
>   ENCRYPTED PASSWORD '...md5hash...'
>   NOSUPERUSER INHERIT NOCREATEDB NOCREATEROLE;
> GRANT plantlore_role_admin TO tester_postgres;
> 
> a Plantlore_Role_Admin je:
> 
> CREATE ROLE plantlore_role_admin LOGIN
>   SUPERUSER INHERIT CREATEDB CREATEROLE;
> UPDATE pg_authid SET rolcatupdate=true WHERE OID=16405::oid;
> 
> Ocividne ale to GRANT plantlore_role_admin TO tester_postgres;
> nefunguje tak ako chceme.
> 
> Kovo
> 
> 
> On 9/15/06, Lada Oberreiterov? <ladaOb at seznam.cz> wrote:
>         To vypada, ze uzivatel u nove vytvorene databaze nema
>         dostatecna prava pro pridani dalsiho uzivatele.
>         
>          
>         
>         net.sf.plantlore.common.exception.DBLayerException:
>         Exception.CreateUser
>         
>         at
>         net.sf.plantlore.server.HibernateDBLayer.createUser(HibernateDBLayer.java:2085)
>         
>         at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
>         
>         at
>         sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
>         
>         at
>         sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
>         
>         at java.lang.reflect.Method.invoke(Method.java:585)
>         
>         at spin.Invocation.evaluate(Invocation.java:175)
>         
>         at
>         spin.off.SpinOffEvaluator.evaluate(SpinOffEvaluator.java:120)
>         
>         at spin.ProxyFactory.evaluteInvocation(ProxyFactory.java:85)
>         
>         at spin.JDKProxyFactory
>         $SpinInvocationHandler.invoke(JDKProxyFactory.java:102)
>         
>         at $Proxy0.createUser(Unknown Source)
>         
>         at net.sf.plantlore.client.login.Login
>         $DBLayerProxy.createUser(Login.java:598)
>         
>         at net.sf.plantlore.client.user.UserManager
>         $2.task(UserManager.java:345)
>         
>         at net.sf.plantlore.common.Task$1.construct(Task.java:190)
>         
>         at net.sf.plantlore.common.SwingWorker
>         $2.run(SwingWorker.java:108)
>         
>         at java.lang.Thread.run(Thread.java:595)
>         
>         Caused by: java.sql.SQLException: ERROR: permission denied to
>         create role
>         
>         at
>         org.postgresql.core.v3.QueryExecutorImpl.receiveErrorResponse(QueryExecutorImpl.java:1471)
>         
>         at
>         org.postgresql.core.v3.QueryExecutorImpl.processResults(QueryExecutorImpl.java:1256)
>         
>         at
>         org.postgresql.core.v3.QueryExecutorImpl.execute(QueryExecutorImpl.java:175)
>         
>         at
>         org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:389)
>         
>         at
>         org.postgresql.jdbc2.AbstractJdbc2Statement.executeWithFlags(AbstractJdbc2Statement.java:330)
>         
>         at
>         org.postgresql.jdbc2.AbstractJdbc2Statement.execute(AbstractJdbc2Statement.java:321)
>         
>         at
>         net.sf.plantlore.server.HibernateDBLayer.createUser(HibernateDBLayer.java:2077)
>         
>         ... 14 more
>         
>          
>         
>         
> 
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev



From fraktalek at mail.berlios.de  Fri Sep 15 11:01:24 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Fri, 15 Sep 2006 11:01:24 +0200
Subject: [Plantlore-dev] r809 - in
	trunk/src/net/sf/plantlore/client/overview: . search
Message-ID: <200609150901.k8F91OP7002827@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-15 11:01:24 +0200 (Fri, 15 Sep 2006)
New Revision: 809

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
   trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
Log:
Final fix of Bug #8588 - Author table breaks sometimes.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-11 06:22:27 UTC (rev 808)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-15 09:01:24 UTC (rev 809)
@@ -767,6 +767,7 @@
         }
 
         public void popupMenuWillBecomeInvisible(PopupMenuEvent e) {
+            dce.cancelCellEditing();
         }
 
         public void popupMenuCanceled(PopupMenuEvent e) {

Modified: trunk/src/net/sf/plantlore/client/overview/search/SearchView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-11 06:22:27 UTC (rev 808)
+++ trunk/src/net/sf/plantlore/client/overview/search/SearchView.java	2006-09-15 09:01:24 UTC (rev 809)
@@ -693,6 +693,7 @@
         }
 
         public void popupMenuWillBecomeInvisible(PopupMenuEvent e) {
+            dce.cancelCellEditing();
         }
 
         public void popupMenuCanceled(PopupMenuEvent e) {



From admin at berlios.de  Fri Sep 15 10:59:24 2006
From: admin at berlios.de (admin at berlios.de)
Date: Fri, 15 Sep 2006 10:59:24 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8588] Author table breaks sometimes
Message-ID: <200609150859.k8F8xOxn015213@unicorn.berlios.de>

Bug #8588, was updated on 2006-Aug-26 23:08
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview
Status: Closed
Resolution: Fixed
Bug Group: Bug
Priority: 7
Submitted by: fraktalek
Assigned to : fraktalek
Summary: Author table breaks sometimes

Details: In the author table in AddEdit dialog there sometimes appears a combobox in the first column of the Add button row. This seems to break the table... adding and removing of authors is no longer possible and Plantlore throws exceptions...

Idea for steps to reproduce:

1. Run Plantlore and log in
2. Choose an occurrence and invoke the Edit dialog
3. Click on the Add button to add an author in the author table
4. Choose an author from the combobox in the new row
5. Click on Storno of the Edit dialog
6. Invoke the edit dialog again on the same occurrence

Sometimes the above situation occurs...


Follow-Ups:

Date: 2006-Sep-15 10:59
By: fraktalek

Comment:
Fixed in revision 809.
-------------------------------------------------------

Date: 2006-Sep-11 21:26
By: fraktalek

Comment:
Unfortunately appeared again.
New steps to reproduce:
1. open add/edit dialog
2. add an author
3. click twice on the author combo box (once to open the popupmenu and then second time on the combobox)
4. close the dialog
5. open it again

The previous fixes seem to prevent problems on Linux. However, checkAndPropagateChanges() method throws a NPE on Mac OS X...
We should check the behaviour on Windows.
-------------------------------------------------------

Date: 2006-Aug-27 19:33
By: fraktalek

Comment:
Real fix in revision 581: the DefaultCellEditor didn't work together with ComboBox as expected - it didn't stop editing after the combo boxe's popupmenu has been canceled. So I made a patch - a popup menu listener that calls fireEditingStopped() (or canceled..) each time the popup menu is canceled.

Right steps to reproduce were:
1. Invoke for example the Edit dialog
2. Add a new row for an author by clicking on the add buton (and do nothing more)
3. Click into the first column of the new row (and do nothing more)
4. Click somewhere else in the dialog - on a panel, not to a widget, so that only the popupmenu disappears but the combobox is still visible
5. Click on Cancel
6. Invoke edit dialog again on the same row

-------------------------------------------------------

Date: 2006-Aug-26 23:14
By: fraktalek

Comment:
Hopefully patched in commit # 577. The AppCore.setAuthor(int) method checks whether the int is in bounds of the array. So further work with plantlore seems to be possible although the cause hasn't been removed.

-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8588&group_id=5975


From fraktalek at gmx.net  Fri Sep 15 20:53:14 2006
From: fraktalek at gmx.net (fraktalek)
Date: Fri, 15 Sep 2006 20:53:14 +0200
Subject: [Plantlore-dev] navrh grafiky pro prezentaci
Message-ID: <1158346394.2448.0.camel@kryton>

Zatim je to jako prezentace, pak by to asi chtelo z toho vytvorit
sablonu, at to jde rozumne pouzivat.

Jakub

-------------- next part --------------
A non-text attachment was scrubbed...
Name: plantlore.odp
Type: application/vnd.oasis.opendocument.presentation
Size: 208566 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060915/07e1de59/attachment.odp>

From discontinuum at gmail.com  Sat Sep 16 09:56:52 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 16 Sep 2006 09:56:52 +0200
Subject: [Plantlore-dev] JavaDoc
Message-ID: <f4dc39b90609160056q3d823994iaae9045710d5866b@mail.gmail.com>

Zda se, ze behem nasich horecnatych utoku na ruzne druhy dokumentaci se
absolutne zapomnelo na JavaDoc... a tak se v nem muzeme docist

   - jake ma ktera trida private metody a membery (zejmena dobre vedet u
   xxxView.java - jLabel1, jLabel2, ..., jLabel373),
   - ze na projektu s nami pracovali jakub, fraktalek, yaa, ...
   - ze nektere veci nestalo za to vubec komentovat,
   - ze naopak nektere veci prochazely vyvojem: TODO: Malo by hadzat
   DBLayerException.. FIXME: Nezapominat generovat stub!...
   - a ze vubec tematicky obsah nekterych JavaDoc je vic nez kuriozni:
   Occurrence.java: Data holder object representing TAUTHORS table in the
   DB...
   - ze polovina z nas v metodach rozkazuje a druha polovina pouziva 3.os
   .
   - ze generator JavaDocu opomnel pridat encoding tagy, takze veskery
   UTF8 obsah vypada zajimave (prijmeni autoru, odkazy na weby)

A to jsou prosim zazitky po cca 10ti minutach nahodneho klikani :) Dalsi
krok smerem k neobhajeni projektu :)
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/ac41e77f/attachment.html>

From discontinuum at gmail.com  Sat Sep 16 10:47:37 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 16 Sep 2006 10:47:37 +0200
Subject: [Plantlore-dev] Plantlore Demo
Message-ID: <f4dc39b90609160147y74c5c81fp90f6b1a3884574e8@mail.gmail.com>

Par screeshotu, jak vypada Plantlore na mojem pocitaci. Jde o verzi stazenou
z urtaxu.

Ta chyba by mohla mit neco spolecneho s tim, ze jsem do poznamky k lokalite
napsal nevim-kolik znaku.



P.S.
Ja snad radsi ani u ty obhajoby nechcu bejt.
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/2520c01e/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Add.jpg
Type: image/jpeg
Size: 221646 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/2520c01e/attachment.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Detail.jpg
Type: image/jpeg
Size: 91354 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/2520c01e/attachment-0001.jpg>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: Chyba.jpg
Type: image/jpeg
Size: 266094 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/2520c01e/attachment-0002.jpg>

From discontinuum at gmail.com  Sat Sep 16 10:48:18 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Sat, 16 Sep 2006 10:48:18 +0200
Subject: [Plantlore-dev] Demo
Message-ID: <f4dc39b90609160148h40a6567am683b486f68c25f29@mail.gmail.com>

Co bude zabrano v demu:

   1. prihlaseni k aplikaci ~ 10s
   2. pridani noveho zaznamu (vic kytek, skrtak, ...) + dalsi zaznam ~
   60s
   3. ukazka habitat tree s pridanymi zaznamy ~ 10s
   4. ukazka editace ~ 20s
   5. undo provedene zmeny ~ 30s
   6. pridani uzivatele (prava, pokus o editaci cizich kytek) ~ 30s
   7. BSOD (joe king) ~ 2s
   8. vyhledavani ~ 30s
   9. vytvoreni schedy ~ 10s
   10. Webovy klient 30s

Navrhy?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/328b27b1/attachment.html>

From tkovarik at gmail.com  Sat Sep 16 11:06:51 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Sat, 16 Sep 2006 11:06:51 +0200
Subject: [Plantlore-dev] Demo
In-Reply-To: <f4dc39b90609160148h40a6567am683b486f68c25f29@mail.gmail.com>
References: <f4dc39b90609160148h40a6567am683b486f68c25f29@mail.gmail.com>
Message-ID: <ea88f1620609160206p79061bd4icf67baff1fa3f51c@mail.gmail.com>

Hmm, mna napada transformace souradnic a import/export ktore tam nie su
spomenute. Na weboveho klienta by som si dal viac ako 30s...

Kovo

On 9/16/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
>
> Co bude zabrano v demu:
>
>    1. prihlaseni k aplikaci ~ 10s
>    2. pridani noveho zaznamu (vic kytek, skrtak, ...) + dalsi zaznam ~
>    60s
>    3. ukazka habitat tree s pridanymi zaznamy ~ 10s
>    4. ukazka editace ~ 20s
>    5. undo provedene zmeny ~ 30s
>    6. pridani uzivatele (prava, pokus o editaci cizich kytek) ~ 30s
>
>
Ten bod 6 je tiez celkom vtipny, kedze pridavanie uzivatelov vlastne
nefunguje.


>    1. BSOD (joe king) ~ 2s
>    2. vyhledavani ~ 30s
>    3. vytvoreni schedy ~ 10s
>    4. Webovy klient 30s
>
> Navrhy?
>
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/bf2e2aa2/attachment.html>

From ladaOb at seznam.cz  Sat Sep 16 13:17:39 2006
From: ladaOb at seznam.cz (=?ISO-8859-1?Q?Lada_Oberreiterov=E1?=)
Date: Sat, 16 Sep 2006 13:17:39 +0200
Subject: [Plantlore-dev] Demo
References: <f4dc39b90609160148h40a6567am683b486f68c25f29@mail.gmail.com>
	<ea88f1620609160206p79061bd4icf67baff1fa3f51c@mail.gmail.com>
Message-ID: <002601c6d981$c868d580$5723a20a@Jose>

V prihlaseni k aplikaci bude zahrnutu zapnuti serveru, prihlaseni k nemu a ukazaka zobrazeni uzivatele na serveru? Navrhovala bych ukazku se serverem do dema pridat.

Lada
  ----- Original Message ----- 
  From: Tomas Kovarik 
  To: plantlore-dev 
  Sent: Saturday, September 16, 2006 11:06 AM
  Subject: Re: [Plantlore-dev] Demo


  Hmm, mna napada transformace souradnic a import/export ktore tam nie su spomenute. Na weboveho klienta by som si dal viac ako 30s...

  Kovo


  On 9/16/06, Erik Kratochv?l <discontinuum at gmail.com> wrote:
    Co bude zabrano v demu:

      1.. prihlaseni k aplikaci ~ 10s

      2.. pridani noveho zaznamu (vic kytek, skrtak, ...) + dalsi zaznam ~ 60s
      3.. ukazka habitat tree s pridanymi zaznamy ~ 10s

      4.. ukazka editace ~ 20s 
      5.. undo provedene zmeny ~ 30s
      6.. pridani uzivatele (prava, pokus o editaci cizich kytek) ~ 30s

  Ten bod 6 je tiez celkom vtipny, kedze pridavanie uzivatelov vlastne nefunguje. 



      1.. BSOD (joe king) ~ 2s 
      2.. vyhledavani ~ 30s

      3.. vytvoreni schedy ~ 10s 
      4.. Webovy klient 30s
    Navrhy?


    _______________________________________________
    Plantlore-dev mailing list
    Plantlore-dev at lists.berlios.de 
    https://lists.berlios.de/mailman/listinfo/plantlore-dev







------------------------------------------------------------------------------


  _______________________________________________
  Plantlore-dev mailing list
  Plantlore-dev at lists.berlios.de
  https://lists.berlios.de/mailman/listinfo/plantlore-dev


  __________ NOD32 1.1758 (20060915) Information __________

  This message was checked by NOD32 antivirus system.
  http://www.eset.com

-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060916/76162fb8/attachment.html>

From fraktalek at mail.berlios.de  Sat Sep 16 17:57:23 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 16 Sep 2006 17:57:23 +0200
Subject: [Plantlore-dev] r810 -
	trunk/src/net/sf/plantlore/client/overview/detail
Message-ID: <200609161557.k8GFvNxb003242@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-16 17:57:23 +0200 (Sat, 16 Sep 2006)
New Revision: 810

Modified:
   trunk/src/net/sf/plantlore/client/overview/detail/Detail.java
Log:
Contents of quadrant and habitat note were switched. Fixed now.



Modified: trunk/src/net/sf/plantlore/client/overview/detail/Detail.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/detail/Detail.java	2006-09-15 09:01:24 UTC (rev 809)
+++ trunk/src/net/sf/plantlore/client/overview/detail/Detail.java	2006-09-16 15:57:23 UTC (rev 810)
@@ -160,8 +160,8 @@
                 longitude = (Double)pa[13];
                 country = (String)pa[14];
                 placeDescription = (String)pa[15];
-                quadrant = (String)pa[16];
-                habNote = (String)pa[17];
+                quadrant = (String)pa[17];
+                habNote = (String)pa[16];
                 village = (String)pa[18];
                 project = (String)pa[19];
                 phytCode = (String)pa[20];



From fraktalek at mail.berlios.de  Sat Sep 16 18:05:41 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sat, 16 Sep 2006 18:05:41 +0200
Subject: [Plantlore-dev] r811 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609161605.k8GG5fXA003769@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-16 18:05:40 +0200 (Sat, 16 Sep 2006)
New Revision: 811

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEditView.form
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
Log:
AddEdit horizontal resizing fixed.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-16 15:57:23 UTC (rev 810)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-09-16 16:05:40 UTC (rev 811)
@@ -59,7 +59,7 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Component id="jScrollPane8" alignment="0" pref="943" max="32767" attributes="0"/>
+          <Component id="jScrollPane8" alignment="0" pref="946" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
@@ -122,10 +122,9 @@
                       <Group type="102" alignment="0" attributes="0">
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="jPanel7" alignment="0" min="-2" max="-2" attributes="3"/>
-                              <Component id="jPanel5" alignment="0" min="-2" max="-2" attributes="1"/>
+                              <Component id="jPanel7" alignment="0" pref="921" max="32767" attributes="3"/>
+                              <Component id="jPanel5" alignment="0" pref="921" max="32767" attributes="1"/>
                           </Group>
-                          <EmptySpace max="32767" attributes="0"/>
                       </Group>
                   </Group>
                 </DimensionLayout>
@@ -218,7 +217,7 @@
                                       <EmptySpace max="-2" attributes="0"/>
                                   </Group>
                               </Group>
-                              <EmptySpace min="-2" pref="69" max="-2" attributes="0"/>
+                              <EmptySpace min="-2" pref="52" max="-2" attributes="0"/>
                           </Group>
                       </Group>
                     </DimensionLayout>
@@ -592,13 +591,13 @@
                                       <Group type="103" groupAlignment="0" attributes="0">
                                           <Group type="102" alignment="0" attributes="0">
                                               <Component id="checklistButton" linkSize="21" min="-2" max="-2" attributes="0"/>
-                                              <EmptySpace pref="232" max="32767" attributes="0"/>
+                                              <EmptySpace pref="235" max="32767" attributes="0"/>
                                               <Component id="clearOccurrenceButton" linkSize="21" min="-2" max="-2" attributes="0"/>
                                           </Group>
                                           <Component id="jPanel4" min="-2" max="-2" attributes="1"/>
                                       </Group>
                                   </Group>
-                                  <Component id="jScrollPane1" pref="645" max="32767" attributes="1"/>
+                                  <Component id="jScrollPane1" pref="648" max="32767" attributes="1"/>
                               </Group>
                               <EmptySpace max="-2" attributes="0"/>
                               <Group type="103" groupAlignment="0" attributes="0">
@@ -611,11 +610,11 @@
                                       </Group>
                                       <EmptySpace max="-2" attributes="0"/>
                                       <Group type="103" groupAlignment="0" attributes="0">
-                                          <Component id="herbariumTextField" alignment="0" pref="132" max="32767" attributes="1"/>
-                                          <Component id="publicationCombo" alignment="0" pref="132" max="32767" attributes="1"/>
-                                          <Component id="projectCombo" alignment="0" pref="132" max="32767" attributes="1"/>
+                                          <Component id="herbariumTextField" alignment="0" pref="136" max="32767" attributes="1"/>
+                                          <Component id="publicationCombo" alignment="0" pref="136" max="32767" attributes="1"/>
+                                          <Component id="projectCombo" alignment="0" pref="136" max="32767" attributes="1"/>
                                           <Group type="102" alignment="0" attributes="0">
-                                              <Component id="sourceCombo" pref="132" max="32767" attributes="1"/>
+                                              <Component id="sourceCombo" pref="136" max="32767" attributes="1"/>
                                               <EmptySpace max="-2" attributes="0"/>
                                           </Group>
                                       </Group>
@@ -1047,7 +1046,7 @@
                           <Component id="settingsButton" linkSize="12" min="-2" max="-2" attributes="0"/>
                           <EmptySpace min="-2" pref="64" max="-2" attributes="0"/>
                           <Component id="requiredInfoLabel" min="-2" max="-2" attributes="0"/>
-                          <EmptySpace pref="350" max="32767" attributes="0"/>
+                          <EmptySpace pref="353" max="32767" attributes="0"/>
                           <Component id="okButton" linkSize="12" min="-2" max="-2" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="cancelButton" linkSize="12" min="-2" max="-2" attributes="0"/>
@@ -1142,7 +1141,7 @@
                   <Group type="103" groupAlignment="0" attributes="0">
                       <Group type="102" alignment="0" attributes="0">
                           <EmptySpace max="-2" attributes="0"/>
-                          <Component id="jScrollPane6" pref="906" max="32767" attributes="0"/>
+                          <Component id="jScrollPane6" pref="909" max="32767" attributes="0"/>
                           <EmptySpace max="-2" attributes="0"/>
                       </Group>
                   </Group>

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-16 15:57:23 UTC (rev 810)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-09-16 16:05:40 UTC (rev 811)
@@ -348,7 +348,7 @@
                                     .add(locationNoteLabel)
                                     .add(jScrollPane4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 286, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
-                .add(69, 69, 69))
+                .add(52, 52, 52))
         );
 
         jPanel5Layout.linkSize(new java.awt.Component[] {quadrantTextField, territoryNameCombo}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
@@ -534,10 +534,10 @@
                         .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jPanel7Layout.createSequentialGroup()
                                 .add(checklistButton)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 232, Short.MAX_VALUE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 235, Short.MAX_VALUE)
                                 .add(clearOccurrenceButton))
                             .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 645, Short.MAX_VALUE))
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 648, Short.MAX_VALUE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7Layout.createSequentialGroup()
@@ -548,11 +548,11 @@
                             .add(herbariumLabel))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(herbariumTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 132, Short.MAX_VALUE)
-                            .add(publicationCombo, 0, 132, Short.MAX_VALUE)
-                            .add(projectCombo, 0, 132, Short.MAX_VALUE)
+                            .add(herbariumTextField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 136, Short.MAX_VALUE)
+                            .add(publicationCombo, 0, 136, Short.MAX_VALUE)
+                            .add(projectCombo, 0, 136, Short.MAX_VALUE)
                             .add(jPanel7Layout.createSequentialGroup()
-                                .add(sourceCombo, 0, 132, Short.MAX_VALUE)
+                                .add(sourceCombo, 0, 136, Short.MAX_VALUE)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                         .add(19, 19, 19))
                     .add(jPanel7Layout.createSequentialGroup()
@@ -615,9 +615,8 @@
             .add(basicPanelLayout.createSequentialGroup()
                 .addContainerGap()
                 .add(basicPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jPanel7, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(jPanel5, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 921, Short.MAX_VALUE)
+                    .add(jPanel5, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 921, Short.MAX_VALUE)))
         );
         basicPanelLayout.setVerticalGroup(
             basicPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -656,7 +655,7 @@
                 .add(settingsButton)
                 .add(64, 64, 64)
                 .add(requiredInfoLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 350, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 353, Short.MAX_VALUE)
                 .add(okButton)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(cancelButton)
@@ -718,7 +717,7 @@
             extendedPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(extendedPanelLayout.createSequentialGroup()
                 .addContainerGap()
-                .add(jScrollPane6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 906, Short.MAX_VALUE)
+                .add(jScrollPane6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 909, Short.MAX_VALUE)
                 .addContainerGap())
         );
         extendedPanelLayout.setVerticalGroup(
@@ -735,7 +734,7 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jScrollPane8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 943, Short.MAX_VALUE)
+            .add(jScrollPane8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 946, Short.MAX_VALUE)
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)



From krater at mail.berlios.de  Sun Sep 17 21:59:35 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 17 Sep 2006 21:59:35 +0200
Subject: [Plantlore-dev] r812 - trunk/src/net/sf/plantlore/common
Message-ID: <200609171959.k8HJxZlN006053@sheep.berlios.de>

Author: krater
Date: 2006-09-17 21:59:34 +0200 (Sun, 17 Sep 2006)
New Revision: 812

Modified:
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
e.printStackTrace() removed

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-16 16:05:40 UTC (rev 811)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-17 19:59:34 UTC (rev 812)
@@ -1114,7 +1114,6 @@
 			
 		} catch(DBLayerException e) {
 			// Roll back the transaction.
-			e.printStackTrace();
 			db.rollbackTransaction();
 			throw e;
 		} catch(RemoteException e) {



From krater at mail.berlios.de  Sun Sep 17 22:35:58 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Sun, 17 Sep 2006 22:35:58 +0200
Subject: [Plantlore-dev] r813 - trunk/src/net/sf/plantlore/common/exception
Message-ID: <200609172035.k8HKZwA1008799@sheep.berlios.de>

Author: krater
Date: 2006-09-17 22:35:54 +0200 (Sun, 17 Sep 2006)
New Revision: 813

Modified:
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
Log:
Fixed possible source of problems if JDBCException.getSQLState() returns null.

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-17 19:59:34 UTC (rev 812)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-17 20:35:54 UTC (rev 813)
@@ -202,6 +202,9 @@
          *  @return DBLayerException constant identifying a problem
          */
         public int translateSQLState(String sqlstate) {
+        	if( sqlstate == null )
+        		return ERROR_OTHER;
+        	
             String errorClass = sqlstate.substring(0,2);
             String errorDetail = sqlstate.substring(2);
             



From fraktalek at mail.berlios.de  Sun Sep 17 23:13:36 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Sun, 17 Sep 2006 23:13:36 +0200
Subject: [Plantlore-dev] r814 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609172113.k8HLDadM012426@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-17 23:13:35 +0200 (Sun, 17 Sep 2006)
New Revision: 814

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
Log:
Fixed the NPE thrown after adding a new occurrence into an empty database or to be precise to a database not containing any country or source yet.
It caused the empty error dialog to show up.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-17 20:35:54 UTC (rev 813)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-17 21:13:35 UTC (rev 814)
@@ -1240,22 +1240,28 @@
         int i = 0;
         
         boolean isCountryNew = true;
-        for (String country : countries)
-            if (country.equals(phytCountry)) {
-                isCountryNew = false;
-                break;
-            }
-        if (isCountryNew)
-            i++;
+        if (countries != null) { //for example after installation there are initially no countries
+            for (String country : countries)
+                if (country.equals(phytCountry)) {
+                    isCountryNew = false;
+                    break;
+                }
+            if (isCountryNew)
+                i++;
+        } else
+            isCountryNew = false;
         
         boolean isSourceNew = true;
-        for (String s : sources)
-            if (s.equals(source)) {
-                isSourceNew = false;
-                break;
-            }
-        if (isSourceNew)
-            i++;
+        if (sources != null) { //sources also can quite possibly be empty
+            for (String s : sources)
+                if (s.equals(source)) {
+                    isSourceNew = false;
+                    break;
+                }
+            if (isSourceNew)
+                i++;
+        } else
+            isSourceNew = false;
             
         if (i > 0) { //there's been some change we must report
             logger.debug("REPORTING CHANGE!");



From kovo at mail.berlios.de  Mon Sep 18 00:10:01 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Mon, 18 Sep 2006 00:10:01 +0200
Subject: [Plantlore-dev] r815 - trunk/src/net/sf/plantlore/server
Message-ID: <200609172210.k8HMA1ni018170@sheep.berlios.de>

Author: kovo
Date: 2006-09-18 00:10:01 +0200 (Mon, 18 Sep 2006)
New Revision: 815

Modified:
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
User that is created together with the new database has now SUPERUSER rights and can add/alter/drop other users.

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-17 21:13:35 UTC (rev 814)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-17 22:10:01 UTC (rev 815)
@@ -2287,7 +2287,7 @@
         }
         // In case we are creating users, add statement to create first user for accesing plantlore
         if (scriptid == DBLayer.CREATE_USERS) {
-            sql.append("CREATE USER "+dbname+"_"+username+" PASSWORD '"+password+"';");
+            sql.append("CREATE USER "+dbname+"_"+username+" PASSWORD '"+password+"' SUPERUSER;");
             sql.append("CREATE USER "+dbname+"_www PASSWORD 'plantlore';");
             sql.append("GRANT Plantlore_Role_Admin TO "+dbname+"_"+username+";");
             sql.append("GRANT Plantlore_Role_www TO "+dbname+"_www;");            



From krater at mail.berlios.de  Mon Sep 18 10:34:20 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 10:34:20 +0200
Subject: [Plantlore-dev] r816 - in trunk/src/net/sf/plantlore: client/login
	middleware server
Message-ID: <200609180834.k8I8YKnC022426@sheep.berlios.de>

Author: krater
Date: 2006-09-18 10:34:19 +0200 (Mon, 18 Sep 2006)
New Revision: 816

Modified:
   trunk/src/net/sf/plantlore/client/login/Login.java
   trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/server/ConnectionInfo.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Login::DatabaseSelection works on double click (behaves the same way as if Next is pressed).
ConnectionInfo::Fixed a minor bug that used toString on DBLayer stubs leading to an improper description of the database layer.

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-17 22:10:01 UTC (rev 815)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-18 08:34:19 UTC (rev 816)
@@ -636,6 +636,10 @@
 			return "Safety wrapper of " + super.toString();
 		}
 		
+		public String getDescription() {
+			return super.toString();
+		}
+		
 	}
         
 }

Modified: trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-17 22:10:01 UTC (rev 815)
+++ trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-18 08:34:19 UTC (rev 816)
@@ -1,6 +1,9 @@
 package net.sf.plantlore.client.login;
 
+import java.awt.Rectangle;
 import java.awt.event.ActionEvent;
+import java.awt.event.MouseAdapter;
+import java.awt.event.MouseEvent;
 
 import javax.swing.AbstractAction;
 import javax.swing.JDialog;
@@ -45,6 +48,7 @@
 		new AuthCtrl(model, authView);
 		
 		view.choice.addListSelectionListener(new ChoiceChanged());
+		view.choice.addMouseListener( new DoubleClictListener() );
 		view.add.setAction(new AddRecordAction());
 		view.edit.setAction(new EditRecordAction());
 		view.remove.setAction(new RemoveRecordAction());
@@ -134,5 +138,19 @@
 				authView.setVisible(true);
 		}
 	}
+	
+	class DoubleClictListener extends MouseAdapter {
+		@Override
+		public void mouseClicked(MouseEvent me) {
+			if( me.getClickCount() == 2 && model.getSelected() != null ) {
+				
+				int index = view.choice.getSelectedIndex();
+				if(index < 0) return;
+				Rectangle area = view.choice.getCellBounds(index, index);
+				if( area != null && area.contains( me.getPoint() ) )
+					authView.setVisible(true);
+			}
+		}
+	}
 
 }

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-17 22:10:01 UTC (rev 815)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-18 08:34:19 UTC (rev 816)
@@ -390,5 +390,13 @@
      * created by this DBLayer. <br/> 
      */
     public void shutdown() throws RemoteException;
+    
+    
+    /**
+     * 
+     * @return	description of this database layer so that the user can easily identify it
+     * @throws RemoteException	in case network error occurred
+     */
+    public String getDescription() throws RemoteException;
            
 }

Modified: trunk/src/net/sf/plantlore/server/ConnectionInfo.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-17 22:10:01 UTC (rev 815)
+++ trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-18 08:34:19 UTC (rev 816)
@@ -1,6 +1,7 @@
 package net.sf.plantlore.server;
 
 import java.io.Serializable;
+import java.rmi.RemoteException;
 
 import net.sf.plantlore.middleware.DBLayer;
 import net.sf.plantlore.middleware.RemoteDBLayerFactory;
@@ -74,7 +75,11 @@
 
 	@Override
 	public String toString() {
-		return database + " @ " + description;
+		try {
+			return database.getDescription() + " @ " + description;
+		} catch( RemoteException e ) {
+			return "? @ " + description;
+		}
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-17 22:10:01 UTC (rev 815)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 08:34:19 UTC (rev 816)
@@ -2409,4 +2409,11 @@
 				" (" + currentlyConnectedUser + ")"; 
 		return currentlyConnectedUser ; 
 	}
+	
+	/**
+	 * @return description of this database layer: Name Surname (login).
+	 */
+	public String getDescription() {
+		return toString();
+	}
 }



From lada at mail.berlios.de  Mon Sep 18 11:36:51 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 11:36:51 +0200
Subject: [Plantlore-dev] r817 - in trunk/src/net/sf/plantlore:
	client/history server
Message-ID: <200609180936.k8I9apOm029787@sheep.berlios.de>

Author: lada
Date: 2006-09-18 11:36:50 +0200 (Mon, 18 Sep 2006)
New Revision: 817

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Fix bug in History - UNDO author of occurrence is working now correctly.
HibernateDBLayer - change saving value for authorOccurrence:
historyChange.recordId = occurrence.cId
history.oldRecordId = authorOccurrence.cId

Show only data from table tOccurrence in HISTORY OF RECORD.

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 08:34:19 UTC (rev 816)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 09:36:50 UTC (rev 817)
@@ -142,6 +142,7 @@
     /** Constants used for description of errors */    
     public static final String ERROR_SEARCH_OBJECT = "Error.HistoryObjectSearchFailed";
     public static final String ERROR_SEARCH_AUTHOR = "Error.HistoryAuthorSearchFailed";
+    public static final String ERROR_SEARCH_AUTHOR_NULL = "Error.HistoryAuthorSearchNull";
     public static final String ERROR_PROCESS = "Error.HistoryProcessResultsFailed"; 
     public static final String ERROR_PARSE_DATE = "Error.HistoryParseData"; // 
     public static final String ERROR_NO_RIGHTS = "Error.HistoryNoRights"; //
@@ -296,12 +297,14 @@
 
     	//Select data from tHistory table
         try {        	        	
-		    query = database.createQuery(HistoryRecord.class);
+		query = database.createQuery(HistoryRecord.class);
 		    // Create aliases for table tHistoryChange.      
-	        query.createAlias("historyChange", "hc");        
+	        query.createAlias("historyChange", "hc");  
+                query.createAlias("historyColumn", "hcol");
 	        // Add restriction to COPERATION column of tHistoryChange table
 	        if (data instanceof Occurrence) {	        	       
 		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Occurrence)data).getId(), null);  
+                        query.addRestriction(PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE, null);
 	        } else if (data instanceof Habitat) {	        	        
 		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Habitat)data).getId(), null);  
 	        }	
@@ -500,7 +503,7 @@
              //Update author of specific occurrence
              isDelete = (isDelete == 1) ? 2 : isDelete;
              Object[] objects = getAllAuthors(occurrence, 2-isDelete);
-             if (isError()) return; //Search authors failed
+             if (isError()) return; //Search authors failed or null object
              int countResult = objects.length;               
              for (int i=0; i<countResult; i++ ) {                    							
                 Object[] autOcc = (Object[])objects[i];          
@@ -640,7 +643,7 @@
      */
     public void undoAuthorOccurrence() {
         
-    	int authorOccId = historyChange.getRecordId();
+    	int authorOccId = oldRecordId;
     	occurrenceId = historyChange.getRecordId();	
     	AuthorOccurrence authorOccurrence = null;
     	int placings = 0;
@@ -658,7 +661,7 @@
     	}    
     	
     	if (!contain) {
-        	// Select record AuthorOccurrence where id = authorOccurrenceId 
+        	// Select record AuthorOccurrence where id = authorOccurrenceId                   
     		Object[] object = searchObject(PlantloreConstants.ENTITY_AUTHOROCCURRENCE, authorOccId);
     		if (isError()) return; //tAuthorOccurrence doesn`t contain required data
                authorOccurrence = (AuthorOccurrence)object[0];
@@ -680,7 +683,7 @@
                 if (authorOccurrence.getDeleted() == 1) {
                     authorOccurrence.setDeleted(0);
                 } else {
-                    authorOccurrence.setDeleted(1);
+                    authorOccurrence.setDeleted(1);                    
                 }                
                 break;
             case 2: //Role of author

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 08:34:19 UTC (rev 816)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 09:36:50 UTC (rev 817)
@@ -1585,7 +1585,7 @@
                     updated = AuthorOccurrence.class;
                     updatedId = ((AuthorOccurrence)data).getId();
                     tableId = AuthorOccurrence.ID;                    
-                    historyChange.setRecordId(((AuthorOccurrence)data).getId());
+                    historyChange.setRecordId(((AuthorOccurrence)data).getOccurrence().getId());
                 } else
                 if (data instanceof Habitat) {
                     updated = Habitat.class;
@@ -1732,7 +1732,7 @@
                         HistoryRecord hist = new HistoryRecord(); 
                         hist.setHistoryChange(historyChange);                        
                         hist.setHistoryColumn((HistoryColumn)hc[0]);
-                        hist.setOldRecordId(0);
+                        hist.setOldRecordId(newRec.getId());
                         if ( newRec.getDeleted() == 1) {
 	                        hist.setNewValue(null);
 	                        hist.setOldValue(newRec.getAuthor().getWholeName());
@@ -1769,7 +1769,7 @@
 	                            HistoryRecord hist = new HistoryRecord();
 	                            hist.setHistoryChange(historyChange);	                            	                           
 	                            hist.setHistoryColumn((HistoryColumn)colNames[0]);  
-	                            hist.setOldRecordId(0);
+	                            hist.setOldRecordId(newRec.getId());
 	                            String origValueString = (origRec.getValue((String)cols.get(i)) == null) ? null : origValue.toString(),
 	                           			   newValueString = (newRec.getValue((String)cols.get(i)) == null) ? null : newValue.toString(); 
 	                      		hist.setOldValue(origValueString);



From krater at mail.berlios.de  Mon Sep 18 12:14:31 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 12:14:31 +0200
Subject: [Plantlore-dev] r818 - in trunk/src/net/sf/plantlore: client/login
	client/resources common server/manager server/tools
Message-ID: <200609181014.k8IAEVku000997@sheep.berlios.de>

Author: krater
Date: 2006-09-18 12:14:31 +0200 (Mon, 18 Sep 2006)
New Revision: 818

Added:
   trunk/src/net/sf/plantlore/client/resources/splash_mini.jpg
Modified:
   trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
   trunk/src/net/sf/plantlore/common/Dispatcher.java
   trunk/src/net/sf/plantlore/common/ProgressBarManager.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Dispatcher&ProgressBar::Do not necessarily hide the progress bar (it may cause layout problems).
ServerCreate::PlantloreLogo finally added. ProgressBar must have been moved down.

Proper Host IP::pending, solution unknown.

Modified: trunk/src/net/sf/plantlore/client/login/LoginCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/client/login/LoginCtrl.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -139,6 +139,10 @@
 		}
 	}
 	
+	/**
+	 * Proceed to the Authorization - open the `Authentication` dialog.
+	 * (double click on the selected item). 
+	 */
 	class DoubleClictListener extends MouseAdapter {
 		@Override
 		public void mouseClicked(MouseEvent me) {

Added: trunk/src/net/sf/plantlore/client/resources/splash_mini.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/splash_mini.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/common/Dispatcher.java
===================================================================
--- trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/common/Dispatcher.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -107,11 +107,19 @@
         return dispatcher;
     }
     
-    public static void initialize(JProgressBar pb) {
+    synchronized public static void initialize(JProgressBar pb) {
         if (pb == null) {
             throw new IllegalArgumentException("Dispatcher can't be initialized with null progress bar!");
         }
         pbm = new ProgressBarManager(pb);
     }
+    
+    synchronized public static void initialize(JProgressBar pb, boolean doNotHide) {
+        if (pb == null) {
+            throw new IllegalArgumentException("Dispatcher can't be initialized with null progress bar!");
+        }
+        pbm = new ProgressBarManager(pb, doNotHide);
+    }
+    
 }
 

Modified: trunk/src/net/sf/plantlore/common/ProgressBarManager.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/common/ProgressBarManager.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -30,6 +30,7 @@
     private JProgressBar progressBar;
     private Window parent;
     private Task task;
+    private boolean doNotHide = false;
     
     /** Creates a new instance of ProgressBarApp */
     public ProgressBarManager(JProgressBar progressBar) {
@@ -37,6 +38,13 @@
         progressBar.setString("");
         progressBar.setStringPainted(true);
     }
+    
+    public ProgressBarManager(JProgressBar progressBar, boolean doNotHide) {
+        this.progressBar = progressBar;
+        progressBar.setString("");
+        progressBar.setStringPainted(true);
+        this.doNotHide = doNotHide;
+    }
 
     public void setParent(JDialog parent) {
         this.parent = parent;       
@@ -95,10 +103,13 @@
      */
     private synchronized void stop() {
         ended = true;
-        progressBar.setVisible(false);
+        if( !doNotHide ) progressBar.setVisible(false);
         if (parent != null) {
             parent.setCursor(Cursor.getDefaultCursor());
             parent.setEnabled(true);
+            // "Deactivate" the progress bar.
+            progressBar.setString("");
+            progressBar.setIndeterminate(false);
         }
         logger.debug(""+this+" STOPPING " + task );
         //!!! afterStopping();        

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -23,7 +23,7 @@
 	
 	public ServerCreateCtrl(final ServerMng model, final ServerCreateView view) {
             
-		Dispatcher.initialize( view.progress );
+		Dispatcher.initialize( view.progress, true );
 		
 		mngView = new ServerMngView(model);
 		new ServerMngCtrl(model, mngView);

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-09-18 10:14:31 UTC (rev 818)
@@ -21,86 +21,49 @@
   <Layout>
     <DimensionLayout dim="0">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" alignment="1" attributes="0">
-              <EmptySpace min="-2" max="-2" attributes="0"/>
-              <Group type="103" groupAlignment="1" attributes="0">
-                  <Component id="choicePane" alignment="0" pref="408" max="32767" attributes="1"/>
-                  <Group type="102" alignment="1" attributes="1">
+          <Group type="102" alignment="0" attributes="0">
+              <EmptySpace max="-2" attributes="0"/>
+              <Group type="103" groupAlignment="0" attributes="0">
+                  <Group type="102" attributes="0">
+                      <Group type="103" groupAlignment="0" attributes="0">
+                          <Component id="logo" alignment="0" pref="431" max="32767" attributes="0"/>
+                          <Component id="choicePane" alignment="0" pref="431" max="32767" attributes="1"/>
+                      </Group>
+                      <EmptySpace max="-2" attributes="0"/>
+                  </Group>
+                  <Group type="102" alignment="1" attributes="0">
                       <Component id="help" min="-2" max="-2" attributes="0"/>
-                      <EmptySpace pref="191" max="32767" attributes="0"/>
+                      <EmptySpace pref="214" max="32767" attributes="0"/>
                       <Component id="next" linkSize="3" min="-2" max="-2" attributes="0"/>
                       <EmptySpace max="-2" attributes="0"/>
                       <Component id="cancel" linkSize="3" min="-2" max="-2" attributes="0"/>
+                      <EmptySpace max="-2" attributes="0"/>
                   </Group>
-                  <Component id="plantloreLogo" alignment="0" pref="408" max="32767" attributes="2"/>
               </Group>
-              <EmptySpace min="-2" max="-2" attributes="0"/>
           </Group>
+          <Component id="jPanel6" alignment="1" max="32767" attributes="0"/>
       </Group>
     </DimensionLayout>
     <DimensionLayout dim="1">
       <Group type="103" groupAlignment="0" attributes="0">
-          <Group type="102" alignment="0" attributes="0">
+          <Group type="102" alignment="1" attributes="0">
               <EmptySpace max="-2" attributes="0"/>
-              <Component id="plantloreLogo" min="-2" max="-2" attributes="0"/>
+              <Component id="logo" min="-2" pref="133" max="-2" attributes="0"/>
               <EmptySpace max="-2" attributes="0"/>
               <Component id="choicePane" min="-2" pref="174" max="-2" attributes="0"/>
               <EmptySpace max="32767" attributes="0"/>
               <Group type="103" groupAlignment="3" attributes="0">
                   <Component id="help" alignment="3" min="-2" max="-2" attributes="0"/>
+                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
                   <Component id="cancel" alignment="3" min="-2" max="-2" attributes="0"/>
-                  <Component id="next" alignment="3" min="-2" max="-2" attributes="0"/>
               </Group>
               <EmptySpace max="-2" attributes="0"/>
+              <Component id="jPanel6" min="-2" max="-2" attributes="0"/>
           </Group>
       </Group>
     </DimensionLayout>
   </Layout>
   <SubComponents>
-    <Container class="javax.swing.JPanel" name="plantloreLogo">
-      <Properties>
-        <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
-          <Color blue="0" green="0" red="0" type="rgb"/>
-        </Property>
-        <Property name="preferredSize" type="java.awt.Dimension" editor="org.netbeans.beaninfo.editors.DimensionEditor">
-          <Dimension value="[300, 100]"/>
-        </Property>
-      </Properties>
-      <AuxValues>
-        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-      </AuxValues>
-
-      <Layout>
-        <DimensionLayout dim="0">
-          <Group type="103" groupAlignment="0" attributes="0">
-              <Group type="102" alignment="1" attributes="0">
-                  <EmptySpace pref="165" max="32767" attributes="0"/>
-                  <Component id="progress" min="-2" pref="233" max="-2" attributes="0"/>
-                  <EmptySpace max="-2" attributes="0"/>
-              </Group>
-          </Group>
-        </DimensionLayout>
-        <DimensionLayout dim="1">
-          <Group type="103" groupAlignment="0" attributes="0">
-              <Group type="102" alignment="1" attributes="0">
-                  <EmptySpace pref="71" max="32767" attributes="0"/>
-                  <Component id="progress" min="-2" max="-2" attributes="0"/>
-                  <EmptySpace max="-2" attributes="0"/>
-              </Group>
-          </Group>
-        </DimensionLayout>
-      </Layout>
-      <SubComponents>
-        <Component class="javax.swing.JProgressBar" name="progress">
-          <Properties>
-            <Property name="borderPainted" type="boolean" value="false"/>
-          </Properties>
-          <AuxValues>
-            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
-          </AuxValues>
-        </Component>
-      </SubComponents>
-    </Container>
     <Component class="javax.swing.JButton" name="next">
       <Properties>
         <Property name="text" type="java.lang.String" editor="org.netbeans.modules.i18n.form.FormI18nStringEditor">
@@ -142,7 +105,7 @@
           <Layout>
             <DimensionLayout dim="0">
               <Group type="103" groupAlignment="0" attributes="0">
-                  <Component id="jPanel1" alignment="0" pref="403" max="32767" attributes="1"/>
+                  <Component id="jPanel1" alignment="0" pref="426" max="32767" attributes="1"/>
                   <Component id="jPanel2" alignment="0" max="32767" attributes="0"/>
               </Group>
             </DimensionLayout>
@@ -260,13 +223,13 @@
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
                               <Group type="102" attributes="0">
-                                  <Component id="databaseType" pref="234" max="32767" attributes="0"/>
+                                  <Component id="databaseType" pref="257" max="32767" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Component id="jLabel6" min="-2" max="-2" attributes="0"/>
                                   <EmptySpace max="-2" attributes="0"/>
                                   <Component id="databasePort" min="-2" pref="51" max="-2" attributes="0"/>
                               </Group>
-                              <Component id="databaseParameter" pref="313" max="32767" attributes="0"/>
+                              <Component id="databaseParameter" pref="336" max="32767" attributes="0"/>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                       </Group>
@@ -411,8 +374,8 @@
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                           <Group type="103" groupAlignment="0" attributes="0">
-                              <Component id="remoteHost" alignment="0" pref="239" max="32767" attributes="2"/>
-                              <Component id="remoteServerPassword" alignment="0" pref="239" max="32767" attributes="2"/>
+                              <Component id="remoteHost" alignment="0" pref="262" max="32767" attributes="2"/>
+                              <Component id="remoteServerPassword" alignment="0" pref="262" max="32767" attributes="2"/>
                           </Group>
                           <EmptySpace max="-2" attributes="0"/>
                           <Component id="jLabel8" min="-2" max="-2" attributes="0"/>
@@ -513,5 +476,51 @@
         <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
       </AuxValues>
     </Component>
+    <Component class="javax.swing.JLabel" name="logo">
+      <Properties>
+        <Property name="background" type="java.awt.Color" editor="org.netbeans.beaninfo.editors.ColorEditor">
+          <Color blue="0" green="0" red="0" type="rgb"/>
+        </Property>
+      </Properties>
+      <AuxValues>
+        <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+      </AuxValues>
+    </Component>
+    <Container class="javax.swing.JPanel" name="jPanel6">
+      <Properties>
+        <Property name="border" type="javax.swing.border.Border" editor="org.netbeans.modules.form.editors2.BorderEditor">
+          <Border info="org.netbeans.modules.form.compat2.border.BevelBorderInfo">
+            <BevelBorder bevelType="1"/>
+          </Border>
+        </Property>
+      </Properties>
+
+      <Layout>
+        <DimensionLayout dim="0">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Group type="102" alignment="0" attributes="0">
+                  <EmptySpace max="-2" attributes="0"/>
+                  <Component id="progress" pref="427" max="32767" attributes="0"/>
+                  <EmptySpace max="-2" attributes="0"/>
+              </Group>
+          </Group>
+        </DimensionLayout>
+        <DimensionLayout dim="1">
+          <Group type="103" groupAlignment="0" attributes="0">
+              <Component id="progress" min="-2" max="-2" attributes="0"/>
+          </Group>
+        </DimensionLayout>
+      </Layout>
+      <SubComponents>
+        <Component class="javax.swing.JProgressBar" name="progress">
+          <Properties>
+            <Property name="borderPainted" type="boolean" value="false"/>
+          </Properties>
+          <AuxValues>
+            <AuxValue name="JavaCodeGenerator_VariableModifier" type="java.lang.Integer" value="4"/>
+          </AuxValues>
+        </Component>
+      </SubComponents>
+    </Container>
   </SubComponents>
 </Form>

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -9,6 +9,9 @@
 import java.util.Observable;
 import java.util.Observer;
 
+import javax.swing.ImageIcon;
+
+import net.sf.plantlore.client.AppCoreView;
 import net.sf.plantlore.common.DocumentSizeFilter;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
@@ -51,7 +54,7 @@
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
         
         // Show the progress bar only when necessary.
-        progress.setVisible( false );
+        //progress.setVisible( false );
         
         DocumentSizeFilter.patch(serverPassword, 20);
         DocumentSizeFilter.patch(serverPort, 5);
@@ -61,6 +64,10 @@
         DocumentSizeFilter.patch(remoteHost, 50);
         DocumentSizeFilter.patch(remoteServerPort, 5);
         DocumentSizeFilter.patch(remoteServerPassword, 20);
+        
+        logo.setIcon(
+        		new ImageIcon(java.awt.Toolkit.getDefaultToolkit().getImage(AppCoreView.class.getResource("resources/splash_mini.jpg")))
+        		);
     }
     
     /** This method is called from within the constructor to
@@ -70,8 +77,6 @@
      */
     // <editor-fold defaultstate="collapsed" desc=" Generated Code ">//GEN-BEGIN:initComponents
     private void initComponents() {
-        plantloreLogo = new javax.swing.JPanel();
-        progress = new javax.swing.JProgressBar();
         next = new javax.swing.JButton();
         help = new javax.swing.JButton();
         choicePane = new javax.swing.JTabbedPane();
@@ -97,31 +102,13 @@
         jLabel8 = new javax.swing.JLabel();
         remoteServerPort = new javax.swing.JTextField();
         cancel = new javax.swing.JButton();
+        logo = new javax.swing.JLabel();
+        jPanel6 = new javax.swing.JPanel();
+        progress = new javax.swing.JProgressBar();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         setTitle(L10n.getString("Server.Create"));
         setResizable(false);
-        plantloreLogo.setBackground(new java.awt.Color(0, 0, 0));
-        plantloreLogo.setPreferredSize(new java.awt.Dimension(300, 100));
-        progress.setBorderPainted(false);
-
-        org.jdesktop.layout.GroupLayout plantloreLogoLayout = new org.jdesktop.layout.GroupLayout(plantloreLogo);
-        plantloreLogo.setLayout(plantloreLogoLayout);
-        plantloreLogoLayout.setHorizontalGroup(
-            plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, plantloreLogoLayout.createSequentialGroup()
-                .addContainerGap(165, Short.MAX_VALUE)
-                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 233, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap())
-        );
-        plantloreLogoLayout.setVerticalGroup(
-            plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, plantloreLogoLayout.createSequentialGroup()
-                .addContainerGap(71, Short.MAX_VALUE)
-                .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap())
-        );
-
         next.setText(L10n.getString("Server.Continue"));
 
         help.setText(L10n.getString("Common.Help"));
@@ -190,12 +177,12 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel2Layout.createSequentialGroup()
-                        .add(databaseType, 0, 234, Short.MAX_VALUE)
+                        .add(databaseType, 0, 257, Short.MAX_VALUE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jLabel6)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(databasePort, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 51, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 313, Short.MAX_VALUE))
+                    .add(databaseParameter, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 336, Short.MAX_VALUE))
                 .addContainerGap())
         );
         jPanel2Layout.setVerticalGroup(
@@ -218,7 +205,7 @@
         jPanel3.setLayout(jPanel3Layout);
         jPanel3Layout.setHorizontalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 403, Short.MAX_VALUE)
+            .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 426, Short.MAX_VALUE)
             .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
         );
         jPanel3Layout.setVerticalGroup(
@@ -261,8 +248,8 @@
                         .add(jLabel4)))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel5Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(remoteHost, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 239, Short.MAX_VALUE)
-                    .add(remoteServerPassword, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 239, Short.MAX_VALUE))
+                    .add(remoteHost, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 262, Short.MAX_VALUE)
+                    .add(remoteServerPassword, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 262, Short.MAX_VALUE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jLabel8)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -302,39 +289,63 @@
 
         cancel.setText(L10n.getString("Common.Cancel"));
 
+        logo.setBackground(new java.awt.Color(0, 0, 0));
+
+        jPanel6.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
+        progress.setBorderPainted(false);
+
+        org.jdesktop.layout.GroupLayout jPanel6Layout = new org.jdesktop.layout.GroupLayout(jPanel6);
+        jPanel6.setLayout(jPanel6Layout);
+        jPanel6Layout.setHorizontalGroup(
+            jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel6Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(progress, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 427, Short.MAX_VALUE)
+                .addContainerGap())
+        );
+        jPanel6Layout.setVerticalGroup(
+            jPanel6Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(progress, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+        );
+
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+            .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, choicePane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(layout.createSequentialGroup()
+                        .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                            .add(logo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 431, Short.MAX_VALUE)
+                            .add(choicePane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 431, Short.MAX_VALUE))
+                        .addContainerGap())
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(help)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 191, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 214, Short.MAX_VALUE)
                         .add(next)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(cancel))
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 408, Short.MAX_VALUE))
-                .addContainerGap())
+                        .add(cancel)
+                        .addContainerGap())))
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel6, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
         );
 
         layout.linkSize(new java.awt.Component[] {cancel, next}, org.jdesktop.layout.GroupLayout.HORIZONTAL);
 
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(layout.createSequentialGroup()
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                 .addContainerGap()
-                .add(plantloreLogo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(logo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 133, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(choicePane, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 174, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(help)
-                    .add(cancel)
-                    .add(next))
-                .addContainerGap())
+                    .add(next)
+                    .add(cancel))
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jPanel6, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         pack();
     }// </editor-fold>//GEN-END:initComponents
@@ -360,8 +371,9 @@
     private javax.swing.JPanel jPanel3;
     private javax.swing.JPanel jPanel4;
     private javax.swing.JPanel jPanel5;
+    private javax.swing.JPanel jPanel6;
+    protected javax.swing.JLabel logo;
     protected javax.swing.JButton next;
-    protected javax.swing.JPanel plantloreLogo;
     protected javax.swing.JProgressBar progress;
     protected javax.swing.JTextField remoteHost;
     protected javax.swing.JPasswordField remoteServerPassword;

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-18 09:36:50 UTC (rev 817)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-18 10:14:31 UTC (rev 818)
@@ -92,15 +92,20 @@
 	}
 	
 	
-	public static void setHostName() {
+	public static String setHostName() {
 		try {
+			// Obtain the IP of this host.
 			InetAddress address = InetAddress.getLocalHost();
 			String ip = address.getHostAddress();
+			
+			// getLocalHost().getHostAddress() failed!
 			if( "127.0.0.1".equals(ip) ) {
+				// Try to obtain the IP using the host name instead of getLocalHost().
 				String name = address.getHostName();
 				logger.info("The name of this machine is " + name);
 				address = InetAddress.getByName(name);
 				ip = address.getHostAddress();
+				// Again, no result. Try to scan all IP addresses and return the first that is not 127.0.0.1
 				if( "127.0.0.1".equals(ip) ) {
 					logger.warn("I'm getting a little desperate here!");
 					InetAddress[] addresses = InetAddress.getAllByName(name);
@@ -110,16 +115,20 @@
 							break;
 					}
 					if(  "127.0.0.1".equals(ip) ) {
+						// It is not possible to autodetect the IP address.
 						logger.fatal("Unable to obtain the " + name + "'s ip! Remote connections may not be possible! Please specify it yourself by adding java -Djava.rmi.server.hostname=YourIP");
-						return;
+						return null;
 					}
 
 				}
 			}
+			// Set the hostname IP address.
 			System.setProperty(PROPERTY_HOSTNAME, ip);
 			logger.info("Hostname set to " + ip);
+			return ip;
 		} catch (UnknownHostException e) {
 			logger.fatal("Unable to obtain the host ip! Remote connections may not be possible! " + e.getMessage());
+			return null;
 		}
 	}
 



From krater at mail.berlios.de  Mon Sep 18 14:34:49 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 14:34:49 +0200
Subject: [Plantlore-dev] r819 - trunk/src/net/sf/plantlore/client/login
Message-ID: <200609181234.k8ICYnfe020231@sheep.berlios.de>

Author: krater
Date: 2006-09-18 14:34:48 +0200 (Mon, 18 Sep 2006)
New Revision: 819

Modified:
   trunk/src/net/sf/plantlore/client/login/Login.java
   trunk/src/net/sf/plantlore/client/login/LoginView.java
Log:
LoginView::DBInfos are reloaded (more often than necessary but also) when a new database is created in Create DB.

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-18 10:14:31 UTC (rev 818)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-18 12:34:48 UTC (rev 819)
@@ -90,6 +90,8 @@
 	protected void load() {
 		logger.debug("Loading the stored list of databases.");
 		
+		dbinfos.clear();
+		
 		for (DBInfo savedDBInfo: mainConfig.getDBinfos())
 			dbinfos.add(savedDBInfo);
 		this.setChanged(); this.notifyObservers(UPDATE_LIST);

Modified: trunk/src/net/sf/plantlore/client/login/LoginView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-18 10:14:31 UTC (rev 818)
+++ trunk/src/net/sf/plantlore/client/login/LoginView.java	2006-09-18 12:34:48 UTC (rev 819)
@@ -44,7 +44,7 @@
         new DefaultEscapeKeyPressed( this );
         
         // See what's new.
-        update(null, Login.UPDATE_LIST);
+        //update(null, Login.UPDATE_LIST);
     }
     
     /** This method is called from within the constructor to
@@ -122,6 +122,13 @@
         pack();
     }// </editor-fold>//GEN-END:initComponents
     
+    
+    @Override
+    public void setVisible(boolean arg0) {
+    	model.load();
+    	super.setVisible(arg0);
+    }
+    
  
     
     /**
@@ -141,11 +148,10 @@
     				
     		        // Update the selected record as well
     		        DBInfo selected = model.getSelected();
-    		        if(source == null) // Is it the first update?
-    		        	if(selected != null)
-    		        		choice.setSelectedValue(selected, true);
-    		        	else
-    		        		choice.setSelectedIndex(0);
+    		        if(selected != null)
+    		        	choice.setSelectedValue(selected, true);
+    		        else
+    		        	choice.setSelectedIndex(0);
     			}
     			else if(parameter != null && parameter instanceof DBLayer)
     				setVisible(false); // the database layer has been created, we are no longer neccessary



From krater at mail.berlios.de  Mon Sep 18 16:16:25 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 16:16:25 +0200
Subject: [Plantlore-dev] r820 - in trunk/src/net/sf/plantlore:
	client/occurrenceimport client/tableimport/parsers common
Message-ID: <200609181416.k8IEGPPU030943@sheep.berlios.de>

Author: krater
Date: 2006-09-18 16:16:25 +0200 (Mon, 18 Sep 2006)
New Revision: 820

Modified:
   trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
   trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
OccurrenceImport::Publication were by mistake treated as if they should be NN. Fixed.
DBLayerUtils::insert, update, delete made a little bit more resilient to evil null.
UnifiedTableParser::Possible NPE fixed.

Modified: trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java
===================================================================
--- trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-18 12:34:48 UTC (rev 819)
+++ trunk/src/net/sf/plantlore/client/occurrenceimport/OccurrenceImportTask.java	2006-09-18 14:16:25 UTC (rev 820)
@@ -123,7 +123,10 @@
 				logger.error("The occurrence record is either corrupted or incomplete. It will be skipped.");
 				throw new DBLayerException(L10n.getString("Error.CorruptedRecord"));
 			}
-			dbutils.processRecord(aos[0].getOccurrence(), aos);
+			Occurrence occ = aos[0].getOccurrence();
+			if( occ.getPublication() != null && !occ.getPublication().areAllNNSet() )
+				occ.setPublication( null );
+			dbutils.processRecord(occ, aos);
 		} 
 		catch(DBLayerException e) {
 			if( IGNORE_ERRORS.contains(e.getErrorCode()) )

Modified: trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java
===================================================================
--- trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-18 12:34:48 UTC (rev 819)
+++ trunk/src/net/sf/plantlore/client/tableimport/parsers/UnifiedTableParser.java	2006-09-18 14:16:25 UTC (rev 820)
@@ -109,7 +109,7 @@
             	throw new ParserException(L10n.getString("Error.IncorrectXMLFile"));
             rootTable = tables.get( root.getName().toLowerCase() );
             if(rootTable == null)
-            	throw new ParserException(L10n.getFormattedString("Error.UnsupportedTable", rootTable.getSimpleName()));
+            	throw new ParserException(L10n.getString("Error.UnsupportedTable"));
             
             List nodes = root.selectNodes("//"+rootTable.getSimpleName().toLowerCase());
             if( nodes != null) {

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-18 12:34:48 UTC (rev 819)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-18 14:16:25 UTC (rev 820)
@@ -479,6 +479,8 @@
 	
 	private Record insert(Record record) 
 	throws RemoteException, DBLayerException {
+		if(record == null)
+			return null;
 		logger.debug("Inserting ["+record+"] into the database.");
 		
 		// Is this part of the record from an immutable table?
@@ -582,6 +584,8 @@
 	
 	private Record update(Record current, Record replacement) 
 	throws RemoteException, DBLayerException{		
+		if(current == null || replacement == null)
+			return null;
 		logger.debug("Updating ["+current+"] with ["+replacement+"].");
 		
 		boolean 
@@ -771,6 +775,8 @@
 	
 	private Record delete(Record record) 
 	throws RemoteException, DBLayerException {
+		if(record == null)
+			return null;
 		logger.info("Deleting [" + record + "] from the database.");
 		if( !Record.BASIC_TABLES.contains(record.getClass()) )
 			throw new IllegalArgumentException(L10n.getString("Error.ImproperUse"));



From krater at mail.berlios.de  Mon Sep 18 16:32:45 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 16:32:45 +0200
Subject: [Plantlore-dev] r821 - trunk/src/net/sf/plantlore/common
Message-ID: <200609181432.k8IEWjPJ000233@sheep.berlios.de>

Author: krater
Date: 2006-09-18 16:32:45 +0200 (Mon, 18 Sep 2006)
New Revision: 821

Modified:
   trunk/src/net/sf/plantlore/common/DBLayerUtils.java
Log:
DBLayerUtils::History friendly AO insert.

Modified: trunk/src/net/sf/plantlore/common/DBLayerUtils.java
===================================================================
--- trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-18 14:16:25 UTC (rev 820)
+++ trunk/src/net/sf/plantlore/common/DBLayerUtils.java	2006-09-18 14:32:45 UTC (rev 821)
@@ -57,6 +57,7 @@
     private Logger logger = Logger.getLogger(this.getClass().getPackage().getName());
     private boolean isCacheEnabled = true;
     
+   
     private Action decisionCallback;
     private Intention intention; 
     
@@ -465,7 +466,7 @@
 		if( !db.beginTransaction() )
 			throw new DBLayerException(L10n.getString("Error.TransactionRaceConditions"));
 		try {
-			Record r = insert( record );
+			Record r = insert( record, false );
 			db.commitTransaction();
 			return r;
 		} catch( DBLayerException e ) {
@@ -477,7 +478,7 @@
 		}
 	}
 	
-	private Record insert(Record record) 
+	private Record insert(Record record, boolean isOccurrenceInDatabaseAlready) 
 	throws RemoteException, DBLayerException {
 		if(record == null)
 			return null;
@@ -508,7 +509,7 @@
 			keys.remove(AuthorOccurrence.OCCURRENCE); 
 		for(String key : keys)
 			// The subrecord must be replaced with the counterpart from the database!
-			record.setValue( key, insert( (Record)record.getValue(key) ) ); 
+			record.setValue( key, insert( (Record)record.getValue(key), isOccurrenceInDatabaseAlready ) ); 
 		
 		Record counterpart = null;
 		
@@ -520,7 +521,10 @@
 		if(counterpart == null) {
 			logger.debug("The record is not in the database. It will be inserted.");
 			// Insert it!
-			return db.executeInsertInTransaction(record);
+			if(record instanceof AuthorOccurrence && !isOccurrenceInDatabaseAlready)
+				return db.executeInsertInTransactionHistory(record);
+			else
+				return db.executeInsertInTransaction(record);
 		}
 		
 		// The record is in the database.
@@ -1020,7 +1024,7 @@
 					// There's nothing to delete.
 					break;
 				default:
-					occInDB = (Occurrence) insert( occ );
+					occInDB = (Occurrence) insert( occ, isInDB );
 				}
 			
 			logger.debug("Occurrence processed. About to start processing author-occurrences...");
@@ -1083,7 +1087,7 @@
 						case DELETE:
 							break;
 						default:
-							insert( ao );							
+							insert( ao, isInDB );							
 						numberOfUndeadAuthors++;
 						}
 					// [B] AO is in the database already.



From lada at mail.berlios.de  Mon Sep 18 17:56:04 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 17:56:04 +0200
Subject: [Plantlore-dev] r822 - in trunk/src/net/sf/plantlore/help/en/html:
	. images
Message-ID: <200609181556.k8IFu4BY009810@sheep.berlios.de>

Author: lada
Date: 2006-09-18 17:56:03 +0200 (Mon, 18 Sep 2006)
New Revision: 822

Added:
   trunk/src/net/sf/plantlore/help/en/html/picture/
Removed:
   trunk/src/net/sf/plantlore/help/en/html/images/AuthorsAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/AuthorsMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ChecklistDefault.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/ChecklistUsage.jpg
   trunk/src/net/sf/plantlore/help/en/html/images/CreateDBAuth.png
   trunk/src/net/sf/plantlore/help/en/html/images/CreateDBMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingColumns.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingRecords.png
   trunk/src/net/sf/plantlore/help/en/html/images/ExportSupplyingName.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginAddMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginAuthentication.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBDirectConnection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBRemoteConnection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDBSelection.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginDeleteMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/LoginEditMenu.png
   trunk/src/net/sf/plantlore/help/en/html/images/PublicationsAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/PublicationsMain.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerConnect.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerCreate.png
   trunk/src/net/sf/plantlore/help/en/html/images/ServerManager.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence_table.png
   trunk/src/net/sf/plantlore/help/en/html/images/addedit_place.png
   trunk/src/net/sf/plantlore/help/en/html/images/habitat_tree.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyOcc.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyOccMark.png
   trunk/src/net/sf/plantlore/help/en/html/images/historyUndo.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataDelete.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataEdit.png
   trunk/src/net/sf/plantlore/help/en/html/images/metadataEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_detail.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_second_toolbar.png
   trunk/src/net/sf/plantlore/help/en/html/images/overview_selecting.png
   trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_extended.png
   trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_simple.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_columns.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_languages.png
   trunk/src/net/sf/plantlore/help/en/html/images/settings_scheda.png
   trunk/src/net/sf/plantlore/help/en/html/images/userAdd.png
   trunk/src/net/sf/plantlore/help/en/html/images/userDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/userDrop.png
   trunk/src/net/sf/plantlore/help/en/html/images/userEdit.png
   trunk/src/net/sf/plantlore/help/en/html/images/userEnter.png
   trunk/src/net/sf/plantlore/help/en/html/images/userRight.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDetail.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDialog.png
   trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryEnter.png
Log:
Rename directory images to picture.

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsAdd.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/AuthorsMain.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistDefault.jpg
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ChecklistUsage.jpg
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBAuth.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/CreateDBMain.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportProgress.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingColumns.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportSelectingRecords.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ExportSupplyingName.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginAddMenu.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginAuthentication.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBDirectConnection.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBRemoteConnection.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginDBSelection.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginDeleteMenu.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/LoginEditMenu.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsAdd.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/PublicationsMain.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ServerConnect.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ServerCreate.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/ServerManager.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/addedit_occurrence_table.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/addedit_place.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/habitat_tree.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/historyEnter.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/historyOcc.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/historyOccMark.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/historyUndo.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/metadataAdd.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/metadataDelete.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/metadataDialog.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/metadataEdit.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/metadataEnter.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/overview.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/overview_detail.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/overview_second_toolbar.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/overview_selecting.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_extended.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/search_dialog_simple.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/settings_columns.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/settings_languages.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/settings_scheda.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userAdd.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userDialog.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userDrop.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userEdit.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userEnter.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/userRight.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDetail.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryDialog.png
===================================================================
(Binary files differ)

Deleted: trunk/src/net/sf/plantlore/help/en/html/images/wholeHistoryEnter.png
===================================================================
(Binary files differ)

Copied: trunk/src/net/sf/plantlore/help/en/html/picture (from rev 803, trunk/src/net/sf/plantlore/help/en/html/images)



From lada at mail.berlios.de  Mon Sep 18 17:58:25 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 17:58:25 +0200
Subject: [Plantlore-dev] r823 - in
	trunk/src/net/sf/plantlore/help/default/html: . picture
Message-ID: <200609181558.k8IFwPc6010107@sheep.berlios.de>

Author: lada
Date: 2006-09-18 17:57:55 +0200 (Mon, 18 Sep 2006)
New Revision: 823

Added:
   trunk/src/net/sf/plantlore/help/default/html/habitattree.html
   trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsAdd.png
   trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsMain.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistDefault.jpg
   trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistUsage.jpg
   trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBAuth.png
   trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBMain.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ExportProgress.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingColumns.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingRecords.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ExportSupplyingName.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginAddMenu.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginAuthentication.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBDirectConnection.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBRemoteConnection.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBSelection.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginDeleteMenu.png
   trunk/src/net/sf/plantlore/help/default/html/picture/LoginEditMenu.png
   trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsAdd.png
   trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsMain.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ServerConnect.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ServerCreate.png
   trunk/src/net/sf/plantlore/help/default/html/picture/ServerManager.png
   trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence.png
   trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence_table.png
   trunk/src/net/sf/plantlore/help/default/html/picture/addedit_place.png
   trunk/src/net/sf/plantlore/help/default/html/picture/habitat_tree.png
   trunk/src/net/sf/plantlore/help/default/html/picture/historyEnter.png
   trunk/src/net/sf/plantlore/help/default/html/picture/historyOcc.png
   trunk/src/net/sf/plantlore/help/default/html/picture/historyOccMark.png
   trunk/src/net/sf/plantlore/help/default/html/picture/historyUndo.png
   trunk/src/net/sf/plantlore/help/default/html/picture/metadataAdd.png
   trunk/src/net/sf/plantlore/help/default/html/picture/metadataDelete.png
   trunk/src/net/sf/plantlore/help/default/html/picture/metadataDialog.png
   trunk/src/net/sf/plantlore/help/default/html/picture/metadataEdit.png
   trunk/src/net/sf/plantlore/help/default/html/picture/metadataEnter.png
   trunk/src/net/sf/plantlore/help/default/html/picture/overview.png
   trunk/src/net/sf/plantlore/help/default/html/picture/overview_detail.png
   trunk/src/net/sf/plantlore/help/default/html/picture/overview_second_toolbar.png
   trunk/src/net/sf/plantlore/help/default/html/picture/overview_selecting.png
   trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_extended.png
   trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_simple.png
   trunk/src/net/sf/plantlore/help/default/html/picture/settings_columns.png
   trunk/src/net/sf/plantlore/help/default/html/picture/settings_languages.png
   trunk/src/net/sf/plantlore/help/default/html/picture/settings_scheda.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userAdd.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userDialog.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userDrop.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userEdit.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userEnter.png
   trunk/src/net/sf/plantlore/help/default/html/picture/userRight.png
   trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDetail.png
   trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDialog.png
   trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryEnter.png
Modified:
   trunk/src/net/sf/plantlore/help/default/html/addoccurrence.html
   trunk/src/net/sf/plantlore/help/default/html/author.html
   trunk/src/net/sf/plantlore/help/default/html/checklist.html
   trunk/src/net/sf/plantlore/help/default/html/createdb.html
   trunk/src/net/sf/plantlore/help/default/html/export.html
   trunk/src/net/sf/plantlore/help/default/html/history.html
   trunk/src/net/sf/plantlore/help/default/html/import.html
   trunk/src/net/sf/plantlore/help/default/html/licence.html
   trunk/src/net/sf/plantlore/help/default/html/login.html
   trunk/src/net/sf/plantlore/help/default/html/metadata.html
   trunk/src/net/sf/plantlore/help/default/html/occurr_history.html
   trunk/src/net/sf/plantlore/help/default/html/overview.html
   trunk/src/net/sf/plantlore/help/default/html/publication.html
   trunk/src/net/sf/plantlore/help/default/html/resources.html
   trunk/src/net/sf/plantlore/help/default/html/search.html
   trunk/src/net/sf/plantlore/help/default/html/server.html
   trunk/src/net/sf/plantlore/help/default/html/settings.html
   trunk/src/net/sf/plantlore/help/default/html/table_import.html
   trunk/src/net/sf/plantlore/help/default/html/user.html
Log:
Add help for default language setting. Some text has to be translated.

Modified: trunk/src/net/sf/plantlore/help/default/html/addoccurrence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/addoccurrence.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/addoccurrence.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,94 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Add/edit occurrence</title>
-</head>
-<body>
-<h1>Add/edit occurrence</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+<html>
+<head>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - P?id?v?n? a editace n?lez?</title>
+</head>
+<body>
+<h1>P?id?v?n? a ?prava n?lez?</h1>
+<p>Z?kladn? manipulaci s n?lezy lze prov?d?t v dialoz?ch pro p?id?v?n? a ?pravu n?lezu. Ka?d? u?ivatel
+m??e upravovat jen ty z?znamy, ke kter?m m? pr?vo editace. Pro p?id?n? nov?ho n?lezu u?ivatel tak?
+mus? m?t pr?va.</p>
+
+<h2>Obsah</h2>
+<ol>
+    <li>Dialogy</li>
+    <li>?prava n?lezu</li>
+    <li>Vypnut? nepovinn?ch polo?ek</li>
+    <li>Kontrola zadan?ch hodnot</li>
+    <li>Sd?len? lokalit</li>
+    <li>Na z?v?r</li>
+</ol>
+
+<h2>1. Dialogy</h2>
+<p>Dialogy pro p?id?v?n? a ?pravu n?lezu jsou velmi podobn? vzhledem i chov?n?m.
+?pravu i p?id?v?n? m??ete vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze <a href="habitattree.html">stromu lokalit</a>. 
+</p>
+<br>
+
+<img src="picture/addedit_place.png" alt="Horn? ??st dialogu s polo?kami o m?st? n?lezu">
+
+<p>Dialog se v obou p??padech skl?d? ze t?? ??st?: zad?v?n? lokality, zad?v?n? n?lezu a tabulky
+ seznamu n?lez?. Tabulka se seznamem n?lez? obsahuje v?echny n?lezy obsa?en? v dan? lokalit?. Je zobrazena
+ pro snaz?? orientaci v ji? zadan?ch n?lezech. V?dy je nutn? vyplnit v?echny povinn? polo?ky (jsou 
+ ozna?eny hv?zdi?kou). Po kliknut? na tla??tko Ok se p?id? nov? n?lez. Zobraz? se okno informuj?c? o ?sp??n?m 
+ p?id?n? a dialog z?stane  otev?en? i se v?emi vypln?n?mi hodnotami. To umo??uje snaz?? a rychlej?? zad?v?n? v?ce n?lez?,
+ kter? maj? n?kter? ?daje spole?n?. <b>POZOR:</b> p?i op?tovn?m kliknut? na Ok
+ se stejn? n?lez p?id? znovu! Tla??tko Vyma? vyma?e hodnoty ve sloupc?ch p??slu?n? ??sti dialogu, aby bylo mo?n?
+ rychleji zadat nov? data.</p>
+<br>
+
+<img src="picture/addedit_occurrence.png" alt="Prost?edn? ??st dialogu s polo?kami o n?lezu.">
+
+<p>M?sto je mo?n? up?esnit zad?n?m sou?adnic GPS. Sou?adnice je mo?n? zadat v jednom 
+ze t?? sou?adn?ch syst?m?: S-JTSK, S42 a WGS84. Plantlore pou??v? jako z?kladn? sou?adn? syst?m syst?m 
+WGS84, do kter?ho se zadan? sou?adnice v?dy p?evedou.</p>
+
+<p>Tabulka n?lez? v dan? lokalit?. Zobrazuje se pouze informace o autorech, taxonu a datu n?lezu.</p>
+<br>
+<img src="picture/addedit_occurrence_table.png" alt="Tabulka n?lez? v dan? lokalit?">
+
+<h2>2. ?prava n?lezu</h2>
+<p>
+    B?hem upravov?n? n?lezu m??ete upravovan? n?lez smazat nebo naopak p?idat n?lezy nov?. Upravovac? dialog
+    je v tomto ohledu velmi pru?n? a pozn?, jak? akce m? prov?st. Pokud b?hem editace n?lezu sma?ete p?vodn?
+    taxon, projev? se to v datab?zi jako byste dan? n?lez smazali vyvol?n?m funkce maz?n? v <a href="overview.html">P?ehledu n?lez?</a>.
+    P?id?n? nov?ch taxon? se projev? stejn? jako by byly p?id?ny p?id?vac?m dialogem.
+</p>
+
+<h2>3. Vypnut? nepovinn?ch polo?ek</h2>
+<p>?asto se stane, ?e nebudete ch?t vypl?ovat v?echny nepovinn? informace o n?lezu. V tomto p??pad?
+m??ete v dialogu "vypnout" ty nepovinn? polo?ky, kter? zad?vat nechcete. Pohyb po dialogu nap??klad
+tabul?torem pak bude rychlej??. Vyp?nan? a zap?n?n? nepovinn?ch polo?ek se prov?d? v dialogu nastaven?, kter?
+ vyvol?te kliknut?m na tla??tko Nastaven? v lev? doln? ??sti p?id?vac?ho nebo upravovac?ho dialogu.</p>
+
+
+<h2>4. Kontrola zadan?ch hodnot</h2>
+<p>Plantlore automaticky kontroluje spr?vnost zadan?ch dat. Kontroluje se:
+    <ul>
+        <li>zad?n? v?ech povinn?ch polo?ek</li>
+        <li>spr?vnost zadan?ho data n?lezu (kontroluje se, zda zadan? den existuje)</li>
+        <li>d?lka zadan?ch dat - nap??klad pozn?mky mohou m?t 4096 znak?</li>
+        <li>korektnost hodnoty - je-li ??slo, tam kde se o?ek?v? ??slo, ... P?i zad?v?n? ??seln? hodnoty je pot?eba pou??t odd?lova? desetinn?ch m?st pro dan? jazykov? prost?ed?, v ?esk?m prost?ed? to je desetinn? ??rka.</li>
+    </ul>        
+</p>
+
+<h2>5. Sd?len? lokalit</h2>
+<p>Zad?te-li pro danou lokalitu v?ce n?lez?, budou v?echny tyto n?lezy na ?rovni datab?zov?ho modelu
+m?t tuto lokalitu sd?let. To v praxi znamen?, ?e Plantlore pozn?, jak? n?lezy do dan? lokality pat??. To
+se projev? nap??klad, pokud budete upravovat lokalitu n?lezu se sd?lenou lokalitou. V tom p??pad? se v?s
+Plantlore po kliknut? na Ok zept?, zda chcete lokalitu upravit v?em n?lez?m anebo jenom tomuto. Pokud vyberete
+jen tento, tak Plantlore vytvo?? novou lokalitu, kter? se od p?vodn? bude li?it t?m, co jste zm?nili. Lokalita
+je z datab?ze smaz?na ve chv?li, kdy je smaz?n posledn? n?lez, kter? se na n? odkazuje.</p>
+
+<h2>6. Na z?v?r</h2>
+      <p>Pr?ce s n?lezy vy?aduje rozvahu - nap??klad co se t??e sd?len? lokalit jednotliv?mi n?lezy. P?i zad?n?
+      nov?ho n?lezu od za??tku Plantlore zkou??, jestli u? dan? lokalita v datab?zi existuje a pokud ano, tak ji 
+      nov? n?lez bude sd?let s ostatn?mi. Sta?? ale jen mal? odchylka v zadan?ch ?daj?ch o lokalit? a vytvo?? se 
+      lokalita nov?, ve kter? bude n?lez s?m. Za poctiv? zad?v?n? povinn?ch polo?ek povinn?mi hodnotami zase 
+      budete odm?n?ni snadn?j?? orientac? v datech nap??klad pomoc? <a href="habitattree.html">stromu lokalit</a>.</p>
+  </body>
+</html>
+
+
+

Modified: trunk/src/net/sf/plantlore/help/default/html/author.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/author.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/author.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,66 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>Author manager</title>
 </head>
 <body>
 <h1>Author manager</h1>
+Author manager allows users to add, search, modify and delete authors of the occurrence records.
+It can be invoked from menu <strong>Data|Author Manager</strong>.
+<p/>
+The Author Manager window consists of two main parts:
+<ul>
+    <li><strong>The list of authors</strong> - where the results of the search are displayed</li>
+    <li><strong>The search criteria</strong> - where you can specify search parameters</li>    
+</ul>
+<img src="picture/AuthorsMain.png">
+<h3>The list of authors</h3>
+After a succcessful search results are displayed in the list of authors, although not all of them can
+be seen immediately. Initially, only the first page of the results is displayed. To see the rest
+of the pages use <i>Next</i> and <i>Previous</i> buttons which can be found directly under the list.
+In case you would like to display more authors per page, input the requested number of authors to the 
+field below the list of authors.
+<p/>
+This part also includes buttons for adding, editing and deleting authors. The <i>Add author</i> and
+<i>Edit author</i> buttons open the Add/Edit Author Dialog (see below), the <i>Delete author</strong>
+button removes the author after the confirmation. When <i>Edit</i> or </i>Delete</i>
+button is pressed, an author must be selected in the list in order to proceed with the operation 
+(otherwise the system will warn you that there is no author selected). Adding and editing authors
+is subject to the system of rights in plantlore. For more information on this topic, see the
+appropriate help section.
+
+<h3>The search criteria</h3>
+Author manager allows users to search the data using 4 parameters: name, organization, role and
+email. Results can be ordered by name, organization, role, email, phone number and URL in either 
+ascending or descending direction. Search string for any of the parameters doesn't have to match 
+the item in the database exactly and any substring will be sufficient (although it might yield more 
+results). To start searching use <i>Search authors</i> button.
+<p/>
+The search is by default case insensitive.
+<p/>
+After the manager window is opened, all available authors are displayed. If you've executed a search
+but you want to display and browse all available authors again, press the <i>Search authors</i>
+button while all of the search fields are left blank.
+<p/>
+<h2><a name="add">Adding and editing authors</a></h2>
+Window for adding new authors can be opened from the main Author Manager window using <i>Add 
+author</i> button. This window contains the following fields:
+<ul>
+    <li><strong>Name</strong> - Whole name of the author. This field is compulsory and cannot be left blank. Maximum length of an item in this field is 50 characters</li>
+    <li><strong>Organization</strong> - Organization or institution to which the author belongs. Maximum length of an item in this field is 50 characters</li>
+    <li><strong>Role</strong> - Role of the author in the given institution. Maximum length of an item in this field is 30 characters</li>
+    <li><strong>Address</strong> - Address of the author. Maximum length of an item in this field is 255 characters</li>
+    <li><strong>Phone</strong> - Phone number of the author. Maximum length of an item in this field is 20 characters</li>
+    <li><strong>Email</strong> - Email address of the author. Maximum length of an item in this field is 100 characters</li>
+    <li><strong>URL</strong> - URL address (webpage) of the author. Maximum length of an item in this field is 255 characters</li>
+    <li><strong>Note</strong> - Any other information can be stored here. This field can hold up to 4096 characters.</li>
+</ul>
+<img src="picture/AuthorsAdd.png">
+<p>
+New author can be saved using the <i>Save author</i> button in the bottom of the window. The only compulsory item is the name of the author.
+</p>
+In case you edit already existing author, all of the items are preloaded with the current parameters of the author and you can modify them. You can save the modifications by 
+pressing <strong>Save author</strong> button. All of the fields can be modified and the only compulsory item is the name of the author.
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/default/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/checklist.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/checklist.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -6,6 +6,90 @@
     <title>Checklist</title>
   </head>
   <body>
-  <h1>Checklist</h1>
+
+	<h1>The Checklist</h1>
+
+	<p>
+	The Checklist simplifies adding of plants that were found at the same place.
+	You just select the plants from the list of all available plants.
+	The Checklist can be accessed when 
+	<a href="./addoccurrence.html">adding the Occurrence data</a>.
+	</p>
+
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>Working with the Checklist</li>
+		<li>Creation and reuse of you own Checklist</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Working with the Checklist</h2>
+
+	<p>
+	When first opened the Checklist contains the list of all plants that are available in the database.
+	There can be several thousands of plants. In order to navigate in the list easily, you can
+	use the arrow keys.
+	In order to move to the desired record even more quickly 
+	you can type the first letters of the plant's name 
+	and the Checklist will display the first suitable choice. 
+	For instance: if you type the letters Z, E, L, K quickly enough, 
+	the Checklist will move to the "Zelkova serrata (Thunb.) Makino". The search is case insensitive. 
+	The longest delay between two consecutive characters is one second;
+	after that the characters start another search.
+	</p>
+
+	<p>
+	You can both select and deselect a record by either left-clicking on it or pressing the spacebar.
+	In order to cancel the selection of all plants click on the "Deselect all" button.
+	</p>
+
+	<p>
+	<img src="picture/ChecklistDefault.jpg" alt="The Checklist opened for the first time.">
+	</p>
+
+	<p>
+	After the selection of plants is finished, 
+	click on the "Insert" button and the selected plants will be inserted 
+	into the list of plants in the Overview.
+	</p>
+
+
+
+	<h2>2. Creation and reuse of your own Checklist</h2>
+
+	<p>
+	If you feel that the list of all plants is too long and working with it is unpleasant, 
+	because there are only a few hundreds of plants in the processed locality,
+	you can create your own Checklist.
+	</p>
+
+	<p>
+	You must select all plants you want to have in the final Checklist.
+	Then press the "Create" button and save the list into a file so that you can easily reuse
+	the Checklist in the future by pressing "Load".
+	</p>
+	
+	<p>
+	You own Checklist may look like this:
+	</p>
+
+	<p>
+	<img src="picture/ChecklistUsage.jpg" alt="Nov? ?krt?k.">
+	</p>
+
+	
+	<p>
+	If you press the "Restore" button the Checklist will return to its initial state
+	(containing all the plants available), but it will not cancel the list of currently
+	selected plants. This is very useful if a plant or two are not in your own Checklist;
+	just click on the "Restore" and select the missing plant from the complete list of
+	plants.
+	</p>
+
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/default/html/createdb.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/createdb.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/createdb.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -7,5 +7,43 @@
   </head>
   <body>
   <h1>Creating new database</h1>
+    In order to work with the occurrence data after Plantlore is installed, it is neccessary to create database where the data will be 
+    stored (in case you are using local connections to the database). For remote connections (over a computer network) you do not have
+    to create new database after installation is finished. Plantlore allows you to work with multiple databases on one server and 
+    therefore it is neccessary to have the option to create new databases. The reason for having more than one database can be for 
+    example separation of data from different projects or institutions. The number of databases and their usage is up to you.
+    <p>
+    Plantlore offers simple user interface for creating new databases which is accessible from the main application menu <b>Data|Create 
+    new database</b>
+    <p>
+    <img src="picture/CreateDBMain.png" />
+    <p>
+    <b>Important warning: Because of security reasons it is only possible to create new database using local connection to the database.</b>
+       Also make sure that there's no other program using the PostgreSQL database system while you create new database.
+    <p>
+    In this dialog you have to input basic information about the database system you are using and the new database.
+    <ul>
+        <li><b>Database</b> - Type of the database system you are using. In current version only PostgreSQL database is supported</li>
+        <li><b>DB Port</b> - Port where the database system is running. This field contains the default port for the selected database system</li>
+        <li><b>Alias</b> - Description of the new database which will be used when logging in (this will be automatically 
+                          added to the Login dialog where you choose the database once the database is created)</li>
+        <li><b>Database identifier</b> - Name of the database itself. Make sure there is no other database with this name. The 
+                             name can only consist of alfanumeric characters (A-Z, a-z, 0-9)</li>
+    </ul>
+    After the <b>Next</b> button is pressed the authentication dialog will show up and you have to input login and password for 
+    connecting to the database system.
+    <p>
+    <img src="picture/CreateDBAuth.png">
+    <p>
+    <b>Creating new databaze right after Plantlore installation</b>
+    <p>
+        In case you create new database right after the Plantlore installation finished, use authentication data you entered during the installation (the one for database user). Plantlore will grant this user to administrative priviliges for the new database and
+        you can create other users of this database.
+    </p>
+    <b>Creating new database in already running system</b> 
+    <p>
+        In case you create new database in a system where there are other databases, you should still use the original database user used for creating new database.
+    </p>
+    Once the database is successfuly created you are informed by a messege window and you can login to your new database right away.
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/default/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/export.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/export.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,154 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Export</title>
-</head>
-<body>
-Export
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Export dat</title>
+  </head>
+  <body>
+  <h1>Export dat</h1>
+  	<p>
+	Your Occurrence data are stored in a database and
+	cannot be accessed directly. In order to transfer your
+	data from one computer to another, you must use Export and
+	<a href="./import.html">Import</a>. 
+	Export allows you to "take" the Occurrence data from the database
+	and store them into a file on your hard drive.
+	</p>
+
+	<p>
+	Export can be performed in every database after logging in - even in a remote database.
+	However, if you are connected to a remote database and want to export the Occurrence data,
+	you should take the capacity of the network connection you are using into account, because
+	the amount of data transfered via the network may be huge and the whole process
+	may be painfully slow.
+	</p>
+
+	<p>
+	There can run only one Export at a time.
+	</p>
+	
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>What has to be done before Export is started</li>
+		<li>Exporting the Occurrence data</li>
+	</ol>
+	</p>
+
+
+
+	<h2>1. What has to be done before Export is started</h2>
+
+	<p>
+	First, you have to select some Occurrences in the <a href="./overview.html">Overview</a>.
+	In order to reduce the amount of records from which you choose, use <a href="./search.html">Search</a>.
+	If you don't select any record, Plantlore acts as if all records were selected saving you
+	the time to select them all by yourself.
+	</p>
+
+	<p>
+	You can see 11 records that are about to be exported in the picture below.
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingRecords.png" alt="Selecting records for export.">
+	</p>
+
+
+
+	<h2>2. Exporting the Occurrence data</h2>
+
+	<p>
+	Export of the Occurrence data takes two steps.
+	</p>
+
+	<h3>2.1. File name and file format specification</h3>
+
+	<p>
+	Type in the name of the file and choose its format from the list of basic formats: 
+	<ul>
+		<li>
+		PlantloreNative is a format designed for the transfer of Occurrence data
+		between two Plantlore programs. 
+		If you are unsure which format you should choose we recommend this one.
+		</li>
+		<li>
+		XML is a format based on the Extensible Markup Language (XML). 
+		The Occurrences are stored in a well-defined tree structure. 
+		This format allows you to specify what attributes of the records you are interested in. 
+		This format is less suitable for the data transfer 
+		but very good for their visualization in the Internet Explorer, for instance.  
+		</li>
+		<li>
+		ABCD Schema is another XML based format. 
+		However, the structure is different and conforms to the ABCD Schema requirements.
+		</li>
+		<li>
+		DarwinCore is another XML based format. 
+		Its structure conforms to the DarwinCore requirements.
+		</li>
+		<li>
+		CSV - known as Comma Separated Values - is a simple format 
+		that contains one Occurrence per line. 
+		Values of attributes of the record are separated by commas. 
+		The first line contains the names of those attribues. 
+		The structure of the file therefore resembles a table, 
+		which is particularly suitable for table processors, such as Microsoft Excel.  
+		</li>
+		<li>
+		StdOut doesn't store the records in a file 
+		but sends them into the standard output. 
+		The records are parsed and sent in a very legible form: 
+		table.column = value. 
+		This "format" is intented for stream processing in a command line.  
+		</li>
+	</ul>
+	If you are unsure which format to choose, 
+	we recommend to use the PlantloreNative which is most suitable for the data transfer.
+	</p>
+
+	<p>
+	<img src="picture/ExportSupplyingName.png" alt="Choosing the file name and its format.">
+	</p>
+
+	<h3>2.2. Records' Attributes Selection (optional)</h3>
+
+	<p>
+	This step is optional. Only XML, CSV and StdOut support this option. 
+	The other formats export the records with all their attributes.  
+	You can select the desired attributes by clicking on them in the tree. 
+	The attributes displayed in red are compulsory if you are planning to 
+	<a href="./import.html">Import</a> the data back into Plantlore. 
+	</p>
+	
+	<p>
+	If you do not select any column, Plantlore acts as if all were selected. 
+	</p>
+
+	<p>
+	<img src="picture/ExportSelectingColumns.png" alt="Selecting important attributes of the record.">
+	</p>
+
+
+	<h3>2.3. The export</h3>
+
+	<p>
+	After the selection of attributes if completed, export is started. 
+	You can follow the progress in a small window. 
+	If you decide to cancel the export, click on the "Cancel" button and
+	export will be ended immediately. The file will contain the Occurrence data
+	that were written before the operation was canceled. It is guaranteed that the
+	format of the file is valid even if export is terminated prematurely either by
+	the User or by an error.
+	</p>
+
+	<p>
+	<img src="picture/ExportProgress.png" alt="Export in progress.">
+	<p>
+
+
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/default/html/habitattree.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/habitattree.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/habitattree.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -0,0 +1,30 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Vytv??en? nov? datab?ze</title>
+  </head>
+  <body>
+  <h1>Strom lokalit</h1>
+ <p>Strom lokalit slou?? k rychl?mu hled?n? v n?lezech podle geografick?ho ?len?n?. Je mo?n? ho vyvolat z panelu n?stroj?
+ v hlavn?m okn? aplikace.</p>
+ <br>
+ <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
+ <br>
+ 
+ <p>Prvn? vrstva stromu obsahuje ?zem? (teritoria), ka?d? ?zem? pak obsahuje fytochoriony a kone?n? ka?d?
+ fytochorion obsahuje seznam lokalit. Strom obsahuje pouze ty fytochoriony a ?zem?, kter? u? n?jak? n?lez obsahuj?.
+  Fytochoriony neobsahuj?c? ??dn? n?lez zobrazeny nejsou. Stejn? tak ?zem?, kter? neobsahuj? alespo? jeden fytochorion
+  obsahuj?c? n?lez nejsou zobrazena.</p>
+  
+  <p>N?lezy v dan? lokalit? m??ete zobrazit bu? dvojklikem na uzel lokality anebo je mo?n? jednoduch?m kliknut?m lokalitu ozna?it
+   a pak bu? kliknout na lev? doln? tla??tko hledat anebo prav?m kliknut?m my?i vyvolat kontextov? menu a v n?m vybrat polo?ku "Hledat".</p>
+   
+   <p>Informace ve stromu se automaticky neaktualizuj? spolu s ?pravami n?lezov?ch dat v datab?zi, aby se p?ede?lo neo?ek?van?mu zpomalen? 
+   aplikace p?i pomal?m p?ipojen? k serveru Plantlore p?i komunikaci p?es s??. Seznam lokalit ve fytochorionu se z datab?ze znovu na??t?
+   p?i ka?d?m rozbalen? uzlu fytochorionu. Pro nov? na?ten? cel? struktury stromu slou?? prav?
+   doln? tla??tko Obnovit. Funkci Obnovit je mo?n? vyvolat i z kontextov?ho menu.
+   </p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,190 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>History</title>
-</head>
-<body>
-<h1>History</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Editing history</title>
+  </head>
+  <body>
+  <h1>Editing history</h1>
+Plantlore enables you to trace the history of your occurrence data. Thanks to this function, you can find out who, when, and how changed the information
+about a specific occurrence, author, publication, or metadata.<br> 
+The basic information recorded about a modification includes:
+<ul> 
+ <li>date and time of the modification
+ <li>operation type (insert, edit, remove)
+ <li>name of the user carrying out the modification
+ <li>name of the edited item, or identification of inserted/removed record
+ <li>old value of the edited item
+ <li>new value of the edited item
+</ul>
+  
+Plantlore, apart from enabling you to follow the abovementioned changes in the occurrence data also allows you to easily cancel these modifications
+and return to the previous values. History is a powerful tool enabling interference with your occurrence data and it is thus necessary to limit the access
+to the history to users possessing sufficient privileges (see  <a href="./user.html">User rights</a>).  
+
+<p>
+<i><b>There are two different types of work with the editing history:</b></i> 
+</p>
+
+<a href="#historyRecord">Occurrence history</a> - a user's tool to trace the history of modifications to a selected occurrence and use the UNDO operation for selected modifications<br> 
+<a href="#historyData">Whole history</a> - an administrator's tool to check the modifications performed in the data and use the operation "UNDO to the selected data and time"
+
+
+
+<br><br>
+<a name="historyRecord"><h2>Occurrence history</h2></a>
+
+<img src="picture/historyEnter.png" alt="History occurence - enter">
+
+<p><br>
+To access the history of a selected occurrence just select this occurrence and click on the <i><b>History</b></i> button. If the <i><b>History</b></i> button is inactive,
+your access to the editing history has been disabled and you do not have the right to work with the selected occurrence. It will certainly do no harm to mention
+in what cases you have the right to work with the history of an occurrence.
+
+</p>
+The occurrence history is accessible to a user who:
+<ul>
+   <li>entered the occurrence into the database</li>
+   <li>has the right to edit the records of the user that entered this occurrence into the database</li>
+   <li>has the right to edit all the occurrences in a database</li>
+   <li>has administrator rights</li>   
+</ul>    
+
+If you do not have access to the occurrence history and you would like to, please contact the administrator of Plantlore.<br>
+You will find more detailed information about user rights in section <a href="./user.html">User rights</a>.
+
+<h5>Occurrence history dialog</h5>
+
+<img src="picture/historyOcc.png">
+<br><br>
+
+The occurrence history dialog is divided into three parts.
+<ul>
+  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)
+  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)
+  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence
+</ul>
+  
+<h3>List of modifications</h3>
+
+The list of modifications of an occurrence is sorted from the most recent to the oldest change and it is displayed in a table containing the following data:
+  
+<ul>
+<li><b>X</b> - selection of individual modifications</li>
+<li><b>Date/Time</b> - date/time of the modification</li>
+<li><b>User</b> - user who carried out the modification</li>
+<li><b>Item</b> - item that was changed</li>
+<li><b>Old value</b> - value of the item prior to the modification</li>
+<li><b>New value</b> - value of the item after the modification</li>
+</ul>
+
+
+<h3>UNDO operation on selected items</h3>
+
+In occurrence history you may choose to amend <b>only a specific item </b>in the record and return to its previous value. This operation is thus different from a classic UNDO
+operation which reverts changes in a chronological order, from the most recent to the oldest. Let's mention an example utilizing this improvement of the UNDO operation:
+
+<div style="text-align:justify; padding: 20 20 30 20">
+<i> 
+You have modified the items "Herbarium", "Occurrence year", "Occurrence note" and then perform about twenty other modifications. You don't remember the original wording of the 
+occurrence note, but you would like to return to it. With a classic UNDO operation, you would have to cancel one-by-one all of the changes until you would get to the
+original wording of the occurrence note. In the history dialog, however, it is simple to meet your demand. If you only want to find out the original wording of the occurrence
+note, it is sufficient to select the oldest modification of the note in the list of modifications and the desired text will be displayed in the column OLD VALUE. If you 
+wanted to revert the change to the original wording, you only need to find the oldest change, select the given line in column X and click on the <b>UNDO </b>button.
+Don't be worried about the fact that by selecting that line, more recent changes of the note will also be selected -- this behavior is implied by the logic of modifications 
+selection (see below).</i> 
+</div>
+
+As stated above, you can use column X to select the modifications you want to revert. Select or deselect a modification by a mouse-click in column X of a given line. 
+You can also use the buttons <i><b>Select all</b></i> and <i><b>Deselect all</b></i> which select or deselect all occurrence modifications displayed int he table. The number 
+of items displayed in the table may be changed by modifying the value of <i><b>Lines displayed </b></i>and confirming the new value by the ENTER key. You can switch
+over to the previous or next list of modifications using the <b><i>Previous </i></b>and <i><b>Next </b></i>buttons. The information about the currently displayed
+list of changes are stated in the part below the table.
+
+<br><br> 
+After pressing the <i><b>UNDO </b></i>button, information will be displayed about the list of changes about to be performed. Use the CANCEL button to
+cancel the operation. Use the OK button to confirm the operation and reversion of the selected occurrence modifications. All of the selected lines will
+be deleted from the history.
+
+<br><br>
+<img src="picture/historyUndo.png">
+<br><br>
+
+<h3><i>Logic of modification selection</i></h3>
+
+Items in the record might be modified more than once. Thus, it is necessary to provide for several possible situations while selecting changes in the history dialog.<br>
+Here's an illustrative example:<br><br> 
+
+<img src="picture/historyOccMark.png">
+<br><br>
+
+<i>
+Let's suppose that item HERBARIUM was modified n-times. In the history dialog, there are n lines informing about the change to item HERBARIUM. The figure above 
+shows a modification HERBARIUM 15.8.2006 11:39 from value CB/910 to value CB/913, a more recent modification HERBARIUM 15.8.2006 11:40 from value CB/913 to value CB/918,
+and the most recent modification HERBARIUM 15.8.2006 12:36 from value CB/918 to value CB/968. While selecting and deselecting these modifications, following situations
+may come about:
+
+<ul> 
+<li> The user wants to revert to the situation when item HERBARIUM had a value of CB/910. He must therefore select the relevant line with the modification from 
+15.8.2006 11:39. Because there are also more recent changes to item HERBARIUM, lines for changes HERBARIUM 15.8.2006 11:40 and HERBARIUM 15.8.2006 12:36  will also
+be selected. After the <b>UNDO</b> operation is performed, item HERBARIUM of the given record will have the value of CB/910 and all of the selected lines will be
+removed from the history.
+<li> The user has selected the modifications of item HERBARIUM from 15.8.2006 11:39, 15.8.2006 11:40 and 15.8.2006 12:36 and he decides to revert only the change 
+from 15.8.2006 11:39, i.e. to value CB/918. In this situation, the user must deselect the modification of 15.8.2006 11:40. If older modifications (e.g. 15.8.2006 11:39)
+were also deselected, this will lead to the automatic deselection of the modification of 15.8.2006 11:40.
+<li> The user has selected the modifications of item HERBARIUM from 15.8.2006 11:39, 15.8.2006 11:40 and 15.8.2006 12:36 and he decides not to revert any of these
+changes. To deselect all modifications of item HERBARIUM, he only needs to deselect the most recent modification and the older modifications will be deselected 
+automatically. By deselecting a more recent modification the user expresses that he wants to keep this modification of item HERBARIUM.
+</ul>
+</i><br>
+
+<a name="historyData"><h2>Whole history</h2></a> 
+
+<br>
+<img src="picture/wholeHistoryEnter.png">
+<br><br>
+
+Dialog of the whole history of modifications is only accessible to the user with administrator rights. If you have administrator rights, you may open
+this dialog from menu <b>Data/Whole history</b>. If you do not have administrator rights, this menu item is disabled.
+
+<h5>Whole history dialog</h5>
+
+<img src="picture/wholeHistoryDialog.png">
+<br><br>
+
+This dialog displays a list of all modifications relating to metadata, occurrences, authors, and publications. This list is sorted from the most recent
+to the oldest modification and it is displayed in a table containing the following data:
+  
+<ul>
+<li><b>Date/time</b> - date and time of the modification</li>
+<li><b>Operation</b> - operation type (insert, edit, remove)</li>
+<li><b>User</b> - name of the user carrying out the modification</li>
+<li><b>Item</b> - name of the modified item</li>
+<li><b>Old value</b> - old value of the edited item (filled in only for edit operation)</li>
+<li><b>New value</b> - new value of the edited item (filled in only for edit operation)</li>
+</ul>
+
+
+<img src="picture/wholeHistoryDetail.png">
+<br><br>
+
+If you want to find out more detailed information about an occurrence, metadata, author, or publication, please select the
+line with the relevant modification in the table and press the <b><i>Detail</i></b> button. 
+
+<h3>Operation "UNDO to the selected date and time"</h3>
+
+The <b><i>Undo</i></b> operation reverts the changes performed in a database, starting from the most recent to the oldest change. Prior to pressing the UNDO
+button, you must select the line into which (including this line) the modification reversal is supposed to be performed. After pressing the <i><b>Undo</b></i> button,
+you will see the information about the selected date/time for this operation. Confirm the operation by pressing OK; this way, the UNDO operation will be performed
+and the reversed changes will be deleted from the history.
+
+<h3>Database cleanup and deletion of history</h3>
+
+The database also contains records which the user has erased and the information about this deletion is recorded in the history tables. The existence of these
+inactive records is necessary for the UNDO operation. However, you have the option to use the <b><i>Delete</i></b> operation, by means of which you can clean the database
+of inactive records and also delete all data from the history. It is advisable to backup the database before performing this operation. You have to use a third-party tool 
+for database backup. After pressing the <i><b>Delete</b></i> button, a dialog with information about the operation about to be performed will appear. Only after confirming 
+this dialog will the operation be carried out.
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/import.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/import.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,110 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Import</title>
-</head>
-<body>
-<h1>Import</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Import dat</title>
+  </head>
+  <body>
+  <h1>Import n?lezov?ch dat</h1>
+
+	<p>
+	Va?e n?lezov? data jsou p?i pr?ci s Plantlore uchov?v?na v datab?zi. 
+	K dat?m nelze p?istupovat p??mo; p?enos  dat na jin?
+	po??ta?e vy?aduje pou?it? <a href="./export.html">Exportu</a> a Importu. 
+	Import slou?? k znovuna?ten? n?lezov?ch dat ze souboru na disku do datab?ze programu.
+	</p>
+
+	<p>
+	Import lze prov?d?t po p?ihl??en? k jak?koli datab?zi - i datab?zi vzd?len?.
+	U vzd?len?ho p?ipojen? je nutn? uv??it p?enosovou kapacitu linky, 
+	kterou pou??v?te pro p?ipojen?, nebo? se m??e p?en??et zna?n? mno?stv? dat 
+	a doba nutn? k proveden? cel? operace by byla ne?nosn?.
+	</p>
+
+	<p>
+	P?i importu n?lezov?ch dat doch?z? k modifikaci obsahu datab?ze.
+	Aby se p?ede?lo neopr?vn?n? manipulaci s daty, je pot?eba m?t k importu
+	dostate?n? u?ivatelsk? pr?va. Nem?te-li pr?vo p?id?vat z?znamy, import neusp?je nikdy.
+	O pr?vech se pojedn?v? v sekci <a href="./user.html">Spr?va u?ivatel?</a>.
+	</p>
+
+
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Importov?n? n?lezov?ch dat</li>
+		<li>Detailn? popis pr?b?hu importu</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Importov?n? n?lezov?ch dat</h2>
+
+	<p>
+	Import za??n? v?b?rem souboru, v n?m? jsou ulo?ena n?lezov? data.
+	V sou?asn? dob? je podporov?n pouze import z XML soubor?, kter?
+	odpov?daj? PlantloreNative form?tu.
+	</p>
+
+	<p>
+	Po v?b?ru souboru je zah?jen import dat. Pr?b?h procesu m??ete sledovat v otev?en?m okn?.
+	Import lze zru?it stiskem tla??tka "Storno". 
+	Zru??te-li Import, n?lezov? data, kter? se stihla naimportovat, v datab?zi z?stanou.
+	Pokud chcete naimportovan? z?znamy odstranit, pou?ijte <a href="./history.html">historii</a>,
+	kter? umo??uje vracen? operac? s datab?z? (undo).
+	</p>
+
+
+	<h2>2. Detailn? popis pr?b?hu importu</h2>
+
+	<p>
+	Import dat je <b>dlouhotrvaj?c?</b> operace, p?i n?? doch?z? k modifikaci datab?ze. 
+	Plantlore zaji??uje, aby nebyla po?kozena integrita nebo bezpe?nost st?vaj?c?ch n?lezov?ch dat. 
+	Vkl?d?n? z?znamu se proto nemus? zda?it. Zam?tnut? z?znamu, 
+	tj. neproveden? po?adovan? operace, m??e nastat z n?sleduj?c?ch d?vod?:
+	<ol>
+		<li>
+		Nedostate?n? opr?vn?n? - nap?. nem?te pr?vo p?id?vat nov? n?lezov? data
+		nebo pr?vo modifikovat z?znamy jin?ch u?ivatel?.
+		V?ce o pr?vech lze nal?zt v sekci <a href="./user.html">Spr?va u?ivatel?</a>.
+		</li>
+
+		<li>
+		Ne?pln? n?lezov? z?znam, tj. z?znam neobsahuj?c? v?echny povinn? polo?ky.
+		</li>
+
+		<li>
+		Nekorektn? z?znam, tj. z?znam, kter? obsahuje ??sti, kter? nelze dohledat
+		v datab?zi. Do datab?ze nelze vlo?it n?lez, kter? obsahuje rostlinu,
+		nejbli??? v?t?? s?dlo, fytochorion nebo teritorium,
+		kter? se nenach?z? v datab?zi.
+		D?vody pro toto opat?en? jsou uvedeny v sekci
+		<a href="./table_import.html">Import dat do tabulek</a>.
+		</li>
+	</ol>
+	P?edchoz? seznam ud?v? d?vody zam?tnut? z?znamu, kter? nevedou ke zru?en? importu.
+	Pokud soubor, z n?ho? maj? b?t z?znamy na?teny, 
+	m? neplatn? nebo nezn?m? form?t, dojde k automatick?mu zru?en? importu, jako kdybyste
+	stiskli tla??tko "Storno".
+	</p>  
+
+
+	<p>
+	Export a Import byl navr?en i pro snadn? p?en??en? zm?n v n?lezov?ch datech mezi dv?ma
+	datab?zemi. Pou??v?te-li Plantlore nap??klad doma i v pr?ci, m??ete ??st zm?n prov?st
+	doma a pot? dan? zm?ny prom?tnout do datab?ze v pr?ci. Uka?me si to na p??kladu.
+	Doma vytvo??te novou lokalitu, ?ekn?me "50 metr? od prav?ho b?ehu ?eky Jihlavy".
+	V t?to lokalit? jste identifikovali dv? rostliny, Rubus saxatilis L. a Caltha palustris.
+	Po p?id?n? t?chto dvou rostlin provedete export t?chto dvou z?znam? a p?enesete je 
+	na sv? pracovi?t?, kde z?znamy importujete. V pr?ci zjist?te, ?e se nejednalo
+	o Rubus saxatilis L, n?br? o Rubus albocarpaticus, a 
+	<a href="./addoccurrence.html">editac?</a>
+	provedete zm?nu. P?enesete-li
+	potom data dom? a importujete-li je, zm?na se projev? i ve va?? dom?c? datab?zi.
+	</p>
+
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/licence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/licence.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/licence.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,90 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Licence</title>
+<title>GNU GPL Licence</title>
 </head>
 <body>
-<h1>Licence</h1>
+<center>
+<h1>GNU General Public License</h1>
+<p>Version 2, June 1991</p>
+<br>
+Copyright (C) 1989, 1991 Free Software Foundation, Inc.  <br>
+59 Temple Place - Suite 330, Boston, MA  02111-1307, USA<br>
+<br>
+Everyone is permitted to copy and distribute verbatim copies<br>
+of this license document, but changing it is not allowed.<br>
+</center>
+
+<h2>Preamble</h2>
+
+<P>The licenses for most software are designed to take away your freedom to share and change it.  By contrast, the GNU General Public License is intended to guarantee your freedom to share and change free software--to make sure the software is free for all its users.  This General Public License applies to most of the Free Software Foundation's software and to any other program whose authors commit to using it.  (Some other Free Software Foundation software is covered by the GNU Library General Public License instead.)  You can apply it to your programs, too.</p>
+<P>When we speak of free software, we are referring to freedom, not price.  Our General Public Licenses are designed to make sure that you have the freedom to distribute copies of free software (and charge for this service if you wish), that you receive source code or can get it if you want it, that you can change the software or use pieces of it in new free programs; and that you know you can do these things.</p>
+<P>To protect your rights, we need to make restrictions that forbid anyone to deny you these rights or to ask you to surrender the rights. These restrictions translate to certain responsibilities for you if you distribute copies of the software, or if you modify it.</p>
+
+<P>For example, if you distribute copies of such a program, whether gratis or for a fee, you must give the recipients all the rights that you have.  You must make sure that they, too, receive or can get the source code.  And you must show them these terms so they know their rights.</p>
+<P>We protect your rights with two steps: (1) copyright the software, and (2) offer you this license which gives you legal permission to copy, distribute and/or modify the software.</p>
+<P>Also, for each author's protection and ours, we want to make certain that everyone understands that there is no warranty for this free software.  If the software is modified by someone else and passed on, we want its recipients to know that what they have is not the original, so that any problems introduced by others will not reflect on the original authors' reputations.</p>
+<P>Finally, any free program is threatened constantly by software patents.  We wish to avoid the danger that redistributors of a free program will individually obtain patent licenses, in effect making the program proprietary.  To prevent this, we have made it clear that any patent must be licensed for everyone's free use or not licensed at all.</p>
+<P>The precise terms and conditions for copying, distribution and modification follow.</p>
+<H2>TERMS AND CONDITIONS FOR COPYING, DISTRIBUTION AND MODIFICATION</h2>
+
+<P><STRONG>0.</strong> This License applies to any program or other work which contains a notice placed by the copyright holder saying it may be distributed under the terms of this General Public License.  The "Program", below, refers to any such program or work, and a "work based on the Program" means either the Program or any derivative work under copyright law: that is to say, a work containing the Program or a portion of it, either verbatim or with modifications and/or translated into another language.  (Hereinafter, translation is included without limitation in the term "modification".)  Each licensee is addressed as "you".
+<P>Activities other than copying, distribution and modification are not covered by this License; they are outside its scope.  The act of running the Program is not restricted, and the output from the Program is covered only if its contents constitute a work based on the Program (independent of having been made by running the Program). Whether that is true depends on what the Program does.
+
+<P><STRONG>1.</strong> You may copy and distribute verbatim copies of the Program's source code as you receive it, in any medium, provided that you conspicuously and appropriately publish on each copy an appropriate copyright notice and disclaimer of warranty; keep intact all the notices that refer to this License and to the absence of any warranty; and give any other recipients of the Program a copy of this License along with the Program.
+<P>You may charge a fee for the physical act of transferring a copy, and you may at your option offer warranty protection in exchange for a fee.
+<P><STRONG>2.</strong> You may modify your copy or copies of the Program or any portion of it, thus forming a work based on the Program, and copy and distribute such modifications or work under the terms of Section 1 above, provided that you also meet all of these conditions:
+<P>
+<UL>
+<LI><STRONG>a)</strong>
+     You must cause the modified files to carry prominent notices stating that you changed the files and the date of any change.
+
+<P>
+<LI><STRONG>b)</strong>
+     You must cause any work that you distribute or publish, that in whole or in part contains or is derived from the Program or any part thereof, to be licensed as a whole at no charge to all third parties under the terms of this License.
+
+<P>
+<LI><STRONG>c)</strong>
+     If the modified program normally reads commands interactively when run, you must cause it, when started running for such interactive use in the most ordinary way, to print or display an announcement including an appropriate copyright notice and a notice that there is no warranty (or else, saying that you provide a warranty) and that users may redistribute the program under these conditions, and telling the user how to view a copy of this License.  (Exception: if the Program itself is interactive but does not normally print such an announcement, your work based on the Program is not required to print an announcement.)
+</ul>
+These requirements apply to the modified work as a whole.  If identifiable sections of that work are not derived from the Program, and can be reasonably considered independent and separate works in themselves, then this License, and its terms, do not apply to those sections when you distribute them as separate works.  But when you distribute the same sections as part of a whole which is a work based on the Program, the distribution of the whole must be on the terms of this License, whose permissions for other licensees extend to the entire whole, and thus to each and every part regardless of who wrote it.
+<P>Thus, it is not the intent of this section to claim rights or contest your rights to work written entirely by you; rather, the intent is to exercise the right to control the distribution of derivative or collective works based on the Program.
+<P>In addition, mere aggregation of another work not based on the Program with the Program (or with a work based on the Program) on a volume of a storage or distribution medium does not bring the other work under the scope of this License.
+<P><STRONG>3.</strong> You may copy and distribute the Program (or a work based on it, under Section 2) in object code or executable form under the terms of Sections 1 and 2 above provided that you also do one of the following:
+
+<UL>
+<LI><STRONG>a)</strong>
+     Accompany it with the complete corresponding machine-readable source code, which must be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
+
+<P>
+<LI><STRONG>b)</strong>
+     Accompany it with a written offer, valid for at least three years, to give any third party, for a charge no more than your cost of physically performing source distribution, a complete  machine-readable copy of the corresponding source code, to be distributed under the terms of Sections 1 and 2 above on a medium customarily used for software interchange; or,
+<P>
+<LI><STRONG>c)</strong>
+     Accompany it with the information you received as to the offer to distribute corresponding source code.  (This alternative is allowed only for noncommercial distribution and only if you received the program in object code or executable form with such an offer, in accord with Subsection b above.)
+</ul>
+The source code for a work means the preferred form of the work for making modifications to it.  For an executable work, complete source code means all the source code for all modules it contains, plus any associated interface definition files, plus the scripts used to control compilation and installation of the executable.  However, as a special exception, the source code distributed need not include anything that is normally distributed (in either source or binary form) with the major components (compiler, kernel, and so on) of the operating system on which the executable runs, unless that component itself accompanies the executable.
+
+<P>
+If distribution of executable or object code is made by offering access to copy from a designated place, then offering equivalent access to copy the source code from the same place counts as distribution of the source code, even though third parties are not compelled to copy the source along with the object code.
+<P><STRONG>4.</strong> You may not copy, modify, sublicense, or distribute the Program except as expressly provided under this License.  Any attempt otherwise to copy, modify, sublicense or distribute the Program is void, and will automatically terminate your rights under this License. However, parties who have received copies, or rights, from you under this License will not have their licenses terminated so long as such parties remain in full compliance.
+
+<P><STRONG>5.</strong> You are not required to accept this License, since you have not signed it.  However, nothing else grants you permission to modify or distribute the Program or its derivative works.  These actions are prohibited by law if you do not accept this License.  Therefore, by modifying or distributing the Program (or any work based on the Program), you indicate your acceptance of this License to do so, and all its terms and conditions for copying, distributing or modifying the Program or works based on it.
+<P><STRONG>6.</strong> Each time you redistribute the Program (or any work based on the Program), the recipient automatically receives a license from the original licensor to copy, distribute or modify the Program subject to these terms and conditions.  You may not impose any further restrictions on the recipients' exercise of the rights granted herein. You are not responsible for enforcing compliance by third parties to this License.
+<P><STRONG>7.</strong> If, as a consequence of a court judgment or allegation of patent infringement or for any other reason (not limited to patent issues), conditions are imposed on you (whether by court order, agreement or otherwise) that contradict the conditions of this License, they do not excuse you from the conditions of this License.  If you cannot distribute so as to satisfy simultaneously your obligations under this License and any other pertinent obligations, then as a consequence you may not distribute the Program at all.  For example, if a patent license would not permit royalty-free redistribution of the Program by all those who receive copies directly or indirectly through you, then the only way you could satisfy both it and this License would be to refrain entirely from distribution of the Program.
+<P>If any portion of this section is held invalid or unenforceable under any particular circumstance, the balance of the section is intended to apply and the section as a whole is intended to apply in other circumstances.
+<P>It is not the purpose of this section to induce you to infringe any patents or other property right claims or to contest validity of any such claims; this section has the sole purpose of protecting the integrity of the free software distribution system, which is implemented by public license practices.  Many people have made generous contributions to the wide range of software distributed through that system in reliance on consistent application of that system; it is up to the author/donor to decide if he or she is willing to distribute software through any other system and a licensee cannot impose that choice.
+<P>This section is intended to make thoroughly clear what is believed to be a consequence of the rest of this License.
+
+<P><STRONG>8.</strong> If the distribution and/or use of the Program is restricted in certain countries either by patents or by copyrighted interfaces, the original copyright holder who places the Program under this License may add an explicit geographical distribution limitation excluding those countries, so that distribution is permitted only in or among countries not thus excluded.  In such case, this License incorporates the limitation as if written in the body of this License.
+<P><STRONG>9.</strong> The Free Software Foundation may publish revised and/or new versions of the General Public License from time to time.  Such new versions will be similar in spirit to the present version, but may differ in detail to address new problems or concerns.
+
+<P>Each version is given a distinguishing version number.  If the Program specifies a version number of this License which applies to it and "any later version", you have the option of following the terms and conditions either of that version or of any later version published by the Free Software Foundation.  If the Program does not specify a version number of this License, you may choose any version ever published by the Free Software Foundation.
+<P><STRONG>10.</strong> If you wish to incorporate parts of the Program into other free programs whose distribution conditions are different, write to the author to ask for permission.  For software which is copyrighted by the Free Software Foundation, write to the Free Software Foundation; we sometimes make exceptions for this.  Our decision will be guided by the two goals of preserving the free status of all derivatives of our free software and of promoting the sharing and reuse of software generally.
+<P><STRONG>NO WARRANTY</strong></p>
+<P><STRONG>11.</strong> BECAUSE THE PROGRAM IS LICENSED FREE OF CHARGE, THERE IS NO WARRANTY FOR THE PROGRAM, TO THE EXTENT PERMITTED BY APPLICABLE LAW.  EXCEPT WHEN OTHERWISE STATED IN WRITING THE COPYRIGHT HOLDERS AND/OR OTHER PARTIES PROVIDE THE PROGRAM "AS IS" WITHOUT WARRANTY OF ANY KIND, EITHER EXPRESSED OR IMPLIED, INCLUDING, BUT NOT LIMITED TO, THE IMPLIED WARRANTIES OF MERCHANTABILITY AND FITNESS FOR A PARTICULAR PURPOSE.  THE ENTIRE RISK AS TO THE QUALITY AND PERFORMANCE OF THE PROGRAM IS WITH YOU.  SHOULD THE PROGRAM PROVE DEFECTIVE, YOU ASSUME THE COST OF ALL NECESSARY SERVICING, REPAIR OR CORRECTION.
+<P><STRONG>12.</strong> IN NO EVENT UNLESS REQUIRED BY APPLICABLE LAW OR AGREED TO IN WRITING WILL ANY COPYRIGHT HOLDER, OR ANY OTHER PARTY WHO MAY MODIFY AND/OR REDISTRIBUTE THE PROGRAM AS PERMITTED ABOVE, BE LIABLE TO YOU FOR DAMAGES, INCLUDING ANY GENERAL, SPECIAL, INCIDENTAL OR CONSEQUENTIAL DAMAGES ARISING OUT OF THE USE OR INABILITY TO USE THE PROGRAM (INCLUDING BUT NOT LIMITED TO LOSS OF DATA OR DATA BEING RENDERED INACCURATE OR LOSSES SUSTAINED BY YOU OR THIRD PARTIES OR A FAILURE OF THE PROGRAM TO OPERATE WITH ANY OTHER PROGRAMS), EVEN IF SUCH HOLDER OR OTHER PARTY HAS BEEN ADVISED OF THE POSSIBILITY OF SUCH DAMAGES.
+<P>
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/default/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/login.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/login.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,371 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Login</title>
-</head>
-<body>
-<h1>Login</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>P?ipojov?n? k datab?zi</title>
+  </head>
+  <body>
+  <h1>P?ipojov?n? k datab?zi a Odhla?ov?n? od datab?ze</h1>
+
+
+  	<p>
+	P?ed zapo?et?m pr?ce s Plantlore je zapot?eb? se p?ihl?sit k datab?zi, se kterou chcete pracovat.
+	</p>
+
+
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Proces p?ipojen? k datab?zi</li>
+		<li>Vytv??en? z?znam? o datab?zi</li>
+		<li>?prava a maz?n? z?znam? o datab?zi</li>
+		<li>Nej?ast?j?? probl?my p?i p?ipojov?n?</li>
+		<li>Odhl??en? od datab?ze</li>
+		<li>Obnova ztracen?ho p?ipojen?</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Proces p?ipojen? k datab?zi</h2>
+
+	<p>
+	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, prob?h? ve dvou kroc?ch.
+	</p>
+
+	<h3><a name="selectdb">1.1. V?b?r datab?ze</a></h3>
+	
+	<p>
+	<img src="picture/LoginDBSelection.png" alt="Volba datab?ze.">
+	</p>
+
+	<p>
+	Po instalaci Plantlore je k disposici jedna datab?ze pojmenovan? "Uk?zkov? datab?ze".
+	Tato datab?ze neobsahuje ??dn? n?lezov? data a je p?ipravena pro zapo?et? pr?ce.
+	Neobsahuje-li seznam datab?z? ??dn? z?znam, budete jej muset vytvo?it - o tom pojedn?v?
+	druh? ??st t?to n?pov?dy.
+	</p>
+
+	<p>
+	Po jist? dob? pou??v?n? Plantlore m??e v?? seznam datab?z? vypadat podobn? jako ten na obr?zku.
+	Plantlore automaticky p?edvol? tu datab?zi, kterou jste zvolili p?i posledn?m p?ihla?ov?n?.
+	Vyberte jednu z datab?z? v seznamu a stiskn?te tla??tko "Pokra?uj".
+	</p>
+
+
+	<h3><a name="authentication">1.2. Autentifikace - prokazov?n? toto?nosti</a></h3>
+
+	<p>
+	Pro p?ihl??en? k datab?zi je pot?eba se prok?zat p?ihla?ovac?mi ?daji 
+	- u?ivatelsk?m jm?nem a heslem. 
+
+	Pokud se p?ihla?ujete poprv?, zadejte p?ihla?ovac? ?daje, 
+	kter? jste pou?ili p?i instalaci Plantlore.
+
+	Nov? u?ivatelsk? jm?no a heslo sm? z bezpe?nostn?ch d?vod? p?id?lit pouze administr?tor datab?ze.
+	?asto i zku?en? u?ivatel? pou??vaj? velmi slab? hesla, proto je jejich p?id?lov?n?
+	p?enech?no jemu.
+	</p>
+	
+	<p>
+	<img src="picture/LoginAuthentication.png" alt="Vkl?d?n? p?ihla?ovac?ch ?daj?.">
+	</p>
+
+	<p>
+	Plantlore si pamatuje n?kolik posledn?ch u?ivatelsk?ch jmen vkl?dan?ch p?i p?ihl??ov?n?;
+	m??ete vybrat jedno z p?ipraven?ho seznamu, nebo zadat jin? u?ivatelsk? jm?no.
+	Hesla Plantlore neukl?d? a automaticky je nikdy nenab?z?.
+	Po zad?n? ?daj? stiskn?te tla??tko "P?ihl?sit". 
+	</p>
+
+	<p>
+	Stiskem tla??tka "P?ihl?sit" se Plantlore pokus? p?ipojit k vybran? datab?zi se zadan?mi
+	p?ihla?ovac?mi ?daji. P?ipojen? m??e (zejm?na pokud se p?ipojujete ke vzd?len? datab?zi)
+	trvat del?? dobu.
+	</p>
+
+
+	<p>
+	Pokud se p?ihl??en? z n?jak?ho d?vodu nezda??, budete o tom informov?ni kr?tkou zpr?vou.
+	V opa?n?m p??pad? Plantlore zobraz? z?kladn? <a href="./overview.html">P?ehled</a>.
+	</p>
+
+
+	<h2 id="AddDBInfo">2. Vytv??en? z?znam? o datab?z?ch</h2>
+
+	<p>
+	Chcete-li se p?ipojit k jin? datab?zi, 
+	kterou jste sami vytvo?ili nebo kterou vytvo?il n?kdo jin? na sv?m po??ta?i,
+	mus?te vytvo?it nov? z?znam, kter? popisuje, kde se datab?ze nach?z? a jak je nastavena.
+	</p>
+
+	<p>
+	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho
+	tla??tka my?i. Vyberte polo?ku "P?idat" a klikn?te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginAddMenu.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+	<p>
+	P?id?n? nov?ho z?znamu pro p?ipojen? k datab?zi je rozd?leno na dv? ??sti, 
+	jim? odpov?daj? dv? z?lo?ky na dialogu. 
+	<ul>
+		<li>
+		Prvn? z nich je <b>p??m? p?ipojen?</b>, t?? lok?ln? p?ipojen?. 
+		P??m? p?ipojen? k datab?zi lze pou??t pouze v p??pad?,
+		?e vytvo?en? datab?ze se nach?z? v datab?zov?m stroji (database engine), kter? b??? na
+		tomto po??ta?i, tzv. lok?ln?. P??m? p?ipojen? vy?aduje pon?kud odli?n? parametry ne? 
+		p?ipojen? ke vzd?len? datab?zi. V?hodou p??m?ho p?ipojen? je jeho rychlost - komunikace
+		s datab?z? se nemus? nijak upravovat pro p?enos po s?ti.
+		</li>
+		<li>
+		Druh? mo?nost je tzv. <b>vzd?len? p?ipojen?</b>, p?ipojen? ke vzd?len? datab?zi.
+		Vzd?len? datab?ze se typicky nach?z? v datab?zov?m stroji (database engine), kter? je
+		spu?t?n na jin?m po??ta?i v s?ti. Pomoc? tohoto p?ipojen? je mo?n? pracovat s datab?z?
+		"na d?lku". Nev?hodou je zpomalen? dan? jednak propustnost? datov? linky a jednak 
+		nutnost? speci?ln? upravovat p?en??en? data kv?li p?enosu po s?ti. 
+		</li>
+	</ul>
+	</p>
+
+
+	<h3>A. P??m? p?ipojen? k datab?zi (lok?ln? p?ipojen?)</h3>
+
+	<p>
+	Parametry popisuj?c? p??m? p?ipojen?:
+	<table>
+		<tr>
+			<th>N?zev</th>
+			<th>V?znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
+				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
+				nap??klad: "Dom?c? datab?ze", "Projekt mapov?n? ?esk?ho st?edoho??".
+			</td>
+		</tr>
+		<tr>
+			<td>Datab?zov? stroj (engine)</td>
+			<td>
+				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
+				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
+				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
+				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
+				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
+				aby s n?m bylo mo?n? bezchybn? komunikovat. Plantlore je standardn? dod?v?na
+				s Postgre. Aktu?ln? podporovan? DB stroje jsou seps?ny v rozbalovac?
+				nab?dce, ale je mo?n? specifikovat i jin?.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik?tor DB</td>
+			<td>
+				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
+				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor (jm?no)
+				datab?ze, se kterou chce pracovat.
+			</td>
+		</tr>
+		<tr>
+			<td>Port DB</td>
+			<td>
+				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
+				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore v?d?l,
+				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
+				vyu??vaj? porty v rozsahu 1.024 a v??e. Nap??klad standardn? port datab?zov?ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+		<tr>
+			<td>Parametr</td>
+			<td>
+				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
+				zp?sobem. N?kter? stroje nap??klad vy?aduj? explicitn? nastaven? k?dov?n?
+				znak?. Parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
+				P?ipojen? k Postgre ??dn? parametr nevy?aduje.
+				<br/>
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za "?".</i>
+			</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	Na uk?zku uve?me, jak by vypadalo lok?ln? p?ipojen? k datab?zi nazvan? "plantlore",
+	kter? je ulo?ena v datab?zov?m stroji "Postgre", kter? naslouch? na portu "5432".
+	</p>
+
+	<p>
+	<img src="picture/LoginDBDirectConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+
+	<h3>B. Vzd?len? p?ipojen? k datab?zi</h3>
+
+	<p>
+	Parametry popisuj?c? vzd?len? p?ipojen?:
+	<table>
+		<tr>
+			<th>N?zev</th>
+			<th>V?znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
+				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
+				nap??klad: "Ofici?ln? datab?ze Jiho?esk? pobo?ky ?BS".
+			</td>
+		</tr>
+		<tr>
+			<td>Host</td>
+			<td>
+				Datab?zov? stroj obsahuj?c? datab?zi, k n?? se chceme p?ipojit, b??? na jin?m
+				po??ta?i v s?ti. Tento parametr identifikuje tento po??ta? a to bu? podle
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
+				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
+				"data.domacisit.cz". C?lov? po??ta? lze identifikovat 
+				ob?ma zp?soby.
+			</td>
+		</tr>
+		<tr>
+			<td>Port</td>
+			<td>
+				Aby bylo mo?n? se p?ipojit ke vzd?len?mu datab?zov?mu stroji, je nutn?
+				na uveden?m vzd?len?m po??ta?i kontaktovat 
+				<a href="./server.html">Plantlore Server</a>, co? je speci?ln?
+				aplikace, kter? m? za ?kol zprost?edkov?vat p?ipojen? vzd?len?m klient?m a
+				dohl??et na po?et p?ipojen?ch u?ivatel?. Tato slu?ba mus? b?t p??stupn?
+				na vzd?len?m po??ta?i, kde se nach?z? i vzd?len? datab?zov? stroj, 
+				a naslouch? na n?jak?m portu. Standardn? port, na kter?m je tato slu?ba
+				dostupn?, je 1099.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik?tor DB</td>
+			<td>
+				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
+				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor
+				datab?ze, se kterou chce pracovat.
+			</td>
+		</tr>
+	</table>
+	</p>
+	
+	<p>
+	Na uk?zku uve?me, jak by vypadalo nastaven? pro vzd?len? p?ipojen? k datab?zi nazvan? "plantlore",
+	kter? je ulo?ena v datab?zov?m stroji, 
+	kter? se nach?z? na po??ta?i s adresou "192.168.0.247", 
+	a Plantlore Server naslouch? na portu "1099".
+	</p>
+
+	<p>
+	<img src="picture/LoginDBRemoteConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		P?id?v?te-li nov? z?znam, ??dn? nov? datab?ze se nikde nevytv???; vytv??? se pouze
+		reference (odkaz) na n?jakou existuj?c? datab?zi.
+	</b>
+	</p>
+
+
+
+	<h2>3. ?prava a maz?n? z?znam? o datab?zi</h2>
+
+	<p>
+	V seznamu datab?z? ozna?te z?znam, kter? chcete upravit nebo smazat.
+	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho tla??tka my?i. 
+	Vyberte polo?ku "Editovat" nebo "Odstranit" a klikn?te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginEditMenu.png" alt="?prava st?vaj?c?ho z?znamu.">
+	</p>
+
+	<p>
+	?prava z?znam? je shodn? s dialogem pro p?id?n? z?znamu, ale obsahuje p?edvypln?n? hodnoty.
+	Detailn? popis lze naj?t v p?edch?zej?c? ??sti.
+	</p>
+
+	<p>
+	Odstran?n? z?znamu dal?? nastaven? nem?.
+	</p>
+
+	<p>
+	<img src="picture/LoginDeleteMenu.png" alt="Vymaz?n? existuj?c?ho z?znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		Ma?ete-li existuj?c? z?znam, ??dn? datab?ze se nikde nema?e; ru?? se pouze
+		reference (odkaz) na n?jakou existuj?c? datab?zi.
+	</b>
+	</p>
+
+
+
+	<h2>4. Nej?ast?j?? probl?my p?i p?ipojov?n?</h2>
+
+	<p>
+	Nej?ast?j?? probl?my p?i p?ipojov?n? jsou tyto:
+	<ol>
+		<li>
+		Nespr?vn? vypln?n? p?ihla?ovac? ?daje - u?ivatelsk? jm?no nebo ?patn? zadan? heslo.
+		Ov??te, zda jste spr?vn? zadali oba ?daje, p??padn? zda m?te vytvo?en?
+		odpov?daj?c? u?ivatelsk? ??et v datab?zi, k n?? se p?ipojujete.
+		</li>
+		<li>
+		Nespr?vn? zadan? parametry pro p??m? nebo vzd?len? p?ipojen? k datab?zi.
+		Ov??te, zda jsou vypln?ny v?echny polo?ky spr?vn? a zda obsahuj? aktu?ln? data. 
+		Nap?. mohlo doj?t ke zm?n? IP adresy po??ta?e, ke kter?mu se p?ihla?ujete, nebo jste
+		ud?lali p?eklep p?i zad?v?n? identifik?toru datab?ze.
+		</li>
+		<li>
+		Vypnut? datab?zov? stroj nebo Plantlore Server.
+		Ov??te, ?e datab?zov? stroj je zapnut?, resp. se ujist?te, ?e na vzd?len?m po??ta?i
+		je spu?t?n Plantlore Server.
+		</li>
+	</ol>
+	</p>
+
+
+
+	<h2>5. Odhl??en? od datab?ze</h2>
+
+	<p>
+	Po skon?en? pr?ce s datab?z? je doporu?eno se odhl?sit, aby t?et? osoba nez?skala mo?nost
+	pracovat s va?imi daty. Odhl??en? provedete bu? v menu polo?kou "Odhl?sit" nebo
+	vypnut?m Plantlore. Oba zp?soby jsou ekvivalentn?.
+	</p>
+
+
+	<h2>6. Obnova ztracen?ho p?ipojen?</h2>
+
+	<p>
+	P?i pr?ci s Plantlore m??e doj?t k n?hl? ztr?t? p?ipojen? k datab?zi nebo vzd?len?mu serveru.
+	D?vodem m??e b?t neo?ek?van? vypnut? nebo p?d datab?zov?ho stroje nebo Serveru ?i v?padek s??ov?ho spojen?.
+	O tomto stavu jste informov?ni kr?tkou zpr?vou, kter? popisuje probl?m, ke kter?mu do?lo.
+	V p??pad? ztracen?ho spojen? s datab?z? nebo Serverem vy?kejte n?jakou dobu a zkuste 
+	v menu vybrat "Znovu p?ipojit". Plantlore se pokus? nav?zat nov? spojen?. 
+	"Znovu p?ipojit" m??ete volat opakovan?.
+	</p>
+
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/metadata.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/metadata.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/metadata.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,117 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html>
 <head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Metadata manager</title>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - Metadata management</title>
 </head>
 <body>
-<h1>Metadata manager</h1>
-</body>
-</html>
\ No newline at end of file
+<h1>Metadata management</h1>
+<img src="picture/metadataEnter.png">
+<br><br>
+
+Metadata manager allows the <b><i>administrator </i></b>to add, edit, and delete the metadata of individual projects.
+You can open the metadata manager from menu <b>Data/Metadata management</b> or by keyboard shortcut CTRL + M.
+
+<h5>Metadata manager dialog</h5>
+
+<img src="picture/metadataDialog.png">
+<br><br>
+The metadata management dialog is divided into two parts:
+<ul>
+  <li><b>List of project metadata</b> - displays the list of metadata of existing projects based on criteria entered for searching and sorting 
+  <li><b>Search</b> - requirements for searching and sorting of metadata
+</ul>
+
+<h2>List of metadata</h2>
+
+This part displays the list of metadata found after a successful search. You can set the number of projects displayed in the table 
+yourselves by changing the value of <i><b>Lines displayed</b></i> and confirming the new value by the ENTER key. Use <i><b>Previous </b></i>and <i><b>Next </b></i>buttons 
+to switch over to the previous or next list of metadata. Information about the currently displayed list of project metadata is stated in the 
+part below the table.<br>
+The following buttons enable the work with a record:
+<ul>    
+   <li><i><b>Add metadata</i></b> - <a href=#add>adds project metadata</a></li>
+   <li><i><b>Edit metadata</i></b> - <a href=#edit>edits project metadata</a></li>
+   <li><i><b>Metadata detail </i></b> - <a href=#detail>detailed project metadata</a></li>
+   <li><i><b>Remove metadata</i></b> - <a href=#drop>removes project metadata</a></li> 
+</ul>   
+
+  
+<h2>Search</h2>
+
+Metadata manager 
+
+User manager offers the administrator the option to search using the following three parameters: institution, project name, and data source.
+The results may be sorted by the institution name, project name, data source, name of the person responsible for technical assistance, name of the person
+responsible for content assistance, date of the project creation and date of the most recent project modification.
+If no parameters and limitations are entered, all project metadata will be found. 
+<br><br>
+<b>Note:</b> the search is case sensitive.
+
+a (case sensitive).
+
+<a name="add"></a><h2>Adding project metadata</h2>
+  
+  <h5>Add metadata dialog</h5>
+  
+  <img src="picture/metadataAdd.png">
+  <br><br>
+Open the Add metadata dialog from Metadata manager. The window displayed offers the following items:
+
+  
+  <ul>
+    <li><b>Institution</b> - unequivocal identifier of the institution that owns the original data source.
+    This item is obligatory and you will not be able to add metadata without filling it in.</li>
+    <li><b>Organization</b> - abbreviation of the organization.</li>
+    <li><b>Technical assistance</b> - name of the person responsible for the technical part of the project. This item is obligatory.</li>
+    <li><b>Technical assistance - e-mail</b> - contact e-mail of the person responsible for the technical part of the project.</li>
+    <li><b>Technical assistance - address</b> - contact address of the person responsible for the technical part of the project.</li>
+    <li><b>Content assistance</b> - name of the person responsible for the content part of the project. This item is obligatory.</li>
+    <li><b>Content assistance - e-mail</b> - contact e-mail of the person responsible for the content part of the project.</li>
+    <li><b>Content assistance - address</b> - contact address of the person responsible for the content part of the project.</li>
+    <li><b>Project name</b> - short name of the project. Project name is an obligatory item and must be unequivocal in the database.</li>
+    <li><b>Project details</b> - detailed description of the project.</li>
+    <li><b>Source</b> - name or code of the data source. This item is obligatory.</li>
+    <li><b>Basis</b> -  information about what the given records describe (preserved specimen, ...).</li>
+    <li><b>Biotope</b> - information about the biotope</li>
+    <li><b>Date of project creation</b> - date and time of project creation. This item is obligatory.</li>
+    <li><b>Date of most recent project modification</b> - date and time of the most recent modification, entering, or deletion of records in the project.</li>        
+ </ul>
+ 
+<a name="edit"></a><h2>Editing metadata</h2>
+
+Open the Edit metadata dialog from Metadata manager. Don?t forget that you must select a project the metadata of which you aim to edit in order to open this dialog. 
+The layout of the Edit metadata dialog is almost identical with the Add metadata dialog. The obligatory items are: institution, name of the person responsible for 
+technical assistance, name of the person responsible for content assistance, name of the project, and data source.<br> 
+  Non-editable items:
+
+  
+  <ul>    
+    <li><b>Date of project creation</b> - date and time of project creation. 
+	Non-editable item.</li>
+    <li><b>Date of most recent project modification</b> - date and time of the 
+	most recent modification, entering, or deletion of records in the project. 
+	Non-editable item.</li>
+  </ul>
+
+The administrator may find the information about the changes performed in individual pieces of metadata in the <a href="./history.html#historyData">whole history</a>
+dialog, where he may also utilize the option of reverting into previous values.
+
+<a name="detail"></a><h2>Detailed project metadata</h2>
+
+This dialog displays detailed information about the project metadata. You have to select a project in order to be able to open this dialog. 
+The dialog is almost identical with the Edit metadata dialog. All items are non-editable, their nature is purely informative.
+
+  
+<a name="drop"></a><h2>Removing project metadata</h2>
+
+Use button <b><i>Delete metadata </i></b>in the Metadata manager to delete the metadata of a particular project. Before pressing this 
+  button, it is necessary to select the metadata. After the button is pressed, the user will be informed about the 
+  operation about to be performed. By confirming the operation, the metadata will be deleted. 
+
+  <br><br>
+  <img src="picture/metadataDelete.png">
+  <br><br>
+  The administrator may recover the deleted metadata by means of the <a href="./history.html#historyData">whole history</a> dialog.
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/occurr_history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/occurr_history.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/occurr_history.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,5 +1,6 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>Occurrence records history</title>
 </head>

Modified: trunk/src/net/sf/plantlore/help/default/html/overview.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/overview.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/overview.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,77 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Plant overview</title>
-</head>
-<body>
-<h1>Plant overview</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>P?ehled n?lez?</title>
+  </head>
+  <body>
+  <h1>P?ehled n?lez?</h1>
+  <p>Centrem Plantlore je p?ehled n?lez?, do kter?ho se dostanete po ?sp??n?m p??hl??en? k serveru. Z p?ehledu
+  n?lez? je pak mo?n? vyvol?vat v?t?inu ostatn?ch funkc? Plantlore.</p> 
+  <br>
+   <img src="picture/overview.png" alt="P?ehled n?lez?"><br>
+    <h2>Obsah</h2>
+    <ol>
+        <li>?vod</li>
+        <li>Ovl?dac? prvky p?ehledu n?lez?</li>
+        <li>T??d?n?</li>
+        <li>Po?ad? sloupk?</li>
+        <li>Podrobnosti o n?lezu</li>
+    </ol>
+    <h2>1. ?vod</h2>
+    <p> P?ehled n?lez? je tabulka zobrazuj?c? seznam n?lez?. Implicitn? jsou zobrazeny
+    v?echny z?znamy. Jejich seznam je ale mo?n? z??it <a href="search.html">vyhled?v?n?m</a>. </p>
+    
+    <p>V?sledek vyhled?v?n? se v?dy zobrazuje v P?ehledu n?lez?. Pro n?vrat k seznamu v?ech n?lez? sta??
+    vyvolat <a href="search.html">dialog hled?n?</a>, nic nevyplnit a pouze kliknout na tla??tko Ok.</p>
+    
+    <h2>2. Ovl?dac? prvky p?ehledu n?lez?</h2>
+    <p>Pokud s n?lezy pracujete, p?ehled n?lez? se automaticky neaktualizuje, z?st?vaj? v n?m zobrazeny
+    star? hodnoty. Tak je to z d?vodu efektivn?j?? pr?ce s aplikac? p?i pomalej??m p?ipojen? na s??. Obnoven?
+    p?ehledu se prov?d? bu? op?tovn?m hled?n?m anebo kliknut?m na tla??tko Obnovit v prav? doln? ??sti okna.</p>
+    <br>
+    <img src="picture/overview_second_toolbar.png" alt="N?stroje pro pr?ci s p?ehledem n?lez?"><br>
+    
+    <p>Po?et z?znam? na str?nku je mo?n? m?nit p?eps?n?m ??sla mezi tla??tky P?edchoz? a N?sleduj?c?. Po potvrzen?
+    stiskem kl?vesy Enter se velikost str?nky zm?n?. Po?et z?znam? na str?nku z technick?ch d?vod? NEN? moment?ln? mo?n? 
+    ur?ovat dynamicky
+    podle aktu?ln? velikosti okna. Z bezpe?nostn?ch d?vod? je po?et z?znam? na stranu omezen na 1 000.</p>
+    
+    <p>Chceteli z?znamy mazat, tisknout nebo exportovat je pot?eba je nejprve vybrat ozna?en?m ve sloupku
+        s n?zvem X. Ozna?ov?n? z?znamu se prov?d? za?krtnut?m p??slu?n?ho pol??ka ve sloupku X. K hromadn?mu ozna?en?, 
+        odzna?en? a invertov?n? ozna?en?ch z?znam? slou?? tla??tka V?e, Nic a Invertuj v lev? doln? ??sti okna.
+        <b>POZOR:</b><i> Vyvolan? ozna?ovac? akce se v?dy t?k? pouze z?znam? na aktu?ln? str?nce!</i> Po ozna?en? z?znam?, se kter?mi chcete pracovat,
+    sta?? vyvolat p??slu?n? p??kaz z menu, n?strojov? li?ty anebo kl?vesovou zkratkou.</p>
+    <br>
+    <img src="picture/overview_selecting.png" alt="V?b?r z?znam?"><br>
+    
+    <h2>3. T??d?n?</h2>
+    <p>P?ehled n?lez? tak? poskytuje omezen? mo?nosti t??d?n? z?znam?. T??d? se v?dy pouze z?znamy aktu?ln?
+    zobrazen? na str?nce. Net??d? se v?echny z?znamy v datab?zi, proto?e by to p?i velk?m mno?stv? z?znam? 
+    vy?adovalo mnoho ?asu v p??pad? pomalej??ho spojen? k serveru. Chcete-li set??dit z?znamy  
+    nap??klad podle roku n?lezu, klikn?te na z?hlav? sloupku Rok. V z?hlav? se objev? ?ipka indikuj?c? sm?r t??d?n?.
+    Z?znamy se po prvn?m kliknut? set??d? vzestupn? podle roku.
+    Chcete-li je set??dit setupn? sta?? znova kliknout na z?hlav? sloupku Rok. T?et? kliknut? t??d?n? zru??. 
+    P?ehled umo??uje i druhotn? t??d?n?, tj. nap??klad nejd??ve podle roku a pak podle nejbli???ho s?dla. 
+    To lze prov?st kliknut?m nejd??ve na z?hlav? sloupku Rok a pak stisknout a dr?et kl?vesu Ctrl
+    a kliknout na z?hlav? sloupku Nejbli?s? s?dlo. Druhotn? t??d?n? indikuje o n?co men?? ?ipka v z?hlav? sloupku.</p>
+    <br>
+    <img src="picture/overview_sorting.png" alt="T??d?n? z?znam?"><br>
+    
+    <h2>4. Po?ad? sloupk?</h2>
+    <p>Po?ad? zobrazen?ch sloupk? je mo?n? m?nit. A to bu? do?asn? prost?m p?esunut?m sloupku, chycen?m a posouv?n?m my?? za jeho
+    z?hlav?, anebo trvale v <a href="settings.html">Nastaven?ch</a>. V nastaven?ch je mo?n? si vybrat
+    i jin? sloupky, kter? se maj? zobrazit, p??padn? n?jak? vynechat.</p>
+    
+    <h2>5. Podrobnosti o n?lezu</h2>
+    <p>V tabulce n?lez? nejsou vid?t v?echny informace o n?lezu. Ty je mo?n? zobrazit bu? vyvol?n?m
+    dialogu pro editaci n?lezu nebo vyvol?n?m detailu n?lezu. Detail n?lezu se vyvol?v? bu? dvojklikem na 
+    p??slu?n? n?lez anebo ozna?en?m n?lezu my?? a stiskem kl?vesy Enter.</p>
+    <br>
+    <img src="picture/overview_detail.png" alt="Detail n?lezu"><br>
+    
+    <p>Detail n?lezu umo??uje p?echod na dal?? nebo p?edchoz? n?lez kliknut?m na tla??tko P?edch?zej?c? nebo
+    N?sleduj?c?. Zobrazuje i informace o tom, kter? u?ivatel Plantlore n?lez vytvo?il, a kdo ho naposledy editoval.</p>  
+  </body>
+</html>

Added: trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/AuthorsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistDefault.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistDefault.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistUsage.jpg
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ChecklistUsage.jpg
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBAuth.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBAuth.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/CreateDBMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ExportProgress.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ExportProgress.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingColumns.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingColumns.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingRecords.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSelectingRecords.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSupplyingName.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ExportSupplyingName.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginAddMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginAddMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginAuthentication.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginAuthentication.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBDirectConnection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBDirectConnection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBRemoteConnection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBRemoteConnection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBSelection.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDBSelection.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDeleteMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginDeleteMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/LoginEditMenu.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/LoginEditMenu.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsMain.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/PublicationsMain.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ServerConnect.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ServerConnect.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ServerCreate.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ServerCreate.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/ServerManager.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/ServerManager.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence_table.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_occurrence_table.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_place.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/addedit_place.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/habitat_tree.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/habitat_tree.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/historyEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/historyEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/historyOcc.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/historyOcc.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/historyOccMark.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/historyOccMark.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/historyUndo.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/historyUndo.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/metadataAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/metadataAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/metadataDelete.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/metadataDelete.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/metadataDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/metadataDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/metadataEdit.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/metadataEdit.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/metadataEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/metadataEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/overview.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/overview.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/overview_detail.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/overview_detail.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/overview_second_toolbar.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/overview_second_toolbar.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/overview_selecting.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/overview_selecting.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_extended.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_extended.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_simple.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/search_dialog_simple.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/settings_columns.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/settings_columns.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/settings_languages.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/settings_languages.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/settings_scheda.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/settings_scheda.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userAdd.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userAdd.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userDrop.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userDrop.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userEdit.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userEdit.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/userRight.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/userRight.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDetail.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDetail.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDialog.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryDialog.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryEnter.png
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/help/default/html/picture/wholeHistoryEnter.png
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/help/default/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/publication.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/publication.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,68 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
 <title>Publication manager</title>
 </head>
 <body>
 <h1>Publication manager</h1>
+Publication manager allows users to add, search, modify and delete publications where the occurrence records were published.
+It can be invoked from menu <strong>Data|Publication Manager</strong>.
+<p/>
+The Publication Manager window consists of two main parts:
+<ul>
+    <li><strong>The list of publications</strong> - where the results of the search are displayed</li>
+    <li><strong>The search criteria</strong> - where you can specify search parameters for publications</li>    
+</ul>
+<img src="picture/PublicationsMain.png">
+<h3>The list of publications</h3>
+After a succcessful search results are displayed in the list of publications, although not all of them can
+be seen immediately. Initially, only the first page of the results is displayed. To see the rest
+of the pages use <i>Next</i> and <i>Previous</i> buttons which can be found directly under the list.
+In case you would like to display more publications per page, input the requested number of publications to the 
+field below the list of publications.
+<p/>
+This part also includes buttons for adding, editing and deleting publications. The <i>Add publication</i> and
+<i>Edit publication</i> buttons open the Add/Edit Publication Dialog (see below), the <i>Delete publication</strong>
+button removes the publication after the confirmation. When <i>Edit</i> or </i>Delete</i>
+button is pressed, publication must be selected in the list in order to proceed with the operation 
+(otherwise the system will warn you that there is no publication selected). Adding and editing publications
+is subject to the system of rights in plantlore. For more information on this topic, see the
+appropriate help section.
+
+<h3>The search criteria</h3>
+Publication manager allows users to search the data using 4 parameters: Collection name, Journal name, 
+Reference citation and Reference detail. Results can be ordered by Collction name, Publication year, 
+Journal name, Journal author, Reference citation and Reference Detail in either 
+ascending or descending direction. Search string for any of the parameters doesn't have to match 
+the item in the database exactly and any substring will be sufficient (although it might yield more 
+results). To start searching use <i>Search publications</i> button.
+<p/>
+The search is by default case insensitive.
+<p/>
+After the manager window is opened, all available publications are displayed. If you've executed a search
+but you want to display and browse all available publications again, press the <i>Search publications</i>
+button while all of the search fields are left blank.
+<p/>
+<h2><a name="add">Adding and editing publications</a></h2>
+Window for adding new publications can be opened from the main Publication Manager window using <i>Add 
+publication</i> button. This window contains the following fields:
+<ul>
+    <li><b>Collection name</b> - Name of the collection this publication belongs to. Maximum size of this item is 255 characters.</li>
+    <li><b>Publication year</b> - Year when the occurrence was published.</li>
+    <li><b>Journal name</b> - Journal name where the occurrence was published. Maximum length of this item is 255 characters.</li>
+    <li><b>Journal author name</b> - Author of the journal where the occurrence was published. Maximum length of this item is 255 characters.</li>
+    <li><b>Refernce detail</b> - Reference detail for the publication. Maximum length of this item is 100 characters.</li>
+    <li><b>URL</b> - URL pointing to the publication. Maximu length of this item is 100 characters.</li>
+    <li><b>Note</b> - Any other information about the publication. Maximum length of this item is 4096 characters.</li>    
+</ul>
+<img src="picture/PublicationsAdd.png">
+<p>
+New publication can be saved using the <i>Save publication</i> button in the bottom of the window. At least one of the following items has to be present: Journal author, Publication year, 
+Journal author name, Collection name.
+</p>
+In case you edit already existing publication, all of the items are preloaded with the current parameters of the publication and you can modify them. You can save the modifications by 
+pressing <strong>Save publication</strong> button. Same as when creating new publication, at least one of the following items has to be present: Journal author, Publication year, Journal 
+author name, Collection name.
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/default/html/resources.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/resources.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/resources.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,22 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Plantlore resources</title>
-</head>
-<body>
-<h1>Plantlore resources</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Zdroje</title>
+  </head>
+  <body>
+  <h1>Zdroje</h1>
+Mnoho informac? v?etn? nejaktu?lnej?? verze Plantlore najdete na na?? dom?ci str?nce uveden? n??e.
+V p??pad? jak?chkoliv probl?m? se obra?te na n?kter?ho z v?voj??? Plantlore
+<p>
+Dom?c? str?nka Plantlore: <a href="http://plantlore.berlios.de">http://plantlore.berlios.de</a>
+<p>
+Ulo?i?te zdrojov?ch k?d? (SVN): svn://svn.berlios.de/plantlore/trunk/
+<p>
+Zaznamen?v?n? chyb: <a href="https://developer.berlios.de/bugs/?group_id=5975">https://developer.berlios.de/bugs/?group_id=5975</a>
+<p>
+Po?adavky na nov? funkce: <a href="https://developer.berlios.de/feature/?group_id=5975">https://developer.berlios.de/feature/?group_id=5975</a>
+  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/search.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/search.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/search.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,50 @@
 <html>
 <head>
+<meta http-equiv="Content?Language" content="en?US" />
 <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Search occurrences</title>
+<title>Searching in occurrence data</title>
 </head>
 <body>
-<h1>Search occurrences</h1>
+<h1>Searching in occurrence data</h1>
+<p>The search dialog resembles add and edit dialogs a lot, but also differs in a few ways.
+It is not possible to add taxons from the checklist. On the other hand you can set either
+month or time interval for searching.</p>
+
+<p>The search dialog opens empty every time. In case you leave it empty and click
+ straight on the Ok button then a list of all occurrences will be displayed in the
+<a href="overview.html">Overview</a>. So now we've just described a way to return
+to all occurrences in the Overview.</p>
+
+<p>It is possible to fill in any combination of the displayed items. The dialog
+only won't let you enter wrong values such as words where it expects numbers, or
+ you can't enter month and time interval at the same time.</p>
+
+<h2>Adding of authors, their roles and notes</h2>
+<p>You can add the author, role or the note the same way as in the add and edit dialogs.
+Click on the Add button in the upper left part of the basic form. New row appears.
+You can fill in the author's name, role or her note.
+The only tricky thing might be that if you add multiple rows and fill in different authors
+ roles or notes all these items will be added to the query using the OR conjuction.
+Here is a little example. You add the first row and fill in "Mosgaard" as the author and "collect"
+as the role. Then you add the second row and fill in "Kroghshoj" and "revised" as the role. 
+If you then click the Ok button then occurrences whose author is either Mosgaard or Kroghshoj are displayed
+as well as occurrences in that some of the authors has role collect or role revised.</p>
+
+<h2>How is the query constructed</h2>
+<p>We've already described the way the query is created in the case of authors, roles and 
+the notes of authors. The rest is quite straightforward. In case you add one or more taxons,
+let's say a Camomile and a Dandelion then occurrences of either of these plants are searched for.
+In other words taxons are connected by the OR conjuction. </p>
+<p>The other itmes are connected to the query using the AND conjuction. Let's say
+you enter Camomile and Dandelion as taxons and Bohemia centralis as territory.
+Then after clicking on the Ok button occurrences of Camomiles in Bohemia centralis and
+occurrences of Dandelions in Bohemia centralis are displayed in the <a href="overview.html">Overview</a></p>
+<p>One more thing worth mentioning is searching in the notes. When searching in notes
+the application looks for substrings in the notes in the database. That means if you
+enter the word "meadow" to the Place description text area and then click on Ok then
+ all occurrences with the string "meadow" in their Place descritption will be displayed.
+ The same way it works when searching in the occurrence or location note.</p>
+ 
+</p>
 </body>
 </html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/default/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/server.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/server.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -2,10 +2,281 @@
 
 <html>
   <head>
-    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
-    <title>Server</title>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Plantlore Server</title>
   </head>
   <body>
-  <h1>Server</h1>
+	<h1>Plantlore Server</h1>
+
+	<p>
+	Aby se mohli k va?? datab?zi p?ipojovat i jin? u?ivatel? z po??ta?? v s?ti, 
+	mus? b?t spu?t?n Plantlore Server. 
+	Server zprost?edkov?v? p?ipojen? vzd?len?m klient?m a dohl??? na dodr?ov?n?
+	p?edepsan?ho po?tu klient?. Standardn? se z jednoho po??ta?e (z jedn? IP adresy)
+	sm? p?ihl?sit nejv??e t?i klienti a maxim?ln? celkov? po?et sou?asn? p?ipojen?ch
+	u?ivatel? je omezen na 32.
+	</p>
+
+
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Vytvo?en? a spu?t?n? nov?ho serveru</li>
+		<li>P?ipojen? k existuj?c?mu serveru za ??elem administrace</li>
+	</ol>
+	</p>
+
+
+
+
+	<h2><a name="connection">1. Vytvo?en? a spu?t?n? nov?ho serveru</a></h2>
+
+	<p>
+	Nastaven? serveru lze prov?st na z?lo?ce "Spustit nov? server".
+	</p>
+
+	<p>
+	<img src="picture/ServerCreate.png" alt="Spu?t?n? serveru.">
+	</p>
+
+
+	<p>
+	Server lze spustit pouze na lok?ln?m po??ta?i. Jako spr?vce serveru m?te mo?nost nastavit n?sleduj?c? parametry:
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th colspan="2">
+				Nastaven? serveru
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Po spu?t?n? je mo?n? server administrovat 
+				i ze vzd?len?ho po??ta?e.
+				Aby k n?mu nem?ly p??stup nepovolan? osoby, 
+				je mo?n? nastavit heslo, kter?m bude server chr?n?n.
+				Kdokoli se bude cht?t k serveru p?ipojit za ??elem
+				administrace, bude se muset t?mto heslem prok?zat.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur?uje, kde bude server naslouchat, aby se k n?mu mohli 
+				p?ipojovat vzd?len? klienti. 
+
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
+				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
+				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
+
+				Porty nelze sd?let - ujist?te se, ?e na zvolen? port ji?
+				n?kter? jin? aplikace nepou??v?.
+
+				Standardn? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<th colspan="2">
+				Nastaven? datab?zov?ho stroje
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Typ DB
+			</td>
+			<td>
+				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
+				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
+				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
+				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
+				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
+				aby s n?m mohl bezchybn? komunikovat. Plantlore je standardn? dod?v?n
+				s Postgre. Aktu?ln? podporovan? DB stroje jsou vyps?ny v rozbalovac?
+				nab?dce, ale je mo?n? specifikovat i jin?.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port DB
+			</td>
+			<td>
+				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
+				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore Server v?d?l,
+				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
+				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Nap??klad standardn? port datab?zov?ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Parametr
+			</td>
+			<td>
+				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
+				zp?sobem. N?kter? stroje kup??kladu vy?aduj? explicitn? nastaven? k?dov?n?
+				znak?. Tenot parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
+				P?ipojen? k Postgre ??dn? parametr nevy?aduje, ale nap?. pro spr?vn? zobrazen?
+				diakritiky od Firebird je pot?eba k?dov?n? nastavit.
+				<br/>
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za :?:</i>
+			</td>
+		</tr>
+
+	</table>
+	</p>
+
+
+
+	<h2><a name="info">2. P?ipojen? k b???c?mu serveru</a></h2>
+
+
+	<p>
+	V?te-li, ?e n?kde b??? server, kter? jste spustili, m??ete jej vzd?len?  
+	administrovat. Nejprve se k tomuto serveru
+	mus?te p?ipojit pomoc? z?lo?ky "P?ipojen? k b???c?mu serveru".
+	</p>
+
+	<p>
+	<img src="picture/ServerConnect.png" alt="Spu?t?n? serveru.">
+	</p>
+
+
+	<p>
+	Pro p?ipojen? je nutno specifikovat n?sleduj?c? parametry
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Host
+			</td>
+			<td>
+				Tento parametr identifikuje po??ta?, kde server b???, a to bu? podle
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
+				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
+				"data.domacisit.cz". 
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur?uje, kde vzd?len? server naslouch?.
+
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
+				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
+				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
+
+				Standardn? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Heslo chr?n?c? p??stup k serveru pro ??ely administrace.
+			</td>
+		</tr>
+	</table>
+	</p>
+
+
+
+
+	<h2><a name="manager">3. Administrace serveru</a></h2>
+
+	<p>
+	Administrace slou?? p?edev??m k z?sk?n? informac? o aktu?ln? p?ipojen?ch u?ivatel?ch
+	a vyp?n?n? serveru. Administr?tor by m?l vy?kat, a? se v?ichni u?ivatel?
+	odpoj?, ne? vypne server. Plantlore Server neimplementuje ??dn? zp?sob 
+	upozor?ov?n? klient?, m?-li b?t server vypnut.
+	</p>
+
+	<p>
+	<img src="picture/ServerManager.png" alt="Administrace serveru.">
+	</p>
+
+	<p>
+	Po p?ipojen?/vytvo?en? k serveru je k dispozici seznam aktu?ln? p?ipojen?ch u?ivatel?.
+	D?le je mo?n? prov?st n?sleduj?c? operace:
+	<ul>
+		<li><b>Obnovit</b>.
+		Aktualizuje seznam s u?ivateli p?ihl??en?mi k tomuto serveru.
+		</li>
+		<li><b>Vyhodit</b>.
+		Odpoj? ozna?en?ho klienta od serveru (tzv. kick).
+		Odpojen? je n?siln? a p?eru?? v?echny operace, kter? klient prov?d?.
+		Neslou?? k zabr?n?n? op?tovn?ho p?ipojen? k serveru, proto?e blokov?n? IP
+		adresy m??e odstavit i jin? klienty. 
+		<br/>
+		V?znam spo??v? v tom, ?e poskytuje prost?edek, jak odpojit neuk?zn?n?
+		klienty, kte?? d?ky sv? nedbalosti pou??vaj? v?ce p?ipojen?, ne? je t?eba,
+		a mohou t?m blokovat jin? u?ivatele, kte?? maj? navenek stejnou IP adresu.
+		<br/>
+		Pokud chcete klientovi zabr?nit v op?tovn?m p?ipojen?, zaka?te jeho u?ivatelsk?
+		??et ve <a href="./import.html">Spr?v? u?ivatel?</a>.
+		</li>
+		<li><b>Zastavit</b>.
+		Ukon?? ?innost serveru, v?ichni u?ivatel? p?ihl??en? k tomuto serveru budou odpojeni
+		bez ohledu na to, zda maj? spu?t?ny n?jak? operace.
+		</li>
+		<li><b>Skr?t</b>.
+		Skryje okno, ale server nech? spu?t?n?. Pro pozd?j?? administraci se k Serveru mus?te
+		znovu p?ihl?sit, jak je pops?no v ??sti 2.
+		</li>
+	</ul>
+	</p>  
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/default/html/settings.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/settings.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/settings.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,29 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Settings</title>
-</head>
-<body>
-<h1>Settings</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Nastaven?</title>
+  </head>
+  <body>
+  <h1>Nastaven?</h1>
+<p>Chov?n? Plantlore je mo?n? do jist? m?ry ovlivnit nastaven?m. Mo?nosti nastaven? se vyvol?vaj? z menu
+Soubor. </p>
+
+<p>Dialog Nastaven? obsahuje ?ty?i z?lo?ky. Z toho pouze nastaven? jazyku se projev? a? po restartu
+aplikace. Ostatn? zm?ny se projev? hned po potvrzen? kliknut?m na Ok.</p>
+<br>
+<img src="picture/settings_languages.png" alt="V?b?r jazyku aplikace">
+<br>
+<p>V z?lo?ce Sloupky je mo?n? si vybrat sloupky a po?ad?, ve kter?m se maj? zobrazovat v p?ehledu n?lez?. 
+Nastaven? se projev? ihned po potvrzen? kliknt?m na Ok.</p>
+
+<img src="picture/settings_columns.png">
+
+<p>Plantlore dovoluje jednoduchou ?pravu nadpis?, kter? se generuj? ve sched?. Slou?? k tomu
+z?lo?ka Scheda.</p>
+
+<img src="picture/settings_scheda.png">
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/default/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/table_import.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/table_import.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -3,9 +3,292 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Import</title>
+    <title>Updating the tables</title>
   </head>
   <body>
-  <h1>Table import</h1>
+  <h1>Updating the tables</h1>
+
+
+
+  	<p>
+	Only an Administrator can update the content of the following tables:
+	Plants, Metadata, Phytochoria, Territories and Nearest bigger seats.
+	</p>
+
+	<p>
+	These tables contain data, that must be kept in tact and in the same version
+	in all databases. Therefore only a responsible person can perform an
+	update of these tables. It is not possible to import 
+	the Occurrence data containing invalid values in the tables mentioned above,
+	in order to secure the quality of the Occurrence data.
+	For instance, it is not possible to <a href="./import.html">Import</a> 
+	an Occurrence refering to a plant that does not exist in the list of available
+	plants.
+	</p>
+
+	<p>
+	The Plantlore Application is supplied with a list of plants, 
+	phytochoria, territories and nearest bigger seats of the Czech republic.
+	However, records in those tables may cease to exist or come into existence.
+	In order to keep those tables up-to-date, you can use the table update.
+	</p>
+
+
+
+	<h2>Contents</h2>
+
+	<p>
+	<ol>
+		<li>The table update</li>
+		<li>The format of the file in detail</li>
+		<li>Examples of the difference files</li>
+		<li>Restrictions and limits</li>
+	</ol>
+	</p>
+
+
+	<h2>1. The table update</h2>
+
+	<p>
+	The operation starts with selection of the file that contains the data
+	with udpates.
+	</p>
+
+	<p>
+	After selecting the file the update of the table starts.
+	You can monitor the progress of the update in a small window
+	and cancel it by pressing the "Cancel" button.
+
+	If you cancel the update, the changes that were already made 
+	will remain in the database.
+
+	Repeated update does not have any effect.
+	</p>
+
+
+
+
+	<h2>2. The format of the file in detail</h2>
+
+	<p>
+	The format of the file allows you to insert new records, remove old records and 
+	update the current records. The format is based on XML and the tree contains three
+	branches - ADD, DELETE, and UPDATE.
+	The root of the tree determines the table that will be updated.
+	</p>
+
+
+	<p>
+	<table>
+		<tr>
+			<th>Root tag</th><th>Table</th>
+		</tr>
+		<tr>
+ 			<td>plants</td><td>plants</td>
+		</tr>
+		<tr>
+			<td>villages</td><td>nearest bigger seats</td>
+		</tr>
+		<tr>
+			<td>phytochoria</td><td>phytochoria</td>
+		</tr>
+		<tr>
+			<td>territories</td><td>territories</td>
+		</tr>
+		<tr>
+			<td>metadata</td><td>metadata</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	An example of the tree to make changes to the table of Plants:
+	</p>
+
+
+	<p>
+	<pre>
+	&lt;plants&gt;
+
+	  &lt;<b>add</b>&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/add</b>&gt;
+
+	  &lt;<b>delete</b>&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/delete</b>&gt;
+
+	  &lt;<b>update</b>&gt;	  
+		&lt;plant&gt;&lt;/plant&gt;
+		&lt;plant&gt;&lt;/plant&gt;
+		...
+	  &lt;<b>/update</b>&gt;
+
+	&lt;/plants&gt;
+	</pre>
+	</p>
+	
+		  
+
+	<p>
+	</p>
+
+
+	<h3>2.1. Inserting a new record - ADD</h3>
+
+	<p>
+	In the ADD branch there are records that should be inserted into the table.
+	If the record is already in the table it is not inserted again to prevent the
+	table from being polluted with duplicities.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;add&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/add&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.2. Deleting an existing record - DELETE </h3>
+
+	<p>
+	The DELETE branch contains records that are meant to be removed from the table.
+	However, if the record, that should be deleted, is refered to by another record
+	in the database, it cannot be deleted in order to preserve the reference integrity.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;delete&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;ACIARVACoacg&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/delete&gt;
+	</pre>
+	</p>
+
+
+
+	<h3>2.3. Updating an existing record - UPDATE </h3>
+
+	<p>
+	In the UPDATE branch there are pairs of records: the <i>original</i> and its <i>replacement</i>. 
+
+	If the <i>original</i> is already in the table, and the <i>replacement</i> is not, 
+	the <i>original</i> is modified so that it becomes the <i>replacement</i>.
+
+	If the <i>original</i> is not in the table, 
+	the <i>replacement</i> is inserted as if it were in the ADD branch.
+
+	If the <i>replacement</i> is alrady in the table,
+	the <i>original</i> is deleted as if it were in the DELETE branch.
+	</p>
+
+	<p>
+	<pre>
+	  &lt;update&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>Aoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+		&lt;plant&gt;
+		  &lt;taxon&gt;Acinos arvensis subsp. villosus (Pers.) Soj?k&lt;/taxon&gt;
+		  &lt;genus&gt;Acinos&lt;/genus&gt;
+		  &lt;species&gt;Acinos arvensis subsp. villosus&lt;/species&gt;
+		  &lt;scientificnameauthor&gt;(Pers.) Soj?k&lt;/scientificnameauthor&gt;
+		  &lt;czechname&gt;pam?tn?k roln? chlupat?&lt;/czechname&gt;
+		  &lt;synonyms&gt;Acinos eglandulosus Klokov&lt;/synonyms&gt;
+		  &lt;note&gt;Vydal: JNTR, Soubor: cevt_r_sp2.dbf&lt;/note&gt;
+		  &lt;surveytaxid&gt;<font color=RED>ACIARVACoacg</font>&lt;/surveytaxid&gt;
+		&lt;/plant&gt;
+	  &lt;/update&gt;
+	</pre>
+	</p>
+
+
+
+	<h2>3. Examples of the difference files</h2>
+
+	<p>
+	Adding a new nearest bigger seat.
+	<pre>
+	&lt;villages&gt;
+	  &lt;add&gt;
+	    &lt;nearestvillage&gt;
+	      &lt;name&gt;Newcastle&lt;/name&gt;
+	    &lt;/nearestvillage&gt;
+	  &lt;add&gt;
+	&lt;villages&gt;
+	</pre>
+	</p>
+
+	<p>
+	Adding a new territory.
+	<pre>
+	&lt;territories&gt;
+	  &lt;add&gt;
+	    &lt;territory&gt;
+	      &lt;name&gt;Nieder?sterreich&lt;/name&gt;
+	    &lt;/territory&gt;
+	   &lt;/add&gt;
+	  &lt;/add&gt;
+	&lt;territories&gt;
+	</pre>
+	</p>
+
+
+	<p>
+	Adding a new phytochorion.
+	<pre>
+	&lt;phytochoria&gt;
+	  &lt;add&gt;
+	    &lt;phytochorion&gt;
+	      &lt;code&gt;25b&lt;/code&gt;
+	      &lt;name&gt;Liboucheck? plo?ina&lt;/name&gt;
+	    &lt;/phytochorion&gt;
+	   &lt;/add&gt;
+	&lt;/phytochoria&gt;
+	</pre>
+	</p>
+
+
+
+	<h2>4. Restrictions and limits</h2>
+
+	<p>
+	The table update is primarily designed for small changes and for work with small files
+	containg several hundreds or thousands records. Bigger files may not be processed due
+	to memory issues.
+	</p>  
+
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/default/html/user.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/user.html	2006-09-18 15:56:03 UTC (rev 822)
+++ trunk/src/net/sf/plantlore/help/default/html/user.html	2006-09-18 15:57:55 UTC (rev 823)
@@ -1,9 +1,121 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>User manager</title>
-</head>
-<body>
-<h1>User manager</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>User Management</title>
+  </head>
+  <body>
+  <h1>User Management</h1>
+<img src="picture/userEnter.png">
+<br><br>
+
+Application Plantlore allows access to and work with the occurrence data only to the users with a user account created in the application. This way, the data are better protected from damage and misuse. The administrator knows who has access to the occurrence data and who performed any edits to the data. The user manager allows the administrator to add and edit users, set user rights, and also terminate their access to the application. You can open the user manager from menu
+	<b>Data/User management</b>.
+
+<h5>User manager dialog</h5>
+
+<img src="picture/userDialog.png">
+<br><br>
+The dialog for user account management is divided into two parts:
+<ul>
+  <li><b>User list </b>? displays the list of users based on criteria entered for searching and sorting
+  <li><b>Search </b>? requirements for searching and sorting of users
+</ul>
+
+<h2>User list</h2>
+
+This part displays the list of users found after a successful search. You can set the number of users displayed in the table 
+yourselves by changing the value for <i><b>Lines displayed</b></i> and confirming the new value by the ENTER key. Use <i><b>Previous </b></i>and <i><b>Next </b></i>buttons 
+to switch over to the previous or next list of users. Information about the currently displayed list of users is stated in the 
+part below the table.<br>
+The following buttons enable the work with a record:
+<ul>    
+   <li><i><b>Add user  </i></b> - <a href=#add>adds a user</a></li>
+   <li><i><b>Edit user </i></b> - <a href=#edit>edits a user</a></li>
+   <li><i><b>User detail </i></b> - <a href=#detail>detailed data and user rights</a></li>
+   <li><i><b>Remove user </i></b> - <a href=#drop>abolishes user access</a></li> 
+</ul>   
+  
+<h2>Search</h2>
+
+User manager offers the administrator the option to search using the following four parameters: login, name, e-mail, 
+and address. The results may be sorted by login, first name, surname, and date of creation of the user; all of 
+that either in an ascending or descending sequence. Another search criterion is the requirement to display all users, 
+or only users with valid access to the application (the value of item <i>Date of user removal </i>is empty for these users). 
+If no parameters and limitations are entered, all users will be found. 
+<br><br>
+<b>Note:</b> the search is case sensitive.
+
+<a name="add"></a><h2>Adding a user</h2>
+  
+  <h5>Add user dialog</h5>
+  
+  <img src="picture/userAdd.png">
+  <br><br>
+  Open the Add user dialog from User manager. The window displayed offers the following items:
+  
+  <h4>User data</h4>
+  <ul>
+    <li><b>Login</b> - user login that will be used for access to the application. This item is obligatory and you will not be able to add a user without filling it in. 
+    The login must be unequivocal in the database and it will not be editable after you save the user.</li>
+    <li><b>Password</b> - Plantlore user password. This item is obligatory.</li>
+    <li><b>Name</b> - first name of the user. This item is obligatory.</li>
+    <li><b>Surname</b> - surname of the user. This item is obligatory.</li>
+    <li><b>E-mail</b> - user?s e-mail address. This item is obligatory. </li>
+    <li><b>Address</b> - user?s address. This item is obligatory.</li>    
+    <li><b>Note</b> - administrator?s note about the user.</li>   
+  </ul>
+  <h4>User rights</h4>  
+  <ul>   
+    <li><b>Administrator right</b> ? by selecting it, the user will be granted same rights as the administrator. You should 
+    carefully consider whom to assign administrator rights. <i><b>Recommendation: </b>in order to provide for higher security, 
+    there should only be one user with administrator rights.</i> </li>
+    <li><b>Right to edit all </b>? by selecting it, the user is granted the right to edit all occurrences in the database.</li>
+    <li><b>Right to add records</b> ? by selecting it, the user is granted the right to add new occurrences.</li>
+    <li><b>Right to edit other users? occurrences</b> ? this item contains the list of users whose occurrences the user will be permitted to edit.
+
+</li>    
+ </ul>
+ 
+<a name="edit"></a><h2>Editing a user</h2>
+<h5>Edit user dialog</h5>
+<img src="picture/userEdit.png">
+<br><br>
+  Open the Edit user dialog from User manager. Don?t forget that you must select a user to open this dialog. The layout of the Edit user dialog is almost identical with the Add user dialog. The obligatory items are: password, name, surname, e-mail.<br> 
+  Non-editable items:: 
+  <ul>
+    <li><b>Login</b></li>
+    <li><b>Date of creation: </b>date and time of user creation. Non-editable item. </li>
+    <li><b>Date of removal:</b> date and time of abolishment of user access to the application. Non-editable item.</li>
+  </ul>
+
+<a name="detail"></a><h2>Detailed user data and rights</h2>
+
+  You can open the dialog displaying detailed information about the user and his rights from User manager. You have to select a user in the list of users to be able to open this dialog. The dialog is almost identical with the Edit user dialog. All items are non-editable, their nature is informative.
+  
+<a name="drop"></a><h2>Removing user from the system</h2>
+
+  In order to abolish the user access to the application, use button <b><i>Remove user </i></b>in the User manager. Before pressing this 
+  button, it is necessary to select a user in the list of users. After the button is pressed, the user will be informed about the 
+  operation about to be performed. By confirming the operation, the current time will be stored in the item <i>Date of user removal</i>. 
+  <br><br>
+  <img src="picture/userDrop.png">
+  <br><br>
+  Renewal of access for a user that has been removed means adding a new user. Login of a new user must be unequivocal in the database (i.e. it is not possible to use a login of user who has or had an account in a given database). This way, the database stores the information about the periods during which a user had access to the application.
+<a name="rights"></a><h2>User rights</h2>
+  
+  The administrator sets rights for work with the occurrence data while adding or editing a user.<br> 
+  
+  <h5>Setting the rights</h5>
+  <img src="picture/userRight.png">
+  <br><br>
+ User can have the following rights:  <ul>
+    <li>Right to browse the data ? this right does not have to be set anywhere as it is granted automatically with the creation of access to the application</li>
+    <li>Right to add data ? this right permits the user to add occurrences, authors, and publications. He is also automatically granted the right to edit the records that he added himself and to browse all the occurrences. Moreover, he has the right to display the history of the occurrence that he added himself.</li>
+    <li>Right to edit other users? data ? a user (Joe) may ask the administrator to add a specific user (Frank) to the list of users whose records he may edit (this right to edit implies the right to access the record history). Whether a user is added into this list depends on the administrator and/or mutual agreement of the users.</li>
+    <li>Administrator right ? a user with administrator right has, of course, the largest collection of rights ? he may edit the occurrences, metadata, publications, authors, plants, and users. He has the access to the <a href="./history.html#historyRecord">history of individual occurrences</a>, but also to the  <a href="./history.html#historyData">whole history</a>.
+    </li>
+  </ul>  
+  </body>
+</html>



From lada at mail.berlios.de  Mon Sep 18 18:03:30 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 18:03:30 +0200
Subject: [Plantlore-dev] r824 - in trunk/src/net/sf/plantlore:
	client/history help/cs/html help/cs/html/picture l10n server
Message-ID: <200609181603.k8IG3Uov010558@sheep.berlios.de>

Author: lada
Date: 2006-09-18 18:03:26 +0200 (Mon, 18 Sep 2006)
New Revision: 824

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/help/cs/html/history.html
   trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistUsage.jpg
   trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingRecords.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_place_cz.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview.png
   trunk/src/net/sf/plantlore/help/cs/html/picture/overview_selecting.png
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
History of record: show changes of authors of occurrence. Add list of possible individual modifications of the occurrence.

HibernateDBLayer: fix bug: saving of history publication. 



Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 16:03:26 UTC (rev 824)
@@ -297,14 +297,15 @@
 
     	//Select data from tHistory table
         try {        	        	
-		query = database.createQuery(HistoryRecord.class);
-		    // Create aliases for table tHistoryChange.      
+		query = database.createQuery(HistoryRecord.class);		        
 	        query.createAlias("historyChange", "hc");  
                 query.createAlias("historyColumn", "hcol");
 	        // Add restriction to COPERATION column of tHistoryChange table
 	        if (data instanceof Occurrence) {	        	       
-		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Occurrence)data).getId(), null);  
-                        query.addRestriction(PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE, null);
+		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Occurrence)data).getId(), null); 
+                        Object[] items = {PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE,
+                        PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_AUTHOROCCURRENCE};
+                        query.addOrRestriction(items);
 	        } else if (data instanceof Habitat) {	        	        
 		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Habitat)data).getId(), null);  
 	        }	

Modified: trunk/src/net/sf/plantlore/help/cs/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/help/cs/html/history.html	2006-09-18 16:03:26 UTC (rev 824)
@@ -59,7 +59,8 @@
 <ul>
   <li><b>Detaily n?lezu</b> - zde jsou zobrazeny aktu?ln? informace o n?lezu (taxon, auto?i n?lezu a lokalita)
   <li><b>Vytvo?en? n?lezu</b> - zde jsou zobrazeny informace o vlo?en? n?lezu do datab?ze (datum/?as vlo?en? a u?ivatel, kter? z?znam vlo?il do datab?ze)
-  <li><b>Seznam zm?n</b> - zde jsou zobrazeny z?kladn? informace o jednotliv?ch zm?n?ch n?lezu 
+  <li><b>Seznam zm?n</b> - zde jsou zobrazeny z?kladn? informace o jednotliv?ch zm?n?ch n?lezu (mezi z?kladn? informace pat??: rok, m?s?c, den a ?as n?lezu,
+  herb??, publikace, n?zev projektu, pozn?mka k z?znamu)
 </ul>
   
 <h3>Seznam zm?n</h3>

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ChecklistUsage.jpg
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/ExportSelectingRecords.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_occurrence_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/addedit_place_cz.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/help/cs/html/picture/overview_selecting.png
===================================================================
(Binary files differ)

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 16:03:26 UTC (rev 824)
@@ -1815,3 +1815,5 @@
 Overview.NoOccurrenceTitle=No occurrence selected
 
 CreateDB.CreatingTables=Creating tables...
+
+AUTHOR.role.revised=Revised

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 16:03:26 UTC (rev 824)
@@ -1962,7 +1962,7 @@
 
 Change=Zm\u011Bna
 
-AUTHOR.role.collect=
+AUTHOR.role.collect=Na\u0161el
 
 Error.HistoryRecordSearchFailed=
 
@@ -2058,7 +2058,7 @@
 
 Error.HistoryProcessResultsFailed=Processing search results failed
 
-Error.HistoryAuthorSearchFailed=Hled\u00E1n\u00ED autor\u016F pro specifikovan\u00FD n\u00E1lez se nezda\u0159ilo
+Error.HistoryAuthorSearchFailed=Dohlled\u00E1n\u00ED autor\u016F pro specifikovan\u00FD n\u00E1lez se nezda\u0159ilo
 
 Information.UserRevokeAdminHimself=Sna\u017E\u00EDte si zru\u0161it administr\u00E1torsk\u00E9 pr\u00E1vo.\nTato operace nen\u00ED povolena.
 
@@ -2181,3 +2181,5 @@
 Overview.NoOccurrenceTitle=Nen\u00ED vybr\u00E1n n\u00E1lez
 
 CreateDB.CreatingTables=Vytv\u00E1\u0159\u00EDm tabulky...
+
+AUTHOR.role.revised=revidoval

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 16:03:26 UTC (rev 824)
@@ -1670,3 +1670,5 @@
 Overview.NoOccurrenceTitle=No occurrence selected
 
 CreateDB.CreatingTables=Creating tables...
+
+AUTHOR.role.revised=Revised

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 15:57:55 UTC (rev 823)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 16:03:26 UTC (rev 824)
@@ -1683,7 +1683,8 @@
                     			 historyRecord.setOldValue(((Plant)origValue).getTaxon());
                          		 historyRecord.setNewValue(((Plant)newValue).getTaxon());
                     		 } else if (((String)columnName).equals(Occurrence.PUBLICATION)) {
-                    			 historyRecord.setOldRecordId(((Publication)origRec.getValue(columnName)).getId());
+                                         if ((Publication)origRec.getValue(columnName) == null) historyRecord.setOldRecordId(0);
+                                         else historyRecord.setOldRecordId(((Publication)origRec.getValue(columnName)).getId());
                                          String referenceCitation = (origValue == null) ? "" : ((Publication)origValue).getReferenceCitation();
                     			 historyRecord.setOldValue(referenceCitation);
                          		 historyRecord.setNewValue(((Publication)newValue).getReferenceCitation());



From lada at mail.berlios.de  Mon Sep 18 21:13:21 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 21:13:21 +0200
Subject: [Plantlore-dev] r825 - in trunk/src/net/sf/plantlore/help:
	default/html en/html
Message-ID: <200609181913.k8IJDLH1031165@sheep.berlios.de>

Author: lada
Date: 2006-09-18 21:13:20 +0200 (Mon, 18 Sep 2006)
New Revision: 825

Modified:
   trunk/src/net/sf/plantlore/help/default/html/history.html
   trunk/src/net/sf/plantlore/help/en/html/history.html
Log:
History record: Add information about item, which history is showed in history dialog.

Modified: trunk/src/net/sf/plantlore/help/default/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 16:03:26 UTC (rev 824)
+++ trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 19:13:20 UTC (rev 825)
@@ -35,7 +35,7 @@
 <br><br>
 <a name="historyRecord"><h2>Occurrence history</h2></a>
 
-<img src="picture/historyEnter.png" alt="History occurence - enter">
+<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
 
 <p><br>
 To access the history of a selected occurrence just select this occurrence and click on the <i><b>History</b></i> button. If the <i><b>History</b></i> button is inactive,
@@ -56,14 +56,15 @@
 
 <h5>Occurrence history dialog</h5>
 
-<img src="picture/historyOcc.png">
+<img src="picture/historyOcc_cs.png">
 <br><br>
 
 The occurrence history dialog is divided into three parts.
 <ul>
-  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)
-  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)
-  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence
+  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)</li>
+  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)</li>
+  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence (basic information: year, month, day and time collected of occurrence,
+  herbar, publication, name of project, note of occurrence)</li>
 </ul>
   
 <h3>List of modifications</h3>
@@ -108,7 +109,7 @@
 be deleted from the history.
 
 <br><br>
-<img src="picture/historyUndo.png">
+<img src="picture/historyUndo_cs.png">
 <br><br>
 
 <h3><i>Logic of modification selection</i></h3>
@@ -116,7 +117,7 @@
 Items in the record might be modified more than once. Thus, it is necessary to provide for several possible situations while selecting changes in the history dialog.<br>
 Here's an illustrative example:<br><br> 
 
-<img src="picture/historyOccMark.png">
+<img src="picture/historyOccMark_cs.png">
 <br><br>
 
 <i>
@@ -142,7 +143,7 @@
 <a name="historyData"><h2>Whole history</h2></a> 
 
 <br>
-<img src="picture/wholeHistoryEnter.png">
+<img src="picture/wholeHistoryEnter_cs.png">
 <br><br>
 
 Dialog of the whole history of modifications is only accessible to the user with administrator rights. If you have administrator rights, you may open
@@ -150,7 +151,7 @@
 
 <h5>Whole history dialog</h5>
 
-<img src="picture/wholeHistoryDialog.png">
+<img src="picture/wholeHistoryDialog_cs.png">
 <br><br>
 
 This dialog displays a list of all modifications relating to metadata, occurrences, authors, and publications. This list is sorted from the most recent
@@ -166,7 +167,7 @@
 </ul>
 
 
-<img src="picture/wholeHistoryDetail.png">
+<img src="picture/wholeHistoryDetail_cs.png">
 <br><br>
 
 If you want to find out more detailed information about an occurrence, metadata, author, or publication, please select the

Modified: trunk/src/net/sf/plantlore/help/en/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-18 16:03:26 UTC (rev 824)
+++ trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-18 19:13:20 UTC (rev 825)
@@ -61,9 +61,10 @@
 
 The occurrence history dialog is divided into three parts.
 <ul>
-  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)
-  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)
-  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence
+  <li><b>Occurrence details</b> - current information about the occurrence (taxon, occurrence authors, and locality)</li>
+  <li><b>Occurrence creation</b> - information about the insertion of the occurrence into the database (date/time of insertion and user who entered the record into the database)</li>
+  <li><b>List of modifications</b> - basic information about individual modifications of the occurrence (basic information: year, month, day and time collected of occurrence,
+  herbar, publication, name of project, note of occurrence)</li>
 </ul>
   
 <h3>List of modifications</h3>



From discontinuum at gmail.com  Mon Sep 18 21:15:41 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Mon, 18 Sep 2006 21:15:41 +0200
Subject: [Plantlore-dev] Instalator - cestina
Message-ID: <f4dc39b90609181215u3e999436t339360f8befcd38c@mail.gmail.com>

Typografie:
P?ed :, ! apod. se ned?l? mezera.


?patn? formulovan? ?et?zce a chyb?j?c? diakritika:

P?e?t?te si n?sleduj?c? informace

Pozorn? si p?e?t?te..

Vyberte bal?ky, kter? budou instalov?ny
Spole?n? soubory, kter? jsou nutn? pro b?h programu - klienta i serveru.

Datab?zov? syst?m ... pod u?ivatelsk?m ??tem ...

...vytvo?it prvn?ho datab?zov?ho u?ivatele, pomoc? kter?ho se poprv?...

Odkazy na syst?m Plantlore  - nahradit n???m jako "Vytvo?it z?stupce na
plo?e a v hlavn?m menu."

Vyberte adres??, do kter?ho....
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060918/368c7e49/attachment.html>

From lada at mail.berlios.de  Mon Sep 18 21:48:47 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 21:48:47 +0200
Subject: [Plantlore-dev] r826 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609181948.k8IJmlrY001113@sheep.berlios.de>

Author: lada
Date: 2006-09-18 21:48:47 +0200 (Mon, 18 Sep 2006)
New Revision: 826

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Update string about transformation and others.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 19:13:20 UTC (rev 825)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 19:48:47 UTC (rev 826)
@@ -808,9 +808,9 @@
 Question.DeleteMetadata = Selected metadata will be delete.
 Question.DeleteMetadataTitle = Delete metadata
 Question.Undo = Changes in database will be rollback to date 
-Question.UndoTitle = Undo to date
+Question.UndoTitle = Undo
 Question.UndoRecord = List of changes prepaer for rollback.\nAttribute for change --> Value for set \n
-Question.UndoRecordTitle = Undo selected changes
+Question.UndoRecordTitle = Undo
 Question.UndoRecordDetail = Changes influence on other occurrences.
 Question.ClearHistoryMessage = Whole history will be deleted.
 Question.ClearHistoryMessageTitle = Clean history.
@@ -1646,9 +1646,9 @@
 
 AUTHOR.null=Author
 
-Error.HistoryRecordSearchFailed=
+Error.HistoryRecordSearchFailed=Search data failed
 
-Error.HistoryDataSearchFailed=
+Error.HistoryDataSearchFailed=Search data failed
 
 Error.HistoryObjectSearchFailed=Search data failed
 
@@ -1817,3 +1817,29 @@
 CreateDB.CreatingTables=Creating tables...
 
 AUTHOR.role.revised=Revised
+
+AUTHOR.role.collected=Collector
+
+addPublicationJournalNameLbl=Journal name\:
+
+Server.Timeout=Timeout
+
+errorAlreadyBoundExceptionTitle=Server collision\!
+
+addPublicationReferenceCitationLbl=Reference citation\:
+
+addPublicationTitle=Add publication
+
+addPublicationUrlLbl=URL\:
+
+searchPublicationsLbl=Search publications
+
+searchPublicationsBtn=Search publications
+
+addPublicationBtn=Add publication
+
+addPublicationCollectionYearPublicationLbl=Year of publication\:
+
+addPublicationNoteLbl=Note\:
+
+addPublicationCollectionNameLbl=Collection name\:

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 19:13:20 UTC (rev 825)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 19:48:47 UTC (rev 826)
@@ -373,7 +373,7 @@
 
 collectionNameTitle=N\u00E1zev kolekce
 
-addPublicationTitle=Add publication
+addPublicationTitle=P\u0159id\u00E1n\u00ED publikace
 
 publicationManager=Spr\u00E1va publikac\u00ED
 
@@ -385,15 +385,15 @@
 
 publicationList=Seznam publikac\u00ED
 
-addPublicationBtn=Add publication
+addPublicationBtn=P\u0159id\u00E1n\u00ED publikace
 
 editPublicationBtn=Edit publication
 
 deletePublicationBtn=Delete publication
 
-searchPublicationsLbl=Search publications
+searchPublicationsLbl=Hled\u00E1n\u00ED publikac\u00ED
 
-searchPublicationsBtn=Search publications
+searchPublicationsBtn=Hled\u00E1n\u00ED publikac\u00ED
 
 publicationSearchFailed=Vyhled\u00E1v\u00E1n\u00ED publikac\u00ED selhalo
 
@@ -405,7 +405,7 @@
 
 publicationProcessResultsFailed=Spracov\u00E1n\u00ED v\u00FDsledk\u016F hled\u00E1n\u00ED selhalo
 
-addPublicationNoteLbl=Note\:
+addPublicationNoteLbl=Pozn\u00E1mka\:
 
 addPublicationUrlLbl=URL\:
 
@@ -413,9 +413,9 @@
 
 addPublicationReferenceCitationLbl=Reference citation\:
 
-addPublicationJournalNameLbl=Journal name\:
+addPublicationJournalNameLbl=Jm\u00E9no \u010Dasopisu\:
 
-addPublicationCollectionYearPublicationLbl=Year of publication\:
+addPublicationCollectionYearPublicationLbl=Rok publikov\u00E1n\u00ED\:
 
 addPublicationCollectionNameLbl=Collection name\:
 
@@ -1480,11 +1480,11 @@
 
 Overview.TransformationInfo=Sna\u017E\u00EDte se transformovat do sou\u0159adnicov\u00E9ho syst\u00E9mu, \nkter\u00FD m\u00E1te aktu\u00E1ln\u011B nastaven\u00FD.
 
-Overview.Transformation.Panel=Prevod mezi souradnicovymi systemy\n
+Overview.Transformation.Panel=P\u0159evod mezi sou\u0159adnicov\u00FDmi syst\u00E9my\n
 
-Overview.Transformation.ActualSystem=Aktualne je nastaven  souradnicovy system\:\n
+Overview.Transformation.ActualSystem=Aktu\u00E1ln\u011B je nastaven  sou\u0159adnicov\u00FD syst\u00E9m\:\n
 
-Overview.Transformation.SelectedSystem=Prevod do souradnicoveho systemu\:
+Overview.Transformation.SelectedSystem=P\u0159evod do sou\u0159adnicov\u00E9ho syst\u00E9mu\:
 
 Overview.Transformation.Help=Pomoc
 
@@ -1772,7 +1772,7 @@
 
 CreateDB.Create=Vytvo\u0159it
 
-CreateDB.LeaveEmptyTT=Nenaplni datab\u00E1zi po\u010D\u00E1te\u010Dn\u00EDmi daty (rostlinami, vesnicemi, fytochoriony, ..)
+CreateDB.LeaveEmptyTT=Nenapln\u00ED datab\u00E1zi po\u010D\u00E1te\u010Dn\u00EDmi daty (rostlinami, vesnicemi, fytochoriony, ..)
 
 CreateDB.Title=Vytvo\u0159 novou datab\u00E1zi
 
@@ -1964,9 +1964,9 @@
 
 AUTHOR.role.collect=Na\u0161el
 
-Error.HistoryRecordSearchFailed=
+Error.HistoryRecordSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
 
-Error.HistoryDataSearchFailed=
+Error.HistoryDataSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
 
 Error.HistoryObjectSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
 
@@ -2183,3 +2183,5 @@
 CreateDB.CreatingTables=Vytv\u00E1\u0159\u00EDm tabulky...
 
 AUTHOR.role.revised=revidoval
+
+AUTHOR.role.collected=Na\u0161el

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 19:13:20 UTC (rev 825)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 19:48:47 UTC (rev 826)
@@ -481,7 +481,7 @@
 
 AddEdit.TimeLabel=Time\: 
 
-AddEdit.BasicData=
+AddEdit.BasicData=Basic data
 
 AddEdit.ExtendedData=Extended data\: 
 
@@ -937,7 +937,7 @@
 
 AddEdit.Settings=Settings
 
-AddEdit.SettingsTT=
+AddEdit.SettingsTT=Opens dialog for disabling and enabling fields
 
 AddEdit.Settings.Disabled=Disabled
 
@@ -1493,9 +1493,9 @@
 
 Author.note=Note
 
-Error.HistoryRecordSearchFailed=
+Error.HistoryRecordSearchFailed=Search data failed
 
-Error.HistoryDataSearchFailed=
+Error.HistoryDataSearchFailed=Search data failed
 
 Error.HistoryObjectSearchFailed=Search data failed
 
@@ -1672,3 +1672,497 @@
 CreateDB.CreatingTables=Creating tables...
 
 AUTHOR.role.revised=Revised
+
+AUTHOR.role.collected=Collector
+
+Server.Timeout=Timeout
+
+CreateDB.Title=Create a new database
+
+CreateDB.LeaveEmptyTT=May be handy for someone who doesn't wish to polute the database \nwith the names of Czech villages, territories, etc.
+
+CreateDB.Create=Create
+
+CreateDB.LeaveEmpty=Leave the database empty (do not add plants, villages, etc.)
+
+CreateDB.NewDatabaseOptions=Options
+
+CreateDB.DatabaseSettings=Database engine settings
+
+DBLayer.Error.Other=Unable to comply.
+
+DBLayer.Error.MaxConnections=Maximum number of users reached.
+
+DBLayer.Error.OutOfMemory=Out of memory.
+
+DBLayer.Error.DiskFull=The disk is full.
+
+DBLayer.Error.Resources=Out of resources\!
+
+DBLayer.Error.Transaction=Another transaction is already running.
+
+DBLayer.Error.DB=The datbase is not in a consistent state.
+
+DBLayer.Error.Rights=Insufficient access rights.
+
+DBLayer.Error.Close=Unable to close the connection.
+
+DBLayer.Error.LoadData=Unable to obtain the data.
+
+DBLayer.Error.Select=Unable to perform the selection.
+
+DBLayer.Error.Update=Ubable to update the record in the database.
+
+DBLayer.Error.Delete=Unable to delete the record from the database.
+
+DBLayer.Error.Save=Unable to store data into the database.
+
+DBLayer.Error.Password=The password is incorrect.
+
+DBLayer.Error.Username=The username is not accepted.
+
+DBLayer.Error.Login=Authentication failed.\nIncorrect user name or password.
+
+DBLayer.Error.Connect=Unable to connect to the database engine.\nIs it running?
+
+DBLayer.Error.LoadConfig=Unable to load the database configuration file. 
+
+DBLayer.Error.Unspecified=There is no additional information regarding to the problem.
+
+=Creates a new database.
+
+Server.Info.Terminated=Server stopped.
+
+Server.Info.TerminatingServer=Stopping the server...
+
+Server.Info.ClientKicked=The client {0} was kicked.
+
+Server.Info.KickingClient=Disconnecting the client...
+
+Server.Info.ClientsObtained=The list of clients refreshed.
+
+Server.Info.ObtainingClients=Retrieving the list of users...
+
+Server.Info.ConnectingToServer=Connecting to the server...
+
+Server.Info.ServerUpAndRunning=Server is up and running.
+
+Server.Info.StartingNewServer=Starting the server...
+
+Server.Info.CreatingNewServer=Creating a new server...
+
+Server.SettingsNotSaved=Settings not saved.
+
+Server.SettingsSaved=Settings saved.
+
+Server.SettingsNotLoaded=Settings not loaded. 
+
+Server.SettingsLoaded=Settings loaded.
+
+Server.ConnectToRunningServer=Connect to a running Server
+
+Server.CreateNewServer=Create a new Server
+
+Server.ListOfUsersTT=The list of currently connected users.
+
+Server.TerminateTT=Terminate the Plantlore server and disconnect all its clients.
+
+Server.Terminate=Stop
+
+Server.KickUserTT=Disconnect the selected user from the server.
+
+Server.KickUser=Kick user
+
+Server.RefreshTT=Reload the list of currently conntected users.
+
+Server.Refresh=Refresh
+
+Server.HideTT=Abandon the Plantlore server (will not terminate the server).
+
+Server.Hide=Hide
+
+Server.DatabasePortTT=The port where the database engine listens.
+
+Server.DatabasePort=Port
+
+Server.DatabaseTypeTT=The database engine that contains the data.
+
+Server.DatabaseType=Database
+
+Server.DatabaseParameterTT=Some additional parameters the Plantlore server should use \nwhen connecting to the database, such as encoding.
+
+Server.DatabaseParameter=Parameter
+
+Server.DatabasePasswordTT=The password of the power-user account. \nThe Plantlore server will use this password \nto gain access to the database engine.
+
+Server.DatabasePassword=Password
+
+Server.DatabaseUserTT=The power user of the database. \nThe Plantlore server will use this login \nto gain access to the database engine.
+
+Server.DatabaseUser=User
+
+Server.DatabaseSettings=Database settings
+
+Server.ConnectToSettings=Remote host settings
+
+Server.PortTT=The port where the Plantlore server should listen.
+
+Server.Port=Port
+
+Server.PasswordTT=The password that will protect the server from being manipulated by unauthorized persons.
+
+Server.Password=Password
+
+Server.ServerSettings=Server settings
+
+Server.Manage=Connections
+
+Server.ContinueTT=Proceed to the Server Manager.
+
+Server.HostTT=The name or IP address where the Server runs.
+
+Server.Host=Host
+
+Question.ClearHistoryMessageTitle=Clean history.
+
+Question.ClearHistoryMessage=Whole history will be deleted.
+
+Question.UndoRecordDetail=Changes influence on other occurrences.
+
+Question.UndoRecordTitle=Undo
+
+Question.UndoRecord=List of changes prepaer for rollback.\nAttribute for change --> Value for set \n
+
+Question.UndoTitle=Undo
+
+Question.Undo=Changes in database will be rollback to date 
+
+Question.DeleteUser=Access for user selected will be prohibit.
+
+Question.NewerRecord=The record in the database is newer than the record in the file.
+
+Question.SharedRecord=A {0} is shared. Updating it may affect other records.
+
+Question.AbortImport=Import will be aborted.
+
+Question.AbortExport=Export will be aborted.
+
+Error.PartialyCorruptedRecord=The record is partially corrupted.
+
+Error.MissingUpdateRecord=Records in the UPDATE branch must come in pairs.
+
+Error.OutOfMemory=Not enough memory to perform the operation.
+
+Error.EmptyXMLFile=There are no records in the file.
+
+Error.UnsupportedTable=You cannot import data to the table {0}.\nIt is not an immutable table.
+
+DBLayer.Error.CreateDB=Creation of new database was not successful. Please make sure that database system is properly installed and that the database doesn't exist yet.
+
+Error.Server.NotBound=There is no Server on the specified port.
+
+Error.Server.AlreadyBound=Another Server is already running on the specified port.
+
+Error.Server.UnmarshallingFailed=Unable to receive the data.\nDo you have the correct version?
+
+Error.Server.UnknownHost=Unknown host or IP address.
+
+Error.Server.UnexpectedProblem=An unexpected problem on the server.
+
+Error.Server.StubNotFound=Some parts of the program are missing.
+
+Error.Server.InTrouble=The Server has crashed.
+
+Error.Server.ObjectDoesNotExistAnymore=You have been disconnected from the server\nby its Administrator.
+
+Error.Server.MarshallingFailed=Unable to send the data.\nDo you have the correct version?
+
+Error.Server.ExportFailed=Unable to register an object within the RMI.
+
+Error.Server.ConnectionRefused=Connection refused. Is the Server running?
+
+Error.Server.AccessDenied=Access denied - insufficient permissions.
+
+Error.ConnectionFailed=The connetion failed
+
+Error.DatabaseOperationFailed=Unable to perform the database operation.
+
+Error.SloppyProgramming=The programmer made a mistake here.\nThis should not have happened.
+
+Error.DeletingSharedRecord=Unable to delete a shared record.
+
+Error.AmbiguousUniqueIdentifier=There are two or more records with the same unique identifier.\nIt is not sure which one should be processed.
+
+Error.RecordNotFound=The record is not in the table {0}.
+
+Error.TransactionRaceConditions=The operation cannot be performed.\nAnother operation is already in progress.
+
+Error.AmbiguousRecord=There are two or more identical records.\nIt is not sure which one should be processed.
+
+Error.ConnectionLost=Connection lost
+
+Error.TooManyConnections=Too many clients are already connected.
+
+Error.WrongAuthorizationKey=Incorrect authorization key.
+
+Error.GenericMessageTitle=Error
+
+Error.UnableToProcess=The record No. {0} cannot be processed; 
+
+Error.DuplicateLoginTitle=Incorrect data
+
+Error.DuplicateLogin=Login already exist. Please change it.
+
+Error.CorruptedFileFormat=The format of the file is corrupted.
+
+Error.CorruptedRecord=The record is incomplete.\nSome parts are missing.
+
+Error.ThreadFailed=Unable to create a new thread\!
+
+Error.FileFormatCorrupted=The format of the file is corrupted.
+
+Error.ReaderNotCreated=Unable to create the file reader.
+
+Error.FKIsNull=Some foreign keys are null.\nThe record is incomplete.
+
+Error.LoginFailed=Login failed.
+
+Error.ImportFailed=Import failed.
+
+Error.ExportFailed=Export ended prematurely. 
+
+Error.NoColumnsSelected=No columns are selected.
+
+Error.NothingSelected=Nothing is selected.
+
+Error.WriterNotCreated=Unable to create the output file writer.
+
+Error.MissingSeveralCompulsoryFields=Some compulsory fields are not filled.
+
+Error.MissingCompulsoryField=is a compulsory field. Please fill in it.
+
+Error.MissingCompulsoryFieldTitle=Missing compulsory field
+
+Error.MissingUserName=You forget to enter the account name.
+
+Error.MissingFileName=The file name was not specified.
+
+Error.Missing=Missing information.
+
+Error.NoAuthorsLeft=Every occurrence data must have at least one author.\nThis one would have no authors left.
+
+Error.ImproperUse=Internal error\: The method is not used properly.
+
+Error.UnhandledExceptionalState=The Application performed an illegal operation\nand it will be terminated.
+
+Error.InvalidFileName=The supplied name of the file is not valid.
+
+Error.InvalidRecord=The record is not valid\!
+
+Error.InvalidRootTable=The supplied root table is not valid\!\n If you want to use projections,\n you must specify the root table.
+
+Error.InvalidUser=The supplied user is not valid\!
+
+Error.InvalidParser=The supplied parser is not valid\!
+
+Error.InvalidChecklist=The checklist is not valid.
+
+Error.InvalidFilter=The supplied file format is not valid\!
+
+Error.InvalidQuery=The supplied select query is not valid\!
+
+Error.InvalidSelection=The supplied list of selected items is not valid\!
+
+Error.InvalidResultset=The supplied result set identifier is not valid\!
+
+Error.InvalidBuilder=The supplied Builder is not valid\!
+
+Error.InvalidDBLayer=The database layer is not valid\! 
+
+Error.Fatal=A serious error occurred.
+
+Error.Internal=An internal error of the Application.
+
+Error.General=An error occurred.
+
+Information.NoMetadataInResultTitle=No search results
+
+Record.Value=Value
+
+Record.Property=Property
+
+Territory=Territory
+
+Phytochorion.code=Code
+
+Phytochorion.name=Name
+
+Phytochorion=Phytochorion
+
+Author.deleted=Deleted
+
+Author.email=E-mail
+
+Author.address=Address
+
+Author=Author
+
+ExtendedTree.Plantlore=Plantlore
+
+Format.StdOut=Standard Output
+
+Format.DC=DarwinCore (*.xml)
+
+Format.ABCD=ABCD Schema (*.xml)
+
+Format.CSV=Comma separated values (*.txt, *.csv)
+
+Format.XML=XML (*.xml)
+
+Format.PlantloreNative=Plantlore Native (*.xml)
+
+Export.Progress=records exported
+
+Export.RecordsExported=records exported.
+
+Export.SelectColumns=Select Columns
+
+Export.Abort=Abort
+
+Export.Failed=Export failed
+
+Export.Completed=Completed\!
+
+Export.Aborted=Aborted by User.
+
+Export.Initializing=Initializing export. This may take a while.
+
+Export.TitleTT=Export the selected records.
+
+Export.Title=Export
+
+Import.UpdatingEnvironment=Updating environment...
+
+Import.RecordsProcessed={0} processed ({1} rejected)
+
+Import.RecordsImported={0} records processed.
+
+Import.UnknownReason=The reason is uknown.
+
+Import.UnableToProcess=The record No. {0} cannot be processed.
+
+Import.IncompleteRecord=The record No. {0} is incomplete - some parts are missing.
+
+Import.CompletelyCorruptedRecord=The record No. {0} is corrupted (cannot be parsed).
+
+Import.CanceledByUser=Canceled by the User.
+
+Import.Completed=Import completed.
+
+Import.Aborted=Import aborted.
+
+Import.Initialized=Initialized.
+
+Import.Initializing=Initializing import...
+
+Import.Failed=Import failed.
+
+Import.Title=Import
+
+Checklist.RestoreTT=Restore the checklist to the original state (with all plants).
+
+Checklist.Restore=Restore
+
+Checklist.ClearTT=Deselect all currently selected records.
+
+Checklist.Clear=Deselect all
+
+Checklist.SaveTT=Create a new checklist from the currently selected plants.
+
+Checklist.Save=Create
+
+Checklist.LoadTT=Load a previously stored checklist (preserve the selection).
+
+Checklist.Load=Load
+
+Checklist.SubmitTT=Set the selected plants.
+
+Checklist.Submit=Submit
+
+Checklist.Title=Checklist
+
+Login.Failed=Login failed\!
+
+Login.DBLayerInitialized=Database connection successful.
+
+Login.InitializingDBLayer=Initializing database connection...
+
+Login.ConnectionFailed=Unable to connect to the database.
+
+Login.Connected=Connection successful.
+
+Login.Connecting=Connecting to the server...
+
+Login.ConnectingTo=Connecting to
+
+Login.AuthorizeTT=Connect to the database with the specified username and password.
+
+Login.Authorize=Login
+
+Login.Password=Password
+
+Login.Authentication=Authentication
+
+Login.ChangeTT=Change this record.
+
+Login.Change=Change
+
+Login.EditTitle=Edit record
+
+Login.AddTT=Add the record.
+
+Login.Add=Add
+
+Login.AddTitle=Add a new record.
+
+Login.DiscardTT=Discard the record.
+
+Login.Discard=Discard
+
+Login.DatabaseTT=The engine that stores the data.
+
+Login.NextTT=Proceed to the next step.
+
+Login.Next=Continue
+
+Login.MasterPasswordTT=The password to the database account.
+
+Login.MasterPassword=Password
+
+Login.MasterUserTT=The database account this connection shall use.
+
+Login.MasterUser=User
+
+Login.ParameterTT=Additional information required for the connection (such as encoding).
+
+Login.Parameter=Parameter
+
+Login.PortTT=The port where the server listens.
+
+Login.Port=Port
+
+Login.DatabasePortTT=The port where the database engine listens.
+
+Login.DatabasePort=DB Port
+
+Login.DatabaseParameterTT=Some additional parameters the Plantlore server should use \nwhen connecting to the database, such as encoding.
+
+Login.DatabaseParameter=Parameter
+
+Login.DatabaseIdentifierTT=The identifier of the database that is stored within the database engine.
+
+Login.DatabaseIdentifier=DB Id.
+
+Login.DatabaseEngineTT=The database engine that contains the data.
+
+Login.DatabaseEngine=Database



From fraktalek at mail.berlios.de  Mon Sep 18 22:23:36 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Mon, 18 Sep 2006 22:23:36 +0200
Subject: [Plantlore-dev] r827 -
	trunk/src/net/sf/plantlore/client/overview/search
Message-ID: <200609182023.k8IKNagB005052@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-18 22:23:35 +0200 (Mon, 18 Sep 2006)
New Revision: 827

Modified:
   trunk/src/net/sf/plantlore/client/overview/search/Search.java
Log:
Get rid of duplicities in overview in case that one author appears in several times in one occurrence.



Modified: trunk/src/net/sf/plantlore/client/overview/search/Search.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-18 19:48:47 UTC (rev 826)
+++ trunk/src/net/sf/plantlore/client/overview/search/Search.java	2006-09-18 20:23:35 UTC (rev 827)
@@ -639,7 +639,7 @@
             // In the subquery select authors for the given occurrence (occurrence comes from the main query)
             subQuery.addRestriction(PlantloreConstants.RESTR_EQ_PROPERTY, "ao."+AuthorOccurrence.OCCURRENCE, "occ."+Occurrence.ID, null, null);
             subQuery.addRestriction(PlantloreConstants.RESTR_EQ, "ao."+AuthorOccurrence.DELETED, null, 0, null);
-            subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY, AuthorOccurrence.AUTHOR);
+            subQuery.addProjection(PlantloreConstants.PROJ_PROPERTY, AuthorOccurrence.ID);
             // create the main query
             sq = database.createQuery(AuthorOccurrence.class);
             sq.createAlias(AuthorOccurrence.AUTHOR,"author");
@@ -653,7 +653,7 @@
             sq.createAlias("habitat."+Habitat.NEARESTVILLAGE,"vill");
             sq.createAlias("habitat."+Habitat.TERRITORY,"territory");
             // Add subquery to the query. Compare authoroccurrence.authorid with the result of a subquery (LEALL: <= all(...))
-            sq.addRestriction(PlantloreConstants.SUBQUERY_LEALL, AuthorOccurrence.AUTHOR, null, subQuery, null);    
+            sq.addRestriction(PlantloreConstants.SUBQUERY_LEALL, AuthorOccurrence.ID, null, subQuery, null);    
             sq.addRestriction(PlantloreConstants.RESTR_EQ, AuthorOccurrence.DELETED, null, 0, null);
             sq.addOrder(PlantloreConstants.DIRECT_DESC, "occ."+Occurrence.YEARCOLLECTED); //setridit podle roku
             sq.addRestriction(PlantloreConstants.RESTR_EQ, "occ."+Occurrence.DELETED, null, 0, null);



From lada at mail.berlios.de  Mon Sep 18 22:26:38 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 22:26:38 +0200
Subject: [Plantlore-dev] r828 - in trunk/src/net/sf/plantlore: help/cs/html
	help/default/html help/en/html l10n
Message-ID: <200609182026.k8IKQcPs005291@sheep.berlios.de>

Author: lada
Date: 2006-09-18 22:26:38 +0200 (Mon, 18 Sep 2006)
New Revision: 828

Removed:
   trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html
   trunk/src/net/sf/plantlore/help/default/html/occurr_history.html
   trunk/src/net/sf/plantlore/help/en/html/occurr_history.html
Modified:
   trunk/src/net/sf/plantlore/help/cs/html/publication.html
   trunk/src/net/sf/plantlore/help/default/html/habitattree.html
   trunk/src/net/sf/plantlore/help/default/html/history.html
   trunk/src/net/sf/plantlore/help/en/html/history.html
   trunk/src/net/sf/plantlore/help/en/html/metadata.html
   trunk/src/net/sf/plantlore/help/en/html/user.html
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
L10n - add some string.

Help - delete not use occurr_history.html. Repair path to picture.

Deleted: trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/cs/html/occurr_history.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -1,11 +0,0 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
-
-<html>
-  <head>
-    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Historie ?prav n?lez?</title>
-  </head>
-  <body>
-  <h1>Historie ?prav n?lez?</h1>
-  </body>
-</html>

Modified: trunk/src/net/sf/plantlore/help/cs/html/publication.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/cs/html/publication.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -56,7 +56,7 @@
 <li><b>URL</b> - URL odkazuj?c? na publikaci. Maxim?ln? d?lka t?to polo?ky je 100 znak?.</li>
 <li><b>Pozn?mka</b> - Jak?koli dal?? informace o publikaci. Maxim?ln? d?lka t?to polo?ky je 4096 znak?.</li>
 </ul>
-<img src="resources/PublicationsAdd.png">
+<img src="picture/PublicationsAdd.png">
 <p>
 Pokud p?id?v?te novou publikaci, vypl?te jednotliv? polo?ky a stiskn?te tla??tko Ulo? publikaci. Alespo? 
 jedna z n?sleduj?c?ch polo?ek mus? b?t vypl?ena: Autor ?l?nku, rok publikace, jm?no ?l?nku, jm?no kolekce.

Modified: trunk/src/net/sf/plantlore/help/default/html/habitattree.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/habitattree.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/default/html/habitattree.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -10,7 +10,7 @@
  <p>Strom lokalit slou?? k rychl?mu hled?n? v n?lezech podle geografick?ho ?len?n?. Je mo?n? ho vyvolat z panelu n?stroj?
  v hlavn?m okn? aplikace.</p>
  <br>
- <img src="picture/habitat_tree_cz.png" alt="Strom lokalit">
+ <img src="picture/habitat_tree.png" alt="Strom lokalit">
  <br>
  
  <p>Prvn? vrstva stromu obsahuje ?zem? (teritoria), ka?d? ?zem? pak obsahuje fytochoriony a kone?n? ka?d?

Modified: trunk/src/net/sf/plantlore/help/default/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/default/html/history.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -35,7 +35,7 @@
 <br><br>
 <a name="historyRecord"><h2>Occurrence history</h2></a>
 
-<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
+<img src="picture/historyEnter.png" alt="History occurence - enter">
 
 <p><br>
 To access the history of a selected occurrence just select this occurrence and click on the <i><b>History</b></i> button. If the <i><b>History</b></i> button is inactive,
@@ -56,7 +56,7 @@
 
 <h5>Occurrence history dialog</h5>
 
-<img src="picture/historyOcc_cs.png">
+<img src="picture/historyOcc.png">
 <br><br>
 
 The occurrence history dialog is divided into three parts.
@@ -109,7 +109,7 @@
 be deleted from the history.
 
 <br><br>
-<img src="picture/historyUndo_cs.png">
+<img src="picture/historyUndo.png">
 <br><br>
 
 <h3><i>Logic of modification selection</i></h3>
@@ -117,7 +117,7 @@
 Items in the record might be modified more than once. Thus, it is necessary to provide for several possible situations while selecting changes in the history dialog.<br>
 Here's an illustrative example:<br><br> 
 
-<img src="picture/historyOccMark_cs.png">
+<img src="picture/historyOccMark.png">
 <br><br>
 
 <i>
@@ -143,7 +143,7 @@
 <a name="historyData"><h2>Whole history</h2></a> 
 
 <br>
-<img src="picture/wholeHistoryEnter_cs.png">
+<img src="picture/wholeHistoryEnter.png">
 <br><br>
 
 Dialog of the whole history of modifications is only accessible to the user with administrator rights. If you have administrator rights, you may open
@@ -151,7 +151,7 @@
 
 <h5>Whole history dialog</h5>
 
-<img src="picture/wholeHistoryDialog_cs.png">
+<img src="picture/wholeHistoryDialog.png">
 <br><br>
 
 This dialog displays a list of all modifications relating to metadata, occurrences, authors, and publications. This list is sorted from the most recent
@@ -167,7 +167,7 @@
 </ul>
 
 
-<img src="picture/wholeHistoryDetail_cs.png">
+<img src="picture/wholeHistoryDetail.png">
 <br><br>
 
 If you want to find out more detailed information about an occurrence, metadata, author, or publication, please select the

Deleted: trunk/src/net/sf/plantlore/help/default/html/occurr_history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/default/html/occurr_history.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/default/html/occurr_history.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -1,10 +0,0 @@
-<html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Occurrence records history</title>
-</head>
-<body>
-<h1>Occurrence records history</h1>
-</body>
-</html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/en/html/history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/en/html/history.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -35,7 +35,7 @@
 <br><br>
 <a name="historyRecord"><h2>Occurrence history</h2></a>
 
-<img src="picture/historyEnter_cs.png" alt="History occurence - enter">
+<img src="picture/historyEnter.png" alt="History occurence - enter">
 
 <p><br>
 To access the history of a selected occurrence just select this occurrence and click on the <i><b>History</b></i> button. If the <i><b>History</b></i> button is inactive,
@@ -56,7 +56,7 @@
 
 <h5>Occurrence history dialog</h5>
 
-<img src="picture/historyOcc_cs.png">
+<img src="picture/historyOcc.png">
 <br><br>
 
 The occurrence history dialog is divided into three parts.
@@ -109,7 +109,7 @@
 be deleted from the history.
 
 <br><br>
-<img src="picture/historyUndo_cs.png">
+<img src="picture/historyUndo.png">
 <br><br>
 
 <h3><i>Logic of modification selection</i></h3>
@@ -117,7 +117,7 @@
 Items in the record might be modified more than once. Thus, it is necessary to provide for several possible situations while selecting changes in the history dialog.<br>
 Here's an illustrative example:<br><br> 
 
-<img src="picture/historyOccMark_cs.png">
+<img src="picture/historyOccMark.png">
 <br><br>
 
 <i>
@@ -143,7 +143,7 @@
 <a name="historyData"><h2>Whole history</h2></a> 
 
 <br>
-<img src="picture/wholeHistoryEnter_cs.png">
+<img src="picture/wholeHistoryEnter.png">
 <br><br>
 
 Dialog of the whole history of modifications is only accessible to the user with administrator rights. If you have administrator rights, you may open
@@ -151,7 +151,7 @@
 
 <h5>Whole history dialog</h5>
 
-<img src="picture/wholeHistoryDialog_cs.png">
+<img src="picture/wholeHistoryDialog.png">
 <br><br>
 
 This dialog displays a list of all modifications relating to metadata, occurrences, authors, and publications. This list is sorted from the most recent
@@ -167,7 +167,7 @@
 </ul>
 
 
-<img src="picture/wholeHistoryDetail_cs.png">
+<img src="picture/wholeHistoryDetail.png">
 <br><br>
 
 If you want to find out more detailed information about an occurrence, metadata, author, or publication, please select the

Modified: trunk/src/net/sf/plantlore/help/en/html/metadata.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/metadata.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/en/html/metadata.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -6,7 +6,7 @@
 </head>
 <body>
 <h1>Metadata management</h1>
-<img src="picture/metadataEnter_cs.png">
+<img src="picture/metadataEnter.png">
 <br><br>
 
 Metadata manager allows the <b><i>administrator </i></b>to add, edit, and delete the metadata of individual projects.
@@ -14,7 +14,7 @@
 
 <h5>Metadata manager dialog</h5>
 
-<img src="picture/metadataDialog_cs.png">
+<img src="picture/metadataDialog.png">
 <br><br>
 The metadata management dialog is divided into two parts:
 <ul>
@@ -54,7 +54,7 @@
   
   <h5>Add metadata dialog</h5>
   
-  <img src="picture/metadataAdd_cs.png">
+  <img src="picture/metadataAdd.png">
   <br><br>
 Open the Add metadata dialog from Metadata manager. The window displayed offers the following items:
 
@@ -110,7 +110,7 @@
   operation about to be performed. By confirming the operation, the metadata will be deleted. 
 
   <br><br>
-  <img src="picture/metadataDelete_cs.png">
+  <img src="picture/metadataDelete.png">
   <br><br>
   The administrator may recover the deleted metadata by means of the <a href="./history.html#historyData">whole history</a> dialog.
   </body>

Deleted: trunk/src/net/sf/plantlore/help/en/html/occurr_history.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/occurr_history.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/en/html/occurr_history.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -1,10 +0,0 @@
-<html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Occurrence records history</title>
-</head>
-<body>
-<h1>Occurrence records history</h1>
-</body>
-</html>
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/help/en/html/user.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/user.html	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/help/en/html/user.html	2006-09-18 20:26:38 UTC (rev 828)
@@ -7,7 +7,7 @@
   </head>
   <body>
   <h1>User Management</h1>
-<img src="picture/userEnter_cs.png">
+<img src="picture/userEnter.png">
 <br><br>
 
 Application Plantlore allows access to and work with the occurrence data only to the users with a user account created in the application. This way, the data are better protected from damage and misuse. The administrator knows who has access to the occurrence data and who performed any edits to the data. The user manager allows the administrator to add and edit users, set user rights, and also terminate their access to the application. You can open the user manager from menu
@@ -15,7 +15,7 @@
 
 <h5>User manager dialog</h5>
 
-<img src="picture/userDialog_cs.png">
+<img src="picture/userDialog.png">
 <br><br>
 The dialog for user account management is divided into two parts:
 <ul>
@@ -51,7 +51,7 @@
   
   <h5>Add user dialog</h5>
   
-  <img src="picture/userAdd_cs.png">
+  <img src="picture/userAdd.png">
   <br><br>
   Open the Add user dialog from User manager. The window displayed offers the following items:
   
@@ -80,7 +80,7 @@
  
 <a name="edit"></a><h2>Editing a user</h2>
 <h5>Edit user dialog</h5>
-<img src="picture/userEdit_cs.png">
+<img src="picture/userEdit.png">
 <br><br>
   Open the Edit user dialog from User manager. Don?t forget that you must select a user to open this dialog. The layout of the Edit user dialog is almost identical with the Add user dialog. The obligatory items are: password, name, surname, e-mail.<br> 
   Non-editable items:: 
@@ -100,7 +100,7 @@
   button, it is necessary to select a user in the list of users. After the button is pressed, the user will be informed about the 
   operation about to be performed. By confirming the operation, the current time will be stored in the item <i>Date of user removal</i>. 
   <br><br>
-  <img src="picture/userDrop_cs.png">
+  <img src="picture/userDrop.png">
   <br><br>
   Renewal of access for a user that has been removed means adding a new user. Login of a new user must be unequivocal in the database (i.e. it is not possible to use a login of user who has or had an account in a given database). This way, the database stores the information about the periods during which a user had access to the application.
 <a name="rights"></a><h2>User rights</h2>
@@ -108,7 +108,7 @@
   The administrator sets rights for work with the occurrence data while adding or editing a user.<br> 
   
   <h5>Setting the rights</h5>
-  <img src="picture/userRight_cs.png">
+  <img src="picture/userRight.png">
   <br><br>
  User can have the following rights:  <ul>
     <li>Right to browse the data ? this right does not have to be set anywhere as it is granted automatically with the creation of access to the application</li>

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:26:38 UTC (rev 828)
@@ -1650,7 +1650,7 @@
 
 Error.HistoryDataSearchFailed=Search data failed
 
-Error.HistoryObjectSearchFailed=Search data failed
+Error.HistoryObjectSearchFailed=Search data failed. Try reolad data.
 
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
@@ -1843,3 +1843,9 @@
 addPublicationNoteLbl=Note\:
 
 addPublicationCollectionNameLbl=Collection name\:
+
+Exception.CreateUser=Failed to create new user. Check that you have appropriate rights for this operation.\n
+
+Exception.AlterUser=Failed to alter user. Check that you have appropriate rights for this operation.
+
+Exception.DropUser=Failed to create new user. Check that you have appropriate rights for this operation. 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:26:38 UTC (rev 828)
@@ -1968,7 +1968,7 @@
 
 Error.HistoryDataSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
 
-Error.HistoryObjectSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi
+Error.HistoryObjectSearchFailed=Chyba p\u0159i hled\u00E1n\u00ED dat v datab\u00E1zi. \nAktualizujte zobrazen\u00E1 data pomoc\u00ED operace Obnovit.
 
 Error.BadDatabaseIdentifier=Identifik\u00E1tor DB m\u016F\u017Ee obsahovat jenom p\u00EDsmena a \u010D\u00EDslice. Pros\u00EDm zadejte korektn\u00ED hodnotu t\u00E9to polo\u017Eky
 
@@ -2185,3 +2185,9 @@
 AUTHOR.role.revised=revidoval
 
 AUTHOR.role.collected=Na\u0161el
+
+Exception.CreateUser=Nepoda\u0159ilo se vytvo\u0159it u\u017Eivatele.\nOv\u011B\u0159te, zda m\u00E1te dostate\u010Dn\u00E1 pr\u00E1va pro tuto operaci.
+
+Exception.AlterUser=Editace hesla nebo pr\u00E1v \u017Eivatele s nezda\u0159ila.\nOv\u011B\u0159te, zda m\u00E1te dostate\u010Dn\u00E1 pr\u00E1va pro tuto operaci.
+
+Exception.DropUser=Nepoda\u0159ilo se zru\u0161it u\u017Eivatele.\nOv\u011B\u0159te, zda m\u00E1te dostate\u010Dn\u00E1 pr\u00E1va pro tuto operaci.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:23:35 UTC (rev 827)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:26:38 UTC (rev 828)
@@ -1497,7 +1497,7 @@
 
 Error.HistoryDataSearchFailed=Search data failed
 
-Error.HistoryObjectSearchFailed=Search data failed
+Error.HistoryObjectSearchFailed=Search data failed. Try reload data.
 
 Error.BadDatabaseIdentifier=Database identifier can only consist of letters and numbers. Please input valid database identifier
 
@@ -2166,3 +2166,9 @@
 Login.DatabaseEngineTT=The database engine that contains the data.
 
 Login.DatabaseEngine=Database
+
+Exception.CreateUser=Failed to create new user. Check that you have appropriate rights for this operation.\n
+
+Exception.AlterUser=Failed to alter user. Check that you have appropriate rights for this operation.
+
+Exception.DropUser=Failed to create new user. Check that you have appropriate rights for this operation. 



From krater at mail.berlios.de  Mon Sep 18 22:26:56 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 22:26:56 +0200
Subject: [Plantlore-dev] r829 - in trunk/src/net/sf/plantlore/help: cs/html
	en/html
Message-ID: <200609182026.k8IKQulD005309@sheep.berlios.de>

Author: krater
Date: 2006-09-18 22:26:55 +0200 (Mon, 18 Sep 2006)
New Revision: 829

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/checklist.html
   trunk/src/net/sf/plantlore/help/cs/html/export.html
   trunk/src/net/sf/plantlore/help/cs/html/import.html
   trunk/src/net/sf/plantlore/help/cs/html/login.html
   trunk/src/net/sf/plantlore/help/cs/html/server.html
   trunk/src/net/sf/plantlore/help/cs/html/table_import.html
   trunk/src/net/sf/plantlore/help/en/html/checklist.html
   trunk/src/net/sf/plantlore/help/en/html/export.html
   trunk/src/net/sf/plantlore/help/en/html/import.html
   trunk/src/net/sf/plantlore/help/en/html/login.html
   trunk/src/net/sf/plantlore/help/en/html/server.html
   trunk/src/net/sf/plantlore/help/en/html/table_import.html
Log:
Few changes to Czech and English help. 

Import translated into English.

Modified: trunk/src/net/sf/plantlore/help/cs/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/checklist.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -15,7 +15,7 @@
 	Je p??stupn? p?i <a href="./addoccurrence.html">vkl?d?n? n?lezov?ch dat</a>.
 	</p>
 
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -24,6 +24,7 @@
 		<li>Vytv??en? a na??t?n? vlastn?ho ?krtac?ho seznamu</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. Pr?ce se ?krtac?m seznamem</h2>

Modified: trunk/src/net/sf/plantlore/help/cs/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/export.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -26,7 +26,7 @@
 	Sou?asn? m??e prob?hat pouze jeden export n?lezov?ch dat.
 	</p>
 	
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -35,9 +35,9 @@
 		<li>Vlastn? export z?znam?</li>
 	</ol>
 	</p>
+        -->
 
 
-
 	<h2>1. Co je nutn? prov?st p?ed t?m, ne? za?nete exportovat</h2>
 
 	<p>

Modified: trunk/src/net/sf/plantlore/help/cs/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/import.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -29,7 +29,7 @@
 	O pr?vech se pojedn?v? v sekci <a href="./user.html">Spr?va u?ivatel?</a>.
 	</p>
 
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -38,6 +38,7 @@
 		<li>Detailn? popis pr?b?hu importu</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. Importov?n? n?lezov?ch dat</h2>

Modified: trunk/src/net/sf/plantlore/help/cs/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/login.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -13,7 +13,7 @@
 	P?ed zapo?et?m pr?ce s Plantlore je zapot?eb? se p?ihl?sit k datab?zi, se kterou chcete pracovat.
 	</p>
 
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -26,6 +26,7 @@
 		<li>Obnova ztracen?ho p?ipojen?</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. Proces p?ipojen? k datab?zi</h2>

Modified: trunk/src/net/sf/plantlore/help/cs/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -17,7 +17,7 @@
 	u?ivatel? je omezen na 32.
 	</p>
 
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -26,6 +26,7 @@
 		<li>P?ipojen? k existuj?c?mu serveru za ??elem administrace</li>
 	</ol>
 	</p>
+        -->
 
 
 

Modified: trunk/src/net/sf/plantlore/help/cs/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/cs/html/table_import.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -33,7 +33,7 @@
 	</p>
 
 
-
+        <!--
 	<h2>Obsah</h2>
 
 	<p>
@@ -44,6 +44,7 @@
 		<li>Omezen? p?i ?prav? tabulek</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. ?prava dat v tabulk?ch</h2>

Modified: trunk/src/net/sf/plantlore/help/en/html/checklist.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/checklist.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -16,7 +16,7 @@
 	<a href="./addoccurrence.html">adding the Occurrence data</a>.
 	</p>
 
-
+        <!--
 	<h2>Contents</h2>
 
 	<p>
@@ -25,6 +25,7 @@
 		<li>Creation and reuse of you own Checklist</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. Working with the Checklist</h2>

Modified: trunk/src/net/sf/plantlore/help/en/html/export.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/export.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/export.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -3,10 +3,10 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Export dat</title>
+    <title>Occurrence Data Export</title>
   </head>
   <body>
-  <h1>Export dat</h1>
+  <h1>Occurrence Data Export</h1>
   	<p>
 	Your Occurrence data are stored in a database and
 	cannot be accessed directly. In order to transfer your
@@ -28,7 +28,7 @@
 	There can run only one Export at a time.
 	</p>
 	
-
+        <!--
 	<h2>Contents</h2>
 
 	<p>
@@ -37,6 +37,7 @@
 		<li>Exporting the Occurrence data</li>
 	</ol>
 	</p>
+        -->
 
 
 

Modified: trunk/src/net/sf/plantlore/help/en/html/import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/import.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/import.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -1,9 +1,126 @@
-<html>
-<head>
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Import</title>
-</head>
-<body>
-<h1>Import</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Occurrence Data Import</title>
+  </head>
+  <body>
+  <h1>Occurrence Data Import</h1>
+
+	<p>
+        Your Occurrence data are stored in a database and
+	cannot be accessed directly. In order to transfer your
+	data from one computer to another, you must use 
+        <a href="./export.html">Export</a> and Import.
+	
+        Import allows you to "take" the Occurrence data from a file on your
+        hard drive and store them back into your database.
+	</p>
+
+	<p>
+        Import can be performed with every database after logging in - even with a remote database.
+	However, if you are connected to a remote database and want to import the Occurrence data,
+	you should take the capacity of the network connection you are using into account, because
+	the amount of data transfered via the network may be huge and the whole process
+	may be painfully slow.
+	</p>
+
+	<p>
+        The database gets modified during the Occurrence data import.
+        In order to prevent unauthorized modifications of the data, you have
+        to posses sufficient access rights.
+        For instance, if you do not have the right to add new records,
+        Occurrence import would never succeed.
+        To learn more about access rights see
+        <a href="./user.html">User's rights</a>.
+	</p>
+
+        <!--
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Importov?n? n?lezov?ch dat</li>
+		<li>Detailn? popis pr?b?hu importu</li>
+	</ol>
+	</p>
+        -->
+
+
+	<h2>1. Occurrence Import</h2>
+
+	<p>
+        First, you must specify the name of the file where the Occurrence
+        records are stored. Currently only the PlantloreNative file format
+        based on XML is available.
+	</p>
+
+	<p>
+        After the file name is supplied, the Occurrence Import begins. 
+        You can monitor its progress in the small window and cancel it by
+        pressing the Cancel button.
+        If you cancel the import prematurely, the Occurrences that were 
+        already inserted will remain in the database.
+        Should you wish to remove these records, use
+	<a href="./history.html">History</a>,
+	that can restore the database's previous state.
+	</p>
+
+
+	<h2>2. Occurrence Import in Detail</h2>
+
+	<p>
+        Occurrence import is a long running operation that modifies the contents
+        of the database. Plantlore must make sure that neither integrity nor security
+        of Occurrence records, that are already in the database, is violated,
+        which is why Plantlore may reject some of the Occurrence data. 
+        There are several reasons that may lead to rejection of a record:
+	<ol>
+		<li>
+                Insufficient access rights - for instance you may not have the 
+                right to add new records or modify records created by other Users.
+		Learn more about user rights in Section
+                <a href="./user.html">User management</a>.
+		</li>
+
+		<li>
+                Incomplete record, i.e. record whose mandatory columns are missing.
+		</li>
+
+		<li>
+                Incorrect record, i.e. record whose parts cannot be found in
+                the database. It is not possible to insert an Occurrence record
+                that refers to a plant, nearest bigger seat, phytochorion, or territorium
+                that is not in the database already.
+                The reasons why it is not possible are listed in Section
+		<a href="./table_import.html">Table import</a>.
+		</li>
+	</ol>
+        The previous list names all reasons that lead to rejection of an Occurrence
+        record, but do not cancel the whole Import.
+        If the file containing the Occurrence data has an unknown or invalid
+        format, the Import is automatically canceled as if the Cancel button was
+        pressed.
+	</p>  
+
+
+	<p>
+        Export and Import were designed for an easy data transfer and exchange 
+        between two databases. You can use Plantlore at home and at work 
+        simultaneously - changes made at work can be easily projected into
+        the database at home using the Export/Import procedure.
+        Let's give an example. You create a new habitat, say 
+        "50 metres from the Thames river.", and add two plants - 
+        Rubus saxatilis L. and Caltha palustris.
+        You export those two records and bring them to work where you import them
+        into your database. At work you realize that one of the plants was not
+	Rubus saxatilis L but Rubus albocarpaticus and you 
+	<a href="./addoccurrence.html">update</a>
+        the Occurrence record. If you transfer the data back to you home database,
+        the change will happen there, too.
+	</p>
+
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -1,10 +1,371 @@
-<html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Login</title>
-</head>
-<body>
-<h1>Login</h1>
-</body>
-</html>
\ No newline at end of file
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>P?ipojov?n? k datab?zi</title>
+  </head>
+  <body>
+  <h1>P?ipojov?n? k datab?zi a Odhla?ov?n? od datab?ze</h1>
+
+
+  	<p>
+	P?ed zapo?et?m pr?ce s Plantlore je zapot?eb? se p?ihl?sit k datab?zi, se kterou chcete pracovat.
+	</p>
+
+
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Proces p?ipojen? k datab?zi</li>
+		<li>Vytv??en? z?znam? o datab?zi</li>
+		<li>?prava a maz?n? z?znam? o datab?zi</li>
+		<li>Nej?ast?j?? probl?my p?i p?ipojov?n?</li>
+		<li>Odhl??en? od datab?ze</li>
+		<li>Obnova ztracen?ho p?ipojen?</li>
+	</ol>
+	</p>
+
+
+	<h2>1. Proces p?ipojen? k datab?zi</h2>
+
+	<p>
+	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, prob?h? ve dvou kroc?ch.
+	</p>
+
+	<h3>1.1. V?b?r datab?ze</h3>
+	
+	<p>
+	<img src="picture/LoginDBSelection.png" alt="Volba datab?ze.">
+	</p>
+
+	<p>
+	Po instalaci Plantlore je k disposici jedna datab?ze pojmenovan? "Uk?zkov? datab?ze".
+	Tato datab?ze neobsahuje ??dn? n?lezov? data a je p?ipravena pro zapo?et? pr?ce.
+	Neobsahuje-li seznam datab?z? ??dn? z?znam, budete jej muset vytvo?it - o tom pojedn?v?
+	druh? ??st t?to n?pov?dy.
+	</p>
+
+	<p>
+	Po jist? dob? pou??v?n? Plantlore m??e v?? seznam datab?z? vypadat podobn? jako ten na obr?zku.
+	Plantlore automaticky p?edvol? tu datab?zi, kterou jste zvolili p?i posledn?m p?ihla?ov?n?.
+	Vyberte jednu z datab?z? v seznamu a stiskn?te tla??tko "Pokra?uj".
+	</p>
+
+
+	<h3>1.2. Autentifikace - prokazov?n? toto?nosti</h3>
+
+	<p>
+	Pro p?ihl??en? k datab?zi je pot?eba se prok?zat p?ihla?ovac?mi ?daji 
+	- u?ivatelsk?m jm?nem a heslem. 
+
+	Pokud se p?ihla?ujete poprv?, zadejte p?ihla?ovac? ?daje, 
+	kter? jste pou?ili p?i instalaci Plantlore.
+
+	Nov? u?ivatelsk? jm?no a heslo sm? z bezpe?nostn?ch d?vod? p?id?lit pouze administr?tor datab?ze.
+	?asto i zku?en? u?ivatel? pou??vaj? velmi slab? hesla, proto je jejich p?id?lov?n?
+	p?enech?no jemu.
+	</p>
+	
+	<p>
+	<img src="picture/LoginAuthentication.png" alt="Vkl?d?n? p?ihla?ovac?ch ?daj?.">
+	</p>
+
+	<p>
+	Plantlore si pamatuje n?kolik posledn?ch u?ivatelsk?ch jmen vkl?dan?ch p?i p?ihl??ov?n?;
+	m??ete vybrat jedno z p?ipraven?ho seznamu, nebo zadat jin? u?ivatelsk? jm?no.
+	Hesla Plantlore neukl?d? a automaticky je nikdy nenab?z?.
+	Po zad?n? ?daj? stiskn?te tla??tko "P?ihl?sit". 
+	</p>
+
+	<p>
+	Stiskem tla??tka "P?ihl?sit" se Plantlore pokus? p?ipojit k vybran? datab?zi se zadan?mi
+	p?ihla?ovac?mi ?daji. P?ipojen? m??e (zejm?na pokud se p?ipojujete ke vzd?len? datab?zi)
+	trvat del?? dobu.
+	</p>
+
+
+	<p>
+	Pokud se p?ihl??en? z n?jak?ho d?vodu nezda??, budete o tom informov?ni kr?tkou zpr?vou.
+	V opa?n?m p??pad? Plantlore zobraz? z?kladn? <a href="./overview.html">P?ehled</a>.
+	</p>
+
+
+	<h2 id="AddDBInfo">2. Vytv??en? z?znam? o datab?z?ch</h2>
+
+	<p>
+	Chcete-li se p?ipojit k jin? datab?zi, 
+	kterou jste sami vytvo?ili nebo kterou vytvo?il n?kdo jin? na sv?m po??ta?i,
+	mus?te vytvo?it nov? z?znam, kter? popisuje, kde se datab?ze nach?z? a jak je nastavena.
+	</p>
+
+	<p>
+	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho
+	tla??tka my?i. Vyberte polo?ku "P?idat" a klikn?te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginAddMenu.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+	<p>
+	P?id?n? nov?ho z?znamu pro p?ipojen? k datab?zi je rozd?leno na dv? ??sti, 
+	jim? odpov?daj? dv? z?lo?ky na dialogu. 
+	<ul>
+		<li>
+		Prvn? z nich je <b>p??m? p?ipojen?</b>, t?? lok?ln? p?ipojen?. 
+		P??m? p?ipojen? k datab?zi lze pou??t pouze v p??pad?,
+		?e vytvo?en? datab?ze se nach?z? v datab?zov?m stroji (database engine), kter? b??? na
+		tomto po??ta?i, tzv. lok?ln?. P??m? p?ipojen? vy?aduje pon?kud odli?n? parametry ne? 
+		p?ipojen? ke vzd?len? datab?zi. V?hodou p??m?ho p?ipojen? je jeho rychlost - komunikace
+		s datab?z? se nemus? nijak upravovat pro p?enos po s?ti.
+		</li>
+		<li>
+		Druh? mo?nost je tzv. <b>vzd?len? p?ipojen?</b>, p?ipojen? ke vzd?len? datab?zi.
+		Vzd?len? datab?ze se typicky nach?z? v datab?zov?m stroji (database engine), kter? je
+		spu?t?n na jin?m po??ta?i v s?ti. Pomoc? tohoto p?ipojen? je mo?n? pracovat s datab?z?
+		"na d?lku". Nev?hodou je zpomalen? dan? jednak propustnost? datov? linky a jednak 
+		nutnost? speci?ln? upravovat p?en??en? data kv?li p?enosu po s?ti. 
+		</li>
+	</ul>
+	</p>
+
+
+	<h3>A. P??m? p?ipojen? k datab?zi (lok?ln? p?ipojen?)</h3>
+
+	<p>
+	Parametry popisuj?c? p??m? p?ipojen?:
+	<table>
+		<tr>
+			<th>N?zev</th>
+			<th>V?znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
+				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
+				nap??klad: "Dom?c? datab?ze", "Projekt mapov?n? ?esk?ho st?edoho??".
+			</td>
+		</tr>
+		<tr>
+			<td>Datab?zov? stroj (engine)</td>
+			<td>
+				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
+				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
+				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
+				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
+				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
+				aby s n?m bylo mo?n? bezchybn? komunikovat. Plantlore je standardn? dod?v?na
+				s Postgre. Aktu?ln? podporovan? DB stroje jsou seps?ny v rozbalovac?
+				nab?dce, ale je mo?n? specifikovat i jin?.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik?tor DB</td>
+			<td>
+				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
+				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor (jm?no)
+				datab?ze, se kterou chce pracovat.
+			</td>
+		</tr>
+		<tr>
+			<td>Port DB</td>
+			<td>
+				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
+				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore v?d?l,
+				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
+				vyu??vaj? porty v rozsahu 1.024 a v??e. Nap??klad standardn? port datab?zov?ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+		<tr>
+			<td>Parametr</td>
+			<td>
+				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
+				zp?sobem. N?kter? stroje nap??klad vy?aduj? explicitn? nastaven? k?dov?n?
+				znak?. Parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
+				P?ipojen? k Postgre ??dn? parametr nevy?aduje.
+				<br/>
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za "?".</i>
+			</td>
+		</tr>
+	</table>
+	</p>
+
+	<p>
+	Na uk?zku uve?me, jak by vypadalo lok?ln? p?ipojen? k datab?zi nazvan? "plantlore",
+	kter? je ulo?ena v datab?zov?m stroji "Postgre", kter? naslouch? na portu "5432".
+	</p>
+
+	<p>
+	<img src="picture/LoginDBDirectConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+
+	<h3>B. Vzd?len? p?ipojen? k datab?zi</h3>
+
+	<p>
+	Parametry popisuj?c? vzd?len? p?ipojen?:
+	<table>
+		<tr>
+			<th>N?zev</th>
+			<th>V?znam</th>
+		</tr>
+		<tr>
+			<td>Alias</td>
+			<td>
+				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
+				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
+				nap??klad: "Ofici?ln? datab?ze Jiho?esk? pobo?ky ?BS".
+			</td>
+		</tr>
+		<tr>
+			<td>Host</td>
+			<td>
+				Datab?zov? stroj obsahuj?c? datab?zi, k n?? se chceme p?ipojit, b??? na jin?m
+				po??ta?i v s?ti. Tento parametr identifikuje tento po??ta? a to bu? podle
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
+				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
+				"data.domacisit.cz". C?lov? po??ta? lze identifikovat 
+				ob?ma zp?soby.
+			</td>
+		</tr>
+		<tr>
+			<td>Port</td>
+			<td>
+				Aby bylo mo?n? se p?ipojit ke vzd?len?mu datab?zov?mu stroji, je nutn?
+				na uveden?m vzd?len?m po??ta?i kontaktovat 
+				<a href="./server.html">Plantlore Server</a>, co? je speci?ln?
+				aplikace, kter? m? za ?kol zprost?edkov?vat p?ipojen? vzd?len?m klient?m a
+				dohl??et na po?et p?ipojen?ch u?ivatel?. Tato slu?ba mus? b?t p??stupn?
+				na vzd?len?m po??ta?i, kde se nach?z? i vzd?len? datab?zov? stroj, 
+				a naslouch? na n?jak?m portu. Standardn? port, na kter?m je tato slu?ba
+				dostupn?, je 1099.
+			</td>
+		</tr>
+		<tr>
+			<td>Identifik?tor DB</td>
+			<td>
+				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
+				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
+				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor
+				datab?ze, se kterou chce pracovat.
+			</td>
+		</tr>
+	</table>
+	</p>
+	
+	<p>
+	Na uk?zku uve?me, jak by vypadalo nastaven? pro vzd?len? p?ipojen? k datab?zi nazvan? "plantlore",
+	kter? je ulo?ena v datab?zov?m stroji, 
+	kter? se nach?z? na po??ta?i s adresou "192.168.0.247", 
+	a Plantlore Server naslouch? na portu "1099".
+	</p>
+
+	<p>
+	<img src="picture/LoginDBRemoteConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		P?id?v?te-li nov? z?znam, ??dn? nov? datab?ze se nikde nevytv???; vytv??? se pouze
+		reference (odkaz) na n?jakou existuj?c? datab?zi.
+	</b>
+	</p>
+
+
+
+	<h2>3. ?prava a maz?n? z?znam? o datab?zi</h2>
+
+	<p>
+	V seznamu datab?z? ozna?te z?znam, kter? chcete upravit nebo smazat.
+	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho tla??tka my?i. 
+	Vyberte polo?ku "Editovat" nebo "Odstranit" a klikn?te na ni.
+	</p>
+
+	<p>
+	<img src="picture/LoginEditMenu.png" alt="?prava st?vaj?c?ho z?znamu.">
+	</p>
+
+	<p>
+	?prava z?znam? je shodn? s dialogem pro p?id?n? z?znamu, ale obsahuje p?edvypln?n? hodnoty.
+	Detailn? popis lze naj?t v p?edch?zej?c? ??sti.
+	</p>
+
+	<p>
+	Odstran?n? z?znamu dal?? nastaven? nem?.
+	</p>
+
+	<p>
+	<img src="picture/LoginDeleteMenu.png" alt="Vymaz?n? existuj?c?ho z?znamu.">
+	</p>
+
+
+	<p>
+	<b>
+		Ma?ete-li existuj?c? z?znam, ??dn? datab?ze se nikde nema?e; ru?? se pouze
+		reference (odkaz) na n?jakou existuj?c? datab?zi.
+	</b>
+	</p>
+
+
+
+	<h2>4. Nej?ast?j?? probl?my p?i p?ipojov?n?</h2>
+
+	<p>
+	Nej?ast?j?? probl?my p?i p?ipojov?n? jsou tyto:
+	<ol>
+		<li>
+		Nespr?vn? vypln?n? p?ihla?ovac? ?daje - u?ivatelsk? jm?no nebo ?patn? zadan? heslo.
+		Ov??te, zda jste spr?vn? zadali oba ?daje, p??padn? zda m?te vytvo?en?
+		odpov?daj?c? u?ivatelsk? ??et v datab?zi, k n?? se p?ipojujete.
+		</li>
+		<li>
+		Nespr?vn? zadan? parametry pro p??m? nebo vzd?len? p?ipojen? k datab?zi.
+		Ov??te, zda jsou vypln?ny v?echny polo?ky spr?vn? a zda obsahuj? aktu?ln? data. 
+		Nap?. mohlo doj?t ke zm?n? IP adresy po??ta?e, ke kter?mu se p?ihla?ujete, nebo jste
+		ud?lali p?eklep p?i zad?v?n? identifik?toru datab?ze.
+		</li>
+		<li>
+		Vypnut? datab?zov? stroj nebo Plantlore Server.
+		Ov??te, ?e datab?zov? stroj je zapnut?, resp. se ujist?te, ?e na vzd?len?m po??ta?i
+		je spu?t?n Plantlore Server.
+		</li>
+	</ol>
+	</p>
+
+
+
+	<h2>5. Odhl??en? od datab?ze</h2>
+
+	<p>
+	Po skon?en? pr?ce s datab?z? je doporu?eno se odhl?sit, aby t?et? osoba nez?skala mo?nost
+	pracovat s va?imi daty. Odhl??en? provedete bu? v menu polo?kou "Odhl?sit" nebo
+	vypnut?m Plantlore. Oba zp?soby jsou ekvivalentn?.
+	</p>
+
+
+	<h2>6. Obnova ztracen?ho p?ipojen?</h2>
+
+	<p>
+	P?i pr?ci s Plantlore m??e doj?t k n?hl? ztr?t? p?ipojen? k datab?zi nebo vzd?len?mu serveru.
+	D?vodem m??e b?t neo?ek?van? vypnut? nebo p?d datab?zov?ho stroje nebo Serveru ?i v?padek s??ov?ho spojen?.
+	O tomto stavu jste informov?ni kr?tkou zpr?vou, kter? popisuje probl?m, ke kter?mu do?lo.
+	V p??pad? ztracen?ho spojen? s datab?z? nebo Serverem vy?kejte n?jakou dobu a zkuste 
+	v menu vybrat "Znovu p?ipojit". Plantlore se pokus? nav?zat nov? spojen?. 
+	"Znovu p?ipojit" m??ete volat opakovan?.
+	</p>
+
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -2,10 +2,281 @@
 
 <html>
   <head>
-    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />  
-    <title>Server</title>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Plantlore Server</title>
   </head>
   <body>
-  <h1>Server</h1>
+	<h1>Plantlore Server</h1>
+
+	<p>
+	Aby se mohli k va?? datab?zi p?ipojovat i jin? u?ivatel? z po??ta?? v s?ti, 
+	mus? b?t spu?t?n Plantlore Server. 
+	Server zprost?edkov?v? p?ipojen? vzd?len?m klient?m a dohl??? na dodr?ov?n?
+	p?edepsan?ho po?tu klient?. Standardn? se z jednoho po??ta?e (z jedn? IP adresy)
+	sm? p?ihl?sit nejv??e t?i klienti a maxim?ln? celkov? po?et sou?asn? p?ipojen?ch
+	u?ivatel? je omezen na 32.
+	</p>
+
+        <!--
+	<h2>Obsah</h2>
+
+	<p>
+	<ol>
+		<li>Vytvo?en? a spu?t?n? nov?ho serveru</li>
+		<li>P?ipojen? k existuj?c?mu serveru za ??elem administrace</li>
+	</ol>
+	</p>
+        -->
+
+
+
+	<h2>1. Vytvo?en? a spu?t?n? nov?ho serveru</h2>
+
+	<p>
+	Nastaven? serveru lze prov?st na z?lo?ce "Spustit nov? server".
+	</p>
+
+	<p>
+	<img src="picture/ServerCreate.png" alt="Spu?t?n? serveru.">
+	</p>
+
+
+	<p>
+	Server lze spustit pouze na lok?ln?m po??ta?i. Jako spr?vce serveru m?te mo?nost nastavit n?sleduj?c? parametry:
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th colspan="2">
+				Nastaven? serveru
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Po spu?t?n? je mo?n? server administrovat 
+				i ze vzd?len?ho po??ta?e.
+				Aby k n?mu nem?ly p??stup nepovolan? osoby, 
+				je mo?n? nastavit heslo, kter?m bude server chr?n?n.
+				Kdokoli se bude cht?t k serveru p?ipojit za ??elem
+				administrace, bude se muset t?mto heslem prok?zat.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur?uje, kde bude server naslouchat, aby se k n?mu mohli 
+				p?ipojovat vzd?len? klienti. 
+
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
+				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
+				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
+
+				Porty nelze sd?let - ujist?te se, ?e na zvolen? port ji?
+				n?kter? jin? aplikace nepou??v?.
+
+				Standardn? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<th colspan="2">
+				Nastaven? datab?zov?ho stroje
+			</th>
+		</tr>
+
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Typ DB
+			</td>
+			<td>
+				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
+				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
+				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
+				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
+				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
+				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
+				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
+				aby s n?m mohl bezchybn? komunikovat. Plantlore je standardn? dod?v?n
+				s Postgre. Aktu?ln? podporovan? DB stroje jsou vyps?ny v rozbalovac?
+				nab?dce, ale je mo?n? specifikovat i jin?.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port DB
+			</td>
+			<td>
+				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
+				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore Server v?d?l,
+				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
+				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Nap??klad standardn? port datab?zov?ho
+				stroje Postgre je 5432.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Parametr
+			</td>
+			<td>
+				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
+				zp?sobem. N?kter? stroje kup??kladu vy?aduj? explicitn? nastaven? k?dov?n?
+				znak?. Tenot parametr slou??
+				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
+				P?ipojen? k Postgre ??dn? parametr nevy?aduje, ale nap?. pro spr?vn? zobrazen?
+				diakritiky od Firebird je pot?eba k?dov?n? nastavit.
+				<br/>
+				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za :?:</i>
+			</td>
+		</tr>
+
+	</table>
+	</p>
+
+
+
+	<h2>2. P?ipojen? k b???c?mu serveru</h2>
+
+
+	<p>
+	V?te-li, ?e n?kde b??? server, kter? jste spustili, m??ete jej vzd?len?  
+	administrovat. Nejprve se k tomuto serveru
+	mus?te p?ipojit pomoc? z?lo?ky "P?ipojen? k b???c?mu serveru".
+	</p>
+
+	<p>
+	<img src="picture/ServerConnect.png" alt="Spu?t?n? serveru.">
+	</p>
+
+
+	<p>
+	Pro p?ipojen? je nutno specifikovat n?sleduj?c? parametry
+	</p>
+
+	<p>
+	<table>
+		<tr>
+			<th>
+				Parametr
+			</th>
+			<th>
+				V?znam
+			</th>
+		</tr>
+
+		<tr>
+			<td>
+				Host
+			</td>
+			<td>
+				Tento parametr identifikuje po??ta?, kde server b???, a to bu? podle
+				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
+				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
+				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
+				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
+				"data.domacisit.cz". 
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Port
+			</td>
+			<td>
+				Port ur?uje, kde vzd?len? server naslouch?.
+
+				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
+				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
+				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
+
+				Standardn? port je 1099.
+			</td>
+		</tr>
+
+		<tr>
+			<td>
+				Heslo
+			</td>
+			<td>
+				Heslo chr?n?c? p??stup k serveru pro ??ely administrace.
+			</td>
+		</tr>
+	</table>
+	</p>
+
+
+
+
+	<h2>3. Administrace serveru</h2>
+
+	<p>
+	Administrace slou?? p?edev??m k z?sk?n? informac? o aktu?ln? p?ipojen?ch u?ivatel?ch
+	a vyp?n?n? serveru. Administr?tor by m?l vy?kat, a? se v?ichni u?ivatel?
+	odpoj?, ne? vypne server. Plantlore Server neimplementuje ??dn? zp?sob 
+	upozor?ov?n? klient?, m?-li b?t server vypnut.
+	</p>
+
+	<p>
+	<img src="picture/ServerManager.png" alt="Administrace serveru.">
+	</p>
+
+	<p>
+	Po p?ipojen?/vytvo?en? k serveru je k dispozici seznam aktu?ln? p?ipojen?ch u?ivatel?.
+	D?le je mo?n? prov?st n?sleduj?c? operace:
+	<ul>
+		<li><b>Obnovit</b>.
+		Aktualizuje seznam s u?ivateli p?ihl??en?mi k tomuto serveru.
+		</li>
+		<li><b>Vyhodit</b>.
+		Odpoj? ozna?en?ho klienta od serveru (tzv. kick).
+		Odpojen? je n?siln? a p?eru?? v?echny operace, kter? klient prov?d?.
+		Neslou?? k zabr?n?n? op?tovn?ho p?ipojen? k serveru, proto?e blokov?n? IP
+		adresy m??e odstavit i jin? klienty. 
+		<br/>
+		V?znam spo??v? v tom, ?e poskytuje prost?edek, jak odpojit neuk?zn?n?
+		klienty, kte?? d?ky sv? nedbalosti pou??vaj? v?ce p?ipojen?, ne? je t?eba,
+		a mohou t?m blokovat jin? u?ivatele, kte?? maj? navenek stejnou IP adresu.
+		<br/>
+		Pokud chcete klientovi zabr?nit v op?tovn?m p?ipojen?, zaka?te jeho u?ivatelsk?
+		??et ve <a href="./import.html">Spr?v? u?ivatel?</a>.
+		</li>
+		<li><b>Zastavit</b>.
+		Ukon?? ?innost serveru, v?ichni u?ivatel? p?ihl??en? k tomuto serveru budou odpojeni
+		bez ohledu na to, zda maj? spu?t?ny n?jak? operace.
+		</li>
+		<li><b>Skr?t</b>.
+		Skryje okno, ale server nech? spu?t?n?. Pro pozd?j?? administraci se k Serveru mus?te
+		znovu p?ihl?sit, jak je pops?no v ??sti 2.
+		</li>
+	</ul>
+	</p>  
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/table_import.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-18 20:26:38 UTC (rev 828)
+++ trunk/src/net/sf/plantlore/help/en/html/table_import.html	2006-09-18 20:26:55 UTC (rev 829)
@@ -34,7 +34,7 @@
 	</p>
 
 
-
+        <!--
 	<h2>Contents</h2>
 
 	<p>
@@ -45,6 +45,7 @@
 		<li>Restrictions and limits</li>
 	</ol>
 	</p>
+        -->
 
 
 	<h2>1. The table update</h2>



From krater at mail.berlios.de  Mon Sep 18 22:32:54 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 22:32:54 +0200
Subject: [Plantlore-dev] r830 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609182032.k8IKWsOw005791@sheep.berlios.de>

Author: krater
Date: 2006-09-18 22:32:54 +0200 (Mon, 18 Sep 2006)
New Revision: 830

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
L10N strings.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:26:55 UTC (rev 829)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:32:54 UTC (rev 830)
@@ -789,7 +789,7 @@
 DBLayer.Error.Other=The reason is unknown.
 
 Error.IncorrectXMLFile=The file format is corrupted.
-Error.UnsupportedTable=You cannot import data to the table {0}.\nIt is not an immutable table.
+Error.UnsupportedTable=You cannot import data to a common table.\nIs it the correct file?
 Error.EmptyXMLFile=There are no records in the file.
 Error.OutOfMemory=Not enough memory to perform the operation.
 Error.MissingUpdateRecord=Records in the UPDATE branch must come in pairs.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:26:55 UTC (rev 829)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:32:54 UTC (rev 830)
@@ -1728,7 +1728,7 @@
 
 Error.Server.NotBound=Na zvolen\u00E9m portu \u017E\u00E1dn\u00FD server neb\u011B\u017E\u00ED.
 
-Error.UnsupportedTable=Do tabulky {0} nelze vkl\u00E1dat data.
+Error.UnsupportedTable=Do vybran\u00E9 tabulky nelze vkl\u00E1dat data.\nJde o spr\u00E1vn\u00FD soubor?
 
 Error.EmptyXMLFile=Soubor neobsahuje \u017E\u00E1dn\u00E9 z\u00E1znamy.
 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:26:55 UTC (rev 829)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:32:54 UTC (rev 830)
@@ -1855,7 +1855,7 @@
 
 Error.EmptyXMLFile=There are no records in the file.
 
-Error.UnsupportedTable=You cannot import data to the table {0}.\nIt is not an immutable table.
+Error.UnsupportedTable=You cannot import data to a common table.\nIs it the correct file?
 
 DBLayer.Error.CreateDB=Creation of new database was not successful. Please make sure that database system is properly installed and that the database doesn't exist yet.
 



From krater at mail.berlios.de  Mon Sep 18 22:36:53 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Mon, 18 Sep 2006 22:36:53 +0200
Subject: [Plantlore-dev] r831 - trunk/src/net/sf/plantlore/l10n
Message-ID: <200609182036.k8IKarrA006012@sheep.berlios.de>

Author: krater
Date: 2006-09-18 22:36:52 +0200 (Mon, 18 Sep 2006)
New Revision: 831

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
A little bit more...

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:32:54 UTC (rev 830)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 20:36:52 UTC (rev 831)
@@ -1849,3 +1849,19 @@
 Exception.AlterUser=Failed to alter user. Check that you have appropriate rights for this operation.
 
 Exception.DropUser=Failed to create new user. Check that you have appropriate rights for this operation. 
+
+Import.RecordsInserted=inserted.
+
+Import.RecordsUpdated=updated.
+
+Server.ConnectionsPerIP=Connections per IP
+
+Server.ConnectionsTotal=Connections total
+
+Import.NoAuthorsLeft=Record No. {0} would have no authors left\!
+
+Import.Progress=completed.
+
+Import.RecordsRejected=rejected.
+
+Import.RecordsDeleted=deleted.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:32:54 UTC (rev 830)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 20:36:52 UTC (rev 831)
@@ -964,12 +964,8 @@
 
 Import.CompletelyCorruptedRecord=Z\u00E1znam {0} je nelze rozparsovat.
 
-Import.PartialyCorruptedRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) je po\u0161kozen.
-
 Import.IncompleteRecord=Z\u00E1znam {0} je ne\u00FApln\u00FD.
 
-Import.ProblematicRecord=Z\u00E1znam \u010D. {0} (UID \= {1}\:{2}) nelze zpracovat;
-
 Import.NoAuthorsLeft=Z\u00E1znam \u010D. {0} by nem\u011Bl \u017E\u00E1dn\u00E9 autory - aktualizaci nelze prov\u00E9st.
 
 Import.UnknownReason=D\u016Fvod nen\u00ED zn\u00E1m.

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:32:54 UTC (rev 830)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 20:36:52 UTC (rev 831)
@@ -2172,3 +2172,19 @@
 Exception.AlterUser=Failed to alter user. Check that you have appropriate rights for this operation.
 
 Exception.DropUser=Failed to create new user. Check that you have appropriate rights for this operation. 
+
+Import.RecordsInserted=inserted.
+
+Import.RecordsUpdated=updated.
+
+Server.ConnectionsPerIP=Connections per IP
+
+Server.ConnectionsTotal=Connections total
+
+Import.NoAuthorsLeft=Record No. {0} would have no authors left\!
+
+Import.Progress=completed
+
+Import.RecordsRejected=rejected.
+
+Import.RecordsDeleted=deleted.



From lada at mail.berlios.de  Mon Sep 18 23:39:04 2006
From: lada at mail.berlios.de (lada at mail.berlios.de)
Date: Mon, 18 Sep 2006 23:39:04 +0200
Subject: [Plantlore-dev] r832 - trunk/src/net/sf/plantlore/client/history
Message-ID: <200609182139.k8ILd4G7012143@sheep.berlios.de>

Author: lada
Date: 2006-09-18 23:39:04 +0200 (Mon, 18 Sep 2006)
New Revision: 832

Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
Log:
History of record: don`t show information about editing author of occurrence. 
Now its better. Some work with authors of occurrence has to be fixed. In future we will change it.

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 20:36:52 UTC (rev 831)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-09-18 21:39:04 UTC (rev 832)
@@ -248,7 +248,7 @@
         
         if (object == null) {
      	   logger.error("tOccurrence doesn't contain required data");  
-     	   throw  new DBLayerException(ERROR_SEARCH_OBJECT + "tOccurrence doesn't contain required data");                           	   		            
+     	   throw  new DBLayerException(ERROR_SEARCH_OBJECT + " tOccurrence doesn't contain required data");                           	   		            
         } else {
      	   
      	   Occurrence occurrence = (Occurrence)object[0];    	   
@@ -303,9 +303,11 @@
 	        // Add restriction to COPERATION column of tHistoryChange table
 	        if (data instanceof Occurrence) {	        	       
 		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Occurrence)data).getId(), null); 
-                        Object[] items = {PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE,
-                        PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_AUTHOROCCURRENCE};
-                        query.addOrRestriction(items);
+                        query.addRestriction(PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE,null);
+                        
+                        //Object[] items = {PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_OCCURRENCE,
+                        //PlantloreConstants.RESTR_EQ, "hcol.tableName", null, PlantloreConstants.ENTITY_AUTHOROCCURRENCE};
+                        //query.addOrRestriction(items);
 	        } else if (data instanceof Habitat) {	        	        
 		        query.addRestriction(PlantloreConstants.RESTR_EQ, "hc.recordId", null, ((Habitat)data).getId(), null);  
 	        }	



From krater at mail.berlios.de  Tue Sep 19 00:07:09 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 19 Sep 2006 00:07:09 +0200
Subject: [Plantlore-dev] r833 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609182207.k8IM79CX015989@sheep.berlios.de>

Author: krater
Date: 2006-09-19 00:07:09 +0200 (Tue, 19 Sep 2006)
New Revision: 833

Modified:
   trunk/src/net/sf/plantlore/help/en/html/server.html
Log:
Server Help translated to English. The rest will come tomorrow.

Modified: trunk/src/net/sf/plantlore/help/en/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-18 21:39:04 UTC (rev 832)
+++ trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-18 22:07:09 UTC (rev 833)
@@ -9,12 +9,13 @@
 	<h1>Plantlore Server</h1>
 
 	<p>
-	Aby se mohli k va?? datab?zi p?ipojovat i jin? u?ivatel? z po??ta?? v s?ti, 
-	mus? b?t spu?t?n Plantlore Server. 
-	Server zprost?edkov?v? p?ipojen? vzd?len?m klient?m a dohl??? na dodr?ov?n?
-	p?edepsan?ho po?tu klient?. Standardn? se z jednoho po??ta?e (z jedn? IP adresy)
-	sm? p?ihl?sit nejv??e t?i klienti a maxim?ln? celkov? po?et sou?asn? p?ipojen?ch
-	u?ivatel? je omezen na 32.
+        To allow other users to connect to your database remotely from other
+        computers in the network, you must start the Plantlore Server.
+        The Server mediates connection for remote clients and
+        controls the number of connected clients.
+        There can be 3 users connected from the same computer (using the same IP)
+        and the total number of clients cannot exceed the number 32.
+        This is the default settings.
 	</p>
 
         <!--
@@ -30,49 +31,52 @@
 
 
 
-	<h2>1. Vytvo?en? a spu?t?n? nov?ho serveru</h2>
+	<h2>1. Creating and starting a new Server</h2>
 
 	<p>
-	Nastaven? serveru lze prov?st na z?lo?ce "Spustit nov? server".
+        You can modify the settings of the server on the Create a new Server tab.
 	</p>
 
 	<p>
-	<img src="picture/ServerCreate.png" alt="Spu?t?n? serveru.">
+	<img src="picture/ServerCreate.png" alt="Starting a new Server.">
 	</p>
 
 
 	<p>
-	Server lze spustit pouze na lok?ln?m po??ta?i. Jako spr?vce serveru m?te mo?nost nastavit n?sleduj?c? parametry:
+        The Server can be started on the local computer only because of security
+        reasons.
+        You can specify following parameters:
 	</p>
 
 	<p>
 	<table>
 		<tr>
 			<th colspan="2">
-				Nastaven? serveru
+				Server Settings
 			</th>
 		</tr>
 
 		<tr>
 			<th>
-				Parametr
+				Parameter
 			</th>
 			<th>
-				V?znam
+				Meaning
 			</th>
 		</tr>
 
 		<tr>
 			<td>
-				Heslo
+				Password
 			</td>
 			<td>
-				Po spu?t?n? je mo?n? server administrovat 
-				i ze vzd?len?ho po??ta?e.
-				Aby k n?mu nem?ly p??stup nepovolan? osoby, 
-				je mo?n? nastavit heslo, kter?m bude server chr?n?n.
-				Kdokoli se bude cht?t k serveru p?ipojit za ??elem
-				administrace, bude se muset t?mto heslem prok?zat.
+                                After the Server is started, it can be controlled
+                                remotely.
+                                To restrict the access to the Server for
+                                administration purposes, you can set a password
+                                that will protect the Server.
+                                Anyone trying to control the Server will have to
+                                pass the password to gain full control.
 			</td>
 		</tr>
 
@@ -81,80 +85,87 @@
 				Port
 			</td>
 			<td>
-				Port ur?uje, kde bude server naslouchat, aby se k n?mu mohli 
-				p?ipojovat vzd?len? klienti. 
-
-				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
-				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
-				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
-
-				Porty nelze sd?let - ujist?te se, ?e na zvolen? port ji?
-				n?kter? jin? aplikace nepou??v?.
-
-				Standardn? port je 1099.
+                                Port specifies where the Server should listen for
+                                connections from remote clients.
+                                
+                                Port is a number from 0 to 65.535 and ports above
+                                1.024 are commonly used. Lower ports are usually
+                                reserved for well known services (such as FTP, HTTP, etc.).
+                                
+                                Ports cannot be shared - you must make sure that the
+                                specified port is not in use by another application.
+                                
+                                The default port where Plantlore Server listens is 1099.
 			</td>
 		</tr>
 
 		<tr>
 			<th colspan="2">
-				Nastaven? datab?zov?ho stroje
+				Database Settings
 			</th>
 		</tr>
 
 		<tr>
 			<th>
-				Parametr
+				Parameter
 			</th>
 			<th>
-				V?znam
+				Meaning
 			</th>
 		</tr>
 
 		<tr>
 			<td>
-				Typ DB
+				DB engine
 			</td>
 			<td>
-				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
-				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
-				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
-				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
-				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
-				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
-				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
-				aby s n?m mohl bezchybn? komunikovat. Plantlore je standardn? dod?v?n
-				s Postgre. Aktu?ln? podporovan? DB stroje jsou vyps?ny v rozbalovac?
-				nab?dce, ale je mo?n? specifikovat i jin?.
+                                There is a wide variety of database engines that
+                                allow you to work with databases, tables, users, 
+                                queries and data very easily.
+                                Every database engine can store several different
+                                databases - databases with different structure and
+                                contents. The best known database engines are
+                                Oracle, MSSQL, MySQL, Postgre and Firebird.
+                                Plantlore can work with some of these database
+                                engines, but it is necessary to specify with
+                                which it should work so that the Server can communicate
+                                with it properly. Plantlore is delivered 
+                                and tested with Postgre.
 			</td>
 		</tr>
 
 		<tr>
 			<td>
-				Port DB
+				DB Port
 			</td>
 			<td>
-				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
-				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore Server v?d?l,
-				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
-				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
-				vyu??vaj? porty v rozsahu 1.024 a? 10.000. Nap??klad standardn? port datab?zov?ho
-				stroje Postgre je 5432.
+                                Database engines can be contacted on a certain port.
+                                Every databse engine may have a different port number
+                                In order to know where to contact the database engine,
+                                you have to supply the port where the database engine listens.
+                                
+                                Port is a number from 0 to 65.535 and ports above
+                                1.024 are commonly used. Lower ports are usually
+                                reserved for well known services (such as FTP, HTTP, etc.).
+                                
+                                The default port of PostgreSQL database engine is 5432.
 			</td>
 		</tr>
 
 		<tr>
 			<td>
-				Parametr
+				Parameter
 			</td>
 			<td>
-				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
-				zp?sobem. N?kter? stroje kup??kladu vy?aduj? explicitn? nastaven? k?dov?n?
-				znak?. Tenot parametr slou??
-				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
-				P?ipojen? k Postgre ??dn? parametr nevy?aduje, ale nap?. pro spr?vn? zobrazen?
-				diakritiky od Firebird je pot?eba k?dov?n? nastavit.
+                                The database engine may require some additional settings.
+                                For instance you have to set the encoding explicitely.
+                                This parameter server for the proper additional configuration
+                                of the database connection.
+                                
+                                Postgre does not require any additional parameter.
 				<br/>
-				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za :?:</i>
+				<i>Note: the parameter is a value passed in the JDBC connections
+                                string right after the exclamation mark "?"</i>
 			</td>
 		</tr>
 
@@ -163,32 +174,32 @@
 
 
 
-	<h2>2. P?ipojen? k b???c?mu serveru</h2>
+	<h2>2. Connecting to a running Server</h2>
 
 
 	<p>
-	V?te-li, ?e n?kde b??? server, kter? jste spustili, m??ete jej vzd?len?  
-	administrovat. Nejprve se k tomuto serveru
-	mus?te p?ipojit pomoc? z?lo?ky "P?ipojen? k b???c?mu serveru".
+        If there is a Server that is already running, you can control it remotely.
+        First, you have to connect to the Server using the
+        Connect to a running Server tab.
 	</p>
 
 	<p>
-	<img src="picture/ServerConnect.png" alt="Spu?t?n? serveru.">
+	<img src="picture/ServerConnect.png" alt="Connecting to a Server.">
 	</p>
 
 
 	<p>
-	Pro p?ipojen? je nutno specifikovat n?sleduj?c? parametry
+        You have to supply the following parameters.
 	</p>
 
 	<p>
 	<table>
 		<tr>
 			<th>
-				Parametr
+				Parameter
 			</th>
 			<th>
-				V?znam
+				Meaning
 			</th>
 		</tr>
 
@@ -197,12 +208,14 @@
 				Host
 			</td>
 			<td>
-				Tento parametr identifikuje po??ta?, kde server b???, a to bu? podle
-				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
-				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
-				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
-				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
-				"data.domacisit.cz". 
+                                This parameter identifies the computer where the Server
+                                is running - either by its name or IP address.
+                                Every computer connected to a network must have its
+                                own unique IP address so that it can be identified
+                                in the network.
+                                IP address is a sequence of four numbers separated with
+                                dots, for instance "192.168.0.247". Some computers may have
+                                also a name, such as "data.home.net".
 			</td>
 		</tr>
 
@@ -211,22 +224,23 @@
 				Port
 			</td>
 			<td>
-				Port ur?uje, kde vzd?len? server naslouch?.
+                                The port specifies where the remote Server listens.
+                                
+                                Port is a number from 0 to 65.535 and ports above
+                                1.024 are commonly used. Lower ports are usually
+                                reserved for well known services (such as FTP, HTTP, etc.).
 
-				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, 
-				?e servery vyu??vaj? porty vy??? ne? 1.024, nebo? ni??? porty
-				b?vaj? rezervov?ny pro zn?m? slu?by (FTP, HTTP, Telnet, ...).
-
-				Standardn? port je 1099.
+				The default port is 1099.
 			</td>
 		</tr>
 
 		<tr>
 			<td>
-				Heslo
+				Password
 			</td>
 			<td>
-				Heslo chr?n?c? p??stup k serveru pro ??ely administrace.
+                                The password protecting the access to the Server
+                                for remote control.
 			</td>
 		</tr>
 	</table>
@@ -235,46 +249,45 @@
 
 
 
-	<h2>3. Administrace serveru</h2>
+	<h2>3. Administration of the Server</h2>
 
 	<p>
-	Administrace slou?? p?edev??m k z?sk?n? informac? o aktu?ln? p?ipojen?ch u?ivatel?ch
-	a vyp?n?n? serveru. Administr?tor by m?l vy?kat, a? se v?ichni u?ivatel?
-	odpoj?, ne? vypne server. Plantlore Server neimplementuje ??dn? zp?sob 
-	upozor?ov?n? klient?, m?-li b?t server vypnut.
+        The Administrator of the Server can obtain the information about currently
+        connected clints, and can switch off the Server.
 	</p>
 
 	<p>
-	<img src="picture/ServerManager.png" alt="Administrace serveru.">
+	<img src="picture/ServerManager.png" alt="Administration of the Server.">
 	</p>
 
 	<p>
-	Po p?ipojen?/vytvo?en? k serveru je k dispozici seznam aktu?ln? p?ipojen?ch u?ivatel?.
-	D?le je mo?n? prov?st n?sleduj?c? operace:
+        After connecting to the Server the Administrator can see the list of 
+        currently connected clients. The Administrator can:
 	<ul>
-		<li><b>Obnovit</b>.
-		Aktualizuje seznam s u?ivateli p?ihl??en?mi k tomuto serveru.
+		<li><b>Refresh the list</b>.
+                Updates the list of connected users.
 		</li>
-		<li><b>Vyhodit</b>.
-		Odpoj? ozna?en?ho klienta od serveru (tzv. kick).
-		Odpojen? je n?siln? a p?eru?? v?echny operace, kter? klient prov?d?.
-		Neslou?? k zabr?n?n? op?tovn?ho p?ipojen? k serveru, proto?e blokov?n? IP
-		adresy m??e odstavit i jin? klienty. 
+		<li><b>Kick a User</b>.
+                Disconnects the selected client from the Server
+		All operations in progress are cancelled. 
+                Kick does not prevent the User from re-connect; His IP address
+                will not be blocked as it may prevent connection from other
+                computers that share the same connection point.
 		<br/>
-		V?znam spo??v? v tom, ?e poskytuje prost?edek, jak odpojit neuk?zn?n?
-		klienty, kte?? d?ky sv? nedbalosti pou??vaj? v?ce p?ipojen?, ne? je t?eba,
-		a mohou t?m blokovat jin? u?ivatele, kte?? maj? navenek stejnou IP adresu.
+                Kick allows you to disconnect clients that use more connectins
+                than necessary thus blockign other Users with the "same" IP address.
 		<br/>
-		Pokud chcete klientovi zabr?nit v op?tovn?m p?ipojen?, zaka?te jeho u?ivatelsk?
-		??et ve <a href="./import.html">Spr?v? u?ivatel?</a>.
+                If you wish to deny the access to the User 
+                (ban Him from using the database), you should disable
+                His account in <a href="./user.html">User manager</a>.
 		</li>
-		<li><b>Zastavit</b>.
-		Ukon?? ?innost serveru, v?ichni u?ivatel? p?ihl??en? k tomuto serveru budou odpojeni
-		bez ohledu na to, zda maj? spu?t?ny n?jak? operace.
+		<li><b>Shutdown the Server</b>.
+                Stops the Server, disconnecting all clients immeditely.
 		</li>
-		<li><b>Skr?t</b>.
-		Skryje okno, ale server nech? spu?t?n?. Pro pozd?j?? administraci se k Serveru mus?te
-		znovu p?ihl?sit, jak je pops?no v ??sti 2.
+		<li><b>Hide the window</b>.
+                Hides the window but keeps the Server online (running).
+                If you seek to administrate the Server again, you must
+                connect to it as described in the Section 2.
 		</li>
 	</ul>
 	</p>  



From fraktalek at mail.berlios.de  Tue Sep 19 01:56:54 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 01:56:54 +0200
Subject: [Plantlore-dev] r834 - trunk/src/net/sf/plantlore/client/overview
Message-ID: <200609182356.k8INusZd002590@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 01:56:51 +0200 (Tue, 19 Sep 2006)
New Revision: 834

Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
Log:
Edit now should work correctly also in cases when one author appears more times
in different roles.

Wrong key was chosen for a hash map in the AddEdit. It used sole author id
instead of the whole authorId,role couple.



Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-18 22:07:09 UTC (rev 833)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-09-18 23:56:51 UTC (rev 834)
@@ -96,7 +96,8 @@
     
     //list of AuthorOccurrence objects that correspond to our Occurrence object, we need it for update
     //set by <code>getAuthorsOf()</code> method
-    private HashMap<Integer,AuthorOccurrence> authorOccurrences;
+    //the key is of form role+AuthorId, for example it could be "4collected" or "2identified"
+    private HashMap<String,AuthorOccurrence> authorOccurrences;
     private Pair<String,Integer> village;
     
     private ArrayList<String> taxonList;
@@ -1033,10 +1034,10 @@
                                 database.executeUpdateInTransaction(o);
                                 habitatToCheck = o.getHabitat(); //we'll maybe have to delete this habitat
                                 logger.debug("Occurrence id "+o.getId()+" "+o.getPlant().getTaxon()+" deleted.");
-                                Set<Map.Entry<Integer,AuthorOccurrence>> aoSet = authorOccurrences.entrySet();
+                                Set<Map.Entry<String,AuthorOccurrence>> aoSet = authorOccurrences.entrySet();
                                 Iterator it = aoSet.iterator();
                                 while (it.hasNext()) {
-                                    Map.Entry<Integer, AuthorOccurrence> entry = (Entry<Integer, AuthorOccurrence>) it.next();
+                                    Map.Entry<String, AuthorOccurrence> entry = (Entry<String, AuthorOccurrence>) it.next();
                                     AuthorOccurrence tmp = entry.getValue();
                                     tmp.setDeleted(2);
                                     database.executeUpdateInTransactionHistory(tmp);
@@ -1067,7 +1068,7 @@
                                     }
                                 }
                                 if (!originalSurvived) {
-                                    aoTmp = authorOccurrences.get(auth.getFirst());
+                                    aoTmp = authorOccurrences.get(auth.getSecond()+auth.getFirst());
                                     aoTmp.setDeleted(1);
                                     database.executeUpdateInTransaction(aoTmp);
                                     logger.debug("AuthorOccurrence id="+aoTmp.getId()+" "+aoTmp.getAuthor().getWholeName()+" deleted.");
@@ -1084,7 +1085,7 @@
                                         new Pair<Integer,String>(pTmp.getFirst().getSecond(),role) )
                                     ) {
                                     logger.info("Updating authorOccurrence properties for "+pTmp.getFirst().getFirst());
-                                    AuthorOccurrence aoTmp = authorOccurrences.get(pTmp.getFirst().getSecond());
+                                    AuthorOccurrence aoTmp = authorOccurrences.get(pTmp.getSecond()+pTmp.getFirst().getSecond());
                                     aoTmp.setRole(pTmp.getSecond());
                                     aoTmp.setNote(resultRevision.get(j));
                                     database.executeUpdateInTransaction(aoTmp);
@@ -1454,7 +1455,7 @@
      */
     private ArrayList<Pair<Pair<String,Integer>,String>> getAuthorsOf(Occurrence o) throws RemoteException, DBLayerException {
         ArrayList<Pair<Pair<String,Integer>,String>> authorResults = new ArrayList<Pair<Pair<String,Integer>,String>>();
-        authorOccurrences = new HashMap<Integer,AuthorOccurrence>();
+        authorOccurrences = new HashMap<String,AuthorOccurrence>();
         resultRevision = new ArrayList();
 
         //Pair<Pair<String,Integer>,Pair<String,Integer>> p;
@@ -1478,7 +1479,7 @@
                         */
             authorResults.add(new Pair<Pair<String,Integer>,String>(
                     new Pair<String,Integer>(a.getWholeName(),a.getId()),role ) );
-            authorOccurrences.put(a.getId(),ao);
+            authorOccurrences.put(role+a.getId(),ao);
             resultRevision.add(ao.getNote());
         }
         database.closeQuery(sq);



From kovo at mail.berlios.de  Tue Sep 19 02:43:30 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 19 Sep 2006 02:43:30 +0200
Subject: [Plantlore-dev] r835 - in trunk/src/net/sf/plantlore: l10n server
Message-ID: <200609190043.k8J0hUD9008414@sheep.berlios.de>

Author: kovo
Date: 2006-09-19 02:43:29 +0200 (Tue, 19 Sep 2006)
New Revision: 835

Modified:
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
When creating new database, set Name and Surname of the new administrator of this database to Admin/Admin.
Display star (compulsory item) next to "name of the author" label on the Add author dialog

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-18 23:56:51 UTC (rev 834)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-19 00:43:29 UTC (rev 835)
@@ -873,7 +873,7 @@
 
 Author.Add.RequiredFieldLabel=* Indicates required field
 #Label next to the field in the Add author dialog
-Author.Add.Name=Name of author\:
+Author.Add.Name=Name of author\: *
 #Label next to the field in the Add author dialog
 Author.Add.Organization=Organization\:
 #Label next to the field in the Add author dialog

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-18 23:56:51 UTC (rev 834)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-19 00:43:29 UTC (rev 835)
@@ -341,7 +341,7 @@
 
 Author.Add.RequiredFieldLabel=* Povinn\u00E1 polo\u017Eka
 
-Author.Add.Name=Jm\u00E9no autora\:
+Author.Add.Name=Jm\u00E9no autora\: *
 
 Author.Add.Organization=Organizace\:
 

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-18 23:56:51 UTC (rev 834)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-19 00:43:29 UTC (rev 835)
@@ -348,7 +348,7 @@
 
 Author.Add.RequiredFieldLabel=* Indicates required field
 
-Author.Add.Name=Name of author\:
+Author.Add.Name=Name of author\: *
 
 Author.Add.Organization=Organization\:
 

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-18 23:56:51 UTC (rev 834)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-19 00:43:29 UTC (rev 835)
@@ -2296,7 +2296,7 @@
         // In case we are creating tables, insert data into TUSER table so that the user can login
         if (scriptid == DBLayer.CREATE_TABLES) {
             sql.append("INSERT INTO tright (cid, cadministrator, cadd, ceditall) VALUES (1,1, 1, 1);");
-            sql.append("INSERT INTO tuser (clogin, cwholename, ccreatewhen, crightid) VALUES ('"+username+"', '', 'NOW', 1);");
+            sql.append("INSERT INTO tuser (clogin, cfirstname, csurname, cwholename, ccreatewhen, crightid) VALUES ('"+username+"', 'Admin', 'Admin', 'Admin Admin', 'NOW', 1);");
         }
         // Split the file with semicolon as the separator
         String[] statements = sql.toString().split(";");        



From kovo at mail.berlios.de  Tue Sep 19 02:50:25 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 19 Sep 2006 02:50:25 +0200
Subject: [Plantlore-dev] r836 - trunk/src/net/sf/plantlore/help/cs/html
Message-ID: <200609190050.k8J0oPWV009177@sheep.berlios.de>

Author: kovo
Date: 2006-09-19 02:50:25 +0200 (Tue, 19 Sep 2006)
New Revision: 836

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/index.html
Log:
Main page of help in Czech. Contains introduction to Plantlore, basic description of the application and basic actions necessary after Plantlore is installed.

Modified: trunk/src/net/sf/plantlore/help/cs/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-19 00:43:29 UTC (rev 835)
+++ trunk/src/net/sf/plantlore/help/cs/html/index.html	2006-09-19 00:50:25 UTC (rev 836)
@@ -2,11 +2,31 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
-    <title>Plantlore - N?pov?da</title>
+    <title>Plantlore</title>
   </head>
   <body>
-    <h1>Plantlore - N?pov?da</h1>
+    <h1>Plantlore</h1>
 
+<h2>?vod</h2>
+Plantlore je datab?zov? syst?m ?e??c? problematiku spr?vy botanick?ch n?lezov?ch dat. Typick?m u?ivatelem Plantlore je profesion?ln? nebo polo-profesion?ln? botanik. Rozhran? syst?mu i jeho n?vrh se soust?edil hlavn? na kvalitn? zad?v?n?, ?pravu a celkov? spr?vu n?lezov?ch dat.
+V syst?mu Plantlore tedy nenajdete funkce jako je anal?za dat, generov?n? statistik, nen? mo?n? k jednotliv?m taxon? ukl?dat obr?zky nebo fotky. Na druhou stranu se Plantlore chov? jako velmi inteligentn? kartot?ka (je mo?n? i tisknout kartot?kov? polo?ky ? schedy), kter? se sna?? v?emo?n? usnadnit spr?vu n?lezov?ch dat ? jejich zad?v?n?, ?pravu, export, import, atd.
+Plantlore tak? nen? taxonomick? datab?ze. Nicm?n? n?vrh datab?zov?ho modelu Plantlore do budoucna do jist? m?ry po??t? s p??padn?m propojen?m na taxonomickou datab?zi. Taxonomick? datab?ze jsou slo?it? samy o sob?, t?to problematice se v?nuje nap??klad takzvan? Berl?nsk? model.
+<p>
+<h2>Zam??len? pou?it? Plantlore</h2>
+Syst?m plantlore je navr?en pro prost?ed? s centr?ln? autoritou spravuj?c? ?pomocn?? data a ?e??c? p??padn? konflikty. Pomocn?mi daty se mysl? jin? data ne? ?ist? n?lezov?. To znamen? nap??klad seznam taxon?, seznam teritori?, fytochorion? nebo s?del. Aby bylo mo?n? tuto centr?ln? spr?vu vytvo?it a udr?et, p?ich?z? Plantlore se syst?mem pr?v, d?ky kter?mu je mo?n? r?zn? funkce povolit jen ur?it?m u?ivatel?m.
+Stejn? tak se p?edpokl?d?, ?e ve v?t?in? p??pad? bude botanik pracovat doma na lok?ln?m po??ta?i bez p?ipojen? k Internetu a zadan? data pot? vyexportuje a p?ed? centr?ln? autorit? kter? provede import do centr?ln? datab?ze. Proto jsou p??padn? konflikty p?i soub??n? ?prav? n?lez? v?ce u?ivateli v Plantlore ?e?eny takzvan?m optimistick? zp?sobem. To znamen?, ?e se p?edpokl?d?, ?e ke konflikt?m bude doch?zet velmi z??dka a proto nebude drah? je vy?e?it manu?ln?. V praxi to znamen?, ?e p?i soub??n? editaci jednoho n?lezu dv?ma u?ivateli se v datab?zi provede jen prvn? zm?na a u?ivatel, kter? editac? ukon?? jako druh? dostane chybovou hl??ku o konfliktu.
+Mimojin? pro usnadn?n? ?e?en? tohoto probl?mu Plantlore obsahuje funkci Historie n?lezu, d?ky kter? je mo?n? si nechat zobrazit v?echny zm?ny proveden? na dan?m n?lezu.
+<p>
+<h2>Webov? klient</h2>
+Plantlore obsahuje krom b??n?ho klienta s grafick?m u?ivatelsk?m rozhran?m i webov?ho klienta. Webov? klient bude instalov?n hlavn? centr?ln? autoritou, kter? chce ob?an?m a sv?m p?isp?vatel?m zp??stupnit ??st sv?ch dat. Oby?ejn? lid? maj? pak p??stup pouze k omezen?m informac?m o n?lezech, kde?to p?isp?vatel? botanici maji p??stup plnohodnotn?.
+Webov? klient tak? umo??uje zapojen? do evropsk?ho v?zkumn?ho projektu BioCASE. V?ce informac? o n?m se m??ete dozv?d?t na jeho internetov?ch str?nk?ch na adrese http://www.biocase.org/.
+<p>
+<h2>Za??tek pr?ce s Plantlore</h2>
+Typicky se u?ivatel po ?sp??n?m nainstalov?n? Plantlore (v?ce viz instala?n? p??ru?ka) do syst?mu p?ihl?s?, lok?ln? k pr?zdn? p?i instalaci vytvo?en? datab?zi.
+Po p?ihla?en? do pr?zdn? datab?ze nebude na klientovi mnoho zaj?mav?ho. Datab?zi je pot?eba nejd??ve naplnit daty. Data pro napln?n? datab?ze u?ivatel z?sk? od sv? centr?ln? autority a postupn? je naipmortuje do sv? datab?ze p??kazem Soubor -> Import. 
+V p??pad?, ?e u? datab?ze obsahuje data nutn? pro zad?n? povinn?ch polo?ek p?i zad?v?n? n?lezu, je mo?n? za??t s p?id?v?n?m n?lezov?ch dat z?skan?ch v pozorov?n?m rostlin v ter?nu. 
+Hlavn?mi funkcemi tedy alespo? ze za??tku budou P?id?v?n? nov?ho n?lezu, editace n?lezu a import dat.    
+
     <ul>
       <li><a href="login.html">P?ihl??en?</a></li>
       <li><a href="setting.html">Nastaven?</a></li>



From fraktalek at mail.berlios.de  Tue Sep 19 03:36:17 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 03:36:17 +0200
Subject: [Plantlore-dev] r837 - in trunk/src/net/sf/plantlore/help: cs/html
	en en/html
Message-ID: <200609190136.k8J1aH8l013247@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 03:36:16 +0200 (Tue, 19 Sep 2006)
New Revision: 837

Added:
   trunk/src/net/sf/plantlore/help/en/html/habitattree.html
Modified:
   trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
   trunk/src/net/sf/plantlore/help/cs/html/habitattree.html
   trunk/src/net/sf/plantlore/help/cs/html/overview.html
   trunk/src/net/sf/plantlore/help/en/html/addoccurrence.html
   trunk/src/net/sf/plantlore/help/en/html/overview.html
   trunk/src/net/sf/plantlore/help/en/html/settings.html
   trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm
   trunk/src/net/sf/plantlore/help/en/jhelptoc.xml
Log:
Translations, a few fixes, fix of the English help structure.



Modified: trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/cs/html/addoccurrence.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -10,16 +10,6 @@
 m??e upravovat jen ty z?znamy, ke kter?m m? pr?vo editace. Pro p?id?n? nov?ho n?lezu u?ivatel tak?
 mus? m?t pr?va.</p>
 
-<h2>Obsah</h2>
-<ol>
-    <li>Dialogy</li>
-    <li>?prava n?lezu</li>
-    <li>Vypnut? nepovinn?ch polo?ek</li>
-    <li>Kontrola zadan?ch hodnot</li>
-    <li>Sd?len? lokalit</li>
-    <li>Na z?v?r</li>
-</ol>
-
 <h2>1. Dialogy</h2>
 <p>Dialogy pro p?id?v?n? a ?pravu n?lezu jsou velmi podobn? vzhledem i chov?n?m.
 ?pravu i p?id?v?n? m??ete vyvolat z panelu n?stroj?. P?id?v?n? je mo?n? vyvolat i ze <a href="habitattree.html">stromu lokalit</a>. 

Modified: trunk/src/net/sf/plantlore/help/cs/html/habitattree.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/habitattree.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/cs/html/habitattree.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -3,7 +3,7 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>Vytv??en? nov? datab?ze</title>
+    <title>Strom lokalit</title>
   </head>
   <body>
   <h1>Strom lokalit</h1>

Modified: trunk/src/net/sf/plantlore/help/cs/html/overview.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/cs/html/overview.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -11,14 +11,6 @@
   n?lez? je pak mo?n? vyvol?vat v?t?inu ostatn?ch funkc? Plantlore.</p> 
   <br>
    <img src="picture/overview.png" alt="P?ehled n?lez?"><br>
-    <h2>Obsah</h2>
-    <ol>
-        <li>?vod</li>
-        <li>Ovl?dac? prvky p?ehledu n?lez?</li>
-        <li>T??d?n?</li>
-        <li>Po?ad? sloupk?</li>
-        <li>Podrobnosti o n?lezu</li>
-    </ol>
     <h2>1. ?vod</h2>
     <p> P?ehled n?lez? je tabulka zobrazuj?c? seznam n?lez?. Implicitn? jsou zobrazeny
     v?echny z?znamy. Jejich seznam je ale mo?n? z??it <a href="search.html">vyhled?v?n?m</a>. </p>

Modified: trunk/src/net/sf/plantlore/help/en/html/addoccurrence.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/addoccurrence.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/html/addoccurrence.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -1,10 +1,86 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html>
 <head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Add/edit occurrence</title>
+<meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+<title>Plantlore - Occurrence adding and editing</title>
 </head>
 <body>
-<h1>Add/edit occurrence</h1>
-</body>
-</html>
\ No newline at end of file
+<h1>Occurrence adding and editing</h1>
+<p>You can do all basic occurrence manipulation from the Add and Edit dialogs.
+You can edit only those records to which he has appropriate rights. To add a new occurrence
+you also have to have sufficient rights.
+</p>
+
+<h2>1. Dialogs</h2>
+<p>The add and edit dialogs are very similar in both their appearance and behaviour.
+You can invoke both dialogs from the toolbar. There is one other way to invoke the Add dialog and that is from the <a href="habitattree.html">habitat tree</a>.
+</p>
+<br>
+
+<img src="picture/addedit_place.png" alt="The top part of add/edit dialog with fields about the location of the occurrence">
+
+<p>
+The dialog consists of three parts: location, occurrence (taxon/author) and table part. 
+The table contains all occurrences contained in the given location. It is a help to make it easier for you
+to keep track of what has already been added. You always have to input all required fields which are the ones denoted by a star.
+After clicking on the Ok button new occurrence is added (or a present one updated). In case of adding a confirmation window shows up
+after the operation is successfuly completed. The Add dialog remains on the screen open with all fields entered. This is to make it
+easier to add other similar occurences that share most of the fields. <b>WARNING:</b> repeated clicking to the Ok button repeats the
+insert of the same occurrence! You can use the two clear buttons to quickly clear the respective parts of the dialog.
+</p>
+<br>
+
+<img src="picture/addedit_occurrence.png" alt="The middle - occurrence - part of the dialog">
+
+<p>You can precisely specify the location of the occurrence using GPS coordinates. You can use one of the three supported coordinate systems:
+S-JTSK, S42, WGS84. The base coordinate system is the WGS84. PLantlore automatically converts the coordinates before storing them into the database.
+</p>
+
+<p>The table of occurrences in the entered location. It shows information only about the author names the taxon name and the date.</p>
+<br>
+<img src="picture/addedit_occurrence_table.png" alt="Table of occurrences for the given location">
+
+<h2>2. Editing an occurrence</h2>
+<p>
+    The edit dialog is quite powerful. While editing an occurrence you can delete an old one or even create new ones. The edit dialog
+    determines the right actions according to what you fill in. Deleting an occurrence (which means deleting the taxon in the edit dialog)
+    has the same effect as deleting in from the <a href="overview.html">Overview</a>. Adding new occurrences (which means entering new taxons in
+    the edit dialog) has the same effect as adding them from the add dialog.
+</p>
+
+<h2>3. Disabling non-mandatory fields</h2>
+<p>Often you won't want to fill in all the fields. In that case you can disable some of them
+to enable quicker navigation through the dialog using keyboard. You can do that in the settings
+dialog which you can invoke by clicking on the Settings button in the bottom part of the add or edit dialog.
+</p>
+
+
+<h2>4. Verification</h2>
+<p>Plantlore automatically verifies the values you entered. Specifically it checks:
+    <ul>
+        <li>whether you filled in all required fields</li>
+        <li>correctness of the date (whether it exists in gregorian calendar)</li>
+        <li>value lenghts - for example the notes can be at most 4096 characters long</li>
+        <li>value correctness - that there is a number where it is expected,etc. You have to adhere to the right decimal point character according to your current locale. In Czech locale it is a comma, in English locale it is a period.</li>
+    </ul>        
+</p>
+
+<h2>5. Habitat sharing</h2>
+<p>If you add multiple occurrences into a habitat all these occurrences wil share the habitat in the database model of Plantlore.
+This means that Plantlore is able to recognize whish occurrences belong to which habitat. You can notice that
+mainly when editing a shared habitat. In that case Plantlore will ask you whether you want to change the habitat
+for all the occurrences or just for the one plant. The habitat is deleted when last it's occurrence is deleted.
+</p>
+
+<h2>6. Conclusion</h2>
+      <p>Work with occurrences requires deliberation. When adding a new occurrence Plantlore automatically tries
+      to find the entered location in the database. If it succeeds it uses that found habitat for the new occurrences.
+      However, only a small difference for example in the place description will cause that Plantlore won't find the habitat
+      and will create a new one instead. You'll be rewarded for dilligent work for example by bigger leverage of the <a href="habitattree.html">habitat tree</a>.
+
+</p>
+  </body>
+</html>
+
+
+

Added: trunk/src/net/sf/plantlore/help/en/html/habitattree.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/habitattree.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/html/habitattree.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -0,0 +1,36 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
+<html>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>The habitat tree</title>
+  </head>
+  <body>
+  <h1>The habitat tree</h1>
+ <p>The purpose of the habitat tree is to make your orientation in the occurrences a little easier.
+You can invoke it from the main application toolbar.
+</p>
+ <br>
+ <img src="picture/habitat_tree.png" alt="The habitat tree">
+ <br>
+ 
+ <p>The first level of the tree contains territories. Each territory then contains phytochoria and
+ each phytochorion contains a list of habitats. The tree contains only those phytochoria and territories
+ for that already some occurrence exists in the database. Phythochoria that don't contain any habitats are not displayed.
+ Similarly territories that don't contain at least one phytochorion containing at least one habitat are also not displayed.
+ Each phytochorion contains all habitats in that phytochorion (even though the user may have used different
+ territories).
+</p>
+  
+  <p>You can display occurrences in a given habitat by double clicking it or by selecting it and then
+  invoking the search action from a context menu or by pressing the tree's Search button.
+</p>
+   
+   <p>The tree doesn't refresh itself as you work with the database to make the work more effective
+   on slower internet connections. The list of habitats is loaded (refreshed) from the database
+   each time you expand node of the particular phytochorion. To load the entire structure of the tree
+   use the refresh button or the refresh action from the context menu.
+
+   </p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/overview.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/overview.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/html/overview.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -1,10 +1,60 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Plant overview</title>
-</head>
-<body>
-<h1>Plant overview</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Overview</title>
+  </head>
+  <body>
+  <h1>Overview</h1>
+  <p>The center of Plantlore is the overview. You see it after a successful login and you can invoke
+  most of the Plantlore features from it.
+
+    <h2>1. Introduction</h2>
+    <p> The overview is a table containing a list of occurrences. By default you see all the occurrences
+    divided to multiple pages. You can narrow the list of occurrences down by using the <a href="search.html">Search</a>.
+     </p>
+    
+    <p>The result of the search is always displayed in the overview. To return back to the all results you can click on the refresh button
+in the right bottom part of the main application window.</p>
+    
+    <p>The overview doesn't refresh itself automatically. The reason is the effectivity of work on slower internet connections. 
+    If you want to refresh the overview, you can either make a new search or use the Refresh button.</p>
+    <br>
+    <img src="picture/overview_second_toolbar.png" alt="The overview tools"><br>
+    
+    <p>You can change the numbor of occurrences displayed on a page by changing the number between the Previous and Next buttons.
+    The page size changes after you confirm the number for example by pressing the Enter key. As of now it is NOT POSSIBLE to
+    determine the page size dynamically according to the size of the window (technical reasons). The page size is restricted to 1000 occurrences.
+    </p>
+    
+    <p>To delete, print or export you first need to check the desired occurrences by clicking on the initially leftmost column called "X".
+    To select occurrences you can also use the All, None and Invert buttons in the lower left part of the window.
+    <b>WARNING:</b> these three selecting buttons always work only with the current page. 
+    After you have selected the occurrence you just have to invoke some plantlore function from the toolbar, menu or using a shortcut.
+</p>
+    <br>
+    <img src="picture/overview_selecting.png" alt="Selecting (checking) occurrences"><br>
+    
+    <h2>3. Sorting</h2>
+    <p>The overview supports only limited ways of sorting. By default the occurrences appear sorted by year from the most current one back to history.
+You can also sort the occurrences on the current page. You can't sort all the occurrences in the database because of the (potentially) big number
+of records in the database that could have enormous demands on connection speed and processing. 
+Let's say you want to sort the occurrences by taxon name. You have to click on the Taxon column header. Then in the header an arrow shows up which
+indicates the sorting direction. Secondary sorting is also possible - again clicking on a column header but this time with the Ctrl key pressed.</p>
+    <br>
+    <!--<img src="picture/overview_sorting.png" alt="Sorting"><br> -->
+    
+    <h2>4. Column order</h2>
+    <p>It is possible to change the order of the columns in overview. You can do that either by simply dragging the column to a different place(which won't
+    persist to the next time you run PLantlore) or by choosing the order in the Plantlore <a href="settings.html">Settings</a>.</p>
+    
+    <h2>5. Occurrence details</h2>
+    <p>The occurrence table doesn't show all information about the occurrence. You can tak a look at them either in the edit dialog or in a special
+Detail dialog. You can invoke the Detail dialog by double clicking or pressing Enter on the desired occurrence.</p>
+    <br>
+    <img src="picture/overview_detail.png" alt="Occurrence detail"><br>
+    
+    <p>The detail allows for skipping to a next or previous occurence. It also shows information about the user that created the occurrence or who edited it the last time.</p>  
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/html/settings.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/settings.html	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/html/settings.html	2006-09-19 01:36:16 UTC (rev 837)
@@ -1,10 +1,27 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
+
 <html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Settings</title>
-</head>
-<body>
-<h1>Settings</h1>
-</body>
-</html>
\ No newline at end of file
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
+    <title>Settings</title>
+  </head>
+  <body>
+  <h1>Settings</h1>
+<p>You can partially influence the behaviour of Plantlore in it's Settings dialog in the File menu.</p>
+
+<p>The settings dialog contains three tabs. From that only the language setting requires restart of the application.
+</p>
+<br>
+<img src="picture/settings_languages.png" alt="Languages">
+<br>
+<p>In the columns tab you can choose the columns and their order in that they should appear in the <a href="overview.html">Overview</a>.
+</p>
+
+<img src="picture/settings_columns.png">
+
+<p>Plantlore also offers a simple scheda customization. You can set the headlines of generated Scheda on the Scheda tab.</p>
+
+<img src="picture/settings_scheda.png">
+
+  </body>
+</html>

Modified: trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm
===================================================================
--- trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/jhelpmap.jhm	2006-09-19 01:36:16 UTC (rev 837)
@@ -10,9 +10,8 @@
     <mapID target="settings" url="html/settings.html"/>
     <mapID target="overview" url="html/overview.html"/>
     <mapID target="overview.addoccurrence" url="html/addoccurrence.html"/>
-    <mapID target="overview.addoccurrence.basic" url="html/addoccurrence.html#basic"/>
-    <mapID target="overview.addoccurrence.extended" url="html/addoccurrence.html#extended"/>
-    <mapID target="overview.addoccurrence.checklist" url="html/addoccurrence.html#checklist"/>
+    <mapID target="overview.addoccurrence.checklist" url="html/checklist.html"/>
+    <mapID target="overview.habitattree" url="html/habitattree.html"/>
     <mapID target="overview.search" url="html/search.html"/>
     <mapID target="overview.history" url="html/history.html#historyRecord"/>
     <mapID target="author" url="html/author.html"/>

Modified: trunk/src/net/sf/plantlore/help/en/jhelptoc.xml
===================================================================
--- trunk/src/net/sf/plantlore/help/en/jhelptoc.xml	2006-09-19 00:50:25 UTC (rev 836)
+++ trunk/src/net/sf/plantlore/help/en/jhelptoc.xml	2006-09-19 01:36:16 UTC (rev 837)
@@ -13,10 +13,9 @@
     <tocitem target="settings" text="Settings"/>
     <tocitem target="overview" text="Overview">
         <tocitem target="overview.addoccurrence" text="Add/Edit Occurrence">        
-            <tocitem target="overview.addoccurrence.basic" text="Basic data"/>
-            <tocitem target="overview.addoccurrence.extended" text="Extended data"/>            
             <tocitem target="overview.addoccurrence.checklist" text="Checklist"/>                        
         </tocitem>
+        <tocitem target="overview.habitattree" text="Habitat tree"/>
         <tocitem target="overview.search" text="Search"/>
         <tocitem target="overview.history" text="Record history"/>        
     </tocitem>



From fraktalek at mail.berlios.de  Tue Sep 19 04:13:42 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 04:13:42 +0200
Subject: [Plantlore-dev] r838 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609190213.k8J2Dgul015557@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 04:13:41 +0200 (Tue, 19 Sep 2006)
New Revision: 838

Modified:
   trunk/src/net/sf/plantlore/help/en/html/index.html
Log:
Introduction translation.



Modified: trunk/src/net/sf/plantlore/help/en/html/index.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/index.html	2006-09-19 01:36:16 UTC (rev 837)
+++ trunk/src/net/sf/plantlore/help/en/html/index.html	2006-09-19 02:13:41 UTC (rev 838)
@@ -1,27 +1,68 @@
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
 <html>
-<head>
-<meta http-equiv="Content?Language" content="en?US" />
-<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
-<title>Plantlore</title>
-</head>
-<body>
-<h1>Plantlore</h1>
+  <head>
+    <meta http-equiv="Content-type" content="text/html; charset=utf-8" />
+    <title>Plantlore</title>
+  </head>
+  <body>
+    <h1>Plantlore</h1>
 
-<ul>
+<h2>Introduction</h2>
+<p>Plantlore is a plant occurrence database system that tries to solve the complex problem of occurrence data management.
+The typical Plantlore user is an (almost) professional botanist. The user interface and the application desing concentrated
+mainly on quality data entering, editing and data management as whole.</p>
+
+<p>In the Plantlore system you won't therefore find features like data analysis, stats generation, it is not possible to store pictures with the occurrences.
+On the other hand Plantlore works as a quite intelligent card-index (it is even possible to print the old fashioned cards - schedas). It tries to
+make your occurrence data management easier - be it adding, editing, export or import, ...
+Plantlore also isn't a taxonomical database. The database model of Plantlore however takes into account a possible future enhancement by interconnecting
+it with some taxonomical database.</p>
+<p>
+<h2>The intended use of Plantlore</h2>
+<p>The Plantlore system is designed for enviroment that has a central authority that manages all auxiliary data and that solves possible conflicts.
+By auxiliary data we mean data other than the pure occurrence data. That for example means the list of taxons, list of territories, phythochoria or villages.
+To make it possible to maintain such central management Plantlore has a system of rights thanks to that you can restrict access to some of it's functions to some users.
+It is also assumed that in most cases the botanist works at home on a local computer not connected to the Internet. He usually exports his data and gives them to the central authority
+that performs an import to a central database. </p>
+<p>This is also why possible conflicts when two users would edit the same occurrence at the same time are solved "optimistically".
+That means that it is assumed that conflicts are very rare and therfore it will be cheap to solve them manually. In practise that means that
+if two users are editing the same occurrence at the same time only the first change appears in the database and the second user to click on Ok
+will receive an error message. To make this, although rare, situation easier Plantlore has the feature of History. In the History you can
+view all the changes that happend to the database and u can also perform undo operations.
+</p>
+
+<p>
+<h2>The web client</h2>
+<p>Except the normal GUI client Plantlore also contains a web client. The web client is expected to be installed only by the central authority in most cases.
+This way the central authority can expose it's data to the public. Ordinary people then have access only to a limited amount of information
+whereas the cooperating botanist can have full access. </p>
+<p>Thanks to the web client it is also very easy to take part in the european research project BioCASE. You can find more information about this project on http://www.biocase.org/.
+</p>
+<h2>Beginning to work</h2>
+<p>Usually after a successful install the user logs into the system locally, not using the Plantlore server. The database is after installation empty.
+Therefore one of the first steps in newly installed Plantlore will be to import some of the auxiliary data. The user typically will
+receive these data from his or her central authority and then import them using the command File -> Table import.</p>
+
+<p>In case that the database contains data necessary to fill in all required fields it is possible to begin to add some new occurrence data
+gained in the terrain. Therefore at least at the beginning the main commands of interest will be the Table import, Add and the managers in the Data menu.
+</p>
+
+
+
+    <ul>
       <li><a href="login.html">Login</a></li>
       <li><a href="setting.html">Settings</a></li>
       <li><a href="overview.html">Overview</a></li>
-      <li><a href="author.html">Author</a></li>
-      <li><a href="publication.html">Publication</a></li>
+      <li><a href="author.html">Authors</a></li>
+      <li><a href="publication.html">Publications</a></li>
       <li><a href="metadata.html">Metadata</a></li>
       <li><a href="history.html">History</a></li>
       <li><a href="user.html">Users</a></li>
       <li><a href="import.html">Import</a></li>
-      <li><a href="export.html">Export</a></li>
-      <li><a href="createdb.html">New database</a></li>
+      <li><a href="export.html">Exportt</a></li>
+      <li><a href="createdb.html">Create database</a></li>
       <li><a href="server.html">Server</a></li>    
     </ul>
-
-
-</body>
+    
+  </body>
 </html>



From fraktalek at mail.berlios.de  Tue Sep 19 10:54:01 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 10:54:01 +0200
Subject: [Plantlore-dev] r839 - in trunk/src/net/sf/plantlore:
	client/overview/tree l10n
Message-ID: <200609190854.k8J8s1O0013022@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 10:54:00 +0200 (Tue, 19 Sep 2006)
New Revision: 839

Modified:
   trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
Log:
Got rid of nulls displayed in Habitat tree.



Modified: trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-19 02:13:41 UTC (rev 838)
+++ trunk/src/net/sf/plantlore/client/overview/tree/HabitatTree.java	2006-09-19 08:54:00 UTC (rev 839)
@@ -186,7 +186,13 @@
         DefaultMutableTreeNode node;
         for (Object record : records) {
             Object[] obj = (Object[])record;
-            String name = ((NearestVillage)obj[2]).getName() + " - " + obj[1] + " ("+L10n.getString("HABITAT.quadrant")+" "+ obj[3] + ")";
+            String name;
+            if (obj[3] != null)
+                name = ((NearestVillage)obj[2]).getName() + " - " + obj[1] + " ("+L10n.getString("HABITAT.quadrant")+" "+ obj[3] + ")";
+            else if (obj[1] != null)
+                name = ((NearestVillage)obj[2]).getName() + " - " + obj[1];
+            else
+                name = ((NearestVillage)obj[2]).getName() + " - " + L10n.getString("Habitat") + " " + L10n.getString("Overview.Tree.Number")+" "+ obj[0];
             Integer count = getOccurrenceCount((Integer)obj[0]);
             name = "("+count+") "+name;
             node = new DefaultMutableTreeNode(new NodeInfo(NodeInfo.NodeType.HABITAT,name,(Integer)obj[0],-1));

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-19 02:13:41 UTC (rev 838)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-19 08:54:00 UTC (rev 839)
@@ -1865,3 +1865,5 @@
 Import.RecordsRejected=rejected.
 
 Import.RecordsDeleted=deleted.
+
+Overview.Tree.Number=number

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-19 02:13:41 UTC (rev 838)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-19 08:54:00 UTC (rev 839)
@@ -2187,3 +2187,5 @@
 Exception.AlterUser=Editace hesla nebo pr\u00E1v \u017Eivatele s nezda\u0159ila.\nOv\u011B\u0159te, zda m\u00E1te dostate\u010Dn\u00E1 pr\u00E1va pro tuto operaci.
 
 Exception.DropUser=Nepoda\u0159ilo se zru\u0161it u\u017Eivatele.\nOv\u011B\u0159te, zda m\u00E1te dostate\u010Dn\u00E1 pr\u00E1va pro tuto operaci.
+
+Overview.Tree.Number=\u010D\u00EDslo

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-19 02:13:41 UTC (rev 838)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-19 08:54:00 UTC (rev 839)
@@ -2188,3 +2188,5 @@
 Import.RecordsRejected=rejected.
 
 Import.RecordsDeleted=deleted.
+
+Overview.Tree.Number=number



From krater at mail.berlios.de  Tue Sep 19 11:18:37 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 19 Sep 2006 11:18:37 +0200
Subject: [Plantlore-dev] r840 - in trunk/src/net/sf/plantlore/help: cs/html
	en/html
Message-ID: <200609190918.k8J9IbqN017373@sheep.berlios.de>

Author: krater
Date: 2006-09-19 11:18:37 +0200 (Tue, 19 Sep 2006)
New Revision: 840

Modified:
   trunk/src/net/sf/plantlore/help/cs/html/server.html
   trunk/src/net/sf/plantlore/help/en/html/server.html
Log:
Server Help finished.

Modified: trunk/src/net/sf/plantlore/help/cs/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-19 08:54:00 UTC (rev 839)
+++ trunk/src/net/sf/plantlore/help/cs/html/server.html	2006-09-19 09:18:37 UTC (rev 840)
@@ -279,5 +279,43 @@
 		</li>
 	</ul>
 	</p>  
+        
+        
+        <h2>4. Odstra?ov?n? probl?m?</h2>
+
+	<p>
+        P?i spu?t?n? Serveru se m??e st?t, ?e Server nen? schopen automaticky
+        rozpoznat IP adresu po??ta?e, na kter?m b???, p?esto?e autodetek?n? rutina
+        zkou?? n?kolik zp?sob? detekce.
+        Typicky jsou t?mto probl?mem posti?eny po??ta?e se dv?ma
+        s??ov?mi rozhran?mi nebo po??ta?e s OS Linux 
+        (zde m??e b?t p???inou i ?patn? nastaven? /etc/hosts).
+	</p>
+        
+        <p>
+        Pro spr?vn? b?h RMI, technologie pou?it? pro zprost?edkov?n?
+        komunikace po s?ti, je zapot?eb?, aby byl spr?vn? nastaven
+        parametr "java.rmi.server.hostname".
+        Nen?-li tento parametr nastaven spr?vn?, vzd?len? p?ipojen?
+        sel?ou s n?sleduj?c? chybou:
+        <pre>
+        java.rmi.ConnectException: Connection refused to host: 127.0.0.1; 
+        nested exception is:
+           java.net.ConnectException: Connection refused: connect
+        </pre>
+        </p>
+        
+        <p>
+        Odstran?n? t?to chyby vy?aduje ru?n? nastaven? IP adresy stroje, 
+        kde Server b???. To lze prov?st p?i spou?t?n? Serveru n?sledovn?:
+        <pre>
+        java -Djava.rmi.server.hostname=Va?eIP -jar plantlore-server.jar
+        </pre>
+        a pokud nepou??v?te dodan? jar archiv:
+        <pre>
+        java -Djava.rmi.server.hostname=Va?eIP net.sf.plantlore.server.Plantlore
+        </pre>
+        </p>
+        
   </body>
 </html>

Modified: trunk/src/net/sf/plantlore/help/en/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-19 08:54:00 UTC (rev 839)
+++ trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-19 09:18:37 UTC (rev 840)
@@ -43,7 +43,7 @@
 
 
 	<p>
-        The Server can be started on the local computer only because of security
+        The Server can be started only on the local computer - because of security
         reasons.
         You can specify following parameters:
 	</p>
@@ -140,7 +140,7 @@
 			</td>
 			<td>
                                 Database engines can be contacted on a certain port.
-                                Every databse engine may have a different port number
+                            Every database engine may have a different port number.
                                 In order to know where to contact the database engine,
                                 you have to supply the port where the database engine listens.
                                 
@@ -253,7 +253,7 @@
 
 	<p>
         The Administrator of the Server can obtain the information about currently
-        connected clints, and can switch off the Server.
+        connected clients, and can switch off the Server.
 	</p>
 
 	<p>
@@ -265,31 +265,67 @@
         currently connected clients. The Administrator can:
 	<ul>
 		<li><b>Refresh the list</b>.
-                Updates the list of connected users.
+                Update the list of connected users.
 		</li>
 		<li><b>Kick a User</b>.
-                Disconnects the selected client from the Server
+                Disconnect the selected client from the Server
 		All operations in progress are cancelled. 
                 Kick does not prevent the User from re-connect; His IP address
                 will not be blocked as it may prevent connection from other
                 computers that share the same connection point.
 		<br/>
-                Kick allows you to disconnect clients that use more connectins
-                than necessary thus blockign other Users with the "same" IP address.
+                Kick allows you to disconnect clients that use more connections
+                than necessary thus blocking other Users with the "same" IP address.
 		<br/>
                 If you wish to deny the access to the User 
                 (ban Him from using the database), you should disable
                 His account in <a href="./user.html">User manager</a>.
 		</li>
 		<li><b>Shutdown the Server</b>.
-                Stops the Server, disconnecting all clients immeditely.
+                Stop the Server, disconnecting all clients immeditely.
 		</li>
 		<li><b>Hide the window</b>.
-                Hides the window but keeps the Server online (running).
+                Hide the window but keep the Server online (running).
                 If you seek to administrate the Server again, you must
                 connect to it as described in the Section 2.
 		</li>
 	</ul>
 	</p>  
+        
+        
+        <h2>4. Troubleshooting</h2>
+
+	<p>
+        Sometimes the Plantlore Server is unable to auto-detect the IP address
+        of the computer where it runs, although the detection routine is
+        quite inquisitive.
+        It usually happens on computers
+        with two different network interfaces or in Linux
+        (mostly if /etc/hosts contains invalid information).
+	</p>
+        
+        <p>
+        JRE requires the "java.rmi.server.hostname" to be set properly, 
+        otherwise the RMI mechanism will fail when someone will try to 
+        contact the Server remotely. The typical message is:
+        <pre>
+        java.rmi.ConnectException: Connection refused to host: 127.0.0.1; 
+        nested exception is:
+           java.net.ConnectException: Connection refused: connect
+        </pre>
+        </p>
+        
+        <p>
+        In order to make the Server work, you must specify the IP address
+        yourself. You can do this when starting the Server:
+        <pre>
+        java -Djava.rmi.server.hostname=YourIP -jar plantlore-server.jar
+        </pre>
+        or (if you are not using the jar archive):
+        <pre>
+        java -Djava.rmi.server.hostname=YourIP net.sf.plantlore.server.Plantlore
+        </pre>
+        </p>
+        
   </body>
 </html>



From krater at mail.berlios.de  Tue Sep 19 11:26:33 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 19 Sep 2006 11:26:33 +0200
Subject: [Plantlore-dev] r841 - trunk/src/net/sf/plantlore/server/tools
Message-ID: <200609190926.k8J9QX4F018712@sheep.berlios.de>

Author: krater
Date: 2006-09-19 11:26:32 +0200 (Tue, 19 Sep 2006)
New Revision: 841

Modified:
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
Switch java.rmi.server.hostname auto-detection off when the User supplied his own valid value (so as not to undermine His efforts).

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-19 09:18:37 UTC (rev 840)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-09-19 09:26:32 UTC (rev 841)
@@ -93,6 +93,12 @@
 	
 	
 	public static String setHostName() {
+		// Skip the autodetection if the User supplied another value
+		// so as not to undermine His effort.
+		String hostnameFromUser = System.getProperty(PROPERTY_HOSTNAME);
+		if( hostnameFromUser != null && !"127.0.0.1".equals(hostnameFromUser) )
+			return hostnameFromUser;
+		
 		try {
 			// Obtain the IP of this host.
 			InetAddress address = InetAddress.getLocalHost();



From kovo at mail.berlios.de  Tue Sep 19 11:31:06 2006
From: kovo at mail.berlios.de (kovo at mail.berlios.de)
Date: Tue, 19 Sep 2006 11:31:06 +0200
Subject: [Plantlore-dev] r842 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609190931.k8J9V6Sl019060@sheep.berlios.de>

Author: kovo
Date: 2006-09-19 11:31:06 +0200 (Tue, 19 Sep 2006)
New Revision: 842

Modified:
   trunk/src/net/sf/plantlore/help/en/html/login.html
Log:
English version of login help, only partially translated

Modified: trunk/src/net/sf/plantlore/help/en/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-19 09:26:32 UTC (rev 841)
+++ trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-19 09:31:06 UTC (rev 842)
@@ -3,101 +3,101 @@
 <html>
   <head>
     <meta http-equiv="Content-type" content="text/html; charset=utf-8" />    
-    <title>P?ipojov?n? k datab?zi</title>
+    <title>Database login</title>
   </head>
   <body>
-  <h1>P?ipojov?n? k datab?zi a Odhla?ov?n? od datab?ze</h1>
+  <h1>Database login and logout</h1>
 
 
   	<p>
-	P?ed zapo?et?m pr?ce s Plantlore je zapot?eb? se p?ihl?sit k datab?zi, se kterou chcete pracovat.
+	Before you start working with Plantlore, it is necessary to login to the database you would like to work with
 	</p>
 
 
-	<h2>Obsah</h2>
+	<h2>Contents</h2>
 
 	<p>
 	<ol>
-		<li>Proces p?ipojen? k datab?zi</li>
-		<li>Vytv??en? z?znam? o datab?zi</li>
-		<li>?prava a maz?n? z?znam? o datab?zi</li>
-		<li>Nej?ast?j?? probl?my p?i p?ipojov?n?</li>
-		<li>Odhl??en? od datab?ze</li>
-		<li>Obnova ztracen?ho p?ipojen?</li>
+		<li>The login process</li>
+		<li>Creating database records</li>
+		<li>Modifying and deleting database records</li>
+		<li>Common problems with login</li>
+		<li>Logout</li>
+		<li>Reconnecting after the connection was lost</li>
 	</ol>
 	</p>
 
 
-	<h2>1. Proces p?ipojen? k datab?zi</h2>
+	<h2>1. the login process</h2>
 
 	<p>
-	P?ihl??en? k datab?zi, kde jsou Va?e data ulo?ena, prob?h? ve dvou kroc?ch.
+	Database login is composed of two main parts
 	</p>
 
-	<h3>1.1. V?b?r datab?ze</h3>
+	<h3>1.1. Selecting the database</h3>
 	
 	<p>
 	<img src="picture/LoginDBSelection.png" alt="Volba datab?ze.">
 	</p>
 
 	<p>
-	Po instalaci Plantlore je k disposici jedna datab?ze pojmenovan? "Uk?zkov? datab?ze".
-	Tato datab?ze neobsahuje ??dn? n?lezov? data a je p?ipravena pro zapo?et? pr?ce.
-	Neobsahuje-li seznam datab?z? ??dn? z?znam, budete jej muset vytvo?it - o tom pojedn?v?
-	druh? ??st t?to n?pov?dy.
-	</p>
-
+	After installing Plantlore you have two options depending on how you would like to use Plantlore:
+        <ul>
+            <li><b>Create new database on your system</b> - You can create new database using menu 
+                Data|Create new database. See Create database section for further information on how 
+                to create new database.
+            </li>
+            <li><b>Connect to remote database</b> - In this case you need to create new database record
+                with information about the remote Plantlore server. Ask your Plantlore server administrator 
+                for necessary data. Information on creating new database records is included in this help section.
+            </li>
+        </ul>
+        
 	<p>
-	Po jist? dob? pou??v?n? Plantlore m??e v?? seznam datab?z? vypadat podobn? jako ten na obr?zku.
-	Plantlore automaticky p?edvol? tu datab?zi, kterou jste zvolili p?i posledn?m p?ihla?ov?n?.
-	Vyberte jednu z datab?z? v seznamu a stiskn?te tla??tko "Pokra?uj".
+	After some time your list of databases can be similar to the one at the picture. Plantlore will automatically 
+        select database you've chosen during the previous session. Choose one of the databases from the list and press
+        "Continue" button.
 	</p>
 
 
-	<h3>1.2. Autentifikace - prokazov?n? toto?nosti</h3>
+	<h3>1.2. Authentication</h3>
 
 	<p>
-	Pro p?ihl??en? k datab?zi je pot?eba se prok?zat p?ihla?ovac?mi ?daji 
-	- u?ivatelsk?m jm?nem a heslem. 
+	For gaining access to the database you have to provide your username and password in order to authenticate.
+        If you are logging in for the first time, use login name and password you have chosen when installing Plantlore.
 
-	Pokud se p?ihla?ujete poprv?, zadejte p?ihla?ovac? ?daje, 
-	kter? jste pou?ili p?i instalaci Plantlore.
-
-	Nov? u?ivatelsk? jm?no a heslo sm? z bezpe?nostn?ch d?vod? p?id?lit pouze administr?tor datab?ze.
-	?asto i zku?en? u?ivatel? pou??vaj? velmi slab? hesla, proto je jejich p?id?lov?n?
-	p?enech?no jemu.
-	</p>
+        For security reasons, new user name and password can only be assigned by an administrator. Weak passwordsa are often
+        used even by experienced users, therefore the assignment of passwords is left to administrator.
+      	</p>
 	
 	<p>
 	<img src="picture/LoginAuthentication.png" alt="Vkl?d?n? p?ihla?ovac?ch ?daj?.">
 	</p>
 
 	<p>
-	Plantlore si pamatuje n?kolik posledn?ch u?ivatelsk?ch jmen vkl?dan?ch p?i p?ihl??ov?n?;
-	m??ete vybrat jedno z p?ipraven?ho seznamu, nebo zadat jin? u?ivatelsk? jm?no.
-	Hesla Plantlore neukl?d? a automaticky je nikdy nenab?z?.
-	Po zad?n? ?daj? stiskn?te tla??tko "P?ihl?sit". 
+        Plantlore remembers several recently used login names; you can choose one from the list or
+        provide a different one. Plantlore doesn't save passwords and doesn't offer them automatically.
+        After you provide the authentication data, press "Login" button.
 	</p>
 
 	<p>
-	Stiskem tla??tka "P?ihl?sit" se Plantlore pokus? p?ipojit k vybran? datab?zi se zadan?mi
-	p?ihla?ovac?mi ?daji. P?ipojen? m??e (zejm?na pokud se p?ipojujete ke vzd?len? datab?zi)
-	trvat del?? dobu.
+        After pressing the "Login" button, Plantlore will try to connect to the selected database
+        using your authentication data. The connection can take some time, especially if you are connecting
+        to a remote database.
 	</p>
 
 
 	<p>
-	Pokud se p?ihl??en? z n?jak?ho d?vodu nezda??, budete o tom informov?ni kr?tkou zpr?vou.
-	V opa?n?m p??pad? Plantlore zobraz? z?kladn? <a href="./overview.html">P?ehled</a>.
+	In case the login fails for some reason, you will be notified by a short message. Otherwise Plantlore 
+        will display basic <a href="./overview.html">Overview</a>.
 	</p>
 
 
-	<h2 id="AddDBInfo">2. Vytv??en? z?znam? o datab?z?ch</h2>
+	<h2 id="AddDBInfo">2. creating database records</h2>
 
 	<p>
-	Chcete-li se p?ipojit k jin? datab?zi, 
-	kterou jste sami vytvo?ili nebo kterou vytvo?il n?kdo jin? na sv?m po??ta?i,
-	mus?te vytvo?it nov? z?znam, kter? popisuje, kde se datab?ze nach?z? a jak je nastavena.
+	If yoy wish to connect to a different database than the one you (or someone else) created on your computer,
+        you have to create new record describing the database, its location and settings.
 	</p>
 
 	<p>



From fraktalek at mail.berlios.de  Tue Sep 19 11:56:05 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 11:56:05 +0200
Subject: [Plantlore-dev] r843 - in trunk/src/net/sf/plantlore/client: . login
Message-ID: <200609190956.k8J9u5pn021239@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 11:56:04 +0200 (Tue, 19 Sep 2006)
New Revision: 843

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
   trunk/src/net/sf/plantlore/client/login/Login.java
Log:
A try to solve the problem that overview doesn't load all the
occurrences after login sometimes.



Modified: trunk/src/net/sf/plantlore/client/AppCoreCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-19 09:31:06 UTC (rev 842)
+++ trunk/src/net/sf/plantlore/client/AppCoreCtrl.java	2006-09-19 09:56:04 UTC (rev 843)
@@ -1843,6 +1843,8 @@
                                 view.getSBM().display(L10n.getString("Message.LoadingOverviewData"));
                                 searchModel.clearAndNotify();
                                 
+                                //Login's ConnectionTask will request a refresh in it's PostTaskAction
+                                /*
                                 try {
                                     searchModel.constructQuery();
                                 } catch (RemoteException ex) {
@@ -1851,7 +1853,7 @@
                                 } catch (DBLayerException ex) {
                                     DefaultExceptionHandler.handle(view, ex);
                                     return;
-                                }
+                                }*/
 
                                 view.getSBM().displayDefaultText();
 
@@ -1889,6 +1891,17 @@
                                 if (metadataManagerModel != null )
                                         metadataManagerModel.setDBLayer( dblayer );							
                         }//if
+                        
+                        if (parameter != null && parameter.equals("REFRESH_PLEASE")) {
+                            //we are notified from a Task (Login's ConnectionTask) therefore
+                            //it would have no effect to try to invoke the refreshAction
+                            //in this thread. And actions are usually invoked from the EDT anyway.
+                            SwingUtilities.invokeLater(new Runnable() {
+                                public void run() {
+                                    refreshAction.actionPerformed(null);
+                                }
+                            });
+                        }
                     }//run()
 	}//DatabaseChange
 

Modified: trunk/src/net/sf/plantlore/client/login/Login.java
===================================================================
--- trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-19 09:31:06 UTC (rev 842)
+++ trunk/src/net/sf/plantlore/client/login/Login.java	2006-09-19 09:56:04 UTC (rev 843)
@@ -6,6 +6,7 @@
 import java.util.Observable;
 import net.sf.plantlore.client.MainConfig;
 import net.sf.plantlore.common.DefaultExceptionHandler;
+import net.sf.plantlore.common.PostTaskAction;
 import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.exception.DBLayerException;
 import net.sf.plantlore.common.record.Record;
@@ -238,7 +239,11 @@
 		logger.debug("Observer notification finished.");
 	}
 	
-
+        private void askForRefresh() {
+            logger.debug("Asking for refresh.");
+            setChanged();
+            notifyObservers("REFRESH_PLEASE");
+        }
 	
 	/**
 	 * Create a task that will build the connection to the selected database. 
@@ -263,8 +268,10 @@
 		selected.promoteUser(name);
 		// Save the current state.
 		save();
-		
-		return lastConnectionTask = new ConnectionTask( selected.clone(), name, password );
+                
+		lastConnectionTask = new ConnectionTask( selected.clone(), name, password );
+                                
+		return lastConnectionTask;
 
 	}
 	
@@ -296,6 +303,11 @@
 			this.dbinfo = dbinfo;
 			this.name = name;
 			this.password = password;
+                        setPostTaskAction(new PostTaskAction() {
+                            public void afterStopped(Object value) {
+                                askForRefresh();
+                            }
+                        });
 		}
 		
 				



From krater at mail.berlios.de  Tue Sep 19 12:20:59 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 19 Sep 2006 12:20:59 +0200
Subject: [Plantlore-dev] r844 - trunk/src/net/sf/plantlore/help/en/html
Message-ID: <200609191020.k8JAKxI7023116@sheep.berlios.de>

Author: krater
Date: 2006-09-19 12:20:58 +0200 (Tue, 19 Sep 2006)
New Revision: 844

Modified:
   trunk/src/net/sf/plantlore/help/en/html/login.html
   trunk/src/net/sf/plantlore/help/en/html/server.html
Log:


Modified: trunk/src/net/sf/plantlore/help/en/html/login.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-19 09:56:04 UTC (rev 843)
+++ trunk/src/net/sf/plantlore/help/en/html/login.html	2006-09-19 10:20:58 UTC (rev 844)
@@ -10,10 +10,11 @@
 
 
   	<p>
-	Before you start working with Plantlore, it is necessary to login to the database you would like to work with
+	Before you start working with Plantlore, 
+        it is necessary to connect to the database you would like to work with.
 	</p>
 
-
+        <!--
 	<h2>Contents</h2>
 
 	<p>
@@ -26,344 +27,395 @@
 		<li>Reconnecting after the connection was lost</li>
 	</ol>
 	</p>
+        -->
 
 
-	<h2>1. the login process</h2>
+	<h2>1. The connection process</h2>
 
 	<p>
-	Database login is composed of two main parts
+	The process has two steps:
 	</p>
 
 	<h3>1.1. Selecting the database</h3>
 	
 	<p>
-	<img src="picture/LoginDBSelection.png" alt="Volba datab?ze.">
+	<img src="picture/LoginDBSelection.png" alt="Database Selection.">
 	</p>
 
 	<p>
-	After installing Plantlore you have two options depending on how you would like to use Plantlore:
+	After installing Plantlore you have two options 
+        depending on how you would like to use Plantlore:
         <ul>
             <li><b>Create new database on your system</b> - You can create new database using menu 
                 Data|Create new database. See Create database section for further information on how 
                 to create new database.
             </li>
-            <li><b>Connect to remote database</b> - In this case you need to create new database record
-                with information about the remote Plantlore server. Ask your Plantlore server administrator 
-                for necessary data. Information on creating new database records is included in this help section.
+            <li><b>Connect to an already existing database</b> - In this case you need to create new database record
+                with information about the database. 
+                Information on creating new database records is included in this help section.
             </li>
         </ul>
         
 	<p>
-	After some time your list of databases can be similar to the one at the picture. Plantlore will automatically 
-        select database you've chosen during the previous session. Choose one of the databases from the list and press
-        "Continue" button.
+	After some time your list of databases can be similar to the one at the picture. 
+        Plantlore will automatically select database you've 
+        chosen during the previous session. 
+        Choose one of the databases from the list and press
+        the Continue button.
 	</p>
 
 
 	<h3>1.2. Authentication</h3>
 
 	<p>
-	For gaining access to the database you have to provide your username and password in order to authenticate.
-        If you are logging in for the first time, use login name and password you have chosen when installing Plantlore.
+	For gaining access to the database you have to provide your 
+        username and password in order to authenticate.
+        If you are logging in for the first time, 
+        use login name and password you have chosen when installing Plantlore.
 
-        For security reasons, new user name and password can only be assigned by an administrator. Weak passwordsa are often
-        used even by experienced users, therefore the assignment of passwords is left to administrator.
+        For security reasons, new user name and password can only be assigned 
+        by an Administrator. Weak passwords are often
+        used even by experienced users, therefore the assignment 
+        of passwords is left to the Administrator.
       	</p>
 	
 	<p>
-	<img src="picture/LoginAuthentication.png" alt="Vkl?d?n? p?ihla?ovac?ch ?daj?.">
+	<img src="picture/LoginAuthentication.png" alt="Specifying the login data.">
 	</p>
 
 	<p>
-        Plantlore remembers several recently used login names; you can choose one from the list or
-        provide a different one. Plantlore doesn't save passwords and doesn't offer them automatically.
-        After you provide the authentication data, press "Login" button.
+        Plantlore remembers several recently used login names; you can choose 
+        one from the list or
+        provide a different one. Plantlore doesn't save passwords 
+        and doesn't offer them automatically.
+        After you provide the authentication data, press the Login button.
 	</p>
 
 	<p>
-        After pressing the "Login" button, Plantlore will try to connect to the selected database
-        using your authentication data. The connection can take some time, especially if you are connecting
+        After pressing the Login button, Plantlore will try to connect to 
+        the selected database
+        using your authentication data. The connection can take some time, 
+        especially if you are connecting
         to a remote database.
 	</p>
 
 
 	<p>
-	In case the login fails for some reason, you will be notified by a short message. Otherwise Plantlore 
-        will display basic <a href="./overview.html">Overview</a>.
+	In case the login fails for some reason, you will be 
+        notified by a short message. Otherwise Plantlore 
+        will display the basic <a href="./overview.html">Overview</a>.
 	</p>
 
 
 	<h2 id="AddDBInfo">2. creating database records</h2>
 
 	<p>
-	If yoy wish to connect to a different database than the one you (or someone else) created on your computer,
-        you have to create new record describing the database, its location and settings.
+	If you wish to connect to a different database than the one you 
+        (or someone else) created on your computer,
+        you have to create new record describing the database, 
+        its location and settings.
 	</p>
 
 	<p>
-	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho
-	tla??tka my?i. Vyberte polo?ku "P?idat" a klikn?te na ni.
+        The context menu allowing you to add, edit or delete a record 
+        is accessible via the right mouse click.
+	Choose Add record and click on it.
 	</p>
 
 	<p>
-	<img src="picture/LoginAddMenu.png" alt="P?id?n? nov?ho z?znamu.">
+	<img src="picture/LoginAddMenu.png" alt="Adding new Record.">
 	</p>
 
 	<p>
-	P?id?n? nov?ho z?znamu pro p?ipojen? k datab?zi je rozd?leno na dv? ??sti, 
-	jim? odpov?daj? dv? z?lo?ky na dialogu. 
+        The database description is divided into two parts.
 	<ul>
 		<li>
-		Prvn? z nich je <b>p??m? p?ipojen?</b>, t?? lok?ln? p?ipojen?. 
-		P??m? p?ipojen? k datab?zi lze pou??t pouze v p??pad?,
-		?e vytvo?en? datab?ze se nach?z? v datab?zov?m stroji (database engine), kter? b??? na
-		tomto po??ta?i, tzv. lok?ln?. P??m? p?ipojen? vy?aduje pon?kud odli?n? parametry ne? 
-		p?ipojen? ke vzd?len? datab?zi. V?hodou p??m?ho p?ipojen? je jeho rychlost - komunikace
-		s datab?z? se nemus? nijak upravovat pro p?enos po s?ti.
+                The first option is the
+                
+		<b>Direct Connection</b>, also Local Connection. 
+                The direct connection to the database can be used in case
+                the database is located in a database engine that runs on the
+                same computer as the client.
+                
+                The most visible advantage of the local connection is its speed -
+                the communication with the database does not have to be processed
+                for the network transfer.
 		</li>
 		<li>
-		Druh? mo?nost je tzv. <b>vzd?len? p?ipojen?</b>, p?ipojen? ke vzd?len? datab?zi.
-		Vzd?len? datab?ze se typicky nach?z? v datab?zov?m stroji (database engine), kter? je
-		spu?t?n na jin?m po??ta?i v s?ti. Pomoc? tohoto p?ipojen? je mo?n? pracovat s datab?z?
-		"na d?lku". Nev?hodou je zpomalen? dan? jednak propustnost? datov? linky a jednak 
-		nutnost? speci?ln? upravovat p?en??en? data kv?li p?enosu po s?ti. 
+                The second option is the 
+		<b>Remote Connection</b>.
+                A remote database is stored within a database engine that runs
+                on a different computer in the network. 
+                Thus you can work with a database remotely.
+                
+                The price you have to pay is that the data must be processed
+                in order to be able to send them via the network. Also the network
+                connection has its limits and work with the database remotely
+                may be painfully slow if the capacity of the network connection
+                is small.
 		</li>
 	</ul>
 	</p>
 
 
-	<h3>A. P??m? p?ipojen? k datab?zi (lok?ln? p?ipojen?)</h3>
+	<h3>A. Direct Connection</h3>
 
 	<p>
-	Parametry popisuj?c? p??m? p?ipojen?:
+        The direct connection requires the following parameters:
 	<table>
 		<tr>
-			<th>N?zev</th>
-			<th>V?znam</th>
+			<th>Name</th>
+			<th>Meaning</th>
 		</tr>
 		<tr>
 			<td>Alias</td>
 			<td>
-				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
-				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
-				nap??klad: "Dom?c? datab?ze", "Projekt mapov?n? ?esk?ho st?edoho??".
+                                Alias is a short string that will be presented to the User.
+                                It allows fast and simple recongition of the database by the User.
+                                The string should be brief.
 			</td>
 		</tr>
 		<tr>
-			<td>Datab?zov? stroj (engine)</td>
+			<td>Database engine</td>
 			<td>
-				Existuje n?kolik datab?zov?ch stroj? (database engine), kter? umo??uj? snadnou
-				pr?ci s datab?zemi, tabulkami, u?ivateli, dotazy a daty.
-				Ka?d? datab?zov? stroj m??e obsahovat n?kolik r?zn? pojmenovan?ch datab?z?
-				s r?znou strukturou a s r?zn?m obsahem. Mezi nejzn?m?j?? datab?zov? stroje
-				pat?? Oracle, MSSQL, MySQL, Postgre a Firebird.
-				Plantlore podporuje pr?ci s r?zn?mi datab?zov?mi stroji,
-				ale je nutn? p?esn? specifikovat, o kter? se jedn?, 
-				aby s n?m bylo mo?n? bezchybn? komunikovat. Plantlore je standardn? dod?v?na
-				s Postgre. Aktu?ln? podporovan? DB stroje jsou seps?ny v rozbalovac?
-				nab?dce, ale je mo?n? specifikovat i jin?.
+				There is a wide variety of database engines that
+                                allow you to work with databases, tables, users, 
+                                queries and data very easily.
+                                Every database engine can store several different
+                                databases - databases with different structure and
+                                contents. The best known database engines are
+                                Oracle, MSSQL, MySQL, Postgre and Firebird.
+                                Plantlore can work with some of these database
+                                engines, but it is necessary to specify with
+                                which it should work so that the Program can communicate
+                                with it properly. Plantlore is delivered 
+                                and tested with Postgre.
 			</td>
 		</tr>
 		<tr>
-			<td>Identifik?tor DB</td>
+			<td>DB Identifier</td>
 			<td>
-				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
-				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
-				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor (jm?no)
-				datab?ze, se kterou chce pracovat.
+                                The database engine may contain several different 
+                                databases with different structure and contents.
+                                Databases that Plantlore works with have their own
+                                specific structure. So as to know to which database
+                                you would like to connect, you must specify 
+                                its identifier within the database engine.
+                                The identifier is usually a short name.
 			</td>
 		</tr>
 		<tr>
-			<td>Port DB</td>
+			<td>DB Port</td>
 			<td>
-				Datab?zov? stroje umo??uj? p?ipojen? pouze p?es tzv. port. Ka?d? datab?zov?
-				stroj m? tento port jin? a nav?c jej lze snadno zm?nit. Aby Plantlore v?d?l,
-				kde m? datab?zov? stroj kontaktovat, mus? zn?t port, na kter?m stroj naslouch?.
-				Port je ??slo v rozsahu 0 a? 65.535, p?i?em? je b??n?, ?e datab?zov? stroje
-				vyu??vaj? porty v rozsahu 1.024 a v??e. Nap??klad standardn? port datab?zov?ho
-				stroje Postgre je 5432.
+				Database engines can be contacted on a certain port.
+                                Every database engine may have a different port number.
+                                In order to know where to contact the database engine,
+                                you have to supply the port where the database engine listens.
+                                
+                                Port is a number from 0 to 65.535 and ports above
+                                1.024 are commonly used. Lower ports are usually
+                                reserved for well known services (such as FTP, HTTP, etc.).
+                                
+                                The default port of PostgreSQL database engine is 5432.
 			</td>
 		</tr>
 		<tr>
-			<td>Parametr</td>
+			<td>Parameter</td>
 			<td>
-				Datab?zov? stroj m??e b?t pot?eba je?t? nakonfigurovat n?jak?m specifick?m
-				zp?sobem. N?kter? stroje nap??klad vy?aduj? explicitn? nastaven? k?dov?n?
-				znak?. Parametr slou??
-				pro spr?vn? nastaven? dodate?n?ch parametr? p?ipojen? k datab?zov?mu stroji.
-				P?ipojen? k Postgre ??dn? parametr nevy?aduje.
+				The database engine may require some additional settings.
+                                For instance you have to set the encoding explicitly.
+                                This parameter is used to the proper additional configuration
+                                of the database connection.
+                                
+                                Postgre does not require any additional parameter.
 				<br/>
-				<i>Odborn?: parametr je hodnota p?ed?van? v p?ipojovac?m JDBC ?et?zci za "?".</i>
+				<i>Note: the parameter is a value passed in the JDBC connections
+                                string right after the exclamation mark "?"</i>
 			</td>
 		</tr>
 	</table>
 	</p>
 
 	<p>
-	Na uk?zku uve?me, jak by vypadalo lok?ln? p?ipojen? k datab?zi nazvan? "plantlore",
-	kter? je ulo?ena v datab?zov?m stroji "Postgre", kter? naslouch? na portu "5432".
+        In the picture there you can see how the local connection may look like.
+        We are connecting to the database called "plantloreOK"
+        that is stored within the database engine
+	"PostgreSQL" that listens on the port "5432".
+        There is no additional paramater.
 	</p>
 
 	<p>
-	<img src="picture/LoginDBDirectConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	<img src="picture/LoginDBDirectConnection.png" alt="Adding new record.">
 	</p>
 
 
-	<h3>B. Vzd?len? p?ipojen? k datab?zi</h3>
+	<h3>B. Remote Connection</h3>
 
 	<p>
-	Parametry popisuj?c? vzd?len? p?ipojen?:
+	Parameters required for the remote connection - to the remote Plantlore
+        Server in this case. It is the Server that will mediate the creation
+        of the connection:
 	<table>
 		<tr>
-			<th>N?zev</th>
-			<th>V?znam</th>
+			<th>Name</th>
+			<th>Meaning</th>
 		</tr>
 		<tr>
 			<td>Alias</td>
 			<td>
-				Alias je kr?tk? ?et?zec, kter? umo??uje snadnou identifikaci datab?ze u?ivatelem.
-				Tento ?et?zec je zobrazov?n v seznamu datab?z?. M?l by b?t kr?tk? a v?sti?n?,
-				nap??klad: "Ofici?ln? datab?ze Jiho?esk? pobo?ky ?BS".
+				Alias is a short string that will be presented to the User.
+                                It allows fast and simple recongition of the database by the User.
+                                The string should be brief.
 			</td>
 		</tr>
 		<tr>
 			<td>Host</td>
 			<td>
-				Datab?zov? stroj obsahuj?c? datab?zi, k n?? se chceme p?ipojit, b??? na jin?m
-				po??ta?i v s?ti. Tento parametr identifikuje tento po??ta? a to bu? podle
-				jeho jm?na nebo IP adresy. Ka?d? po??ta? p?ipojen? k s?ti mus? m?t
-				svou vlastn? unik?tn? IP adresu, podle n?? je rozpozn?n. IP adresa je 
-				nej?ast?ji ?tve?ice ??sel odd?len? te?kami, nap?. "192.168.0.247".
-				N?kter? po??ta?e maj? krom? IP adresy p?id?lena i jm?na, nap?. 
-				"data.domacisit.cz". C?lov? po??ta? lze identifikovat 
-				ob?ma zp?soby.
+				This parameter identifies the computer where the Server
+                                is running - either by its name or IP address.
+                                Every computer connected to a network must have its
+                                own unique IP address so that it can be identified
+                                in the network.
+                                IP address is a sequence of four numbers separated with
+                                dots, for instance "192.168.0.247". Some computers may have
+                                also a name, such as "data.home.net".
+                                
+                                You can use both ways to identify the remote computer.
 			</td>
 		</tr>
 		<tr>
 			<td>Port</td>
 			<td>
-				Aby bylo mo?n? se p?ipojit ke vzd?len?mu datab?zov?mu stroji, je nutn?
-				na uveden?m vzd?len?m po??ta?i kontaktovat 
-				<a href="./server.html">Plantlore Server</a>, co? je speci?ln?
-				aplikace, kter? m? za ?kol zprost?edkov?vat p?ipojen? vzd?len?m klient?m a
-				dohl??et na po?et p?ipojen?ch u?ivatel?. Tato slu?ba mus? b?t p??stupn?
-				na vzd?len?m po??ta?i, kde se nach?z? i vzd?len? datab?zov? stroj, 
-				a naslouch? na n?jak?m portu. Standardn? port, na kter?m je tato slu?ba
-				dostupn?, je 1099.
+				The port specifies where the remote Server listens.
+                                
+                                Port is a number from 0 to 65.535 and ports above
+                                1.024 are commonly used. Lower ports are usually
+                                reserved for well known services (such as FTP, HTTP, etc.).
+
+				The default port is 1099.
 			</td>
 		</tr>
 		<tr>
-			<td>Identifik?tor DB</td>
+			<td>DB identifier</td>
 			<td>
-				Datab?zov? stroj m??e obsahovat n?kolik r?zn?ch datab?z? s r?znou strukturou
-				a obsahem. Datab?ze Plantlore maj? vlastn? specifickou strukturu. 
-				Pro spr?vn? p?ipojen? je nutn? vyplnit identifik?tor
-				datab?ze, se kterou chce pracovat.
+				The database engine may contain several different 
+                                databases with different structure and contents.
+                                Databases that Plantlore works with have their own
+                                specific structure. So as to know to which database
+                                you would like to connect, you must specify 
+                                its identifier within the database engine.
+                                The identifier is usually a short name.
 			</td>
 		</tr>
 	</table>
 	</p>
 	
 	<p>
-	Na uk?zku uve?me, jak by vypadalo nastaven? pro vzd?len? p?ipojen? k datab?zi nazvan? "plantlore",
-	kter? je ulo?ena v datab?zov?m stroji, 
-	kter? se nach?z? na po??ta?i s adresou "192.168.0.247", 
-	a Plantlore Server naslouch? na portu "1099".
+        Let us see how the remote connection parameters may look like.
+        In the picture there you can see that we are connecting to a remote database
+	named  "plantlore" that is stored within a database engine that is located
+	on a computer with IP address "86.42.59.39" and the
+	Plantlore Server listens on the port "1099".
 	</p>
 
 	<p>
-	<img src="picture/LoginDBRemoteConnection.png" alt="P?id?n? nov?ho z?znamu.">
+	<img src="picture/LoginDBRemoteConnection.png" alt="Adding a new record.">
 	</p>
 
 
 	<p>
 	<b>
-		P?id?v?te-li nov? z?znam, ??dn? nov? datab?ze se nikde nevytv???; vytv??? se pouze
-		reference (odkaz) na n?jakou existuj?c? datab?zi.
+            If you add a new record, no database is created; merely a reference to
+            an already existing database is created.
 	</b>
 	</p>
 
 
 
-	<h2>3. ?prava a maz?n? z?znam? o datab?zi</h2>
+	<h2>3. Editing and Deleting records</h2>
 
 	<p>
-	V seznamu datab?z? ozna?te z?znam, kter? chcete upravit nebo smazat.
-	Kontextov? menu pro vytvo?en?, upraven? nebo vymaz?n? z?znamu lze vyvolat stiskem prav?ho tla??tka my?i. 
-	Vyberte polo?ku "Editovat" nebo "Odstranit" a klikn?te na ni.
+        In the list of databases select the record you wish to update or delete.
+        Use the context menu (accessible via the right mouse click) and 
+        select Edit or Remove and click on it.
 	</p>
 
 	<p>
-	<img src="picture/LoginEditMenu.png" alt="?prava st?vaj?c?ho z?znamu.">
+	<img src="picture/LoginEditMenu.png" alt="Editing an existing record.">
 	</p>
 
 	<p>
-	?prava z?znam? je shodn? s dialogem pro p?id?n? z?znamu, ale obsahuje p?edvypln?n? hodnoty.
-	Detailn? popis lze naj?t v p?edch?zej?c? ??sti.
+        If you are updating (editing) an existing record, the dialog is the
+        same as the Add dialog, but this one contains pre-filled values.
+        The detailed description of all parameters is in the previous section.
 	</p>
 
 	<p>
-	Odstran?n? z?znamu dal?? nastaven? nem?.
+	There are no additional settings when deleting a record.
 	</p>
 
 	<p>
-	<img src="picture/LoginDeleteMenu.png" alt="Vymaz?n? existuj?c?ho z?znamu.">
+	<img src="picture/LoginDeleteMenu.png" alt="Deleting an existing record.">
 	</p>
 
 
 	<p>
 	<b>
-		Ma?ete-li existuj?c? z?znam, ??dn? datab?ze se nikde nema?e; ru?? se pouze
-		reference (odkaz) na n?jakou existuj?c? datab?zi.
+            If you delete an existing record, no database is actually delete.
+            It is merely the reference to some database that is lost.
 	</b>
 	</p>
 
 
 
-	<h2>4. Nej?ast?j?? probl?my p?i p?ipojov?n?</h2>
+	<h2>4. Most common mistakes</h2>
 
 	<p>
-	Nej?ast?j?? probl?my p?i p?ipojov?n? jsou tyto:
+        The most common problems encountered during the login process are:
 	<ol>
 		<li>
-		Nespr?vn? vypln?n? p?ihla?ovac? ?daje - u?ivatelsk? jm?no nebo ?patn? zadan? heslo.
-		Ov??te, zda jste spr?vn? zadali oba ?daje, p??padn? zda m?te vytvo?en?
-		odpov?daj?c? u?ivatelsk? ??et v datab?zi, k n?? se p?ipojujete.
+                Incorrect authentication information. Either the username does not
+                exist or the password is wrong. Please verify that both
+                the account name (user name) exists and the password is correct.
 		</li>
 		<li>
-		Nespr?vn? zadan? parametry pro p??m? nebo vzd?len? p?ipojen? k datab?zi.
-		Ov??te, zda jsou vypln?ny v?echny polo?ky spr?vn? a zda obsahuj? aktu?ln? data. 
-		Nap?. mohlo doj?t ke zm?n? IP adresy po??ta?e, ke kter?mu se p?ihla?ujete, nebo jste
-		ud?lali p?eklep p?i zad?v?n? identifik?toru datab?ze.
+                Incorrect parameters for direct or remote connection. 
+                Please make sure that all necessary parameters are specified
+                and that contain up-to-date data.
+                For instance the IP address of the computer might have changed
+                or you might have misspelled the database identifier.
 		</li>
 		<li>
-		Vypnut? datab?zov? stroj nebo Plantlore Server.
-		Ov??te, ?e datab?zov? stroj je zapnut?, resp. se ujist?te, ?e na vzd?len?m po??ta?i
-		je spu?t?n Plantlore Server.
+                The database engine or the Plantlore Server is not running.
+                Please make sure that the database engine and/or the Plantlore
+                Server are running.
 		</li>
 	</ol>
 	</p>
 
 
 
-	<h2>5. Odhl??en? od datab?ze</h2>
+	<h2>5. Logging out</h2>
 
 	<p>
-	Po skon?en? pr?ce s datab?z? je doporu?eno se odhl?sit, aby t?et? osoba nez?skala mo?nost
-	pracovat s va?imi daty. Odhl??en? provedete bu? v menu polo?kou "Odhl?sit" nebo
-	vypnut?m Plantlore. Oba zp?soby jsou ekvivalentn?.
+        After you finish your work with the database we strongly recommecd that
+        you disconnect from the database so that a third person is prevented from
+        accessing your data. You can disconnect from the database either by 
+        clicking on Menu|Logout or by closing the Planlore. Both ways are equal.
 	</p>
 
 
-	<h2>6. Obnova ztracen?ho p?ipojen?</h2>
+	<h2>6. Renewal of the lost connection</h2>
 
 	<p>
-	P?i pr?ci s Plantlore m??e doj?t k n?hl? ztr?t? p?ipojen? k datab?zi nebo vzd?len?mu serveru.
-	D?vodem m??e b?t neo?ek?van? vypnut? nebo p?d datab?zov?ho stroje nebo Serveru ?i v?padek s??ov?ho spojen?.
-	O tomto stavu jste informov?ni kr?tkou zpr?vou, kter? popisuje probl?m, ke kter?mu do?lo.
-	V p??pad? ztracen?ho spojen? s datab?z? nebo Serverem vy?kejte n?jakou dobu a zkuste 
-	v menu vybrat "Znovu p?ipojit". Plantlore se pokus? nav?zat nov? spojen?. 
-	"Znovu p?ipojit" m??ete volat opakovan?.
+        The connection to the database or to the remote Server may be lost
+        during the work. There are many reasons: the database engine or Server
+        might have crashed or might have been switched off by their Administators,
+        or the network connection might have been lost.
+        After the problem is detected, you are notified by a short message describing
+        the problem. In case you lose the connection, wait for a while, and then try 
+        Menu|Reconnect. The Plantlore Client will try to renew the lost connection.
+        You can call the Reconnect several times.
 	</p>
 
 

Modified: trunk/src/net/sf/plantlore/help/en/html/server.html
===================================================================
--- trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-19 09:56:04 UTC (rev 843)
+++ trunk/src/net/sf/plantlore/help/en/html/server.html	2006-09-19 10:20:58 UTC (rev 844)
@@ -158,8 +158,8 @@
 			</td>
 			<td>
                                 The database engine may require some additional settings.
-                                For instance you have to set the encoding explicitely.
-                                This parameter server for the proper additional configuration
+                                For instance you have to set the encoding explicitly.
+                                This parameter is used to the proper additional configuration
                                 of the database connection.
                                 
                                 Postgre does not require any additional parameter.



From fraktalek at mail.berlios.de  Tue Sep 19 12:44:59 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 12:44:59 +0200
Subject: [Plantlore-dev] r845 - trunk
Message-ID: <200609191044.k8JAix0d011243@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 12:44:59 +0200 (Tue, 19 Sep 2006)
New Revision: 845

Modified:
   trunk/build.xml
Log:
New client class used in server...



Modified: trunk/build.xml
===================================================================
--- trunk/build.xml	2006-09-19 10:20:58 UTC (rev 844)
+++ trunk/build.xml	2006-09-19 10:44:59 UTC (rev 845)
@@ -133,6 +133,7 @@
                         <fileset dir="${base.dir}/src" includes="net/sf/plantlore/help/**"/>
                         <fileset dir="${base.dir}/src" includes="net/sf/plantlore/l10n/**" excludes="**/*.java"/>
                         <fileset dir="${base.dir}/src" includes="net/sf/plantlore/client/resources/**" excludes="**/*.java"/>
+                        <fileset dir="${build.dir}" includes="net/sf/plantlore/client/AppCoreView.class"/>
 			<manifest>
 				<attribute name="Built-By" value="${user.name}"/>
 				<attribute name="Main-Class" value="net.sf.plantlore.server.Plantlore"/>



From fraktalek at mail.berlios.de  Tue Sep 19 13:23:48 2006
From: fraktalek at mail.berlios.de (fraktalek at mail.berlios.de)
Date: Tue, 19 Sep 2006 13:23:48 +0200
Subject: [Plantlore-dev] r846 - trunk/installer
Message-ID: <200609191123.k8JBNm4Z022655@sheep.berlios.de>

Author: fraktalek
Date: 2006-09-19 13:23:47 +0200 (Tue, 19 Sep 2006)
New Revision: 846

Modified:
   trunk/installer/intro_cze.html
Log:
Fixed the encoding.



Modified: trunk/installer/intro_cze.html
===================================================================
--- trunk/installer/intro_cze.html	2006-09-19 10:44:59 UTC (rev 845)
+++ trunk/installer/intro_cze.html	2006-09-19 11:23:47 UTC (rev 846)
@@ -1,26 +1,47 @@
-<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
-
-<html>
-  <head>
-    <title>Plantlore</title>
-  </head>
-  <body>
-      <h1>Plantlore</h1>
-      <h2>?vod</h2>
-      <p>Plantlore je datab?zov? syst?m pro zad?v?n? a vyhled?v?n? dat o v?skytu rostlin ???en? pod licenc? GPL.
-      Je navr?en jako aplikace s architekturou klient server. Umo??uje jak pr?ci lok?ln?
-      tak i vzd?lenou po s?ti. Tento instal?tor instaluje Plantlore klienta a server
-      napsan? v programovac?m jazyce Java. Sou??st? projektu Plantlore je i webov? klient,
-      kter? se instaluje zvl???.</p>
-      <h2>Vybran? funkce</h2>
-      <ul>
-          <li>Rychl? zad?v?ni a editace n?lez? ("?krt?k", automatick? dopl?ov?n?, ...)</li>
-          <li>Spr?va dat o u?ivatel?ch, autorech a projektech</li>
-          <li>Import a export do XML kompatibiln?ho se standardy ABCD schema a DarwinCore</li>
-          <li>Lokalizace - zat?m ?e?tina a angli?tina</li>
-          <li>Tisk sched</li>
-          <li>Voln? dostupn? zdrojov? k?dy pod licenc? GPL</li>
-          <li>... a dal??</li>
-      </ul>
-  </body>
-</html>
+<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
+<HTML>
+<HEAD>
+	<META HTTP-EQUIV="CONTENT-TYPE" CONTENT="text/html; charset=utf-8">
+	<TITLE>Plantlore</TITLE>
+	<META NAME="GENERATOR" CONTENT="OpenOffice.org 2.0  (Linux)">
+	<META NAME="CREATED" CONTENT="20060919;15365900">
+	<META NAME="CHANGEDBY" CONTENT="Jakub Kotowski">
+	<META NAME="CHANGED" CONTENT="20060919;15383100">
+</HEAD>
+<BODY LANG="cs-CZ" DIR="LTR">
+<H1>Plantlore</H1>
+<H2>&Uacute;vod</H2>
+<P>Plantlore je datab&aacute;zov&yacute; syst&eacute;m pro zad&aacute;v&aacute;n&iacute;
+a vyhled&aacute;v&aacute;n&iacute; dat o v&yacute;skytu rostlin
+??&iacute;??en&yacute; pod licenc&iacute; GPL. Je navr??en jako
+aplikace s architekturou klient server. Umo????uje jak pr&aacute;ci
+lok&aacute;ln&iacute; tak i vzd&aacute;lenou po s&iacute;ti. Tento
+instal&aacute;tor instaluje Plantlore klienta a server napsan&eacute;
+v programovac&iacute;m jazyce Java. Sou??&aacute;st&iacute; projektu
+Plantlore je i webov&yacute; klient, kter&yacute; se instaluje
+zvl&aacute;????.</P>
+<H2>Vybran&eacute; funkce</H2>
+<UL>
+	<LI><P STYLE="margin-bottom: 0cm">Rychl&eacute; zad&aacute;v&aacute;ni
+	a editace n&aacute;lez&ugrave; (&quot;??krt&aacute;k&quot;,
+	automatick&eacute; dopl??ov&aacute;n&iacute;, ...) 
+	</P>
+	<LI><P STYLE="margin-bottom: 0cm">Spr&aacute;va dat o u??ivatel&iacute;ch,
+	autorech a projektech 
+	</P>
+	<LI><P STYLE="margin-bottom: 0cm">Import a export do XML
+	kompatibiln&iacute;ho se standardy ABCD schema a DarwinCore 
+	</P>
+	<LI><P STYLE="margin-bottom: 0cm">Lokalizace - zat&iacute;m ??e??tina
+	a angli??tina 
+	</P>
+	<LI><P STYLE="margin-bottom: 0cm">Tisk sched 
+	</P>
+	<LI><P STYLE="margin-bottom: 0cm">Voln?? dostupn&eacute; zdrojov&eacute;
+	k&oacute;dy pod licenc&iacute; GPL 
+	</P>
+	<LI><P>... a dal??&iacute; 
+	</P>
+</UL>
+</BODY>
+</HTML>
\ No newline at end of file



From krater at mail.berlios.de  Tue Sep 19 16:10:54 2006
From: krater at mail.berlios.de (krater at mail.berlios.de)
Date: Tue, 19 Sep 2006 16:10:54 +0200
Subject: [Plantlore-dev] r847 - trunk/src/net/sf/plantlore/server
Message-ID: <200609191410.k8JEAsXC005730@sheep.berlios.de>

Author: krater
Date: 2006-09-19 16:10:53 +0200 (Tue, 19 Sep 2006)
New Revision: 847

Modified:
   trunk/src/net/sf/plantlore/server/ConnectionInfo.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
ConnectionInfo made more resilient to NULL, although ConnectionInfo.database SHOULD NEVER be null...

Modified: trunk/src/net/sf/plantlore/server/ConnectionInfo.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-19 11:23:47 UTC (rev 846)
+++ trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-09-19 14:10:53 UTC (rev 847)
@@ -76,8 +76,15 @@
 	@Override
 	public String toString() {
 		try {
-			return database.getDescription() + " @ " + description;
-		} catch( RemoteException e ) {
+			if( database == null && description == null )
+				return "unidentified user";
+			else if( database != null && description == null )
+				return database.getDescription();
+			else if( database == null && description != null )
+				return "? @ " + description;
+			else
+				return database.getDescription() + " @ " + description;
+		} catch( Exception e ) {
 			return "? @ " + description;
 		}
 	}

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-19 11:23:47 UTC (rev 846)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-19 14:10:53 UTC (rev 847)
@@ -2415,6 +2415,16 @@
 	 * @return description of this database layer: Name Surname (login).
 	 */
 	public String getDescription() {
-		return toString();
+		if(plantloreUser != null) {
+			String name = plantloreUser.getFirstName(),
+			surname = plantloreUser.getSurname(), 
+			description = ((name != null) ? name + " " : "") + ((surname != null) ? surname : "");
+			if(name == null && surname == null)
+				description = currentlyConnectedUser;
+			else
+				description = description +	" (" + currentlyConnectedUser + ")";
+			return description;
+		}
+		return currentlyConnectedUser ; 
 	}
 }



From tkovarik at gmail.com  Tue Sep 19 23:54:59 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Tue, 19 Sep 2006 23:54:59 +0200
Subject: [Plantlore-dev] Prva verzia prezentacie
Message-ID: <ea88f1620609191454v6c212delaffbd6bfb6ac3115@mail.gmail.com>

Caute,

posielam prvu verziu prezentacie na obhajobu. Prosim o vyjadrenie hlavne co
sa tyka obsahu a taktiez o pripadne upravy cestiny. Prosim napiste mi do
mailu co nevyhovuje aby som potom nemusel mergovat upravene odp dokumenty.

Majte sa

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060919/8ef69a3f/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation.odp
Type: application/vnd.oasis.opendocument.presentation
Size: 277758 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060919/8ef69a3f/attachment.odp>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation.pdf
Type: application/pdf
Size: 322828 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060919/8ef69a3f/attachment.pdf>

From fraktalek at gmx.net  Wed Sep 20 02:32:34 2006
From: fraktalek at gmx.net (fraktalek)
Date: Wed, 20 Sep 2006 02:32:34 +0200
Subject: [Plantlore-dev] Prva verzia prezentacie
In-Reply-To: <ea88f1620609191454v6c212delaffbd6bfb6ac3115@mail.gmail.com>
References: <ea88f1620609191454v6c212delaffbd6bfb6ac3115@mail.gmail.com>
Message-ID: <200609200232.34451.fraktalek@gmx.net>

ad slide c. 12:

pri zmince o tom, ze plantlore neobsahuje taxon. db. bych zminil, ze tohle 
oddeleni jsme zvolili po konzultaci s prazskym odbornikem na taxonomii


ad posledni slide:

neni to tam napsano jako bod, ale doufam, ze planujes rict, ze si myslime, ze 
jsme splnili vsechny body specifikace a dokonce udelali nemalo prace navic.


On Tuesday 19 September 2006 23:54, Tomas Kovarik wrote:
> Caute,
>
> posielam prvu verziu prezentacie na obhajobu. Prosim o vyjadrenie hlavne co
> sa tyka obsahu a taktiez o pripadne upravy cestiny. Prosim napiste mi do
> mailu co nevyhovuje aby som potom nemusel mergovat upravene odp dokumenty.
>
> Majte sa
>
> Kovo


From ladaOb at seznam.cz  Wed Sep 20 01:10:22 2006
From: ladaOb at seznam.cz (=?iso-8859-1?Q?Lada_Oberreiterov=E1?=)
Date: Wed, 20 Sep 2006 01:10:22 +0200
Subject: [Plantlore-dev] Spracovany Bug list od Hansa
References: <ea88f1620609191548k7e7043e6r8e376407139bb58e@mail.gmail.com>
Message-ID: <008701c6dc40$ccf4c9d0$5113a8c0@Jose>

 Ahoj,

posilam par veci k tomu seznamu. Zitra to jeste doprojdu
Chyb? mi tu fce pro nacten? tabulky se souradnicemi. Pri manu?ln?m zad?v?n? se casto udel? chyba ... nebyla uplne v planu, ale diskutovalo se o ni s Hansem. Posilal i soubory, jak vypadaji data z GPS. Nedelalo se to, protoze se to nestihalo.

Celkov? historie, historie z?znamu - Nechce to prov?st undo, jestlize star? hodnota byla null ..... tezko rici, kdy to Hansovi pada. Co jsem testovala, tak se mi nestalo nikdy, ze by neproslo UNDO, kdyz je stara hodnota null

 Add dialog a historie: nezobrazuje se kdo to zmenil, i kdyz se to zapisuje do db. Zmen?m-li taxon, tak se mi prestanou se zobrazovat predchoz? zmeny z?znamu. V tbl thistory pribydou 4 r?dky s hodnotami null ve sloupc?ch cnewvalue a coldvalue.  .......... to nezobrazovani uzivatele, ktery to editoval bylo urcite dano tim, ze u uzivatele, ktery byl vytvoren pri createDB nebylo jmeno ani prijmeni. Pri zmene taxonu je logicky vlozen novy nalez do databaze, takze jeho historie se zacne sledovat od zacatku. 

Lada





  ----- Original Message ----- 
  From: Tomas Kovarik 
  To: fraktalek at gmx.net ; Lada Oberreiterov? ; Erik Kratochvil 
  Sent: Wednesday, September 20, 2006 12:48 AM
  Subject: Spracovany Bug list od Hansa


  Caute,

  v prilohe posielam zoznam tych veci na ktore narazil Hans. Niektore su uz fixnute ale vela z nich su vacsie ci mensie upravy. Niektore by podla mna stalo za to opravit (oznacil som ich v stlpci Fixed ako "Bude"). Ak nesuhlasite, upravte (nejak tak aby sa to dalo vystopovat, napr. inou farbou) alebo doplnte podla vlastneho uvazenia. 

  Mali by sme asi idealne zajtra poslat Hansovi nejake vyjadrenie k tymto veciam.

  Majte sa

  Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/955c392e/attachment.html>

From admin at berlios.de  Wed Sep 20 01:18:50 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:18:50 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3122] Tidy up /documentation directory in
	the SVN repository
Message-ID: <200609192318.k8JNIoef018233@unicorn.berlios.de>

Task #3122 has been updated. 

Project: Plantlore
Subproject: Documentation
Summary: Tidy up /documentation directory in the SVN repository
Priority: 7
Percent Complete: 0%
Status: Open
Authority  : tkovarik
Assigned to: none

Description: There's a lot of files in the documentation directory in the SVN repository, some of them are outdated, some are merged into other documents.
We should decide on which files to keep and how to organize the documentation directory.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3122&group_id=5975&group_project_id=1508


From admin at berlios.de  Wed Sep 20 01:21:19 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:21:19 +0200 (CEST)
Subject: [Plantlore-dev] [Bug #8600] Define create,
	alter and drop user for other database
Message-ID: <200609192321.k8JNLJZ5022618@unicorn.berlios.de>

Bug #8600, was updated on 2006-Aug-28 12:33
Here is a current snapshot of the bug.

Project: Plantlore
Category: DBLayer
Status: Open
Resolution: None
Bug Group: None
Priority: 3
Submitted by: joselada
Assigned to : tkovarik
Summary: Define create, alter and drop user for other database

Details: Define create, alter and drop user for other database (MySQL, Oracle, ...).

Test plantlore with other database (Oracle, ...)

Follow-Ups:

Date: 2006-Sep-20 01:21
By: tkovarik

Comment:
Priority decreased since we probably won't support different databases in the near future.
-------------------------------------------------------

For detailed info, follow this link:
http://developer.berlios.de/bugs/?func=detailbug&bug_id=8600&group_id=5975


From admin at berlios.de  Wed Sep 20 01:22:49 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:22:49 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3050] Prepare final database
Message-ID: <200609192322.k8JNMnr4025259@unicorn.berlios.de>

Task #3050 has been updated. 

Project: Plantlore
Subproject: General
Summary: Prepare final database
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: joselada

Description: The one we'll use during our defence and prior to that also for testing!!!

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:22
By: tkovarik

Comment:
Current DB schema seems to be final.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3050&group_id=5975&group_project_id=1512


From admin at berlios.de  Wed Sep 20 01:24:09 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:24:09 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3061] Testing
Message-ID: <200609192324.k8JNO9jG027144@unicorn.berlios.de>

Task #3061 has been updated. 

Project: Plantlore
Subproject: Installer
Summary: Testing 
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: none

Description: Has to work at least on Unix and Windows

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:24
By: tkovarik

Comment:
Installer works fine on Windows, Linux and Mac OS X

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3061&group_id=5975&group_project_id=1509


From admin at berlios.de  Wed Sep 20 01:25:10 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:25:10 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3047] Development documentation
Message-ID: <200609192325.k8JNPAer028829@unicorn.berlios.de>

Task #3047 has been updated. 

Project: Plantlore
Subproject: Documentation
Summary: Development documentation
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: none

Description: Mailing list, minutes and action items from meetings, decisions explained, ...

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:25
By: tkovarik

Comment:
Development documentation for Plantlore 1.0 is in the SVN repository

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3047&group_id=5975&group_project_id=1508


From admin at berlios.de  Wed Sep 20 01:27:39 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:27:39 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3046] Programming documentation
Message-ID: <200609192327.k8JNRdsw003198@unicorn.berlios.de>

Task #3046 has been updated. 

Project: Plantlore
Subproject: Documentation
Summary: Programming documentation
Priority: 3
Percent Complete: 75%
Status: Open
Authority  : fraktalek
Assigned to: none

Description: Source code comments, architecture and design, ...

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:27
By: tkovarik

Comment:
Developer's documentation for Plantlore 1.0 is in the SVN repository.
JavaDoc comments are not complete in some source files and should be fixed.
Lowering priority since JavaDoc is not a key part of the docs.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3046&group_id=5975&group_project_id=1508


From admin at berlios.de  Wed Sep 20 01:29:39 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:29:39 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3045] User documentation
Message-ID: <200609192329.k8JNTdgT006646@unicorn.berlios.de>

Task #3045 has been updated. 

Project: Plantlore
Subproject: Documentation
Summary: User documentation
Priority: 5
Percent Complete: 50%
Status: Open
Authority  : fraktalek
Assigned to: none

Description: Mainly documentation accessible from the Java client.

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:29
By: tkovarik

Comment:
User documentation for Plantlore 1.0 is in the SVN repository. 
English version of the user manual should be created (compiled from the html help files)
Some modifications of user documentation are also required (so that all parts look alike) but it is not a priority

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3045&group_id=5975&group_project_id=1508


From admin at berlios.de  Wed Sep 20 01:32:28 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:32:28 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3058] Use record locking in the client
Message-ID: <200609192332.k8JNWSt6011239@unicorn.berlios.de>

Task #3058 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Use record locking in the client
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: tkovarik, krater, joselada, fraktalek

Description: Detect conflicts, inform user, .... - implement all that in all relevant code

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:32
By: tkovarik

Comment:
Optimistic locking implemented in Plantlore. Hibernate managed versioning feature was used. DB tables were modified to include "cversion" column used by Hibernate to implement optimistic locking. 
Since Plantlore is not expected to run in highly concurrent environment, optimistic locking is sufficient

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3058&group_id=5975&group_project_id=1511


From admin at berlios.de  Wed Sep 20 01:34:51 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:34:51 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3060] Check security issues
Message-ID: <200609192334.k8JNYpFg015233@unicorn.berlios.de>

Task #3060 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Check security issues
Priority: 5
Percent Complete: 90%
Status: Open
Authority  : fraktalek
Assigned to: tkovarik

Description: Where and how to store passwords, .... ?

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:34
By: tkovarik

Comment:
Passwords are not saved anywhere in Plantlore. We only use authentication on the level of the database system (PostgreSQL).
We still have to deal with the feature of PostgreSQL which enables local DB connection to proceed without any password.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3060&group_id=5975&group_project_id=1511


From admin at berlios.de  Wed Sep 20 01:36:02 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:36:02 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3059] Database management
Message-ID: <200609192336.k8JNa2aP017174@unicorn.berlios.de>

Task #3059 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Database management
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: none

Description: Creation of a new database from within the client and subsequent managing of various databases

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:36
By: tkovarik

Comment:
Create database is implemented in Plantlore 1.0 (it is PostgreSQL specific)

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3059&group_id=5975&group_project_id=1511


From admin at berlios.de  Wed Sep 20 01:39:23 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:39:23 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3064] Add database user accounts for
	Plantlore users
Message-ID: <200609192339.k8JNdNVY022281@unicorn.berlios.de>

Task #3064 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Add database user accounts for Plantlore users
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : tkovarik
Assigned to: tkovarik, krater, joselada

Description: Every plantlore user should access database using his/her own database server account. This way, we don't have to store username and password for DB access on the Client (given that the username and password are the same for DB access and for Plantlore access). DBlayer, UserManager and Login have to be updated in order for this feature to work.

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:39
By: tkovarik

Comment:
New DB account created for every Plantlore user. The user account consists of the database prefix and the username itself. For example, for user "tester" in the database "test" we have DB account "test_tester". Users use only the username part when logging in, database prefix is attached automatically based on the selected database.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3064&group_id=5975&group_project_id=1511


From admin at berlios.de  Wed Sep 20 01:42:33 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:42:33 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3057] Implement record locking in DBLayer
Message-ID: <200609192342.k8JNgXHL024230@unicorn.berlios.de>

Task #3057 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Implement record locking in DBLayer
Priority: 5
Percent Complete: 100%
Status: Closed
Authority  : fraktalek
Assigned to: tkovarik

Description: So that concurrent work of multiple users on the same database is reasonably possible and clear.

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:42
By: tkovarik

Comment:
Closing task since duplicate tsak no. 003058 exists. See this task for additional comments

-------------------------------------------------------
Date: 2006-Aug-07 00:31
By: tkovarik

Comment:
Hibernate optimistic locking using managed versioning implemented (relevant tables now have CVERSION column used by Hibernate to implement optimistic locking). This means First commit wins strategy is used. In case more clients update the same data, only the first to commit will succeed, others will have to reload the data and make their modifications again. Proper translation of StaleObjectStateException still needs to be implemented so that we can let clients know their update failed because of concurrent updates.

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3057&group_id=5975&group_project_id=1511


From admin at berlios.de  Wed Sep 20 01:43:58 2006
From: admin at berlios.de (admin at berlios.de)
Date: Wed, 20 Sep 2006 01:43:58 +0200 (CEST)
Subject: [Plantlore-dev] [Task #3055] Fine tune GUI
Message-ID: <200609192343.k8JNhw4l025271@unicorn.berlios.de>

Task #3055 has been updated. 

Project: Plantlore
Subproject: Plantlore Client/Server
Summary: Fine tune GUI
Priority: 5
Percent Complete: 50%
Status: Open
Authority  : fraktalek
Assigned to: none

Description: Positions and order of Ok, Cancel and Help buttons should be the same in all dialogs, mnemonic and shortcut usage, ...

Follow-Ups:

-------------------------------------------------------
Date: 2006-Sep-20 01:43
By: tkovarik

Comment:
Positions and order of Ok, Cancel and Help buttons was unified throughout Plantlore

-------------------------------------------------------
For more info, visit:

http://developer.berlios.de/pm/task.php?func=detailtask&project_task_id=3055&group_id=5975&group_project_id=1511


From discontinuum at gmail.com  Wed Sep 20 12:19:36 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 20 Sep 2006 12:19:36 +0200
Subject: [Plantlore-dev] Spracovany Bug list od Hansa - moje komentare
Message-ID: <f4dc39b90609200319w6e5ecca5w663ef9f60267ed9@mail.gmail.com>

Modre pridany moje nazory/komentare. Nevedel jsem, jestli to bude cist i
Hans, nebo je-li to interni dokument, proto jsem se krotil.

---------- Forwarded message ----------
From: Erik Kratochv?l <discontinuum at gmail.com>
Date: Sep 20, 2006 12:18 PM
Subject: Re: [Plantlore-dev] Spracovany Bug list od Hansa
To: Lada Oberreiterov? <ladaOb at seznam.cz>

Modre moje poznamky k nekterym "bugum".

On 9/20/06, Lada Oberreiterov? <ladaOb at seznam.cz> wrote:

>   Ahoj,
>
> posilam par veci k tomu seznamu. Zitra to jeste doprojdu
>
> *Chyb? mi tu fce pro na?ten? tabulky se sou?adnicemi. P?i manu?ln?m
> zad?v?n? se ?asto ud?l? chyba *... nebyla uplne v planu, ale diskutovalo
> se o ni s Hansem. Posilal i soubory, jak vypadaji data z GPS. Nedelalo se
> to, protoze se to nestihalo.
>
> *Celkov? historie, historie z?znamu - Nechce to prov?st undo, jestli?e
> star? hodnota byla null* ..... tezko rici, kdy to Hansovi pada. Co jsem
> testovala, tak se mi nestalo nikdy, ze by neproslo UNDO, kdyz je stara
> hodnota null
>
> * **Add dialog a historie: nezobrazuje se kdo to zm?nil, i kdy? se to
> zapisuje do db. Zm?n?m-li taxon, tak se mi p?estanou se zobrazovat p?edchoz?
> zm?ny z?znamu. V tbl thistory p?ibydou 4 ??dky s hodnotami null ve sloupc?ch
> cnewvalue a coldvalue.*  .......... to nezobrazovani uzivatele, ktery to
> editoval bylo urcite dano tim, ze u uzivatele, ktery byl vytvoren pri
> createDB nebylo jmeno ani prijmeni. Pri zmene taxonu je logicky vlozen novy
> nalez do databaze, takze jeho historie se zacne sledovat od zacatku.
>
> Lada
>
>
>
>
>
> ----- Original Message -----
>  *From:* Tomas Kovarik <tkovarik at gmail.com>
> *To:* fraktalek at gmx.net ; Lada Oberreiterov? <ladaob at seznam.cz> ; Erik
> Kratochvil <discontinuum at gmail.com>
> *Sent:* Wednesday, September 20, 2006 12:48 AM
> *Subject:* Spracovany Bug list od Hansa
>
> Caute,
>
> v prilohe posielam zoznam tych veci na ktore narazil Hans. Niektore su uz
> fixnute ale vela z nich su vacsie ci mensie upravy. Niektore by podla mna
> stalo za to opravit (oznacil som ich v stlpci Fixed ako "Bude"). Ak
> nesuhlasite, upravte (nejak tak aby sa to dalo vystopovat, napr. inou
> farbou) alebo doplnte podla vlastneho uvazenia.
>
> Mali by sme asi idealne zajtra poslat Hansovi nejake vyjadrenie k tymto
> veciam.
>
> Majte sa
>
> Kovo
>
>
> _______________________________________________
> Plantlore-dev mailing list
> Plantlore-dev at lists.berlios.de
> https://lists.berlios.de/mailman/listinfo/plantlore-dev
>
>
>
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/a7db34be/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: BugList.odt
Type: application/vnd.oasis.opendocument.text
Size: 17773 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/a7db34be/attachment.odt>

From tkovarik at gmail.com  Wed Sep 20 14:18:29 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Wed, 20 Sep 2006 14:18:29 +0200
Subject: [Plantlore-dev] Prezentacia Plantlore na obhajobu
Message-ID: <ea88f1620609200518k14083ecdv114c06300fa4135e@mail.gmail.com>

Dobry den,

v prilohe vam posielam sucasnu verziu prezentacie na obhajobu. Este tam
pravdepodobne spravime nejake drobne upravy. Ak by ste narazil na nejaky
nedostatok alebo ak myslite, ze tam nieco chyba dajte mi prosim vediet.

S pozdravom

Tomas Kovarik
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/23e65ee4/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation.pdf
Type: application/pdf
Size: 323855 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/23e65ee4/attachment.pdf>

From tkovarik at gmail.com  Wed Sep 20 16:26:18 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Wed, 20 Sep 2006 16:26:18 +0200
Subject: [Plantlore-dev] Fwd: Prezentacia Plantlore na obhajobu
In-Reply-To: <20060920135648.ac6d479a@ksint.ms.mff.cuni.cz>
References: <20060920135648.ac6d479a@ksint.ms.mff.cuni.cz>
Message-ID: <ea88f1620609200726s7cdec4fdl1d996ffaf5c07201@mail.gmail.com>

---------- Forwarded message ----------
From: Antonin Riha <riha at ksi.ms.mff.cuni.cz>
Date: Sep 20, 2006 3:56 PM
Subject: Re: Prezentacia Plantlore na obhajobu
To: Tomas Kovarik <tkovarik at gmail.com>

Mily kolego,
dik za prezentaci. Prohledl jsem to parkrat, ale nenapada me zadna chyba.
Snad jen - prohodil bych slajdy 2 a 3, aby po osnove prezentace hned byl
jeji prvni bod; a pak: vyhody Plantlore na slajdu 6 jsou presnym opakovanim
(samozrejme v negaci) nevyhod ze slajdu 5 - mozna by se dal slajd 6 usetrit
a jen u slajdu 5 prohlasit, ze vy vsechny ty nevyhody vy odstranujete.
Myslim, ze nebudou chybet ani ty (jinak ovsem pekne) obrazky ze slajdu 6,
protoze pozdeji pak vse podrobneji ukazujete.
Pak me jeste napadlo, ze nezasvecenemu posluchaci nebudou jasne ty standardy
tim, co je uvedeno na slajdu 9 - kdyby se dal ukazat jednoduchoucky priklad
na jeden slajd, asi by to pomohlo (ale pokud by to zabralo vic, tak chapu,
ze na to nebude cas).
Vse ostatni pak uz ovsem bude zalezet na Vasi frekvenci hovoru, na kterou
pevne spoleham.
Doufam, ze nekdy behem zitrka dostanu vyjadreni dr. Skopala, hned vam
ho preposlu.
Jen na okraj uvadim, ze v dokumentaci nakonec zustal nazev systemu Postgre
(jak jsem psal v nekterem drivejsim mailu, myslim si, ze to ma byt Postgres)
- pripomnel mi to ted Vas slajd 10, kde je "Python-Posgre db.driver".
To uz musime (pokud mam pravdu) nejak "okecat".
Zdravi  A. Riha
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/18d4b39c/attachment.html>

From discontinuum at gmail.com  Wed Sep 20 18:48:06 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Wed, 20 Sep 2006 18:48:06 +0200
Subject: [Plantlore-dev] Videa
Message-ID: <f4dc39b90609200948v24b6eaao41e176992b614030@mail.gmail.com>

Nova videa jsou na urtaxu ke stazeni. Pristup je i primo z internetu pres

http://urtax.ms.mff.cuni.cz/plantlore/video/new/


Videa

   - obsahuji kratky (3s) popis, co na nich bude nasledovat
   - jsou poskladana v rozumnem sledu (nekde jsou dokonce i data z
   predchoziho vyhledavani apod)
   - nejsou spojena v jedno velke video - diky tomu bude mozne nekterou
   cast snadno vynechat, resp. nakonec volit jine poradi - "spojeni" videi lze
   snadno docilit jejich zarazenim do playlistu

Zbyva mi jeste udelat video o WebKlientu - musim si pohrat s tim BioCasem..
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060920/b061067a/attachment.html>

From tkovarik at gmail.com  Thu Sep 21 01:00:19 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 21 Sep 2006 01:00:19 +0200
Subject: [Plantlore-dev] Vyskusanie prezentacie a videa
Message-ID: <ea88f1620609201600x6d15d1d3r14aea29f0170b9fd@mail.gmail.com>

Caute,

hovoril som dnes po telefone s Dejmkovou, pytal som sa jej na to vyskusanie
prezentacie v S4-ke. Hovorila, ze v pohode, mame sa ale pozriet ci nebude S4
obsadena. Podla
http://www.mff.cuni.cz/vnitro/is/sis/rezervace/index.php?ACT=2&BUILDINGID=S&day=21&month=9&year=2006tam
ma Holan nejake konzultacie, zastavil by som sa tam teda tak okolo tej
jednej a vyskusal tu prezentaciu. Ak by ste sa chceli niekto pridat dajte
vediet, nejak sa dohodneme.

Majte sa zatial

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060921/d650cca5/attachment.html>

From tkovarik at gmail.com  Thu Sep 21 15:10:21 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 21 Sep 2006 15:10:21 +0200
Subject: [Plantlore-dev] Test prezentacie
Message-ID: <ea88f1620609210610g6cb639f8w75bb89b9913503a9@mail.gmail.com>

Caute,

bol som v S4ke otestovat prezentaciu. Video ide bez problemov (je tam WMP).
Prezentacia tiez (je tam OO.org). Trosku problem je, ze ked to clovek pusti
z OO.org tak pismo nie je anti-aliasovane takze to pri zvacseni na
projektore nevyzera uplne dobre. Skusal som pustit prezentaciu z Adobe
Acrobatu a tam uz je to vyhladzovane, takze navrhujem to pustat z PDFka.

Majte sa

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060921/9ea2c207/attachment.html>

From tkovarik at gmail.com  Thu Sep 21 22:27:30 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Thu, 21 Sep 2006 22:27:30 +0200
Subject: [Plantlore-dev] Dalsia verzia prezentacie
Message-ID: <ea88f1620609211327r4347086ey67001f668584bc93@mail.gmail.com>

Caute,

v prilohe je nova verzia, zapracoval som tam pripomienky, ak by ste este na
nieco narazili dajte vediet.

Kovo
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060921/c4569240/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation3.odp
Type: application/vnd.oasis.opendocument.presentation
Size: 274217 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060921/c4569240/attachment.odp>

From tkovarik at gmail.com  Fri Sep 22 00:38:03 2006
From: tkovarik at gmail.com (Tomas Kovarik)
Date: Fri, 22 Sep 2006 00:38:03 +0200
Subject: [Plantlore-dev] Nova verzia prezentacie
Message-ID: <ea88f1620609211538k11790e7ve512a077f2a7757d@mail.gmail.com>

V prilohe
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060922/b20f6204/attachment.html>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation4.odp
Type: application/vnd.oasis.opendocument.presentation
Size: 278210 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060922/b20f6204/attachment.odp>
-------------- next part --------------
A non-text attachment was scrubbed...
Name: PlantlorePresentation4.pdf
Type: application/pdf
Size: 320970 bytes
Desc: not available
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060922/b20f6204/attachment.pdf>

From discontinuum at gmail.com  Mon Sep 25 23:18:57 2006
From: discontinuum at gmail.com (=?UTF-8?Q?Erik_Kratochv=C3=ADl?=)
Date: Mon, 25 Sep 2006 23:18:57 +0200
Subject: [Plantlore-dev] Rozpocet
Message-ID: <f4dc39b90609251418y1b5120dk20a7e36d5ec706f2@mail.gmail.com>

Spoctete nekdo plz vyslednou cenu dokumentace ;)
At vim, kolik si mam dat stranou. Odhaduju, ze to na kazdyho je cca 750,-
korun, ne?
-------------- next part --------------
An HTML attachment was scrubbed...
URL: <https://lists.berlios.de/pipermail/plantlore-dev/attachments/20060925/12ff9acd/attachment.html>

