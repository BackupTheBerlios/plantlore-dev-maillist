<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] [Bug #8480] The Select Query is wrong!!
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20%5BBug%20%238480%5D%20The%20Select%20Query%20is%20wrong%21%21&In-Reply-To=%3C200608211204.k7LC4YuE016008%40unicorn.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000740.html">
   <LINK REL="Next"  HREF="000742.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] [Bug #8480] The Select Query is wrong!!</H1>
    <B>admin at berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20%5BBug%20%238480%5D%20The%20Select%20Query%20is%20wrong%21%21&In-Reply-To=%3C200608211204.k7LC4YuE016008%40unicorn.berlios.de%3E"
       TITLE="[Plantlore-dev] [Bug #8480] The Select Query is wrong!!">admin at berlios.de
       </A><BR>
    <I>Mon Aug 21 14:04:34 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000740.html">[Plantlore-dev] [Bug #8480] There is something terribly wrong!!
</A></li>
        <LI>Next message: <A HREF="000742.html">[Plantlore-dev] [Bug #8497] Overview cannot deal with empty database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#741">[ date ]</a>
              <a href="thread.html#741">[ thread ]</a>
              <a href="subject.html#741">[ subject ]</a>
              <a href="author.html#741">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Bug #8480, was updated on 2006-Aug-20 12:15
Here is a current snapshot of the bug.

Project: Plantlore
Category: Overview
Status: Open
Resolution: None
Bug Group: Bug
Priority: 9
Submitted by: fraktalek
Assigned to : none
Summary: The Select Query is wrong!!

Details: Some occurrences are doubled some are left out...
For example in the habitat tree navigate to Bohemia orientalis and then expand the Blatensko phytochorion one of the Prusy-Boskuvky habitat as one occurrence in it, however if you double-click it the Overview will show nothing.

Other way to reproduce this is to search for Herbarium CB/1003.
Overview will show two times the occurrence with id 587, one time occurrence with id 590 and will ommit occurrence with id 589.

I'll shortly commit code that makes the inspection of this problem a little easier - Plantlore will print the occurrence id when you select a row and by  each habitat in the habitat tree there will be indicated how many occurrences it has in it.

Follow-Ups:

Date: 2006-Aug-21 14:04
By: krater

Comment:
Sorry, unintentionally changed the title... :(
-------------------------------------------------------

Date: 2006-Aug-21 14:02
By: krater

Comment:
I concur.

I used 
 * the plantlore_full_2006_08_06.backup database 
 * Plantlore revision 540

Then, right after logging in,  I marked first five occurrences in the Overview dialog with following results:

Selected row #0 occurrence id is 590
Selected row #1 occurrence id is 587
Selected row #2 occurrence id is 587
Selected row #3 occurrence id is 207
Selected row #4 occurrence id is 3

The most confusing part of all this was Export: I tried to export those five marked Occurrences and this is what I got:

&lt;occurrence&gt;
  &lt;unitvalue&gt;3&lt;/unitvalue&gt;
&lt;/occurrence&gt;
&lt;occurrence&gt;
  &lt;unitvalue&gt;207&lt;/unitvalue&gt;
&lt;/occurrence&gt;
&lt;occurrence&gt;
  &lt;unitvalue&gt;303&lt;/unitvalue&gt;
&lt;/occurrence&gt;
&lt;occurrence&gt;
  &lt;unitvalue&gt;303&lt;/unitvalue&gt;
&lt;/occurrence&gt;

Well:
 * Does the database contain occurrences with the same Unique identifier (ie. unitvalue &amp; unitiddb)?
 * Where the heck came the record 303 from and where are records 587 and 590?
 * Why are there only 4 records?

This calls for revision of Search.creaExportQuery as well.
-------------------------------------------------------

For detailed info, follow this link:
<A HREF="http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=8480&amp;group_id=5975">http://developer.berlios.de/bugs/?func=detailbug&amp;bug_id=8480&amp;group_id=5975</A>

</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000740.html">[Plantlore-dev] [Bug #8480] There is something terribly wrong!!
</A></li>
	<LI>Next message: <A HREF="000742.html">[Plantlore-dev] [Bug #8497] Overview cannot deal with empty database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#741">[ date ]</a>
              <a href="thread.html#741">[ thread ]</a>
              <a href="subject.html#741">[ subject ]</a>
              <a href="author.html#741">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
