<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r586 - in trunk/src/net/sf/plantlore/client: .	overview
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r586%20-%20in%20trunk/src/net/sf/plantlore/client%3A%20.%0A%09overview&In-Reply-To=%3C200608281801.k7SI1YZG029768%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000812.html">
   <LINK REL="Next"  HREF="000814.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r586 - in trunk/src/net/sf/plantlore/client: .	overview</H1>
    <B>lada at mail.berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r586%20-%20in%20trunk/src/net/sf/plantlore/client%3A%20.%0A%09overview&In-Reply-To=%3C200608281801.k7SI1YZG029768%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r586 - in trunk/src/net/sf/plantlore/client: .	overview">lada at mail.berlios.de
       </A><BR>
    <I>Mon Aug 28 20:01:34 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000812.html">[Plantlore-dev] r585 - in trunk/src/net/sf/plantlore:	client/history client/login common common/exception l10n server
</A></li>
        <LI>Next message: <A HREF="000814.html">[Plantlore-dev] r587 - trunk/src/net/sf/plantlore/l10n
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#813">[ date ]</a>
              <a href="thread.html#813">[ thread ]</a>
              <a href="subject.html#813">[ subject ]</a>
              <a href="author.html#813">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lada
Date: 2006-08-28 20:00:44 +0200 (Mon, 28 Aug 2006)
New Revision: 586

Added:
   trunk/src/net/sf/plantlore/client/overview/Transformation.java
   trunk/src/net/sf/plantlore/client/overview/TransformationChangeCtrl.java
   trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.form
   trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.java
Removed:
   trunk/src/net/sf/plantlore/client/Transformation.java
Modified:
   trunk/src/net/sf/plantlore/client/overview/AddEdit.java
   trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
   trunk/src/net/sf/plantlore/client/overview/AddEditView.form
   trunk/src/net/sf/plantlore/client/overview/AddEditView.java
Log:
Add transformation between coordinate systems.
WGS-84 &lt;--&gt; S-JSTK is OK.
WGS-84 &lt;--&gt; S-42 have to bee little change.

Number of Latitude, longitude and altitude have to have bigger.




Deleted: trunk/src/net/sf/plantlore/client/Transformation.java
===================================================================
--- trunk/src/net/sf/plantlore/client/Transformation.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/Transformation.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -1,865 +0,0 @@
-/*
- * Transformation.java
- *
- * Created on 4. &#269;erven 2006, 0:46
- *
- * To change this template, choose Tools | Template Manager
- * and open the template in the editor.
- */
-
-package net.sf.plantlore.client;
-
-import org.apache.log4j.Logger;
-
-/**
- *
- * Zdroj: 
- * Converting between grid eastings and northings and ellipsoidal latititude and longitude. <A HREF="http://www.gps.gov.uk/guidec.asp.">http://www.gps.gov.uk/guidec.asp.</A>
- * Hrdina, Z.: P&#345;epo&#269;et z S-JTSK do WGS-84. 2002. <A HREF="http://gpsweb.cz/JTSK-WGS.htm.">http://gpsweb.cz/JTSK-WGS.htm.</A>
- * Hrdina, Z.: Transformace sou&#345;adnic ze syst&#233;mu WGS-84 do syst&#233;mu S-JTSK. Praha: &#268;VUT, 1997. <A HREF="http://www.geospeleos.com/Mapovani/WGS84toSJTSK/WGS_JTSK.pdf.">http://www.geospeleos.com/Mapovani/WGS84toSJTSK/WGS_JTSK.pdf.</A> 
- * Transformace souradnic WGS84&lt;--&gt;-JTSK&lt;--&gt;S42 <A HREF="http://astro.mff.cuni.cz/mira/sh/sh.php">http://astro.mff.cuni.cz/mira/sh/sh.php</A>  
- *
- * @author Lada Oberreiterova
- * 
- * 
- * U WGS-84 se bude zadavat a zobrazovat geodeticke souradnice:
- *    latitude: 50.4576&#176;
- * 	  longitude: 14.3986&#176;
- * 	  altitude: 289.15 m
- *
- * U S42 a S-JTSK se budou zadavat a zobrazovat souradnice v ortogon&#225;ln&#237;m syst&#233;mu: 
- * Pro S-JSTK se rozlisuji kvadranty - CR spada do 3.kvadrantu (X-ova souradnice bude vychazet zaporne)
- * Pro S-42 se rozlisuji pasy - CR spada do 3.pasu a &#269;&#225;st Karpat na Morav&#283; do 4.pasu
- * 		Y= 1002007 m 
- * 		X= 738791 m.
- * 		Z=  244 m
- */
-public class Transformation {
-    
-    private Logger logger;    
-    
-    private Double latitude;
-    private Double longitude;
-    private Double altitude;
-    private Double latitudeRAD;
-    private Double longitudeRAD;
-    private Double x;
-    private Double y;
-    private Double z;
-    private String coordinateSystem;
-    
-    public static final String WGS84 = &quot;WGS84&quot;;
-    public static final String SJTSK = &quot;S-JTSK&quot;;
-    public static final String S42 = &quot;S-42&quot;;
-    
-    //A = velka poloosa zplosteneho elipsoidu
-    //F = zplosteni elipsoidu
-    public static final Double ELIPSOID_WGS84_A = 6378137.0; //6377397,155
-    public static final Double ELIPSOID_WGS84_F = 298.257223563;
-    public static final Double ELIPSOID_BESSEL_A = 6377397.15508;
-    public static final Double ELIPSOID_BESSEL_F = 299.152812853;    
-    public static final Double ELIPSOID_KRAJOVSKIJ_A = 6378245.0;
-    public static final Double ELIPSOID_KRAJOVSKIJ_F = 298.3;    
-    
-    /**
-     * 
-     * Creates a new instance of Transformation 
-     * 
-     * 
-     * @param latitude
-     * @param longitude
-     * @param altitude
-     * @param coordinateSystem
-     */
-    public Transformation() {
-        
-        logger = Logger.getLogger(this.getClass().getPackage().getName());	                
-        
-    }
-    
-    
-     public static void main(String[] args) {
-            Transformation tr = new Transformation();
-            System.out.println(&quot;********************WGS84 --&gt; S-JTSK**************************&quot;);
-            Double[] coordinate_SJTSK = tr.transform_WGS84_to_SJTSK(50.4576163694, 14.3986, 289.155);
-            System.out.println(&quot;******************** S-JTSK --&gt; WGS84 **************************&quot;);
-            Double[] coordinate_WGS84_SJTSK = tr.transform_SJTSK_to_WGS84(coordinate_SJTSK[0], coordinate_SJTSK[1], coordinate_SJTSK[2]);
-            System.out.println(&quot;********************WGS84 --&gt; S-42**************************&quot;);
-            Double[] coordinate_S42 = tr.transform_WGS84_to_S42(50.4576163694, 14.3986, 289.155);
-            System.out.println(&quot;******************** S-42 --&gt; WGS84 **************************&quot;);                       
-            Double[] coordinate_WGS84_S42 = tr.transform_S42_to_WGS84(coordinate_S42[0], coordinate_S42[1], coordinate_S42[2]);            
-     }
-         
-    //**********************************************************************************************//
-    //**********************************  WGS-84  &lt;---&gt; S-JTSK ************************************//
-    //*********************************************************************************************//
-    /**
-     * Helmertova transformace (podm&#237;nka &quot;min max&quot;) 
-     * 
-     *  WGS-84 pou&#382;&#237;v&#225; elipsoid WGS-84, kde&#382;to S-JTSK pou&#382;&#237;v&#225; elipsoid Basse&#367;v (Elipsoidy se s r&#367;znou p&#345;esnost&#237; p&#345;ibli&#382;uj&#237; 
-     * zobecn&#283;n&#233;mu fyzik&#225;ln&#237;mu tvaru Zem&#283; - geoidu). 
-     *
-     *  Transformace z WGS84 do S-JTSK m&#225; dv&#283; &#269;&#225;sti:
-     *  1. transformace elipsoidu WGS84 na Bessel&#367;v elipsoid
-     *  2. transformace z Besselova elipsoidu do kart&#233;zsk&#233;ho sou&#345;. syst&#233;mu S-JTSK 
-     *
-     *  vraci JTSK sou&#345;adnice pro zadanou severn&#237; &#353;&#237;&#345;ku a v&#253;chodn&#237; d&#233;lku - zm&#283;&#345;enou GPS v sou&#345;adn&#233;m syst&#233;mu elipsoidu WGS84
-     * 
-     */
-    
-    public Double[] transform_WGS84_to_SJTSK(Double latitude, Double longitude, Double altitude) {
-        
-        //Transformace elipsoidu WGS84 na Bessel&#367;v elipsoid.
-        //WGS84 - transform latitude and longitude from degree to radiant format
-        Double[] geodeticCoordinateRAD_WGS = degreeToRadiant(latitude, longitude);   
-        System.out.println(&quot;from &quot; + latitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[0]);
-        System.out.println(&quot;from &quot; + longitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[1] + &quot;\n&quot;); 
-        //WGS84 - vypocet pravouhlych souradnic z geodetickych souradnic
-        Double[] cartesianCoordinate_WGS = WGS84_BLH_xyz(geodeticCoordinateRAD_WGS[0], geodeticCoordinateRAD_WGS[1], altitude); 
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[0]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[1]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[2] + &quot;\n&quot;);
-        //transformace prostorov&#253;ch pravo&#250;hl&#253;ch sou&#345;adnic do syst&#233;mu S-JTSK
-        Double[] cartesianCoordinate_SJTSK = transformation_WGS84_SJTSK_xyz_xyz(cartesianCoordinate_WGS[0], cartesianCoordinate_WGS[1], cartesianCoordinate_WGS[2]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[0]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[1]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[2] + &quot;\n&quot;);
-        //S-JTSK - vypocet geodetickych souradnic z pravouhlych souradnic
-        Double[] geodeticCoordinateRAD_SJTSK = bessel_xyz_BLH(cartesianCoordinate_SJTSK[0], cartesianCoordinate_SJTSK[1], cartesianCoordinate_SJTSK[2]);      
-        System.out.println(&quot;SJTSK - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_SJTSK[0]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_SJTSK[1]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_SJTSK[2] + &quot;\n&quot;);        
-        //S-JTSK - transform latitude and longitude from radiant to degree format
-        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_SJTSK[0], geodeticCoordinateRAD_SJTSK[1]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + latLong[0]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + latLong[1]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_SJTSK[2] + &quot;\n&quot;);        
-         
-        Double[] planarCoordinate = krovak_BLH_xy(latLong[0], latLong[1], geodeticCoordinateRAD_SJTSK[2]);       
-        System.out.println(&quot;SJTSK - planar souradnice (X): &quot; + planarCoordinate[0]);
-        System.out.println(&quot;SJTSK - planar souradnice (Y): &quot; + planarCoordinate[1]);
-        System.out.println(&quot;SJTSK (Z): &quot; + planarCoordinate[2] + &quot;\n&quot;);
-        
-        return planarCoordinate;
-    }
-    
-    public Double[] transform_SJTSK_to_WGS84(Double x, Double y, Double z) {
-                 
-        //Prepocet z S-JTSK  ... uz dostanu hodnoty v radianech
-        Double[] geodeticCoordinate = kovak_xy_BLH(x, y, z);
-        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + geodeticCoordinate[0]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + geodeticCoordinate[1]);
-        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinate[2] + &quot;\n&quot;);                      
-        //Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
-        Double[] cartesianCoordinate = bessel_BLH_xyz(geodeticCoordinate[0], geodeticCoordinate[1], geodeticCoordinate[2]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[0]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[1]);
-        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[2] + &quot;\n&quot;);
-        //Transformace pravouhlych souradnic z S-JTSK do WGS84
-        Double[] cartesianCoordinate_WGS84 = transformation_SJTSK_WGS84_xyz_xyz(cartesianCoordinate[0], cartesianCoordinate[1], cartesianCoordinate[2]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[0]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[1]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[2] + &quot;\n&quot;);
-        //Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
-        Double[] geodeticCoordinateRAD_WGS84 = WGS84_xyz_BLH(cartesianCoordinate_WGS84[0], cartesianCoordinate_WGS84[1], cartesianCoordinate_WGS84[2]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[0]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[1]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[2] + &quot;\n&quot;);
-        //Transformation latitude and longitude from radiant to degree 
-        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_WGS84[0], geodeticCoordinateRAD_WGS84[1]);
-        Double[] geodeticCoordinate_WGS84 = new Double[3];
-        geodeticCoordinate_WGS84[0] = latLong[0];
-        geodeticCoordinate_WGS84[1] = latLong[1];
-        geodeticCoordinate_WGS84[2] = geodeticCoordinateRAD_WGS84[2];
-        
-        System.out.println(&quot;WGS84 latitude: &quot;+ geodeticCoordinate_WGS84[0]);
-        System.out.println(&quot;WGS84 longitude: &quot; + geodeticCoordinate_WGS84[1]);
-        System.out.println(&quot;WGS84 altitude: &quot; + geodeticCoordinate_WGS84[2] + &quot;\n&quot;);
-        
-        return geodeticCoordinate_WGS84;
-    }      
-    
-    //**********************************************************************************************//
-    //**********************************  WGS-84  &lt;---&gt; S-42 ************************************//
-    //*********************************************************************************************//
-    
-    public Double[] transform_WGS84_to_S42(Double latitude, Double longitude, Double altitude) {
-                
-        //WGS84 - transform latitude and longitude from degree to radiant format
-        Double[] geodeticCoordinateRAD_WGS = degreeToRadiant(latitude, longitude);   
-        System.out.println(&quot;from &quot; + latitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[0]);
-        System.out.println(&quot;from &quot; + longitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[1] + &quot;\n&quot;); 
-        //WGS84 - vypocet pravouhlych souradnic z geodetickych souradnic
-        Double[] cartesianCoordinate_WGS = WGS84_BLH_xyz(geodeticCoordinateRAD_WGS[0], geodeticCoordinateRAD_WGS[1], altitude); 
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[0]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[1]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[2] + &quot;\n&quot;);
-        //transformace prostorov&#253;ch pravo&#250;hl&#253;ch sou&#345;adnic do syst&#233;mu S-42
-        Double[] cartesianCoordinate_S42 = this.transformation_WGS84_S42_xyz_xyz(cartesianCoordinate_WGS[0], cartesianCoordinate_WGS[1], cartesianCoordinate_WGS[2]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[0]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[1]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[2] + &quot;\n&quot;);
-        //S-42 - vypocet geodetickych souradnic z pravouhlych souradnic
-        Double[] geodeticCoordinateRAD_S42 = this.krajovskij_xyz_BLH(cartesianCoordinate_S42[0], cartesianCoordinate_S42[1], cartesianCoordinate_S42[2]);      
-        System.out.println(&quot;S42 - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_S42[0]);
-        System.out.println(&quot;S42 - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_S42[1]);
-        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);        
-        //S-42 - transform latitude and longitude from radiant to degree format
-        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_S42[0], geodeticCoordinateRAD_S42[1]);
-        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + latLong[0]);
-        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + latLong[1]);
-        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);        
-                 
-        Double[] coordinate = transformatin_S42_BLH_xy(geodeticCoordinateRAD_S42[0], geodeticCoordinateRAD_S42[1]);               
-        System.out.println(&quot;S42 - planar souradnice (X): &quot; + coordinate[0]);
-        System.out.println(&quot;S42 - planar souradnice (Y): &quot; + coordinate[1]);
-        System.out.println(&quot;S42 (Z): &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);
-        
-        Double[] planarCoordinate = new Double[3];
-        planarCoordinate[0] = coordinate[0];
-        planarCoordinate[1] = coordinate[1];
-        planarCoordinate[2] = geodeticCoordinateRAD_S42[2];
-               
-        return planarCoordinate;
-    }
-      
-    
-     public Double[] transform_S42_to_WGS84(Double x, Double y, Double z) {
-         
-         //Prepocet z S-42 do WGS-84 ... uz dostanu hodnoty v radianech
-         //!!!!!FIXME - v teto funkci je chyba
-        //Double[] geodeticCoordinate = transformation_S42_xy_BLH(x, y, z);
-    	 Double[] geodeticCoordinate = S42_xy_BLH(x, y, z);
-        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + geodeticCoordinate[0]);
-        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + geodeticCoordinate[1]);
-        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinate[2] + &quot;\n&quot;);                      
-        //Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
-        Double[] cartesianCoordinate = krajovskij_BLH_xyz(geodeticCoordinate[0], geodeticCoordinate[1], geodeticCoordinate[2]);
-        //Double[] cartesianCoordinate = krajovskij_BLH_xyz(0.8806574639397869, 0.25133270679766656, geodeticCoordinate[2]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[0]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[1]);
-        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[2] + &quot;\n&quot;);
-        //Transformace pravouhlych souradnic z S-42 do WGS84
-        Double[] cartesianCoordinate_WGS84 = transformation_S42_WGS84_xyz_xyz(cartesianCoordinate[0], cartesianCoordinate[1], cartesianCoordinate[2]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[0]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[1]);
-        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[2] + &quot;\n&quot;);
-        //Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
-        Double[] geodeticCoordinateRAD_WGS84 = WGS84_xyz_BLH(cartesianCoordinate_WGS84[0], cartesianCoordinate_WGS84[1], cartesianCoordinate_WGS84[2]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[0]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[1]);
-        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[2] + &quot;\n&quot;);
-        //Transformation latitude and longitude from radiant to degree 
-        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_WGS84[0], geodeticCoordinateRAD_WGS84[1]);
-        Double[] geodeticCoordinate_WGS84 = new Double[3];
-        geodeticCoordinate_WGS84[0] = latLong[0];
-        geodeticCoordinate_WGS84[1] = latLong[1];
-        geodeticCoordinate_WGS84[2] = geodeticCoordinateRAD_WGS84[2];
-        
-        System.out.println(&quot;WGS84 latitude: &quot;+ geodeticCoordinate_WGS84[0]);
-        System.out.println(&quot;WGS84 longitude: &quot; + geodeticCoordinate_WGS84[1]);
-        System.out.println(&quot;WGS84 altitude: &quot; + geodeticCoordinate_WGS84[2] + &quot;\n&quot;);
-        
-        return geodeticCoordinate_WGS84;
-     }
-        
-    //*******************************************************************************************//
-    //*********************** Planar coordinates ***********************************************//
-    //******************************************************************************************//    
-    
-    /**    
-     *   Prepocet z S-JTSk do WGS-84
-     *   (Krovak projection (used in the S-JTSK coordinate system))
-     */    
-    public Double[] kovak_xy_BLH(Double x, Double y, Double altitude) {
-          
-        //konstanty prouzite pro transformaci
-        double a     = 6377397.15508;   //polomer Gausseovy koule (6380065.5402 metr&#367;)
-        double e     = 0.081696831215303;
-        double n     = 0.97992470462083;
-        double rho_0 = 12310230.12797036;
-        double sinUQ = 0.863499969506341; //kulova sirka odpovidajici zemepisne sirce 49&#176;30`
-        double cosUQ = 0.504348889819882;
-        double sinVQ = 0.420215144586493;
-        double cosVQ = 0.907424504992097;
-        double alfa  = 1.000597498371542; //koustanta pro vypocet sfericke sirky a delky
-        double k_2   = 1.003419163966575;  //koustanta pro vypocet sfericke sirky a delky             
-        
-        double ro = Math.sqrt(Math.pow(x,2)+ Math.pow(y,2));
-        double epsilon = 2.* Math.atan(y/(ro+x));
-        double d = epsilon/n; 
-        double s = 2.* Math.atan(Math.exp(1./ n* Math.log(rho_0 / ro)))- Math.PI/2.;
-        double sinS = Math.sin(s); 
-        double cosS = Math.cos(s);
-        double sinU = sinUQ * sinS - cosUQ * cosS * Math.cos(d); 
-        double cosU = Math.sqrt(1.- Math.pow(sinU, 2));
-        double sinDV = Math.sin(d) * cosS/cosU; 
-        double cosDV = Math.sqrt(1.-Math.pow(sinDV,2));
-        double sinV = sinVQ * cosDV - cosVQ * sinDV; 
-        double cosV = cosVQ * cosDV + sinVQ * sinDV;
-        double longitude = 2.* Math.atan(sinV / (1.+ cosV))/alfa;
-        double t = Math.exp(2./alfa * Math.log((1.+ sinU)/cosU/k_2));
-        double pom = (t-1.)/(t+1.);
-        double sinB;
-        do {
-           sinB = pom;
-           pom = t * Math.exp(e * Math.log((1.+ e * sinB)/(1. - e * sinB))); 
-           pom = (pom-1)/(pom+1);
-      } while (Math.abs(pom - sinB) &gt; 1.e-15);
-       double latitude = Math.atan(pom/Math.sqrt(1.- Math.pow(pom,2)));
-  
-      // this is an appropriate heigth correction                  
-
-       Double[] geologicCoordinate = new Double[3];
-       geologicCoordinate[0] = latitude;
-       geologicCoordinate[1] = longitude;
-       geologicCoordinate[2] = altitude;
-       
-       return geologicCoordinate;       
-        
-    }
-    
-    /**
-     * Transformace souradnic ze systemu WGS-84 do systemu S-JTSK.
-     *
-     * vraci JTSK sou&#345;adnice pro zadanou Severn&#237; &#353;&#237;&#345;ku a v&#253;chodn&#237; d&#233;lku  
-     * Zobrazeni zemepisnych souradnic na pravouhle:
-     *  - zobrazeni Besselova elipsoidu  na Gausseovu kouli
-     *  - vypocet kartografickych souradnic na Gaussove kouli s posunutym polem Q o souradnicich 48&#176;15`, 42&#176;30`.
-     *  - konformni kuzelove zobrazeni s tecnym kuzelem na zakladni rovnobezce
-     *  - dopocitani pravouhlych souradnic
-     */
-    public Double[] krovak_BLH_xy(Double latitude, Double longitude, Double altitude) {      
-       
-        //konstanty prouzite pro transformaci
-        double a     = 6377397.15508;   //polomer Gausseovy koule (6380065.5402 metr&#367;)
-        double e     = 0.081696831215303;
-        double n     = 0.97992470462083;
-        double rho_0 = 12310230.12797036; //1298039,0046
-        double sinUQ = 0.863499969506341; //kulova sirka odpovidajici zemepisne sirce 49&#176;30`
-        double cosUQ = 0.504348889819882;
-        double sinVQ = 0.420215144586493;
-        double cosVQ = 0.907424504992097;
-        double alfa  = 1.000597498371542; //koustanta pro vypocet sfericke sirky a delky
-        double k_2   = 1.00685001861538;  //koustanta pro vypocet sfericke sirky a delky
-           
-       Double[] coordinateRAD = degreeToRadiant(latitude, longitude);
-       latitude = coordinateRAD[0]; 
-       longitude = coordinateRAD[1];
-       
-       double sinB = Math.sin(latitude);
-       double t = (1-e*sinB)/(1+e*sinB);
-              t = Math.pow(1+sinB,2)/(1- Math.pow(sinB,2)) * Math.exp(e*Math.log(t));
-              t = k_2 * Math.exp(alfa * Math.log(t));
-
-       double sinU  = (t-1)/(t+1);
-       double cosU  = Math.sqrt(1-Math.pow(sinU,2));
-       double V = alfa * longitude;
-       double sinV  = Math.sin(V);
-       double cosV  = Math.cos(V);
-       double cosDV = cosVQ * cosV + sinVQ * sinV;
-       double sinDV = sinVQ * cosV - cosVQ * sinV;
-       double sinS  = sinUQ*sinU + cosUQ*cosU*cosDV;
-       double cosS  = Math.sqrt(1-sinS*sinS);
-       double sinD  = sinDV * cosU/cosS;
-       double cosD  = Math.sqrt(1-sinD*sinD);
-       
-       double eps = n * Math.atan(sinD/cosD);
-       double rho = rho_0 * Math.exp(-n * Math.log((1+sinS)/cosS));
-
-       Double[] planarCoordinate = new Double[3];
-       planarCoordinate[0] = rho * Math.cos(eps); //x
-       planarCoordinate[1] = rho * Math.sin(eps); //y
-       planarCoordinate[2] = altitude;
-       
-       return planarCoordinate;       
-    }        
- 
-    //*******************************************************************************************//
-    //***************** S-42  Orthogonal coordinates --&gt; geodetic coordinate*********************//
-    //******************************************************************************************//   
-    
-    public Double[] S42_xy_BLH(Double x, Double y, Double z) {
-    	//VYPOCET S-42 ortogonalni system --&gt; S-42 geodeticky system
-
-    	double A2 = x;
-    	double B2 = y;
-    	double C2 = 6378245;
-    	double D2 = 0.0818133340169312;
-    	double E2 = 500000+Math.rint(A2/1000000)*1000000;
-    	double F2 = 0;
-    	double G2 = 21+6*(Math.rint(A2/1000000)-4);
-    	double H2 = G2*Math.PI/180;
-    	double I2 = 0;
-    	double J2 = I2*Math.PI/180;
-    	double K2 = 1;
-    	double L2 = A2-E2;
-    	double M2 = B2-F2;
-    	double N2 = (1-Math.sqrt(1-D2*D2))/(1+ Math.sqrt(1-D2*D2));
-    	double O2 = C2*(J2*(1-D2*D2/4-3*Math.pow(D2,4)/64-5*Math.pow(D2,6)/256)-Math.sin(2*J2)*(3*D2*D2/8+3*Math.pow(D2,4)/32+45*Math.pow(D2,6)/1024)+Math.sin(4*J2)*(15*Math.pow(D2,4)/256+45*Math.pow(D2,6)/1024)-Math.sin(6*J2)*35*Math.pow(D2,6)/3072);
-    	double P2 = O2+M2/K2;
-    	double Q2 = P2/(C2*(1-D2*D2/4-3*Math.pow(D2,4)/64-5*Math.pow(D2,6)/256));
-    	double R2 = Q2+Math.sin(2*Q2)*(3*N2/2-27*Math.pow(N2,3)/32)+Math.sin(4*Q2)*(21*N2*N2/16-55*Math.pow(N2,4)/32)+Math.sin(6*Q2)*151*Math.pow(N2,3)/96+Math.sin(8*Q2)*1097*Math.pow(N2,4)/512;
-    	double S2 = D2*D2/(1-D2*D2);
-    	double T2 = S2*Math.cos(R2)*Math.cos(R2);
-    	double U2 = Math.tan(R2)*Math.tan(R2);
-    	double V2 = C2/Math.sqrt(1-D2*D2*Math.sin(R2)*Math.sin(R2));
-    	double W2 = C2*(1-D2*D2)/Math.sqrt(1-D2*D2*Math.sin(R2)*Math.sin(R2));
-    	double X2 = L2/(V2*K2);
-    	double Z2 = H2+(X2-(1+2*U2+T2)*Math.pow(X2,3)/6+(5-2*T2+28*U2-3*T2*T2+8*S2+24*U2*U2)*Math.pow(X2,5)/120)/Math.cos(R2);
-    	double Y2 = R2-(V2*Math.tan(R2)/W2)*(X2*X2/2-(5+3*U2+10*T2-4*T2*T2-9*S2)*Math.pow(X2,4)/24+(61+90*U2+298*T2+45*U2*U2-252*S2-3*T2*T2)*Math.pow(X2,6)/720);
-    	//latitude
-    	double lambda = Z2*180/Math.PI;
-    	//longitude
-    	double fi = Y2 * 180/Math.PI; //prevod na stupne z radianu    	
-    	
-    	Double[] coordinate = new Double[3];
-    	coordinate[0] = Math.toRadians(fi);
-    	coordinate[1] = Math.toRadians(lambda);
-    	coordinate[2] = z;
-    	
-    	return coordinate;
-    }
-    
-    //*******************************************************************************************//
-    //***************** S-42  Planar coordinates ***********************************************//
-    //******************************************************************************************//    
- 
-    /**
-     *  Mercator projection for the S42 coordinate system
-     *
-     */ 
-    public Double[] transformatin_S42_BLH_xy(Double phi, Double lambda) {               
-       
-        // parameters of the Krasovskij ellipsoid
-        double elipsoid_a = ELIPSOID_KRAJOVSKIJ_A; 
-        double elipsoid_f = ELIPSOID_KRAJOVSKIJ_F;
-
-        // parameters of the S-42 coordinate system (3rd belt)
-       double no = 0;
-       double eo = 3500000;
-       double fo = 1;
-       double phi0 = Math.toRadians(0);
-       double lambda0 = Math.toRadians(15);
-       double b = elipsoid_a - elipsoid_a/elipsoid_f;
-
-       Double[] listEN = transverseMercator_BLH_XY(phi, lambda, no, eo, fo, phi0, lambda0, elipsoid_a, b);
-      
-       return listEN;
-    }
-    
-    /**
-     * Mercator projection for the S42 coordinate system
-     * (the 3rd belt suitable for the Czech Republic)
-     *
-     */
-    public Double[] transformation_S42_xy_BLH(Double e, Double n, Double altitude) {
-             
-        // parameters of the Krasovskij ellipsoid 
-        double elipsoid_a = ELIPSOID_KRAJOVSKIJ_A; 
-        double elipsoid_f = ELIPSOID_KRAJOVSKIJ_F;
-
-
-        // parameters of the S-42 coordinate system (3rd belt)
-       double no = 0;
-       double eo = 3500000;
-       double fo = 1;
-       double phi0 = Math.toRadians(0);
-       double lambda0 = Math.toRadians(15);
-       double b = elipsoid_a - (elipsoid_a/elipsoid_f);
-          
-       Double[] listPhiLambda = mercator_XY_BLH(e, n, no, eo, fo, phi0, lambda0, elipsoid_a, b);      
-       Double[] value = new Double[3];
-       value[0] = listPhiLambda[0];
-       value[1] = listPhiLambda[1];
-       value[2] = altitude;          
-       return value;
-    }    
-    
-    /**
-     *
-     *
-     */
-    public Double[] transverseMercator_BLH_XY(double phi, double lambda, double no, double eo, double fo, double phi0, double lambda0, double elipsoid_a, double b) {
-                
-        double e2 = (Math.pow(elipsoid_a,2) - Math.pow(b, 2)) / Math.pow(elipsoid_a,2);
-        double n = (elipsoid_a - b) / (elipsoid_a + b);
-        double sinphi = Math.sin(phi);       
-        double e2sinphi2 = 1 - e2 * Math.pow(sinphi, 2);
-        double nu = elipsoid_a * fo / Math.sqrt(e2sinphi2);
-        double rho = elipsoid_a * fo * (1 - e2) / Math.sqrt( Math.pow(e2sinphi2, 3));
-        double eta2 = nu / rho - 1;
-        
-        double n2 = Math.pow(n,2);
-        double n3 = Math.pow(n, 3);
-        
-        double m = b * fo *(
-              (1 + n + 5/4*n2 + 5/4*n3) * (phi - phi0)
-              - (3*n + 3*n2 + 21/8*n3) * Math.sin(phi - phi0) * Math.cos(phi + phi0)
-              + (15/8*n2 + 15/8*n3) * Math.sin(2*(phi - phi0)) * Math.cos(2*(phi + phi0))
-              - 35/24*n3 * Math.sin(3*(phi - phi0)) * Math.cos(3*(phi-phi0))
-              );
-        
-        double cosphi = Math.cos(phi);
-        double tanphi = Math.tan(phi);
-     
-        double i = m + no;
-        double ii = nu/2 * sinphi * cosphi;
-        double iii = nu/24 * sinphi* Math.pow(cosphi,3) * (5 - Math.pow(tanphi,2) + 9 * eta2);
-        double iiia = nu/720 * sinphi * Math.pow(cosphi,5) * (61 - 58 * Math.pow(tanphi,2) + Math.pow(tanphi,4));
-        double iv = nu * cosphi;
-        double v = nu/6 * Math.pow(cosphi,3) * (nu/rho - Math.pow(tanphi,2));
-        double vi = nu/120 * Math.pow(cosphi,5) * (5 - 18* Math.pow(tanphi,2) + Math.pow(tanphi,4) + 14 * eta2 - 58 * Math.pow(tanphi,2) * eta2);
-
-        double llo = lambda - lambda0;
-        n = i + ii * Math.pow(llo,2) + iii * Math.pow(llo,4) + iiia * Math.pow(llo,6);
-        double e = eo + iv * llo + v * Math.pow(llo,3) + vi * Math.pow(llo,5);
-        
-        Double[] value = new Double[2];
-        value[0] = e;
-        value[1] = n;
-        
-        return value;
-    }
-    
-    /**
-     *
-     *
-     */
-    public Double[] mercator_XY_BLH(double e, double n, double no, double eo, double fo, double phi0, double lambda0, double elipsoid_a, double b){
-        
-        double phid = (n-no) / (elipsoid_a * fo) + phi0;
-
-        n = (elipsoid_a - b) / (elipsoid_a + b);
-        double n2 = Math.pow(n,2);
-        double n3 = Math.pow(n,3);
-        double m = 0;
-        
-        int i1st = 0;
-        do {
-            if (i1st &gt; 0) 
-                phid = (n - no - m) / (elipsoid_a * fo) + phid;
-            i1st++;
-
-            m = b * fo *(
-              (1 + n + 5/4*n2 + 5/4*n3) * (phid - phi0)
-              - (3*n + 3*n2 + 21/8*n3) * Math.sin(phid - phi0) * Math.cos(phid + phi0)
-              + (15/8*n2 + 15/8*n3) * Math.sin(2*(phid - phi0)) * Math.cos(2*(phid + phi0))
-              - 35/24*n3 * Math.sin(3*(phid - phi0)) * Math.cos(3*(phid-phi0))
-              );
-
-          } while (Math.abs(n-no-m) &gt; 1.e-4);
-
-          double e2 = (Math.pow(elipsoid_a,2) - Math.pow(b, 2)) / Math.pow(elipsoid_a,2);
-          double sinphi = Math.sin(phid);	// tady je zrejme phi        
-          double e2sinphi2 = 1 - e2 * Math.pow(sinphi, 2);
-          double nu = elipsoid_a * fo / Math.sqrt(e2sinphi2);
-          double rho = elipsoid_a * fo * (1 - e2) / Math.sqrt( Math.pow(e2sinphi2, 3));
-          double eta2 = nu / rho - 1;
-          
-          double secphid = 1./ Math.cos(phid);
-          double tanphid = Math.tan(phid);         
-
-          double vii = tanphid/(2 * rho * nu);
-          double viii = tanphid/(24 * rho * Math.pow(nu,3)) * (5 + 3* Math.pow(tanphid,2) + eta2 - 9 * Math.pow(tanphid,2) * eta2);
-          double ix = tanphid/(720 * rho * Math.pow(nu,5)) * (61 + 90 * Math.pow(tanphid,2) + 45 * Math.pow(tanphid,4));
-          double x = secphid / nu;
-          double xi = secphid/(6 * Math.pow(nu,3)) * (nu/rho + 2 * Math.pow(tanphid,2));
-          double xii = secphid/(120 * Math.pow(nu,5)) * (5 + 28 * Math.pow(tanphid,2) + 24 * Math.pow(tanphid,4));
-          double xiia = secphid/(5040* Math.pow(nu,7)) * (61 + 662 * Math.pow(tanphid,2) + 1320 * Math.pow(tanphid,4) + 720 * Math.pow(tanphid,6));
-
-          double eeo = e - eo;
-          double phi = phid - vii * Math.pow(eeo,2) + viii * Math.pow(eeo,4) - ix * Math.pow(eeo,6);
-          double lambda = lambda0 + x * eeo - xi * Math.pow(eeo,3) + xii * Math.pow(eeo,5) - xiia * Math.pow(eeo,7);
-
-          Double[] value = new Double[2];
-          value[0] = phi;
-          value[1] = lambda;                   
-          
-          return value;
-    }
-    
-    //****************************************************************************************//
-    //******** Convergetion between geological coordinate and cartesian coordinate ***********//
-    //***************************************************************************************//
-    
-    /**
-     *  Vypocet geodetickych souradnic z pravouhlych souradnic pro urcity elipsoid
-     */
-    public Double[] ellipsoid_xyz_BLH(Double x, Double y, Double z, Double elipsoid_a, Double elipsoid_f) {
-
-          double a_b = elipsoid_f/(elipsoid_f - 1);      
-          double p = Math.sqrt(Math.pow(x,2) + Math.pow(y,2));      
-          double e2 = 1 - Math.pow((1 - 1 /elipsoid_f), 2);      
-          double th = Math.atan(z * a_b / p); 
-          double sinth = Math.sin(th);
-          double costh = Math.cos(th);          
-          double t = (z + e2 * a_b * elipsoid_a * Math.pow(sinth,3)) / (p - e2 * elipsoid_a * Math.pow(costh,3));  
-        
-          Double[] geodeticCoordinate = new Double[3];
-          //latitude
-          geodeticCoordinate[0] = Math.atan(t);
-          //longitude
-          geodeticCoordinate[1] = 2 * Math.atan(y / (p + x));
-          //altitude
-          geodeticCoordinate[2] =  Math.sqrt(1 + Math.pow(t, 2)) * (p - elipsoid_a / Math.sqrt(1 + (1 - e2) * Math.pow(t, 2)));            
-          
-          return geodeticCoordinate;       
-      }
-    
-    /**
-     * Vypocet pravouhlych souradnic z geodetickych souradnic pro dany elipsoid
-     * (phi = B, lambda = L )
-     *
-     * @param  zem&#283;pisn&#225; geodetick&#225; &#353;&#237;&#345;ka &#966; je &#250;hel, kter&#253; sv&#237;r&#225; rovina rovn&#237;ku s norm&#225;lou k plo&#353;e elipsoidu (kladn&#225; na sever)
-     * @param zem&#283;pisn&#225; geodetick&#225; d&#233;lka &#955; je &#250;hel, kter&#253; sv&#237;r&#225; rovina m&#237;stn&#237;ho poledn&#237;ku s rovinou z&#225;kladn&#237;ho poledn&#237;ku (kladn&#225; na v&#253;chod),
-     * @param elipsoidick&#225; v&#253;&#353;ka H je vzd&#225;lenost od elipsoidu, m&#283;&#345;en&#225; po norm&#225;le (kladn&#225; vn&#283; elipsoidu)
-     *
-     */
-    public Double[] ellipsoid_BLH_xyz(Double latitude, Double longitude, Double altitude, Double elipsoid_a, Double elipsoid_f) {
-       
-        //e = excentricita elipsoidu
-        Double e2 = 1 - Math.pow(1 - 1 / elipsoid_f, 2);
-        //rho = pricny polomer krivosti
-        Double rho = elipsoid_a/Math.sqrt(1 - e2 * Math.pow(Math.sin(latitude),2));          
-        //pravouhle souradnice
-        Double[] cartesianCoordinate = new Double[3];
-        cartesianCoordinate[0] = (rho + altitude) * Math.cos(latitude) * Math.cos(longitude); //x
-        cartesianCoordinate[1] = (rho + altitude) * Math.cos(latitude) * Math.sin(longitude); //y
-        cartesianCoordinate[2] = ((1-e2)*rho + altitude) * Math.sin(latitude);  //z
-                
-        return cartesianCoordinate;
-    }
-    
-    /**
-     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid WGS84
-     *     
-     */
-    public Double[] WGS84_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
-       
-        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_WGS84_A, ELIPSOID_WGS84_F);        
-        return cartesianCoordinate;
-    }
-    
-    /**
-     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
-     *
-     */
-    public Double[] WGS84_xyz_BLH(Double x, Double y, Double z) {        
-     
-        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_WGS84_A, ELIPSOID_WGS84_F);
-        return geodeticCoordinate;
-      }        
-    
-    /**
-     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
-     *     
-     */
-    public Double[] bessel_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
-       
-        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_BESSEL_A, ELIPSOID_BESSEL_F);        
-        return cartesianCoordinate;
-    }
-    
-    /**
-     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Bessel
-     *
-     */
-    public Double[] bessel_xyz_BLH(Double x, Double y, Double z) {        
-     
-        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_BESSEL_A, ELIPSOID_BESSEL_F);
-        return geodeticCoordinate;
-      }        
-    
-    /**
-     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Krajovskij
-     *     
-     */
-    public Double[] krajovskij_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
-       
-        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_KRAJOVSKIJ_A, ELIPSOID_KRAJOVSKIJ_F);        
-        return cartesianCoordinate;
-    }
-    
-    /**
-     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Krajovskij
-     *
-     */
-    public Double[] krajovskij_xyz_BLH(Double x, Double y, Double z) {        
-     
-        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_KRAJOVSKIJ_A, ELIPSOID_KRAJOVSKIJ_F);
-        return geodeticCoordinate;
-      }        
-    
-   
-    //*****************************************************************************************//
-    //***************** Transaction of the cartesian coordinates ******************************//
-    //****************************************************************************************//
-    
-    /**
-     * Hrdina (1997)
-     *
-     * Transformace pravouhlych souradnic z WGS84 do S-JTSK
-     */
-    public Double[] transformation_WGS84_SJTSK_xyz_xyz(Double xs, Double ys, Double zs) {
-        // koeficienty transformace ze systemu WGS-84 do systemu S-JTSK
-        //posunuti
-       double dx = -570.69; 
-       double dy = -85.69; 
-       double dz = -462.84; 
-       //rotace
-       double wx = 4.99821/3600 * Math.PI/180; 
-       double wy = 1.58676/3600 * Math.PI/180; 
-       double wz = 5.2611/3600 * Math.PI/180;
-       //meritko
-       double m  = -3.543e-6; 
-       
-       //Heltmert transform
-        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
-        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
-        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
-        
-        //save
-        Double[] cartesianCoordinateNew = new Double[3];
-        cartesianCoordinateNew[0] = xn;
-        cartesianCoordinateNew[1] = yn;
-        cartesianCoordinateNew[2] = zn;
-                
-        return cartesianCoordinateNew;
-    }
-    
-    /**
-     * Hrdina (2002)
-     *
-     * Transformace pravouhlych souradnic z S-JTSK do WGS84 
-     */
-    public Double[] transformation_SJTSK_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
-        // koeficienty transformace ze systemu S-JTSK do systemu WGS-84
-        //posunuti
-       double dx = 570.69; 
-       double dy = 85.69; 
-       double dz = 462.84; 
-       //rotace
-       double wx = -4.99821/3600 * Math.PI/180; 
-       double wy = -1.58676/3600 * Math.PI/180; 
-       double wz = -5.2611/3600 * Math.PI/180;
-       //meritko
-       double m  = 3.543e-6; 
-       
-       //Heltmert transform
-        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
-        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
-        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
-        
-        //save
-        Double[] cartesianCoordinateNew = new Double[3];
-        cartesianCoordinateNew[0] = xn;
-        cartesianCoordinateNew[1] = yn;
-        cartesianCoordinateNew[2] = zn;
-                
-        return cartesianCoordinateNew;
-    }
-    
-    /**
-     *
-     * Transformace pravouhlych souradnic z WGS84 do S42
-     */
-    public Double[] transformation_WGS84_S42_xyz_xyz(Double xs, Double ys, Double zs) {
-        // koeficienty transformace ze systemu WGS84 do systemu S42
-        //posunuti
-       double dx = -23; 
-       double dy = 124; 
-       double dz = 84; 
-       //rotace
-       double wx = -0.13/3600 * Math.PI/180; 
-       double wy = -0.25/3600 * Math.PI/180; 
-       double wz = 0.02/3600 * Math.PI/180;
-       //meritko
-       double m  = -1.1e-6; 
-       
-       //Heltmert transform
-        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
-        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
-        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
-        
-        //save
-        Double[] cartesianCoordinateNew = new Double[3];
-        cartesianCoordinateNew[0] = xn;
-        cartesianCoordinateNew[1] = yn;
-        cartesianCoordinateNew[2] = zn;
-                
-        return cartesianCoordinateNew;
-    }
-    
-    /**     
-     *
-     * Transformace pravouhlych souradnic z S42 do WGS84 
-     */
-    public Double[] transformation_S42_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
-        // koeficienty transformace ze systemu S42 do systemu WGS-84
-        //posunuti
-       double dx = 23; 
-       double dy = -124; 
-       double dz = -84; 
-       //rotace
-       double wx = 0.13/3600 * Math.PI/180; 
-       double wy = 0.25/3600 * Math.PI/180; 
-       double wz = -0.02/3600 * Math.PI/180;
-       //meritko
-       double m  = 1.1e-6; 
-       
-       //Heltmert transform
-        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
-        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
-        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
-        
-        //save
-        Double[] cartesianCoordinateNew = new Double[3];
-        cartesianCoordinateNew[0] = xn;
-        cartesianCoordinateNew[1] = yn;
-        cartesianCoordinateNew[2] = zn;
-                
-        return cartesianCoordinateNew;
-    }
-    
-    //**********************************************************************//
-    //******************* Radiant vs. Degree *******************************//
-    //**********************************************************************//
-    
-   /**
-   * transform latitude and longitude from degree to radiant format
-   * 
-   * @param latitude
-   * @param longitude
-   */
-  protected Double[] degreeToRadiant(double latitude, double longitude)
-  {
-      Double[] geodeticCoordinateRAD = new Double[2];
-      geodeticCoordinateRAD[0] = Math.toRadians(latitude);
-      geodeticCoordinateRAD[1] = Math.toRadians(longitude);
-      
-      //geodeticCoordinateRAD[0] = latitude;
-      //geodeticCoordinateRAD[1] = longitude;
-      
-      return geodeticCoordinateRAD;
-  }
-
-  /**
-   * transform latitude and longitude from radiant to degree format
-   * 
-   * @param latitude
-   * @param longitude
-   */
-  protected Double[] radiantToDegree(double latitudeRAD, double longitudeRAD)
-  {
-    Double[] geodeticCoordinate = new Double[2];  
-    geodeticCoordinate[0] = Math.toDegrees(latitudeRAD);
-    geodeticCoordinate[1] = Math.toDegrees(longitudeRAD);    
-    
-    //geodeticCoordinate[0] = latitudeRAD;
-    //geodeticCoordinate[1] = longitudeRAD;    
-    
-    return geodeticCoordinate;
-  }
-  
-}
\ No newline at end of file

Modified: trunk/src/net/sf/plantlore/client/overview/AddEdit.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/AddEdit.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -47,16 +47,17 @@
  * @author fraktalek
  */
 public class AddEdit extends Observable {
-    public static final int WGS84 = 1;
+    public static final int WGS84 = 0;
+    public static final int SJTSK = 1;
     public static final int S42 = 2;
-    public static final int SJTSK = 3;
     public static final String EMPTY_STRING = L10n.getString(&quot;Common.ComboboxNothingSelected&quot;);
-    public static final Pair&lt;String,Integer&gt; EMPTY_PAIR = new Pair&lt;String,Integer&gt;(EMPTY_STRING,-1);
-    
+    public static final Pair&lt;String,Integer&gt; EMPTY_PAIR = new Pair&lt;String,Integer&gt;(EMPTY_STRING,-1);            
+     
     private static Logger logger;
     private static DBLayer database;      
     
-    private int coordinateSystem;
+    private int coordinateSystem = 0;
+    private boolean isCancled = true;
     private Occurrence o; //original occurrence
     
     //list of authors user selects
@@ -131,7 +132,7 @@
     private Boolean editMode = false;
     private Boolean preloadAuthors = false;
     
-    private OccurrenceTableModel occurrenceTableModel;
+    private OccurrenceTableModel occurrenceTableModel;     
     
     /** Creates a new instance of AddEdit */
     public AddEdit(DBLayer database, Boolean editMode) {
@@ -628,7 +629,7 @@
     }
 
     public void setCoordinateSystem(int coordinateSystem) {
-        this.coordinateSystem = coordinateSystem;
+        this.coordinateSystem = coordinateSystem;       
         switch (coordinateSystem) {
             case WGS84:
                 logger.debug(&quot;CoordinateSystem set to WGS84&quot;);
@@ -1534,6 +1535,7 @@
         altitude = null;
         longitude = null;
         latitude = null;
+        setCoordinateSystem(AddEdit.WGS84);
 
         occurrenceTableModel.clear();
 
@@ -1568,6 +1570,58 @@
     public OccurrenceTableModel getOccurrenceTableModel() {
         return occurrenceTableModel;
     }
+    
+    /**
+     * Transformation coordinate system
+     * @param newSystem 
+     */
+    public void transformationCoordinateSystem(int selectedSystem) {
+        Transformation tr = new Transformation();
+        Double[] newCoordinate = new Double[3];
+        Double[] newCoordinateTmp = new Double[3];
+        //Check null value and set 0.0 if value is null      
+        if (latitude == null) latitude = 0.0;
+        if (longitude == null) longitude = 0.0;
+        if (altitude == null) altitude = 0.0;
+        //WGS-84 --&gt; S-JSTK
+        if (getCoordinateSystem() == AddEdit.WGS84 &amp;&amp; selectedSystem == AddEdit.SJTSK) {
+            newCoordinate = tr.transform_WGS84_to_SJTSK(latitude, longitude, altitude);
+        }
+        //S-JSTK --&gt; WGS-84
+        if (getCoordinateSystem() == AddEdit.SJTSK &amp;&amp; selectedSystem == AddEdit.WGS84) {
+            newCoordinate = tr.transform_SJTSK_to_WGS84(latitude, longitude, altitude);
+        }
+        //WGS-84 --&gt; S-42
+         if (getCoordinateSystem() == AddEdit.WGS84 &amp;&amp; selectedSystem == AddEdit.S42) {
+            newCoordinate = tr.transform_WGS84_to_S42(latitude, longitude, altitude);
+         }
+        //S-42 --&gt; WGA-84
+         if (getCoordinateSystem() == AddEdit.S42 &amp;&amp; selectedSystem == AddEdit.WGS84) {
+            newCoordinate = tr.transform_S42_to_WGS84(latitude, longitude, altitude);
+         }
+        //S-JSTK --&gt; S-42
+        if (getCoordinateSystem() == AddEdit.SJTSK &amp;&amp; selectedSystem == AddEdit.S42) {
+            newCoordinateTmp = tr.transform_SJTSK_to_WGS84(latitude, longitude, altitude);
+            newCoordinate  = tr.transform_WGS84_to_S42(newCoordinateTmp[0], newCoordinateTmp[1], newCoordinateTmp[2]);
+        }
+        //S-42 --&gt; S-JSTK
+        if (getCoordinateSystem() == AddEdit.S42 &amp;&amp; selectedSystem == AddEdit.SJTSK) {
+            newCoordinateTmp = tr.transform_S42_to_WGS84(latitude, longitude, altitude);
+            newCoordinate  = tr.transform_WGS84_to_SJTSK(newCoordinateTmp[0], newCoordinateTmp[1], newCoordinateTmp[2]);
+        }
+        this.setCoordinateSystem(selectedSystem);
+        this.setLatitude(newCoordinate[0]);
+        this.setLongitude(newCoordinate[1]);
+        this.setAltitude(newCoordinate[2]);
+    }     
+    
+    public void setIsCancle(boolean isCancle) {
+        this.isCancled = isCancle;
+    }
+    
+    public boolean getIsCancle() {
+        return this.isCancled;
+    }
 }
 
 

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditCtrl.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -75,8 +75,9 @@
     private boolean inAddMode = true;
     private AddEdit model;
     private AddEditView view;
-    private final static int MAXIMUM_FRACTION_DIGITS = 5;
-    private final static int MAXIMUM_INTEGER_DIGITS = 4;
+    private TransformationChangeView transformationView;
+    private final static int MAXIMUM_FRACTION_DIGITS = 8;
+    private final static int MAXIMUM_INTEGER_DIGITS = 8;
     private final static Color COLOR_INVALID = Color.RED;
     
     //--------------MODELS AND VIEWS THIS CONTROLLER CREATES-----------------
@@ -130,12 +131,12 @@
         //------- Buttons --------
         view.okButton.setAction(new OkButtonAction());
         view.cancelButton.setAction(new CancelButtonAction());
-        view.checklistButton.setAction(new ChecklistAction());
-        
+        view.checklistButton.setAction(new ChecklistAction());        
         view.clearLocationButton.setAction(new ClearLocationAction());
         view.clearOccurrenceButton.setAction(new ClearOccurrenceAction());
         view.calendarButton.setAction(new CalendarAction());
         view.settingsButton.setAction(new SettingsAction());
+        view.gpsChangeButton.setAction(new ChangeCoordinateSystemAction());
 //        view.preloadAuthorsCheckBox.addActionListener(new PreloadCheckBox());
     }
     
@@ -750,6 +751,21 @@
             settingsView.setVisible(true);
         }
     }//class SettingsAction
+    
+    class ChangeCoordinateSystemAction extends AbstractAction {
+        
+        public ChangeCoordinateSystemAction() {
+            putValue(NAME, L10n.getString(&quot;Common.GpsChange&quot;));
+            transformationView = new TransformationChangeView(view, model, true);
+            new TransformationChangeCtrl(model, transformationView); 
+        }
+        public void actionPerformed(ActionEvent e) {                       
+            transformationView.setVisible(true);         
+            if (model.getIsCancle()) return;
+            model.setIsCancle(true);
+            view.loadComponetCoordinate();
+        }
+    }
 }
 
 

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.form	2006-08-28 18:00:44 UTC (rev 586)
@@ -169,7 +169,7 @@
                                                       &lt;EmptySpace min=&quot;-2&quot; pref=&quot;434&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                                   &lt;/Group&gt;
                                                   &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                                                      &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;536&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                                      &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;530&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                                                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                                   &lt;/Group&gt;
                                               &lt;/Group&gt;
@@ -612,13 +612,13 @@
                                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                                           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                                               &lt;Component id=&quot;checklistButton&quot; linkSize=&quot;21&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                              &lt;EmptySpace pref=&quot;232&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                                              &lt;EmptySpace pref=&quot;340&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                                               &lt;Component id=&quot;clearOccurrenceButton&quot; linkSize=&quot;21&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                           &lt;/Group&gt;
                                           &lt;Component id=&quot;jPanel4&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                                       &lt;/Group&gt;
                                   &lt;/Group&gt;
-                                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;645&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;658&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                               &lt;/Group&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
@@ -631,11 +631,11 @@
                                       &lt;/Group&gt;
                                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;herbariumTextField&quot; alignment=&quot;0&quot; pref=&quot;132&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                          &lt;Component id=&quot;publicationCombo&quot; alignment=&quot;0&quot; pref=&quot;132&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                          &lt;Component id=&quot;projectCombo&quot; alignment=&quot;0&quot; pref=&quot;132&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                          &lt;Component id=&quot;herbariumTextField&quot; alignment=&quot;0&quot; pref=&quot;146&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                          &lt;Component id=&quot;publicationCombo&quot; alignment=&quot;0&quot; pref=&quot;146&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                          &lt;Component id=&quot;projectCombo&quot; alignment=&quot;0&quot; pref=&quot;146&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                                           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                              &lt;Component id=&quot;sourceCombo&quot; pref=&quot;132&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                                              &lt;Component id=&quot;sourceCombo&quot; pref=&quot;146&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                           &lt;/Group&gt;
                                       &lt;/Group&gt;
@@ -1067,7 +1067,7 @@
                           &lt;Component id=&quot;settingsButton&quot; linkSize=&quot;12&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace min=&quot;-2&quot; pref=&quot;64&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;requiredInfoLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;EmptySpace pref=&quot;350&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace pref=&quot;436&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;okButton&quot; linkSize=&quot;12&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;cancelButton&quot; linkSize=&quot;12&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -1086,7 +1086,7 @@
                               &lt;Component id=&quot;okButton&quot; linkSize=&quot;13&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;Component id=&quot;requiredInfoLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
-                          &lt;EmptySpace pref=&quot;13&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace pref=&quot;16&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
                 &lt;/DimensionLayout&gt;
@@ -1162,7 +1162,7 @@
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;jScrollPane6&quot; pref=&quot;906&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;jScrollPane6&quot; pref=&quot;905&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;

Modified: trunk/src/net/sf/plantlore/client/overview/AddEditView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/AddEditView.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -858,20 +858,44 @@
             tableModel.reset();
     }
     
+    
+    public void loadComponetCoordinate() {
+         switch (model.getCoordinateSystem()) {
+            case AddEdit.WGS84:
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: WGS-84&quot;);
+                break;
+            case AddEdit.S42:
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: S-42&quot;);
+                break;
+            case AddEdit.SJTSK:
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: S-JTSK&quot;);
+                break;
+            default:
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: WGS-84&quot;);
+        }
+         
+         if (model.getAltitude() != null) altitudeTextField.setText(&quot;&quot;+numberFormat.format(model.getAltitude()));
+            else altitudeTextField.setText(&quot;&quot;);
+        if (model.getLongitude() != null) longitudeTextField.setText(&quot;&quot;+numberFormat.format(model.getLongitude()));
+            else longitudeTextField.setText(&quot;&quot;);
+        if (model.getLatitude() != null) latitudeTextField.setText(&quot;&quot;+numberFormat.format(model.getLatitude()));
+            else latitudeTextField.setText(&quot;&quot;);
+    }
+    
     public void loadComponentData()
     {
         switch (model.getCoordinateSystem()) {
             case AddEdit.WGS84:
-                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot; WGS84&quot;);
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: WGS-84&quot;);
                 break;
             case AddEdit.S42:
-                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot; S42&quot;);
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: S-42&quot;);
                 break;
             case AddEdit.SJTSK:
-                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot; SJTSK&quot;);
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: S-JTSK&quot;);
                 break;
             default:
-                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot; WGS84&quot;);
+                coordinateSystemLabel.setText(L10n.getString(&quot;Overview.CoordinateSystemLabel&quot;)+&quot;: WGS-84&quot;);
         }
         
         resetAuthorModel();
@@ -987,6 +1011,7 @@
         okButton.setMnemonic(L10n.getMnemonic(&quot;Common.Ok&quot;));
         cancelButton.setText(L10n.getString(&quot;Common.Cancel&quot;));
         cancelButton.setMnemonic(L10n.getMnemonic(&quot;Common.Cancel&quot;));
+        gpsChangeButton.setText(L10n.getString(&quot;Common.GpsChange&quot;));
         
         Object[] arg = {REQUIRED_STRING};
         requiredInfoLabel.setText(L10n.getFormattedString(&quot;AddEdit.RequiredInfoLabel&quot;,arg));

Added: trunk/src/net/sf/plantlore/client/overview/Transformation.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/Transformation.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/Transformation.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -0,0 +1,870 @@
+/*
+ * Transformation.java
+ *
+ * Created on 4. &#269;erven 2006, 0:46
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.client.overview;
+
+import org.apache.log4j.Logger;
+
+/**
+ *
+ * Zdroj: 
+ * Converting between grid eastings and northings and ellipsoidal latititude and longitude. <A HREF="http://www.gps.gov.uk/guidec.asp.">http://www.gps.gov.uk/guidec.asp.</A>
+ * Hrdina, Z.: P&#345;epo&#269;et z S-JTSK do WGS-84. 2002. <A HREF="http://gpsweb.cz/JTSK-WGS.htm.">http://gpsweb.cz/JTSK-WGS.htm.</A>
+ * Hrdina, Z.: Transformace sou&#345;adnic ze syst&#233;mu WGS-84 do syst&#233;mu S-JTSK. Praha: &#268;VUT, 1997. <A HREF="http://www.geospeleos.com/Mapovani/WGS84toSJTSK/WGS_JTSK.pdf.">http://www.geospeleos.com/Mapovani/WGS84toSJTSK/WGS_JTSK.pdf.</A> 
+ * Transformace souradnic WGS84&lt;--&gt;-JTSK&lt;--&gt;S42 <A HREF="http://astro.mff.cuni.cz/mira/sh/sh.php">http://astro.mff.cuni.cz/mira/sh/sh.php</A>  
+ *
+ * @author Lada Oberreiterova
+ * 
+ * 
+ * U WGS-84 se bude zadavat a zobrazovat geodeticke souradnice:
+ *    latitude: 50.4576&#176;
+ * 	  longitude: 14.3986&#176;
+ * 	  altitude: 289.15 m
+ *
+ * U S42 a S-JTSK se budou zadavat a zobrazovat souradnice v ortogon&#225;ln&#237;m syst&#233;mu: 
+ * Pro S-JSTK se rozlisuji kvadranty - CR spada do 3.kvadrantu (X-ova souradnice bude vychazet zaporne)
+ * Pro S-42 se rozlisuji pasy - CR spada do 3.pasu a &#269;&#225;st Karpat na Morav&#283; do 4.pasu
+ * 		Y= 1002007 m 
+ * 		X= 738791 m.
+ * 		Z=  244 m
+ */
+public class Transformation {
+    
+    private Logger logger;    
+    
+    private Double latitude;
+    private Double longitude;
+    private Double altitude;
+    private Double latitudeRAD;
+    private Double longitudeRAD;
+    private Double x;
+    private Double y;
+    private Double z;
+    private String coordinateSystem;
+    
+    public static final String WGS84 = &quot;WGS84&quot;;
+    public static final String SJTSK = &quot;S-JTSK&quot;;
+    public static final String S42 = &quot;S-42&quot;;
+    
+    //A = velka poloosa zplosteneho elipsoidu
+    //F = zplosteni elipsoidu
+    public static final Double ELIPSOID_WGS84_A = 6378137.0; //6377397,155
+    public static final Double ELIPSOID_WGS84_F = 298.257223563;
+    public static final Double ELIPSOID_BESSEL_A = 6377397.15508;
+    public static final Double ELIPSOID_BESSEL_F = 299.152812853;    
+    public static final Double ELIPSOID_KRAJOVSKIJ_A = 6378245.0;
+    public static final Double ELIPSOID_KRAJOVSKIJ_F = 298.3;    
+    
+    /**
+     * 
+     * Creates a new instance of Transformation 
+     * 
+     * 
+     * @param latitude
+     * @param longitude
+     * @param altitude
+     * @param coordinateSystem
+     */
+    public Transformation() {
+        
+        logger = Logger.getLogger(this.getClass().getPackage().getName());	                
+        
+    }
+    
+    //**********************************************************************************************//
+    //**********************************  WGS-84  &lt;---&gt; S-JTSK ************************************//
+    //*********************************************************************************************//
+    /**
+     * Helmertova transformace (podm&#237;nka &quot;min max&quot;) 
+     * 
+     *  WGS-84 pou&#382;&#237;v&#225; elipsoid WGS-84, kde&#382;to S-JTSK pou&#382;&#237;v&#225; elipsoid Basse&#367;v (Elipsoidy se s r&#367;znou p&#345;esnost&#237; p&#345;ibli&#382;uj&#237; 
+     * zobecn&#283;n&#233;mu fyzik&#225;ln&#237;mu tvaru Zem&#283; - geoidu). 
+     *
+     *  Transformace z WGS84 do S-JTSK m&#225; dv&#283; &#269;&#225;sti:
+     *  1. transformace elipsoidu WGS84 na Bessel&#367;v elipsoid
+     *  2. transformace z Besselova elipsoidu do kart&#233;zsk&#233;ho sou&#345;. syst&#233;mu S-JTSK 
+     *
+     *  vraci JTSK sou&#345;adnice pro zadanou severn&#237; &#353;&#237;&#345;ku a v&#253;chodn&#237; d&#233;lku - zm&#283;&#345;enou GPS v sou&#345;adn&#233;m syst&#233;mu elipsoidu WGS84
+     * 
+     */
+    
+    public Double[] transform_WGS84_to_SJTSK(Double latitude, Double longitude, Double altitude) {
+        
+        //Transformace elipsoidu WGS84 na Bessel&#367;v elipsoid.
+        //WGS84 - transform latitude and longitude from degree to radiant format
+        Double[] geodeticCoordinateRAD_WGS = degreeToRadiant(latitude, longitude);   
+        System.out.println(&quot;from &quot; + latitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[0]);
+        System.out.println(&quot;from &quot; + longitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[1] + &quot;\n&quot;); 
+        //WGS84 - vypocet pravouhlych souradnic z geodetickych souradnic
+        Double[] cartesianCoordinate_WGS = WGS84_BLH_xyz(geodeticCoordinateRAD_WGS[0], geodeticCoordinateRAD_WGS[1], altitude); 
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[0]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[1]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[2] + &quot;\n&quot;);
+        //transformace prostorov&#253;ch pravo&#250;hl&#253;ch sou&#345;adnic do syst&#233;mu S-JTSK
+        Double[] cartesianCoordinate_SJTSK = transformation_WGS84_SJTSK_xyz_xyz(cartesianCoordinate_WGS[0], cartesianCoordinate_WGS[1], cartesianCoordinate_WGS[2]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[0]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[1]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate_SJTSK[2] + &quot;\n&quot;);
+        //S-JTSK - vypocet geodetickych souradnic z pravouhlych souradnic
+        Double[] geodeticCoordinateRAD_SJTSK = bessel_xyz_BLH(cartesianCoordinate_SJTSK[0], cartesianCoordinate_SJTSK[1], cartesianCoordinate_SJTSK[2]);      
+        System.out.println(&quot;SJTSK - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_SJTSK[0]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_SJTSK[1]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_SJTSK[2] + &quot;\n&quot;);        
+        //S-JTSK - transform latitude and longitude from radiant to degree format
+        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_SJTSK[0], geodeticCoordinateRAD_SJTSK[1]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + latLong[0]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + latLong[1]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_SJTSK[2] + &quot;\n&quot;);        
+         
+        Double[] planarCoordinate = krovak_BLH_xy(latLong[0], latLong[1], geodeticCoordinateRAD_SJTSK[2]);       
+        System.out.println(&quot;SJTSK - planar souradnice (X): &quot; + planarCoordinate[0]);
+        System.out.println(&quot;SJTSK - planar souradnice (Y): &quot; + planarCoordinate[1]);
+        System.out.println(&quot;SJTSK (Z): &quot; + planarCoordinate[2] + &quot;\n&quot;);
+        
+        return planarCoordinate;
+    }
+    
+    public Double[] transform_SJTSK_to_WGS84(Double x, Double y, Double z) {
+                 
+        //Prepocet z S-JTSK  ... uz dostanu hodnoty v radianech
+        Double[] geodeticCoordinate = kovak_xy_BLH(x, y, z);
+        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + geodeticCoordinate[0]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice: &quot; + geodeticCoordinate[1]);
+        System.out.println(&quot;SJTSK - geodeticke souradnice altitude: &quot; + geodeticCoordinate[2] + &quot;\n&quot;);                      
+        //Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
+        Double[] cartesianCoordinate = bessel_BLH_xyz(geodeticCoordinate[0], geodeticCoordinate[1], geodeticCoordinate[2]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[0]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[1]);
+        System.out.println(&quot;SJTSK - provouhle souradnice: &quot; + cartesianCoordinate[2] + &quot;\n&quot;);
+        //Transformace pravouhlych souradnic z S-JTSK do WGS84
+        Double[] cartesianCoordinate_WGS84 = transformation_SJTSK_WGS84_xyz_xyz(cartesianCoordinate[0], cartesianCoordinate[1], cartesianCoordinate[2]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[0]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[1]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[2] + &quot;\n&quot;);
+        //Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
+        Double[] geodeticCoordinateRAD_WGS84 = WGS84_xyz_BLH(cartesianCoordinate_WGS84[0], cartesianCoordinate_WGS84[1], cartesianCoordinate_WGS84[2]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[0]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[1]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[2] + &quot;\n&quot;);
+        //Transformation latitude and longitude from radiant to degree 
+        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_WGS84[0], geodeticCoordinateRAD_WGS84[1]);
+        Double[] geodeticCoordinate_WGS84 = new Double[3];
+        geodeticCoordinate_WGS84[0] = latLong[0];
+        geodeticCoordinate_WGS84[1] = latLong[1];
+        geodeticCoordinate_WGS84[2] = geodeticCoordinateRAD_WGS84[2];
+        
+        System.out.println(&quot;WGS84 latitude: &quot;+ geodeticCoordinate_WGS84[0]);
+        System.out.println(&quot;WGS84 longitude: &quot; + geodeticCoordinate_WGS84[1]);
+        System.out.println(&quot;WGS84 altitude: &quot; + geodeticCoordinate_WGS84[2] + &quot;\n&quot;);
+        
+        return geodeticCoordinate_WGS84;
+    }      
+    
+    //**********************************************************************************************//
+    //**********************************  WGS-84  &lt;---&gt; S-42 ************************************//
+    //*********************************************************************************************//
+    
+    public Double[] transform_WGS84_to_S42(Double latitude, Double longitude, Double altitude) {
+                
+        //WGS84 - transform latitude and longitude from degree to radiant format
+        Double[] geodeticCoordinateRAD_WGS = degreeToRadiant(latitude, longitude);   
+        System.out.println(&quot;from &quot; + latitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[0]);
+        System.out.println(&quot;from &quot; + longitude + &quot; toRadian: &quot; + geodeticCoordinateRAD_WGS[1] + &quot;\n&quot;); 
+        //WGS84 - vypocet pravouhlych souradnic z geodetickych souradnic
+        Double[] cartesianCoordinate_WGS = WGS84_BLH_xyz(geodeticCoordinateRAD_WGS[0], geodeticCoordinateRAD_WGS[1], altitude); 
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[0]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[1]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS[2] + &quot;\n&quot;);
+        //transformace prostorov&#253;ch pravo&#250;hl&#253;ch sou&#345;adnic do syst&#233;mu S-42
+        Double[] cartesianCoordinate_S42 = this.transformation_WGS84_S42_xyz_xyz(cartesianCoordinate_WGS[0], cartesianCoordinate_WGS[1], cartesianCoordinate_WGS[2]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[0]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[1]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate_S42[2] + &quot;\n&quot;);
+        //S-42 - vypocet geodetickych souradnic z pravouhlych souradnic
+        Double[] geodeticCoordinateRAD_S42 = this.krajovskij_xyz_BLH(cartesianCoordinate_S42[0], cartesianCoordinate_S42[1], cartesianCoordinate_S42[2]);      
+        System.out.println(&quot;S42 - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_S42[0]);
+        System.out.println(&quot;S42 - geodeticke souradnice RAD: &quot; + geodeticCoordinateRAD_S42[1]);
+        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);        
+        //S-42 - transform latitude and longitude from radiant to degree format
+        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_S42[0], geodeticCoordinateRAD_S42[1]);
+        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + latLong[0]);
+        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + latLong[1]);
+        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);        
+                 
+        Double[] coordinate = transformatin_S42_BLH_xy(geodeticCoordinateRAD_S42[0], geodeticCoordinateRAD_S42[1]);               
+        System.out.println(&quot;S42 - planar souradnice (X): &quot; + coordinate[0]);
+        System.out.println(&quot;S42 - planar souradnice (Y): &quot; + coordinate[1]);
+        System.out.println(&quot;S42 (Z): &quot; + geodeticCoordinateRAD_S42[2] + &quot;\n&quot;);
+        
+        Double[] planarCoordinate = new Double[3];
+        planarCoordinate[0] = coordinate[0];
+        planarCoordinate[1] = coordinate[1];
+        planarCoordinate[2] = geodeticCoordinateRAD_S42[2];
+               
+        return planarCoordinate;
+    }
+      
+    
+     public Double[] transform_S42_to_WGS84(Double x, Double y, Double z) {
+         
+         //Prepocet z S-42 do WGS-84 ... uz dostanu hodnoty v radianech
+         //!!!!!FIXME - v teto funkci je chyba
+        //Double[] geodeticCoordinate = transformation_S42_xy_BLH(x, y, z);
+    	 Double[] geodeticCoordinate = S42_xy_BLH(x, y, z);
+        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + geodeticCoordinate[0]);
+        System.out.println(&quot;S42 - geodeticke souradnice: &quot; + geodeticCoordinate[1]);
+        System.out.println(&quot;S42 - geodeticke souradnice altitude: &quot; + geodeticCoordinate[2] + &quot;\n&quot;);                      
+        //Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
+        Double[] cartesianCoordinate = krajovskij_BLH_xyz(geodeticCoordinate[0], geodeticCoordinate[1], geodeticCoordinate[2]);
+        //Double[] cartesianCoordinate = krajovskij_BLH_xyz(0.8806574639397869, 0.25133270679766656, geodeticCoordinate[2]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[0]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[1]);
+        System.out.println(&quot;S42 - provouhle souradnice: &quot; + cartesianCoordinate[2] + &quot;\n&quot;);
+        //Transformace pravouhlych souradnic z S-42 do WGS84
+        Double[] cartesianCoordinate_WGS84 = transformation_S42_WGS84_xyz_xyz(cartesianCoordinate[0], cartesianCoordinate[1], cartesianCoordinate[2]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[0]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[1]);
+        System.out.println(&quot;WGS84 - pravouhle souradnice: &quot; + cartesianCoordinate_WGS84[2] + &quot;\n&quot;);
+        //Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
+        Double[] geodeticCoordinateRAD_WGS84 = WGS84_xyz_BLH(cartesianCoordinate_WGS84[0], cartesianCoordinate_WGS84[1], cartesianCoordinate_WGS84[2]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[0]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[1]);
+        System.out.println(&quot;WGS84 - geodeticke souradnice: &quot; + geodeticCoordinateRAD_WGS84[2] + &quot;\n&quot;);
+        //Transformation latitude and longitude from radiant to degree 
+        Double[] latLong = radiantToDegree(geodeticCoordinateRAD_WGS84[0], geodeticCoordinateRAD_WGS84[1]);
+        Double[] geodeticCoordinate_WGS84 = new Double[3];
+        geodeticCoordinate_WGS84[0] = latLong[0];
+        geodeticCoordinate_WGS84[1] = latLong[1];
+        geodeticCoordinate_WGS84[2] = geodeticCoordinateRAD_WGS84[2];
+        
+        System.out.println(&quot;WGS84 latitude: &quot;+ geodeticCoordinate_WGS84[0]);
+        System.out.println(&quot;WGS84 longitude: &quot; + geodeticCoordinate_WGS84[1]);
+        System.out.println(&quot;WGS84 altitude: &quot; + geodeticCoordinate_WGS84[2] + &quot;\n&quot;);
+        
+        return geodeticCoordinate_WGS84;
+     }
+        
+    //*******************************************************************************************//
+    //*********************** Planar coordinates ***********************************************//
+    //******************************************************************************************//    
+    
+    /**    
+     *   Prepocet z S-JTSk do WGS-84
+     *   (Krovak projection (used in the S-JTSK coordinate system))
+     */    
+    public Double[] kovak_xy_BLH(Double x, Double y, Double altitude) {
+          
+        //konstanty prouzite pro transformaci
+        double a     = 6377397.15508;   //polomer Gausseovy koule (6380065.5402 metr&#367;)
+        double e     = 0.081696831215303;
+        double n     = 0.97992470462083;
+        double rho_0 = 12310230.12797036;
+        double sinUQ = 0.863499969506341; //kulova sirka odpovidajici zemepisne sirce 49&#176;30`
+        double cosUQ = 0.504348889819882;
+        double sinVQ = 0.420215144586493;
+        double cosVQ = 0.907424504992097;
+        double alfa  = 1.000597498371542; //koustanta pro vypocet sfericke sirky a delky
+        double k_2   = 1.003419163966575;  //koustanta pro vypocet sfericke sirky a delky             
+        
+        double ro = Math.sqrt(Math.pow(x,2)+ Math.pow(y,2));
+        double epsilon = 2.* Math.atan(y/(ro+x));
+        double d = epsilon/n; 
+        double s = 2.* Math.atan(Math.exp(1./ n* Math.log(rho_0 / ro)))- Math.PI/2.;
+        double sinS = Math.sin(s); 
+        double cosS = Math.cos(s);
+        double sinU = sinUQ * sinS - cosUQ * cosS * Math.cos(d); 
+        double cosU = Math.sqrt(1.- Math.pow(sinU, 2));
+        double sinDV = Math.sin(d) * cosS/cosU; 
+        double cosDV = Math.sqrt(1.-Math.pow(sinDV,2));
+        double sinV = sinVQ * cosDV - cosVQ * sinDV; 
+        double cosV = cosVQ * cosDV + sinVQ * sinDV;
+        double longitude = 2.* Math.atan(sinV / (1.+ cosV))/alfa;
+        double t = Math.exp(2./alfa * Math.log((1.+ sinU)/cosU/k_2));
+        double pom = (t-1.)/(t+1.);
+        double sinB;
+        do {
+           sinB = pom;
+           pom = t * Math.exp(e * Math.log((1.+ e * sinB)/(1. - e * sinB))); 
+           pom = (pom-1)/(pom+1);
+      } while (Math.abs(pom - sinB) &gt; 1.e-15);
+       double latitude = Math.atan(pom/Math.sqrt(1.- Math.pow(pom,2)));
+  
+      // this is an appropriate heigth correction                  
+
+       Double[] geologicCoordinate = new Double[3];
+       geologicCoordinate[0] = latitude;
+       geologicCoordinate[1] = longitude;
+       geologicCoordinate[2] = altitude;
+       
+       return geologicCoordinate;       
+        
+    }
+    
+    /**
+     * Transformace souradnic ze systemu WGS-84 do systemu S-JTSK.
+     *
+     * vraci JTSK sou&#345;adnice pro zadanou Severn&#237; &#353;&#237;&#345;ku a v&#253;chodn&#237; d&#233;lku  
+     * Zobrazeni zemepisnych souradnic na pravouhle:
+     *  - zobrazeni Besselova elipsoidu  na Gausseovu kouli
+     *  - vypocet kartografickych souradnic na Gaussove kouli s posunutym polem Q o souradnicich 48&#176;15`, 42&#176;30`.
+     *  - konformni kuzelove zobrazeni s tecnym kuzelem na zakladni rovnobezce
+     *  - dopocitani pravouhlych souradnic
+     */
+    public Double[] krovak_BLH_xy(Double latitude, Double longitude, Double altitude) {      
+       
+        //konstanty prouzite pro transformaci
+        double a     = 6377397.15508;   //polomer Gausseovy koule (6380065.5402 metr&#367;)
+        double e     = 0.081696831215303;
+        double n     = 0.97992470462083;
+        double rho_0 = 12310230.12797036; //1298039,0046
+        double sinUQ = 0.863499969506341; //kulova sirka odpovidajici zemepisne sirce 49&#176;30`
+        double cosUQ = 0.504348889819882;
+        double sinVQ = 0.420215144586493;
+        double cosVQ = 0.907424504992097;
+        double alfa  = 1.000597498371542; //koustanta pro vypocet sfericke sirky a delky
+        double k_2   = 1.00685001861538;  //koustanta pro vypocet sfericke sirky a delky
+           
+       Double[] coordinateRAD = degreeToRadiant(latitude, longitude);
+       latitude = coordinateRAD[0]; 
+       longitude = coordinateRAD[1];
+       
+       double sinB = Math.sin(latitude);
+       double t = (1-e*sinB)/(1+e*sinB);
+              t = Math.pow(1+sinB,2)/(1- Math.pow(sinB,2)) * Math.exp(e*Math.log(t));
+              t = k_2 * Math.exp(alfa * Math.log(t));
+
+       double sinU  = (t-1)/(t+1);
+       double cosU  = Math.sqrt(1-Math.pow(sinU,2));
+       double V = alfa * longitude;
+       double sinV  = Math.sin(V);
+       double cosV  = Math.cos(V);
+       double cosDV = cosVQ * cosV + sinVQ * sinV;
+       double sinDV = sinVQ * cosV - cosVQ * sinV;
+       double sinS  = sinUQ*sinU + cosUQ*cosU*cosDV;
+       double cosS  = Math.sqrt(1-sinS*sinS);
+       double sinD  = sinDV * cosU/cosS;
+       double cosD  = Math.sqrt(1-sinD*sinD);
+       
+       double eps = n * Math.atan(sinD/cosD);
+       double rho = rho_0 * Math.exp(-n * Math.log((1+sinS)/cosS));
+
+       Double[] planarCoordinate = new Double[3];
+       planarCoordinate[0] = rho * Math.cos(eps); //x
+       planarCoordinate[1] = rho * Math.sin(eps); //y
+       planarCoordinate[2] = altitude;
+       
+       return planarCoordinate;       
+    }        
+ 
+    //*******************************************************************************************//
+    //***************** S-42  Orthogonal coordinates --&gt; geodetic coordinate*********************//
+    //******************************************************************************************//   
+    
+    public Double[] S42_xy_BLH(Double x, Double y, Double z) {
+    	//VYPOCET S-42 ortogonalni system --&gt; S-42 geodeticky system
+
+    	double A2 = x;
+    	double B2 = y;
+    	double C2 = 6378245;
+    	double D2 = 0.0818133340169312;
+    	double E2 = 500000+Math.rint(A2/1000000)*1000000;
+    	double F2 = 0;
+    	double G2 = 21+6*(Math.rint(A2/1000000)-4);
+    	double H2 = G2*Math.PI/180;
+    	double I2 = 0;
+    	double J2 = I2*Math.PI/180;
+    	double K2 = 1;
+    	double L2 = A2-E2;
+    	double M2 = B2-F2;
+    	double N2 = (1-Math.sqrt(1-D2*D2))/(1+ Math.sqrt(1-D2*D2));
+    	double O2 = C2*(J2*(1-D2*D2/4-3*Math.pow(D2,4)/64-5*Math.pow(D2,6)/256)-Math.sin(2*J2)*(3*D2*D2/8+3*Math.pow(D2,4)/32+45*Math.pow(D2,6)/1024)+Math.sin(4*J2)*(15*Math.pow(D2,4)/256+45*Math.pow(D2,6)/1024)-Math.sin(6*J2)*35*Math.pow(D2,6)/3072);
+    	double P2 = O2+M2/K2;
+    	double Q2 = P2/(C2*(1-D2*D2/4-3*Math.pow(D2,4)/64-5*Math.pow(D2,6)/256));
+    	double R2 = Q2+Math.sin(2*Q2)*(3*N2/2-27*Math.pow(N2,3)/32)+Math.sin(4*Q2)*(21*N2*N2/16-55*Math.pow(N2,4)/32)+Math.sin(6*Q2)*151*Math.pow(N2,3)/96+Math.sin(8*Q2)*1097*Math.pow(N2,4)/512;
+    	double S2 = D2*D2/(1-D2*D2);
+    	double T2 = S2*Math.cos(R2)*Math.cos(R2);
+    	double U2 = Math.tan(R2)*Math.tan(R2);
+    	double V2 = C2/Math.sqrt(1-D2*D2*Math.sin(R2)*Math.sin(R2));
+    	double W2 = C2*(1-D2*D2)/Math.sqrt(1-D2*D2*Math.sin(R2)*Math.sin(R2));
+    	double X2 = L2/(V2*K2);
+    	double Z2 = H2+(X2-(1+2*U2+T2)*Math.pow(X2,3)/6+(5-2*T2+28*U2-3*T2*T2+8*S2+24*U2*U2)*Math.pow(X2,5)/120)/Math.cos(R2);
+    	double Y2 = R2-(V2*Math.tan(R2)/W2)*(X2*X2/2-(5+3*U2+10*T2-4*T2*T2-9*S2)*Math.pow(X2,4)/24+(61+90*U2+298*T2+45*U2*U2-252*S2-3*T2*T2)*Math.pow(X2,6)/720);
+    	//latitude
+    	double lambda = Z2*180/Math.PI;
+    	//longitude
+    	double fi = Y2 * 180/Math.PI; //prevod na stupne z radianu    	
+    	
+    	Double[] coordinate = new Double[3];
+    	coordinate[0] = Math.toRadians(fi);
+    	coordinate[1] = Math.toRadians(lambda);
+    	coordinate[2] = z;
+    	
+    	return coordinate;
+    }
+    
+    //*******************************************************************************************//
+    //***************** S-42  Planar coordinates ***********************************************//
+    //******************************************************************************************//    
+ 
+    /**
+     *  Mercator projection for the S42 coordinate system
+     *
+     */ 
+    public Double[] transformatin_S42_BLH_xy(Double phi, Double lambda) {               
+       
+        // parameters of the Krasovskij ellipsoid
+        double elipsoid_a = ELIPSOID_KRAJOVSKIJ_A; 
+        double elipsoid_f = ELIPSOID_KRAJOVSKIJ_F;
+
+        // parameters of the S-42 coordinate system (3rd belt)
+       double no = 0;
+       double eo = 3500000;
+       double fo = 1;
+       double phi0 = Math.toRadians(0);
+       double lambda0 = Math.toRadians(15);
+       double b = elipsoid_a - elipsoid_a/elipsoid_f;
+
+       Double[] listEN = transverseMercator_BLH_XY(phi, lambda, no, eo, fo, phi0, lambda0, elipsoid_a, b);
+      
+       return listEN;
+    }
+    
+    /**
+     * Mercator projection for the S42 coordinate system
+     * (the 3rd belt suitable for the Czech Republic)
+     *
+     */
+    public Double[] transformation_S42_xy_BLH(Double e, Double n, Double altitude) {
+             
+        // parameters of the Krasovskij ellipsoid 
+        double elipsoid_a = ELIPSOID_KRAJOVSKIJ_A; 
+        double elipsoid_f = ELIPSOID_KRAJOVSKIJ_F;
+
+
+        // parameters of the S-42 coordinate system (3rd belt)
+       double no = 0;
+       double eo = 3500000;
+       double fo = 1;
+       double phi0 = Math.toRadians(0);
+       double lambda0 = Math.toRadians(15);
+       double b = elipsoid_a - (elipsoid_a/elipsoid_f);
+          
+       Double[] listPhiLambda = mercator_XY_BLH(e, n, no, eo, fo, phi0, lambda0, elipsoid_a, b);      
+       Double[] value = new Double[3];
+       value[0] = listPhiLambda[0];
+       value[1] = listPhiLambda[1];
+       value[2] = altitude;          
+       return value;
+    }    
+    
+    /**
+     *
+     *
+     */
+    public Double[] transverseMercator_BLH_XY(double phi, double lambda, double no, double eo, double fo, double phi0, double lambda0, double elipsoid_a, double b) {
+                
+        double e2 = (Math.pow(elipsoid_a,2) - Math.pow(b, 2)) / Math.pow(elipsoid_a,2);
+        double n = (elipsoid_a - b) / (elipsoid_a + b);
+        double sinphi = Math.sin(phi);       
+        double e2sinphi2 = 1 - e2 * Math.pow(sinphi, 2);
+        double nu = elipsoid_a * fo / Math.sqrt(e2sinphi2);
+        double rho = elipsoid_a * fo * (1 - e2) / Math.sqrt( Math.pow(e2sinphi2, 3));
+        double eta2 = nu / rho - 1;
+        
+        double n2 = Math.pow(n,2);
+        double n3 = Math.pow(n, 3);
+        
+        double m = b * fo *(
+              (1 + n + 5/4*n2 + 5/4*n3) * (phi - phi0)
+              - (3*n + 3*n2 + 21/8*n3) * Math.sin(phi - phi0) * Math.cos(phi + phi0)
+              + (15/8*n2 + 15/8*n3) * Math.sin(2*(phi - phi0)) * Math.cos(2*(phi + phi0))
+              - 35/24*n3 * Math.sin(3*(phi - phi0)) * Math.cos(3*(phi-phi0))
+              );
+        
+        double cosphi = Math.cos(phi);
+        double tanphi = Math.tan(phi);
+     
+        double i = m + no;
+        double ii = nu/2 * sinphi * cosphi;
+        double iii = nu/24 * sinphi* Math.pow(cosphi,3) * (5 - Math.pow(tanphi,2) + 9 * eta2);
+        double iiia = nu/720 * sinphi * Math.pow(cosphi,5) * (61 - 58 * Math.pow(tanphi,2) + Math.pow(tanphi,4));
+        double iv = nu * cosphi;
+        double v = nu/6 * Math.pow(cosphi,3) * (nu/rho - Math.pow(tanphi,2));
+        double vi = nu/120 * Math.pow(cosphi,5) * (5 - 18* Math.pow(tanphi,2) + Math.pow(tanphi,4) + 14 * eta2 - 58 * Math.pow(tanphi,2) * eta2);
+
+        double llo = lambda - lambda0;
+        n = i + ii * Math.pow(llo,2) + iii * Math.pow(llo,4) + iiia * Math.pow(llo,6);
+        double e = eo + iv * llo + v * Math.pow(llo,3) + vi * Math.pow(llo,5);
+        
+        Double[] value = new Double[2];
+        value[0] = e;
+        value[1] = n;
+        
+        return value;
+    }
+    
+    /**
+     *
+     *
+     */
+    public Double[] mercator_XY_BLH(double e, double n, double no, double eo, double fo, double phi0, double lambda0, double elipsoid_a, double b){
+        
+        double phid = (n-no) / (elipsoid_a * fo) + phi0;
+
+        n = (elipsoid_a - b) / (elipsoid_a + b);
+        double n2 = Math.pow(n,2);
+        double n3 = Math.pow(n,3);
+        double m = 0;
+        
+        int i1st = 0;
+        do {
+            if (i1st &gt; 0) 
+                phid = (n - no - m) / (elipsoid_a * fo) + phid;
+            i1st++;
+
+            m = b * fo *(
+              (1 + n + 5/4*n2 + 5/4*n3) * (phid - phi0)
+              - (3*n + 3*n2 + 21/8*n3) * Math.sin(phid - phi0) * Math.cos(phid + phi0)
+              + (15/8*n2 + 15/8*n3) * Math.sin(2*(phid - phi0)) * Math.cos(2*(phid + phi0))
+              - 35/24*n3 * Math.sin(3*(phid - phi0)) * Math.cos(3*(phid-phi0))
+              );
+
+          } while (Math.abs(n-no-m) &gt; 1.e-4);
+
+          double e2 = (Math.pow(elipsoid_a,2) - Math.pow(b, 2)) / Math.pow(elipsoid_a,2);
+          double sinphi = Math.sin(phid);	// tady je zrejme phi        
+          double e2sinphi2 = 1 - e2 * Math.pow(sinphi, 2);
+          double nu = elipsoid_a * fo / Math.sqrt(e2sinphi2);
+          double rho = elipsoid_a * fo * (1 - e2) / Math.sqrt( Math.pow(e2sinphi2, 3));
+          double eta2 = nu / rho - 1;
+          
+          double secphid = 1./ Math.cos(phid);
+          double tanphid = Math.tan(phid);         
+
+          double vii = tanphid/(2 * rho * nu);
+          double viii = tanphid/(24 * rho * Math.pow(nu,3)) * (5 + 3* Math.pow(tanphid,2) + eta2 - 9 * Math.pow(tanphid,2) * eta2);
+          double ix = tanphid/(720 * rho * Math.pow(nu,5)) * (61 + 90 * Math.pow(tanphid,2) + 45 * Math.pow(tanphid,4));
+          double x = secphid / nu;
+          double xi = secphid/(6 * Math.pow(nu,3)) * (nu/rho + 2 * Math.pow(tanphid,2));
+          double xii = secphid/(120 * Math.pow(nu,5)) * (5 + 28 * Math.pow(tanphid,2) + 24 * Math.pow(tanphid,4));
+          double xiia = secphid/(5040* Math.pow(nu,7)) * (61 + 662 * Math.pow(tanphid,2) + 1320 * Math.pow(tanphid,4) + 720 * Math.pow(tanphid,6));
+
+          double eeo = e - eo;
+          double phi = phid - vii * Math.pow(eeo,2) + viii * Math.pow(eeo,4) - ix * Math.pow(eeo,6);
+          double lambda = lambda0 + x * eeo - xi * Math.pow(eeo,3) + xii * Math.pow(eeo,5) - xiia * Math.pow(eeo,7);
+
+          Double[] value = new Double[2];
+          value[0] = phi;
+          value[1] = lambda;                   
+          
+          return value;
+    }
+    
+    //****************************************************************************************//
+    //******** Convergetion between geological coordinate and cartesian coordinate ***********//
+    //***************************************************************************************//
+    
+    /**
+     *  Vypocet geodetickych souradnic z pravouhlych souradnic pro urcity elipsoid
+     */
+    public Double[] ellipsoid_xyz_BLH(Double x, Double y, Double z, Double elipsoid_a, Double elipsoid_f) {
+
+          double a_b = elipsoid_f/(elipsoid_f - 1);      
+          double p = Math.sqrt(Math.pow(x,2) + Math.pow(y,2));      
+          double e2 = 1 - Math.pow((1 - 1 /elipsoid_f), 2);      
+          double th = Math.atan(z * a_b / p); 
+          double sinth = Math.sin(th);
+          double costh = Math.cos(th);          
+          double t = (z + e2 * a_b * elipsoid_a * Math.pow(sinth,3)) / (p - e2 * elipsoid_a * Math.pow(costh,3));  
+        
+          Double[] geodeticCoordinate = new Double[3];
+          //latitude
+          geodeticCoordinate[0] = Math.atan(t);
+          //longitude
+          geodeticCoordinate[1] = 2 * Math.atan(y / (p + x));
+          //altitude
+          geodeticCoordinate[2] =  Math.sqrt(1 + Math.pow(t, 2)) * (p - elipsoid_a / Math.sqrt(1 + (1 - e2) * Math.pow(t, 2)));            
+          
+          return geodeticCoordinate;       
+      }
+    
+    /**
+     * Vypocet pravouhlych souradnic z geodetickych souradnic pro dany elipsoid
+     * (phi = B, lambda = L )
+     *
+     * @param  zem&#283;pisn&#225; geodetick&#225; &#353;&#237;&#345;ka &#966; je &#250;hel, kter&#253; sv&#237;r&#225; rovina rovn&#237;ku s norm&#225;lou k plo&#353;e elipsoidu (kladn&#225; na sever)
+     * @param zem&#283;pisn&#225; geodetick&#225; d&#233;lka &#955; je &#250;hel, kter&#253; sv&#237;r&#225; rovina m&#237;stn&#237;ho poledn&#237;ku s rovinou z&#225;kladn&#237;ho poledn&#237;ku (kladn&#225; na v&#253;chod),
+     * @param elipsoidick&#225; v&#253;&#353;ka H je vzd&#225;lenost od elipsoidu, m&#283;&#345;en&#225; po norm&#225;le (kladn&#225; vn&#283; elipsoidu)
+     *
+     */
+    public Double[] ellipsoid_BLH_xyz(Double latitude, Double longitude, Double altitude, Double elipsoid_a, Double elipsoid_f) {
+       
+        //e = excentricita elipsoidu
+        Double e2 = 1 - Math.pow(1 - 1 / elipsoid_f, 2);
+        //rho = pricny polomer krivosti
+        Double rho = elipsoid_a/Math.sqrt(1 - e2 * Math.pow(Math.sin(latitude),2));          
+        //pravouhle souradnice
+        Double[] cartesianCoordinate = new Double[3];
+        cartesianCoordinate[0] = (rho + altitude) * Math.cos(latitude) * Math.cos(longitude); //x
+        cartesianCoordinate[1] = (rho + altitude) * Math.cos(latitude) * Math.sin(longitude); //y
+        cartesianCoordinate[2] = ((1-e2)*rho + altitude) * Math.sin(latitude);  //z
+                
+        return cartesianCoordinate;
+    }
+    
+    /**
+     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid WGS84
+     *     
+     */
+    public Double[] WGS84_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
+       
+        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_WGS84_A, ELIPSOID_WGS84_F);        
+        return cartesianCoordinate;
+    }
+    
+    /**
+     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid WGS84
+     *
+     */
+    public Double[] WGS84_xyz_BLH(Double x, Double y, Double z) {        
+     
+        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_WGS84_A, ELIPSOID_WGS84_F);
+        return geodeticCoordinate;
+      }        
+    
+    /**
+     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Bessel
+     *     
+     */
+    public Double[] bessel_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
+       
+        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_BESSEL_A, ELIPSOID_BESSEL_F);        
+        return cartesianCoordinate;
+    }
+    
+    /**
+     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Bessel
+     *
+     */
+    public Double[] bessel_xyz_BLH(Double x, Double y, Double z) {        
+     
+        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_BESSEL_A, ELIPSOID_BESSEL_F);
+        return geodeticCoordinate;
+      }        
+    
+    /**
+     * Vypocet pravouhlych souradnic z geodetickych souradnic pro elipsoid Krajovskij
+     *     
+     */
+    public Double[] krajovskij_BLH_xyz(Double latitude, Double longitude, Double altitude) {                
+       
+        Double[] cartesianCoordinate = ellipsoid_BLH_xyz(latitude, longitude, altitude, ELIPSOID_KRAJOVSKIJ_A, ELIPSOID_KRAJOVSKIJ_F);        
+        return cartesianCoordinate;
+    }
+    
+    /**
+     * Vypocet geodetickych souradnic z pravouhlych souradnic pro elipsoid Krajovskij
+     *
+     */
+    public Double[] krajovskij_xyz_BLH(Double x, Double y, Double z) {        
+     
+        Double[] geodeticCoordinate = ellipsoid_xyz_BLH(x,y, z, ELIPSOID_KRAJOVSKIJ_A, ELIPSOID_KRAJOVSKIJ_F);
+        return geodeticCoordinate;
+      }        
+    
+   
+    //*****************************************************************************************//
+    //***************** Transaction of the cartesian coordinates ******************************//
+    //****************************************************************************************//
+    
+    /**
+     * Hrdina (1997)
+     *
+     * Transformace pravouhlych souradnic z WGS84 do S-JTSK
+     */
+    public Double[] transformation_WGS84_SJTSK_xyz_xyz(Double xs, Double ys, Double zs) {
+        // koeficienty transformace ze systemu WGS-84 do systemu S-JTSK
+        //posunuti
+       double dx = -570.69; 
+       double dy = -85.69; 
+       double dz = -462.84; 
+       //rotace
+       double wx = 4.99821/3600 * Math.PI/180; 
+       double wy = 1.58676/3600 * Math.PI/180; 
+       double wz = 5.2611/3600 * Math.PI/180;
+       //meritko
+       double m  = -3.543e-6; 
+       
+       //Heltmert transform
+        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
+        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
+        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
+        
+        //save
+        Double[] cartesianCoordinateNew = new Double[3];
+        cartesianCoordinateNew[0] = xn;
+        cartesianCoordinateNew[1] = yn;
+        cartesianCoordinateNew[2] = zn;
+                
+        return cartesianCoordinateNew;
+    }
+    
+    /**
+     * Hrdina (2002)
+     *
+     * Transformace pravouhlych souradnic z S-JTSK do WGS84 
+     */
+    public Double[] transformation_SJTSK_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
+        // koeficienty transformace ze systemu S-JTSK do systemu WGS-84
+        //posunuti
+       double dx = 570.69; 
+       double dy = 85.69; 
+       double dz = 462.84; 
+       //rotace
+       double wx = -4.99821/3600 * Math.PI/180; 
+       double wy = -1.58676/3600 * Math.PI/180; 
+       double wz = -5.2611/3600 * Math.PI/180;
+       //meritko
+       double m  = 3.543e-6; 
+       
+       //Heltmert transform
+        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
+        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
+        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
+        
+        //save
+        Double[] cartesianCoordinateNew = new Double[3];
+        cartesianCoordinateNew[0] = xn;
+        cartesianCoordinateNew[1] = yn;
+        cartesianCoordinateNew[2] = zn;
+                
+        return cartesianCoordinateNew;
+    }
+    
+    /**
+     *
+     * Transformace pravouhlych souradnic z WGS84 do S42
+     */
+    public Double[] transformation_WGS84_S42_xyz_xyz(Double xs, Double ys, Double zs) {
+        // koeficienty transformace ze systemu WGS84 do systemu S42
+        //posunuti
+       double dx = -23; 
+       double dy = 124; 
+       double dz = 84; 
+       //rotace
+       double wx = -0.13/3600 * Math.PI/180; 
+       double wy = -0.25/3600 * Math.PI/180; 
+       double wz = 0.02/3600 * Math.PI/180;
+       //meritko
+       double m  = -1.1e-6; 
+       
+       //Heltmert transform
+        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
+        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
+        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
+        
+        //save
+        Double[] cartesianCoordinateNew = new Double[3];
+        cartesianCoordinateNew[0] = xn;
+        cartesianCoordinateNew[1] = yn;
+        cartesianCoordinateNew[2] = zn;
+                
+        return cartesianCoordinateNew;
+    }
+    
+    /**     
+     *
+     * Transformace pravouhlych souradnic z S42 do WGS84 
+     */
+    public Double[] transformation_S42_WGS84_xyz_xyz(Double xs, Double ys, Double zs) {
+        // koeficienty transformace ze systemu S42 do systemu WGS-84
+        //posunuti
+       double dx = 23; 
+       double dy = -124; 
+       double dz = -84; 
+       //rotace
+       double wx = 0.13/3600 * Math.PI/180; 
+       double wy = 0.25/3600 * Math.PI/180; 
+       double wz = -0.02/3600 * Math.PI/180;
+       //meritko
+       double m  = 1.1e-6; 
+       
+       //Heltmert transform
+        double xn = dx + (1+m)*(+   xs + wz*ys - wy*zs);
+        double yn = dy + (1+m)*(-wz*xs +    ys + wx*zs);
+        double zn = dz + (1+m)*(+wy*xs - wx*ys +    zs);
+        
+        //save
+        Double[] cartesianCoordinateNew = new Double[3];
+        cartesianCoordinateNew[0] = xn;
+        cartesianCoordinateNew[1] = yn;
+        cartesianCoordinateNew[2] = zn;
+                
+        return cartesianCoordinateNew;
+    }
+    
+    //**********************************************************************//
+    //******************* Radiant vs. Degree *******************************//
+    //**********************************************************************//
+    
+   /**
+   * transform latitude and longitude from degree to radiant format
+   * 
+   * @param latitude
+   * @param longitude
+   */
+  protected Double[] degreeToRadiant(double latitude, double longitude)
+  {
+      Double[] geodeticCoordinateRAD = new Double[2];
+      geodeticCoordinateRAD[0] = Math.toRadians(latitude);
+      geodeticCoordinateRAD[1] = Math.toRadians(longitude);
+      
+      //geodeticCoordinateRAD[0] = latitude;
+      //geodeticCoordinateRAD[1] = longitude;
+      
+      return geodeticCoordinateRAD;
+  }
+
+  /**
+   * transform latitude and longitude from radiant to degree format
+   * 
+   * @param latitude
+   * @param longitude
+   */
+  protected Double[] radiantToDegree(double latitudeRAD, double longitudeRAD)
+  {
+    Double[] geodeticCoordinate = new Double[2];  
+    geodeticCoordinate[0] = Math.toDegrees(latitudeRAD);
+    geodeticCoordinate[1] = Math.toDegrees(longitudeRAD);    
+    
+    //geodeticCoordinate[0] = latitudeRAD;
+    //geodeticCoordinate[1] = longitudeRAD;    
+    
+    return geodeticCoordinate;
+  }
+  
+ 
+   
+     public static void main(String[] args) {
+            Transformation tr = new Transformation();
+            System.out.println(&quot;********************WGS84 --&gt; S-JTSK**************************&quot;);
+            Double[] coordinate_SJTSK = tr.transform_WGS84_to_SJTSK(50.4576163694, 14.3986, 289.155);
+            System.out.println(&quot;******************** S-JTSK --&gt; WGS84 **************************&quot;);
+            System.out.println(&quot;From: &quot; + coordinate_SJTSK[0]);
+            System.out.println(&quot;From: &quot; + coordinate_SJTSK[1]);
+            System.out.println(&quot;From: &quot; + coordinate_SJTSK[2]);
+            Double[] coordinate_WGS84_SJTSK = tr.transform_SJTSK_to_WGS84(coordinate_SJTSK[0], coordinate_SJTSK[1], coordinate_SJTSK[2]);
+            System.out.println(&quot;********************WGS84 --&gt; S-42**************************&quot;);
+            Double[] coordinate_S42 = tr.transform_WGS84_to_S42(50.4576163694, 14.3986, 289.155);
+            System.out.println(&quot;******************** S-42 --&gt; WGS84 **************************&quot;);                       
+            Double[] coordinate_WGS84_S42 = tr.transform_S42_to_WGS84(coordinate_S42[0], coordinate_S42[1], coordinate_S42[2]);            
+     }
+         
+  
+}
\ No newline at end of file

Added: trunk/src/net/sf/plantlore/client/overview/TransformationChangeCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/TransformationChangeCtrl.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/TransformationChangeCtrl.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -0,0 +1,107 @@
+/*
+ * TransformationChangeCtrl.java
+ *
+ * Created on 27. srpen 2006, 10:13
+ *
+ * To change this template, choose Tools | Template Manager
+ * and open the template in the editor.
+ */
+
+package net.sf.plantlore.client.overview;
+
+import java.awt.event.ActionEvent;
+import java.awt.event.ActionListener;
+import java.awt.event.FocusEvent;
+import java.awt.event.FocusListener;
+import javax.swing.JOptionPane;
+import net.sf.plantlore.common.DefaultCancelAction;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
+import net.sf.plantlore.l10n.L10n;
+import org.apache.log4j.Logger;
+
+/**
+ *
+ * @author Lada
+ */
+public class TransformationChangeCtrl {
+    
+    /** Instance of a logger */
+    private Logger logger;
+    /** Model of AddEdit MVC */
+    private AddEdit model;
+    /** View of TransformationChangeView MVC */
+    private TransformationChangeView view;  
+    /** Selected coordinate system */
+    private int selectedCoordinateSystem;
+    
+    /** Creates a new instance of TransformationChangeCtrl */
+    public TransformationChangeCtrl(AddEdit modelAddEdit, TransformationChangeView viewTransf) {
+        this.model = modelAddEdit;
+        this.view = viewTransf;
+        selectedCoordinateSystem = model.getCoordinateSystem();
+        logger = Logger.getLogger(this.getClass().getPackage().getName());
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);  
+        selectedCoordinateSystem = model.getCoordinateSystem();
+        
+        view.closeButton.setAction(new DefaultCancelAction(view)); 
+        view.changeButton.addActionListener(new ChangeSystemButtonListener());
+        view.selectedSystem.addFocusListener(new ChooseSystemComboFocusListener());
+        
+        //Add key listeners
+        view.closeButton.addKeyListener(escapeKeyPressed);
+        view.helpButton.addKeyListener(escapeKeyPressed);
+        view.changeButton.addKeyListener(escapeKeyPressed);
+        view.selectedSystem.addKeyListener(escapeKeyPressed);       
+    }
+        
+    
+    /**
+    *  ActionListener class controlling the &lt;b&gt;Change&lt;/b&gt; button on the form.
+    *  The button CHANGE is used for changing coordinate system, transformation data to select coordinate system.
+    */
+   class ChangeSystemButtonListener implements ActionListener {
+       public void actionPerformed(ActionEvent actionEvent)
+       {
+           //test whether user set transformation from one coordinate system to the same coordinate system 
+           if (model.getCoordinateSystem() == getSelectedCoordinateSystem()) {
+               JOptionPane.showMessageDialog(view, L10n.getString(&quot;Overview.TransformationInfo&quot;), L10n.getString(&quot;Overview.TrensformationInfoTitle&quot;), JOptionPane.INFORMATION_MESSAGE);       
+           } else {
+               //prevest a zavrit dialog - v hlavnim dialogu se zmeni hodnoty a info o aktualnim nastavenem systemu
+               model.transformationCoordinateSystem(getSelectedCoordinateSystem()); 
+               model.setIsCancle(false);
+               view.setVisible(false);
+           }
+       }
+   }
+    
+     /**
+     *  Focus listener for the &lt;strong&gt;choose system combobox&lt;/strong&gt;. After losing focus automaticaly 
+     *  stores value of the field to model.
+     */
+    class ChooseSystemComboFocusListener implements FocusListener {
+        public void focusLost(FocusEvent e) {            
+           setSelectedCoordinateSystem(view.selectedSystem.getSelectedIndex());
+           logger.debug(&quot;Use coordinate system: &quot;+view.selectedSystem.getSelectedIndex());
+        }        
+
+        public void focusGained(FocusEvent e) {
+            // Empty
+        }
+    } 
+       
+    /**
+     *  Set choice coordinate system (WGS-84, S-JTSK, S-42)
+     *  @param choiceSystem choice coordinate system (0 == WGS-84, 1 == S-JTSK, 2 == S-42)
+     */
+    public void setSelectedCoordinateSystem(int choiceSystem) {
+        this.selectedCoordinateSystem = choiceSystem;
+    }
+    
+    /**
+     *  Get choice coordinate system (WGS-84, S-JTSK, S-42)
+     *  @return identificator of choice coordinate system (0 == WGS-84, 1 == S-JTSK, 2 == S-42)
+     */
+    public int getSelectedCoordinateSystem() {
+        return this.selectedCoordinateSystem;
+    }
+}

Added: trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.form	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.form	2006-08-28 18:00:44 UTC (rev 586)
@@ -0,0 +1,168 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.3&quot; type=&quot;org.netbeans.modules.form.forminfo.JDialogFormInfo&quot;&gt;
+  &lt;Properties&gt;
+    &lt;Property name=&quot;defaultCloseOperation&quot; type=&quot;int&quot; value=&quot;2&quot;/&gt;
+  &lt;/Properties&gt;
+  &lt;SyntheticProperties&gt;
+    &lt;SyntheticProperty name=&quot;formSizePolicy&quot; type=&quot;int&quot; value=&quot;1&quot;/&gt;
+  &lt;/SyntheticProperties&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;1&quot;&gt;
+                      &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;80&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;changeButton&quot; min=&quot;-2&quot; pref=&quot;80&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;80&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Component id=&quot;jPanel1&quot; alignment=&quot;1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jPanel1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;changeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;closeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+          &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.TitledBorderInfo&quot;&gt;
+            &lt;TitledBorder title=&quot;&lt;User Code&gt;&quot;&gt;
+              &lt;Connection PropertyName=&quot;titleX&quot; code=&quot;L10n.getString(&quot;Overview.Transformation.Panel&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/TitledBorder&gt;
+          &lt;/Border&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+
+      &lt;Layout&gt;
+        &lt;DimensionLayout dim=&quot;0&quot;&gt;
+          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel3&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jLabel1&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;23&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;actualSystem&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;selectedSystem&quot; pref=&quot;127&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+          &lt;/Group&gt;
+        &lt;/DimensionLayout&gt;
+        &lt;DimensionLayout dim=&quot;1&quot;&gt;
+          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel1&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;actualSystem&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jLabel3&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;selectedSystem&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+          &lt;/Group&gt;
+        &lt;/DimensionLayout&gt;
+      &lt;/Layout&gt;
+      &lt;SubComponents&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel1&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;Overview.Transformation.ActualSystem&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;actualSystem&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;WGS-8&quot;/&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;jLabel3&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;Overview.Transformation.SelectedSystem&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JComboBox&quot; name=&quot;selectedSystem&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;model&quot; type=&quot;javax.swing.ComboBoxModel&quot; editor=&quot;org.netbeans.modules.form.editors2.ComboBoxModelEditor&quot;&gt;
+              &lt;StringArray count=&quot;3&quot;&gt;
+                &lt;StringItem index=&quot;0&quot; value=&quot;WGS-84&quot;/&gt;
+                &lt;StringItem index=&quot;1&quot; value=&quot;S-JTSK&quot;/&gt;
+                &lt;StringItem index=&quot;2&quot; value=&quot;S-42&quot;/&gt;
+              &lt;/StringArray&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
+      &lt;/SubComponents&gt;
+    &lt;/Container&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;closeButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Storno&quot;/&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;changeButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;Overview.Transformation.Change&quot;)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;Overview.Transformation.Help&quot;)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.java	2006-08-28 15:21:48 UTC (rev 585)
+++ trunk/src/net/sf/plantlore/client/overview/TransformationChangeView.java	2006-08-28 18:00:44 UTC (rev 586)
@@ -0,0 +1,168 @@
+/*
+ * TransformationChangeView.java
+ *
+ * Created on 26. srpen 2006, 23:48
+ */
+
+package net.sf.plantlore.client.overview;
+
+import java.util.Observable;
+import java.util.Observer;
+import javax.swing.JDialog;
+import net.sf.plantlore.common.PlantloreHelp;
+import net.sf.plantlore.l10n.L10n;
+import org.apache.log4j.Logger;
+
+/**
+ *
+ * @author  Lada
+ */
+public class TransformationChangeView extends javax.swing.JDialog  implements Observer {    
+    
+    
+    /** Model of the AddEdit MVC (AddEdit, TransformatinChangeView, TransformatinChangeCtrl)*/
+     private AddEdit model;   
+     /** Instance of Logger*/
+    private Logger logger;
+    
+    /**
+     * Creates new form TransformationChangeView
+     */
+    public TransformationChangeView(javax.swing.JDialog parent, AddEdit model, boolean modal) {
+        super(parent, modal);
+        this.model = model;
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        logger = Logger.getLogger(this.getClass().getPackage().getName());  
+        initComponents();
+        //Init Help
+        PlantloreHelp.addKeyHelp(PlantloreHelp.ADD_OCCURRENCE, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.ADD_OCCURRENCE, this.helpButton);        
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot; Generated Code &quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+        jPanel1 = new javax.swing.JPanel();
+        jLabel1 = new javax.swing.JLabel();
+        actualSystem = new javax.swing.JLabel();
+        jLabel3 = new javax.swing.JLabel();
+        selectedSystem = new javax.swing.JComboBox();
+        closeButton = new javax.swing.JButton();
+        changeButton = new javax.swing.JButton();
+        helpButton = new javax.swing.JButton();
+
+        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;Overview.Transformation.Panel&quot;)));
+        jLabel1.setText(L10n.getString(&quot;Overview.Transformation.ActualSystem&quot;));
+
+        actualSystem.setText(&quot;WGS-8&quot;);
+
+        jLabel3.setText(L10n.getString(&quot;Overview.Transformation.SelectedSystem&quot;));
+
+        selectedSystem.setModel(new javax.swing.DefaultComboBoxModel(new String[] { &quot;WGS-84&quot;, &quot;S-JTSK&quot;, &quot;S-42&quot; }));
+
+        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
+        jPanel1.setLayout(jPanel1Layout);
+        jPanel1Layout.setHorizontalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jLabel3)
+                    .add(jLabel1))
+                .add(23, 23, 23)
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(actualSystem)
+                    .add(selectedSystem, 0, 127, Short.MAX_VALUE))
+                .addContainerGap())
+        );
+        jPanel1Layout.setVerticalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jPanel1Layout.createSequentialGroup()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(jLabel1)
+                    .add(actualSystem))
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(jLabel3)
+                    .add(selectedSystem, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+        );
+
+        closeButton.setText(&quot;Storno&quot;);
+
+        changeButton.setText(L10n.getString(&quot;Overview.Transformation.Change&quot;));
+
+        helpButton.setText(L10n.getString(&quot;Overview.Transformation.Help&quot;));
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(layout.createSequentialGroup()
+                        .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                        .add(changeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 80, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED))
+                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(helpButton)
+                    .add(changeButton)
+                    .add(closeButton))
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+        );
+        pack();
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+
+    public void update(Observable o, Object arg) {
+    }  
+    
+  /**
+     *  Shows and inicialize actual data or hides this dialog depending on the value of parameter visible. 
+     *  @param visible if true, shows this component and initialize actual data; otherwise, hides this component  
+     */
+    public void setVisible(boolean visible) {
+    	if (visible) {          
+            switch (model.getCoordinateSystem()) {
+                case 0: this.actualSystem.setText(&quot;WGS-84&quot;);
+                        break;
+                case 1: this.actualSystem.setText(&quot;S-JTSK&quot;);
+                        break;
+                case 2: this.actualSystem.setText(&quot;S-42&quot;);
+                        break;
+                default:
+                        logger.error(&quot;Actual coordinate system is not setting.&quot;);                        
+            }            
+        }    	
+    	super.setVisible(visible);        
+    }
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JLabel actualSystem;
+    protected javax.swing.JButton changeButton;
+    protected javax.swing.JButton closeButton;
+    protected javax.swing.JButton helpButton;
+    private javax.swing.JLabel jLabel1;
+    private javax.swing.JLabel jLabel3;
+    private javax.swing.JPanel jPanel1;
+    protected javax.swing.JComboBox selectedSystem;
+    // End of variables declaration//GEN-END:variables
+    
+}


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000812.html">[Plantlore-dev] r585 - in trunk/src/net/sf/plantlore:	client/history client/login common common/exception l10n server
</A></li>
	<LI>Next message: <A HREF="000814.html">[Plantlore-dev] r587 - trunk/src/net/sf/plantlore/l10n
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#813">[ date ]</a>
              <a href="thread.html#813">[ thread ]</a>
              <a href="subject.html#813">[ subject ]</a>
              <a href="author.html#813">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
