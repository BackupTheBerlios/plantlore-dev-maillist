<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r497 - in trunk/src/net/sf/plantlore: common server	server/manager server/tools
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-August/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r497%20-%20in%20trunk/src/net/sf/plantlore%3A%20common%20server%0A%09server/manager%20server/tools&In-Reply-To=%3C200608090946.k799kMxX001813%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000671.html">
   <LINK REL="Next"  HREF="000673.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r497 - in trunk/src/net/sf/plantlore: common server	server/manager server/tools</H1>
    <B>krater at mail.berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r497%20-%20in%20trunk/src/net/sf/plantlore%3A%20common%20server%0A%09server/manager%20server/tools&In-Reply-To=%3C200608090946.k799kMxX001813%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r497 - in trunk/src/net/sf/plantlore: common server	server/manager server/tools">krater at mail.berlios.de
       </A><BR>
    <I>Wed Aug  9 11:46:22 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000671.html">[Plantlore-dev] r496 - in trunk/src/net/sf/plantlore: client	client/history client/metadata client/user common
</A></li>
        <LI>Next message: <A HREF="000673.html">[Plantlore-dev] Kde jsou hesla?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#672">[ date ]</a>
              <a href="thread.html#672">[ thread ]</a>
              <a href="subject.html#672">[ subject ]</a>
              <a href="author.html#672">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: krater
Date: 2006-08-09 11:46:17 +0200 (Wed, 09 Aug 2006)
New Revision: 497

Added:
   trunk/src/net/sf/plantlore/common/StandardAction.java
Modified:
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerLoginCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerLoginView.form
   trunk/src/net/sf/plantlore/server/manager/ServerLoginView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMng.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.form
   trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
   trunk/src/net/sf/plantlore/server/tools/RMI.java
Log:
ServerManager makes a heavy use of the Task now. The codebase is read from a configuration file now. In order to set the CODEBASE properly, you have to add a tag into the plantlore.server.xml file. This file is located at the same place as your plantlore.xml configuration file and contains the settings required by the server. It should look like this:

&lt;config&gt;
  &lt;server&gt;
    &lt;port&gt;1099&lt;/port&gt;
    &lt;connections&gt;20&lt;/connections&gt;
    &lt;perip&gt;3&lt;/perip&gt;
    &lt;database&gt;
      &lt;engine&gt;postgresql&lt;/engine&gt;
      &lt;port&gt;5432&lt;/port&gt;
      &lt;parameter&gt;&lt;/parameter&gt;
      &lt;masteruser&gt;postgres&lt;/masteruser&gt;
    &lt;/database&gt;
  &lt;/server&gt;
  &lt;codebase&gt;c:\Documents and Settings\yaa\workspace\Plantlore\bin/&lt;/codebase&gt;
&lt;/config&gt;

The &lt;codebase&gt; is the most important tag of them all. There should be the path (or a .jar) to the directory, where the stubs &quot;are&quot; (meaning: the path to the stubs is valid from that directory on, like net.sf.plantlore.server.HibernateDBLayer_Stub.class).

StandardAction is just a helper class to save some troubles with filling the NAME, DESCRIPTION, etc. of a button/menuitem.

Added: trunk/src/net/sf/plantlore/common/StandardAction.java
===================================================================
--- trunk/src/net/sf/plantlore/common/StandardAction.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/common/StandardAction.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -0,0 +1,19 @@
+package net.sf.plantlore.common;
+
+import javax.swing.AbstractAction;
+import javax.swing.ImageIcon;
+
+import net.sf.plantlore.client.resources.Resource;
+import net.sf.plantlore.l10n.L10n;
+
+public abstract class StandardAction extends AbstractAction {
+	
+	public StandardAction(String text) {
+		putValue(NAME, L10n.getString(text));
+		putValue(SHORT_DESCRIPTION, L10n.getString(text+&quot;TT&quot;));
+        ImageIcon icon = Resource.createIcon(text+&quot;.gif&quot;);
+		if(icon != null) putValue(SMALL_ICON, icon);
+	}
+
+
+}

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -148,24 +148,12 @@
 	}
 
 	
-	/** 
-	 * Initialize the codebase java.rmi.server.property to the specified directory or the
-	 * current working directory if the specified directory is null.
-	 * 
-	 *  @param directory	The directory that shall serve as a codebase. */
-	public static void initialize(String directory) {
-		String codebase = &quot;file:/&quot; + ((directory != null) ? directory : System.getProperty(&quot;user.dir&quot;)) + &quot;/&quot;;
-		codebase = codebase.replaceAll(&quot; &quot;, &quot;%20&quot;); // to prevent the MalformedURLException
-		System.setProperty(&quot;java.rmi.server.codebase&quot;, codebase);
-		System.out.println(&quot;java.rmi.server.codebase = &quot; + codebase);
-		
-		System.setProperty(&quot;java.rmi.dgc.leaseValue&quot;, &quot;30000&quot;); // 30 seconds, just for DEBUG.REASONS
-	}
 	
 	
+	
 	/** Static initialization. */
 	static {
-		initialize(null);
+		//RMI.addToCodebase( System.getProperty(&quot;user.dir&quot;) + &quot;/&quot; );
 	}
 	
 

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -2,41 +2,29 @@
 
 import java.awt.event.ActionEvent;
 
-import javax.swing.AbstractAction;
-import javax.swing.ImageIcon;
-
-import net.sf.plantlore.client.resources.Resource;
-import net.sf.plantlore.l10n.L10n;
+import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.StandardAction;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.server.DatabaseSettings;
 import net.sf.plantlore.server.RMIServer;
 import net.sf.plantlore.server.ServerSettings;
 
 public class ServerCreateCtrl {
-	
-	private ServerMng model;
-	private ServerCreateView view;
+
 	private ServerMngView mngView;
 	
-	public ServerCreateCtrl(ServerMng model, ServerCreateView view) {
-		this.model = model;
-		this.view = view;
+	public ServerCreateCtrl(final ServerMng model, final ServerCreateView view) {
 		
-		view.next.setAction( new CreateServerAction() );
-	}
-	
-	private class CreateServerAction extends AbstractAction {
-		public CreateServerAction() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.CreateTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.Create&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.Create.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
-		public void actionPerformed(ActionEvent arg0) {
-			// Take the stored information.
-			ServerSettings settings = model.getSettings(false);
-			
-			// Gather the information from the dialog. 
-			try {
+		mngView = new ServerMngView(model);
+		new ServerMngCtrl(model, mngView);
+		
+		view.next.setAction( new StandardAction(&quot;Server.Create&quot;) {
+			public void actionPerformed(ActionEvent arg0) {
+				// Take the stored information.
+				ServerSettings settings = model.getSettings(false);
+				
+				// Gather the information from the dialog. 
+				
 				// About the server.
 				String serverPassword = new String( view.serverPassword.getPassword() );
 				int serverPort;
@@ -50,48 +38,33 @@
 				databaseUser = view.databaseUser.getText(),
 				suffix = view.databaseParameter.getText();
 				
-				int databasePort; 
-				databasePort = Integer.parseInt(view.databasePort.getText());
+				int databasePort;
+				try {
+					databasePort = Integer.parseInt(view.databasePort.getText());
+				} catch(Exception e) { databasePort = 5432 ; }
 				
 				settings = new ServerSettings(
 						serverPort, 
-						settings.getTimeout(), // use the stored values
-						settings.getConnectionsTotal(),  // use the stored values
-						settings.getConnectionsPerIP(), // use the stored values
+						settings.getTimeout(), // use the stored value
+						settings.getConnectionsTotal(),  // use the stored value
+						settings.getConnectionsPerIP(), // use the stored value
 						new DatabaseSettings(
 								database, 
 								databasePort, 
 								suffix, 
 								databaseUser, 
 								databasePassword)
-						);
+				);
 				
 				// Save those settings.
 				model.setSettings( settings );
 				
 				// Create and run a new server.
-				if( model.startNewServer(serverPassword) ){
-					// Hide this window, create and display the ServerMngView instead.
-					view.setVisible(false);
-//					view.dispose();
-					
-					mngView = new ServerMngView(model);
-					mngView.setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
-					/*mngCtrl = */ new ServerMngCtrl(model, mngView);
-					mngView.setVisible(true);
-				}
-
-			} catch(final Exception e) {
-//				java.awt.EventQueue.invokeLater(new Runnable() {
-//					public void run() {
-//						JOptionPane.showMessageDialog(null,
-//								e.getMessage(),
-//							    L10n.getString(&quot;Error.MissingInformation&quot;),
-//							    JOptionPane.ERROR_MESSAGE);						
-//					}
-//				});
+				Task t = model.createNewServerTask( serverPassword );
+				new DefaultProgressBar(t, view, true);
+				t.start();
 			}
-		}
+		} );
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.form	2006-08-09 09:46:17 UTC (rev 497)
@@ -21,22 +21,19 @@
   &lt;Layout&gt;
     &lt;DimensionLayout dim=&quot;0&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;help&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;EmptySpace pref=&quot;307&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;next&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-          &lt;/Group&gt;
-          &lt;Component id=&quot;status&quot; alignment=&quot;0&quot; pref=&quot;453&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;1&quot;&gt;
+                      &lt;Component id=&quot;help&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;next&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
                   &lt;Component id=&quot;jPanel2&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;jPanel1&quot; alignment=&quot;0&quot; pref=&quot;433&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                   &lt;Component id=&quot;plantloreLogo&quot; alignment=&quot;0&quot; pref=&quot;433&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -54,8 +51,7 @@
                   &lt;Component id=&quot;next&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;help&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;11&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;status&quot; min=&quot;-2&quot; pref=&quot;18&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -178,15 +174,6 @@
         &lt;/Component&gt;
       &lt;/SubComponents&gt;
     &lt;/Container&gt;
-    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;status&quot;&gt;
-      &lt;Properties&gt;
-        &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-          &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.BevelBorderInfo&quot;&gt;
-            &lt;BevelBorder bevelType=&quot;1&quot;/&gt;
-          &lt;/Border&gt;
-        &lt;/Property&gt;
-      &lt;/Properties&gt;
-    &lt;/Component&gt;
     &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel2&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -9,8 +9,7 @@
 import java.util.Observable;
 import java.util.Observer;
 
-import javax.swing.JOptionPane;
-
+import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.ServerSettings;
 
@@ -19,17 +18,18 @@
  * @author  yaa
  */
 public class ServerCreateView extends javax.swing.JFrame implements Observer {
-    
 	
-//	private ServerMng model;
-
-	
     /** Creates new form ServerCreateView */
     public ServerCreateView(ServerMng model) {
     	model.addObserver(this);
+    	
         initComponents();
         getRootPane().setDefaultButton(next);
         setLocationRelativeTo(null); // center of the screen
+        /*
+        PlantloreHelp.addKeyHelp(PlantloreHelp.SERVER, this.getRootPane());
+        PlantloreHelp.addButtonHelp(PlantloreHelp.SERVER, this.help);
+        */
         
         // Initialize the components' contents.
         ServerSettings settings = model.getSettings(true);
@@ -62,7 +62,6 @@
         serverPassword = new javax.swing.JPasswordField();
         jLabel1 = new javax.swing.JLabel();
         serverPort = new javax.swing.JTextField();
-        status = new javax.swing.JLabel();
         jPanel2 = new javax.swing.JPanel();
         jLabel5 = new javax.swing.JLabel();
         databaseType = new javax.swing.JComboBox();
@@ -131,8 +130,6 @@
                 .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
 
-        status.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
-
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(null, L10n.getString(&quot;Server.DatabaseSettings&quot;)));
         jLabel5.setText(L10n.getString(&quot;Server.DatabaseType&quot;));
 
@@ -212,20 +209,17 @@
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                .addContainerGap()
-                .add(help)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 307, Short.MAX_VALUE)
-                .add(next)
-                .addContainerGap())
-            .add(status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 453, Short.MAX_VALUE)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE)
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING, false)
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+                        .add(help)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                        .add(next))
+                    .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                    .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE)
+                    .add(plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 433, Short.MAX_VALUE))
+                .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -240,8 +234,7 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(next)
                     .add(help))
-                .add(11, 11, 11)
-                .add(status, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 18, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .addContainerGap())
         );
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
@@ -267,24 +260,16 @@
     protected javax.swing.JPanel plantloreLogo;
     protected javax.swing.JPasswordField serverPassword;
     protected javax.swing.JTextField serverPort;
-    private javax.swing.JLabel status;
     // End of variables declaration//GEN-END:variables
-
     
-	public void update(Observable source, final Object parameter) {
-		java.awt.EventQueue.invokeLater(new Runnable() {
-			public void run() {
-				if(parameter instanceof String)
-					status.setText( &quot; &quot; + (String)parameter );
-				else if(parameter instanceof Exception) {
-					JOptionPane.showMessageDialog(null,
-							((Exception)parameter).getMessage(),
-						    L10n.getString(&quot;Error.ServerLoginFailed&quot;),
-						    JOptionPane.ERROR_MESSAGE);
+    
+	public void update(Observable source, Object parameter) {
+		if(parameter == ServerMng.CONNECTED)
+			java.awt.EventQueue.invokeLater(new Runnable() {
+				public void run() {
+					setVisible(false);
 				}
-			}
-		});
+			});
 	}
-	
-    
+          
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerLoginCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerLoginCtrl.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerLoginCtrl.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -2,12 +2,10 @@
 
 import java.awt.event.ActionEvent;
 
-import javax.swing.AbstractAction;
-import javax.swing.ImageIcon;
+import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.StandardAction;
+import net.sf.plantlore.common.Task;
 
-import net.sf.plantlore.client.resources.Resource;
-import net.sf.plantlore.l10n.L10n;
-
 /**
  * 
  * @author Erik Kratochv&#237;l (<A HREF="https://lists.berlios.de/mailman/listinfo/plantlore-dev">discontinuum at gmail.com</A>)
@@ -16,51 +14,35 @@
  */
 public class ServerLoginCtrl {
 	
-	private ServerMng model;
-	private ServerLoginView view;
+	private ServerMngView mngView;
 	
-	private ServerMngView serverMngView;
-//	private ServerMngCtrl serverMngCtrl;
 	
 	
-	
-	public ServerLoginCtrl(ServerMng model, ServerLoginView view) {
-		this.view = view;
-		this.model = model;
+	public ServerLoginCtrl(final ServerMng model, final ServerLoginView view) {
 		
-		view.next.setAction(new Connect());
-	}
-	
-	
-	class Connect extends AbstractAction {
-		public Connect() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.NextTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.Next&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.Connect.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
+		mngView = new ServerMngView(model);
+		new ServerMngCtrl(model, mngView);
 		
-		public void actionPerformed(ActionEvent e) {
-			String hp = view.host.getText(), host;
-			int t = hp.indexOf(':'), 
-			port = net.sf.plantlore.server.RMIServer.DEFAULT_PORT;
-			if(t &lt; 0) 
-				host = hp;
-			else { 
-				host = hp.substring(0, t); 
-				port = Integer.parseInt(hp.substring(t + 1)); 
+		view.next.setAction(new StandardAction(&quot;Server.Next&quot;) {
+			public void actionPerformed(ActionEvent e) {
+				String hostAndPort = view.host.getText(), host;
+				int delimiter = hostAndPort.indexOf(':'), 
+				port = net.sf.plantlore.server.RMIServer.DEFAULT_PORT;
+				if(delimiter &lt; 0) 
+					host = hostAndPort;
+				else { 
+					host = hostAndPort.substring(0, delimiter);
+					try {
+						port = Integer.parseInt(hostAndPort.substring(delimiter + 1));
+					} catch(Exception ex) { /* Never mind, use the default port.*/ }
+				}
+					
+				Task t = model.createConnectToRunningServerTask(host, port, new String(view.password.getPassword()) );
+				new DefaultProgressBar(t, view, true);
+				t.start();
 			}
-				
-			if( model.connectToRunningServer(host, port, new String(view.password.getPassword())) ) {
-				// Everything's fine.
-				view.setVisible(false);
-				
-				serverMngView = new ServerMngView(model);
-				serverMngView.setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
-				/*serverMngCtrl = */new ServerMngCtrl(model, serverMngView);
-				serverMngView.setVisible(true);
-			}
-		}
+			
+		});
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerLoginView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerLoginView.form	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerLoginView.form	2006-08-09 09:46:17 UTC (rev 497)
@@ -24,7 +24,7 @@
           &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;plantloreLogo&quot; alignment=&quot;0&quot; pref=&quot;397&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;plantloreLogo&quot; alignment=&quot;0&quot; pref=&quot;413&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;help&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace pref=&quot;279&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
@@ -37,21 +37,20 @@
                       &lt;/Group&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;password&quot; pref=&quot;347&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;host&quot; alignment=&quot;0&quot; pref=&quot;347&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;password&quot; pref=&quot;363&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;host&quot; alignment=&quot;0&quot; pref=&quot;363&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
               &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
-          &lt;Component id=&quot;status&quot; alignment=&quot;0&quot; pref=&quot;417&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
     &lt;DimensionLayout dim=&quot;1&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;plantloreLogo&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;plantloreLogo&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;jLabel1&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -68,7 +67,6 @@
                   &lt;Component id=&quot;help&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;status&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -113,7 +111,7 @@
       &lt;Layout&gt;
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;EmptySpace min=&quot;0&quot; pref=&quot;397&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;0&quot; pref=&quot;413&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
@@ -147,15 +145,5 @@
         &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
       &lt;/AuxValues&gt;
     &lt;/Component&gt;
-    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;status&quot;&gt;
-      &lt;Properties&gt;
-        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Awaiting commands&quot;/&gt;
-        &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-          &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.BevelBorderInfo&quot;&gt;
-            &lt;BevelBorder bevelType=&quot;1&quot;/&gt;
-          &lt;/Border&gt;
-        &lt;/Property&gt;
-      &lt;/Properties&gt;
-    &lt;/Component&gt;
   &lt;/SubComponents&gt;
 &lt;/Form&gt;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerLoginView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerLoginView.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerLoginView.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -3,8 +3,6 @@
 import java.util.Observable;
 import java.util.Observer;
 
-import javax.swing.JOptionPane;
-
 import net.sf.plantlore.l10n.L10n;
 
 
@@ -39,7 +37,6 @@
         jLabel1 = new javax.swing.JLabel();
         jLabel2 = new javax.swing.JLabel();
         help = new javax.swing.JButton();
-        status = new javax.swing.JLabel();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         setTitle(L10n.getString(&quot;Server.Login&quot;));
@@ -54,7 +51,7 @@
         plantloreLogo.setLayout(plantloreLogoLayout);
         plantloreLogoLayout.setHorizontalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(0, 397, Short.MAX_VALUE)
+            .add(0, 413, Short.MAX_VALUE)
         );
         plantloreLogoLayout.setVerticalGroup(
             plantloreLogoLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -67,9 +64,6 @@
 
         help.setText(L10n.getString(&quot;Common.Help&quot;));
 
-        status.setText(&quot;Awaiting commands&quot;);
-        status.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
-
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
         layout.setHorizontalGroup(
@@ -77,7 +71,7 @@
             .add(layout.createSequentialGroup()
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 397, Short.MAX_VALUE)
+                    .add(plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 413, Short.MAX_VALUE)
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(help)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 279, Short.MAX_VALUE)
@@ -88,16 +82,15 @@
                             .add(jLabel2))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(password, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 347, Short.MAX_VALUE)
-                            .add(host, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 347, Short.MAX_VALUE))))
+                            .add(password, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE)
+                            .add(host, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE))))
                 .addContainerGap())
-            .add(status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 417, Short.MAX_VALUE)
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(plantloreLogo, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(plantloreLogo, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(jLabel1)
@@ -110,8 +103,7 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(next)
                     .add(help))
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(status))
+                .addContainerGap())
         );
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
@@ -126,23 +118,16 @@
     protected javax.swing.JButton next;
     protected javax.swing.JPasswordField password;
     protected javax.swing.JPanel plantloreLogo;
-    private javax.swing.JLabel status;
     // End of variables declaration//GEN-END:variables
     
     
     public void update(Observable source, final Object parameter) {
-		java.awt.EventQueue.invokeLater(new Runnable() {
-			public void run() {
-				if(parameter instanceof String)
-					status.setText( &quot; &quot; + (String)parameter );
-				else if(parameter instanceof Exception) {
-					JOptionPane.showMessageDialog(null,
-							((Exception)parameter).getMessage(),
-						    L10n.getString(&quot;Error.ServerLoginFailed&quot;),
-						    JOptionPane.ERROR_MESSAGE);
+    	if(parameter == ServerMng.CONNECTED)
+			java.awt.EventQueue.invokeLater(new Runnable() {
+				public void run() {
+					setVisible(false);
 				}
-			}
-		});
+			});
 	}
 	
     

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMng.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -9,9 +9,6 @@
 import java.io.OutputStreamWriter;
 import java.io.Reader;
 import java.io.Writer;
-import java.rmi.AlreadyBoundException;
-import java.rmi.NotBoundException;
-import java.rmi.RemoteException;
 import java.rmi.registry.LocateRegistry;
 import java.rmi.registry.Registry;
 import java.util.Observable;
@@ -25,8 +22,10 @@
 import org.dom4j.io.SAXReader;
 import org.dom4j.io.XMLWriter;
 
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.*;
+import net.sf.plantlore.server.tools.RMI;
 
 /**
  * The server manager can
@@ -46,10 +45,13 @@
 public class ServerMng extends Observable {
 	
 	public static final Object UPDATE_LIST = new Object();
+	public static final Object CONNECTED = new Object();
 	
 	private static final String SERVER_CONFIG_NAME = &quot;plantlore.server.xml&quot;;
 	private static final String PLANTLORE = &quot;plantlore&quot;;
 	
+	private String codebase;
+	
 	/** The server control interface. */
 	private Server server;
 	private ServerSettings settings;
@@ -72,8 +74,14 @@
 	}
 	
 	
+	public ServerMng() {
+		getSettings(true);
+		if(codebase != null &amp;&amp; codebase.length() &gt; 0)
+			RMI.addToCodebase( codebase );
+	}
+	
+	
 	public ServerSettings getSettings(boolean refresh) {
-		
 		if( !refresh )
 			return settings;
 
@@ -86,14 +94,15 @@
 					new InputStreamReader(new FileInputStream(settingsFileName), &quot;UTF-8&quot;));
 			SAXReader saxReader = new SAXReader();
             Document document = saxReader.read( reader );
+            reader.close();
             
             Node server = document.selectSingleNode(&quot;/config/server&quot;);
-            Number portNumber = server.numberValueOf(&quot;port&quot;)/*,
+            Number portNumber = server.numberValueOf(&quot;port&quot;),
             connectionsNumber = server.numberValueOf(&quot;connections&quot;),
-            peripNumber = server.numberValueOf(&quot;perip&quot;)*/;
-            int port = (portNumber == null) ? RMIServer.DEFAULT_PORT : portNumber.intValue()/*,
-            connections = (connectionsNumber == null) ? 16 : connectionsNumber.intValue(),
-            perip = (peripNumber == null) ? 2 : peripNumber.intValue()*/;
+            peripNumber = server.numberValueOf(&quot;perip&quot;);
+            int port = (portNumber == null) ? RMIServer.DEFAULT_PORT : portNumber.intValue(),
+            connections = (connectionsNumber == null || connectionsNumber.intValue() &lt;= 1) ? 16 : connectionsNumber.intValue(),
+            perip = (peripNumber == null || peripNumber.intValue() &lt;= 1) ? 2 : peripNumber.intValue();
             
             Node database = server.selectSingleNode(&quot;database&quot;);
             
@@ -104,19 +113,15 @@
             Number databasePortNumber = database.numberValueOf(&quot;port&quot;);
             int databasePort = (databasePortNumber == null) ? 0 : databasePortNumber.intValue();
             
-            settings = new ServerSettings(port, 3, 32, 2, 
+            settings = new ServerSettings(port, 3, connections, perip, 
             		new DatabaseSettings(databaseType, databasePort, databaseParameter, databaseMasterUser, databaseMasterPassword));
             
-    		setChanged();
-    		notifyObservers(L10n.getString(&quot;Server.SettingsLoaded&quot;));
+            // Load the codebase
+            Node path = document.selectSingleNode(&quot;/config/codebase&quot;);
+            codebase = path.getText();
             
 		} catch(Exception e) {
-			logger.error(&quot;Settings could not be loaded. &quot; + e.getMessage());
-			
-			e.printStackTrace();
-			
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.SettingsNotLoaded&quot;));
+			logger.error(&quot;Unable to load settings. &quot; + e.getMessage());
 		}
 		return settings;
 	}
@@ -130,14 +135,17 @@
 		Element config = document.addElement(&quot;config&quot;),
 		server = config.addElement(&quot;server&quot;);
 		server.addElement(&quot;port&quot;).setText( &quot;&quot; + settings.getPort() );
-		//server.addElement(&quot;connections&quot;).setText( &quot;&quot; + settings.getConnectionsTotal() );
-		//server.addElement(&quot;perip&quot;).setText( &quot;&quot; + settings.getConnectionsPerIP() );
+		server.addElement(&quot;connections&quot;).setText( &quot;&quot; + settings.getConnectionsTotal() );
+		server.addElement(&quot;perip&quot;).setText( &quot;&quot; + settings.getConnectionsPerIP() );
 		
 		Element db = server.addElement(&quot;database&quot;);
 		db.addElement(&quot;engine&quot;).setText( settings.getDatabaseSettings().getDatabase() );
 		db.addElement(&quot;port&quot;).setText( &quot;&quot; + settings.getDatabaseSettings().getPort() );
 		db.addElement(&quot;parameter&quot;).setText(settings.getDatabaseSettings().getConnectionStringSuffix());
 		db.addElement(&quot;masteruser&quot;).setText(settings.getDatabaseSettings().getMasterUser());
+		
+		// Store the current codebase
+		config.addElement(&quot;codebase&quot;).setText(codebase);
 
 		try {
 			Writer outputWriter = new BufferedWriter(
@@ -148,14 +156,8 @@
 			xmlwriter.write( document );
 			xmlwriter.close();
 			outputWriter.close();
-			
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.SettingsSaved&quot;));
-			
-		} catch (java.io.IOException e) {
-			logger.error(&quot;Settings could not be saved. &quot; + e.getMessage());
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.SettingsNotSaved&quot;));
+		} catch (Exception e) {
+			logger.error(&quot;Unable to save settings. &quot; + e.getMessage());
 		}
 	}
 	
@@ -171,40 +173,29 @@
 	 * It is &lt;b&gt;not&lt;/b&gt; possible to create a server on a remote machine
 	 * (because of security reasons).
 	 * 
-	 * @param port The port where the server should listen.
 	 * @param password	The password protecting the access to the server.
-	 * @throws AlreadyBoundException if another server is already running on the specified port.
-	 * @throws RemoteException if the RMI encounters an error.
 	 */
-	synchronized public boolean startNewServer(String password) {
-		try {
-			logger.debug(&quot;Creating a new server at localhost:&quot; + settings.getPort());
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.Info.CreatingNewServer&quot;));
-			// Create a new server.
-			server = new RMIServer(settings, password);
-			
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.Info.StartingNewServer&quot;));
-			// Start the server.
-			server.start();
-			
-			logger.info(&quot;Server up and running (port &quot; + settings.getPort() + &quot;).&quot;);
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.Info.ServerUpAndRunning&quot;));
-			
-			return true;
-			
-		} catch(AlreadyBoundException e) {
-			logger.fatal(&quot;There is another server running on the specified port (&quot;+settings.getPort()+&quot;).&quot;);
-			setChanged();
-			notifyObservers(e);
-		} catch(RemoteException e) {
-			logger.fatal(&quot;The server creation failed. &quot;+e.getMessage());
-			setChanged();
-			notifyObservers(e);
-		}
-		return false;
+	public Task createNewServerTask(final String password) {
+		return new Task() {
+			public Object task() throws Exception {
+				logger.debug(&quot;Creating a new server at localhost:&quot; + settings.getPort());
+				setStatusMessage(L10n.getString(&quot;Server.Info.CreatingNewServer&quot;));
+				// Create a new server.
+				server = new RMIServer(settings, password);
+				
+				setStatusMessage(L10n.getString(&quot;Server.Info.StartingNewServer&quot;));
+				// Start the server.
+				server.start();
+				
+				logger.info(&quot;Server up and running (port &quot; + settings.getPort() + &quot;).&quot;);
+				setStatusMessage(L10n.getString(&quot;Server.Info.ServerUpAndRunning&quot;));
+				
+				announce(CONNECTED);
+				
+				fireStopped(null);
+				return server;
+			}
+		};
 	}
 
 	/**
@@ -214,68 +205,66 @@
 	 * @param host The hostname of the computer where the server is running.
 	 * @param port The port where the server is listening.
 	 * @param password The password to gain the access to the server.
-	 * @throws RemoteException if the RMI encounters an error.
-	 * @throws NotBoundException if there is no server running on the specified host:port. 
-	 * @throws CertificationException if the password is incorrect.
 	 */
-	synchronized public boolean connectToRunningServer(String host, int port, String password) {
-		try {
-			logger.info(&quot;Connecting to a running server at &quot; +host+&quot;:&quot;+port);
-			setChanged();
-			notifyObservers(L10n.getString(&quot;Server.Info.ConnectingToServer&quot;));
-			// Connect to the registry and obtain the Guard.
-			Registry registry = LocateRegistry.getRegistry(host, port);
-			Guard guard = (Guard) registry.lookup(Guard.ID);
-			// Send authorization information to gain access to the server.
-			server = guard.certify(password);
-			
-			return true;
-			
-		} catch(RemoteException e) {
-			logger.fatal(&quot;Connecting to the server failed. &quot;+e.getMessage());
-			setChanged();
-			notifyObservers(e);
-		} catch(NotBoundException e) {
-			logger.fatal(&quot;There is no server running on &quot;+host+&quot;:&quot;+port+&quot;. &quot; + e.getMessage());
-			setChanged();
-			notifyObservers(e);
-		} catch(CertificationException e) {
-			logger.fatal(&quot;The certification failed. &quot;+e.getMessage());
-			setChanged();
-			notifyObservers(e);
-		}
-		return false;
+	public Task createConnectToRunningServerTask(final String host, final int port, final String password) {
+		return new Task() {
+			public Object task() throws Exception {
+				logger.info(&quot;Connecting to a running server at &quot; +host+&quot;:&quot;+port);
+				setStatusMessage(L10n.getString(&quot;Server.Info.ConnectingToServer&quot;));
+				// Connect to the registry and obtain the Guard.
+				Registry registry = LocateRegistry.getRegistry(host, port);
+				Guard guard = (Guard) registry.lookup(Guard.ID);
+				// Send authorization information to gain access to the server.
+				server = guard.certify(password);
+				
+				announce(CONNECTED);
+				
+				fireStopped(null);
+				return server;
+			}
+		};
 	}
 	
+	
+	private void announce(Object event) {
+		setChanged();
+		notifyObservers(event);
+	}
+	
 
 	/**
 	 * Get the list of connected clients.
-	 * If &lt;code&gt;refresh&lt;/code&gt; is true, the server is asked and the list of clients is refreshed.
-	 * If it is false, the stored list of connected clients is returned. 
-	 * 
-	 * @param refresh true means get the list from the server, false means get it from the local cache. 
-	 * @return The (possibly not updated) list of connected clients so that you can see whom you can kick, 
-	 * 	or null if noone is connected or we are not connected (or running) to some server.   
+	 * @return The updated list of connected clients so that you can see whom you can kick, 
+	 * 	or null if we are not connected to some server.   
 	 */
-	synchronized public ConnectionInfo[] getConnectedUsers(boolean refresh) {
-		try {
-			if(server == null) 
-				return null;
-			
-			if(refresh) {
+	public Task createUpdateConnectedUsersTask() {
+		return new Task() {
+			public Object task() throws Exception {
+				if(server == null) {
+					fireStopped(null);
+					return null;
+				}
+				
+				setStatusMessage(L10n.getString(&quot;Server.Info.ObtainingClients&quot;));
+				
 				clients = server.getClients();
-				setChanged();
-				notifyObservers(UPDATE_LIST);
+				announce(UPDATE_LIST);
+				
+				setStatusMessage(L10n.getString(&quot;Server.Info.ClientsObtained&quot;));
+				
+				fireStopped(null);
+				return clients;
 			}
-			
-			setChanged(); 
-			notifyObservers(L10n.getString(&quot;Server.Info.ClientsObtained&quot;));
-			
-		} catch( RemoteException e) { 
-			logger.fatal(&quot;Unable to obtain the list of connected users. &quot; + e.getMessage());
-			setChanged(); 
-			notifyObservers(e);
-		}
+		};
+	}
+	
+	/**
+	 * Get the list of connected clients.
+	 * 
+	 * @return The (possibly outdated) list of connected clients so that you can see whom you can kick, 
+	 * 	or null if we are not connected to some server.   
+	 */
+	public ConnectionInfo[] getConnectedUsers() {
 		return clients;
 	}
 	
@@ -283,52 +272,55 @@
 	 * Disconnect the selected client from the server.
 	 * 
 	 * @param client The client to be kicked out of the server.
-	 * @throws RemoteException if the RMI has problems with this drastic task.
 	 */
-	synchronized public void kick(ConnectionInfo client) {
-		try {
-			if(server == null || client == null) 
-				return;
+	public Task createKickTask(final ConnectionInfo client) {
+		return new Task() {
+			public Object task() throws Exception {
+				if(server == null || client == null) {
+					fireStopped(null);
+					return null;
+				}
+				
+				setStatusMessage(L10n.getString(&quot;Server.Info.KickingClient&quot;));
+				
+				server.disconnect(client);
+				
+				logger.info(client + &quot; was kicked out of the server.&quot;);
+				setStatusMessage(L10n.getFormattedString(&quot;Server.Info.ClientKicked&quot;, client));
 			
-			server.disconnect(client);
-			
-			logger.info(client + &quot; was kicked out of the server. Muhehee.&quot;);
-			setChanged(); 
-			notifyObservers(L10n.getFormattedString(&quot;Server.Info.ClientKicked&quot;, client));
-			
-		} catch(RemoteException e) {
-			logger.fatal(&quot;Unable to kick the user &quot;+client+&quot;. &quot; + e.getMessage());
-			setChanged(); 
-			notifyObservers(e);
-		}
-		
-		// Reload the list of connected users.
-		getConnectedUsers(true);
+				// 	Reload the list of connected users.
+				createUpdateConnectedUsersTask().start();
+				
+				fireStopped(null);
+				return null;
+			}
+		};
 	}
 	
 	/**
 	 * Terminate the server.
 	 * &lt;b&gt;Warning:&lt;/b&gt; This will also kick all users as well.
-	 * 
-	 * @throws RemoteException if the RMI has personal feelings for the server.
 	 */
-	synchronized public void terminateServer()  {
-		try {
-			if(server != null)
-				server.stop();
-
-			server = null;
-			
-			logger.info(&quot;Server terminated.&quot;);
-			setChanged(); 
-			notifyObservers(L10n.getString(&quot;Server.Info.Terminated&quot;));
-			
-		}catch(RemoteException e) { 
-			logger.fatal(&quot;Unable to stop the server. &quot; + e.getMessage());
-			setChanged(); 
-			notifyObservers(e);
-		}
+	public Task createTerminateServerTask()  {
+		return new Task() {
+			public Object task() throws Exception {
+				
+				setStatusMessage(L10n.getString(&quot;Server.Info.TerminatingServer&quot;));
+				
+				if(server != null)
+					server.stop();
+				
+				server = null;
+				
+				logger.info(&quot;Server terminated.&quot;);
+				setStatusMessage(L10n.getString(&quot;Server.Info.Terminated&quot;));
+				
+				fireStopped(null);
+				System.exit(0);
+				return null;
+			}
+		};
 	}
 	
-
+	
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -2,11 +2,9 @@
 
 import java.awt.event.ActionEvent;
 
-import javax.swing.AbstractAction;
-import javax.swing.ImageIcon;
-
-import net.sf.plantlore.client.resources.Resource;
-import net.sf.plantlore.l10n.L10n;
+import net.sf.plantlore.common.DefaultProgressBar;
+import net.sf.plantlore.common.StandardAction;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.server.ConnectionInfo;
 
 /**
@@ -16,78 +14,41 @@
  */
 public class ServerMngCtrl {
 	
-	private ServerMngView view;
-	private ServerMng model;
-	private boolean terminated = false;
 	
-	public ServerMngCtrl(ServerMng model, ServerMngView view) {
-		this.model = model; this. view = view;
+	public ServerMngCtrl(final ServerMng model, final ServerMngView view) {
 		
-		view.kick.setAction(new KickUserAction());
-		view.terminate.setAction(new TerminateServerAction());
-		view.refresh.setAction(new RefreshAction());
-		view.hide.setAction(new HideAction());
+		view.kick.setAction(new StandardAction(&quot;Server.KickUser&quot;) {
+			public void actionPerformed(ActionEvent arg0) {
+				Task t = model.createKickTask( (ConnectionInfo)view.users.getSelectedValue() );
+				new DefaultProgressBar(t, view, true);
+				t.start();			
+			}
+		});
+		
+		view.terminate.setAction(new StandardAction(&quot;Server.Terminate&quot;) {
+			public void actionPerformed(ActionEvent arg0) {
+				Task t = model.createTerminateServerTask();
+				new DefaultProgressBar(t, view, true);
+				t.start();	
+			}
+		});
+		
+		view.refresh.setAction(new StandardAction(&quot;Server.Refresh&quot;) {
+			public void actionPerformed(ActionEvent arg0) {
+				Task t = model.createUpdateConnectedUsersTask();
+				new DefaultProgressBar(t, view, true);
+				t.start();
+			}
+		});
+		
+		view.hide.setAction(new StandardAction(&quot;Server.Hide&quot;) {
+			public void actionPerformed(ActionEvent ae) {
+				view.setVisible(false);
+				view.dispose();
+			}
+		});
 	}
+
 	
-	
-	class KickUserAction extends AbstractAction {
-		public KickUserAction() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.KickUserTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.KickUser&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.KickUser.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
-		public void actionPerformed(ActionEvent ae) {
-			Object client = view.users.getSelectedValue();
-			if(client == null) 
-				return;
-			else if(client instanceof ConnectionInfo) 
-				model.kick( (ConnectionInfo)client );
-		}
-	}
-	
-	class TerminateServerAction extends AbstractAction {
-		public TerminateServerAction() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.TerminateTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.Terminate&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.Terminate.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
-		public void actionPerformed(ActionEvent ae) {
-			model.terminateServer();
-			// Disable Terminate, Refresh and Kick buttons.
-			view.terminate.setEnabled(false);
-			view.refresh.setEnabled(false);
-			view.kick.setEnabled(false);
-			terminated = true;
-		}
-	}
-	
-	class RefreshAction extends AbstractAction {
-		public RefreshAction() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.RefreshTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.Refresh&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.Refresh.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
-		public void actionPerformed(ActionEvent ae) {
-			model.getConnectedUsers(true);
-		}
-	}
-	
-	class HideAction extends AbstractAction {
-		public HideAction() {
-			putValue(SHORT_DESCRIPTION, L10n.getString(&quot;Server.HideTT&quot;));
-			putValue(NAME, L10n.getString(&quot;Server.Hide&quot;));
-            ImageIcon icon = Resource.createIcon(&quot;Server.Hide.gif&quot;);
-			if(icon != null) putValue(SMALL_ICON, icon);
-		}
-		public void actionPerformed(ActionEvent ae) {
-			view.setVisible(false);
-			view.dispose();
-			if(terminated)
-				System.exit(0);
-		}
-	}
 
 }

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.form
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.form	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.form	2006-08-09 09:46:17 UTC (rev 497)
@@ -30,11 +30,11 @@
                       &lt;Component id=&quot;terminate&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;hide&quot; linkSize=&quot;1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
-          &lt;Component id=&quot;status&quot; alignment=&quot;0&quot; pref=&quot;363&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
           &lt;Component id=&quot;jToolBar1&quot; alignment=&quot;0&quot; pref=&quot;363&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -43,15 +43,14 @@
           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Component id=&quot;jToolBar1&quot; min=&quot;-2&quot; pref=&quot;25&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;215&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;221&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;hide&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Component id=&quot;help&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;terminate&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;help&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;status&quot; min=&quot;-2&quot; pref=&quot;18&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -99,16 +98,6 @@
         &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
       &lt;/AuxValues&gt;
     &lt;/Component&gt;
-    &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;status&quot;&gt;
-      &lt;Properties&gt;
-        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;Server up and running&quot;/&gt;
-        &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
-          &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.BevelBorderInfo&quot;&gt;
-            &lt;BevelBorder bevelType=&quot;1&quot;/&gt;
-          &lt;/Border&gt;
-        &lt;/Property&gt;
-      &lt;/Properties&gt;
-    &lt;/Component&gt;
     &lt;Container class=&quot;javax.swing.JToolBar&quot; name=&quot;jToolBar1&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;floatable&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngView.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -9,9 +9,6 @@
 import java.util.Observable;
 import java.util.Observer;
 
-import javax.swing.JOptionPane;
-
-
 import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.server.ConnectionInfo;
 
@@ -46,7 +43,6 @@
         users = new javax.swing.JList();
         hide = new javax.swing.JButton();
         help = new javax.swing.JButton();
-        status = new javax.swing.JLabel();
         jToolBar1 = new javax.swing.JToolBar();
         refresh = new javax.swing.JButton();
         kick = new javax.swing.JButton();
@@ -61,9 +57,6 @@
 
         help.setText(L10n.getString(&quot;Common.Help&quot;));
 
-        status.setText(&quot;Server up and running&quot;);
-        status.setBorder(javax.swing.BorderFactory.createBevelBorder(javax.swing.border.BevelBorder.LOWERED));
-
         jToolBar1.setFloatable(false);
         refresh.setText(L10n.getString(&quot;Server.Refresh&quot;));
         jToolBar1.add(refresh);
@@ -86,9 +79,9 @@
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 166, Short.MAX_VALUE)
                         .add(terminate)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(hide)))
+                        .add(hide)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                 .addContainerGap())
-            .add(status, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE)
             .add(jToolBar1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 363, Short.MAX_VALUE)
         );
 
@@ -99,14 +92,13 @@
             .add(layout.createSequentialGroup()
                 .add(jToolBar1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 25, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 215, Short.MAX_VALUE)
+                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 221, Short.MAX_VALUE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(hide)
-                    .add(help)
-                    .add(terminate))
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(status, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 18, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(terminate)
+                    .add(help))
+                .addContainerGap())
         );
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
@@ -120,7 +112,6 @@
     private javax.swing.JToolBar jToolBar1;
     protected javax.swing.JButton kick;
     protected javax.swing.JButton refresh;
-    private javax.swing.JLabel status;
     protected javax.swing.JButton terminate;
     protected javax.swing.JList users;
     // End of variables declaration//GEN-END:variables
@@ -131,22 +122,16 @@
      */
 	public void update(Observable source, final Object parameter) {
 		if(parameter == ServerMng.UPDATE_LIST){
-			ConnectionInfo[] clients = model.getConnectedUsers(false);
+			ConnectionInfo[] clients = model.getConnectedUsers();
 			if(clients != null) 
 				users.setListData(clients);
 			else 
 				users.setListData(new String[] {&quot;&quot;});
-		} else
-			java.awt.EventQueue.invokeLater(new Runnable(){
+		} 
+		else if( parameter == ServerMng.CONNECTED ) 
+			java.awt.EventQueue.invokeLater(new Runnable() {
 				public void run() {
-					if(parameter instanceof String)
-						status.setText((String)parameter);
-					else if(parameter instanceof Exception) {
-						JOptionPane.showMessageDialog(null,
-								((Exception)parameter).getMessage(),
-							    L10n.getString(&quot;Error.ServerOperationFailed&quot;),
-							    JOptionPane.ERROR_MESSAGE);
-					}
+					setVisible(true);
 				}
 			});
 	}

Modified: trunk/src/net/sf/plantlore/server/tools/RMI.java
===================================================================
--- trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-08-08 16:12:12 UTC (rev 496)
+++ trunk/src/net/sf/plantlore/server/tools/RMI.java	2006-08-09 09:46:17 UTC (rev 497)
@@ -9,6 +9,11 @@
 
 public class RMI {
 	
+	
+	public static final String PROPERTY_CODEBASE = &quot;java.rmi.server.codebase&quot;;
+	public static final String PROPERTY_LEASEVALUE = &quot;java.rmi.dgc.leaseValue&quot;;
+	
+	
 	public static void bind(Remote object, String name) 
 	throws RemoteException, AccessException, AlreadyBoundException {
 		
@@ -47,5 +52,34 @@
 	public static void unexport(Remote object) throws NoSuchObjectException {
 		UnicastRemoteObject.unexportObject(object, true);
 	}
+	
+	
+	/** 
+	 * Initialize the codebase java.rmi.server.property to the specified directory or the
+	 * current working directory if the specified directory is null.
+	 * &lt;br/&gt;
+	 * Do not forget that directories must end with a slash 
+	 * while JAR files must not.
+	 * 
+	 *  @param directory	The directory that shall serve as a codebase. */
+	public static void addToCodebase(String directory) {
+		String codebase = System.getProperty(PROPERTY_CODEBASE);
+		directory = &quot;file:/&quot; + directory.replaceAll(&quot; &quot;, &quot;%20&quot;); // to prevent the MalformedURLException
+		
+		if( codebase != null &amp;&amp; codebase.length() &gt; 0 ) {
+			if( !codebase.contains(directory) )
+				codebase = codebase + &quot; &quot; + directory;
+		}
+		else
+			codebase = directory;
+		
+		System.setProperty(PROPERTY_CODEBASE, codebase);
+		System.out.println(&quot;java.rmi.server.codebase = &quot; + codebase);
+	}
+	
+	
+	public static void setLeaseValue(int value) {
+		System.setProperty( PROPERTY_LEASEVALUE, Integer.toString(value) ); 
+	}
 
 }


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000671.html">[Plantlore-dev] r496 - in trunk/src/net/sf/plantlore: client	client/history client/metadata client/user common
</A></li>
	<LI>Next message: <A HREF="000673.html">[Plantlore-dev] Kde jsou hesla?
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#672">[ date ]</a>
              <a href="thread.html#672">[ thread ]</a>
              <a href="subject.html#672">[ subject ]</a>
              <a href="author.html#672">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
