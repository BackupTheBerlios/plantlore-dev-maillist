<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r162 - in trunk/src/net/sf/plantlore: client/history l10n
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-April/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r162%20-%20in%20trunk/src/net/sf/plantlore%3A%20client/history%20l10n&In-Reply-To=%3C200604202140.k3KLeUxw000749%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000166.html">
   <LINK REL="Next"  HREF="000168.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r162 - in trunk/src/net/sf/plantlore: client/history l10n</H1>
    <B>lada at berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r162%20-%20in%20trunk/src/net/sf/plantlore%3A%20client/history%20l10n&In-Reply-To=%3C200604202140.k3KLeUxw000749%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r162 - in trunk/src/net/sf/plantlore: client/history l10n">lada at berlios.de
       </A><BR>
    <I>Thu Apr 20 23:40:30 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000166.html">[Plantlore-dev] Dnesna schodzka
</A></li>
        <LI>Next message: <A HREF="000168.html">[Plantlore-dev] r163 - trunk/analysis/database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#167">[ date ]</a>
              <a href="thread.html#167">[ thread ]</a>
              <a href="subject.html#167">[ subject ]</a>
              <a href="author.html#167">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lada
Date: 2006-04-20 23:40:28 +0200 (Thu, 20 Apr 2006)
New Revision: 162

Added:
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
Modified:
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/history/WholeHistory.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
Log:
Whole history - add details dialog. Repair warning and using finally. 

Added: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-04-20 21:40:28 UTC (rev 162)
@@ -0,0 +1,133 @@
+&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
+
+&lt;Form version=&quot;1.3&quot; type=&quot;org.netbeans.modules.form.forminfo.JDialogFormInfo&quot;&gt;
+  &lt;Properties&gt;
+    &lt;Property name=&quot;defaultCloseOperation&quot; type=&quot;int&quot; value=&quot;2&quot;/&gt;
+  &lt;/Properties&gt;
+  &lt;SyntheticProperties&gt;
+    &lt;SyntheticProperty name=&quot;formSizePolicy&quot; type=&quot;int&quot; value=&quot;1&quot;/&gt;
+  &lt;/SyntheticProperties&gt;
+  &lt;AuxValues&gt;
+    &lt;AuxValue name=&quot;FormSettings_generateMnemonicsCode&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_listenerGenerationStyle&quot; type=&quot;java.lang.Integer&quot; value=&quot;0&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesLocal&quot; type=&quot;java.lang.Boolean&quot; value=&quot;false&quot;/&gt;
+    &lt;AuxValue name=&quot;FormSettings_variablesModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;2&quot;/&gt;
+  &lt;/AuxValues&gt;
+
+  &lt;Layout&gt;
+    &lt;DimensionLayout dim=&quot;0&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jPanel1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;186&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;okButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;27&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;20&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+    &lt;DimensionLayout dim=&quot;1&quot;&gt;
+      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jPanel1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;22&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;okButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;closeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;/Group&gt;
+              &lt;EmptySpace pref=&quot;21&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+      &lt;/Group&gt;
+    &lt;/DimensionLayout&gt;
+  &lt;/Layout&gt;
+  &lt;SubComponents&gt;
+    &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel1&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;border&quot; type=&quot;javax.swing.border.Border&quot; editor=&quot;org.netbeans.modules.form.editors2.BorderEditor&quot;&gt;
+          &lt;Border info=&quot;org.netbeans.modules.form.compat2.border.TitledBorderInfo&quot;&gt;
+            &lt;TitledBorder title=&quot;Details of history record&quot;/&gt;
+          &lt;/Border&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+
+      &lt;Layout&gt;
+        &lt;DimensionLayout dim=&quot;0&quot;&gt;
+          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Component id=&quot;jScrollPane2&quot; alignment=&quot;0&quot; pref=&quot;642&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+        &lt;/DimensionLayout&gt;
+        &lt;DimensionLayout dim=&quot;1&quot;&gt;
+          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Component id=&quot;jScrollPane2&quot; alignment=&quot;0&quot; pref=&quot;295&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
+        &lt;/DimensionLayout&gt;
+      &lt;/Layout&gt;
+      &lt;SubComponents&gt;
+        &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane2&quot;&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;autoScrollPane&quot; type=&quot;java.lang.Boolean&quot; value=&quot;true&quot;/&gt;
+          &lt;/AuxValues&gt;
+
+          &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
+          &lt;SubComponents&gt;
+            &lt;Component class=&quot;javax.swing.JTextArea&quot; name=&quot;detailsTextArea&quot;&gt;
+              &lt;Properties&gt;
+                &lt;Property name=&quot;columns&quot; type=&quot;int&quot; value=&quot;20&quot;/&gt;
+                &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.beaninfo.editors.FontEditor&quot;&gt;
+                  &lt;Font name=&quot;Arial&quot; size=&quot;12&quot; style=&quot;0&quot;/&gt;
+                &lt;/Property&gt;
+                &lt;Property name=&quot;rows&quot; type=&quot;int&quot; value=&quot;5&quot;/&gt;
+                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; value=&quot;testovaci nasazeni textu&quot;/&gt;
+              &lt;/Properties&gt;
+              &lt;AuxValues&gt;
+                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+              &lt;/AuxValues&gt;
+            &lt;/Component&gt;
+          &lt;/SubComponents&gt;
+        &lt;/Container&gt;
+      &lt;/SubComponents&gt;
+    &lt;/Container&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;Ok&quot;)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;closeButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;Close&quot;)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
+      &lt;Properties&gt;
+        &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;Help&quot;)&quot; type=&quot;code&quot;/&gt;
+        &lt;/Property&gt;
+      &lt;/Properties&gt;
+      &lt;AuxValues&gt;
+        &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+      &lt;/AuxValues&gt;
+    &lt;/Component&gt;
+  &lt;/SubComponents&gt;
+&lt;/Form&gt;

Added: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -0,0 +1,119 @@
+/*
+ * DetailsHistoryView.java
+ *
+ * Created on 19. duben 2006, 14:39
+ */
+
+package net.sf.plantlore.client.history;
+
+import javax.swing.JDialog;
+import net.sf.plantlore.l10n.L10n;
+
+/**
+ *
+ * @author  Lada
+ */
+public class DetailsHistoryView extends javax.swing.JDialog {
+    
+    /**
+     * Creates new form DetailsHistoryView
+     */
+    public DetailsHistoryView(WholeHistory model, javax.swing.JDialog parent, boolean modal) {
+        super(parent, modal);
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
+        initComponents();        
+    }
+    
+    /** This method is called from within the constructor to
+     * initialize the form.
+     * WARNING: Do NOT modify this code. The content of this method is
+     * always regenerated by the Form Editor.
+     */
+    // &lt;editor-fold defaultstate=&quot;collapsed&quot; desc=&quot; Generated Code &quot;&gt;//GEN-BEGIN:initComponents
+    private void initComponents() {
+        jPanel1 = new javax.swing.JPanel();
+        jScrollPane2 = new javax.swing.JScrollPane();
+        detailsTextArea = new javax.swing.JTextArea();
+        okButton = new javax.swing.JButton();
+        closeButton = new javax.swing.JButton();
+        helpButton = new javax.swing.JButton();
+
+        setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
+        jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(&quot;Details of history record&quot;));
+        detailsTextArea.setColumns(20);
+        detailsTextArea.setFont(new java.awt.Font(&quot;Arial&quot;, 0, 12));
+        detailsTextArea.setRows(5);
+        detailsTextArea.setText(&quot;testovaci nasazeni textu&quot;);
+        jScrollPane2.setViewportView(detailsTextArea);
+
+        org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
+        jPanel1.setLayout(jPanel1Layout);
+        jPanel1Layout.setHorizontalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 642, Short.MAX_VALUE)
+        );
+        jPanel1Layout.setVerticalGroup(
+            jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
+        );
+
+        okButton.setText(L10n.getString(&quot;Ok&quot;));
+
+        closeButton.setText(L10n.getString(&quot;Close&quot;));
+
+        helpButton.setText(L10n.getString(&quot;Help&quot;));
+
+        org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
+        getContentPane().setLayout(layout);
+        layout.setHorizontalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(layout.createSequentialGroup()
+                        .addContainerGap()
+                        .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(layout.createSequentialGroup()
+                        .add(186, 186, 186)
+                        .add(okButton)
+                        .add(27, 27, 27)
+                        .add(closeButton)
+                        .add(20, 20, 20)
+                        .add(helpButton)))
+                .addContainerGap())
+        );
+        layout.setVerticalGroup(
+            layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+            .add(layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(22, 22, 22)
+                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(helpButton)
+                    .add(okButton)
+                    .add(closeButton))
+                .addContainerGap(21, Short.MAX_VALUE))
+        );
+        pack();
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
+    
+    /**
+     * @param args the command line arguments
+     */
+    public static void main(String args[]) {
+        java.awt.EventQueue.invokeLater(new Runnable() {
+            public void run() {
+                new DetailsHistoryView(null,new javax.swing.JDialog(), true).setVisible(true);
+            }
+        });
+    }
+    
+    // Variables declaration - do not modify//GEN-BEGIN:variables
+    protected javax.swing.JButton closeButton;
+    protected javax.swing.JTextArea detailsTextArea;
+    protected javax.swing.JButton helpButton;
+    private javax.swing.JPanel jPanel1;
+    private javax.swing.JScrollPane jScrollPane2;
+    protected javax.swing.JButton okButton;
+    // End of variables declaration//GEN-END:variables
+    
+}

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -13,9 +13,7 @@
 import java.util.HashSet;
 import java.util.Hashtable;
 import java.util.Observable;
-import java.util.Set;
 
-import net.sf.plantlore.l10n.L10n;
 import net.sf.plantlore.middleware.DBLayer;
 import net.sf.plantlore.server.DBLayerException;
 import net.sf.plantlore.middleware.SelectQuery;
@@ -26,10 +24,8 @@
 import net.sf.plantlore.common.record.Plant;
 import net.sf.plantlore.common.record.Publication;
 import net.sf.plantlore.common.record.Territory;
-import net.sf.plantlore.common.record.User;
 import net.sf.plantlore.common.record.HistoryRecord;
 import net.sf.plantlore.common.record.HistoryChange;
-import net.sf.plantlore.common.record.HistoryColumn;
 import net.sf.plantlore.common.record.Village;
 
 
@@ -74,8 +70,6 @@
     private boolean editHabitat;
     //zprava pro uzivatele
     private String messageUndo;
-    //zaznamenani ITEM, jejichz zmena ovlibni vice polozek
-   private ArrayList&lt;String&gt; itemAffectMore = new ArrayList();
     
     //*********************Record of history ***************************************//    
     private Occurrence occurrence;
@@ -114,7 +108,6 @@
 
      //********************************************************//
      /** Mapping of entities */
-    private Hashtable&lt;String, Integer&gt; publicationHash;
     private Hashtable&lt;String, Integer&gt; habitatHash;
     private Hashtable&lt;String, Integer&gt; occurrenceHash;  
     
@@ -153,10 +146,8 @@
            logger.error(&quot;Searching occurence failed.&quot;);          
        } catch (RemoteException e) {
     	   System.err.println(&quot;RemoteException- History(), executeQuery&quot;);
-	   } finally {
-	    	   logger.debug(&quot;Searching occurrence ends successfully&quot;);                           
-	       }   
-	   
+	   } 
+       
 	   Object[] objectOccurrence = null;
 	   Object[] objHis = null;
        try {
@@ -170,8 +161,6 @@
        } catch (DBLayerException e) {
            // Log and set error in case of an exception
            logger.error(&quot;Processing search occurrence results failed: &quot;+e.toString());            
-       } finally { 
-       	   logger.debug(&quot;Sets occurrence data ends successfully.&quot;);        	
        } 
               
        occurrence = ((Occurrence)objHis[0]);
@@ -220,17 +209,15 @@
        int resultIdInsert = 0;
        try {
            // Execute query                    
-           resultIdInsert = database.executeQuery(query);        
+           resultIdInsert = database.executeQuery(query); 
+           // Save &quot;insert&quot; history data
+           setInsertResult(resultIdInsert);
        } catch (DBLayerException e) {
            // Log and set an error                   
            logger.error(&quot;Searching history data with condition 'operation = insert' failed. Unable to execute search query.&quot;);          
        } catch (RemoteException e) {		 
     	   System.err.println(&quot;RemoteException- searchInsertInfo(), executeQuery&quot;);
-	} finally {
-    	   logger.debug(&quot;Searching history data with condition 'operation = insert' ends successfully&quot;);
-           // Save &quot;insert&quot; history data
-           setInsertResult(resultIdInsert);                    
-       }              
+	    }             
     }
     
     
@@ -261,17 +248,15 @@
         int resultIdEdit = 0;
         try {
             // Execute query                    
-            resultIdEdit = database.executeQuery(query);        
+            resultIdEdit = database.executeQuery(query); 
+            // Save &quot;edit&quot; history data
+            setEditResult(resultIdEdit);
         } catch (DBLayerException e) {
             // Log and set an error                   
             logger.error(&quot;Searching history data with condition 'operation = edit' failed. Unable to execute search query.&quot;);           
         } catch (RemoteException e) { 		   
      	   System.err.println(&quot;RemoteException- searchEditHistory(), executeQuery&quot;);
-	 	} finally {
-	 		logger.debug(&quot;Searching history data with condition 'operation = edit' ends successfully&quot;);
-        	// Save &quot;edit&quot; history data
-            setEditResult(resultIdEdit);                  
-	 	}              
+	 	}           
     }
     
     
@@ -300,9 +285,7 @@
          	setNameUser(((HistoryChange)objHis[0]).getWho().getWholeName());         	
         } catch (DBLayerException e) {         
             logger.error(&quot;Processing search (inserting) results failed: &quot;+e.toString());            
-        } finally { 
-        	logger.debug(&quot;Sets 'insert' data ends successfully.&quot;);        	
-        }        
+        }       
     }
     
     
@@ -345,14 +328,12 @@
                     for (int i=0; i&lt;countResult; i++ ) {                    							
 						Object[] objHis = (Object[])objectHistory[i];
                         this.editHistoryDataList.add((HistoryRecord)objHis[0]);
-                    }                     
+                    }           
+                    //Update current first displayed row (only if data retrieval was successful)
+                    setCurrentFirstRow(fromTable); 
                 } catch (DBLayerException e) {                  
                     logger.error(&quot;Processing search results failed: &quot;+e.toString());            
-                } finally { 
-                	logger.debug(&quot;Sets 'edit' data ends successfully&quot;);
-                	//Update current first displayed row (only if data retrieval was successful)
-                    setCurrentFirstRow(fromTable);                    
-                }               
+                }             
             }
         }         
     }
@@ -424,9 +405,7 @@
             logger.error(&quot;Searching &quot; +typeObject+ &quot; failed. Unable to execute search query.&quot;);
         } catch (RemoteException e) {		 
      	   System.err.println(&quot;RemoteException- executeQuery &quot; +typeObject);
- 	    } finally {
-     	   logger.debug(&quot;Searching &quot; +typeObject+ &quot; ends successfully&quot;);
-        }         
+ 	    }        
 
  	   Object[] objects = null;
  	   Object[] object = null;
@@ -440,10 +419,9 @@
         	object = (Object[])objects[0];           
        } catch (DBLayerException e) {
            // Log and set error in case of an exception
-           logger.error(&quot;Processing search &quot; +typeObject+ &quot; results failed: &quot;+e.toString());            
-       } finally {     	    
-    	   	return object; 	       	          	   
-       }     	        
+           logger.error(&quot;Processing search &quot; +typeObject+ &quot; results failed: &quot;+e.toString());               
+       }     	    
+       return object; 	       	          	          	       
     }
     
  
@@ -615,7 +593,7 @@
                 		 */ 	                		  
                 		occurrence.getHabitat().setQuadrant(oldValue);		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Quadrant.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {
 	                		// existuji dva edity EDIT (ovlivni jeden nalez) a EDITGROUP (ovlivni vice nalezu)
 	                		// potrebujeme zjistit, zda pro dany nalez je vazeba mezi tHabitats a tOccurrences vzdy 1:N
 	                		// nebo zda editaci nalezu vznikla vazvba 1:1
@@ -625,35 +603,35 @@
  	                case 2: //Place description 	                	 	                			                		 
                 		occurrence.getHabitat().setDescription(oldValue);		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Description.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                         
 	                	} 	              	
  	                	break;
  	                case 3:  //Country 	                	 	                			                		 
                 		occurrence.getHabitat().setCountry(oldValue);		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Country.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                          
 	                	} 	
  	                    break;
  	                case 4: //Altitude 	                	                			                		 
                 		occurrence.getHabitat().setAltitude(Double.parseDouble(oldValue));		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Altitude.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                          
 	                	} 	
  	                	break;
  	                case 5:  //Latitude   	                		                			                		  
                 		occurrence.getHabitat().setLatitude(Double.parseDouble(oldValue));		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Latitude.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                        
 	                	} 	
  	                    break;
  	                case 6: //Longitude 	                		                			                		
                 		occurrence.getHabitat().setLongitude(Double.parseDouble(oldValue));		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Longitude.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                         
 	                	} 	
  	                	break;
@@ -667,7 +645,7 @@
             			} else {
             				logger.error(&quot;UNDO - Incorrect oldRecordId for Village.&quot;);
             			}
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                        
 	                	} 	
  	                    break;
@@ -681,7 +659,7 @@
  	                	}else {
             				logger.error(&quot;UNDO - Incorrect oldRecordId for Phytochoria.&quot;);
             			}
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                        
 	                	} 	
  	                    break; 	               
@@ -695,14 +673,14 @@
 	                	}else {
             				logger.error(&quot;UNDO - Incorrect oldRecordId for Territory.&quot;);
             			}	
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                      
 	                	} 	        	
 	                    break;
 	                case 10: //Note habitat	                		                			                		  
                 		occurrence.getHabitat().setNote(oldValue);		                	
 	                	logger.debug(&quot;Set selected value for update of attribute Note.&quot;);
-	                	if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+	                	if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 	                		relationship = true;                                        
 	                	} 	
 	                	break;
@@ -823,9 +801,7 @@
             logger.error(&quot;Searching historyChangeId failed. Unable to execute search query.&quot;);
         } catch (RemoteException e) {		 
      	   System.err.println(&quot;RemoteException- searchHistoryChangeId(), executeQuery&quot;);
- 	    } finally {
-     	   logger.debug(&quot;Searching historyChangeId ends successfully.&quot;);
-        }         
+ 	    }        
  	    
  	    int countResult = 100;
  	    try {

Modified: trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -5,15 +5,8 @@
 
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
-import java.awt.event.WindowEvent;
-import java.awt.event.WindowListener;
-import java.beans.PropertyChangeEvent;
-import java.beans.PropertyChangeListener;
 import java.util.ArrayList;
 
-import net.sf.plantlore.client.Settings;
-import net.sf.plantlore.client.SettingsView;
-import net.sf.plantlore.common.*;
 
 
 import org.apache.log4j.Logger;
@@ -43,7 +36,7 @@
         view.selectAllButton.addActionListener(new selectAllButtonListener());
         view.unselectAllButton.addActionListener(new unselectAllButtonListener());
         view.undoButton.addActionListener(new undoSelectedButtonListener());
-        view.toDisplayValueTextField.addPropertyChangeListener(new rowSetDisplayChangeListener());        
+        view.toDisplayValueTextField.addActionListener(new rowSetDisplayChangeListener());           
     }
     
         /** 
@@ -197,8 +190,8 @@
    /**
     * 
     */
-   class rowSetDisplayChangeListener implements PropertyChangeListener {
-	   public void propertyChange(PropertyChangeEvent e) {
+    class rowSetDisplayChangeListener implements ActionListener {
+       public void actionPerformed(ActionEvent actionEvent) {
            // Save old value
            int oldValue = model.getDisplayRows();           
            // Check whether new value &gt; 0

Modified: trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/HistoryTableModel.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -2,13 +2,7 @@
 
 import java.util.ArrayList;
 import java.util.HashSet;
-import java.util.Set;
-
-import javax.swing.DefaultCellEditor;
-import javax.swing.JCheckBox;
 import javax.swing.table.AbstractTableModel;
-import javax.swing.table.TableColumn;
-import javax.swing.table.TableColumnModel;
 
 import org.apache.log4j.Logger;
 
@@ -262,8 +256,7 @@
      * @param itemId
      * @return
      */
-    public int searchSmaller(String item, int itemId) {    	
-    	int itemNewId = -1;
+    public int searchSmaller(String item, int itemId) {    	    	
     	int firstRow = model.getCurrentFirstRow();
     	for( int i=itemId-firstRow; i &gt;=0 ; i--){
     		if (getValueAt(i,3).equals(item)){

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -8,6 +8,7 @@
 
 import java.util.Observable;
 import java.util.Observer;
+import javax.swing.JDialog;
 import javax.swing.JOptionPane;
 import javax.swing.JTable;
 import net.sf.plantlore.l10n.L10n;
@@ -30,6 +31,7 @@
                 
         super(parent, modal);
         this.model = model;
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
         initComponents();
         getTable().setModel(new HistoryTableModel(model));
     }

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistory.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistory.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistory.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -40,9 +40,7 @@
 public class WholeHistory {
     
       /** Instance of a logger */
-    private Logger logger;   
-    /** Exception with details about an error */
-    private DBLayerException error = null;
+    private Logger logger;      
     /** Instance of a database management object */
     private DBLayer database;   
     /** Constant with default number of rows to display */
@@ -88,22 +86,19 @@
     /** Operation whitch was used*/   
     private int operation;
     /** Date and time when the reccord was changed*/
-    private java.util.Date when = new Date();	
+    //private java.util.Date when = new Date();	
     /** Old value of attribute*/    
     private String oldValue;
     /** New value of attribute*/
-    private String newValue;
+    //private String newValue;
    /** Name of user who did changed*/
-    private String nameUser;
+    //private String nameUser;
     
     //********************************************************//
     /** Mapping of entities */
     private Hashtable&lt;String, Integer&gt; publicationHash;
     private Hashtable&lt;String, Integer&gt; habitatHash;
     private Hashtable&lt;String, Integer&gt; occurrenceHash;  
-    private Hashtable&lt;String, Integer&gt; villageHash;
-    private Hashtable&lt;String, Integer&gt; territoryHash;
-    private Hashtable&lt;String, Integer&gt; phytochorionHash;
     private Hashtable&lt;String, Integer&gt; authorHash;
     
     
@@ -142,16 +137,14 @@
         int resultId = 0;
         try {
             // Execute query                    
-            resultId = database.executeQuery(query);        
+            resultId = database.executeQuery(query);
+            // Save &quot;edit&quot; history data
+            setResultId(resultId);    
         } catch (DBLayerException e) {                            
             logger.error(&quot;Searching whole history data failed. Unable to execute search query.&quot;);           
         } catch (RemoteException e) { 		   
      	   System.err.println(&quot;RemoteException- searchWholeHistoryData(), executeQuery&quot;);
-        } finally {
-                logger.debug(&quot;Searching whole history data ends successfully&quot;);
-                // Save &quot;edit&quot; history data
-                setResultId(resultId);                  
-        }              
+        }          
     }
     
    /**
@@ -193,14 +186,12 @@
                     for (int i=0; i&lt;countResult; i++ ) {                    							
 						Object[] objHis = (Object[])objectHistory[i];
                         this.historyDataList.add((HistoryRecord)objHis[0]);
-                    }                     
+                    }           
+                    //Update current first displayed row (only if data retrieval was successful)
+                    setCurrentFirstRow(fromTable); 
                 } catch (DBLayerException e) {                  
                     logger.error(&quot;Processing search results failed: &quot;+e.toString());            
-                } finally { 
-                    logger.debug(&quot;Sets 'edit' data ends successfully&quot;);
-                    //Update current first displayed row (only if data retrieval was successful)
-                    setCurrentFirstRow(fromTable);                    
-                }               
+                }             
             }
         }         
     }
@@ -235,11 +226,11 @@
                /** 
                 * Pri insertu a editu nedohledavam column --&gt; prvne rozdelit podle operace a pro edit dale rozdelit podle column
                 */
-                if (operation == historyChange.HISTORYCHANGE_INSERT) {
+                if (operation == HistoryChange.HISTORYCHANGE_INSERT) {
                     undoInsertDelete(0);
-                } else if (operation == historyChange.HISTORYCHANGE_EDIT || operation == historyChange.HISTORYCHANGE_EDITGROUP) {
+                } else if (operation == HistoryChange.HISTORYCHANGE_EDIT || operation == HistoryChange.HISTORYCHANGE_EDITGROUP) {
                     undoEdit();
-                } else if (operation == historyChange.HISTORYCHANGE_DELETE) {
+                } else if (operation == HistoryChange.HISTORYCHANGE_DELETE) {
                     undoInsertDelete(1);
                 } else {
                     logger.error(&quot;Incorrect opreration code: &quot;+ operation);
@@ -476,7 +467,7 @@
                  */ 	                		  
                 occurrence.getHabitat().setQuadrant(oldValue);		                	
                 logger.debug(&quot;Set selected value for update of attribute Quadrant.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {
                 // existuji dva edity EDIT (ovlivni jeden nalez) a EDITGROUP (ovlivni vice nalezu)
                 // potrebujeme zjistit, zda pro dany nalez je vazeba mezi tHabitats a tOccurrences vzdy 1:N
                 // nebo zda editaci nalezu vznikla vazvba 1:1
@@ -486,35 +477,35 @@
         case 2: //Place description 	                	 	                			                		 
                 occurrence.getHabitat().setDescription(oldValue);		                	
                 logger.debug(&quot;Set selected value for update of attribute Description.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	              	
                 break;
         case 3:  //Country 	                	 	                			                		 
                 occurrence.getHabitat().setCountry(oldValue);		                	
                 logger.debug(&quot;Set selected value for update of attribute Country.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
             break;
         case 4: //Altitude 	                	                			                		 
                 occurrence.getHabitat().setAltitude(Double.parseDouble(oldValue));		                	
                 logger.debug(&quot;Set selected value for update of attribute Altitude.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
                 break;
         case 5:  //Latitude   	                		                			                		  
                 occurrence.getHabitat().setLatitude(Double.parseDouble(oldValue));		                	
                 logger.debug(&quot;Set selected value for update of attribute Latitude.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
             break;
         case 6: //Longitude 	                		                			                		
                 occurrence.getHabitat().setLongitude(Double.parseDouble(oldValue));		                	
                 logger.debug(&quot;Set selected value for update of attribute Longitude.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
                 break;
@@ -528,7 +519,7 @@
                 } else {
                         logger.error(&quot;UNDO - Incorrect oldRecordId for Village.&quot;);
                 }
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
             break;
@@ -542,7 +533,7 @@
                 }else {
                         logger.error(&quot;UNDO - Incorrect oldRecordId for Phytochoria.&quot;);
                 }
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
             break; 	               
@@ -556,14 +547,14 @@
                 }else {
                         logger.error(&quot;UNDO - Incorrect oldRecordId for Territory.&quot;);
                 }	
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	        	
             break;
         case 10: //Note habitat	                		                			                		  
                 occurrence.getHabitat().setNote(oldValue);		                	
                 logger.debug(&quot;Set selected value for update of attribute Note.&quot;);
-                if (operation == historyChange.HISTORYCHANGE_EDIT) {	                		
+                if (operation == HistoryChange.HISTORYCHANGE_EDIT) {	                		
 //                        relationship = true;
                 } 	
                 break;
@@ -863,10 +854,7 @@
             logger.error(&quot;Searching &quot; +typeObject+ &quot; failed. Unable to execute search query.&quot;);
         } catch (RemoteException e) {		 
      	   System.err.println(&quot;RemoteException- executeQuery &quot; +typeObject);
- 	} finally {
-     	   logger.debug(&quot;Searching &quot; +typeObject+ &quot; ends successfully&quot;);
-        }         
-
+ 	} 
        Object[] objects = null;
        Object[] object = null;
        try {
@@ -880,9 +868,9 @@
        } catch (DBLayerException e) {
            // Log and set error in case of an exception
            logger.error(&quot;Processing search &quot; +typeObject+ &quot; results failed: &quot;+e.toString());            
-       } finally {     	    
-    	   return object; 	       	          	   
-       }     	        
+       }     	    
+        return object; 	       	          	   
+           	        
     }
     
     /**
@@ -962,8 +950,7 @@
      * @param id
      * @return
      */
-    public int searchHistoryChangeId(int id){
-    	HistoryChange historyChange = ((HistoryRecord)historyDataList.get(id)).getHistoryChange();
+    public int searchHistoryChangeId(int id){    	
     	SelectQuery query = null;
         try {
         	    query = database.createQuery(HistoryRecord.class);
@@ -983,10 +970,8 @@
             logger.error(&quot;Searching historyChangeId failed. Unable to execute search query.&quot;);
         } catch (RemoteException e) {		 
      	   System.err.println(&quot;RemoteException- searchHistoryChangeId(), executeQuery&quot;);
- 	    } finally {
-     	   logger.debug(&quot;Searching historyChangeId ends successfully.&quot;);
-        }         
- 	    
+ 	    } 
+        
  	    int countResult = 100;
  	    try {
 			countResult = database.getNumRows(resultIdChange);

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -11,13 +11,9 @@
 
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
-import java.beans.PropertyChangeEvent;
-import java.beans.PropertyChangeListener;
 import org.apache.log4j.Logger;
 
 
-
-
 /**
  *
  * @author Lada
@@ -41,7 +37,8 @@
         view.previousButton.addActionListener(new previousButtonListener());
         view.nextButton.addActionListener(new nextButtonListener());     
         view.undoToDateButton.addActionListener(new undoToDateButtonListener());
-        view.toDisplayValueTextField.addPropertyChangeListener(new rowSetDisplayChangeListener());        
+        view.detailsButton.addActionListener(new detailsHistoryListener());
+        view.toDisplayValueTextField.addActionListener(new rowSetDisplayChangeListener());       
     }
     
             /** 
@@ -133,8 +130,8 @@
       /**
     * 
     */
-   class rowSetDisplayChangeListener implements PropertyChangeListener {
-	   public void propertyChange(PropertyChangeEvent e) {
+     class rowSetDisplayChangeListener implements ActionListener {
+       public void actionPerformed(ActionEvent actionEvent) {
            // Save old value
            int oldValue = model.getDisplayRows();           
            // Check whether new value &gt; 0
@@ -199,4 +196,21 @@
            }
        }
     }
+    
+    /**
+    *
+    */  
+    class detailsHistoryListener implements ActionListener {
+       public void actionPerformed(ActionEvent actionEvent)
+       {
+           if (view.tableHistoryList.getSelectedRow() &lt; 0) {    
+               view.messageUndoSelection();
+           } else {
+               //zobrazi se detailni informace o vybranem zaznamu
+               DetailsHistoryView detailsView = new DetailsHistoryView(model, view, true);
+               detailsView.setVisible(true);
+               //jeste kontroler
+           }          
+       }
+    }
 }

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-04-20 21:40:28 UTC (rev 162)
@@ -109,39 +109,35 @@
                   &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Component id=&quot;undoToDateButton&quot; alignment=&quot;0&quot; min=&quot;-2&quot; pref=&quot;126&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;/Group&gt;
-                                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                          &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;/Group&gt;
-                                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                          &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                                              &lt;EmptySpace min=&quot;10&quot; pref=&quot;10&quot; max=&quot;10&quot; attributes=&quot;0&quot;/&gt;
-                                              &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;0&quot; min=&quot;-2&quot; pref=&quot;31&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                          &lt;/Group&gt;
-                                          &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                      &lt;/Group&gt;
-                                  &lt;/Group&gt;
-                              &lt;/Group&gt;
+                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;/Group&gt;
                           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Component id=&quot;nextButton&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;Component id=&quot;previousButton&quot; alignment=&quot;0&quot; pref=&quot;125&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                                  &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;/Group&gt;
-                              &lt;EmptySpace pref=&quot;15&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                                      &lt;EmptySpace min=&quot;10&quot; pref=&quot;10&quot; max=&quot;10&quot; attributes=&quot;0&quot;/&gt;
+                                      &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;0&quot; min=&quot;-2&quot; pref=&quot;31&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;/Group&gt;
+                                  &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;/Group&gt;
                           &lt;/Group&gt;
+                          &lt;Group type=&quot;103&quot; alignment=&quot;0&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;nextButton&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;Component id=&quot;previousButton&quot; alignment=&quot;0&quot; pref=&quot;125&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;/Group&gt;
+                          &lt;Group type=&quot;103&quot; alignment=&quot;0&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;detailsButton&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;Component id=&quot;undoToDateButton&quot; alignment=&quot;0&quot; pref=&quot;126&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;/Group&gt;
                       &lt;/Group&gt;
+                      &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -149,7 +145,9 @@
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;undoToDateButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;94&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;detailsButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;65&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                           &lt;Component id=&quot;totalResultLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;totalResultValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -256,6 +254,16 @@
                 &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
               &lt;/AuxValues&gt;
             &lt;/Component&gt;
+            &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;detailsButton&quot;&gt;
+              &lt;Properties&gt;
+                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+                  &lt;Connection code=&quot;L10n.getString(&quot;detailsHistory&quot;)&quot; type=&quot;code&quot;/&gt;
+                &lt;/Property&gt;
+              &lt;/Properties&gt;
+              &lt;AuxValues&gt;
+                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+              &lt;/AuxValues&gt;
+            &lt;/Component&gt;
           &lt;/SubComponents&gt;
         &lt;/Container&gt;
       &lt;/SubComponents&gt;

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-04-20 21:40:28 UTC (rev 162)
@@ -9,8 +9,8 @@
 import java.util.Observable;
 import java.util.Observer;
 import javax.swing.DefaultListSelectionModel;
+import javax.swing.JDialog;
 import javax.swing.JOptionPane;
-import javax.swing.JTable;
 import net.sf.plantlore.l10n.L10n;
 
 /**
@@ -29,6 +29,7 @@
         
         super(parent, modal);
         this.model = model;
+        setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
         initComponents();
         this.tableHistoryList.setRowSelectionAllowed(true);
         this.tableHistoryList.setSelectionMode(DefaultListSelectionModel.SINGLE_SELECTION);
@@ -59,6 +60,7 @@
         toDisplayValueTextField = new javax.swing.JTextField();
         nextButton = new javax.swing.JButton();
         previousButton = new javax.swing.JButton();
+        detailsButton = new javax.swing.JButton();
         okButton = new javax.swing.JButton();
         closeButton = new javax.swing.JButton();
         helpButton = new javax.swing.JButton();
@@ -97,6 +99,8 @@
 
         previousButton.setText(L10n.getString(&quot;prevButton&quot;));
 
+        detailsButton.setText(L10n.getString(&quot;detailsHistory&quot;));
+
         org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
         jPanel2.setLayout(jPanel2Layout);
         jPanel2Layout.setHorizontalGroup(
@@ -105,34 +109,34 @@
                 .addContainerGap()
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel2Layout.createSequentialGroup()
+                        .add(totalResultLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(totalResultValueLabel))
+                    .add(jPanel2Layout.createSequentialGroup()
                         .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(undoToDateButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 126, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                            .add(displayedLabel)
+                            .add(toDisplayLabel))
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jPanel2Layout.createSequentialGroup()
-                                .add(totalResultLabel)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(totalResultValueLabel))
-                            .add(jPanel2Layout.createSequentialGroup()
-                                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                                    .add(displayedLabel)
-                                    .add(toDisplayLabel))
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                                    .add(jPanel2Layout.createSequentialGroup()
-                                        .add(10, 10, 10)
-                                        .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 31, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                                    .add(displayedValueLabel))))
-                        .addContainerGap())
-                    .add(jPanel2Layout.createSequentialGroup()
-                        .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, nextButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, previousButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 125, Short.MAX_VALUE))
-                        .addContainerGap(15, Short.MAX_VALUE))))
+                                .add(10, 10, 10)
+                                .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 31, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                            .add(displayedValueLabel)))
+                    .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
+                        .add(org.jdesktop.layout.GroupLayout.LEADING, nextButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                        .add(org.jdesktop.layout.GroupLayout.LEADING, previousButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 125, Short.MAX_VALUE))
+                    .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
+                        .add(org.jdesktop.layout.GroupLayout.LEADING, detailsButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                        .add(org.jdesktop.layout.GroupLayout.LEADING, undoToDateButton, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 126, Short.MAX_VALUE)))
+                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
         );
         jPanel2Layout.setVerticalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel2Layout.createSequentialGroup()
                 .add(undoToDateButton)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 94, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(detailsButton)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 65, Short.MAX_VALUE)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(totalResultLabel)
                     .add(totalResultValueLabel))
@@ -250,6 +254,7 @@
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton closeButton;
+    protected javax.swing.JButton detailsButton;
     private javax.swing.JLabel displayedLabel;
     protected javax.swing.JLabel displayedValueLabel;
     protected javax.swing.JButton helpButton;

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-04-20 19:51:31 UTC (rev 161)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-04-20 21:40:28 UTC (rev 162)
@@ -99,6 +99,7 @@
 unselectAll = Unselect all
 undoSelected = Undo selected
 undoToDate = Undo to Date
+detailsHistory = Details
 #History - information about result and displayed rows
 totalResult = Total results:
 displayed = Displayed rows:


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000166.html">[Plantlore-dev] Dnesna schodzka
</A></li>
	<LI>Next message: <A HREF="000168.html">[Plantlore-dev] r163 - trunk/analysis/database
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#167">[ date ]</a>
              <a href="thread.html#167">[ thread ]</a>
              <a href="subject.html#167">[ subject ]</a>
              <a href="author.html#167">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
