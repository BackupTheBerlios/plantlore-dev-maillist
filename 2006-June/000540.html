<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r433 - in trunk/src/net/sf/plantlore: client/resources common/exception common/record middleware server server/manager
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-June/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r433%20-%20in%20trunk/src/net/sf/plantlore%3A%20client/resources%20common/exception%20common/record%20middleware%20server%20server/manager&In-Reply-To=%3C200606040940.k549em1f004475%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000539.html">
   <LINK REL="Next"  HREF="000541.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r433 - in trunk/src/net/sf/plantlore: client/resources common/exception common/record middleware server server/manager</H1>
    <B>krater at berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r433%20-%20in%20trunk/src/net/sf/plantlore%3A%20client/resources%20common/exception%20common/record%20middleware%20server%20server/manager&In-Reply-To=%3C200606040940.k549em1f004475%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r433 - in trunk/src/net/sf/plantlore: client/resources common/exception common/record middleware server server/manager">krater at berlios.de
       </A><BR>
    <I>Sun Jun  4 11:40:48 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000539.html">[Plantlore-dev] r432 - in trunk/src/net/sf/plantlore: client l10n
</A></li>
        <LI>Next message: <A HREF="000541.html">[Plantlore-dev] r434 - trunk/src/net/sf/plantlore/server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#540">[ date ]</a>
              <a href="thread.html#540">[ thread ]</a>
              <a href="subject.html#540">[ subject ]</a>
              <a href="author.html#540">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: krater
Date: 2006-06-04 11:40:45 +0200 (Sun, 04 Jun 2006)
New Revision: 433

Added:
   trunk/src/net/sf/plantlore/client/resources/Server.KickUser.gif
   trunk/src/net/sf/plantlore/client/resources/Server.Refresh.gif
Modified:
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
   trunk/src/net/sf/plantlore/common/exception/ExportException.java
   trunk/src/net/sf/plantlore/common/exception/ImportException.java
   trunk/src/net/sf/plantlore/common/exception/ParserException.java
   trunk/src/net/sf/plantlore/common/exception/PlantloreException.java
   trunk/src/net/sf/plantlore/common/record/Author.java
   trunk/src/net/sf/plantlore/common/record/AuthorOccurrence.java
   trunk/src/net/sf/plantlore/common/record/Habitat.java
   trunk/src/net/sf/plantlore/common/record/HistoryChange.java
   trunk/src/net/sf/plantlore/common/record/HistoryColumn.java
   trunk/src/net/sf/plantlore/common/record/HistoryRecord.java
   trunk/src/net/sf/plantlore/common/record/LastDataVersion.java
   trunk/src/net/sf/plantlore/common/record/Metadata.java
   trunk/src/net/sf/plantlore/common/record/Occurrence.java
   trunk/src/net/sf/plantlore/common/record/Phytochorion.java
   trunk/src/net/sf/plantlore/common/record/Plant.java
   trunk/src/net/sf/plantlore/common/record/Publication.java
   trunk/src/net/sf/plantlore/common/record/Record.java
   trunk/src/net/sf/plantlore/common/record/Right.java
   trunk/src/net/sf/plantlore/common/record/Territory.java
   trunk/src/net/sf/plantlore/common/record/User.java
   trunk/src/net/sf/plantlore/common/record/Village.java
   trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java
   trunk/src/net/sf/plantlore/server/CertificationException.java
   trunk/src/net/sf/plantlore/server/ConnectionInfo.java
   trunk/src/net/sf/plantlore/server/DatabaseSettings.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
   trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
   trunk/src/net/sf/plantlore/server/RMIServer.java
   trunk/src/net/sf/plantlore/server/RMIServerControl.java
   trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
   trunk/src/net/sf/plantlore/server/SubQueryImplementation.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
   trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
   trunk/src/net/sf/plantlore/server/manager/ServerMng.java
   trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
Log:
SerialVersionUID created for every Serializable class. (In order to ensure that client and server can be compiled with a different version of javac - 1.5.0_04 vs 1.5.0_07 for instance).

Added: trunk/src/net/sf/plantlore/client/resources/Server.KickUser.gif
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/Server.KickUser.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Added: trunk/src/net/sf/plantlore/client/resources/Server.Refresh.gif
===================================================================
(Binary files differ)


Property changes on: trunk/src/net/sf/plantlore/client/resources/Server.Refresh.gif
___________________________________________________________________
Name: svn:mime-type
   + application/octet-stream

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -10,6 +10,9 @@
  *
  */
 public class DBLayerException extends PlantloreException {
+	
+	private static final long serialVersionUID = 2006060411002L;
+	
         /** Error code */
         private int errorCode;
         /** Additional error info */

Modified: trunk/src/net/sf/plantlore/common/exception/ExportException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/ExportException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/exception/ExportException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -14,6 +14,8 @@
  */
 public class ExportException extends PlantloreException {
 	
+	private static final long serialVersionUID = 2006060411004L;
+	
 	public ExportException() { super(); }
 	
 	public ExportException(String message) { super(message); }

Modified: trunk/src/net/sf/plantlore/common/exception/ImportException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/ImportException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/exception/ImportException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -4,6 +4,8 @@
 
 public class ImportException extends PlantloreException {
 	
+	private static final long serialVersionUID = 2006060411008L;
+	
 	private Record problematicRecord;
 
 	public ImportException() { super(); }

Modified: trunk/src/net/sf/plantlore/common/exception/ParserException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/ParserException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/exception/ParserException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -1,6 +1,8 @@
 package net.sf.plantlore.common.exception;
 
 public class ParserException extends PlantloreException {
+	
+	private static final long serialVersionUID = 2006060411016L;
 
 	public ParserException() { super(); }
 	

Modified: trunk/src/net/sf/plantlore/common/exception/PlantloreException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/PlantloreException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/exception/PlantloreException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -12,6 +12,8 @@
  *
  */
 public class PlantloreException extends Exception implements Serializable {
+	
+	private static final long serialVersionUID = 2006060411032L;
 
 	public PlantloreException() { super(); }
 

Modified: trunk/src/net/sf/plantlore/common/record/Author.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Author.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Author.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -18,6 +18,10 @@
  *  @version 0.1, Mar 14, 2006
  */
 public class Author extends Record implements Deletable {
+	
+	private static final long serialVersionUID = 20060604002L;
+	
+	
     /** Parameters of the author. For detailed explanation see data model documentation. */
     private Integer id;
     private String wholeName;

Modified: trunk/src/net/sf/plantlore/common/record/AuthorOccurrence.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/AuthorOccurrence.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/AuthorOccurrence.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class AuthorOccurrence extends Record implements Deletable {
+	
+	private static final long serialVersionUID = 20060604004L;
+	
     /** Parameters of AuthorOccurence */
     private Integer id;
     private Author author;

Modified: trunk/src/net/sf/plantlore/common/record/Habitat.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Habitat.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Habitat.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class Habitat extends Record implements Deletable {   
+	
+	private static final long serialVersionUID = 20060604006L;
+	
     /** Parameters of the Habitat */
     private Integer id;
     private Territory territory;

Modified: trunk/src/net/sf/plantlore/common/record/HistoryChange.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/HistoryChange.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/HistoryChange.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -16,6 +16,8 @@
  *  @author Tomas Kovarik
  */
 public class HistoryChange extends Record {
+	
+	private static final long serialVersionUID = 20060604010L;
 
     // Constants for HistoryChange operations (field COPERATION)
     public static final int HISTORYCHANGE_INSERT = 1;

Modified: trunk/src/net/sf/plantlore/common/record/HistoryColumn.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/HistoryColumn.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/HistoryColumn.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -16,6 +16,9 @@
  *  @author Tomas Kovarik
  */
 public class HistoryColumn extends Record {
+	
+	private static final long serialVersionUID = 20060604008L;
+	
     /** Parameters of the HistoryColumn. For detailed explanation see data model documentation. */
     private Integer id;    
     private String tableName;

Modified: trunk/src/net/sf/plantlore/common/record/HistoryRecord.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/HistoryRecord.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/HistoryRecord.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -10,6 +10,9 @@
  *  @author Tomas Kovarik
  */
 public class HistoryRecord extends Record {
+	
+	private static final long serialVersionUID = 20060604012L;
+	
     /** Parameters of the author. For detailed explanation see data model documentation. */
     private Integer id;
     private HistoryColumn historyColumn;

Modified: trunk/src/net/sf/plantlore/common/record/LastDataVersion.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/LastDataVersion.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/LastDataVersion.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -11,6 +11,8 @@
  *  @author Lada Oberreiterova  
  */
 public class LastDataVersion extends Record {
+	
+	private static final long serialVersionUID = 20060604014L;
 
 	 /**
      * Parameters of the LastDataVersion. For detailed explanation see data model documentation.

Modified: trunk/src/net/sf/plantlore/common/record/Metadata.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Metadata.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Metadata.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class Metadata extends Record {
+	
+	private static final long serialVersionUID = 20060604016L;
+	
     /** Parameters of Metadata */
     private Integer id;
     private String technicalContactName;

Modified: trunk/src/net/sf/plantlore/common/record/Occurrence.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Occurrence.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -24,6 +24,9 @@
  *  @version 0.1, Mar 14, 2006
  */
 public class Occurrence extends Record implements Deletable {
+	
+	private static final long serialVersionUID = 20060604018L;
+	
     /** Parameters of the occurrence. For detailed explanation see data model documentation. */
     private Integer id;
     private String unitIdDb;

Modified: trunk/src/net/sf/plantlore/common/record/Phytochorion.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Phytochorion.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Phytochorion.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class Phytochorion extends Record {
+	
+	private static final long serialVersionUID = 20060604020L;
+	
     /** Parameters of phytochorion */
     private Integer id;
     private String code;

Modified: trunk/src/net/sf/plantlore/common/record/Plant.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Plant.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Plant.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  *  @version 0.1, Mar 15, 2006
  */
 public class Plant extends Record {
+	
+	private static final long serialVersionUID = 20060604022L;
+	
     /** Parameters of the plant */    
     private Integer id;
     private String surveyTaxId;

Modified: trunk/src/net/sf/plantlore/common/record/Publication.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Publication.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Publication.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  *  @version 0.1, Mar 15, 2006
  */
 public class Publication extends Record implements Deletable  {
+	
+	private static final long serialVersionUID = 20060604024L;
+	
     /** Parameters of the publication */    
     private Integer id;
     private String collectionName;

Modified: trunk/src/net/sf/plantlore/common/record/Record.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Record.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Record.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -21,6 +21,9 @@
  */
 public abstract class Record implements Serializable {
 	
+	
+	private static final long serialVersionUID = 20060604000L;
+	
 	/** 
 	 * The list of &quot;basic tables&quot; i.e. tables related directly to the Occurence data.
 	 * The other tables are database specific and are used by our System only

Modified: trunk/src/net/sf/plantlore/common/record/Right.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Right.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Right.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -17,6 +17,9 @@
  * @author Lada Oberreiterova
  */
 public class Right extends Record {
+	
+	private static final long serialVersionUID = 20060604026L;
+	
     /** Parameters of the Right record */
     private Integer id;   
     private int administrator;

Modified: trunk/src/net/sf/plantlore/common/record/Territory.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Territory.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Territory.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class Territory extends Record {
+	
+	private static final long serialVersionUID = 20060604030L;
+	
     /** Parameters of the territory */
     private Integer id;    
     private String name;

Modified: trunk/src/net/sf/plantlore/common/record/User.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/User.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/User.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -14,6 +14,9 @@
  *  @version 0.1, Mar 15, 2006
  */
 public class User extends Record {
+	
+	private static final long serialVersionUID = 20060604032L;
+	
     /** Parameters of the user */
     private Integer id;
     private String login;

Modified: trunk/src/net/sf/plantlore/common/record/Village.java
===================================================================
--- trunk/src/net/sf/plantlore/common/record/Village.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/common/record/Village.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -19,6 +19,9 @@
  * @author Lada Oberreiterova
  */
 public class Village extends Record {
+	
+	private static final long serialVersionUID = 20060604034L;
+	
     /** Parameters of the Village */    
     private Integer id;   
     private String name;

Modified: trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/middleware/RMIDBLayerFactory.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -147,6 +147,23 @@
 		else db.shutdown(); 
 	}
 	
+	
+	/** 
+	 * Initialize the codebase java.rmi.server.property to the specified directory or the
+	 * current working directory if the specified directory is null.
+	 * 
+	 *  @param directory	The directory that shall serve as a codebase. */
+	public static void initialize(String directory) {
+		String codebase = &quot;file:/&quot; + ((directory != null) ? directory : System.getProperty(&quot;user.dir&quot;)) + &quot;/&quot;;
+		codebase = codebase.replaceAll(&quot; &quot;, &quot;%20&quot;); // to prevent the MalformedURLException
+		System.setProperty(&quot;java.rmi.server.codebase&quot;, codebase);
+		System.out.println(&quot;java.rmi.server.codebase = &quot; + codebase);
+	}
+	
+	
+	/** Static initialization. */
+	static {
+		initialize(null);
+	}
 
-
 }

Modified: trunk/src/net/sf/plantlore/server/CertificationException.java
===================================================================
--- trunk/src/net/sf/plantlore/server/CertificationException.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/CertificationException.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -3,6 +3,8 @@
 
 public class CertificationException extends Exception {
 	
+	private static final long serialVersionUID = 2006060411064L;
+	
 	public CertificationException() { super(); }
 	
 	public CertificationException(String msg) { super(msg); }

Modified: trunk/src/net/sf/plantlore/server/ConnectionInfo.java
===================================================================
--- trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/ConnectionInfo.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -20,6 +20,9 @@
  */
 public class ConnectionInfo implements Serializable {
 	
+	
+	private static final long serialVersionUID = 2006060433002L;
+	
 	private RemoteDBLayerFactory remoteFactory = null;
 	private DBLayer database = null;
 	private DBLayer stub = null;

Modified: trunk/src/net/sf/plantlore/server/DatabaseSettings.java
===================================================================
--- trunk/src/net/sf/plantlore/server/DatabaseSettings.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/DatabaseSettings.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -2,6 +2,8 @@
 
 public class DatabaseSettings {
 	
+	private static final long serialVersionUID = 2006060433004L;
+	
 	private String connectionStringPrefix;
 	private String connectionStringSuffix;
 	private String masterUser;

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -56,6 +56,10 @@
  *  @version far from ready!
  */
 public class HibernateDBLayer implements DBLayer, Unreferenced {
+	
+	
+	private static final long serialVersionUID = 2006060433222L;
+	
     /** Instance of a logger */
     private Logger logger;
     /** Configuration file for Hibernate */

Modified: trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/RMIRemoteDBLayerFactory.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -37,6 +37,8 @@
 public class RMIRemoteDBLayerFactory extends UnicastRemoteObject
 	implements RemoteDBLayerFactory {
 	
+	private static final long serialVersionUID = 2006060433002698L;
+	
 	private Logger logger  = Logger.getLogger(this.getClass().getPackage().getName());;
 	
 	private ServerSettings  settings;
@@ -67,8 +69,7 @@
 		Collection&lt;ConnectionInfo&gt; currentlyConnectedClients = clients.values();
 		if(currentlyConnectedClients != null) 
 			return currentlyConnectedClients.toArray(new ConnectionInfo[0]);
-		else 
-			return null;
+		return null;
 	}
 	
 	/**
@@ -112,16 +113,26 @@
 		}
 		
 		// Create a new DBLayer, export it, and keep the stub. Also set the Undertaker of this object.
-		logger.debug(&quot;  Creating a new HibernateDBLayer ...&quot;);
+		logger.debug(&quot;Creating a new HibernateDBLayer ...&quot;);
 		DBLayer database = new HibernateDBLayer( undertaker, settings.getDatabaseSettings() );
-		logger.debug(&quot;   completed!&quot;);
-		DBLayer stub = (DBLayer) UnicastRemoteObject.exportObject(database);
+		logger.debug(&quot;[Success] DBLayer created.&quot;);
 		
+		
+		DBLayer stub = null;
+		try {
+			logger.debug(&quot;Exporting the database layer...&quot;);
+			stub = (DBLayer) UnicastRemoteObject.exportObject(database);
+			logger.debug(&quot;[Success] DBLayer exported.&quot;);
+		} catch(RemoteException e) {
+			logger.error(&quot;[Failure] Unable to export the DBLayer. Is the `codebase` set properly? Are stubs generated properly? &quot; + e.getMessage());
+			throw e;
+		}
+		
 		// Save the information about this connection.
 		ConnectionInfo info = new ConnectionInfo(null, database, stub, clientHost); // remoteFactory is null because of security reasons.
 		clients.put(stub, info);
 		
-		logger.info(&quot;New remote DBLayer created &quot; + info);
+		logger.info(&quot;New remote DBLayer created (&quot; + info + &quot;).&quot;);
 
 		return stub;
 	}
@@ -156,7 +167,8 @@
 	public synchronized void destroy(DBLayer stub) throws RemoteException {
 		if(stub == null) return;
 		ConnectionInfo info = clients.remove(stub);
-		if(info != null) disconnect(info.getDatabase());
+		if(info != null) 
+			disconnect(info.getDatabase());
 		else try {
 			logger.warn(RemoteServer.getClientHost() + &quot; attempts to destroy &quot; +
 						&quot;a database layer that has was not created by this factory OR attempts to destroy an already destroyed DBLayer!&quot;);

Modified: trunk/src/net/sf/plantlore/server/RMIServer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServer.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/RMIServer.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -28,6 +28,8 @@
  */
 public class RMIServer extends UnicastRemoteObject implements Server {
 	
+	private static final long serialVersionUID = 2006060433819775L;
+	
 	/** The default port where the rmiregistry listens. To that rmiregistry the RemoteDBLayerFactory will be bound to. */
 	public static final int DEFAULT_PORT = Registry.REGISTRY_PORT;
 	
@@ -54,8 +56,9 @@
 	
 	/** Get the information about the connected clients. */
 	public synchronized ConnectionInfo[] getClients() {
-		if(remoteFactory == null) return null;
-		else return remoteFactory.getClients(); 
+		if(remoteFactory == null) 
+			return null;
+		return remoteFactory.getClients(); 
 	}
 
 	/**
@@ -67,7 +70,8 @@
 		try { 
 			remoteFactory.destroy(client.getStub()); 
 		} catch(RemoteException e) { 
-			logger.warn(e.getMessage()); 
+			logger.error(&quot;Unable to disconnect the client. &quot; + e.getMessage());
+			e.printStackTrace();
 		}
 	}
 	
@@ -98,7 +102,10 @@
 			
 			logger.info(&quot;The RemoteDBLayerFactory has been bound to the rmiregistry.&quot;);
 		}
-		catch(RemoteException e) { logger.error(e); }
+		catch(RemoteException e) { 
+			logger.error(&quot;Unable to start the server. &quot; + e.getMessage());
+			e.printStackTrace();
+		}
 	}
 	
 	/** 
@@ -135,7 +142,8 @@
 			logger.info(&quot;The Server terminates. Bye.&quot;);
 		}
 		catch(Exception e) { 
-			logger.error(e.getMessage()); 
+			logger.error(&quot;Unable to stop the server. &quot; + e.getMessage());
+			e.printStackTrace();
 		}
 	}
 
@@ -149,7 +157,7 @@
 		String codebase = &quot;file:/&quot; + ((directory != null) ? directory : System.getProperty(&quot;user.dir&quot;)) + &quot;/&quot;;
 		codebase = codebase.replaceAll(&quot; &quot;, &quot;%20&quot;); // to prevent the MalformedURLException
 		System.setProperty(&quot;java.rmi.server.codebase&quot;, codebase);
-		//System.out.println(&quot;java.rmi.server.codebase = &quot; + codebase);
+		System.out.println(&quot;java.rmi.server.codebase = &quot; + codebase);
 		
 		System.setProperty(&quot;java.rmi.dgc.leaseValue&quot;, &quot;30000&quot;); // 30 seconds, just for DEBUG.REASONS
 	}

Modified: trunk/src/net/sf/plantlore/server/RMIServerControl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/RMIServerControl.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -5,6 +5,8 @@
 
 public class RMIServerControl extends UnicastRemoteObject implements Guard {
 	
+	private static final long serialVersionUID = 2006060433140537L;
+	
 	private Server server;
 	private String password;
 

Modified: trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/SelectQueryImplementation.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -44,6 +44,9 @@
  * @author Tom&#225;&#353; Kova&#345;&#237;k, Erik Kratochv&#237;l
  */
 public class SelectQueryImplementation implements SelectQuery {
+	
+	private static final long serialVersionUID = 2006060433450880L;
+	
     // Hibernate criteria used in criteria query
     private Criteria criteria;
     /* List of projections for the query */

Modified: trunk/src/net/sf/plantlore/server/SubQueryImplementation.java
===================================================================
--- trunk/src/net/sf/plantlore/server/SubQueryImplementation.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/SubQueryImplementation.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -37,6 +37,9 @@
  * @author Tomas Kovarik
  */
 public class SubQueryImplementation implements SelectQuery {
+	
+	private static final long serialVersionUID = 2006060433001676L;
+	
     // Hibernate criteria used in criteria query
     private DetachedCriteria criteria;
     /* List of projections for the query */

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateCtrl.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -34,7 +34,7 @@
 		}
 		public void actionPerformed(ActionEvent arg0) {
 			// Take the stored information.
-			ServerSettings settings = model.getSettings();
+			ServerSettings settings = model.getSettings(false);
 			
 			// Gather the information from the dialog. 
 			try {

Modified: trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/manager/ServerCreateView.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -32,7 +32,7 @@
         setLocationRelativeTo(null); // center of the screen
         
         // Initialize the components' contents.
-        ServerSettings settings = model.getSettings();
+        ServerSettings settings = model.getSettings(true);
         if(settings != null) {
         	// Server
         	serverPort.setText( new Integer(settings.getPort()).toString() );
@@ -44,6 +44,8 @@
         	databasePassword.setText( settings.getDatabaseSettings().getMasterPassword() );
         	databaseParameter.setText( settings.getDatabaseSettings().getConnectionStringSuffix() );
         }
+        
+        setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
     }
     
     /** This method is called from within the constructor to

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMng.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMng.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -72,7 +72,10 @@
 	}
 	
 	
-	public ServerSettings getSettings() {
+	public ServerSettings getSettings(boolean refresh) {
+		
+		if( !refresh )
+			return settings;
 
 		// Create some default settings.
 		settings = new ServerSettings(RMIServer.DEFAULT_PORT, 3, 32, 2, 
@@ -84,7 +87,7 @@
 			SAXReader saxReader = new SAXReader();
             Document document = saxReader.read( reader );
             
-            Node server = (Node)document.selectSingleNode(&quot;/config/server&quot;);
+            Node server = document.selectSingleNode(&quot;/config/server&quot;);
             Number portNumber = server.numberValueOf(&quot;port&quot;)/*,
             connectionsNumber = server.numberValueOf(&quot;connections&quot;),
             peripNumber = server.numberValueOf(&quot;perip&quot;)*/;
@@ -92,16 +95,17 @@
             connections = (connectionsNumber == null) ? 16 : connectionsNumber.intValue(),
             perip = (peripNumber == null) ? 2 : peripNumber.intValue()*/;
             
-            Node database = (Node)server.selectSingleNode(&quot;database&quot;);
+            Node database = server.selectSingleNode(&quot;database&quot;);
             
             String databaseType = database.valueOf(&quot;engine&quot;),
             databaseParameter = database.valueOf(&quot;parameter&quot;),
-            databaseMasterUser = database.valueOf(&quot;masteruser&quot;);
+            databaseMasterUser = database.valueOf(&quot;masteruser&quot;),
+            databaseMasterPassword = database.valueOf(&quot;masterpassword&quot;);
             Number databasePortNumber = database.numberValueOf(&quot;port&quot;);
             int databasePort = (databasePortNumber == null) ? 0 : databasePortNumber.intValue();
             
             settings = new ServerSettings(port, 3, 32, 2, 
-            		new DatabaseSettings(databaseType, databasePort, databaseParameter, databaseMasterUser, &quot;&quot;));
+            		new DatabaseSettings(databaseType, databasePort, databaseParameter, databaseMasterUser, databaseMasterPassword));
             
     		setChanged();
     		notifyObservers(L10n.getString(&quot;Server.SettingsLoaded&quot;));

Modified: trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-06-03 22:33:40 UTC (rev 432)
+++ trunk/src/net/sf/plantlore/server/manager/ServerMngCtrl.java	2006-06-04 09:40:45 UTC (rev 433)
@@ -18,8 +18,8 @@
 	
 	private ServerMngView view;
 	private ServerMng model;
+	private boolean terminated = false;
 	
-	
 	public ServerMngCtrl(ServerMng model, ServerMngView view) {
 		this.model = model; this. view = view;
 		
@@ -55,10 +55,15 @@
 		}
 		public void actionPerformed(ActionEvent ae) {
 			model.terminateServer();
-			// Disable Terminate, Refresh and Kick buttons.
-			view.terminate.setEnabled(false);
-			view.refresh.setEnabled(false);
-			view.kick.setEnabled(false);
+			java.awt.EventQueue.invokeLater(new Runnable() {
+				public void run() {
+					// Disable Terminate, Refresh and Kick buttons.
+					view.terminate.setEnabled(false);
+					view.refresh.setEnabled(false);
+					view.kick.setEnabled(false);
+					terminated = true;
+				}
+			});
 		}
 	}
 	
@@ -82,8 +87,14 @@
 			if(icon != null) putValue(SMALL_ICON, icon);
 		}
 		public void actionPerformed(ActionEvent ae) {
-			view.setVisible(false);
-			//view.dispose();
+			java.awt.EventQueue.invokeLater(new Runnable() {
+				public void run() {
+					view.setVisible(false);
+					view.dispose();
+					if(terminated)
+						System.exit(0);
+				}
+			});
 		}
 	}
 


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000539.html">[Plantlore-dev] r432 - in trunk/src/net/sf/plantlore: client l10n
</A></li>
	<LI>Next message: <A HREF="000541.html">[Plantlore-dev] r434 - trunk/src/net/sf/plantlore/server
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#540">[ date ]</a>
              <a href="thread.html#540">[ thread ]</a>
              <a href="subject.html#540">[ subject ]</a>
              <a href="author.html#540">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
