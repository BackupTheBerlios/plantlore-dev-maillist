<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r760 - in trunk/src/net/sf/plantlore: client	client/authors client/createdb client/publications	common/exception l10n middleware server
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-September/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r760%20-%20in%20trunk/src/net/sf/plantlore%3A%20client%0A%09client/authors%20client/createdb%20client/publications%0A%09common/exception%20l10n%20middleware%20server&In-Reply-To=%3C200609071031.k87AVJmL014454%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="001038.html">
   <LINK REL="Next"  HREF="001040.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r760 - in trunk/src/net/sf/plantlore: client	client/authors client/createdb client/publications	common/exception l10n middleware server</H1>
    <B>kovo at mail.berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r760%20-%20in%20trunk/src/net/sf/plantlore%3A%20client%0A%09client/authors%20client/createdb%20client/publications%0A%09common/exception%20l10n%20middleware%20server&In-Reply-To=%3C200609071031.k87AVJmL014454%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r760 - in trunk/src/net/sf/plantlore: client	client/authors client/createdb client/publications	common/exception l10n middleware server">kovo at mail.berlios.de
       </A><BR>
    <I>Thu Sep  7 12:31:19 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="001038.html">[Plantlore-dev] r759 - trunk/documentation
</A></li>
        <LI>Next message: <A HREF="001040.html">[Plantlore-dev] r761 - trunk/documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1039">[ date ]</a>
              <a href="thread.html#1039">[ thread ]</a>
              <a href="subject.html#1039">[ subject ]</a>
              <a href="author.html#1039">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: kovo
Date: 2006-09-07 12:31:12 +0200 (Thu, 07 Sep 2006)
New Revision: 760

Modified:
   trunk/src/net/sf/plantlore/client/AppCoreView.form
   trunk/src/net/sf/plantlore/client/AppCoreView.java
   trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form
   trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form
   trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
   trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
   trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
   trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
   trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
   trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
   trunk/src/net/sf/plantlore/l10n/Plantlore.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
   trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
   trunk/src/net/sf/plantlore/middleware/DBLayer.java
   trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
Log:
Updates of PublicationManager, AuthorManager, CreateDb - L10n fixed, leaking connections fixed.
DBLayer - just added javadoc

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -238,6 +238,9 @@
   &lt;/NonVisualComponents&gt;
   &lt;Properties&gt;
     &lt;Property name=&quot;defaultCloseOperation&quot; type=&quot;int&quot; value=&quot;3&quot;/&gt;
+    &lt;Property name=&quot;title&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+      &lt;Connection code=&quot;L10n.getString(&quot;Plantlore.Title&quot;)&quot; type=&quot;code&quot;/&gt;
+    &lt;/Property&gt;
   &lt;/Properties&gt;
   &lt;SyntheticProperties&gt;
     &lt;SyntheticProperty name=&quot;menuBar&quot; type=&quot;java.lang.String&quot; value=&quot;jMenuBar1&quot;/&gt;
@@ -378,7 +381,7 @@
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;statusLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;EmptySpace pref=&quot;404&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace pref=&quot;424&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;progressBar&quot; min=&quot;-2&quot; pref=&quot;314&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
@@ -453,7 +456,7 @@
                       &lt;Component id=&quot;recordsPerPage&quot; min=&quot;-2&quot; pref=&quot;45&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;nextPage&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;352&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;371&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
             &lt;/DimensionLayout&gt;
@@ -537,7 +540,7 @@
         &lt;/DimensionLayout&gt;
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Component id=&quot;overviewScrollPane&quot; alignment=&quot;0&quot; pref=&quot;223&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;overviewScrollPane&quot; alignment=&quot;0&quot; pref=&quot;188&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
       &lt;/Layout&gt;
@@ -575,7 +578,7 @@
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace pref=&quot;673&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace pref=&quot;704&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;recordsCountLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;recordsCount&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;

Modified: trunk/src/net/sf/plantlore/client/AppCoreView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/AppCoreView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -142,6 +142,7 @@
         helpAbout = new javax.swing.JMenuItem();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.EXIT_ON_CLOSE);
+        setTitle(L10n.getString(&quot;Plantlore.Title&quot;));
         mainToolBar.setFloatable(false);
         mainToolBar.setRollover(true);
         addButton.setIcon(new javax.swing.ImageIcon(getClass().getResource(&quot;/toolbarButtonGraphics/general/Add24.gif&quot;)));
@@ -178,7 +179,7 @@
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
                 .add(statusLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 404, Short.MAX_VALUE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 424, Short.MAX_VALUE)
                 .add(progressBar, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 314, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
         );
         jPanel1Layout.setVerticalGroup(
@@ -224,7 +225,7 @@
                 .add(recordsPerPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 45, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(nextPage, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addContainerGap(352, Short.MAX_VALUE))
+                .addContainerGap(371, Short.MAX_VALUE))
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -265,7 +266,7 @@
         );
         overviewPanelLayout.setVerticalGroup(
             overviewPanelLayout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 295, Short.MAX_VALUE)
+            .add(overviewScrollPane, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 188, Short.MAX_VALUE)
         );
 
         recordsCount.setText(&quot;-&quot;);
@@ -281,7 +282,7 @@
         jPanel4Layout.setHorizontalGroup(
             jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel4Layout.createSequentialGroup()
-                .addContainerGap(673, Short.MAX_VALUE)
+                .addContainerGap(704, Short.MAX_VALUE)
                 .add(recordsCountLabel)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(recordsCount)

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -8,6 +8,7 @@
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.Dispatcher;
 import net.sf.plantlore.common.PlantloreHelp;
@@ -43,10 +44,12 @@
      *  @param addView View for adding authors in Author manager
      */
     public AddAuthorCtrl(AuthorManager addModel, AddAuthorView addView) {
-        logger = Logger.getLogger(this.getClass().getPackage().getName());        
+        logger = Logger.getLogger(this.getClass().getPackage().getName());                
         // Save instance of view and model
         this.model = addModel;
         this.view = addView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);        
         // Add listeners for buttons and fields
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.saveBtnAddActionListener(new SaveAuthorButtonListener());        

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -22,13 +22,12 @@
           &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;37&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;101&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;saveBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;13&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;40&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;saveBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;9&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
@@ -54,13 +53,10 @@
                           &lt;Component id=&quot;emailField&quot; alignment=&quot;0&quot; pref=&quot;279&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;urlField&quot; alignment=&quot;0&quot; pref=&quot;279&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;jLabel9&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;293&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
+                  &lt;Component id=&quot;jLabel9&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -112,8 +108,8 @@
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;helpBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Component id=&quot;closeBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; pref=&quot;23&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;saveBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;closeBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; pref=&quot;23&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;

Modified: trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AddAuthorView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -132,14 +132,13 @@
             .add(layout.createSequentialGroup()
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 37, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 101, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(saveBtn)
-                        .add(13, 13, 13))
                     .add(layout.createSequentialGroup()
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(40, 40, 40)
+                        .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 9, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(layout.createSequentialGroup()
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
                                 .add(jLabel5, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
@@ -159,11 +158,9 @@
                             .add(org.jdesktop.layout.GroupLayout.TRAILING, organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
                             .add(phoneField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
                             .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)
-                            .add(urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE))
-                        .addContainerGap())
-                    .add(layout.createSequentialGroup()
-                        .add(jLabel9)
-                        .addContainerGap(293, Short.MAX_VALUE))))
+                            .add(urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 279, Short.MAX_VALUE)))
+                    .add(jLabel9))
+                .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -205,8 +202,8 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(helpBtn)
-                    .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(saveBtn))
+                    .add(saveBtn)
+                    .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 23, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManager.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -81,8 +81,9 @@
     private Author editAuthor;
     /** Enum used for notifying AppCore to reload cached publications */
     private PlantloreConstants.Table[] editTypeArray = new PlantloreConstants.Table[]{PlantloreConstants.Table.AUTHOR};
+    /** Currently running query */
+    private SelectQuery activeSelectQuery = null;    
     
-    
     /** Constants used for identification of fields for sorting */
     public static final int SORT_NAME = 1;
     public static final int SORT_ORGANIZATION = 2;
@@ -139,7 +140,7 @@
                 clearDataHolders();                
                 // Execute query
                 author = (Author)database.executeInsert(author);
-                logger.info(&quot;Author &quot;+name+&quot; saved successfuly.&quot;);                
+                logger.info(&quot;Author &quot;+author.getWholeName()+&quot; saved successfuly.&quot;);                
                 // Set operation state to finished
                 done = true;
                 // Stop the Task
@@ -308,10 +309,36 @@
         int resultId = 0;
         // Execute query
         resultId = database.executeQuery(query);
+        if (this.activeSelectQuery != null) {
+            database.closeQuery(this.activeSelectQuery);
+        }
+        // Save the query as the active search query        
+        this.activeSelectQuery = query;        
         return resultId;
     }
      
     /**
+     *  Close active SelectQuery (if there is one)
+     */
+    public void closeActiveQuery()  {
+        if (this.activeSelectQuery != null) {
+            try {
+                database.closeQuery(this.activeSelectQuery);
+            } catch (RemoteException ex) {
+                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            }            
+            this.activeSelectQuery = null;
+        }
+    }
+    
+    
+    /**
      *  Clear the variables with author properties
      */
     private void clearDataHolders() {

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -38,6 +38,8 @@
         // Save model and view
         this.model = authModel;
         this.view = authView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);                
         // Add action listeners to buttons
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.addBtnAddActionListener(new AddAuthorButtonListener());
@@ -112,7 +114,7 @@
             AddAuthorCtrl addAuthCtrl = new AddAuthorCtrl(model, addAuthView);            
             // We are going to add author, no editing
             model.setEditAuthor(null);
-            addAuthView.setSize(400,450);        
+//            addAuthView.setSize(400,450);        
             addAuthView.setLocationRelativeTo(null);
             logger.info(&quot;Add Author dialog opened for adding new author&quot;);            
             addAuthView.setVisible(true);
@@ -147,7 +149,7 @@
             model.setEditAuthor(model.getSelectedAuthor(index));            
             model.setAuthorIndex(index);
             model.loadAuthor();
-            addAuthView.setSize(400,450);        
+//            addAuthView.setSize(400,450);        
             addAuthView.setLocationRelativeTo(null);
             logger.info(&quot;Add Author dialog opened for editing author&quot;);
             addAuthView.setVisible(true);            

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,9 +31,9 @@
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;jPanel7&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;542&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;113&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;617&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Component id=&quot;jPanel8&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
               &lt;/Group&gt;
@@ -75,9 +75,9 @@
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;jScrollPane3&quot; alignment=&quot;0&quot; pref=&quot;724&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jScrollPane3&quot; alignment=&quot;0&quot; pref=&quot;825&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;previousBtn&quot; min=&quot;-2&quot; pref=&quot;107&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;previousBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;totalResultLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -91,19 +91,19 @@
                                   &lt;EmptySpace min=&quot;-2&quot; pref=&quot;89&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                   &lt;Component id=&quot;displayedLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;Component id=&quot;displayedLabel&quot; pref=&quot;62&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;displayedLabel&quot; pref=&quot;139&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                               &lt;/Group&gt;
                               &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Component id=&quot;addBtn&quot; min=&quot;-2&quot; pref=&quot;107&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                                  &lt;Component id=&quot;addBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;Component id=&quot;editBtn&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                                  &lt;Component id=&quot;editBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                                   &lt;EmptySpace min=&quot;-2&quot; pref=&quot;2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                               &lt;/Group&gt;
                           &lt;/Group&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;nextBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                              &lt;Component id=&quot;deleteBtn&quot; min=&quot;-2&quot; pref=&quot;109&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;deleteBtn&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                              &lt;Component id=&quot;nextBtn&quot; alignment=&quot;1&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                           &lt;/Group&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
@@ -140,18 +140,18 @@
       &lt;/Layout&gt;
       &lt;SubComponents&gt;
         &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane3&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;background&quot; type=&quot;java.awt.Color&quot; editor=&quot;org.netbeans.beaninfo.editors.ColorEditor&quot;&gt;
+              &lt;Color blue=&quot;ff&quot; green=&quot;ff&quot; id=&quot;white&quot; palette=&quot;1&quot; red=&quot;ff&quot; type=&quot;palette&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
 
           &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
           &lt;SubComponents&gt;
             &lt;Component class=&quot;javax.swing.JTable&quot; name=&quot;listTable&quot;&gt;
               &lt;Properties&gt;
                 &lt;Property name=&quot;model&quot; type=&quot;javax.swing.table.TableModel&quot; editor=&quot;org.netbeans.modules.form.editors2.TableModelEditor&quot;&gt;
-                  &lt;Table columnCount=&quot;4&quot; rowCount=&quot;4&quot;&gt;
-                    &lt;Column editable=&quot;true&quot; title=&quot;Title 1&quot; type=&quot;java.lang.Object&quot;/&gt;
-                    &lt;Column editable=&quot;true&quot; title=&quot;Title 2&quot; type=&quot;java.lang.Object&quot;/&gt;
-                    &lt;Column editable=&quot;true&quot; title=&quot;Title 3&quot; type=&quot;java.lang.Object&quot;/&gt;
-                    &lt;Column editable=&quot;true&quot; title=&quot;Title 4&quot; type=&quot;java.lang.Object&quot;/&gt;
-                  &lt;/Table&gt;
+                  &lt;Table columnCount=&quot;0&quot; rowCount=&quot;0&quot;/&gt;
                 &lt;/Property&gt;
               &lt;/Properties&gt;
               &lt;AuxValues&gt;
@@ -277,8 +277,8 @@
                           &lt;/Group&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;organizationField&quot; pref=&quot;160&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
-                              &lt;Component id=&quot;nameField&quot; alignment=&quot;0&quot; pref=&quot;160&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;organizationField&quot; pref=&quot;211&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;nameField&quot; alignment=&quot;0&quot; pref=&quot;211&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
                           &lt;/Group&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
@@ -287,11 +287,11 @@
                           &lt;/Group&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;emailField&quot; pref=&quot;161&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
-                              &lt;Component id=&quot;roleField&quot; alignment=&quot;0&quot; pref=&quot;161&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;emailField&quot; pref=&quot;211&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;roleField&quot; alignment=&quot;0&quot; pref=&quot;211&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
                           &lt;/Group&gt;
                       &lt;/Group&gt;
-                      &lt;Component id=&quot;searchBtn&quot; min=&quot;-2&quot; pref=&quot;144&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;Component id=&quot;searchBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;jPanel9&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;

Modified: trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/authors/AuthorManagerView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -45,6 +45,7 @@
         this.model = model;
         this.model.addObserver(this);         
         initComponents();
+        jScrollPane3.getViewport().setBackground(java.awt.Color.white);
         PlantloreHelp.addKeyHelp(PlantloreHelp.AUTHOR_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.AUTHOR_MANAGER, this.helpBtn);
         // Center the dialog on the screen
@@ -97,15 +98,13 @@
 
         setTitle(L10n.getString(&quot;authorManager&quot;));
         jPanel7.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;Author.list&quot;)));
+        jScrollPane3.setBackground(java.awt.Color.white);
         listTable.setModel(new javax.swing.table.DefaultTableModel(
             new Object [][] {
-                {null, null, null, null},
-                {null, null, null, null},
-                {null, null, null, null},
-                {null, null, null, null}
+
             },
             new String [] {
-                &quot;Title 1&quot;, &quot;Title 2&quot;, &quot;Title 3&quot;, &quot;Title 4&quot;
+
             }
         ));
         jScrollPane3.setViewportView(listTable);
@@ -139,9 +138,9 @@
             .add(jPanel7Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 724, Short.MAX_VALUE)
+                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 825, Short.MAX_VALUE)
                     .add(jPanel7Layout.createSequentialGroup()
-                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(totalResultLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -155,16 +154,16 @@
                                 .add(89, 89, 89)
                                 .add(displayedLabel2)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 62, Short.MAX_VALUE))
+                                .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 139, Short.MAX_VALUE))
                             .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel7Layout.createSequentialGroup()
-                                .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                                 .add(2, 2, 2)))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(nextBtn)
-                            .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 109, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
+                        .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING, false)
+                            .add(deleteBtn, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                            .add(nextBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))))
                 .addContainerGap())
         );
         jPanel7Layout.setVerticalGroup(
@@ -263,17 +262,17 @@
                             .add(jLabel12))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 160, Short.MAX_VALUE)
-                            .add(nameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 160, Short.MAX_VALUE))
+                            .add(organizationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)
+                            .add(nameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                             .add(jLabel14)
                             .add(jLabel15))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)
-                            .add(roleField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 161, Short.MAX_VALUE)))
-                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 144, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                            .add(emailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)
+                            .add(roleField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 211, Short.MAX_VALUE)))
+                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel9, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap())
@@ -314,9 +313,9 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 542, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 113, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 617, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
@@ -498,6 +497,7 @@
      *  Close this dialog.
      */    
     public void close() {
+        model.closeActiveQuery();        
         this.dispose();
     }
 

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDB.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDB.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -193,26 +193,7 @@
                     // Disconnect - destroy DBLayer
                     factory.destroy(currentDBLayer);
                     logger.debug(&quot;Disconnected from the database &quot;+dbinfo.getDatabaseIdentifier());
-                    
-                            /*
-                             * TODO:
-                             *
-                             * HERE GOES YOUR CODE THAT PERFORMS
-                             * 1. THE CONNECTION TO THE DATABASE ENGINE
-                             *    You should use inormation stored in dbinfo and the stored name and password.
-                             *    See HibernateDBLayer.initialize().
-                             * 2. THE CREATION OF THE NEW DATABASE
-                             *    Here it is up to you, I have no idea what should be done here.
-                             *    Creation of all tables and roles + user admin with some default password +
-                             *    neccessary columns (history).
-                             * 3. PRE-FILLING THE DATABASE WITH SOME VALUES
-                             *    Polluting the database with all villages, plants, territories, and phytochoria.
-                             *    This may be optional - only if leaveEmpty is true.
-                             *
-                             * Everything you want do, do it here in the CreationTask!
-                             *
-                             */
-                    
+                                                
                     // Everything went fine.
                     addDBInfoPermanently( dbinfo );
                     logger.info(&quot;The creation of a new database was successful.&quot;);

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -32,13 +32,17 @@
 
 				Task creation = model.createCreationTask(user, new String(view.password.getPassword()));
                                 Dispatcher.getDispatcher().dispatch(creation, view, false);
-                                /*
-				new DefaultProgressBar(creation, view, true);
-				creation.start(); */
 				
 				view.password.setText(&quot;&quot;);
 			}
 		});
+                /*
+		JOptionPane.showMessageDialog(
+                    view, 
+                    L10n.getString(&quot;Error.BadDatabaseIdentifier&quot;), 
+                    L10n.getString(&quot;Error.BadDatabaseIdentifierTitle&quot;), 
+                    JOptionPane.ERROR_MESSAGE);                   
+                 */
 	}
 
 }

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -1,6 +1,11 @@
 &lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot; ?&gt;
 
 &lt;Form version=&quot;1.3&quot; type=&quot;org.netbeans.modules.form.forminfo.JDialogFormInfo&quot;&gt;
+  &lt;Properties&gt;
+    &lt;Property name=&quot;title&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+      &lt;Connection code=&quot;L10n.getString(&quot;Login.Authentication&quot;)&quot; type=&quot;code&quot;/&gt;
+    &lt;/Property&gt;
+  &lt;/Properties&gt;
   &lt;SyntheticProperties&gt;
     &lt;SyntheticProperty name=&quot;formSizePolicy&quot; type=&quot;int&quot; value=&quot;1&quot;/&gt;
   &lt;/SyntheticProperties&gt;

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBAuthView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,7 +31,7 @@
         PlantloreHelp.addButtonHelp(PlantloreHelp.CREATE_DB, this.help);
         */
         new DefaultEscapeKeyPressed( this );
-        
+
         DocumentSizeFilter.patch(password, 20);
     }
 
@@ -50,6 +50,7 @@
         user = new javax.swing.JTextField();
         cancel = new javax.swing.JButton();
 
+        setTitle(L10n.getString(&quot;Login.Authentication&quot;));
         jLabel1.setText(L10n.getString(&quot;Login.UserName&quot;));
 
         jLabel2.setText(L10n.getString(&quot;Login.Password&quot;));

Modified: trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/createdb/CreateDBCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -43,6 +43,14 @@
 					engine = ((javax.swing.JTextField)view.databaseEngine.getEditor().getEditorComponent()).getText(),
 					identifier = view.databaseIdentifier.getText(),
 					alias = view.databaseAlias.getText();
+                                if (!identifier.matches(&quot;[A-Za-z0-9][A-Za-z0-9]*&quot;)) {
+					JOptionPane.showMessageDialog(
+    						view, 
+    						L10n.getString(&quot;Error.BadDatabaseIdentifier&quot;), 
+    						L10n.getString(&quot;Error.BadDatabaseIdentifierTitle&quot;), 
+    						JOptionPane.ERROR_MESSAGE);   
+                                        return;
+                                }
 				int port = -1;
 				try { 
 					port = Integer.parseInt(view.databasePort.getText());
@@ -63,8 +71,8 @@
 			}
 		});
 	}
-        
-    /**
+       
+   /**
      *  Focus listener for the &lt;strong&gt;DatabaseEngine combobox&lt;/strong&gt;. After losing focus
      *  automaticaly loads default port for the given database.
      */

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -8,6 +8,7 @@
 import java.beans.PropertyChangeEvent;
 import java.beans.PropertyChangeListener;
 import java.rmi.RemoteException;
+import net.sf.plantlore.common.DefaultEscapeKeyPressed;
 import net.sf.plantlore.common.DefaultExceptionHandler;
 import net.sf.plantlore.common.DefaultProgressBar;
 import net.sf.plantlore.common.Dispatcher;
@@ -42,6 +43,8 @@
         // Save instance of view and model
         this.model = addModel;
         this.view = addView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);                
         // Add listeners for buttons and fields
         view.closeBtnAddActionListener(new CloseButtonListener());
         view.saveBtnAddActionListener(new SavePublicationButtonListener());        

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -43,22 +43,27 @@
                       &lt;/Group&gt;
                       &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;journalAuthorField&quot; alignment=&quot;0&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;collectionNameField&quot; alignment=&quot;1&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;publicationYearField&quot; alignment=&quot;1&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;journalNameField&quot; alignment=&quot;1&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;urlField&quot; alignment=&quot;0&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;referenceDetailField&quot; alignment=&quot;0&quot; pref=&quot;290&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;journalAuthorField&quot; alignment=&quot;0&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;collectionNameField&quot; alignment=&quot;1&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;publicationYearField&quot; alignment=&quot;1&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;journalNameField&quot; alignment=&quot;1&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;urlField&quot; alignment=&quot;0&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;referenceDetailField&quot; alignment=&quot;0&quot; pref=&quot;264&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
-                  &lt;Component id=&quot;jLabel9&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;58&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;101&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                          &lt;Component id=&quot;jLabel9&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                              &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;EmptySpace pref=&quot;38&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;saveBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                              &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;/Group&gt;
+                      &lt;/Group&gt;
                       &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;saveBtn&quot; min=&quot;-2&quot; pref=&quot;104&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
               &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -106,15 +111,15 @@
                       &lt;Component id=&quot;jLabel9&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;72&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;16&quot; pref=&quot;16&quot; max=&quot;16&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jScrollPane2&quot; pref=&quot;59&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;29&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
               &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;helpBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;closeBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;saveBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Component id=&quot;helpBtn&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
               &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;

Modified: trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/AddPublicationView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -152,20 +152,23 @@
                             .add(jLabel8))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, journalAuthorField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(publicationYearField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)
-                            .add(org.jdesktop.layout.GroupLayout.LEADING, referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 290, Short.MAX_VALUE)))
-                    .add(jLabel9)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 58, Short.MAX_VALUE)
-                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 101, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 104, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, journalAuthorField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(collectionNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(publicationYearField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(journalNameField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, urlField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 264, Short.MAX_VALUE)))
+                    .add(layout.createSequentialGroup()
+                        .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                            .add(jLabel9)
+                            .add(layout.createSequentialGroup()
+                                .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 38, Short.MAX_VALUE)
+                                .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                                .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
@@ -202,13 +205,13 @@
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 60, Short.MAX_VALUE)
                         .add(jLabel9))
                     .add(layout.createSequentialGroup()
-                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 72, Short.MAX_VALUE)
-                        .add(16, 16, 16)))
+                        .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 59, Short.MAX_VALUE)
+                        .add(29, 29, 29)))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                     .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(saveBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addContainerGap())
         );
         pack();

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManager.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManager.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -556,13 +556,20 @@
     
     /**
      *  Close active SelectQuery (if there is one)
-     *
-     *  @throws DBLayerException    In case database operation failed
-     *  @throws RemoteException     In case network operation failed
      */
-    public void closeActiveQuery() throws DBLayerException, RemoteException {
+    public void closeActiveQuery()  {
         if (this.activeSelectQuery != null) {
-            database.closeQuery(this.activeSelectQuery);
+            try {
+                database.closeQuery(this.activeSelectQuery);
+            } catch (RemoteException ex) {
+                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            } catch (DBLayerException ex) {
+                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
+                ex.printStackTrace();
+                return;                    
+            }            
             this.activeSelectQuery = null;
         }
     }

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerCtrl.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -40,6 +40,8 @@
         // Save model and view
         this.model = publModel;
         this.view = publView;
+        // Add escape key event - close dialog
+        DefaultEscapeKeyPressed escapeKeyPressed = new DefaultEscapeKeyPressed(view);        
         // Add action listeners to buttons
         view.addPublicationWindowListener(new PublicationWindowListener());        
         view.closeBtnAddActionListener(new CloseButtonListener());
@@ -112,19 +114,8 @@
     class PublicationWindowListener extends WindowAdapter {
         public void windowClosed(WindowEvent e) {
             // Close database connection
-            try {
-                model.closeActiveQuery();
-            } catch (RemoteException ex) {
-                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
-                ex.printStackTrace();
-                DefaultExceptionHandler.handle(view, ex);
-                return;                    
-            } catch (DBLayerException ex) {
-                logger.error(&quot;RemoteException caught while closing select query. Details: &quot;+ex.getMessage());
-                ex.printStackTrace();
-                DefaultExceptionHandler.handle(view, ex);
-                return;                    
-            }
+            System.out.println(&quot;closing window and query&quot;);
+            model.closeActiveQuery();
         }
     }
 

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.form	2006-09-07 10:31:12 UTC (rev 760)
@@ -31,9 +31,9 @@
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;jPanel7&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;1&quot;&gt;
-                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;585&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;helpBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;548&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Component id=&quot;jPanel8&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
               &lt;/Group&gt;
@@ -75,9 +75,9 @@
               &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
                   &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;jScrollPane3&quot; alignment=&quot;0&quot; pref=&quot;755&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;jScrollPane3&quot; alignment=&quot;0&quot; pref=&quot;756&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;previousBtn&quot; min=&quot;-2&quot; pref=&quot;107&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;previousBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;totalResultLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -89,17 +89,17 @@
                           &lt;EmptySpace min=&quot;-2&quot; pref=&quot;89&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Component id=&quot;displayedLabel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;displayedLabel&quot; pref=&quot;97&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;displayedLabel&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;nextBtn&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;nextBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                       &lt;/Group&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;addBtn&quot; min=&quot;-2&quot; pref=&quot;111&quot; max=&quot;-2&quot; attributes=&quot;3&quot;/&gt;
+                          &lt;Component id=&quot;addBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;3&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;editBtn&quot; min=&quot;-2&quot; pref=&quot;113&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;editBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;deleteBtn&quot; min=&quot;-2&quot; pref=&quot;136&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;deleteBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                       &lt;/Group&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -284,11 +284,11 @@
                           &lt;/Group&gt;
                           &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;referenceDetailField&quot; pref=&quot;183&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
-                              &lt;Component id=&quot;referenceCitationField&quot; alignment=&quot;0&quot; pref=&quot;183&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;referenceDetailField&quot; pref=&quot;184&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
+                              &lt;Component id=&quot;referenceCitationField&quot; alignment=&quot;0&quot; pref=&quot;184&quot; max=&quot;32767&quot; attributes=&quot;2&quot;/&gt;
                           &lt;/Group&gt;
                       &lt;/Group&gt;
-                      &lt;Component id=&quot;searchBtn&quot; min=&quot;-2&quot; pref=&quot;149&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                      &lt;Component id=&quot;searchBtn&quot; min=&quot;-2&quot; pref=&quot;120&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;jPanel9&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;

Modified: trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/client/publications/PublicationManagerView.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -55,6 +55,7 @@
         this.model = model;
         this.model.addObserver(this);
         initComponents();
+        jScrollPane3.getViewport().setBackground(java.awt.Color.white);        
         // Initialize help
         PlantloreHelp.addKeyHelp(PlantloreHelp.PUBLICATION_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.PUBLICATION_MANAGER, this.helpBtn);        
@@ -151,9 +152,9 @@
             .add(jPanel7Layout.createSequentialGroup()
                 .addContainerGap()
                 .add(jPanel7Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 755, Short.MAX_VALUE)
+                    .add(jScrollPane3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 756, Short.MAX_VALUE)
                     .add(jPanel7Layout.createSequentialGroup()
-                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 107, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(previousBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(totalResultLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
@@ -165,16 +166,16 @@
                         .add(89, 89, 89)
                         .add(displayedLabel2)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 97, Short.MAX_VALUE)
+                        .add(displayedLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(nextBtn))
+                        .add(nextBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel7Layout.createSequentialGroup()
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 111, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(addBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 113, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(editBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 136, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
+                        .add(deleteBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         jPanel7Layout.setVerticalGroup(
@@ -284,9 +285,9 @@
                             .add(jLabel15))
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                         .add(jPanel8Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)
-                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 183, Short.MAX_VALUE)))
-                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 149, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                            .add(referenceDetailField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 184, Short.MAX_VALUE)
+                            .add(referenceCitationField, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 184, Short.MAX_VALUE)))
+                    .add(searchBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel9, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addContainerGap())
@@ -327,9 +328,9 @@
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
                     .add(jPanel7, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(layout.createSequentialGroup()
-                        .add(helpBtn)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 585, Short.MAX_VALUE)
-                        .add(closeBtn))
+                        .add(helpBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 548, Short.MAX_VALUE)
+                        .add(closeBtn, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 120, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(jPanel8, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
                 .addContainerGap())
         );
@@ -520,6 +521,7 @@
      *  Close this dialog.
      */    
     public void close() {
+        model.closeActiveQuery();
         this.dispose();
     }
 

Modified: trunk/src/net/sf/plantlore/common/exception/DBLayerException.java
===================================================================
--- trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/common/exception/DBLayerException.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -205,8 +205,6 @@
             String errorClass = sqlstate.substring(0,2);
             String errorDetail = sqlstate.substring(2);
             
-            System.out.println(&quot;---------------------------------------Translating sqlstate = &quot; + sqlstate);
-            
             // Connection exception - Connection does not exist, was interrupted or cannot be established
             if (errorClass.equals(&quot;08&quot;)) {
             	/* POINTLESS :(

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -1785,3 +1785,11 @@
 Error.Transformation.SJTSK=Some value is incorrect
 
 Error.Transformation.S42=Some value is incorrect
+
+Plantlore.Title=Plantlore
+
+Common.Previous=Previous
+
+Publications.SelectPublication=Please select publication
+
+Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_cs_CZ.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -2103,3 +2103,59 @@
 Error.Transformation.SJTSK=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
 
 Error.Transformation.S42=N\u011Bkter\u00E1 z hodnot p\u0159ekro\u010Dil\u00E1 povolenou velikost
+
+Plantlore.Title=Plantlore
+
+statusOkButton=Potvrd\u00ED zm\u011Bny
+
+statusCancelButton=Zru\u0161\u00ED ud\u011Blan\u00E9 zm\u011Bny
+
+statusHelpButton=Zobraz\u00ED n\u00E1pov\u011Bdu pro dan\u00FD dialog
+
+statusLangSettings=P\u0159epne se na jazykov\u00E9 nastaven\u00ED
+
+statusOtherSettings=P\u0159epne se na dal\u0161\u00ED nastaven\u00ED
+
+Data=Data
+
+dataImport=&amp;Import
+
+dataImportTooltip=Importuje n\u00E1lezov\u00E9 z\u00E1znamy do datab\u00E1ze
+
+dataExport=&amp;Export
+
+dataExportTooltip=Exportuje vybran\u00E9 z\u00E1znamy
+
+dataSearch=&amp;Search/Sort
+
+dataSearchTooltip=Otev\u0159e dialog pro vyhled\u00E1v\u00E1n\u00ED
+
+dataSort=Uspo\u0159\u00E1dat podle\:
+
+recordAdd=&amp;Add
+
+recordAddTT=P\u0159id\u00E1 nov\u00FD n\u00E1lez
+
+recordEdit=&amp;Edit
+
+recordEditTT=Upravit vybrabn\u00FD n\u00E1lez
+
+recordDelete=&amp;Delete
+
+recordDeleteTT=Sma\u017E vybran\u00FD n\u00E1lez
+
+recordDetails=Detaily
+
+Information.NoMetadataInResultTitle=\u017D\u00E1dn\u00E9 v\u00FDsledky vyhled\u00E1v\u00E1n\u00ED
+
+DBLayer.Error.CreateDB=Vytvo\u0159en\u00ED nov\u00E9 datab\u00E1ze nebylo \u00FAsp\u011B\u0161n\u00E9. P\u0159esv\u011Bd\u010Dte se, \u017Ee datab\u00E1zov\u00FD syst\u00E9m je spr\u00E1vn\u011B nainstalov\u00E1n a \u017Ee datab\u00E1ze s t\u00EDmto jm\u00E9nem je\u0161te neexistuje.\n
+
+Question.UndoRecordDetail=\u00DApravy neovplyvn\u00ED \u017E\u00E1dn\u00E9 dal\u0161\u00ED n\u00E1lezy
+
+recordCreatedPanel=Z\u00E1znam vytvo\u0159en
+
+Common.Previous=P\u0159edchoz\u00ED
+
+Publications.SelectPublication=Vyberte pros\u00EDm publikaci
+
+Error.CreateDatabase=Nebylo mo\u017En\u00E9 vytvo\u0159it datab\u00E1zi. Skontrolujte zadan\u00E9 autentifika\u0107n\u00ED \u00FAdaje a to, jestli tato datab\u00E1ze u\u017E neexistuje

Modified: trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties
===================================================================
--- trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/l10n/Plantlore_en.properties	2006-09-07 10:31:12 UTC (rev 760)
@@ -1636,3 +1636,15 @@
 Error.Transformation.SJTSK=Some value is incorrect
 
 Error.Transformation.S42=Some value is incorrect
+
+Plantlore.Title=Plantlore
+
+Login.AddRecord=Add
+
+Login.AddRecordTT=Add a new record.
+
+Common.Previous=Previous
+
+Publications.SelectPublication=Please select publication
+
+Error.CreateDatabase=Unable to create database. Please check that you enetred correct authentication data and that the database doesn't exist yet

Modified: trunk/src/net/sf/plantlore/middleware/DBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/middleware/DBLayer.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -364,13 +364,22 @@
     public int getConnectionCount() throws RemoteException;
     
     /**
-     *  TODO: JavaDoc pending     
+     *  Method used to create new database in the PostgreSQL system.
+     *  @param dbname name of the database to create
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
      */
     public void createDatabase(String dbname) throws DBLayerException, RemoteException;
 
     /**
-     *  TODO: JavaDoc pending     
-     */    
+     *  Executes given SQL script. This method is used for creating new users in the new database nad createing tables.
+     *  @param scriptid id of the script to execute
+     *  @param dbname name of the database to execute the script in
+     *  @param username username used to connect to the database
+     *  @password password used to connect to the database
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException;
     
     /**

Modified: trunk/src/net/sf/plantlore/server/HibernateDBLayer.java
===================================================================
--- trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-07 09:58:48 UTC (rev 759)
+++ trunk/src/net/sf/plantlore/server/HibernateDBLayer.java	2006-09-07 10:31:12 UTC (rev 760)
@@ -261,7 +261,13 @@
         return plantloreUser;
     }
     
-    // TODO: JavaDoc, cleanup
+    /**
+     *  Initialization of DBLayer when creating new DB (login without database prefix)
+     *
+     *  @param dbID database identifier - database we want to use
+     *  @param user loginname of the user
+     *  @param password password of the user
+     */
     public void initializeNewDB(String dbID, String user, String password) throws DBLayerException, RemoteException {
         Configuration cfg;
         // Load Hibernate configuration
@@ -1066,7 +1072,12 @@
     public void executeDeleteInTransactionHistory(Object data) throws DBLayerException, RemoteException {
         lowLevelOperation(DELETE, data, false, false);
     }
-    
+
+    /**
+     *  Method to check the rights of the user, whether he is allowed to execute given operation
+     *  @data data we inserted/updated
+     *  @type type of the operation (INSERT/UPDATE/DELETE)
+     */
     private void checkRights(Object data, int type) throws DBLayerException {
         DBLayerException ex;
         Session sess;
@@ -1404,6 +1415,15 @@
         }        
     }
     
+    /**
+     *  Method for saving history of database modifications
+     *
+     *  @param sess session to use for databas queries
+     *  @param data data we inserted/updated
+     *  @param type type of operation (SAVE, UPDATE)
+     *  @param recordId id of the newly created record
+     *  @throws DBLayerException in case database error occurred
+     */
     private void saveHistory(Session sess, Object data, int type, Integer recordId) throws DBLayerException {
         String table;
         Integer id, result = 0;
@@ -2174,6 +2194,12 @@
         return sessions.size();
     }
     
+    /**
+     *  Method used to create new database in the PostgreSQL system.
+     *  @param dbname name of the database to create
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void createDatabase(String dbname) throws DBLayerException, RemoteException {
         // Check whether we are connected and obtain a session
         checkConnection();     
@@ -2194,6 +2220,15 @@
         }
     }
     
+    /**
+     *  Executes given SQL script. This method is used for creating new users in the new database nad createing tables.
+     *  @param scriptid id of the script to execute
+     *  @param dbname name of the database to execute the script in
+     *  @param username username used to connect to the database
+     *  @password password used to connect to the database
+     *  @throws DBLayerException in case database error occurred
+     *  @throws RemoteException in case network error occurred
+     */
     public void executeSQLScript(int scriptid, String dbname, String username, String password) throws DBLayerException, RemoteException {
         String file;
         switch (scriptid) {


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="001038.html">[Plantlore-dev] r759 - trunk/documentation
</A></li>
	<LI>Next message: <A HREF="001040.html">[Plantlore-dev] r761 - trunk/documentation
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#1039">[ date ]</a>
              <a href="thread.html#1039">[ thread ]</a>
              <a href="subject.html#1039">[ subject ]</a>
              <a href="author.html#1039">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
