<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<HTML>
 <HEAD>
   <TITLE> [Plantlore-dev] r470 - in trunk/src/net/sf/plantlore:	client/history common
   </TITLE>
   <LINK REL="Index" HREF="http://lists.berlios.de/pipermail/plantlore-dev/2006-July/index.html" >
   <LINK REL="made" HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r470%20-%20in%20trunk/src/net/sf/plantlore%3A%0A%09client/history%20common&In-Reply-To=%3C200607231841.k6NIfAm6010361%40sheep.berlios.de%3E">
   <META NAME="robots" CONTENT="index,nofollow">
   <style type="text/css">
       pre {
           white-space: pre-wrap;       /* css-2.1, curent FF, Opera, Safari */
           }
   </style>
   <META http-equiv="Content-Type" content="text/html; charset=us-ascii">
   <LINK REL="Previous"  HREF="000607.html">
   <LINK REL="Next"  HREF="000609.html">
 </HEAD>
 <BODY BGCOLOR="#ffffff">
   <H1>[Plantlore-dev] r470 - in trunk/src/net/sf/plantlore:	client/history common</H1>
    <B>lada at mail.berlios.de</B> 
    <A HREF="mailto:plantlore-dev%40lists.berlios.de?Subject=Re%3A%20%5BPlantlore-dev%5D%20r470%20-%20in%20trunk/src/net/sf/plantlore%3A%0A%09client/history%20common&In-Reply-To=%3C200607231841.k6NIfAm6010361%40sheep.berlios.de%3E"
       TITLE="[Plantlore-dev] r470 - in trunk/src/net/sf/plantlore:	client/history common">lada at mail.berlios.de
       </A><BR>
    <I>Sun Jul 23 20:41:10 CEST 2006</I>
    <P><UL>
        <LI>Previous message: <A HREF="000607.html">[Plantlore-dev] r469 - trunk/analysis/database
</A></li>
        <LI>Next message: <A HREF="000609.html">[Plantlore-dev] Fwd: Plantlore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#608">[ date ]</a>
              <a href="thread.html#608">[ thread ]</a>
              <a href="subject.html#608">[ subject ]</a>
              <a href="author.html#608">[ author ]</a>
         </LI>
       </UL>
    <HR>  
<!--beginarticle-->
<PRE>Author: lada
Date: 2006-07-23 20:41:04 +0200 (Sun, 23 Jul 2006)
New Revision: 470

Modified:
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
   trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
   trunk/src/net/sf/plantlore/client/history/History.java
   trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/HistoryView.form
   trunk/src/net/sf/plantlore/client/history/HistoryView.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
   trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
   trunk/src/net/sf/plantlore/common/ProgressBar.java
Log:
History - task, long transaction, rewrite view form - correct layout after expansion of dialog, tab, white background, ... (sometimes netbeans don`t save changes in form correctly - often old value is not rewrite in source).

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.form	2006-07-23 18:41:04 UTC (rev 470)
@@ -23,7 +23,7 @@
                   &lt;Component id=&quot;jPanel1&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;189&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;193&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
@@ -34,13 +34,13 @@
     &lt;DimensionLayout dim=&quot;1&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
           &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Component id=&quot;jPanel1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jPanel1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace min=&quot;-2&quot; pref=&quot;11&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;closeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;

Modified: trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/DetailsHistoryView.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -80,7 +80,7 @@
         jPanel1.setLayout(jPanel1Layout);
         jPanel1Layout.setHorizontalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 373, Short.MAX_VALUE)
+            .add(jScrollPane2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 377, Short.MAX_VALUE)
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -101,19 +101,19 @@
                     .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 189, Short.MAX_VALUE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 193, Short.MAX_VALUE)
                         .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
-                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(11, 11, 11)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(closeButton)
                     .add(helpButton))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                .addContainerGap())
         );
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents

Modified: trunk/src/net/sf/plantlore/client/history/History.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/History.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/History.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -20,6 +20,7 @@
 import java.util.Hashtable;
 import java.util.Observable;
 import net.sf.plantlore.common.PlantloreConstants;
+import net.sf.plantlore.common.Task;
 import net.sf.plantlore.common.record.Author;
 import net.sf.plantlore.common.record.AuthorOccurrence;
 import net.sf.plantlore.common.record.Habitat;
@@ -74,7 +75,11 @@
     /** List of identifier of selected item */
     private HashSet markListId = new HashSet();
     /** List of pairs (Item, identifier of the oldest change of this Item) */
-    private ArrayList&lt;Object[]&gt; markItem = new ArrayList&lt;Object[]&gt;();
+    private ArrayList&lt;Object[]&gt; markItem = new ArrayList&lt;Object[]&gt;();    
+    /** Identifier of the oldest changes which will be restored */
+    private int toResult;
+    /** Containing information about type of history (false == whole history and true == history of record) */
+    private boolean typeHistory;
     /** Information about useing function Select All*/
     private boolean selectAll;
     /** Information about useing function Unselected All*/
@@ -213,7 +218,7 @@
      *  Creates a new instance of History - history of specific habitat 
      *  @param database Instance of a database management object
      *  @param idObj integer containing identifier of specific habitat
-     *  @param infoHabitat 
+     *  @param innfoHabitat 
      * */
     public History(DBLayer database, int idObj, String infoHabitat)
     {
@@ -1436,7 +1441,14 @@
             setChanged();
             notifyObservers();
         }     
-               
+          
+        if (objects == null) {
+        	logger.error(&quot;tAuthors doesn't contain required data&quot;);  
+ 		    setError(ERROR_SEARCH_AUTHOR);		    		   
+            setChanged();
+            notifyObservers();
+        }
+        
        return objects;
     }
     
@@ -1462,47 +1474,69 @@
     }
     
     /**
-     *  Update data in the database.
+     *  Update data in the database and delete selected data from history tables.
+     *  Operation is executed in a separate thread using Task class.
+     *  @param toResult identifier of the oldest changes which will be restored
+     *  @param typeHistory containing information about type of history (whole history or history of record)
+     *  @return instance of the Task with the long running operation (commitUpdate)
      */
-    public void commitUpdate() {    	                
+    public Task commitUpdate(int toResult, boolean typeHistory) {   
+    	this.toResult = toResult;
+    	this.typeHistory = typeHistory;
+    	
+    	final Task task = new Task() {    		    		
+    		public Object task() throws DBLayerException, RemoteException {
+    	
+		        ArrayList&lt;Enum&gt; editType = new ArrayList&lt;Enum&gt;();
+		        int count = editObjectList.size();
+		        boolean ok = false;
+		        String type;
+		        Enum key;
         
-        ArrayList&lt;Enum&gt; editType = new ArrayList&lt;Enum&gt;();
-        String type;
-        Enum key;
-        initEditTypeHash();
-        
-    	int count = editObjectList.size();
-              	
-    	for (int i=0; i&lt; count; i++) {
-    		try {
-    			logger.debug(&quot;Object for update: &quot;+ ((Record)editObjectList.get(i)).getId());                         
-                type = editObjectList.get(i).getClass().getSimpleName();
-                 if (editTypeHash.containsKey(type)) {
-                         key = (Enum)editTypeHash.get(type); 
-                         if(!editType.contains(key))
-                             editType.add(key);
-                }                                                     
-                database.executeUpdateHistory(editObjectList.get(i));
-	        } catch (RemoteException e) {
-	        	logger.error(&quot;Update data failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-	       	    setError(ERROR_UPDATE);
-	       	    //Tell observers to update
-	            setChanged();
-	            notifyObservers();
-	            return;
-	        } catch (DBLayerException e) {
-	        	logger.error(&quot;Update data failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-	            setError(ERROR_UPDATE); 
-	            //Tell observers to update
-	            setChanged();
-	            notifyObservers();
-	            return;
-	        } 
-       }    	
-    	//Create array of editing object and call notifyObservers
-        informMethod(editType);
+		        initEditTypeHash();
+            	    	
+		        ok = database.beginTransaction();
+		        if (!ok) {
+		            logger.debug(&quot;History.commitUpdate(): Can't create transaction. Another is probably already running.&quot;);
+		            throw new DBLayerException(&quot;Can't create transaction. Another already running.&quot;);
+		        }
+		        
+		        try {
+			    	for (int i=0; i&lt; count; i++) {			    		
+			    			logger.debug(&quot;Object for update: &quot;+ ((Record)editObjectList.get(i)).getId());                         
+			                type = editObjectList.get(i).getClass().getSimpleName();
+			                 if (editTypeHash.containsKey(type)) {
+			                         key = (Enum)editTypeHash.get(type); 
+			                         if(!editType.contains(key))
+			                             editType.add(key);
+			                }                                                     
+			                database.executeUpdateHistory(editObjectList.get(i));
+			    		}
+			    	//Delete selected data from history tables 
+			    	deleteHistory();
+		        } catch (RemoteException e) {
+		        	logger.error(&quot;Process UNDO failed. Remote exception caught in History. Details: &quot;+e.getMessage());
+		        	database.rollbackTransaction();
+                    RemoteException remex = new RemoteException(ERROR_UPDATE + e);
+                    remex.setStackTrace(e.getStackTrace());
+                    throw remex; 		           
+		       	    
+		        } catch (DBLayerException e) {
+		        	logger.error(&quot;Process UNDO failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
+		        	database.rollbackTransaction();
+                    DBLayerException dbex = new DBLayerException(ERROR_UPDATE + e);
+                    dbex.setStackTrace(e.getStackTrace());
+                    throw dbex; 		            
+		        } 
+		        database.commitTransaction();	    	
+		    	//Create array of editing object and call notifyObservers
+		        informMethod(editType);	    		    	        
+		        return null;
+    		}
+	    };
+	    return task;
     }
-    
+	    
     /**
      *  Create array of editing object and give this array to parrent
      *  @param editType containing list of type of editing object 
@@ -1526,11 +1560,11 @@
     }
        
     /**
-     * Delete selected data from history table. During delete data from table tHistoryChange verify foring key from table tHistory.
-     * @param toResult identifier of the oldest changes which will be restored
-     * @param typeHistory containing information about type of history (whole history or history of record)
+     * Delete selected data from history table. 
+     * During delete data from table tHistoryChange verify foring key from table tHistory. 
+     * Operation is executed in a separate thread using Task class.   
      */
-    public void deleteHistory(int toResult, boolean typeHistory) {
+    public void deleteHistory() throws DBLayerException, RemoteException {
    	
     	//take from younger record to older record
     	for( int i=0; i &lt; toResult; i++) {
@@ -1544,18 +1578,17 @@
 	    	try {
 				database.executeDeleteHistory(historyRecord);
 				logger.debug(&quot;Deleting historyRecord successfully. Number of result: &quot;+i);
-			} catch (RemoteException e) {				
-				logger.error(&quot;Deleting historyRecord failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-	       	    setError(ERROR_DELETE);
-	       	    //Tell observers to update
-	            setChanged();
-	            notifyObservers();
-			} catch (DBLayerException e) {				
-				logger.error(&quot;Deleting historyRecord failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-	            setError(ERROR_DELETE); 
-	            //Tell observers to update
-	            setChanged();
-	            notifyObservers();
+			} catch (RemoteException e) {								
+				logger.error(&quot;Process UNDO failed. Deleting historyRecord failed. Remote exception caught in History. Details: &quot;+e.getMessage());	        	
+                RemoteException remex = new RemoteException(ERROR_DELETE + e);
+                remex.setStackTrace(e.getStackTrace());
+                throw remex; 		           
+			} catch (DBLayerException e) {								
+				logger.error(&quot;Process UNDO failed. Deleting historyRecord failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
+	        	database.rollbackTransaction();
+                DBLayerException dbex = new DBLayerException(ERROR_DELETE + e);
+                dbex.setStackTrace(e.getStackTrace());
+                throw dbex; 		           	          
 			}
 			int countResult = getRelationshipHistoryChange(historyChange.getId());			
 			if (countResult == 0) {				
@@ -1563,17 +1596,16 @@
 					database.executeDeleteHistory(historyChange);
 					logger.debug(&quot;Deleting historyChange successfully.&quot;);
 				} catch (RemoteException e) {
-					logger.error(&quot;Deleting historyChange failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-		       	    setError(ERROR_DELETE);
-		       	    //Tell observers to update
-		            setChanged();
-		            notifyObservers();
+					logger.error(&quot;Process UNDO failed. Deleting historyChange failed. Remote exception caught in History. Details: &quot;+e.getMessage());	        	
+	                RemoteException remex = new RemoteException(ERROR_DELETE + e);
+	                remex.setStackTrace(e.getStackTrace());
+	                throw remex; 		           
 				} catch (DBLayerException e) {
-					logger.error(&quot;Deleting historyChange failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-		            setError(ERROR_DELETE); 
-		            //Tell observers to update
-		            setChanged();
-		            notifyObservers();
+					logger.error(&quot;Process UNDO failed. Deleting historyChange failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
+		        	database.rollbackTransaction();
+	                DBLayerException dbex = new DBLayerException(ERROR_DELETE + e);
+	                dbex.setStackTrace(e.getStackTrace());
+	                throw dbex; 		           
 				}
 			} else {
 				logger.debug(&quot;Exist other record in the table tHistory, whitch has the same value of attribute cChangeId.&quot;);
@@ -1775,134 +1807,83 @@
     
     /**
      *  Delete all date from tables tHistory and tHistoryChange
+     *  Operation is executed in a separate thread using Task class.
      */
-    public void clearHistory() {        
-        
-    	//TODO uzavrit to do dlouhotrvajici transakce
+    public void clearHistory() throws RemoteException, DBLayerException {        
+            	
         try {
             //delete data from table tHistory
             database.conditionDelete(HistoryRecord.class, HistoryRecord.ID, &quot;&gt;&quot;, 0);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tHistory failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_HISTORY);       	   
-            setChanged();
-            notifyObservers();    
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tHistory failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_HISTORY);            
-            setChanged();
-            notifyObservers(); 
-            return;
-        }        
-        
-        try {            
             //delete data from  table tHistoryChange
             database.conditionDelete(HistoryChange.class, HistoryChange.ID, &quot;&gt;&quot;, 0);
         } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tHistoryChange failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_HISTORY);       	   
-            setChanged();
-            notifyObservers();  
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tHistoryChange failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_HISTORY);            
-            setChanged();
-            notifyObservers();
-            return;
-        }        
-        
+        	logger.error(&quot;Process cleare database failed. Remote exception caught in History. Details: &quot;+e.getMessage());
+        	database.rollbackTransaction();
+            RemoteException remex = new RemoteException(ERROR_CLEAR_HISTORY + e);
+            remex.setStackTrace(e.getStackTrace());
+            throw remex; 		           
+       	    
+        } catch (DBLayerException e) {
+        	logger.error(&quot;Process cleare database failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
+        	database.rollbackTransaction();
+            DBLayerException dbex = new DBLayerException(ERROR_CLEAR_HISTORY + e);
+            dbex.setStackTrace(e.getStackTrace());
+            throw dbex; 		            
+        }       
     }
     
     /**
-     * Delete records from table tAuthors, tAuthorsOccurrences, tOccurrences, tHabitats, tPublications with condition cdelete == 1 
+     * Delete records from table tAuthors, tAuthorsOccurrences, tOccurrences, tHabitats, tPublications with condition cdelete == 1
+     * and delete all date from tables tHistory and tHistoryChange
+     * Operation is executed in a separate thread using Task class. 
+     * @return instance of the Task with the long running operation (clearDatabase)
      */
-    public void clearDatabase() {
+    public Task clearDatabase() {
     	
     	//TODO - osetrit proti smazani zaznamu na ktery existuje FK
-    	//Uzavrit to do dlouho trvajici transakce, at se to provede bud vse nebo nic 
     	
-        try {
-            // delete data from table tAuthor with contidion cDelete == 1
-            database.conditionDelete(Author.class, Author.DELETED, &quot;=&quot;, 1);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tAuthor failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_DATABASE);       	   
-            setChanged();
-            notifyObservers();   
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tAuthor failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_DATABASE);            
-            setChanged();
-            notifyObservers();  
-            return;
-        }        
-        try {
-        	//delete data from table tAuthorOccurrence with contidion cDelete &gt; 0
-            database.conditionDelete(AuthorOccurrence.class, AuthorOccurrence.DELETED, &quot;&gt;&quot;, 0);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tAuthorOccurrence failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_DATABASE);       	   
-            setChanged();
-            notifyObservers();
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tAuthorOccurrence failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_DATABASE);            
-            setChanged();
-            notifyObservers();
-            return;
-        }        
-        try {
-        	// delete data from table tOccurrence with contidion cDelete == 1
-            database.conditionDelete(Occurrence.class, Occurrence.DELETED, &quot;=&quot;, 1);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tOccurrence failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_DATABASE);       	   
-            setChanged();
-            notifyObservers();
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tOccurrence failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_DATABASE);            
-            setChanged();
-            notifyObservers();
-            return;
-        }        
-        try {
-        	// delete data from table tHabitat with contidion cDelete == 1
-            database.conditionDelete(Habitat.class, Habitat.DELETED, &quot;=&quot;, 1);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tHabitat failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_DATABASE);       	   
-            setChanged();
-            notifyObservers();
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tHabitat failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_DATABASE);            
-            setChanged();
-            notifyObservers();
-            return;
-        }        
-        try {
-        	// delete data from table tPublication with contidion cDelete == 1
-            database.conditionDelete(Publication.class, Publication.DELETED, &quot;=&quot;, 1);
-        } catch (RemoteException e) {
-        	logger.error(&quot;Delete data from tPublication failed.Remote exception caught in History. Details: &quot;+e.getMessage());
-       	    setError(ERROR_CLEAR_DATABASE);       	   
-            setChanged();
-            notifyObservers();
-            return;
-        } catch(DBLayerException e) {
-        	logger.error(&quot;Delete data from tPublication failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
-            setError(ERROR_CLEAR_DATABASE);            
-            setChanged();
-            notifyObservers();
-            return;
-        }        
+    	final Task task = new Task() {    		    		
+    		public Object task() throws DBLayerException, RemoteException {
+    			boolean ok = false;
+    			
+    			ok = database.beginTransaction();
+		        if (!ok) {
+		            logger.debug(&quot;History.clearDatabase(): Can't create transaction. Another is probably already running.&quot;);
+		            throw new DBLayerException(&quot;Can't create transaction. Another already running.&quot;);
+		        }
+		        
+		        try {
+		        	// delete data from table tAuthor with contidion cDelete == 1
+		            database.conditionDelete(Author.class, Author.DELETED, &quot;=&quot;, 1);
+		            // delete data from table tAuthorOccurrence with contidion cDelete &gt; 0
+		            database.conditionDelete(AuthorOccurrence.class, AuthorOccurrence.DELETED, &quot;&gt;&quot;, 0);
+		            // delete data from table tOccurrence with contidion cDelete == 1
+		            database.conditionDelete(Occurrence.class, Occurrence.DELETED, &quot;=&quot;, 1);
+		            // delete data from table tHabitat with contidion cDelete == 1
+		            database.conditionDelete(Habitat.class, Habitat.DELETED, &quot;=&quot;, 1);
+		            // delete data from table tPublication with contidion cDelete == 1
+		            database.conditionDelete(Publication.class, Publication.DELETED, &quot;=&quot;, 1);
+		            //Delete all date from tables tHistory and tHistoryChange
+		            clearHistory();
+		        } catch (RemoteException e) {
+		        	logger.error(&quot;Process cleare database failed. Remote exception caught in History. Details: &quot;+e.getMessage());
+		        	database.rollbackTransaction();
+                    RemoteException remex = new RemoteException(ERROR_CLEAR_DATABASE + e);
+                    remex.setStackTrace(e.getStackTrace());
+                    throw remex; 		           
+		       	    
+		        } catch (DBLayerException e) {
+		        	logger.error(&quot;Process cleare database failed. DBLayer exception caught in History. Details: &quot;+e.getMessage());       	                                                   
+		        	database.rollbackTransaction();
+                    DBLayerException dbex = new DBLayerException(ERROR_CLEAR_DATABASE + e);
+                    dbex.setStackTrace(e.getStackTrace());
+                    throw dbex; 		            
+		        } 
+		        database.commitTransaction(); 
+		        return null;
+    		}
+    	};
+    	return task;
     }
     
     /**

Modified: trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/HistoryCtrl.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -3,6 +3,15 @@
 
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
+import java.rmi.RemoteException;
+
+import javax.swing.JOptionPane;
+
+import net.sf.plantlore.common.ProgressBar;
+import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.l10n.L10n;
+
 import org.apache.log4j.Logger;
 
 /**
@@ -202,23 +211,54 @@
                if (okCancle == 0){
             	   //Button OK was press
             	   logger.debug(&quot;Button OK was press.&quot;);
-            	   model.commitUpdate();
-            	   model.deleteHistory(model.getResultRows(), true);            	   
-            	   model.searchEditHistory(model.getData());
-            	   model.processResult(1,model.getDisplayRows());
-            	   view.getTable().setModel(new HistoryTableModel(model));
-            	   int resultRows = model.getResultRows();
-            	   if (resultRows == 0) {
-            		   view.setCurrentRowsInfo(&quot;0-0&quot;); 
-            	   } else {
-            		   int from = model.getCurrentFirstRow();
-                       int to = from + view.getTable().getRowCount() - 1;               
-                       view.setCurrentRowsInfo(from + &quot;-&quot; + to);    
-            	   }               
-                       view.setCountResutl(resultRows);   
+            	   Task task = model.commitUpdate(model.getResultRows(), true);  
+            	   
+            	   ProgressBar progressBar = new ProgressBar(task, view, true) {		   				
+						private static final long serialVersionUID = -6065695152319199854L;
+							public void exceptionHandler(Exception e) {
+		   						if (e instanceof DBLayerException) {	   									   							
+		   							DBLayerException dbex = (DBLayerException) e;
+		   							//TODO zobrazit vlastni message - nemusi vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+									JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.DBLayerException&quot;)+ &quot;\n&quot; + dbex.getErrorInfo(),
+		 							   L10n.getString(&quot;Error.DBLayerExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(dbex + &quot;: &quot; + dbex.getErrorInfo());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						if (e instanceof RemoteException) {	 
+		   							RemoteException remex = (RemoteException) e;
+		   							//TODO zobrazit vlastni message - nemusi vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+		   							JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.RemoteException&quot;)+ &quot;\n&quot; + remex.getMessage(),
+		 							   L10n.getString(&quot;Error.RemoteExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(remex + &quot;: &quot; + remex.getMessage());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						JOptionPane.showMessageDialog(view, L10n.getString(&quot;Delete.Message.UnknownException&quot;)+ &quot;\n&quot; + e.getMessage(),
+			 					    L10n.getString(&quot;Delete.Message.UnknownExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);							
+		   						logger.error(e);
+		   					}
+	
+		   					public void afterStopping() {
+		   					   model.searchEditHistory(model.getData());
+		   	            	   model.processResult(1,model.getDisplayRows());
+		   	            	   view.getTable().setModel(new HistoryTableModel(model));
+		   	            	   int resultRows = model.getResultRows();
+		   	            	   if (resultRows == 0) {
+		   	            		   view.setCurrentRowsInfo(&quot;0-0&quot;); 
+		   	            	   } else {
+		   	            		   int from = model.getCurrentFirstRow();
+		   	                       int to = from + view.getTable().getRowCount() - 1;               
+		   	                       view.setCurrentRowsInfo(from + &quot;-&quot; + to);    
+		   	            	   }               
+		   	                       view.setCountResutl(resultRows);   
+		   	               } 		   					
+		   				};
+		   				progressBar.setTitle(L10n.getString(&quot;History.Undo.ProgressTitle&quot;));	                   	                   
+	                    task.start();            	               	   
                } else {            	  
             	   logger.debug(&quot;Button Cancle was press.&quot;); 
-               }
+               }  
            } else {
         	   model.setError(null);        	           	  
            }

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.form	2006-07-23 18:41:04 UTC (rev 470)
@@ -17,28 +17,24 @@
   &lt;Layout&gt;
     &lt;DimensionLayout dim=&quot;0&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-          &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;EmptySpace pref=&quot;364&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;okButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;20&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
-                          &lt;Component id=&quot;jPanel3&quot; alignment=&quot;1&quot; pref=&quot;684&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace pref=&quot;472&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;okButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;30&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
                       &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;jPanel1&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;Component id=&quot;jPanel2&quot; alignment=&quot;1&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;jPanel1&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;jPanel2&quot; alignment=&quot;0&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;jPanel3&quot; alignment=&quot;1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;20&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
@@ -46,20 +42,20 @@
     &lt;/DimensionLayout&gt;
     &lt;DimensionLayout dim=&quot;1&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Component id=&quot;jPanel1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Component id=&quot;jPanel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;jPanel3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;15&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jPanel3&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;14&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Component id=&quot;okButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;closeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Component id=&quot;okButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -79,27 +75,26 @@
       &lt;Layout&gt;
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;19&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;taxonLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;authorLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;locationLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;taxonLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;83&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace pref=&quot;57&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;locationValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;authorValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;taxonValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;authorValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;locationValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace pref=&quot;428&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace pref=&quot;445&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                       &lt;Component id=&quot;taxonLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;taxonValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
@@ -114,7 +109,6 @@
                       &lt;Component id=&quot;locationLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;locationValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
@@ -187,18 +181,18 @@
       &lt;Layout&gt;
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;20&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;whenInserLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;whoInsertLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whenInsertLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whoInsertLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;80&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;39&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;whoInsertValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;whenInsertValueLabel&quot; alignment=&quot;0&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whenInsertValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whoInsertValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace pref=&quot;431&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace pref=&quot;462&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
@@ -206,21 +200,20 @@
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;whenInserLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;whenInsertValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whenInsertLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;whoInsertLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;whoInsertValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;whoInsertLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace pref=&quot;14&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
       &lt;/Layout&gt;
       &lt;SubComponents&gt;
-        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;whenInserLabel&quot;&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;whenInsertLabel&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;font&quot; type=&quot;java.awt.Font&quot; editor=&quot;org.netbeans.beaninfo.editors.FontEditor&quot;&gt;
               &lt;Font name=&quot;Tahoma&quot; size=&quot;11&quot; style=&quot;1&quot;/&gt;
@@ -270,24 +263,34 @@
       &lt;Layout&gt;
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; pref=&quot;642&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;326&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;undoButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;2&quot;/&gt;
-                          &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;selectAllButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;2&quot;/&gt;
-                          &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;unselectAllButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;undoButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;selectAllButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;unselectAllButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
-                      &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;EmptySpace pref=&quot;33&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;jPanel4&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                          &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;68&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                           &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
+                          &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;33&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;toDisplayLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;toDisplayValueTextField&quot; min=&quot;-2&quot; pref=&quot;29&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;42&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;displayedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;displayedValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
-                      &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; pref=&quot;668&quot; max=&quot;32767&quot; attributes=&quot;1&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
@@ -295,27 +298,35 @@
         &lt;/DimensionLayout&gt;
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; max=&quot;-2&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jScrollPane1&quot; min=&quot;-2&quot; pref=&quot;214&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;jPanel4&quot; alignment=&quot;1&quot; min=&quot;-2&quot; pref=&quot;36&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;224&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;14&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;nextButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;previousButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;totalResultValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;totalResultLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;unselectAllButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;selectAllButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;Component id=&quot;undoButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;unselectAllButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
       &lt;/Layout&gt;
       &lt;SubComponents&gt;
         &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane1&quot;&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;jScrollPane1.getViewport().setBackground(Color.WHITE);&quot;/&gt;
+          &lt;/AuxValues&gt;
 
           &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
           &lt;SubComponents&gt;
@@ -330,6 +341,9 @@
                   &lt;/Table&gt;
                 &lt;/Property&gt;
               &lt;/Properties&gt;
+              &lt;AuxValues&gt;
+                &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;TransferFocus.patch(tableEditList);&quot;/&gt;
+              &lt;/AuxValues&gt;
             &lt;/Component&gt;
           &lt;/SubComponents&gt;
         &lt;/Container&gt;
@@ -353,20 +367,20 @@
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
-        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;selectAllButton&quot;&gt;
+        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;unselectAllButton&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonSelectAll&quot;)&quot; type=&quot;code&quot;/&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonUnselectAll&quot;)&quot; type=&quot;code&quot;/&gt;
             &lt;/Property&gt;
           &lt;/Properties&gt;
           &lt;AuxValues&gt;
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
-        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;unselectAllButton&quot;&gt;
+        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;selectAllButton&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonUnselectAll&quot;)&quot; type=&quot;code&quot;/&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonSelectAll&quot;)&quot; type=&quot;code&quot;/&gt;
             &lt;/Property&gt;
           &lt;/Properties&gt;
           &lt;AuxValues&gt;
@@ -383,103 +397,57 @@
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
-        &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel4&quot;&gt;
-
-          &lt;Layout&gt;
-            &lt;DimensionLayout dim=&quot;0&quot;&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;17&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;toDisplayLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;toDisplayValueTextField&quot; min=&quot;-2&quot; pref=&quot;25&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;21&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;displayedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;displayedValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
-              &lt;/Group&gt;
-            &lt;/DimensionLayout&gt;
-            &lt;DimensionLayout dim=&quot;1&quot;&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;totalResultLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;totalResultValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
-              &lt;/Group&gt;
-            &lt;/DimensionLayout&gt;
-          &lt;/Layout&gt;
-          &lt;SubComponents&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.TotalResult&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultValueLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;((Integer)model.getResultRows()).toString()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;toDisplayLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.RowToDisplay&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JTextField&quot; name=&quot;toDisplayValueTextField&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;((Integer)model.getDisplayRows()).toString()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;autoscrolls&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
-                &lt;Property name=&quot;minimumSize&quot; type=&quot;java.awt.Dimension&quot; editor=&quot;org.netbeans.beaninfo.editors.DimensionEditor&quot;&gt;
-                  &lt;Dimension value=&quot;[16, 19]&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;AuxValues&gt;
-                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
-              &lt;/AuxValues&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.Displayed&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedValueLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;model.getCurrentDisplayRows()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-          &lt;/SubComponents&gt;
-        &lt;/Container&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.TotalResult&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultValueLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;((Integer)model.getResultRows()).toString()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;toDisplayLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.RowToDisplay&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JTextField&quot; name=&quot;toDisplayValueTextField&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;((Integer)model.getDisplayRows()).toString()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.Displayed&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedValueLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;model.getCurrentDisplayRows()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
       &lt;/SubComponents&gt;
     &lt;/Container&gt;
-    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonOk&quot;)&quot; type=&quot;code&quot;/&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonHelp&quot;)&quot; type=&quot;code&quot;/&gt;
         &lt;/Property&gt;
       &lt;/Properties&gt;
       &lt;AuxValues&gt;
@@ -496,10 +464,10 @@
         &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
       &lt;/AuxValues&gt;
     &lt;/Component&gt;
-    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonHelp&quot;)&quot; type=&quot;code&quot;/&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonOk&quot;)&quot; type=&quot;code&quot;/&gt;
         &lt;/Property&gt;
       &lt;/Properties&gt;
       &lt;AuxValues&gt;

Modified: trunk/src/net/sf/plantlore/client/history/HistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/HistoryView.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -14,6 +14,8 @@
 import javax.swing.JTable;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
+import java.awt.Color;
+import net.sf.plantlore.common.TransferFocus;
 
 /**
  * View for the main History dialog (part of the History MVC). Used for displaying the search results.
@@ -61,7 +63,7 @@
               return;
           } 
     } 
-      
+    
     /** This method is called from within the constructor to
      * initialize the form.
      * WARNING: Do NOT modify this code. The content of this method is
@@ -77,7 +79,7 @@
         authorValueLabel = new javax.swing.JLabel();
         locationValueLabel = new javax.swing.JLabel();
         jPanel2 = new javax.swing.JPanel();
-        whenInserLabel = new javax.swing.JLabel();
+        whenInsertLabel = new javax.swing.JLabel();
         whoInsertLabel = new javax.swing.JLabel();
         whenInsertValueLabel = new javax.swing.JLabel();
         whoInsertValueLabel = new javax.swing.JLabel();
@@ -86,19 +88,18 @@
         tableEditList = new javax.swing.JTable();
         previousButton = new javax.swing.JButton();
         nextButton = new javax.swing.JButton();
-        selectAllButton = new javax.swing.JButton();
         unselectAllButton = new javax.swing.JButton();
+        selectAllButton = new javax.swing.JButton();
         undoButton = new javax.swing.JButton();
-        jPanel4 = new javax.swing.JPanel();
         totalResultLabel = new javax.swing.JLabel();
         totalResultValueLabel = new javax.swing.JLabel();
         toDisplayLabel = new javax.swing.JLabel();
         toDisplayValueTextField = new javax.swing.JTextField();
         displayedLabel = new javax.swing.JLabel();
         displayedValueLabel = new javax.swing.JLabel();
-        okButton = new javax.swing.JButton();
-        closeButton = new javax.swing.JButton();
         helpButton = new javax.swing.JButton();
+        closeButton = new javax.swing.JButton();
+        okButton = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;History.DetailsRecordPanel&quot;)));
@@ -122,22 +123,21 @@
         jPanel1Layout.setHorizontalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
-                .addContainerGap()
+                .add(19, 19, 19)
                 .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(taxonLabel)
                     .add(authorLabel)
-                    .add(locationLabel))
-                .add(83, 83, 83)
+                    .add(locationLabel)
+                    .add(taxonLabel))
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 57, Short.MAX_VALUE)
                 .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(locationValueLabel)
+                    .add(taxonValueLabel)
                     .add(authorValueLabel)
-                    .add(taxonValueLabel))
-                .addContainerGap(424, Short.MAX_VALUE))
+                    .add(locationValueLabel))
+                .addContainerGap(491, Short.MAX_VALUE))
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
-                .addContainerGap()
                 .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(taxonLabel)
                     .add(taxonValueLabel))
@@ -148,19 +148,17 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(locationLabel)
-                    .add(locationValueLabel))
-                .addContainerGap())
+                    .add(locationValueLabel)))
         );
 
         jPanel2.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;History.RecordCreatedPanel&quot;)));
-        whenInserLabel.setFont(new java.awt.Font(&quot;Tahoma&quot;, 1, 11));
-        whenInserLabel.setText(L10n.getString(&quot;History.WhenInsert&quot;));
+        whenInsertLabel.setFont(new java.awt.Font(&quot;Tahoma&quot;, 1, 11));
+        whenInsertLabel.setText(L10n.getString(&quot;History.WhenInsert&quot;));
 
         whoInsertLabel.setFont(new java.awt.Font(&quot;Tahoma&quot;, 1, 11));
         whoInsertLabel.setText(L10n.getString(&quot;History.WhoInsert&quot;));
 
-        String whenInsert = (model.getWhen() == null) ? null : DateFormat.getDateTimeInstance(DateFormat.MEDIUM, DateFormat.SHORT,L10n.getCurrentLocale()).format(model.getWhen());
-        whenInsertValueLabel.setText(whenInsert);
+        whenInsertValueLabel.setText(DateFormat.getDateTimeInstance(DateFormat.MEDIUM, DateFormat.SHORT,L10n.getCurrentLocale()).format(model.getWhen()) );
 
         whoInsertValueLabel.setText(model.getNameUser());
 
@@ -169,30 +167,30 @@
         jPanel2Layout.setHorizontalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel2Layout.createSequentialGroup()
-                .addContainerGap()
+                .add(20, 20, 20)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(whenInserLabel)
+                    .add(whenInsertLabel)
                     .add(whoInsertLabel))
-                .add(80, 80, 80)
+                .add(39, 39, 39)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(whoInsertValueLabel)
-                    .add(whenInsertValueLabel))
-                .addContainerGap(427, Short.MAX_VALUE))
+                    .add(whenInsertValueLabel)
+                    .add(whoInsertValueLabel))
+                .addContainerGap(508, Short.MAX_VALUE))
         );
         jPanel2Layout.setVerticalGroup(
             jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel2Layout.createSequentialGroup()
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(whenInserLabel)
-                    .add(whenInsertValueLabel))
+                    .add(whenInsertValueLabel)
+                    .add(whenInsertLabel))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(whoInsertLabel)
-                    .add(whoInsertValueLabel))
-                .addContainerGap(14, Short.MAX_VALUE))
+                    .add(whoInsertValueLabel)
+                    .add(whoInsertLabel)))
         );
 
         jPanel3.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;History.ChangesRecordPanel&quot;)));
+        jScrollPane1.getViewport().setBackground(Color.WHITE);
         tableEditList.setModel(new javax.swing.table.DefaultTableModel(
             new Object [][] {
                 {null, null, null, null},
@@ -204,16 +202,17 @@
                 &quot;Title 1&quot;, &quot;Title 2&quot;, &quot;Title 3&quot;, &quot;Title 4&quot;
             }
         ));
+        TransferFocus.patch(tableEditList);
         jScrollPane1.setViewportView(tableEditList);
 
         previousButton.setText(L10n.getString(&quot;History.ButtonPrev&quot;));
 
         nextButton.setText(L10n.getString(&quot;History.ButtonNext&quot;));
 
-        selectAllButton.setText(L10n.getString(&quot;History.ButtonSelectAll&quot;));
-
         unselectAllButton.setText(L10n.getString(&quot;History.ButtonUnselectAll&quot;));
 
+        selectAllButton.setText(L10n.getString(&quot;History.ButtonSelectAll&quot;));
+
         undoButton.setText(L10n.getString(&quot;History.ButtonUndoSelected&quot;));
 
         totalResultLabel.setText(L10n.getString(&quot;History.TotalResult&quot;));
@@ -223,90 +222,70 @@
         toDisplayLabel.setText(L10n.getString(&quot;History.RowToDisplay&quot;));
 
         toDisplayValueTextField.setText(((Integer)model.getDisplayRows()).toString());
-        toDisplayValueTextField.setAutoscrolls(false);
-        toDisplayValueTextField.setMinimumSize(new java.awt.Dimension(16, 19));
 
         displayedLabel.setText(L10n.getString(&quot;History.Displayed&quot;));
 
         displayedValueLabel.setText(model.getCurrentDisplayRows());
 
-        org.jdesktop.layout.GroupLayout jPanel4Layout = new org.jdesktop.layout.GroupLayout(jPanel4);
-        jPanel4.setLayout(jPanel4Layout);
-        jPanel4Layout.setHorizontalGroup(
-            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel4Layout.createSequentialGroup()
-                .addContainerGap()
-                .add(totalResultLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(totalResultValueLabel)
-                .add(17, 17, 17)
-                .add(toDisplayLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 25, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 21, Short.MAX_VALUE)
-                .add(displayedLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(displayedValueLabel)
-                .addContainerGap())
-        );
-        jPanel4Layout.setVerticalGroup(
-            jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel4Layout.createSequentialGroup()
-                .addContainerGap()
-                .add(jPanel4Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(totalResultLabel)
-                    .add(totalResultValueLabel)
-                    .add(toDisplayLabel)
-                    .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(displayedLabel)
-                    .add(displayedValueLabel))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-        );
-
         org.jdesktop.layout.GroupLayout jPanel3Layout = new org.jdesktop.layout.GroupLayout(jPanel3);
         jPanel3.setLayout(jPanel3Layout);
         jPanel3Layout.setHorizontalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel3Layout.createSequentialGroup()
-                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()
-                        .add(326, 326, 326)
-                        .add(undoButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()
+                .addContainerGap()
+                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                    .add(org.jdesktop.layout.GroupLayout.LEADING, jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 688, Short.MAX_VALUE)
+                    .add(jPanel3Layout.createSequentialGroup()
+                        .add(undoButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(selectAllButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(selectAllButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(unselectAllButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                        .add(unselectAllButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
                     .add(jPanel3Layout.createSequentialGroup()
-                        .add(previousButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 33, Short.MAX_VALUE)
-                        .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(previousButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(68, 68, 68)
+                        .add(totalResultLabel)
                         .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(nextButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 668, Short.MAX_VALUE))
+                        .add(totalResultValueLabel)
+                        .add(33, 33, 33)
+                        .add(toDisplayLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 29, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(42, 42, 42)
+                        .add(displayedLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(displayedValueLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 50, Short.MAX_VALUE)
+                        .add(nextButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         jPanel3Layout.setVerticalGroup(
             jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel3Layout.createSequentialGroup()
-                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 214, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                    .add(jPanel4, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 36, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel3Layout.createSequentialGroup()
+                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 224, Short.MAX_VALUE)
+                .add(14, 14, 14)
+                .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(nextButton)
                     .add(previousButton)
-                    .add(nextButton))
+                    .add(totalResultValueLabel)
+                    .add(totalResultLabel)
+                    .add(toDisplayLabel)
+                    .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                    .add(displayedLabel)
+                    .add(displayedValueLabel))
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel3Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(unselectAllButton)
                     .add(selectAllButton)
-                    .add(undoButton)
-                    .add(unselectAllButton))
+                    .add(undoButton))
                 .addContainerGap())
         );
 
-        okButton.setText(L10n.getString(&quot;History.ButtonOk&quot;));
+        helpButton.setText(L10n.getString(&quot;History.ButtonHelp&quot;));
 
         closeButton.setText(L10n.getString(&quot;History.ButtonClose&quot;));
 
-        helpButton.setText(L10n.getString(&quot;History.ButtonHelp&quot;));
+        okButton.setText(L10n.getString(&quot;History.ButtonOk&quot;));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
@@ -315,21 +294,19 @@
             .add(layout.createSequentialGroup()
                 .addContainerGap()
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(layout.createSequentialGroup()
+                        .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 518, Short.MAX_VALUE)
+                        .add(okButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(30, 30, 30))
                     .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
                         .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(layout.createSequentialGroup()
-                                .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 364, Short.MAX_VALUE)
-                                .add(okButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                                .add(20, 20, 20)
-                                .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                            .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 684, Short.MAX_VALUE))
-                        .addContainerGap())
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
-                        .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
                             .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                            .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
-                        .add(20, 20, 20))))
+                            .add(org.jdesktop.layout.GroupLayout.LEADING, jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                            .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                        .addContainerGap())))
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
@@ -339,18 +316,19 @@
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
                 .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
                 .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel3, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .add(15, 15, 15)
+                .add(jPanel3, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .add(14, 14, 14)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(helpButton)
-                    .add(okButton)
-                    .add(closeButton))
-                .addContainerGap(org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE))
+                    .add(closeButton)
+                    .add(okButton))
+                .addContainerGap())
         );
         pack();
-    }// &lt;/editor-fold&gt;//GEN-END:initComponents       
+    }// &lt;/editor-fold&gt;//GEN-END:initComponents
     
-    /**
+       
+        /**
      *  Display generic error message.
      *  @param message Message we want to display
      */
@@ -429,7 +407,6 @@
         this.toDisplayValueTextField.setText(value.toString());
     }  
     
-    
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JLabel authorLabel;
     private javax.swing.JLabel authorValueLabel;
@@ -440,7 +417,6 @@
     private javax.swing.JPanel jPanel1;
     private javax.swing.JPanel jPanel2;
     private javax.swing.JPanel jPanel3;
-    private javax.swing.JPanel jPanel4;
     private javax.swing.JScrollPane jScrollPane1;
     private javax.swing.JLabel locationLabel;
     private javax.swing.JLabel locationValueLabel;
@@ -457,7 +433,7 @@
     private javax.swing.JLabel totalResultValueLabel;
     protected javax.swing.JButton undoButton;
     protected javax.swing.JButton unselectAllButton;
-    private javax.swing.JLabel whenInserLabel;
+    private javax.swing.JLabel whenInsertLabel;
     private javax.swing.JLabel whenInsertValueLabel;
     private javax.swing.JLabel whoInsertLabel;
     private javax.swing.JLabel whoInsertValueLabel;

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryCtrl.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -11,6 +11,15 @@
 
 import java.awt.event.ActionEvent;
 import java.awt.event.ActionListener;
+import java.rmi.RemoteException;
+
+import javax.swing.JOptionPane;
+
+import net.sf.plantlore.common.ProgressBar;
+import net.sf.plantlore.common.Task;
+import net.sf.plantlore.common.exception.DBLayerException;
+import net.sf.plantlore.l10n.L10n;
+
 import org.apache.log4j.Logger;
 
 /**
@@ -157,7 +166,7 @@
     class rowSetDisplayChangeListener implements ActionListener {
        public void actionPerformed(ActionEvent actionEvent) {
     	   // Check whether an error flag is set
-    	   if (model.isError()) {
+    	   if (model.isError() &amp;&amp; view.tableHistoryList.getRowCount() &gt; 0) {
         	   view.showErrorMessage(model.getError());
         	   return;
            }
@@ -206,7 +215,7 @@
        public void actionPerformed(ActionEvent actionEvent)
        {
     	   // Check whether an error flag is set
-    	   if (model.isError()) {
+    	   if (model.isError() &amp;&amp; view.tableHistoryList.getRowCount() &gt; 0) {
         	   view.showErrorMessage(model.getError());
         	   return;
            }
@@ -225,20 +234,53 @@
 	               if (okCancle == 0){
 	                   //Button OK was press
 	                   logger.debug(&quot;Button OK was press.&quot;);    
-	                   model.commitUpdate();
-	                   model.deleteHistory(toResult, false);
-	                   model.searchWholeHistoryData();        	
-	                   model.processResult(1,model.getDisplayRows());
-	                   view.tableHistoryList.setModel(new WholeHistoryTableModel(model));
-	                   Integer resultRows = model.getResultRows();
-	                   if (resultRows == 0) {
-	                           view.displayedValueLabel.setText(&quot;0-0&quot;); 
-	                   } else {
-	                           int from = model.getCurrentFirstRow();
-	                   int to = from + view.tableHistoryList.getRowCount() - 1;               
-	                   view.displayedValueLabel.setText(from + &quot;-&quot; + to);    
-	                   }               
-	                   view.totalResultValueLabel.setText(resultRows.toString());
+	                   Task task = model.commitUpdate(toResult, false);
+	                   
+	                   ProgressBar progressBar = new ProgressBar(task, view, true) {		   				
+						private static final long serialVersionUID = -6065695152319199854L;
+							public void exceptionHandler(Exception e) {
+		   						if (e instanceof DBLayerException) {	   									   							
+		   							DBLayerException dbex = (DBLayerException) e;
+		   							//TODO zobrazit vlastni message - nemusi byt vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+									JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.DBLayerException&quot;)+ &quot;\n&quot; + dbex.getErrorInfo(),
+		 							   L10n.getString(&quot;Error.DBLayerExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(dbex + &quot;: &quot; + dbex.getErrorInfo());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						if (e instanceof RemoteException) {	 
+		   							RemoteException remex = (RemoteException) e;
+		   							//TODO zobrazit vlastni message - nemusi byt vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+		   							JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.RemoteException&quot;)+ &quot;\n&quot; + remex.getMessage(),
+		 							   L10n.getString(&quot;Error.RemoteExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(remex + &quot;: &quot; + remex.getMessage());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						JOptionPane.showMessageDialog(view, L10n.getString(&quot;Delete.Message.UnknownException&quot;)+ &quot;\n&quot; + e.getMessage(),
+			 					    L10n.getString(&quot;Delete.Message.UnknownExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);							
+		   						logger.error(e);
+		   					}
+	
+		   					public void afterStopping() {
+		   						logger.debug(&quot;Load Data&quot;);	                   
+		 	                    model.searchWholeHistoryData();        	
+		 	                    model.processResult(1,model.getDisplayRows());
+		 	                    view.tableHistoryList.setModel(new WholeHistoryTableModel(model));
+		 	                    Integer resultRows = model.getResultRows();
+		 	                    if (resultRows == 0) {
+		 	                            view.displayedValueLabel.setText(&quot;0-0&quot;); 
+		 	                    } else {
+		 	                            int from = model.getCurrentFirstRow();
+		 	                    int to = from + view.tableHistoryList.getRowCount() - 1;               
+		 	                    view.displayedValueLabel.setText(from + &quot;-&quot; + to);    
+		 	                    }               
+		 	                    view.totalResultValueLabel.setText(resultRows.toString());
+		   					}
+		   				};
+		   				progressBar.setTitle(L10n.getString(&quot;History.Undo.ProgressTitle&quot;));	                   	                   
+	                    task.start();
+	                   
 	               } else {	                       	                     
 	                       logger.debug(&quot;Button Cancle was press.&quot;);
 	               } 
@@ -257,7 +299,7 @@
        public void actionPerformed(ActionEvent actionEvent)
        {
     	   // Check whether an error flag is set
-    	   if (model.isError()) {
+    	   if (model.isError() &amp;&amp; view.tableHistoryList.getRowCount() &gt; 0) {
         	   view.showErrorMessage(model.getError());
         	   return;
            }        
@@ -284,26 +326,59 @@
        public void actionPerformed(ActionEvent actionEvent)
        {
     	   // Check whether an error flag is set
-    	   if (model.isError()) {
+    	   if (model.isError() &amp;&amp; view.tableHistoryList.getRowCount() &gt; 0) {
         	   view.showErrorMessage(model.getError());
         	   return;
-           }       
-           int okCancle = view.messageUndo(&quot;CH&quot;);
+           }     
+    	   if (view.tableHistoryList.getRowCount() == 0) {
+    		   view.messageUndo(&quot;clearHistory&quot;);
+    		   return;
+    	   }
+           int okCancle = view.messageUndo(&quot;clearHistory&quot;);
            if (okCancle == 0){
                    //Button OK was press
                    logger.debug(&quot;Button OK was press.&quot;);  
                    // delete records whit contition cdelete &gt; 0
-                   model.clearDatabase();
-                   //deleta data from tables tHistoryChange and tHistory
-                   model.clearHistory();                   
-                   //load data
-                   model.searchWholeHistoryData();        	
-                   model.processResult(1,model.getDisplayRows());
-                   view.tableHistoryList.setModel(new WholeHistoryTableModel(model));
-                   view.displayedValueLabel.setText(&quot;0-0&quot;);
-                   view.displayedValueLabel.setText(&quot;0-0&quot;); 
-                   view.totalResultValueLabel.setText(&quot;0&quot;);
+                   Task task = model.clearDatabase();
                    
+                   ProgressBar progressBar = new ProgressBar(task, view, true) {		   				
+						private static final long serialVersionUID = -6065695152319199854L;
+							public void exceptionHandler(Exception e) {
+		   						if (e instanceof DBLayerException) {	   									   							
+		   							DBLayerException dbex = (DBLayerException) e;
+		   							//TODO zobrazit vlastni message - nemusi vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+									JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.DBLayerException&quot;)+ &quot;\n&quot; + dbex.getErrorInfo(),
+		 							   L10n.getString(&quot;Error.DBLayerExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(dbex + &quot;: &quot; + dbex.getErrorInfo());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						if (e instanceof RemoteException) {	 
+		   							RemoteException remex = (RemoteException) e;
+		   							//TODO zobrazit vlastni message - nemusi vzdy byt poskozene pripojeni k DB, nekdo mohl smazat data, atd..
+		   							JOptionPane.showMessageDialog(view, L10n.getString(&quot;Error.RemoteException&quot;)+ &quot;\n&quot; + remex.getMessage(),
+		 							   L10n.getString(&quot;Error.RemoteExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);																						
+									logger.error(remex + &quot;: &quot; + remex.getMessage());
+		   							getTask().stop();
+		   							return;
+		   						}
+		   						JOptionPane.showMessageDialog(view, L10n.getString(&quot;Delete.Message.UnknownException&quot;)+ &quot;\n&quot; + e.getMessage(),
+			 					    L10n.getString(&quot;Delete.Message.UnknownExceptionTitle&quot;), JOptionPane.WARNING_MESSAGE);							
+		   						logger.error(e);
+		   					}
+	
+		   					public void afterStopping() {
+		   						//load data
+		   	                   model.searchWholeHistoryData();        	
+		   	                   model.processResult(1,model.getDisplayRows());
+		   	                   view.tableHistoryList.setModel(new WholeHistoryTableModel(model));
+		   	                   view.displayedValueLabel.setText(&quot;0-0&quot;);
+		   	                   view.displayedValueLabel.setText(&quot;0-0&quot;); 
+		   	                   view.totalResultValueLabel.setText(&quot;0&quot;);
+		   					}
+		   				};
+		   				progressBar.setTitle(L10n.getString(&quot;History.Undo.ProgressTitle&quot;));	                   	                   
+	                    task.start();	                                                         
            }
        }
     }

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.form	2006-07-23 18:41:04 UTC (rev 470)
@@ -19,32 +19,32 @@
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
           &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace pref=&quot;462&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;okButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
-                  &lt;Component id=&quot;jPanel1&quot; alignment=&quot;1&quot; min=&quot;-2&quot; pref=&quot;768&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;/Group&gt;
+              &lt;Component id=&quot;jPanel1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;30&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;helpButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace pref=&quot;565&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;okButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;closeButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;27&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+          &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
     &lt;DimensionLayout dim=&quot;1&quot;&gt;
       &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-          &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+          &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;Component id=&quot;jPanel1&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-              &lt;EmptySpace pref=&quot;17&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;Component id=&quot;jPanel1&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;15&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
                   &lt;Component id=&quot;helpButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;closeButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;Component id=&quot;okButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
-              &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+              &lt;EmptySpace min=&quot;-2&quot; pref=&quot;20&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
           &lt;/Group&gt;
       &lt;/Group&gt;
     &lt;/DimensionLayout&gt;
@@ -64,29 +64,34 @@
       &lt;Layout&gt;
         &lt;DimensionLayout dim=&quot;0&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
+              &lt;Group type=&quot;102&quot; attributes=&quot;0&quot;&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; pref=&quot;752&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
+                          &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;50&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;41&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;toDisplayLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;toDisplayValueTextField&quot; min=&quot;-2&quot; pref=&quot;28&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;50&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;displayedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;displayedValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace pref=&quot;117&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; pref=&quot;60&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;/Group&gt;
                       &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;Component id=&quot;detailsButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;Component id=&quot;undoToDateButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                              &lt;/Group&gt;
-                              &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                                  &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; pref=&quot;100&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                                  &lt;EmptySpace pref=&quot;46&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                                  &lt;Component id=&quot;jPanel2&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;/Group&gt;
-                          &lt;/Group&gt;
-                          &lt;EmptySpace min=&quot;-2&quot; pref=&quot;12&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                              &lt;Component id=&quot;clearHistoryButton&quot; min=&quot;-2&quot; pref=&quot;110&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                          &lt;/Group&gt;
+                          &lt;Component id=&quot;detailsButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;undoToDateButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                          &lt;Component id=&quot;clearHistoryButton&quot; min=&quot;-2&quot; pref=&quot;90&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                       &lt;/Group&gt;
-                      &lt;Component id=&quot;jScrollPane1&quot; alignment=&quot;0&quot; min=&quot;-2&quot; pref=&quot;747&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
                   &lt;/Group&gt;
                   &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
@@ -95,31 +100,39 @@
         &lt;DimensionLayout dim=&quot;1&quot;&gt;
           &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
               &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Component id=&quot;jScrollPane1&quot; min=&quot;-2&quot; pref=&quot;222&quot; max=&quot;-2&quot; attributes=&quot;1&quot;/&gt;
-                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Component id=&quot;previousButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;jPanel2&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;nextButton&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                              &lt;Component id=&quot;detailsButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;undoToDateButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                              &lt;Component id=&quot;clearHistoryButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;/Group&gt;
-                          &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;/Group&gt;
+                  &lt;Component id=&quot;jScrollPane1&quot; pref=&quot;240&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;15&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;previousButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;nextButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;totalResultLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;totalResultValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
                   &lt;/Group&gt;
-                  &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;EmptySpace min=&quot;-2&quot; pref=&quot;13&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
+                      &lt;Component id=&quot;clearHistoryButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;undoToDateButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                      &lt;Component id=&quot;detailsButton&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
+                  &lt;/Group&gt;
+                  &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
               &lt;/Group&gt;
           &lt;/Group&gt;
         &lt;/DimensionLayout&gt;
       &lt;/Layout&gt;
       &lt;SubComponents&gt;
         &lt;Container class=&quot;javax.swing.JScrollPane&quot; name=&quot;jScrollPane1&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;background&quot; type=&quot;java.awt.Color&quot; editor=&quot;org.netbeans.beaninfo.editors.ColorEditor&quot;&gt;
+              &lt;Color blue=&quot;ff&quot; green=&quot;ff&quot; id=&quot;white&quot; palette=&quot;1&quot; red=&quot;ff&quot; type=&quot;palette&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;jScrollPane1.getViewport().setBackground(Color.WHITE);&quot;/&gt;
+          &lt;/AuxValues&gt;
 
           &lt;Layout class=&quot;org.netbeans.modules.form.compat2.layouts.support.JScrollPaneSupportLayout&quot;/&gt;
           &lt;SubComponents&gt;
@@ -135,6 +148,7 @@
                 &lt;/Property&gt;
               &lt;/Properties&gt;
               &lt;AuxValues&gt;
+                &lt;AuxValue name=&quot;JavaCodeGenerator_InitCodePost&quot; type=&quot;java.lang.String&quot; value=&quot;TransferFocus.patch(tableHistoryList);&quot;/&gt;
                 &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
               &lt;/AuxValues&gt;
             &lt;/Component&gt;
@@ -150,17 +164,36 @@
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;nextButton&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonNext&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
         &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;clearHistoryButton&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
               &lt;Connection code=&quot;L10n.getString(&quot;History.Whole.ButtonClearHistory&quot;)&quot; type=&quot;code&quot;/&gt;
             &lt;/Property&gt;
-            &lt;Property name=&quot;inheritsPopupMenu&quot; type=&quot;boolean&quot; value=&quot;true&quot;/&gt;
           &lt;/Properties&gt;
           &lt;AuxValues&gt;
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;undoToDateButton&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.Whole.ButtonUndoToDate&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
         &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;detailsButton&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
@@ -171,125 +204,63 @@
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
-        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;undoToDateButton&quot;&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultLabel&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-              &lt;Connection code=&quot;L10n.getString(&quot;History.Whole.ButtonUndoToDate&quot;)&quot; type=&quot;code&quot;/&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.TotalResult&quot;)&quot; type=&quot;code&quot;/&gt;
             &lt;/Property&gt;
           &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultValueLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;((Integer)model.getResultRows()).toString()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
           &lt;AuxValues&gt;
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
-        &lt;Container class=&quot;javax.swing.JPanel&quot; name=&quot;jPanel2&quot;&gt;
-
-          &lt;Layout&gt;
-            &lt;DimensionLayout dim=&quot;0&quot;&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;31&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;totalResultLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;totalResultValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;31&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;toDisplayLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;toDisplayValueTextField&quot; min=&quot;-2&quot; pref=&quot;31&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; pref=&quot;30&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;displayedLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;Component id=&quot;displayedValueLabel&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;EmptySpace max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
-              &lt;/Group&gt;
-            &lt;/DimensionLayout&gt;
-            &lt;DimensionLayout dim=&quot;1&quot;&gt;
-              &lt;Group type=&quot;103&quot; groupAlignment=&quot;0&quot; attributes=&quot;0&quot;&gt;
-                  &lt;Group type=&quot;102&quot; alignment=&quot;1&quot; attributes=&quot;0&quot;&gt;
-                      &lt;Group type=&quot;103&quot; groupAlignment=&quot;3&quot; attributes=&quot;0&quot;&gt;
-                          &lt;Component id=&quot;totalResultLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;toDisplayLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;totalResultValueLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; pref=&quot;14&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;toDisplayValueTextField&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;displayedLabel&quot; alignment=&quot;3&quot; min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                          &lt;Component id=&quot;displayedValueLabel&quot; alignment=&quot;3&quot; pref=&quot;25&quot; max=&quot;32767&quot; attributes=&quot;0&quot;/&gt;
-                      &lt;/Group&gt;
-                      &lt;EmptySpace min=&quot;-2&quot; max=&quot;-2&quot; attributes=&quot;0&quot;/&gt;
-                  &lt;/Group&gt;
-              &lt;/Group&gt;
-            &lt;/DimensionLayout&gt;
-          &lt;/Layout&gt;
-          &lt;SubComponents&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.TotalResult&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;totalResultValueLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;((Integer)model.getResultRows()).toString()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;AuxValues&gt;
-                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
-              &lt;/AuxValues&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;toDisplayLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.RowsToDisplay&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JTextField&quot; name=&quot;toDisplayValueTextField&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;((Integer)model.getDisplayRows()).toString()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-                &lt;Property name=&quot;autoscrolls&quot; type=&quot;boolean&quot; value=&quot;false&quot;/&gt;
-              &lt;/Properties&gt;
-              &lt;AuxValues&gt;
-                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
-              &lt;/AuxValues&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;L10n.getString(&quot;History.Displayed&quot;)&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-            &lt;/Component&gt;
-            &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedValueLabel&quot;&gt;
-              &lt;Properties&gt;
-                &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-                  &lt;Connection code=&quot;model.getCurrentDisplayRows()&quot; type=&quot;code&quot;/&gt;
-                &lt;/Property&gt;
-              &lt;/Properties&gt;
-              &lt;AuxValues&gt;
-                &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
-              &lt;/AuxValues&gt;
-            &lt;/Component&gt;
-          &lt;/SubComponents&gt;
-        &lt;/Container&gt;
-        &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;nextButton&quot;&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;toDisplayLabel&quot;&gt;
           &lt;Properties&gt;
             &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-              &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonNext&quot;)&quot; type=&quot;code&quot;/&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.RowsToDisplay&quot;)&quot; type=&quot;code&quot;/&gt;
             &lt;/Property&gt;
           &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JTextField&quot; name=&quot;toDisplayValueTextField&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;((Integer)model.getDisplayRows()).toString()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
           &lt;AuxValues&gt;
             &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
           &lt;/AuxValues&gt;
         &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;L10n.getString(&quot;History.Displayed&quot;)&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+        &lt;/Component&gt;
+        &lt;Component class=&quot;javax.swing.JLabel&quot; name=&quot;displayedValueLabel&quot;&gt;
+          &lt;Properties&gt;
+            &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
+              &lt;Connection code=&quot;model.getCurrentDisplayRows()&quot; type=&quot;code&quot;/&gt;
+            &lt;/Property&gt;
+          &lt;/Properties&gt;
+          &lt;AuxValues&gt;
+            &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
+          &lt;/AuxValues&gt;
+        &lt;/Component&gt;
       &lt;/SubComponents&gt;
     &lt;/Container&gt;
-    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonOk&quot;)&quot; type=&quot;code&quot;/&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonHelp&quot;)&quot; type=&quot;code&quot;/&gt;
         &lt;/Property&gt;
       &lt;/Properties&gt;
       &lt;AuxValues&gt;
@@ -306,10 +277,10 @@
         &lt;AuxValue name=&quot;JavaCodeGenerator_VariableModifier&quot; type=&quot;java.lang.Integer&quot; value=&quot;4&quot;/&gt;
       &lt;/AuxValues&gt;
     &lt;/Component&gt;
-    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;helpButton&quot;&gt;
+    &lt;Component class=&quot;javax.swing.JButton&quot; name=&quot;okButton&quot;&gt;
       &lt;Properties&gt;
         &lt;Property name=&quot;text&quot; type=&quot;java.lang.String&quot; editor=&quot;org.netbeans.modules.form.RADConnectionPropertyEditor&quot;&gt;
-          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonHelp&quot;)&quot; type=&quot;code&quot;/&gt;
+          &lt;Connection code=&quot;L10n.getString(&quot;History.ButtonOk&quot;)&quot; type=&quot;code&quot;/&gt;
         &lt;/Property&gt;
       &lt;/Properties&gt;
       &lt;AuxValues&gt;

Modified: trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java
===================================================================
--- trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/client/history/WholeHistoryView.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -1,11 +1,12 @@
 /*
  * WholeHistoryView.java
  *
- * Created on 14. duben 2006, 18:21
+ * Created on 23. &#269;ervenec 2006, 14:37
  */
 
 package net.sf.plantlore.client.history;
 
+import java.awt.Color;
 import java.util.Observable;
 import java.util.Observer;
 import javax.swing.DefaultListSelectionModel;
@@ -13,16 +14,14 @@
 import javax.swing.JOptionPane;
 import net.sf.plantlore.common.PlantloreHelp;
 import net.sf.plantlore.l10n.L10n;
+import net.sf.plantlore.common.TransferFocus;
 
 /**
- * View for the main WholeHistory dialog (part of the WholeHistory MVC). Used for displaying the search results.
- * @author  Lada Oberreiterov&#225;
- * @version 1.0
+ *
+ * @author  Lada
  */
-public class WholeHistoryView extends javax.swing.JDialog implements Observer{
-       
-	private static final long serialVersionUID = -3610428060548385487L;
-	/** Model of the History MVC*/
+public class WholeHistoryView extends javax.swing.JDialog implements Observer {
+    
     private History model;  
   
     /**
@@ -38,7 +37,9 @@
         // Register observer
         model.addObserver(this);
         setDefaultCloseOperation(JDialog.HIDE_ON_CLOSE);
-        initComponents();
+        initComponents();        
+        getRootPane().setDefaultButton(okButton);    
+        //TODO doresit ENTER
         // Init Help
         PlantloreHelp.addKeyHelp(PlantloreHelp.HISTORY_MANAGER, this.getRootPane());
         PlantloreHelp.addButtonHelp(PlantloreHelp.HISTORY_MANAGER, this.helpButton);        
@@ -51,7 +52,7 @@
         }
     }
     
-    /**
+     /**
      * Reload the view dialog or display some kind of error.
      */
     public void update(Observable observable, Object object)
@@ -74,23 +75,24 @@
         jScrollPane1 = new javax.swing.JScrollPane();
         tableHistoryList = new javax.swing.JTable();
         previousButton = new javax.swing.JButton();
+        nextButton = new javax.swing.JButton();
         clearHistoryButton = new javax.swing.JButton();
-        detailsButton = new javax.swing.JButton();
         undoToDateButton = new javax.swing.JButton();
-        jPanel2 = new javax.swing.JPanel();
+        detailsButton = new javax.swing.JButton();
         totalResultLabel = new javax.swing.JLabel();
         totalResultValueLabel = new javax.swing.JLabel();
         toDisplayLabel = new javax.swing.JLabel();
         toDisplayValueTextField = new javax.swing.JTextField();
         displayedLabel = new javax.swing.JLabel();
         displayedValueLabel = new javax.swing.JLabel();
-        nextButton = new javax.swing.JButton();
-        okButton = new javax.swing.JButton();
-        closeButton = new javax.swing.JButton();
         helpButton = new javax.swing.JButton();
+        closeButton = new javax.swing.JButton();
+        okButton = new javax.swing.JButton();
 
         setDefaultCloseOperation(javax.swing.WindowConstants.DISPOSE_ON_CLOSE);
         jPanel1.setBorder(javax.swing.BorderFactory.createTitledBorder(L10n.getString(&quot;History.Whole.Panel&quot;)));
+        jScrollPane1.setBackground(java.awt.Color.white);
+        jScrollPane1.getViewport().setBackground(Color.WHITE);
         tableHistoryList.setModel(new javax.swing.table.DefaultTableModel(
             new Object [][] {
                 {null, null, null, null},
@@ -102,17 +104,19 @@
                 &quot;Title 1&quot;, &quot;Title 2&quot;, &quot;Title 3&quot;, &quot;Title 4&quot;
             }
         ));
+        TransferFocus.patch(tableHistoryList);
         jScrollPane1.setViewportView(tableHistoryList);
 
         previousButton.setText(L10n.getString(&quot;History.ButtonPrev&quot;));
 
+        nextButton.setText(L10n.getString(&quot;History.ButtonNext&quot;));
+
         clearHistoryButton.setText(L10n.getString(&quot;History.Whole.ButtonClearHistory&quot;));
-        clearHistoryButton.setInheritsPopupMenu(true);
 
-        detailsButton.setText(L10n.getString(&quot;History.ButtonDetails&quot;));
-
         undoToDateButton.setText(L10n.getString(&quot;History.Whole.ButtonUndoToDate&quot;));
 
+        detailsButton.setText(L10n.getString(&quot;History.ButtonDetails&quot;));
+
         totalResultLabel.setText(L10n.getString(&quot;History.TotalResult&quot;));
 
         totalResultValueLabel.setText(((Integer)model.getResultRows()).toString());
@@ -120,95 +124,70 @@
         toDisplayLabel.setText(L10n.getString(&quot;History.RowsToDisplay&quot;));
 
         toDisplayValueTextField.setText(((Integer)model.getDisplayRows()).toString());
-        toDisplayValueTextField.setAutoscrolls(false);
 
         displayedLabel.setText(L10n.getString(&quot;History.Displayed&quot;));
 
         displayedValueLabel.setText(model.getCurrentDisplayRows());
 
-        org.jdesktop.layout.GroupLayout jPanel2Layout = new org.jdesktop.layout.GroupLayout(jPanel2);
-        jPanel2.setLayout(jPanel2Layout);
-        jPanel2Layout.setHorizontalGroup(
-            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(jPanel2Layout.createSequentialGroup()
-                .add(31, 31, 31)
-                .add(totalResultLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(totalResultValueLabel)
-                .add(31, 31, 31)
-                .add(toDisplayLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 31, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .add(30, 30, 30)
-                .add(displayedLabel)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                .add(displayedValueLabel)
-                .addContainerGap())
-        );
-        jPanel2Layout.setVerticalGroup(
-            jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel2Layout.createSequentialGroup()
-                .add(jPanel2Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                    .add(totalResultLabel)
-                    .add(toDisplayLabel)
-                    .add(totalResultValueLabel, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 14, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                    .add(displayedLabel)
-                    .add(displayedValueLabel, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 25, Short.MAX_VALUE))
-                .addContainerGap())
-        );
-
-        nextButton.setText(L10n.getString(&quot;History.ButtonNext&quot;));
-
         org.jdesktop.layout.GroupLayout jPanel1Layout = new org.jdesktop.layout.GroupLayout(jPanel1);
         jPanel1.setLayout(jPanel1Layout);
         jPanel1Layout.setHorizontalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
-                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
+                .addContainerGap()
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                    .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 752, Short.MAX_VALUE)
                     .add(jPanel1Layout.createSequentialGroup()
-                        .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1Layout.createSequentialGroup()
-                                .addContainerGap()
-                                .add(detailsButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                                .add(undoToDateButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                            .add(jPanel1Layout.createSequentialGroup()
-                                .add(previousButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 46, Short.MAX_VALUE)
-                                .add(jPanel2, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
-                        .add(12, 12, 12)
-                        .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.TRAILING)
-                            .add(nextButton)
-                            .add(clearHistoryButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 110, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
-                    .add(org.jdesktop.layout.GroupLayout.LEADING, jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 747, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                        .add(previousButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(50, 50, 50)
+                        .add(totalResultLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(totalResultValueLabel)
+                        .add(41, 41, 41)
+                        .add(toDisplayLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 28, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .add(50, 50, 50)
+                        .add(displayedLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(displayedValueLabel)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 117, Short.MAX_VALUE)
+                        .add(nextButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1Layout.createSequentialGroup()
+                        .add(detailsButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(undoToDateButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                        .add(clearHistoryButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 90, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)))
                 .addContainerGap())
         );
         jPanel1Layout.setVerticalGroup(
             jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(jPanel1Layout.createSequentialGroup()
-                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 222, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
+                .add(jScrollPane1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, 240, Short.MAX_VALUE)
+                .add(15, 15, 15)
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(previousButton)
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1Layout.createSequentialGroup()
-                        .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                            .add(jPanel2, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
-                            .add(nextButton))
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
-                            .add(detailsButton)
-                            .add(undoToDateButton)
-                            .add(clearHistoryButton))
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)))
+                    .add(nextButton)
+                    .add(totalResultLabel)
+                    .add(totalResultValueLabel)
+                    .add(toDisplayLabel)
+                    .add(toDisplayValueTextField, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                    .add(displayedValueLabel)
+                    .add(displayedLabel))
+                .add(13, 13, 13)
+                .add(jPanel1Layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
+                    .add(clearHistoryButton)
+                    .add(undoToDateButton)
+                    .add(detailsButton))
                 .addContainerGap())
         );
 
-        okButton.setText(L10n.getString(&quot;History.ButtonOk&quot;));
+        helpButton.setText(L10n.getString(&quot;History.ButtonHelp&quot;));
 
         closeButton.setText(L10n.getString(&quot;History.ButtonClose&quot;));
 
-        helpButton.setText(L10n.getString(&quot;History.ButtonHelp&quot;));
+        okButton.setText(L10n.getString(&quot;History.ButtonOk&quot;));
 
         org.jdesktop.layout.GroupLayout layout = new org.jdesktop.layout.GroupLayout(getContentPane());
         getContentPane().setLayout(layout);
@@ -216,33 +195,44 @@
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
             .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-                    .add(layout.createSequentialGroup()
-                        .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 462, Short.MAX_VALUE)
-                        .add(okButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                        .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
-                        .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 100, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
-                    .add(org.jdesktop.layout.GroupLayout.TRAILING, jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 768, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE))
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
                 .addContainerGap())
+            .add(layout.createSequentialGroup()
+                .add(30, 30, 30)
+                .add(helpButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 565, Short.MAX_VALUE)
+                .add(okButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED)
+                .add(closeButton, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, 60, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
+                .add(27, 27, 27))
         );
         layout.setVerticalGroup(
             layout.createParallelGroup(org.jdesktop.layout.GroupLayout.LEADING)
-            .add(org.jdesktop.layout.GroupLayout.TRAILING, layout.createSequentialGroup()
+            .add(layout.createSequentialGroup()
                 .addContainerGap()
-                .add(jPanel1, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.PREFERRED_SIZE)
-                .addPreferredGap(org.jdesktop.layout.LayoutStyle.RELATED, 17, Short.MAX_VALUE)
+                .add(jPanel1, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, org.jdesktop.layout.GroupLayout.DEFAULT_SIZE, Short.MAX_VALUE)
+                .add(15, 15, 15)
                 .add(layout.createParallelGroup(org.jdesktop.layout.GroupLayout.BASELINE)
                     .add(helpButton)
                     .add(closeButton)
                     .add(okButton))
-                .addContainerGap())
+                .add(20, 20, 20))
         );
         pack();
     }// &lt;/editor-fold&gt;//GEN-END:initComponents
-      
     
     /**
+     * @param args the command line arguments
+     */
+    public static void main(String args[]) {
+        java.awt.EventQueue.invokeLater(new Runnable() {
+            public void run() {
+                new WholeHistoryView(null, new javax.swing.JFrame(), true).setVisible(true);
+            }
+        });
+    }
+    
+    /**
      * Close this dialog.
      */
     public void close() {
@@ -264,7 +254,7 @@
      */
     public int messageUndo(String message) {
     	int okCancle = 1;
-    	if (message.equals(&quot;cHistory&quot;)) {
+    	if (message.equals(&quot;clearHistory&quot;)) {
     		okCancle = JOptionPane.showConfirmDialog(this, L10n.getString(&quot;Question.ClearHistoryMessage&quot;), L10n.getString(&quot;Question.ClearHistoryMessageTitle&quot;), JOptionPane.OK_CANCEL_OPTION);
     	}else {
     		okCancle = JOptionPane.showConfirmDialog(this, L10n.getString(&quot;Question.Undo&quot;) + &quot;  &quot;+ message, L10n.getString(&quot;Question.UndoTitle&quot;), JOptionPane.OK_CANCEL_OPTION);
@@ -300,7 +290,7 @@
      */
     public void setDisplayRows(Integer value) {
         this.toDisplayValueTextField.setText(value.toString());
-    }  
+    }      
     
     // Variables declaration - do not modify//GEN-BEGIN:variables
     protected javax.swing.JButton clearHistoryButton;
@@ -310,7 +300,6 @@
     protected javax.swing.JLabel displayedValueLabel;
     protected javax.swing.JButton helpButton;
     private javax.swing.JPanel jPanel1;
-    private javax.swing.JPanel jPanel2;
     private javax.swing.JScrollPane jScrollPane1;
     protected javax.swing.JButton nextButton;
     protected javax.swing.JButton okButton;

Modified: trunk/src/net/sf/plantlore/common/ProgressBar.java
===================================================================
--- trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-07-22 02:33:30 UTC (rev 469)
+++ trunk/src/net/sf/plantlore/common/ProgressBar.java	2006-07-23 18:41:04 UTC (rev 470)
@@ -219,6 +219,7 @@
                         setVisible(false);
                         dispose();                    
                         parent.setCursor(Cursor.getDefaultCursor());
+                        afterStopping();
                         break;
                     case STOPPED:
                         afterStopped(value);
@@ -247,6 +248,10 @@
         
     }
     
+    public void afterStopping() {
+    	
+    }
+    
     // Variables declaration - do not modify//GEN-BEGIN:variables
     private javax.swing.JPanel jPanel1;
     private javax.swing.JProgressBar progressBar;


</PRE>

<!--endarticle-->
    <HR>
    <P><UL>
        <!--threads-->
	<LI>Previous message: <A HREF="000607.html">[Plantlore-dev] r469 - trunk/analysis/database
</A></li>
	<LI>Next message: <A HREF="000609.html">[Plantlore-dev] Fwd: Plantlore
</A></li>
         <LI> <B>Messages sorted by:</B> 
              <a href="date.html#608">[ date ]</a>
              <a href="thread.html#608">[ thread ]</a>
              <a href="subject.html#608">[ subject ]</a>
              <a href="author.html#608">[ author ]</a>
         </LI>
       </UL>

<hr>
<a href="https://lists.berlios.de/mailman/listinfo/plantlore-dev">More information about the Plantlore-dev
mailing list</a><br>
</body></html>
